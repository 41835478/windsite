var TaobaoConstants={URL:"/router/taobao",SECRET:"",API_KEY:"",APIKEY:"api_key",METHOD:"method",SESSION:"session",SIGN:"sign",TIMESTAMP:"timestamp",FORMAT:"format",VERSION:"v",ERROR_RSP:"error_response",ERROR_CODE:"code",ERROR_MSG:"msg",SUB_ERROR_CODE:"sub_code",SUB_ERROR_MSG:"sub_msg",RSP:"rsp",TOTALRESULTS:"totalResults"};function WindSender(c,p){this.url=c;this.load=function(x,d,b,l){$.ajax({url:this.url,type:x,data:d,dataType:"json",beforeSend:function(e){e.setRequestHeader("WindType","AJAX")},error:function(){p||alert("\u7f51\u7edc\u9519\u8bef!\u8bf7\u91cd\u8bd5");l&&typeof l=="function"&&l()},success:function(e){e=new WindResponse(e);if(!e.isSuccess()&&(e.errorCode==27||e.errorCode==100))document.location.href="/router/site/redirect";else b(e)}})}};function WindResponse(c){this.subMsg=this.subCode=this.msg=this.errorCode=null;this.body={};this.isSuccess=function(){return null==this.errorCode};if(c!=null){if(c.hasOwnProperty(TaobaoConstants.ERROR_RSP)){this.errorCode=c[TaobaoConstants.ERROR_RSP][TaobaoConstants.ERROR_CODE];this.msg=c[TaobaoConstants.ERROR_RSP][TaobaoConstants.ERROR_MSG];if(c[TaobaoConstants.ERROR_RSP].hasOwnProperty(TaobaoConstants.SUB_ERROR_CODE)){this.subCode=c[TaobaoConstants.ERROR_RSP][TaobaoConstants.SUB_ERROR_CODE];this.subMsg=
c[TaobaoConstants.ERROR_RSP][TaobaoConstants.SUB_ERROR_MSG]}}this.msg=convertError(parseInt(this.errorCode),this.msg);this.body=c}}
function convertError(c,p){switch(c){case 3:return"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25";case 4:return"\u7528\u6237\u8c03\u7528\u6b21\u6570\u8d85\u9650";case 5:return"\u4f1a\u8bdd\u8c03\u7528\u6b21\u6570\u8d85\u9650";case 6:return"\u5408\u4f5c\u4f19\u4f34\u8c03\u7528\u6b21\u6570\u8d85\u9650";case 7:return"\u5e94\u7528\u8c03\u7528\u6b21\u6570\u8d85\u9650";case 8:return"\u5e94\u7528\u8c03\u7528\u9891\u7387\u8d85\u9650";case 9:return"HTTP\u65b9\u6cd5\u88ab\u7981\u6b62\uff08\u8bf7\u7528\u5927\u5199\u7684POST\u6216GET\uff09";
case 10:return"\u670d\u52a1\u4e0d\u53ef\u7528";case 11:return"\u5f00\u53d1\u8005\u6743\u9650\u4e0d\u8db3";case 12:return"\u7528\u6237\u6743\u9650\u4e0d\u8db3";case 13:return"\u5408\u4f5c\u4f19\u4f34\u6743\u9650\u4e0d\u8db3";case 15:return"\u6dd8\u5b9d\u8fdc\u7a0b\u670d\u52a1\u51fa\u9519,\u8bf7\u91cd\u8bd5";case 21:return"\u7f3a\u5c11\u65b9\u6cd5\u540d\u53c2\u6570";case 22:return"\u4e0d\u5b58\u5728\u7684\u65b9\u6cd5\u540d";case 23:return"\u975e\u6cd5\u6570\u636e\u683c\u5f0f";case 24:return"\u7f3a\u5c11\u7b7e\u540d\u53c2\u6570";
case 25:return"\u975e\u6cd5\u7b7e\u540d";case 26:return"\u7f3a\u5c11SessionKey\u53c2\u6570";case 27:return"\u65e0\u6548\u7684SessionKey\u53c2\u6570";case 28:return"\u7f3a\u5c11AppKey\u53c2\u6570";case 29:return"\u975e\u6cd5\u7684AppKe\u53c2\u6570";case 30:return"\u7f3a\u5c11\u65f6\u95f4\u6233\u53c2\u6570";case 31:return"\u975e\u6cd5\u7684\u65f6\u95f4\u6233\u53c2\u6570";case 32:return"\u7f3a\u5c11\u7248\u672c\u53c2\u6570";case 33:return"\u975e\u6cd5\u7684\u7248\u672c\u53c2\u6570";case 34:return"\u4e0d\u652f\u6301\u7684\u7248\u672c\u53f7";
case 40:return"\u7f3a\u5c11\u5fc5\u9009\u53c2\u6570";case 41:return"\u975e\u6cd5\u7684\u53c2\u6570";case 42:return"\u8bf7\u6c42\u88ab\u7981\u6b62";case 43:return"\u53c2\u6570\u9519\u8bef"}return p};$(function(){function c(j,o){$("dd",q).remove();$(".related-goods-marker",k).remove();if(e!=null){for(var f,r=0;r<e.length;r++){var E=e[r];if(j==E.picId){f=E;d=r;if(r<l-1)(new Image).src=e[r+1].picSrc;break}}if(!(f==null||!f)){b=parseInt(d/5)*5;true==o&&d>5&&s.animate({top:-1*b*m},500);z.animate({top:m*(d-b)},500);var n=f.markedItem;if(n==null||!n||n.length==0){q.hide();if(f.relatedGoodsLink){o=f.relatedGoodsLink.replace(/&amp;/ig,"&").replace(F,PID);t.empty().append('<a href="'+o+"&pid="+PID+'" target="_blank">'+
f.picDesc+"</a>");G.attr("href",o);u.show()}else{t.empty().append(f.picDesc);u.hide()}}else if(data.version=="1.0"){q.hide();if(f.relatedGoodsLink){o=f.relatedGoodsLink.replace(/&amp;/ig,"&").replace(F,PID);t.empty().append('<a href="'+o+"&pid="+PID+'" target="_blank">'+f.picDesc+"</a>");G.attr("href",o);u.show()}else{t.empty().append(f.picDesc);u.hide()}}else{q.show();t.empty().append(f.picDesc);u.hide()}H.unbind("load").load(function(){J.text(d+1);var A=[],v=$(this).height()<=502?508:$(this).height()+
6,h;h=parseInt(k.height());if(isNaN(h))h=0;h=Math.abs(h-v);k.animate({height:v},(h>15?0.5:0.1)>15?500:1E3);v=$(this).width()>660?660:$(this).width();$(this).height();if(!(n==null||!n||n.length==0)){for(h=0;h<n.length;h++){var a=n[h];A.push(a.itemId);var B=$('<dd style="display:none" data-tipid="'+h+'">'+a.itemTitle+"</dd>");q.append(B);B=$('<div class="related-goods-marker" style="left:'+((654-v)/2+a.x)+"px;top:"+a.y+'px" data-tipid="'+h+'"></div>');for(var C=$('<span class="marked-area" style="width:'+
(a.width+8)+"px;height:"+(a.height+8)+'px;"></span>'),g=1;g<4;g++)C.append('<b class="shadow-'+g+'" style="width:'+(a.width+(4-g)*2)+"px;height:"+(a.height+(4-g)*2)+'px;"></b>');g=$('<b class="inner-border" style="width:'+a.width+"px;height:"+a.height+'px;opacity: 1;"></b>');C.append(g);g=-1*(a.height+8)/2;var w=(a.width+8)/2;g=g+a.y+270>$(this).height()?g-123:g;w=w+(654-v)/2+a.x+254>$(this).width()?w-270:w;a=$('<div class="tip-wrap" href="/titem/'+a.itemId+".html?"+a.P4PKeyword+'" style="margin-left:'+
w+"px;margin-top:"+g+'px;display:none;"><b class="corner"></b><div class="goods-tip clearfix"><div class="pic goods-image"><a href="/titem/'+a.itemId+".html?"+a.P4PKeyword+'" target="_blank"><img src="'+a.itemPic+'" /></a></div><dl class="goods-detail"><dt class="goods-name">\u5546\u54c1\u540d\u79f0:</dt><dd><a href="/titem/'+a.itemId+".html?"+a.P4PKeyword+'" target="_blank">'+a.itemTitle+'</a></dd><dt class="overwritten">\u4e00\u53e3\u4ef7:</dt><dd class="goods-price overwritten">\uffe5'+a.itemPrice+
'</dd><dt class="hb-fl-desc" style="display:none;">\u8fd4\u5229:</dt><dd numiid="'+a.itemId+'" class="hb-fl" picid="'+j+'" style="display:none;font-size:14px;font-weight:700;color:#f60;"></dd><dt>\u7b80\u8ff0:</dt><dd>'+a.itemDesc+'</dd></dl><a href="/titem/'+a.itemId+".html?"+a.P4PKeyword+'" style="position:absolute;right:10px;bottom:7px;background:#232323 url(http://img04.taobaocdn.com/tps/i4/T1KLBOXc0uXXXXXXXX.png) right -21px no-repeat;display:inline-block;padding-right:12px;" target="_blank">\u5b9d\u8d1d\u8be6\u60c5</a><div style="clear:both;"></div></div><div class="p4p-goods-tip"></div><b class="corner"></b></div>');
k.append(B.append(C).append(a))}$(".marked-area",k).animate({opacity:0},2E3);$(".inner-border",k).hover(function(){p($(this).parent())},function(i){var y=$(this).parent();if(i.relatedTarget)if($.contains(y.parent().find(".tip-wrap")[0],i.relatedTarget))return;x(y)});$("dd",q).fadeIn("slow").unbind("hover").hover(function(){$(this).addClass("current").siblings().removeClass("current");p($(".related-goods-marker[data-tipid="+$(this).attr("data-tipid")+"] .marked-area",k))},function(){$(this).removeClass("current");
x($(".related-goods-marker[data-tipid="+$(this).attr("data-tipid")+"] .marked-area",k))});if(ISFANLI&&A.length>0){var I=$("#J_posterContainer").data("pic-"+j);I!=null?$(".hb-fl",k).each(function(){var i=I[$(this).attr("numiid")];i&&"0"!=i&&$(this).empty().append(i+"\u5143").show().parent().find(".hb-fl-desc").show()}):(new WindSender("/router/huabao/convert?v="+Math.random(),true)).load("GET",{picid:j,numiids:A.join(",")},function(i){if(i.isSuccess()){var y=i.body.commissions;$("#J_posterContainer").data("pic-"+
i.body.picid,i.body.commissions);$(".hb-fl",k).each(function(){var D=y[$(this).attr("numiid")];D&&"0"!=D&&$(this).empty().append(D+"\u5143").show().parent().find(".hb-fl-desc").show()})}})}}}).attr("src",f.picSrc)}}}function p(j){j.animate({opacity:1},500);j.parent().find(".tip-wrap").animate({opacity:1},500).css("z-Index",1).show()}function x(j){j.animate({opacity:0},1E3);j.parent().find(".tip-wrap").animate({opacity:0},1E3).css("z-Index",0).show()}var d,b,l,e,F=/mm_\d{0,24}_\d{0,24}_\d{0,24}/gmi,
s=$("#J_thumbList ul"),J=$("#currentNum"),z=$("#thumbCurrent"),k=$("#J_posterOriginalImage"),H=$("#J_Image"),t=$("#J_PosterDesc"),q=$("#related-goods"),u=$("#related-goods-v1-btn"),G=$("#related-goods-v1-btn a");if(typeof data!="undefined"&&data.hasOwnProperty("posterInfo")){e=data.posterInfo;l=e.length;var m=parseInt($("#J_thumbList").height()/5);PICID!=0?c(PICID,true):c($("#J_thumbList ul li div img:first").attr("data-picid"));$("#J_thumbList li").click(function(){c($("div img:first",$(this)).attr("data-picid"));
return false});$("#J_prevThumb").click(function(){b=b>5?b-5:0;s.animate({top:-1*b*m},500);z.animate({top:-1*(b-d)*m},500);return false});$("#J_nextThumb").click(function(){if(!(l-b<=5)){b+=5;s.animate({top:-1*b*m},500);z.animate({top:-1*(b-d)*m},500);return false}});H.click(function(){if(d<l-1){d-b>=4&&s.animate({top:-1*(b+5)*m},500);c(e[d+1].picId)}return false});$("#J_prevPage").click(function(){if(d>0){d-b==0&&s.animate({top:-1*(b-5)*m},500);c(e[d-1].picId)}return false});$("#J_nextPage").click(function(){if(d<
l-1){d-b>=4&&s.animate({top:-1*(b+5)*m},500);c(e[d+1].picId)}return false})}});