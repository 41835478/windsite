/*
 Rangy Inputs, a jQuery plug-in for selection and caret manipulation within textareas and text inputs.

 https://github.com/timdown/rangyinputs

 For range and selection features for contenteditable, see Rangy.

 http://code.google.com/p/rangy/

 Depends on jQuery 1.0 or later.

 Copyright 2013, Tim Down
 Licensed under the MIT license.
 Version: 1.1
 Build date: 31 March 2013
*/
window.JSON || (window.JSON = {}); (function() {
	function a(a) {
		return 10 > a ? "0" + a: a
	}
	function e(a) {
		return k.lastIndex = 0,
		k.test(a) ? '"' + a.replace(k,
		function(a) {
			var d = n[a];
			return "string" == typeof d ? d: "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice( - 4)
		}) + '"': '"' + a + '"'
	}
	function d(a, g) {
		var j, k, n, v, D = l,
		E, F = g[a];
		F && "object" == typeof F && "function" == typeof F.toJSON && (F = F.toJSON(a));
		"function" == typeof o && (F = o.call(g, a, F));
		switch (typeof F) {
		case "string":
			return e(F);
		case "number":
			return isFinite(F) ? String(F) : "null";
		case "boolean":
		case "null":
			return String(F);
		case "object":
			if (!F) return "null";
			l += m;
			E = [];
			if ("[object Array]" === Object.prototype.toString.apply(F)) {
				v = F.length;
				for (j = 0; j < v; j += 1) E[j] = d(j, F) || "null";
				return n = 0 === E.length ? "[]": l ? "[\n" + l + E.join(",\n" + l) + "\n" + D + "]": "[" + E.join(",") + "]",
				l = D,
				n
			}
			if (o && "object" == typeof o) {
				v = o.length;
				for (j = 0; j < v; j += 1) k = o[j],
				"string" == typeof k && (n = d(k, F), n && E.push(e(k) + (l ? ": ": ":") + n))
			} else for (k in F) Object.hasOwnProperty.call(F, k) && (n = d(k, F), n && E.push(e(k) + (l ? ": ": ":") + n));
			return n = 0 === E.length ? "{}": l ? "{\n" + l + E.join(",\n" + l) + "\n" + D + "}": "{" + E.join(",") + "}",
			l = D,
			n
		}
	}
	"use strict";
	"function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function() {
		return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + a(this.getUTCMonth() + 1) + "-" + a(this.getUTCDate()) + "T" + a(this.getUTCHours()) + ":" + a(this.getUTCMinutes()) + ":" + a(this.getUTCSeconds()) + "Z": null
	},
	String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function() {
		return this.valueOf()
	});
	var g = window.JSON,
	j = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
	k = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
	l, m, n = {
		"\b": "\\b",
		"\t": "\\t",
		"\n": "\\n",
		"\f": "\\f",
		"\r": "\\r",
		'"': '\\"',
		"\\": "\\\\"
	},
	o;
	"function" != typeof g.stringify && (g.stringify = function(a, e, g) {
		var j;
		m = l = "";
		if ("number" == typeof g) for (j = 0; j < g; j += 1) m += " ";
		else "string" == typeof g && (m = g);
		o = e;
		if (!e || "function" == typeof e || "object" == typeof e && "number" == typeof e.length) return d("", {
			"": a
		});
		throw Error("JSON.stringify");
	});
	"function" != typeof g.parse && (g.parse = function(a, d) {
		function e(a, g) {
			var j, k, m = a[g];
			if (m && "object" == typeof m) for (j in m) Object.hasOwnProperty.call(m, j) && (k = e(m, j), void 0 !== k ? m[j] = k: delete m[j]);
			return d.call(a, g, m)
		}
		var g;
		a = String(a);
		j.lastIndex = 0;
		j.test(a) && (a = a.replace(j,
		function(a) {
			return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice( - 4)
		}));
		if (/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return g = eval("(" + a + ")"),
		"function" == typeof d ? e({
			"": g
		},
		"") : g;
		throw new SyntaxError("JSON.parse");
	})
})(); (function(a, e) {
	var d = a.History = a.History || {},
	g = a.jQuery;
	if ("undefined" != typeof d.Adapter) throw Error("History.js Adapter has already been loaded...");
	d.Adapter = {
		bind: function(a, d, e) {
			g(a).bind(d, e)
		},
		trigger: function(a, d, e) {
			g(a).trigger(d, e)
		},
		extractEventData: function(a, d, g) {
			return d && d.originalEvent && d.originalEvent[a] || g && g[a] || e
		},
		onDomLoad: function(a) {
			g(a)
		}
	};
	"undefined" != typeof d.init && d.init()
})(window); (function(a) {
	var e = a.document,
	d = a.setInterval || d,
	g = a.History = a.History || {};
	if ("undefined" != typeof g.initHtml4) throw Error("History.js HTML4 Support has already been loaded...");
	g.initHtml4 = function() {
		if ("undefined" != typeof g.initHtml4.initialized) return ! 1;
		g.initHtml4.initialized = !0;
		g.enabled = !0;
		g.savedHashes = [];
		g.isLastHash = function(a) {
			var d = g.getHashByIndex(),
			e;
			return e = a === d,
			e
		};
		g.saveHash = function(a) {
			return g.isLastHash(a) ? !1 : (g.savedHashes.push(a), !0)
		};
		g.getHashByIndex = function(a) {
			return null
		};
		g.discardedHashes = {};
		g.discardedStates = {};
		g.discardState = function(a, d, e) {
			var m = g.getHashByState(a),
			n;
			return n = {
				discardedState: a,
				backState: e,
				forwardState: d
			},
			g.discardedStates[m] = n,
			!0
		};
		g.discardHash = function(a, d, e) {
			return g.discardedHashes[a] = {
				discardedHash: a,
				backState: e,
				forwardState: d
			},
			!0
		};
		g.discardedState = function(a) {
			a = g.getHashByState(a);
			var d;
			return d = g.discardedStates[a] || !1,
			d
		};
		g.discardedHash = function(a) {
			return g.discardedHashes[a] || !1
		};
		g.recycleState = function(a) {
			var d = g.getHashByState(a);
			return g.discardedState(a) && delete g.discardedStates[d],
			!0
		};
		g.emulated.hashChange && (g.hashChangeInit = function() {
			g.checkerFunction = null;
			var j = "",
			k, l, m;
			return g.isInternetExplorer() ? (k = e.createElement("iframe"), k.setAttribute("id", "historyjs-iframe"), k.style.display = "none", e.body.appendChild(k), k.contentWindow.document.open(), k.contentWindow.document.close(), l = "", m = !1, g.checkerFunction = function() {
				if (m) return ! 1;
				m = !0;
				var d = g.getHash() || "",
				e = g.unescapeHash(k.contentWindow.document.location.hash) || "";
				return d !== j ? (j = d, e !== d && (l = d, k.contentWindow.document.open(), k.contentWindow.document.close(), k.contentWindow.document.location.hash = g.escapeHash(d)), g.Adapter.trigger(a, "hashchange")) : e !== l && (l = e, g.setHash(e, !1)),
				m = !1,
				!0
			}) : g.checkerFunction = function() {
				var d = g.getHash();
				return d !== j && (j = d, g.Adapter.trigger(a, "hashchange")),
				!0
			},
			g.intervalList.push(d(g.checkerFunction, g.options.hashChangeInterval)),
			!0
		},
		g.Adapter.onDomLoad(g.hashChangeInit));
		g.emulated.pushState && (g.onHashChange = function(d) {
			d = g.getHashByUrl(d && d.newURL || e.location.href);
			var k = null,
			l;
			return g.isLastHash(d) ? (g.busy(!1), !1) : (g.doubleCheckComplete(), g.saveHash(d), d && g.isTraditionalAnchor(d) ? (g.Adapter.trigger(a, "anchorchange"), g.busy(!1), !1) : (k = g.extractState(g.getFullUrl(d || e.location.href, !1), !0), g.isLastSavedState(k) ? (g.busy(!1), !1) : (g.getHashByState(k), l = g.discardedState(k), l ? (g.getHashByIndex( - 2) === g.getHashByState(l.forwardState) ? g.back(!1) : g.forward(!1), !1) : (g.pushState(k.data, k.title, k.url, !1), !0))))
		},
		g.Adapter.bind(a, "hashchange", g.onHashChange), g.pushState = function(d, k, l, m) {
			if (g.getHashByUrl(l)) throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
			if (!1 !== m && g.busy()) return g.pushQueue({
				scope: g,
				callback: g.pushState,
				args: arguments,
				queue: m
			}),
			!1;
			g.busy(!0);
			var n = g.createStateObject(d, k, l),
			o = g.getHashByState(n),
			r = g.getState(!1),
			r = g.getHashByState(r),
			u = g.getHash();
			return g.storeState(n),
			g.expectedStateId = n.id,
			g.recycleState(n),
			g.setTitle(n),
			o === r ? (g.busy(!1), !1) : o !== u && o !== g.getShortUrl(e.location.href) ? (g.setHash(o, !1), !1) : (g.saveState(n), g.Adapter.trigger(a, "statechange"), g.busy(!1), !0)
		},
		g.replaceState = function(a, d, e, m) {
			if (g.getHashByUrl(e)) throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
			if (!1 !== m && g.busy()) return g.pushQueue({
				scope: g,
				callback: g.replaceState,
				args: arguments,
				queue: m
			}),
			!1;
			g.busy(!0);
			var n = g.createStateObject(a, d, e),
			o = g.getState(!1),
			r = g.getStateByIndex( - 2);
			return g.discardState(o, n, r),
			g.pushState(n.data, n.title, n.url, !1),
			!0
		});
		g.emulated.pushState && g.getHash() && !g.emulated.hashChange && g.Adapter.onDomLoad(function() {
			g.Adapter.trigger(a, "hashchange")
		})
	};
	"undefined" != typeof g.init && g.init()
})(window); (function(a, e) {
	var d = a.console || e,
	g = a.document,
	j = a.navigator,
	k = a.sessionStorage || !1,
	l = a.setTimeout,
	m = a.clearTimeout,
	n = a.setInterval,
	o = a.clearInterval,
	r = a.JSON,
	u = a.alert,
	s = a.History = a.History || {},
	B = a.history;
	r.stringify = r.stringify || r.encode;
	r.parse = r.parse || r.decode;
	if ("undefined" != typeof s.init) throw Error("History.js Core has already been loaded...");
	s.init = function() {
		return "undefined" == typeof s.Adapter ? !1 : ("undefined" != typeof s.initCore && s.initCore(), "undefined" != typeof s.initHtml4 && s.initHtml4(), !0)
	};
	s.initCore = function() {
		if ("undefined" != typeof s.initCore.initialized) return ! 1;
		s.initCore.initialized = !0;
		s.options = s.options || {};
		s.options.hashChangeInterval = s.options.hashChangeInterval || 100;
		s.options.safariPollInterval = s.options.safariPollInterval || 500;
		s.options.doubleCheckInterval = s.options.doubleCheckInterval || 500;
		s.options.storeInterval = s.options.storeInterval || 1E3;
		s.options.busyDelay = s.options.busyDelay || 250;
		s.options.debug = s.options.debug || !1;
		s.options.initialTitle = s.options.initialTitle || g.title;
		s.intervalList = [];
		s.clearAllIntervals = function() {
			var a, d = s.intervalList;
			if ("undefined" != typeof d && null !== d) {
				for (a = 0; a < d.length; a++) o(d[a]);
				s.intervalList = null
			}
		};
		s.debug = function() {
			s.options.debug && s.log.apply(s, arguments)
		};
		s.log = function() {
			var a = "undefined" != typeof d && "undefined" != typeof d.log && "undefined" != typeof d.log.apply,
			e = g.getElementById("log"),
			j,
			k,
			m,
			n;
			a ? (k = Array.prototype.slice.call(arguments), j = k.shift(), "undefined" != typeof d.debug ? d.debug.apply(d, [j, k]) : d.log.apply(d, [j, k])) : j = "\n" + arguments[0] + "\n";
			k = 1;
			for (m = arguments.length; k < m; ++k) {
				n = arguments[k];
				if ("object" == typeof n && "undefined" != typeof r) try {
					n = r.stringify(n)
				} catch(l) {}
				j += "\n" + n + "\n"
			}
			return e ? (e.value += j + "\n-----\n", e.scrollTop = e.scrollHeight - e.clientHeight) : a || u(j),
			!0
		};
		s.getInternetExplorerMajorVersion = function() {
			var a = s.getInternetExplorerMajorVersion,
			d;
			if ("undefined" != typeof s.getInternetExplorerMajorVersion.cached) d = s.getInternetExplorerMajorVersion.cached;
			else {
				d = 3;
				for (var e = g.createElement("div"), j = e.getElementsByTagName("i"); (e.innerHTML = "\x3c!--[if gt IE " + ++d + "]\x3e\x3ci\x3e\x3c/i\x3e\x3c![endif]--\x3e") && j[0];);
				d = 4 < d ? d: !1
			}
			return a.cached = d
		};
		s.isInternetExplorer = function() {
			return s.isInternetExplorer.cached = "undefined" != typeof s.isInternetExplorer.cached ? s.isInternetExplorer.cached: Boolean(s.getInternetExplorerMajorVersion())
		};
		s.emulated = {
			pushState: !Boolean(a.history && a.history.pushState && a.history.replaceState && !/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(j.userAgent) && !/AppleWebKit\/5([0-2]|3[0-2])/i.test(j.userAgent)),
			hashChange: Boolean(!("onhashchange" in a || "onhashchange" in g) || s.isInternetExplorer() && 8 > s.getInternetExplorerMajorVersion())
		};
		s.enabled = !s.emulated.pushState;
		s.bugs = {
			setHash: Boolean(!s.emulated.pushState && "Apple Computer, Inc." === j.vendor && /AppleWebKit\/5([0-2]|3[0-3])/.test(j.userAgent)),
			safariPoll: Boolean(!s.emulated.pushState && "Apple Computer, Inc." === j.vendor && /AppleWebKit\/5([0-2]|3[0-3])/.test(j.userAgent)),
			ieDoubleCheck: Boolean(s.isInternetExplorer() && 8 > s.getInternetExplorerMajorVersion()),
			hashEscape: Boolean(s.isInternetExplorer() && 7 > s.getInternetExplorerMajorVersion())
		};
		s.isEmptyObject = function(a) {
			for (var d in a) return ! 1;
			return ! 0
		};
		s.cloneObject = function(a) {
			var d, e;
			return a ? (d = r.stringify(a), e = r.parse(d)) : e = {},
			e
		};
		s.getRootUrl = function() {
			var a = g.location.protocol + "//" + (g.location.hostname || g.location.host);
			g.location.port && (a += ":" + g.location.port);
			return a += "/",
			a
		};
		s.getBaseHref = function() {
			var a = g.getElementsByTagName("base"),
			d = "";
			return 1 === a.length && (d = null.href.replace(/[^\/]+$/, "")),
			d = d.replace(/\/+$/, ""),
			d && (d += "/"),
			d
		};
		s.getBaseUrl = function() {
			return s.getBaseHref() || s.getBasePageUrl() || s.getRootUrl()
		};
		s.getPageUrl = function() {
			var a;
			return a = ((s.getState(!1, !1) || {}).url || g.location.href).replace(/\/+$/, "").replace(/[^\/]+$/,
			function(a) {
				return /\./.test(a) ? a: a + "/"
			}),
			a
		};
		s.getBasePageUrl = function() {
			return g.location.href.replace(/[#\?].*/, "").replace(/[^\/]+$/,
			function(a) {
				return /[^\/]$/.test(a) ? "": a
			}).replace(/\/+$/, "") + "/"
		};
		s.getFullUrl = function(a, d) {
			var e = a,
			g = a.substring(0, 1);
			return d = "undefined" == typeof d ? !0 : d,
			/[a-z]+\:\/\//.test(a) || ("/" === g ? e = s.getRootUrl() + a.replace(/^\/+/, "") : "#" === g ? e = s.getPageUrl().replace(/#.*/, "") + a: "?" === g ? e = s.getPageUrl().replace(/[\?#].*/, "") + a: d ? e = s.getBaseUrl() + a.replace(/^(\.\/)+/, "") : e = s.getBasePageUrl() + a.replace(/^(\.\/)+/, "")),
			e.replace(/\#$/, "")
		};
		s.getShortUrl = function(a) {
			var d = s.getBaseUrl(),
			e = s.getRootUrl();
			return s.emulated.pushState && (a = a.replace(d, "")),
			a = a.replace(e, "/"),
			s.isTraditionalAnchor(a) && (a = "./" + a),
			a = a.replace(/^(\.\/)+/g, "./").replace(/\#$/, ""),
			a
		};
		s.store = {};
		s.idToState = s.idToState || {};
		s.stateToId = s.stateToId || {};
		s.urlToId = s.urlToId || {};
		s.storedStates = s.storedStates || [];
		s.savedStates = s.savedStates || [];
		s.normalizeStore = function() {
			s.store.idToState = s.store.idToState || {};
			s.store.urlToId = s.store.urlToId || {};
			s.store.stateToId = s.store.stateToId || {}
		};
		s.getState = function(a, d) {
			"undefined" == typeof a && (a = !0);
			"undefined" == typeof d && (d = !0);
			var e = s.getLastSavedState();
			return ! e && d && (e = s.createStateObject()),
			a && (e = s.cloneObject(e), e.url = e.cleanUrl || e.url),
			e
		};
		s.getIdByState = function(a) {
			var d = s.extractId(a.url),
			e;
			if (!d) if (e = s.getStateString(a), "undefined" != typeof s.stateToId[e]) d = s.stateToId[e];
			else if ("undefined" != typeof s.store.stateToId[e]) d = s.store.stateToId[e];
			else {
				for (; ! (d = (new Date).getTime() + String(Math.random()).replace(/\D/g, ""), "undefined" == typeof s.idToState[d] && "undefined" == typeof s.store.idToState[d]););
				s.stateToId[e] = d;
				s.idToState[d] = a
			}
			return d
		};
		s.normalizeState = function(a) {
			var d;
			if (!a || "object" != typeof a) a = {};
			if ("undefined" != typeof a.normalized) return a;
			if (!a.data || "object" != typeof a.data) a.data = {};
			d = {
				normalized: !0
			};
			d.title = a.title || "";
			d.url = s.getFullUrl(s.unescapeString(a.url || g.location.href));
			d.hash = s.getShortUrl(d.url);
			d.data = s.cloneObject(a.data);
			d.id = s.getIdByState(d);
			d.cleanUrl = d.url.replace(/\??\&_suid.*/, "");
			d.url = d.cleanUrl;
			a = !s.isEmptyObject(d.data);
			if (d.title || a) d.hash = s.getShortUrl(d.url).replace(/\??\&_suid.*/, ""),
			/\?/.test(d.hash) || (d.hash += "?"),
			d.hash += "\x26_suid\x3d" + d.id;
			return d.hashedUrl = s.getFullUrl(d.hash),
			(s.emulated.pushState || s.bugs.safariPoll) && s.hasUrlDuplicate(d) && (d.url = d.hashedUrl),
			d
		};
		s.createStateObject = function(a, d, e) {
			a = {
				data: a,
				title: d,
				url: e
			};
			return a = s.normalizeState(a),
			a
		};
		s.getStateById = function(a) {
			a = String(a);
			return s.idToState[a] || s.store.idToState[a] || e
		};
		s.getStateString = function(a) {
			var d, e, g;
			return d = s.normalizeState(a),
			e = {
				data: d.data,
				title: a.title,
				url: a.url
			},
			g = r.stringify(e),
			g
		};
		s.getStateId = function(a) {
			var d, e;
			return d = s.normalizeState(a),
			e = d.id,
			e
		};
		s.getHashByState = function(a) {
			var d, e;
			return d = s.normalizeState(a),
			e = d.hash,
			e
		};
		s.extractId = function(a) {
			var d, e;
			return e = /(.*)\&_suid=([0-9]+)$/.exec(a),
			d = e ? String(e[2] || "") : "",
			d || !1
		};
		s.isTraditionalAnchor = function(a) {
			return ! /[\/\?\.]/.test(a)
		};
		s.extractState = function(a, d) {
			var e = null,
			g, j;
			return d = d || !1,
			g = s.extractId(a),
			g && (e = s.getStateById(g)),
			e || (j = s.getFullUrl(a), g = s.getIdByUrl(j) || !1, g && (e = s.getStateById(g)), !e && d && !s.isTraditionalAnchor(a) && (e = s.createStateObject(null, null, j))),
			e
		};
		s.getIdByUrl = function(a) {
			return s.urlToId[a] || s.store.urlToId[a] || e
		};
		s.getLastSavedState = function() {
			return s.savedStates[s.savedStates.length - 1] || e
		};
		s.getLastStoredState = function() {
			return s.storedStates[s.storedStates.length - 1] || e
		};
		s.hasUrlDuplicate = function(a) {
			var d = !1,
			e;
			return e = s.extractState(a.url),
			d = e && e.id !== a.id,
			d
		};
		s.storeState = function(a) {
			return s.urlToId[a.url] = a.id,
			s.storedStates.push(s.cloneObject(a)),
			a
		};
		s.isLastSavedState = function() {
			return s.savedStates.length && s.getLastSavedState(),
			!1
		};
		s.saveState = function(a) {
			return s.isLastSavedState(a) ? !1 : (s.savedStates.push(s.cloneObject(a)), !0)
		};
		s.getStateByIndex = function(a) {
			return null
		};
		s.getHash = function() {
			return s.unescapeHash(g.location.hash)
		};
		s.unescapeString = function(d) {
			for (var e;;) {
				e = a.unescape(d);
				if (e === d) break;
				d = e
			}
			return d
		};
		s.unescapeHash = function(a) {
			a = s.normalizeHash(a);
			return a = s.unescapeString(a),
			a
		};
		s.normalizeHash = function(a) {
			return a.replace(/[^#]*#/, "").replace(/#.*/, "")
		};
		s.setHash = function(a, d) {
			var e, j, k;
			return ! 1 !== d && s.busy() ? (s.pushQueue({
				scope: s,
				callback: s.setHash,
				args: arguments,
				queue: d
			}), !1) : (e = s.escapeHash(a), s.busy(!0), j = s.extractState(a, !0), j && !s.emulated.pushState ? s.pushState(j.data, j.title, j.url, !1) : g.location.hash !== e && (s.bugs.setHash ? (k = s.getPageUrl(), s.pushState(null, null, k + "#" + e, !1)) : g.location.hash = e), s)
		};
		s.escapeHash = function(d) {
			d = s.normalizeHash(d);
			return d = a.escape(d),
			s.bugs.hashEscape || (d = d.replace(/\%21/g, "!").replace(/\%26/g, "\x26").replace(/\%3D/g, "\x3d").replace(/\%3F/g, "?")),
			d
		};
		s.getHashByUrl = function(a) {
			a = String(a).replace(/([^#]*)#?([^#]*)#?(.*)/, "$2");
			return a = s.unescapeHash(a),
			a
		};
		s.setTitle = function(a) {
			var d = a.title,
			e;
			d || (e = s.getStateByIndex(0), e && e.url === a.url && (d = e.title || s.options.initialTitle));
			try {
				g.getElementsByTagName("title")[0].innerHTML = d.replace("\x3c", "\x26lt;").replace("\x3e", "\x26gt;").replace(" \x26 ", " \x26amp; ")
			} catch(j) {}
			return g.title = d,
			s
		};
		s.queues = [];
		s.busy = function(a) {
			"undefined" != typeof a ? s.busy.flag = a: "undefined" == typeof s.busy.flag && (s.busy.flag = !1);
			if (!s.busy.flag) {
				m(s.busy.timeout);
				var d = function() {
					var a, e;
					if (!s.busy.flag) for (a = s.queues.length - 1; 0 <= a; --a) e = s.queues[a],
					0 !== e.length && (e = e.shift(), s.fireQueueItem(e), s.busy.timeout = l(d, s.options.busyDelay))
				};
				s.busy.timeout = l(d, s.options.busyDelay)
			}
			return s.busy.flag
		};
		s.busy.flag = !1;
		s.fireQueueItem = function(a) {
			return a.callback.apply(a.scope || s, a.args || [])
		};
		s.pushQueue = function(a) {
			return s.queues[a.queue || 0] = s.queues[a.queue || 0] || [],
			s.queues[a.queue || 0].push(a),
			s
		};
		s.queue = function(a, d) {
			return "function" == typeof a && (a = {
				callback: a
			}),
			"undefined" != typeof d && (a.queue = d),
			s.busy() ? s.pushQueue(a) : s.fireQueueItem(a),
			s
		};
		s.clearQueue = function() {
			return s.busy.flag = !1,
			s.queues = [],
			s
		};
		s.stateChanged = !1;
		s.doubleChecker = !1;
		s.doubleCheckComplete = function() {
			return s.stateChanged = !0,
			s.doubleCheckClear(),
			s
		};
		s.doubleCheckClear = function() {
			return s.doubleChecker && (m(s.doubleChecker), s.doubleChecker = !1),
			s
		};
		s.doubleCheck = function(a) {
			return s.stateChanged = !1,
			s.doubleCheckClear(),
			s.bugs.ieDoubleCheck && (s.doubleChecker = l(function() {
				return s.doubleCheckClear(),
				s.stateChanged || a(),
				!0
			},
			s.options.doubleCheckInterval)),
			s
		};
		s.safariStatePoll = function() {
			var d = s.extractState(g.location.href);
			if (!s.isLastSavedState(d)) return d || s.createStateObject(),
			s.Adapter.trigger(a, "popstate"),
			s
		};
		s.back = function(a) {
			return ! 1 !== a && s.busy() ? (s.pushQueue({
				scope: s,
				callback: s.back,
				args: arguments,
				queue: a
			}), !1) : (s.busy(!0), s.doubleCheck(function() {
				s.back(!1)
			}), B.go( - 1), !0)
		};
		s.forward = function(a) {
			return ! 1 !== a && s.busy() ? (s.pushQueue({
				scope: s,
				callback: s.forward,
				args: arguments,
				queue: a
			}), !1) : (s.busy(!0), s.doubleCheck(function() {
				s.forward(!1)
			}), B.go(1), !0)
		};
		s.go = function(a, d) {
			var e;
			if (0 < a) for (e = 1; e <= a; ++e) s.forward(d);
			else {
				if (! (0 > a)) throw Error("History.go: History.go requires a positive or negative integer passed.");
				for (e = -1; e >= a; --e) s.back(d)
			}
			return s
		};
		if (s.emulated.pushState) {
			var z = function() {};
			s.pushState = s.pushState || z;
			s.replaceState = s.replaceState || z
		} else s.onPopState = function(d, e) {
			var j = !1,
			k = !1,
			m, n;
			return s.doubleCheckComplete(),
			m = s.getHash(),
			m ? (n = s.extractState(m || g.location.href, !0), n ? s.replaceState(n.data, n.title, n.url, !1) : (s.Adapter.trigger(a, "anchorchange"), s.busy(!1)), s.expectedStateId = !1, !1) : (j = s.Adapter.extractEventData("state", d, e) || !1, j ? k = s.getStateById(j) : s.expectedStateId ? k = s.getStateById(s.expectedStateId) : k = s.extractState(g.location.href), k || (k = s.createStateObject(null, null, g.location.href)), s.expectedStateId = !1, s.isLastSavedState(k) ? (s.busy(!1), !1) : (s.storeState(k), s.saveState(k), s.setTitle(k), s.Adapter.trigger(a, "statechange"), s.busy(!1), !0))
		},
		s.Adapter.bind(a, "popstate", s.onPopState),
		s.pushState = function(d, e, g, j) {
			if (s.getHashByUrl(g) && s.emulated.pushState) throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
			if (!1 !== j && s.busy()) return s.pushQueue({
				scope: s,
				callback: s.pushState,
				args: arguments,
				queue: j
			}),
			!1;
			s.busy(!0);
			var k = s.createStateObject(d, e, g);
			return s.isLastSavedState(k) ? s.busy(!1) : (s.storeState(k), s.expectedStateId = k.id, B.pushState(k.id, k.title, k.url), s.Adapter.trigger(a, "popstate")),
			!0
		},
		s.replaceState = function(d, e, g, j) {
			if (s.getHashByUrl(g) && s.emulated.pushState) throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
			if (!1 !== j && s.busy()) return s.pushQueue({
				scope: s,
				callback: s.replaceState,
				args: arguments,
				queue: j
			}),
			!1;
			s.busy(!0);
			var k = s.createStateObject(d, e, g);
			return s.isLastSavedState(k) ? s.busy(!1) : (s.storeState(k), s.expectedStateId = k.id, B.replaceState(k.id, k.title, k.url), s.Adapter.trigger(a, "popstate")),
			!0
		};
		if (k) try {
			s.store = r.parse(k.getItem("History.store")) || {}
		} catch(v) {
			s.store = {}
		} else s.store = {};
		s.normalizeStore();
		s.Adapter.bind(a, "beforeunload", s.clearAllIntervals);
		s.Adapter.bind(a, "unload", s.clearAllIntervals);
		s.saveState(s.storeState(s.extractState(g.location.href, !0)));
		k && (s.onUnload = function() {
			var a, d;
			try {
				a = r.parse(k.getItem("History.store")) || {}
			} catch(e) {
				a = {}
			}
			a.idToState = a.idToState || {};
			a.urlToId = a.urlToId || {};
			a.stateToId = a.stateToId || {};
			for (d in s.idToState) s.idToState.hasOwnProperty(d) && (a.idToState[d] = s.idToState[d]);
			for (d in s.urlToId) s.urlToId.hasOwnProperty(d) && (a.urlToId[d] = s.urlToId[d]);
			for (d in s.stateToId) s.stateToId.hasOwnProperty(d) && (a.stateToId[d] = s.stateToId[d]);
			s.store = a;
			s.normalizeStore();
			k.setItem("History.store", r.stringify(a))
		},
		s.intervalList.push(n(s.onUnload, s.options.storeInterval)), s.Adapter.bind(a, "beforeunload", s.onUnload), s.Adapter.bind(a, "unload", s.onUnload));
		if (!s.emulated.pushState && (s.bugs.safariPoll && s.intervalList.push(n(s.safariStatePoll, s.options.safariPollInterval)), "Apple Computer, Inc." === j.vendor || "Mozilla" === (j.appCodeName || ""))) s.Adapter.bind(a, "hashchange",
		function() {
			s.Adapter.trigger(a, "popstate")
		}),
		s.getHash() && s.Adapter.onDomLoad(function() {
			s.Adapter.trigger(a, "hashchange")
		})
	};
	s.init()
})(window);
var Opentip, firstAdapter, i, position, vendors, _i, _len, _ref, __slice = [].slice,
__indexOf = [].indexOf ||
function(a) {
	for (var e = 0,
	d = this.length; e < d; e++) if (e in this && this[e] === a) return e;
	return - 1
},
__hasProp = {}.hasOwnProperty;
Opentip = function() {
	function a(e, d, g, j) {
		var k, l, m = this;
		this.id = ++a.lastId;
		this.debug("Creating Opentip.");
		a.tips.push(this);
		this.adapter = a.adapter;
		k = this.adapter.data(e, "opentips") || [];
		k.push(this);
		this.adapter.data(e, "opentips", k);
		this.triggerElement = this.adapter.wrap(e);
		if (1 < this.triggerElement.length) throw Error("You can't call Opentip on multiple elements.");
		if (1 > this.triggerElement.length) throw Error("Invalid element.");
		this.waitingToHide = this.waitingToShow = this.visible = this.loading = this.loaded = !1;
		this.currentPosition = {
			left: 0,
			top: 0
		};
		this.dimensions = {
			width: 100,
			height: 50
		};
		this.content = "";
		this.redraw = !0;
		this.currentObservers = {
			showing: !1,
			visible: !1,
			hiding: !1,
			hidden: !1
		};
		j = this.adapter.clone(j);
		"object" === typeof d ? (j = d, d = g = void 0) : "object" === typeof g && (j = g, g = void 0);
		null != g && (j.title = g);
		null != d && this.setContent(d);
		null == j["extends"] && (j["extends"] = null != j.style ? j.style: a.defaultStyle);
		e = [j];
		for (d = j; d["extends"];) {
			j = d["extends"];
			d = a.styles[j];
			if (null == d) throw Error("Invalid style: " + j);
			e.unshift(d);
			null != d["extends"] || "standard" === j || (d["extends"] = "standard")
		}
		e = j = (l = this.adapter).extend.apply(l, [{}].concat(__slice.call(e)));
		var n;
		k = j.hideTriggers;
		n = [];
		d = 0;
		for (g = k.length; d < g; d++) l = k[d],
		n.push(l);
		e.hideTriggers = n;
		j.hideTrigger && 0 === j.hideTriggers.length && j.hideTriggers.push(j.hideTrigger);
		g = ["tipJoint", "targetJoint", "stem"];
		e = 0;
		for (d = g.length; e < d; e++) l = g[e],
		j[l] && "string" === typeof j[l] && (j[l] = new a.Joint(j[l]));
		if (j.ajax && (!0 === j.ajax || !j.ajax)) j.ajax = "A" === this.adapter.tagName(this.triggerElement) ? this.adapter.attr(this.triggerElement, "href") : !1;
		"click" === j.showOn && "A" === this.adapter.tagName(this.triggerElement) && this.adapter.observe(this.triggerElement, "click",
		function(a) {
			a.preventDefault();
			a.stopPropagation();
			return a.stopped = !0
		});
		j.target && (j.fixed = !0); ! 0 === j.stem && (j.stem = new a.Joint(j.tipJoint)); ! 0 === j.target ? j.target = this.triggerElement: j.target && (j.target = this.adapter.wrap(j.target));
		this.currentStem = j.stem;
		null == j.delay && (j.delay = "mouseover" === j.showOn ? 0.2 : 0);
		null == j.targetJoint && (j.targetJoint = (new a.Joint(j.tipJoint)).flip());
		this.showTriggers = [];
		this.showTriggersWhenVisible = [];
		this.hideTriggers = [];
		j.showOn && "creation" !== j.showOn && this.showTriggers.push({
			element: this.triggerElement,
			event: j.showOn
		});
		this.options = j;
		this.adapter.domReady(function() {
			return m._init()
		})
	}
	a.prototype.STICKS_OUT_TOP = 1;
	a.prototype.STICKS_OUT_BOTTOM = 2;
	a.prototype.STICKS_OUT_LEFT = 1;
	a.prototype.STICKS_OUT_RIGHT = 2;
	a.prototype["class"] = {
		container: "opentip-container",
		opentip: "opentip",
		content: "content",
		loadingIndicator: "loading-indicator",
		close: "close",
		goingToHide: "going-to-hide",
		hidden: "hidden",
		hiding: "hiding",
		goingToShow: "going-to-show",
		showing: "showing",
		visible: "visible",
		loading: "loading",
		ajaxError: "ajax-error",
		fixed: "fixed",
		showEffectPrefix: "show-effect-",
		hideEffectPrefix: "hide-effect-",
		stylePrefix: "style-"
	};
	a.prototype._init = function() {
		var a, d, g, j, k, l, m = this;
		this._buildContainer();
		l = this.options.hideTriggers;
		a = j = 0;
		for (k = l.length; j < k; a = ++j) {
			d = l[a];
			g = null;
			a = this.options.hideOn instanceof Array ? this.options.hideOn[a] : this.options.hideOn;
			if ("string" === typeof d) switch (d) {
			case "trigger":
				a = a || "mouseout";
				g = this.triggerElement;
				break;
			case "tip":
				a = a || "mouseover";
				g = this.container;
				break;
			case "target":
				a = a || "mouseover";
				g = this.options.target;
				break;
			case "closeButton":
				break;
			default:
				throw Error("Unknown hide trigger: " + d + ".");
			} else a = a || "mouseover",
			g = this.adapter.wrap(d);
			g && this.hideTriggers.push({
				element: g,
				event: a,
				original: d
			})
		}
		k = this.hideTriggers;
		g = 0;
		for (j = k.length; g < j; g++) d = k[g],
		this.showTriggersWhenVisible.push({
			element: d.element,
			event: "mouseover"
		});
		this.bound = {};
		k = ["prepareToShow", "prepareToHide", "show", "hide", "reposition"];
		g = 0;
		for (j = k.length; g < j; g++) d = k[g],
		this.bound[d] = function(a) {
			return function() {
				return m[a].apply(m, arguments)
			}
		} (d);
		this.activate();
		if ("creation" === this.options.showOn) return this.prepareToShow()
	};
	a.prototype._buildContainer = function() {
		this.container = this.adapter.create('\x3cdiv id\x3d"opentip-' + this.id + '" class\x3d"' + this["class"].container + " " + this["class"].hidden + " " + this["class"].stylePrefix + this.options.className + '"\x3e\x3c/div\x3e');
		this.adapter.css(this.container, {
			position: "absolute"
		});
		this.options.ajax && this.adapter.addClass(this.container, this["class"].loading);
		this.options.fixed && this.adapter.addClass(this.container, this["class"].fixed);
		this.options.showEffect && this.adapter.addClass(this.container, "" + this["class"].showEffectPrefix + this.options.showEffect);
		if (this.options.hideEffect) return this.adapter.addClass(this.container, "" + this["class"].hideEffectPrefix + this.options.hideEffect)
	};
	a.prototype._buildElements = function() {
		var a, d;
		this.tooltipElement = this.adapter.create('\x3cdiv class\x3d"' + this["class"].opentip + '"\x3e\x3cdiv class\x3d"header"\x3e\x3c/div\x3e\x3cdiv class\x3d"' + this["class"].content + '"\x3e\x3c/div\x3e\x3c/div\x3e');
		this.backgroundCanvas = this.adapter.wrap(document.createElement("canvas"));
		this.adapter.css(this.backgroundCanvas, {
			position: "absolute"
		});
		"undefined" !== typeof G_vmlCanvasManager && null !== G_vmlCanvasManager && G_vmlCanvasManager.initElement(this.adapter.unwrap(this.backgroundCanvas));
		a = this.adapter.find(this.tooltipElement, ".header");
		this.options.title && (d = this.adapter.create("\x3ch1\x3e\x3c/h1\x3e"), this.adapter.update(d, this.options.title, this.options.escapeTitle), this.adapter.append(a, d));
		this.options.ajax && this.adapter.append(this.tooltipElement, this.adapter.create('\x3cdiv class\x3d"' + this["class"].loadingIndicator + '"\x3e\x3cspan\x3eLoading...\x3c/span\x3e\x3c/div\x3e'));
		0 <= __indexOf.call(this.options.hideTriggers, "closeButton") && (this.closeButtonElement = this.adapter.create('\x3ca href\x3d"javascript:undefined;" class\x3d"' + this["class"].close + '"\x3e\x3cspan\x3eClose\x3c/span\x3e\x3c/a\x3e'), this.adapter.append(a, this.closeButtonElement));
		this.adapter.append(this.container, this.backgroundCanvas);
		this.adapter.append(this.container, this.tooltipElement);
		return this.adapter.append(document.body, this.container)
	};
	a.prototype.setContent = function(a) {
		this.content = a;
		if (this.visible) return this._updateElementContent()
	};
	a.prototype._updateElementContent = function() {
		var a;
		a = this.adapter.find(this.container, ".content");
		null != a && ("function" === typeof this.content && (this.debug("Executing content function."), this.content = this.content(this)), this.adapter.update(a, this.content, this.options.escapeContent));
		this._storeAndLockDimensions();
		return this.reposition()
	};
	a.prototype._storeAndLockDimensions = function() {
		var a;
		a = this.dimensions;
		this.adapter.css(this.container, {
			width: "auto",
			left: "0px",
			top: "0px"
		});
		this.dimensions = this.adapter.dimensions(this.container);
		this.dimensions.width += 1;
		this.adapter.css(this.container, {
			width: "" + this.dimensions.width + "px",
			top: "" + this.currentPosition.top + "px",
			left: "" + this.currentPosition.left + "px"
		});
		if (!this._dimensionsEqual(this.dimensions, a)) return this.redraw = !0,
		this._draw()
	};
	a.prototype.activate = function() {
		return this._setupObservers("-showing", "-visible", "hidden", "hiding")
	};
	a.prototype.deactivate = function() {
		this.debug("Deactivating tooltip.");
		return this.hide()
	};
	a.prototype._setupObservers = function() {
		var a, d, g, j, k, l, m, n, o, r = this;
		j = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
		k = 0;
		for (m = j.length; k < m; k++) if (g = j[k], d = !1, "-" === g.charAt(0) && (d = !0, g = g.substr(1)), this.currentObservers[g] !== !d) switch (this.currentObservers[g] = !d, a = function() {
			var a, e, g;
			a = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
			return d ? (e = r.adapter).stopObserving.apply(e, a) : (g = r.adapter).observe.apply(g, a)
		},
		g) {
		case "showing":
			o = this.hideTriggers;
			l = 0;
			for (n = o.length; l < n; l++) g = o[l],
			a(g.element, g.event, this.bound.prepareToHide);
			a(null != document.onresize ? document: window, "resize", this.bound.reposition);
			a(window, "scroll", this.bound.reposition);
			break;
		case "visible":
			o = this.showTriggersWhenVisible;
			l = 0;
			for (n = o.length; l < n; l++) g = o[l],
			a(g.element, g.event, this.bound.prepareToShow);
			break;
		case "hiding":
			o = this.showTriggers;
			l = 0;
			for (n = o.length; l < n; l++) g = o[l],
			a(g.element, g.event, this.bound.prepareToShow);
			break;
		case "hidden":
			break;
		default:
			throw Error("Unknown state: " + g);
		}
		return null
	};
	a.prototype.prepareToShow = function() {
		this._abortHiding();
		this._abortShowing();
		if (!this.visible) return this.debug("Showing in " + this.options.delay + "s."),
		this.options.group && a._abortShowingGroup(this.options.group, this),
		this.preparingToShow = !0,
		this._setupObservers("-hidden", "-hiding", "showing"),
		this._followMousePosition(),
		this.reposition(),
		this._showTimeoutId = this.setTimeout(this.bound.show, this.options.delay || 0)
	};
	a.prototype.show = function() {
		var e = this;
		this._abortHiding();
		this._clearTimeouts();
		if (!this.visible) {
			if (!this._triggerElementExists()) return this.deactivate();
			this.debug("Showing now.");
			this.options.group && a._hideGroup(this.options.group, this);
			this.visible = !0;
			this.preparingToShow = !1;
			null == this.tooltipElement && this._buildElements();
			this._updateElementContent();
			this.options.ajax && (!this.loaded || !this.options.ajaxCache) && this._loadAjax();
			this._searchAndActivateCloseButtons();
			this._startEnsureTriggerElement();
			this.adapter.css(this.container, {
				zIndex: a.lastZIndex++
			});
			this._setupObservers("-hidden", "-hiding", "-showing", "-visible", "showing", "visible");
			this.reposition();
			this.adapter.removeClass(this.container, this["class"].hiding);
			this.adapter.removeClass(this.container, this["class"].hidden);
			this.adapter.addClass(this.container, this["class"].goingToShow);
			this.setCss3Style(this.container, {
				transitionDuration: "0s"
			});
			this.defer(function() {
				var a;
				e.adapter.removeClass(e.container, e["class"].goingToShow);
				e.adapter.addClass(e.container, e["class"].showing);
				a = 0;
				e.options.showEffect && e.options.showEffectDuration && (a = e.options.showEffectDuration);
				e.setCss3Style(e.container, {
					transitionDuration: "" + a + "s"
				});
				e._visibilityStateTimeoutId = e.setTimeout(function() {
					e.adapter.removeClass(e.container, e["class"].showing);
					return e.adapter.addClass(e.container, e["class"].visible)
				},
				a);
				return e._activateFirstInput()
			});
			return this._draw()
		}
	};
	a.prototype._abortShowing = function() {
		if (this.preparingToShow) return this.debug("Aborting showing."),
		this._clearTimeouts(),
		this._stopFollowingMousePosition(),
		this.preparingToShow = !1,
		this._setupObservers("-showing", "-visible", "hiding", "hidden")
	};
	a.prototype.prepareToHide = function() {
		this._abortShowing();
		this._abortHiding();
		if (this.visible) return this.debug("Hiding in " + this.options.hideDelay + "s"),
		this.preparingToHide = !0,
		this._setupObservers("-showing", "visible", "-hidden", "hiding"),
		this._hideTimeoutId = this.setTimeout(this.bound.hide, this.options.hideDelay)
	};
	a.prototype.hide = function() {
		var a = this;
		this._abortShowing();
		this._clearTimeouts();
		if (this.visible) return this.debug("Hiding!"),
		this.preparingToHide = this.visible = !1,
		this._stopEnsureTriggerElement(),
		this._setupObservers("-showing", "-visible", "-hiding", "-hidden", "hiding", "hidden"),
		this.options.fixed || this._stopFollowingMousePosition(),
		this.adapter.removeClass(this.container, this["class"].visible),
		this.adapter.removeClass(this.container, this["class"].showing),
		this.adapter.addClass(this.container, this["class"].goingToHide),
		this.setCss3Style(this.container, {
			transitionDuration: "0s"
		}),
		this.defer(function() {
			var d;
			a.adapter.removeClass(a.container, a["class"].goingToHide);
			a.adapter.addClass(a.container, a["class"].hiding);
			d = 0;
			a.options.hideEffect && a.options.hideEffectDuration && (d = a.options.hideEffectDuration);
			a.setCss3Style(a.container, {
				transitionDuration: "" + d + "s"
			});
			return a._visibilityStateTimeoutId = a.setTimeout(function() {
				a.adapter.removeClass(a.container, a["class"].hiding);
				a.adapter.addClass(a.container, a["class"].hidden);
				return a.setCss3Style(a.container, {
					transitionDuration: "0s"
				})
			},
			d)
		})
	};
	a.prototype._abortHiding = function() {
		if (this.preparingToHide) return this.debug("Aborting hiding."),
		this._clearTimeouts(),
		this.preparingToHide = !1,
		this._setupObservers("-hiding", "showing", "visible")
	};
	a.prototype.reposition = function(a) {
		var d, g, j = this;
		null == a && (a = this.lastEvent);
		d = this.getPosition(a);
		if (null != d && (g = this.options.stem, this.options.containInViewport && (a = this._ensureViewportContainment(a, d), d = a.position, g = a.stem), !this._positionsEqual(d, this.currentPosition))) return this.options.stem && !g.eql(this.currentStem) && (this.redraw = !0),
		this.currentPosition = d,
		this.currentStem = g,
		this._draw(),
		this.adapter.css(this.container, {
			left: "" + d.left + "px",
			top: "" + d.top + "px"
		}),
		this.defer(function() {
			var a;
			a = j.adapter.unwrap(j.container);
			a.style.visibility = "hidden";
			return a.style.visibility = "visible"
		})
	};
	a.prototype.getPosition = function(a, d, g, j) {
		var k, l, m;
		null == d && (d = this.options.tipJoint);
		null == g && (g = this.options.targetJoint);
		if (this.options.target) a = this.adapter.offset(this.options.target),
		l = this.adapter.dimensions(this.options.target),
		g.right ? (m = this.adapter.unwrap(this.options.target), a.left = null != m.getBoundingClientRect ? m.getBoundingClientRect().right + (null != (k = window.pageXOffset) ? k: document.body.scrollLeft) : a.left + l.width) : g.center && (a.left += Math.round(l.width / 2)),
		g.bottom ? a.top += l.height: g.middle && (a.top += Math.round(l.height / 2)),
		this.options.borderWidth && (this.options.tipJoint.left && (a.left += this.options.borderWidth), this.options.tipJoint.right && (a.left -= this.options.borderWidth), this.options.tipJoint.top ? a.top += this.options.borderWidth: this.options.tipJoint.bottom && (a.top -= this.options.borderWidth));
		else {
			null != a && (this.lastEvent = a);
			a = this.adapter.mousePosition(a);
			if (null == a) return;
			a = {
				top: a.y,
				left: a.x
			}
		}
		this.options.autoOffset && (l = (m = this.options.stem ? this.options.stemLength: 0) && this.options.fixed ? 2 : 10, g = d.middle && !this.options.fixed ? 15 : 0, k = d.center && !this.options.fixed ? 15 : 0, d.right ? a.left -= l + g: d.left && (a.left += l + g), d.bottom ? a.top -= l + k: d.top && (a.top += l + k), m && (null == j && (j = this.options.stem), j.right ? a.left -= m: j.left && (a.left += m), j.bottom ? a.top -= m: j.top && (a.top += m)));
		a.left += this.options.offset[0];
		a.top += this.options.offset[1];
		d.right ? a.left -= this.dimensions.width: d.center && (a.left -= Math.round(this.dimensions.width / 2));
		d.bottom ? a.top -= this.dimensions.height: d.middle && (a.top -= Math.round(this.dimensions.height / 2));
		return a
	};
	a.prototype._ensureViewportContainment = function(e, d) {
		var g, j, k, l, m, n, o, r;
		m = this.options.stem;
		j = {
			position: d,
			stem: m
		};
		if (!this.visible || !d) return j;
		n = this._sticksOut(d);
		if (!n[0] && !n[1]) return j;
		r = new a.Joint(this.options.tipJoint);
		this.options.targetJoint && (o = new a.Joint(this.options.targetJoint));
		this.adapter.scrollOffset();
		k = this.adapter.viewportDimensions();
		g = !1;
		if (k.width >= this.dimensions.width && n[0]) switch (g = !0, n[0]) {
		case this.STICKS_OUT_LEFT:
			r.setHorizontal("left");
			this.options.targetJoint && o.setHorizontal("right");
			break;
		case this.STICKS_OUT_RIGHT:
			r.setHorizontal("right"),
			this.options.targetJoint && o.setHorizontal("left")
		}
		if (k.height >= this.dimensions.height && n[1]) switch (g = !0, n[1]) {
		case this.STICKS_OUT_TOP:
			r.setVertical("top");
			this.options.targetJoint && o.setVertical("bottom");
			break;
		case this.STICKS_OUT_BOTTOM:
			r.setVertical("bottom"),
			this.options.targetJoint && o.setVertical("top")
		}
		if (!g) return j;
		this.options.stem && (m = r);
		d = this.getPosition(e, r, o, m);
		g = this._sticksOut(d);
		l = k = !1;
		g[0] && g[0] !== n[0] && (k = !0, r.setHorizontal(this.options.tipJoint.horizontal), this.options.targetJoint && o.setHorizontal(this.options.targetJoint.horizontal));
		g[1] && g[1] !== n[1] && (l = !0, r.setVertical(this.options.tipJoint.vertical), this.options.targetJoint && o.setVertical(this.options.targetJoint.vertical));
		if (k && l) return j;
		if (k || l) this.options.stem && (m = r),
		d = this.getPosition(e, r, o, m);
		return {
			position: d,
			stem: m
		}
	};
	a.prototype._sticksOut = function(a) {
		var d, g;
		d = this.adapter.scrollOffset();
		g = this.adapter.viewportDimensions();
		a = [a.left - d[0], a.top - d[1]];
		d = [!1, !1];
		0 > a[0] ? d[0] = this.STICKS_OUT_LEFT: a[0] + this.dimensions.width > g.width && (d[0] = this.STICKS_OUT_RIGHT);
		0 > a[1] ? d[1] = this.STICKS_OUT_TOP: a[1] + this.dimensions.height > g.height && (d[1] = this.STICKS_OUT_BOTTOM);
		return d
	};
	a.prototype._draw = function() {
		var e, d, g, j, k, l, m, n, o, r, u, s, B, z = this;
		if (this.backgroundCanvas && this.redraw) {
			this.debug("Drawing background.");
			this.redraw = !1;
			if (this.currentStem) {
				d = ["top", "right", "bottom", "left"];
				m = 0;
				for (e = d.length; m < e; m++) k = d[m],
				this.adapter.removeClass(this.container, "stem-" + k);
				this.adapter.addClass(this.container, "stem-" + this.currentStem.horizontal);
				this.adapter.addClass(this.container, "stem-" + this.currentStem.vertical)
			}
			o = [0, 0];
			k = [0, 0];
			0 <= __indexOf.call(this.options.hideTriggers, "closeButton") && (n = new a.Joint("top right" === (null != (l = this.currentStem) ? l.toString() : void 0) ? "top left": "top right"), o = [this.options.closeButtonRadius + this.options.closeButtonOffset[0], this.options.closeButtonRadius + this.options.closeButtonOffset[1]], k = [this.options.closeButtonRadius - this.options.closeButtonOffset[0], this.options.closeButtonRadius - this.options.closeButtonOffset[1]]);
			l = this.adapter.clone(this.dimensions);
			m = [0, 0];
			this.options.borderWidth && (l.width += 2 * this.options.borderWidth, l.height += 2 * this.options.borderWidth, m[0] -= this.options.borderWidth, m[1] -= this.options.borderWidth);
			this.options.shadow && (l.width += 2 * this.options.shadowBlur, l.width += Math.max(0, this.options.shadowOffset[0] - 2 * this.options.shadowBlur), l.height += 2 * this.options.shadowBlur, l.height += Math.max(0, this.options.shadowOffset[1] - 2 * this.options.shadowBlur), m[0] -= Math.max(0, this.options.shadowBlur - this.options.shadowOffset[0]), m[1] -= Math.max(0, this.options.shadowBlur - this.options.shadowOffset[1]));
			j = g = d = e = 0;
			this.currentStem && (this.currentStem.left ? e = this.options.stemLength: this.currentStem.right && (d = this.options.stemLength), this.currentStem.top ? g = this.options.stemLength: this.currentStem.bottom && (j = this.options.stemLength));
			n && (n.left ? e = Math.max(e, k[0]) : n.right && (d = Math.max(d, k[0])), n.top ? g = Math.max(g, k[1]) : n.bottom && (j = Math.max(j, k[1])));
			l.width += e + d;
			l.height += g + j;
			m[0] -= e;
			m[1] -= g;
			this.currentStem && this.options.borderWidth && (k = this._getPathStemMeasures(this.options.stemBase, this.options.stemLength, this.options.borderWidth), B = k.stemLength, s = k.stemBase);
			k = this.adapter.unwrap(this.backgroundCanvas);
			k.width = l.width;
			k.height = l.height;
			this.adapter.css(this.backgroundCanvas, {
				width: "" + k.width + "px",
				height: "" + k.height + "px",
				left: "" + m[0] + "px",
				top: "" + m[1] + "px"
			});
			r = k.getContext("2d");
			r.setTransform(1, 0, 0, 1, 0, 0);
			r.clearRect(0, 0, k.width, k.height);
			r.beginPath();
			r.fillStyle = this._getColor(r, this.dimensions, this.options.background, this.options.backgroundGradientHorizontal);
			r.lineJoin = "miter";
			r.miterLimit = 500;
			u = this.options.borderWidth / 2;
			this.options.borderWidth ? (r.strokeStyle = this.options.borderColor, r.lineWidth = this.options.borderWidth) : (B = this.options.stemLength, s = this.options.stemBase);
			null == s && (s = 0);
			k = function(a, d, e) {
				e && r.moveTo(Math.max(s, z.options.borderRadius, o[0]) + 1 - u, -u);
				if (d) return r.lineTo(a / 2 - s / 2, -u),
				r.lineTo(a / 2, -B - u),
				r.lineTo(a / 2 + s / 2, -u)
			};
			l = function(a, d, e) {
				var g;
				if (a) return r.lineTo( - s + u, 0 - u),
				r.lineTo(B + u, -B - u),
				r.lineTo(u, s - u);
				if (d) return d = z.options.closeButtonOffset,
				a = o[0],
				0 !== e % 2 && (d = [d[1], d[0]], a = o[1]),
				e = Math.acos(d[1] / z.options.closeButtonRadius),
				g = Math.acos(d[0] / z.options.closeButtonRadius),
				r.lineTo( - a + u, -u),
				r.arc(u - d[0], -u + d[1], z.options.closeButtonRadius, -(Math.PI / 2 + e), g, !1);
				r.lineTo( - z.options.borderRadius + u, -u);
				return r.quadraticCurveTo(u, -u, u, z.options.borderRadius - u)
			};
			r.translate( - m[0], -m[1]);
			r.save();
			var v, D, E, F, I;
			I = [];
			m = E = 0;
			for (F = a.positions.length / 2; 0 <= F ? E < F: E > F; m = 0 <= F ? ++E: --E) v = 2 * m,
			g = 0 === m || 3 === m ? 0 : z.dimensions.width,
			j = 2 > m ? 0 : z.dimensions.height,
			D = Math.PI / 2 * m,
			e = 0 === m % 2 ? z.dimensions.width: z.dimensions.height,
			d = new a.Joint(a.positions[v]),
			v = new a.Joint(a.positions[v + 1]),
			r.save(),
			r.translate(g, j),
			r.rotate(D),
			k(e, d.eql(z.currentStem), 0 === m),
			r.translate(e, 0),
			l(v.eql(z.currentStem), v.eql(n), m),
			I.push(r.restore());
			r.closePath();
			r.save();
			this.options.shadow && (r.shadowColor = this.options.shadowColor, r.shadowBlur = this.options.shadowBlur, r.shadowOffsetX = this.options.shadowOffset[0], r.shadowOffsetY = this.options.shadowOffset[1]);
			r.fill();
			r.restore();
			this.options.borderWidth && r.stroke();
			r.restore();
			if (n) return "top right" === n.toString() ? (n = [z.dimensions.width - z.options.closeButtonOffset[0], z.options.closeButtonOffset[1]], l = [n[0] + u, n[1] - u]) : (n = [z.options.closeButtonOffset[0], z.options.closeButtonOffset[1]], l = [n[0] - u, n[1] - u]),
			r.translate(l[0], l[1]),
			l = z.options.closeButtonCrossSize / 2,
			r.save(),
			r.beginPath(),
			r.strokeStyle = z.options.closeButtonCrossColor,
			r.lineWidth = z.options.closeButtonCrossLineWidth,
			r.lineCap = "round",
			r.moveTo( - l, -l),
			r.lineTo(l, l),
			r.stroke(),
			r.beginPath(),
			r.moveTo(l, -l),
			r.lineTo( - l, l),
			r.stroke(),
			r.restore(),
			z.adapter.css(z.closeButtonElement, {
				left: "" + (n[0] - l - z.options.closeButtonLinkOverscan) + "px",
				top: "" + (n[1] - l - z.options.closeButtonLinkOverscan) + "px",
				width: "" + (z.options.closeButtonCrossSize + 2 * z.options.closeButtonLinkOverscan) + "px",
				height: "" + (z.options.closeButtonCrossSize + 2 * z.options.closeButtonLinkOverscan) + "px"
			})
		}
	};
	a.prototype._getPathStemMeasures = function(a, d, g) {
		var j;
		g /= 2;
		a = Math.atan(a / 2 / d);
		j = 2 * (g / Math.sin(2 * a)) * Math.cos(a);
		d = g + d - j;
		if (0 > d) throw Error("Sorry but your stemLength / stemBase ratio is strange.");
		a = 2 * Math.tan(a) * d;
		return {
			stemLength: d,
			stemBase: a
		}
	};
	a.prototype._getColor = function(a, d, g, j) {
		var k;
		null == j && (j = !1);
		if ("string" === typeof g) return g;
		a = j ? a.createLinearGradient(0, 0, d.width, 0) : a.createLinearGradient(0, 0, 0, d.height);
		k = d = 0;
		for (j = g.length; d < j; k = ++d) k = g[k],
		a.addColorStop(k[0], k[1]);
		return a
	};
	a.prototype._searchAndActivateCloseButtons = function() {
		var a, d, g, j;
		j = this.adapter.findAll(this.container, "." + this["class"].close);
		d = 0;
		for (g = j.length; d < g; d++) a = j[d],
		this.hideTriggers.push({
			element: this.adapter.wrap(a),
			event: "click"
		});
		this.currentObservers.showing && this._setupObservers("-showing", "showing");
		if (this.currentObservers.visible) return this._setupObservers("-visible", "visible")
	};
	a.prototype._activateFirstInput = function() {
		var a;
		a = this.adapter.unwrap(this.adapter.find(this.container, "input, textarea"));
		return null != a ? "function" === typeof a.focus ? a.focus() : void 0 : void 0
	};
	a.prototype._followMousePosition = function() {
		if (!this.options.fixed) return this.adapter.observe(document.body, "mousemove", this.bound.reposition)
	};
	a.prototype._stopFollowingMousePosition = function() {
		if (!this.options.fixed) return this.adapter.stopObserving(document.body, "mousemove", this.bound.reposition)
	};
	a.prototype._clearShowTimeout = function() {
		return clearTimeout(this._showTimeoutId)
	};
	a.prototype._clearHideTimeout = function() {
		return clearTimeout(this._hideTimeoutId)
	};
	a.prototype._clearTimeouts = function() {
		clearTimeout(this._visibilityStateTimeoutId);
		this._clearShowTimeout();
		return this._clearHideTimeout()
	};
	a.prototype._triggerElementExists = function() {
		var a;
		for (a = this.adapter.unwrap(this.triggerElement); a.parentNode;) {
			if ("BODY" === a.parentNode.tagName) return ! 0;
			a = a.parentNode
		}
		return ! 1
	};
	a.prototype._loadAjax = function() {
		var a = this;
		if (!this.loading) return this.loaded = !1,
		this.loading = !0,
		this.adapter.addClass(this.container, this["class"].loading),
		this.debug("Loading content from " + this.options.ajax),
		this.adapter.ajax({
			url: this.options.ajax,
			method: this.options.ajaxMethod,
			onSuccess: function(d) {
				a.debug("Loading successful.");
				a.adapter.removeClass(a.container, a["class"].loading);
				return a.setContent(d)
			},
			onError: function(d) {
				a.debug("There was a problem downloading the content.", d);
				a.setContent("There was a problem downloading the content.");
				return a.adapter.addClass(a.container, a["class"].ajaxError)
			},
			onComplete: function() {
				a.adapter.removeClass(a.container, a["class"].loading);
				a.loading = !1;
				a.loaded = !0;
				a._searchAndActivateCloseButtons();
				a._activateFirstInput();
				return a.reposition()
			}
		})
	};
	a.prototype._ensureTriggerElement = function() {
		if (!this._triggerElementExists()) return this.deactivate(),
		this._stopEnsureTriggerElement()
	};
	a.prototype._ensureTriggerElementInterval = 1E3;
	a.prototype._startEnsureTriggerElement = function() {
		var a = this;
		return this._ensureTriggerElementTimeoutId = setInterval(function() {
			return a._ensureTriggerElement()
		},
		this._ensureTriggerElementInterval)
	};
	a.prototype._stopEnsureTriggerElement = function() {
		return clearInterval(this._ensureTriggerElementTimeoutId)
	};
	return a
} ();
vendors = ["khtml", "ms", "o", "moz", "webkit"];
Opentip.prototype.setCss3Style = function(a, e) {
	var d, g, j, k, l;
	a = this.adapter.unwrap(a);
	l = [];
	for (d in e) __hasProp.call(e, d) && (g = e[d], null != a.style[d] ? l.push(a.style[d] = g) : l.push(function() {
		var e, n, l;
		l = [];
		e = 0;
		for (n = vendors.length; e < n; e++) j = vendors[e],
		k = "" + this.ucfirst(j) + this.ucfirst(d),
		null != a.style[k] ? l.push(a.style[k] = g) : l.push(void 0);
		return l
	}.call(this)));
	return l
};
Opentip.prototype.defer = function(a) {
	return setTimeout(a, 0)
};
Opentip.prototype.setTimeout = function(a, e) {
	return setTimeout(a, e ? 1E3 * e: 0)
};
Opentip.prototype.ucfirst = function(a) {
	return null == a ? "": a.charAt(0).toUpperCase() + a.slice(1)
};
Opentip.prototype.dasherize = function(a) {
	return a.replace(/([A-Z])/g,
	function(a, d) {
		return "-" + d.toLowerCase()
	})
};
Opentip.Joint = function() {
	function a(a) {
		null != a && (a instanceof Opentip.Joint && (a = a.toString()), this.set(a), this)
	}
	a.prototype.set = function(a) {
		a = a.toLowerCase();
		this.setHorizontal(a);
		this.setVertical(a);
		return this
	};
	a.prototype.setHorizontal = function(a) {
		var d, g, j, k;
		g = ["left", "center", "right"];
		j = 0;
		for (k = g.length; j < k; j++) d = g[j],
		~a.indexOf(d) && (this.horizontal = d.toLowerCase());
		null == this.horizontal && (this.horizontal = "center");
		k = [];
		a = 0;
		for (j = g.length; a < j; a++) d = g[a],
		k.push(this[d] = this.horizontal === d ? d: void 0);
		return k
	};
	a.prototype.setVertical = function(a) {
		var d, g, j, k;
		g = ["top", "middle", "bottom"];
		j = 0;
		for (k = g.length; j < k; j++) d = g[j],
		~a.indexOf(d) && (this.vertical = d.toLowerCase());
		null == this.vertical && (this.vertical = "middle");
		k = [];
		a = 0;
		for (j = g.length; a < j; a++) d = g[a],
		k.push(this[d] = this.vertical === d ? d: void 0);
		return k
	};
	a.prototype.eql = function(a) {
		return null != a && this.horizontal === a.horizontal && this.vertical === a.vertical
	};
	a.prototype.flip = function() {
		var a;
		a = Opentip.position[this.toString(!0)];
		this.set(Opentip.positions[(a + 4) % 8]);
		return this
	};
	a.prototype.toString = function(a) {
		var d, g;
		null == a && (a = !1);
		g = "middle" === this.vertical ? "": this.vertical;
		d = "center" === this.horizontal ? "": this.horizontal;
		g && d && (d = a ? Opentip.prototype.ucfirst(d) : " " + d);
		return "" + g + d
	};
	return a
} ();
Opentip.prototype._positionsEqual = function(a, e) {
	return null != a && null != e && a.left === e.left && a.top === e.top
};
Opentip.prototype._dimensionsEqual = function(a, e) {
	return null != a && null != e && a.width === e.width && a.height === e.height
};
Opentip.prototype.debug = function() {
	var a;
	a = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
	if (Opentip.debug && null != ("undefined" !== typeof console && null !== console ? console.debug: void 0)) return a.unshift("#" + this.id + " |"),
	console.debug.apply(console, a)
};
Opentip.findElements = function() {
	var a, e, d, g, j, k, l, m, n, o;
	a = Opentip.adapter;
	n = a.findAll(document.body, "[data-ot]");
	o = [];
	l = 0;
	for (m = n.length; l < m; l++) {
		d = n[l];
		k = {};
		e = a.data(d, "ot");
		if ("" === e || "true" === e || "yes" === e) e = a.attr(d, "title"),
		a.attr(d, "title", "");
		e = e || "";
		for (g in Opentip.styles.standard) if (j = a.data(d, "ot" + Opentip.prototype.ucfirst(g)), null != j) {
			if ("yes" === j || "true" === j || "on" === j) j = !0;
			else if ("no" === j || "false" === j || "off" === j) j = !1;
			k[g] = j
		}
		o.push(new Opentip(d, e, k))
	}
	return o
};
Opentip.version = "2.2.2";
Opentip.debug = !1;
Opentip.lastId = 0;
Opentip.lastZIndex = 100;
Opentip.tips = [];
Opentip._abortShowingGroup = function(a, e) {
	var d, g, j, k, l;
	k = Opentip.tips;
	l = [];
	g = 0;
	for (j = k.length; g < j; g++) d = k[g],
	d !== e && d.options.group === a ? l.push(d._abortShowing()) : l.push(void 0);
	return l
};
Opentip._hideGroup = function(a, e) {
	var d, g, j, k, l;
	k = Opentip.tips;
	l = [];
	g = 0;
	for (j = k.length; g < j; g++) d = k[g],
	d !== e && d.options.group === a ? l.push(d.hide()) : l.push(void 0);
	return l
};
Opentip.adapters = {};
Opentip.adapter = null;
firstAdapter = !0;
Opentip.addAdapter = function(a) {
	Opentip.adapters[a.name] = a;
	if (firstAdapter) return Opentip.adapter = a,
	a.domReady(Opentip.findElements),
	firstAdapter = !1
};
Opentip.positions = "top topRight right bottomRight bottom bottomLeft left topLeft".split(" ");
Opentip.position = {};
_ref = Opentip.positions;
i = _i = 0;
for (_len = _ref.length; _i < _len; i = ++_i) position = _ref[i],
Opentip.position[position] = i;
Opentip.styles = {
	standard: {
		"extends": null,
		title: void 0,
		escapeTitle: !0,
		escapeContent: !1,
		className: "standard",
		stem: !0,
		delay: null,
		hideDelay: 0.1,
		fixed: !1,
		showOn: "mouseover",
		hideTrigger: "trigger",
		hideTriggers: [],
		hideOn: null,
		offset: [0, 0],
		containInViewport: !0,
		autoOffset: !0,
		showEffect: "appear",
		hideEffect: "fade",
		showEffectDuration: 0.3,
		hideEffectDuration: 0.2,
		stemLength: 5,
		stemBase: 8,
		tipJoint: "top left",
		target: null,
		targetJoint: null,
		ajax: !1,
		ajaxMethod: "GET",
		ajaxCache: !0,
		group: null,
		style: null,
		background: "#fff18f",
		backgroundGradientHorizontal: !1,
		closeButtonOffset: [5, 5],
		closeButtonRadius: 7,
		closeButtonCrossSize: 4,
		closeButtonCrossColor: "#d2c35b",
		closeButtonCrossLineWidth: 1.5,
		closeButtonLinkOverscan: 6,
		borderRadius: 5,
		borderWidth: 1,
		borderColor: "#f2e37b",
		shadow: !0,
		shadowBlur: 10,
		shadowOffset: [3, 3],
		shadowColor: "rgba(0, 0, 0, 0.1)"
	},
	glass: {
		"extends": "standard",
		className: "glass",
		background: [[0, "rgba(252, 252, 252, 0.8)"], [0.5, "rgba(255, 255, 255, 0.8)"], [0.5, "rgba(250, 250, 250, 0.9)"], [1, "rgba(245, 245, 245, 0.9)"]],
		borderColor: "#eee",
		closeButtonCrossColor: "rgba(0, 0, 0, 0.2)",
		borderRadius: 15,
		closeButtonRadius: 10,
		closeButtonOffset: [8, 8]
	},
	dark: {
		"extends": "standard",
		className: "dark",
		borderRadius: 13,
		borderColor: "#444",
		closeButtonCrossColor: "rgba(240, 240, 240, 1)",
		shadowColor: "rgba(0, 0, 0, 0.3)",
		shadowOffset: [2, 2],
		background: [[0, "rgba(30, 30, 30, 0.7)"], [0.5, "rgba(30, 30, 30, 0.8)"], [0.5, "rgba(10, 10, 10, 0.8)"], [1, "rgba(10, 10, 10, 0.9)"]]
	},
	alert: {
		"extends": "standard",
		className: "alert",
		borderRadius: 1,
		borderColor: "#AE0D11",
		closeButtonCrossColor: "rgba(255, 255, 255, 1)",
		shadowColor: "rgba(0, 0, 0, 0.3)",
		shadowOffset: [2, 2],
		background: [[0, "rgba(203, 15, 19, 0.7)"], [0.5, "rgba(203, 15, 19, 0.8)"], [0.5, "rgba(189, 14, 18, 0.8)"], [1, "rgba(179, 14, 17, 0.9)"]]
	}
};
Opentip.defaultStyle = "standard";
"undefined" !== typeof module && null !== module ? module.exports = Opentip: window.Opentip = Opentip;
__slice = [].slice; (function(a) {
	a.fn.opentip = function(a, e, j) {
		return new Opentip(this, a, e, j)
	};
	var e = function() {};
	e.prototype.name = "jquery";
	e.prototype.domReady = function(d) {
		return a(d)
	};
	e.prototype.create = function(d) {
		return a(d)
	};
	e.prototype.wrap = function(d) {
		d = a(d);
		if (1 < d.length) throw Error("Multiple elements provided.");
		return d
	};
	e.prototype.unwrap = function(d) {
		return a(d)[0]
	};
	e.prototype.tagName = function(a) {
		return this.unwrap(a).tagName
	};
	e.prototype.attr = function() {
		var d, e, j;
		e = arguments[0];
		d = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
		return (j = a(e)).attr.apply(j, d)
	};
	e.prototype.data = function() {
		var d, e, j;
		e = arguments[0];
		d = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
		return (j = a(e)).data.apply(j, d)
	};
	e.prototype.find = function(d, e) {
		return a(d).find(e)
	};
	e.prototype.findAll = function() {
		return this.find.apply(this, arguments)
	};
	e.prototype.update = function(d, e, j) {
		d = a(d);
		return j ? d.text(e) : d.html(e)
	};
	e.prototype.append = function(d, e) {
		return a(d).append(e)
	};
	e.prototype.addClass = function(d, e) {
		return a(d).addClass(e)
	};
	e.prototype.removeClass = function(d, e) {
		return a(d).removeClass(e)
	};
	e.prototype.css = function(d, e) {
		return a(d).css(e)
	};
	e.prototype.dimensions = function(d) {
		return {
			width: a(d).outerWidth(),
			height: a(d).outerHeight()
		}
	};
	e.prototype.scrollOffset = function() {
		return [window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft, window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop]
	};
	e.prototype.viewportDimensions = function() {
		return {
			width: document.documentElement.clientWidth,
			height: document.documentElement.clientHeight
		}
	};
	e.prototype.mousePosition = function(a) {
		return null == a ? null: {
			x: a.pageX,
			y: a.pageY
		}
	};
	e.prototype.offset = function(d) {
		d = a(d).offset();
		return {
			left: d.left,
			top: d.top
		}
	};
	e.prototype.observe = function(d, e, j) {
		return a(d).bind(e, j)
	};
	e.prototype.stopObserving = function(d, e, j) {
		return a(d).unbind(e, j)
	};
	e.prototype.ajax = function(d) {
		var e, j;
		if (null == d.url) throw Error("No url provided");
		return a.ajax({
			url: d.url,
			type: null != (e = null != (j = d.method) ? j.toUpperCase() : void 0) ? e: "GET"
		}).done(function(a) {
			return "function" === typeof d.onSuccess ? d.onSuccess(a) : void 0
		}).fail(function(a) {
			return "function" === typeof d.onError ? d.onError("Server responded with status " + a.status) : void 0
		}).always(function() {
			return "function" === typeof d.onComplete ? d.onComplete() : void 0
		})
	};
	e.prototype.clone = function(d) {
		return a.extend({},
		d)
	};
	e.prototype.extend = function() {
		var d, e;
		e = arguments[0];
		d = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
		return a.extend.apply(a, [e].concat(__slice.call(d)))
	};
	return Opentip.addAdapter(new e)
})(jQuery); (function(a) {
	function e(d, e, g, j) {
		j = {
			data: j || 0 === j || !1 === j ? j: e ? e.data: {},
			_wrap: e ? e._wrap: null,
			tmpl: null,
			parent: e || null,
			nodes: [],
			calls: n,
			nest: o,
			wrap: r,
			html: u,
			update: s
		};
		d && a.extend(j, d, {
			nodes: [],
			parent: e
		});
		g && (j.tmpl = g, j._ctnt = j._ctnt || j.tmpl(a, j), j.key = ++G, (J.length ? E: D)[G] = j);
		return j
	}
	function d(e, j, k) {
		var n;
		k = k ? a.map(k,
		function(a) {
			return "string" === typeof a ? e.key ? a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g, "$1 " + z + '\x3d"' + e.key + '" $2') : a: d(a, e, a._ctnt)
		}) : e;
		if (j) return k;
		k = k.join("");
		k.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
		function(d, e, j, k) {
			n = a(j).get();
			m(n);
			e && (n = g(e).concat(n));
			k && (n = n.concat(g(k)))
		});
		return n ? n: g(k)
	}
	function g(d) {
		var e = document.createElement("div");
		e.innerHTML = d;
		return a.makeArray(e.childNodes)
	}
	function j(d) {
		return new Function("jQuery", "$item", "var $\x3djQuery,call,__\x3d[],$data\x3d$item.data;with($data){__.push('" + a.trim(d).replace(/([\\'])/g, "\\$1").replace(/[\r\t\n]/g, " ").replace(/\$\{([^\}]*)\}/g, "{{\x3d $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
		function(d, e, g, j, k, m, n) {
			d = a.tmpl.tag[g];
			if (!d) throw "Unknown template tag: " + g;
			g = d._default || [];
			m && !/\w$/.test(k) && (k += m, m = "");
			k ? (k = l(k), n = n ? "," + l(n) + ")": m ? ")": "", n = m ? -1 < k.indexOf(".") ? k + l(m) : "(" + k + ").call($item" + n: k, m = m ? n: "(typeof(" + k + ")\x3d\x3d\x3d'function'?(" + k + ").call($item):(" + k + "))") : m = n = g.$1 || "null";
			j = l(j);
			return "');" + d[e ? "close": "open"].split("$notnull_1").join(k ? "typeof(" + k + ")!\x3d\x3d'undefined' \x26\x26 (" + k + ")!\x3dnull": "true").split("$1a").join(m).split("$1").join(n).split("$2").join(j || g.$2 || "") + "__.push('"
		}) + "');}return __;")
	}
	function k(e, g) {
		e._wrap = d(e, !0, a.isArray(g) ? g: [v.test(g) ? g: a(g).html()]).join("")
	}
	function l(a) {
		return a ? a.replace(/\\'/g, "'").replace(/\\\\/g, "\\") : null
	}
	function m(d) {
		function g(d) {
			function k(a) {
				a += j;
				o = n[a] = n[a] || e(o, D[o.parent.key + j] || o.parent)
			}
			var m, l = d,
			o, r;
			if (r = d.getAttribute(z)) {
				for (; l.parentNode && 1 === (l = l.parentNode).nodeType && !(m = l.getAttribute(z)););
				if (m !== r) {
					l = l.parentNode ? 11 === l.nodeType ? 0 : l.getAttribute(z) || 0 : 0;
					if (! (o = D[r])) o = E[r],
					o = e(o, D[l] || E[l]),
					o.key = ++G,
					D[G] = o;
					K && k(r)
				}
				d.removeAttribute(z)
			} else if (K && (o = a.data(d, "tmplItem"))) k(o.key),
			D[o.key] = o,
			l = (l = a.data(d.parentNode, "tmplItem")) ? l.key: 0;
			if (o) {
				for (m = o; m && m.key != l;) m.nodes.push(d),
				m = m.parent;
				delete o._ctnt;
				delete o._wrap;
				a.data(d, "tmplItem", o)
			}
		}
		var j = "_" + K,
		k, m, n = {},
		l, o, r;
		l = 0;
		for (o = d.length; l < o; l++) if (1 === (k = d[l]).nodeType) {
			m = k.getElementsByTagName("*");
			for (r = m.length - 1; 0 <= r; r--) g(m[r]);
			g(k)
		}
	}
	function n(a, d, e, g) {
		if (!a) return J.pop();
		J.push({
			_: a,
			tmpl: d,
			item: this,
			data: e,
			options: g
		})
	}
	function o(d, e, g) {
		return a.tmpl(a.template(d), e, g, this)
	}
	function r(d, e) {
		var g = d.options || {};
		g.wrapped = e;
		return a.tmpl(a.template(d.tmpl), d.data, g, d.item)
	}
	function u(d, e) {
		var g = this._wrap;
		return a.map(a(a.isArray(g) ? g.join("") : g).filter(d || "*"),
		function(a) {
			if (e) a = a.innerText || a.textContent;
			else {
				var d;
				if (! (d = a.outerHTML)) d = document.createElement("div"),
				d.appendChild(a.cloneNode(!0)),
				d = d.innerHTML;
				a = d
			}
			return a
		})
	}
	function s() {
		var d = this.nodes;
		a.tmpl(null, null, null, this).insertBefore(d[0]);
		a(d).remove()
	}
	var B = a.fn.domManip,
	z = "_tmplitem",
	v = /^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,
	D = {},
	E = {},
	F, I = {
		key: 0,
		data: {}
	},
	G = 0,
	K = 0,
	J = [];
	a.each({
		appendTo: "append",
		prependTo: "prepend",
		insertBefore: "before",
		insertAfter: "after",
		replaceAll: "replaceWith"
	},
	function(d, e) {
		a.fn[d] = function(g) {
			var j = [];
			g = a(g);
			var k, m, n;
			k = 1 === this.length && this[0].parentNode;
			F = D || {};
			if (k && 11 === k.nodeType && 1 === k.childNodes.length && 1 === g.length) g[e](this[0]),
			j = this;
			else {
				m = 0;
				for (n = g.length; m < n; m++) K = m,
				k = (0 < m ? this.clone(!0) : this).get(),
				a(g[m])[e](k),
				j = j.concat(k);
				K = 0;
				j = this.pushStack(j, d, g.selector)
			}
			g = F;
			F = null;
			a.tmpl.complete(g);
			return j
		}
	});
	a.fn.extend({
		tmpl: function(d, e, g) {
			return a.tmpl(this[0], d, e, g)
		},
		tmplItem: function() {
			return a.tmplItem(this[0])
		},
		template: function(d) {
			return a.template(d, this[0])
		},
		domManip: function(d, e, g) {
			if (d[0] && a.isArray(d[0])) {
				for (var j = a.makeArray(arguments), k = d[0], m = k.length, n = 0, l; n < m && !(l = a.data(k[n++], "tmplItem")););
				l && K && (j[2] = function(d) {
					a.tmpl.afterManip(this, d, g)
				});
				B.apply(this, j)
			} else B.apply(this, arguments);
			K = 0; ! F && a.tmpl.complete(D);
			return this
		}
	});
	a.extend({
		tmpl: function(g, j, m, n) {
			var l = !n;
			if (l) n = I,
			g = a.template[g] || a.template(null, g),
			E = {};
			else if (!g) return g = n.tmpl,
			D[n.key] = n,
			n.nodes = [],
			n.wrapped && k(n, n.wrapped),
			a(d(n, null, n.tmpl(a, n)));
			if (!g) return [];
			"function" === typeof j && (j = j.call(n || {}));
			m && m.wrapped && k(m, m.wrapped);
			j = a.isArray(j) ? a.map(j,
			function(a) {
				return a ? e(m, n, g, a) : null
			}) : [e(m, n, g, j)];
			return l ? a(d(n, null, j)) : j
		},
		tmplItem: function(d) {
			var e;
			for (d instanceof a && (d = d[0]); d && 1 === d.nodeType && !(e = a.data(d, "tmplItem")) && (d = d.parentNode););
			return e || I
		},
		template: function(d, e) {
			return e ? ("string" === typeof e ? e = j(e) : e instanceof a && (e = e[0] || {}), e.nodeType && (e = a.data(e, "tmpl") || a.data(e, "tmpl", j(e.innerHTML))), "string" === typeof d ? a.template[d] = e: e) : d ? "string" !== typeof d ? a.template(null, d) : a.template[d] || a.template(null, v.test(d) ? d: a(d)) : null
		},
		encode: function(a) {
			return ("" + a).split("\x3c").join("\x26lt;").split("\x3e").join("\x26gt;").split('"').join("\x26#34;").split("'").join("\x26#39;")
		}
	});
	a.extend(a.tmpl, {
		tag: {
			tmpl: {
				_default: {
					$2: "null"
				},
				open: "if($notnull_1){__\x3d__.concat($item.nest($1,$2));}"
			},
			wrap: {
				_default: {
					$2: "null"
				},
				open: "$item.calls(__,$1,$2);__\x3d[];",
				close: "call\x3d$item.calls();__\x3dcall._.concat($item.wrap(call,__));"
			},
			each: {
				_default: {
					$2: "$index, $value"
				},
				open: "if($notnull_1){$.each($1a,function($2){with(this){",
				close: "}});}"
			},
			"if": {
				open: "if(($notnull_1) \x26\x26 $1a){",
				close: "}"
			},
			"else": {
				_default: {
					$1: "true"
				},
				open: "}else if(($notnull_1) \x26\x26 $1a){"
			},
			html: {
				open: "if($notnull_1){__.push($1a);}"
			},
			"\x3d": {
				_default: {
					$1: "$data"
				},
				open: "if($notnull_1){__.push($.encode($1a));}"
			},
			"!": {
				open: ""
			}
		},
		complete: function() {
			D = {}
		},
		afterManip: function(d, e, g) {
			var j = 11 === e.nodeType ? a.makeArray(e.childNodes) : 1 === e.nodeType ? [e] : [];
			g.call(d, e);
			m(j);
			K++
		}
	})
})(jQuery); (function(a) {
	a.widget("mjs.nestedSortable", a.extend({},
	a.ui.sortable.prototype, {
		options: {
			tabSize: 20,
			disableNesting: "mjs-nestedSortable-no-nesting",
			errorClass: "mjs-nestedSortable-error",
			doNotClear: !1,
			listType: "ol",
			maxLevels: 0,
			protectRoot: !1,
			rootID: null,
			rtl: !1,
			isAllowed: function() {
				return ! 0
			}
		},
		_create: function() {
			this.element.data("sortable", this.element.data("nestedSortable"));
			if (!this.element.is(this.options.listType)) throw Error("nestedSortable: Please check the listType option is set to your actual list type");
			return a.ui.sortable.prototype._create.apply(this, arguments)
		},
		destroy: function() {
			this.element.removeData("nestedSortable").unbind(".nestedSortable");
			return a.ui.sortable.prototype.destroy.apply(this, arguments)
		},
		_mouseDrag: function(e) {
			this.position = this._generatePosition(e);
			this.positionAbs = this._convertPositionTo("absolute");
			this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
			var d = this.options;
			if (this.options.scroll) {
				var g = !1;
				this.scrollParent[0] != document && "HTML" != this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - e.pageY < d.scrollSensitivity ? this.scrollParent[0].scrollTop = g = this.scrollParent[0].scrollTop + d.scrollSpeed: e.pageY - this.overflowOffset.top < d.scrollSensitivity && (this.scrollParent[0].scrollTop = g = this.scrollParent[0].scrollTop - d.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - e.pageX < d.scrollSensitivity ? this.scrollParent[0].scrollLeft = g = this.scrollParent[0].scrollLeft + d.scrollSpeed: e.pageX - this.overflowOffset.left < d.scrollSensitivity && (this.scrollParent[0].scrollLeft = g = this.scrollParent[0].scrollLeft - d.scrollSpeed)) : (e.pageY - a(document).scrollTop() < d.scrollSensitivity ? g = a(document).scrollTop(a(document).scrollTop() - d.scrollSpeed) : a(window).height() - (e.pageY - a(document).scrollTop()) < d.scrollSensitivity && (g = a(document).scrollTop(a(document).scrollTop() + d.scrollSpeed)), e.pageX - a(document).scrollLeft() < d.scrollSensitivity ? g = a(document).scrollLeft(a(document).scrollLeft() - d.scrollSpeed) : a(window).width() - (e.pageX - a(document).scrollLeft()) < d.scrollSensitivity && (g = a(document).scrollLeft(a(document).scrollLeft() + d.scrollSpeed))); ! 1 !== g && (a.ui.ddmanager && !d.dropBehaviour) && a.ui.ddmanager.prepareOffsets(this, e)
			}
			this.positionAbs = this._convertPositionTo("absolute");
			g = this.placeholder.offset().top;
			if (!this.options.axis || "y" != this.options.axis) this.helper[0].style.left = this.position.left + "px";
			if (!this.options.axis || "x" != this.options.axis) this.helper[0].style.top = this.position.top + "px";
			for (var j = this.items.length - 1; 0 <= j; j--) {
				var k = this.items[j],
				l = k.item[0],
				m = this._intersectsWithPointer(k);
				if (m && l != this.currentItem[0] && this.placeholder[1 == m ? "next": "prev"]()[0] != l && !a.contains(this.placeholder[0], l) && ("semi-dynamic" == this.options.type ? !a.contains(this.element[0], l) : 1)) {
					a(l).mouseenter();
					this.direction = 1 == m ? "down": "up";
					if ("pointer" == this.options.tolerance || this._intersectsWithSides(k)) a(l).mouseleave(),
					this._rearrange(e, k);
					else break;
					this._clearEmpty(l);
					this._trigger("change", e, this._uiHash());
					break
				}
			}
			j = this.placeholder[0].parentNode.parentNode && a(this.placeholder[0].parentNode.parentNode).closest(".ui-sortable").length ? a(this.placeholder[0].parentNode.parentNode) : null;
			k = this._getLevel(this.placeholder);
			l = this._getChildLevels(this.helper);
			m = this.placeholder[0].previousSibling ? a(this.placeholder[0].previousSibling) : null;
			if (null != m) for (;
			"li" != m[0].nodeName.toLowerCase() || m[0] == this.currentItem[0] || m[0] == this.helper[0];) if (m[0].previousSibling) m = a(m[0].previousSibling);
			else {
				m = null;
				break
			}
			var n = this.placeholder[0].nextSibling ? a(this.placeholder[0].nextSibling) : null;
			if (null != n) for (;
			"li" != n[0].nodeName.toLowerCase() || n[0] == this.currentItem[0] || n[0] == this.helper[0];) if (n[0].nextSibling) n = a(n[0].nextSibling);
			else {
				n = null;
				break
			}
			var o = document.createElement(d.listType);
			this.beyondMaxLevels = 0;
			null != j && null == n && (d.rtl && this.positionAbs.left + this.helper.outerWidth() > j.offset().left + j.outerWidth() || !d.rtl && this.positionAbs.left < j.offset().left) ? (j.after(this.placeholder[0]), this._clearEmpty(j[0]), this._trigger("change", e, this._uiHash())) : null != m && (d.rtl && this.positionAbs.left + this.helper.outerWidth() < m.offset().left + m.outerWidth() - d.tabSize || !d.rtl && this.positionAbs.left > m.offset().left + d.tabSize) ? (this._isAllowed(m, k, k + l + 1), m.children(d.listType).length || m[0].appendChild(o), g && g <= m.offset().top ? m.children(d.listType).prepend(this.placeholder) : m.children(d.listType)[0].appendChild(this.placeholder[0]), this._trigger("change", e, this._uiHash())) : this._isAllowed(j, k, k + l);
			this._contactContainers(e);
			a.ui.ddmanager && a.ui.ddmanager.drag(this, e);
			this._trigger("sort", e, this._uiHash());
			this.lastPositionAbs = this.positionAbs;
			return ! 1
		},
		_mouseStop: function(e, d) {
			this.beyondMaxLevels && (this.placeholder.removeClass(this.options.errorClass), this.domPosition.prev ? a(this.domPosition.prev).after(this.placeholder) : a(this.domPosition.parent).prepend(this.placeholder), this._trigger("revert", e, this._uiHash()));
			for (var g = this.items.length - 1; 0 <= g; g--) this._clearEmpty(this.items[g].item[0]);
			a.ui.sortable.prototype._mouseStop.apply(this, arguments)
		},
		serialize: function(e) {
			var d = a.extend({},
			this.options, e);
			e = this._getItemsAsjQuery(d && d.connected);
			var g = [];
			a(e).each(function() {
				var e = (a(d.item || this).attr(d.attribute || "id") || "").match(d.expression || /(.+)[-=_](.+)/),
				k = (a(d.item || this).parent(d.listType).parent(d.items).attr(d.attribute || "id") || "").match(d.expression || /(.+)[-=_](.+)/);
				e && g.push((d.key || e[1]) + "[" + (d.key && d.expression ? e[1] : e[2]) + "]\x3d" + (k ? d.key && d.expression ? k[1] : k[2] : d.rootID))
			}); ! g.length && d.key && g.push(d.key + "\x3d");
			return g.join("\x26")
		},
		toHierarchy: function(e) {
			function d(e) {
				var j = (a(e).attr(g.attribute || "id") || "").match(g.expression || /(.+)[-=_](.+)/);
				if (j) {
					var m = {
						id: j[2]
					};
					0 < a(e).children(g.listType).children(g.items).length && (m.children = [], a(e).children(g.listType).children(g.items).each(function() {
						var a = d(this);
						m.children.push(a)
					}));
					return m
				}
			}
			var g = a.extend({},
			this.options, e),
			j = [];
			a(this.element).children(g.items).each(function() {
				var a = d(this);
				j.push(a)
			});
			return j
		},
		toArray: function(e) {
			function d(e, n, l) {
				var r = l + 1,
				u;
				0 < a(e).children(g.listType).children(g.items).length && (n++, a(e).children(g.listType).children(g.items).each(function() {
					r = d(a(this), n, r)
				}), n--);
				u = a(e).attr(g.attribute || "id").match(g.expression || /(.+)[-=_](.+)/);
				e = n === j + 1 ? g.rootID: a(e).parent(g.listType).parent(g.items).attr(g.attribute || "id").match(g.expression || /(.+)[-=_](.+)/)[2];
				u && k.push({
					item_id: u[2],
					parent_id: e,
					depth: n,
					left: l,
					right: r
				});
				return r + 1
			}
			var g = a.extend({},
			this.options, e),
			j = g.startDepthCount || 0,
			k = [],
			l = 2;
			k.push({
				item_id: g.rootID,
				parent_id: "none",
				depth: j,
				left: "1",
				right: 2 * (a(g.items, this.element).length + 1)
			});
			a(this.element).children(g.items).each(function() {
				l = d(this, j + 1, l)
			});
			return k = k.sort(function(a, d) {
				return a.left - d.left
			})
		},
		_clearEmpty: function(e) {
			e = a(e).children(this.options.listType);
			e.length && (!e.children().length && !this.options.doNotClear) && e.remove()
		},
		_getLevel: function(a) {
			var d = 1;
			if (this.options.listType) for (a = a.closest(this.options.listType); a && 0 < a.length && !a.is(".ui-sortable");) d++,
			a = a.parent().closest(this.options.listType);
			return d
		},
		_getChildLevels: function(e, d) {
			var g = this,
			j = this.options,
			k = 0;
			d = d || 0;
			a(e).children(j.listType).children(j.items).each(function(a, e) {
				k = Math.max(g._getChildLevels(e, d + 1), k)
			});
			return d ? k + 1 : k
		},
		_isAllowed: function(e, d, g) {
			var j = this.options,
			k = a(this.domPosition.parent).hasClass("ui-sortable") ? !0 : !1,
			l = this.placeholder.closest(".ui-sortable").nestedSortable("option", "maxLevels"); ! j.isAllowed(this.currentItem, e) || e && e.hasClass(j.disableNesting) || j.protectRoot && (null == e && !k || k && 1 < d) ? (this.placeholder.addClass(j.errorClass), this.beyondMaxLevels = l < g && 0 != l ? g - l: 1) : l < g && 0 != l ? (this.placeholder.addClass(j.errorClass), this.beyondMaxLevels = g - l) : (this.placeholder.removeClass(j.errorClass), this.beyondMaxLevels = 0)
		}
	}));
	a.mjs.nestedSortable.prototype.options = a.extend({},
	a.ui.sortable.prototype.options, a.mjs.nestedSortable.prototype.options)
})(jQuery); (function(a) {
	a.chainclude = function(e, d) {
		var g = function(j, k) {
			if ("undefined" != typeof e.length) {
				if (0 == e.length) return a.isFunction(d) ? d(k) : null;
				e.shift();
				return a.chainclude.load(e, g)
			}
			for (var l in e) {
				e[l](k);
				delete e[l];
				l = 0;
				for (var m in e) l++;
				return 0 == l ? a.isFunction(d) ? d(k) : null: a.chainclude.load(e, g)
			}
		};
		a.chainclude.load(e, g)
	};
	a.chainclude.load = function(e, d) {
		if ("object" == typeof e && "undefined" == typeof e.length) for (var g in e) return a.include.load(g, d, e[g].callback);
		e = a.makeArray(e);
		a.include.load(e[0], d, null)
	};
	a.include = function(e, d) {
		var g = a.include.luid++,
		j = function(e, j) {
			a.isFunction(e) && e(j);
			0 == --a.include.counter[g] && a.isFunction(d) && d()
		};
		if ("object" == typeof e && "undefined" == typeof e.length) {
			a.include.counter[g] = 0;
			for (var k in e) a.include.counter[g]++;
			return a.each(e,
			function(d, e) {
				a.include.load(d, j, e)
			})
		}
		e = a.makeArray(e);
		a.include.counter[g] = e.length;
		a.each(e,
		function() {
			a.include.load(this, j, null)
		})
	};
	a.extend(a.include, {
		luid: 0,
		counter: [],
		load: function(e, d, g) {
			e = e.toString();
			if (a.include.exist(e)) return d(g);
			/.css$/.test(e) ? a.include.loadCSS(e, d, g) : /.js$/.test(e) ? a.include.loadJS(e, d, g) : a.get(e,
			function(a) {
				d(g, a)
			})
		},
		loadCSS: function(e, d, g) {
			var j = document.createElement("link");
			j.setAttribute("type", "text/css");
			j.setAttribute("rel", "stylesheet");
			j.setAttribute("href", "" + e);
			a("head").get(0).appendChild(j);
			a.browser.msie ? a.include.IEonload(j, d, g) : d(g)
		},
		loadJS: function(e, d, g) {
			var j = document.createElement("script");
			j.setAttribute("type", "text/javascript");
			j.setAttribute("src", "" + e);
			a.browser.msie ? a.include.IEonload(j, d, g) : j.onload = function() {
				d(g)
			};
			a("head").get(0).appendChild(j)
		},
		IEonload: function(a, d, g) {
			a.onreadystatechange = function() { ("loaded" == this.readyState || "complete" == this.readyState) && d(g)
			}
		},
		exist: function(e) {
			var d = !1;
			a("head script").each(function() {
				if (/.css$/.test(e) && this.href == e || /.js$/.test(e) && this.src == e) return d = !0
			});
			return d
		}
	})
})(jQuery); (function(a, e, d) {
	function g(d) {
		var g = this,
		j = d.options.show.modal,
		k = d.elements,
		m = k.tooltip,
		l = ".qtipmodal" + d.id,
		r = a(document.body),
		v;
		d.checks.modal = {
			"^show.modal.(on|blur)$": function() {
				g.init();
				k.overlay.toggle(m.is(":visible"))
			}
		};
		a.extend(g, {
			init: function() {
				if (!j.on) return g;
				v = g.create();
				m.attr("is-modal-qtip", n).css("z-index", s.modal.zindex + a(F + "[is-modal-qtip]").length).unbind(".qtipmodal").unbind(l).bind("tooltipshow.qtipmodal tooltiphide.qtipmodal",
				function(d, e, j) {
					e = d.originalEvent;
					if (d.target === m[0]) if (e && "tooltiphide" === d.type && /mouse(leave|enter)/.test(e.type) && a(e.relatedTarget).closest(v[0]).length) try {
						d.preventDefault()
					} catch(k) {} else(!e || e && !e.solo) && g[d.type.replace("tooltip", "")](d, j)
				}).bind("tooltipfocus.qtipmodal",
				function(d) {
					if (!d.isDefaultPrevented() && d.target === m[0]) {
						var e = a(F).filter("[is-modal-qtip]"),
						g = s.modal.zindex + e.length,
						j = parseInt(m[0].style.zIndex, 10);
						v[0].style.zIndex = g - 1;
						e.each(function() {
							this.style.zIndex > j && (this.style.zIndex -= 1)
						});
						e.end().filter("." + G).qtip("blur", d.originalEvent);
						m.addClass(G)[0].style.zIndex = g;
						try {
							d.preventDefault()
						} catch(k) {}
					}
				}).bind("tooltiphide.qtipmodal",
				function(d) {
					d.target === m[0] && a("[is-modal-qtip]").filter(":visible").not(m).last().qtip("focus", d)
				});
				j.escape && a(e).unbind(l).bind("keydown" + l,
				function(a) {
					27 === a.keyCode && m.hasClass(G) && d.hide(a)
				});
				j.blur && k.overlay.unbind(l).bind("click" + l,
				function(a) {
					m.hasClass(G) && d.hide(a)
				});
				return g
			},
			create: function() {
				function d() {
					v.css({
						height: a(e).height(),
						width: a(e).width()
					})
				}
				var g = a("#qtip-overlay");
				if (g.length) return k.overlay = g.insertAfter(a(F).last());
				v = k.overlay = a("\x3cdiv /\x3e", {
					id: "qtip-overlay",
					html: "\x3cdiv\x3e\x3c/div\x3e",
					mousedown: function() {
						return o
					}
				}).insertAfter(a(F).last());
				a(e).unbind(".qtipmodal").bind("resize.qtipmodal", d);
				d();
				return v
			},
			toggle: function(d, e, k) {
				if (d && d.isDefaultPrevented()) return g;
				d = j.effect;
				var s = e ? "show": "hide",
				u = v.is(":visible"),
				B = a("[is-modal-qtip]").filter(":visible").not(m);
				v || (v = g.create());
				if (v.is(":animated") && u === e || !e && B.length) return g;
				e ? (v.css({
					left: 0,
					top: 0
				}), v.toggleClass("blurs", j.blur), r.bind("focusin" + l,
				function(d) {
					var e = a(d.target).closest(".qtip"); ! (1 > e.length ? o: parseInt(e[0].style.zIndex, 10) > parseInt(m[0].style.zIndex, 10)) && a(d.target).closest(F)[0] !== m[0] && m.find("input:visible").filter(":first").focus()
				})) : r.undelegate("*", "focusin" + l);
				v.stop(n, o);
				a.isFunction(d) ? d.call(v, e) : d === o ? v[s]() : v.fadeTo(parseInt(k, 10) || 90, e ? 1 : 0,
				function() {
					e || a(this).hide()
				});
				e || v.queue(function(a) {
					v.css({
						left: "",
						top: ""
					});
					a()
				});
				return g
			},
			show: function(a, d) {
				return g.toggle(a, n, d)
			},
			hide: function(a, d) {
				return g.toggle(a, o, d)
			},
			destroy: function() {
				var g = v;
				g && (g = 1 > a("[is-modal-qtip]").not(m).length, g ? (k.overlay.remove(), a(e).unbind(".qtipmodal")) : k.overlay.unbind(".qtipmodal" + d.id), r.undelegate("*", "focusin" + l));
				return m.removeAttr("is-modal-qtip").unbind(".qtipmodal")
			}
		});
		g.init()
	}
	function j(e) {
		function g(a) {
			var d = "y" === a.precedance,
			e = z[d ? "width": "height"],
			j = z[d ? "height": "width"],
			k = -1 < a.string().indexOf("center"),
			m = e * (k ? 0.5 : 1),
			n = Math.pow;
			a = Math.round;
			var l = Math.sqrt(n(m, 2) + n(j, 2)),
			m = [F / m * l, F / j * l];
			m[2] = Math.sqrt(n(m[0], 2) - n(F, 2));
			m[3] = Math.sqrt(n(m[1], 2) - n(F, 2));
			k = (l + m[2] + m[3] + (k ? 0 : m[0])) / l;
			e = [a(k * j), a(k * e)];
			return {
				height: e[d ? 0 : 1],
				width: e[d ? 1 : 0]
			}
		}
		function j(a, d, e) {
			d = d ? d: a[a.precedance];
			var g = u.hasClass(J);
			a = v.titlebar && "top" === a.y ? v.titlebar: v.content;
			d = "border-" + d + "-width";
			u.addClass(J);
			a = parseInt(a.css(d), 10);
			a = (e ? a || parseInt(u.css(d), 10) : a) || 0;
			u.toggleClass(J, g);
			return a
		}
		function k(a, g, j) {
			if (v.tip) {
				a = m.corner.clone();
				g = j.adjusted;
				var r = e.options.position.adjust.method.split(" "),
				s = r[0],
				r = r[1] || r[0],
				u = o,
				z = o,
				D = 0,
				E = 0,
				F,
				I = {},
				G;
				m.corner.fixed !== n && ("shift" === s && "x" === a.precedance && g.left && "center" !== a.y ? a.precedance = "x" === a.precedance ? "y": "x": "flip" === s && g.left && (a.x = "center" === a.x ? 0 < g.left ? "left": "right": "left" === a.x ? "right": "left"), "shift" === r && "y" === a.precedance && g.top && "center" !== a.x ? a.precedance = "y" === a.precedance ? "x": "y": "flip" === r && g.top && (a.y = "center" === a.y ? 0 < g.top ? "top": "bottom": "top" === a.y ? "bottom": "top"), a.string() !== B.corner.string() && (B.top !== g.top || B.left !== g.left) && m.update(a, o));
				F = m.position(a, g);
				F.right !== d && (F.left = -F.right);
				F.bottom !== d && (F.top = -F.bottom);
				F.user = Math.max(0, l.offset);
				if (u = "shift" === s && !!g.left)"center" === a.x ? I["margin-left"] = D = F["margin-left"] - g.left: (G = F.right !== d ? [g.left, -F.left] : [ - g.left, F.left], (D = Math.max(G[0], G[1])) > G[0] && (j.left -= g.left, u = o), I[F.right !== d ? "right": "left"] = D);
				if (z = "shift" === r && !!g.top)"center" === a.y ? I["margin-top"] = E = F["margin-top"] - g.top: (G = F.bottom !== d ? [g.top, -F.top] : [ - g.top, F.top], (E = Math.max(G[0], G[1])) > G[0] && (j.top -= g.top, z = o), I[F.bottom !== d ? "bottom": "top"] = E);
				v.tip.css(I).toggle(!(D && E || "center" === a.x && E || "center" === a.y && D));
				j.left -= F.left.charAt ? F.user: "shift" !== s || z || !u && !z ? F.left: 0;
				j.top -= F.top.charAt ? F.user: "shift" !== r || u || !u && !z ? F.top: 0;
				B.left = g.left;
				B.top = g.top;
				B.corner = a.clone()
			}
		}
		var m = this,
		l = e.options.style.tip,
		v = e.elements,
		u = v.tooltip,
		B = {
			top: 0,
			left: 0
		},
		z = {
			width: l.width,
			height: l.height
		},
		D,
		E,
		F = l.border || 0,
		I = !!(a("\x3ccanvas /\x3e")[0] || {}).getContext;
		m.mimic = m.corner = r;
		m.border = F;
		m.offset = l.offset;
		m.size = z;
		e.checks.tip = {
			"^position.my|style.tip.(corner|mimic|border)$": function() {
				m.init() || m.destroy();
				e.reposition()
			},
			"^style.tip.(height|width)$": function() {
				z = {
					width: l.width,
					height: l.height
				};
				m.create();
				m.update();
				e.reposition()
			},
			"^content.title.text|style.(classes|widget)$": function() {
				v.tip && m.update()
			}
		};
		a.extend(m, {
			init: function() {
				var d = m.detectCorner() && (I || a.browser.msie);
				d && (m.create(), m.update(), u.unbind(".qtip-tip").bind("tooltipmove.qtip-tip", k));
				return d
			},
			detectCorner: function() {
				var a = l.corner,
				d = e.options.position,
				g = d.at,
				d = d.my.string ? d.my.string() : d.my;
				if (a === o || d === o && g === o) return o;
				a === n ? m.corner = new s.Corner(d) : a.string || (m.corner = new s.Corner(a), m.corner.fixed = n);
				B.corner = new s.Corner(m.corner.string());
				return "centercenter" !== m.corner.string()
			},
			detectColours: function(d) {
				var g, j, k = v.tip.css("cssText", "");
				g = d || m.corner;
				var n = g[g.precedance];
				d = "border-" + n + "-color";
				j = "border" + n.charAt(0) + n.substr(1) + "Color";
				var n = /rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,
				o = a(document.body).css("color");
				e.elements.content.css("color");
				var r = v.titlebar && ("top" === g.y || "center" === g.y && k.position().top + z.height / 2 + l.offset < v.titlebar.outerHeight(1)) ? v.titlebar: v.content;
				u.addClass(J);
				D = g = k.css("background-color");
				E = j = k[0].style[j] || k.css(d) || u.css(d);
				if (!g || n.test(g)) D = r.css("background-color") || "transparent",
				n.test(D) && (D = u.css("background-color") || g);
				if (!j || n.test(j) || j === o) E = r.css(d) || "transparent",
				n.test(E) && (E = j);
				a("*", k).add(k).css("cssText", "background-color:transparent !important;border:0 !important;");
				u.removeClass(J)
			},
			create: function() {
				var d = z.width,
				e = z.height;
				v.tip && v.tip.remove();
				v.tip = a("\x3cdiv /\x3e", {
					"class": "ui-tooltip-tip"
				}).css({
					width: d,
					height: e
				}).prependTo(u);
				I ? a("\x3ccanvas /\x3e").appendTo(v.tip)[0].getContext("2d").save() : (v.tip.html('\x3cvml:shape coordorigin\x3d"0,0" style\x3d"display:inline-block; position:absolute; behavior:url(#default#VML);"\x3e\x3c/vml:shape\x3e\x3cvml:shape coordorigin\x3d"0,0" style\x3d"display:inline-block; position:absolute; behavior:url(#default#VML);"\x3e\x3c/vml:shape\x3e'), a("*", v.tip).bind("click mousedown",
				function(a) {
					a.stopPropagation()
				}))
			},
			update: function(d, e) {
				var k = v.tip,
				u = k.children(),
				G = z.width,
				J = z.height,
				C = l.mimic,
				O = Math.round,
				K,
				N,
				T,
				ca,
				va;
				d || (d = B.corner || m.corner);
				C === o ? C = d: (C = new s.Corner(C), C.precedance = d.precedance, "inherit" === C.x ? C.x = d.x: "inherit" === C.y ? C.y = d.y: C.x === C.y && (C[d.precedance] = d[d.precedance]));
				K = C.precedance;
				m.detectColours(d);
				"transparent" !== E && "#123456" !== E ? (F = j(d, r, n), 0 === l.border && 0 < F && (D = E), m.border = F = l.border !== n ? l.border: F) : m.border = F = 0;
				va = C;
				var za = Math.ceil(G / 2),
				ea = Math.ceil(J / 2),
				za = {
					bottomright: [[0, 0], [G, J], [G, 0]],
					bottomleft: [[0, 0], [G, 0], [0, J]],
					topright: [[0, J], [G, 0], [G, J]],
					topleft: [[0, 0], [0, J], [G, J]],
					topcenter: [[0, J], [za, 0], [G, J]],
					bottomcenter: [[0, 0], [G, 0], [za, J]],
					rightcenter: [[0, 0], [G, ea], [0, J]],
					leftcenter: [[G, 0], [G, J], [0, ea]]
				};
				za.lefttop = za.bottomright;
				za.righttop = za.bottomleft;
				za.leftbottom = za.topright;
				za.rightbottom = za.topleft;
				T = za[va.string()];
				m.size = va = g(d);
				k.css(va);
				"y" === d.precedance ? ca = [O("left" === C.x ? F: "right" === C.x ? va.width - G - F: (va.width - G) / 2), O("top" === C.y ? va.height - J: 0)] : ca = [O("left" === C.x ? va.width - G: 0), O("top" === C.y ? F: "bottom" === C.y ? va.height - J - F: (va.height - J) / 2)];
				I ? (u.attr(va), N = u[0].getContext("2d"), N.restore(), N.save(), N.clearRect(0, 0, 3E3, 3E3), N.translate(ca[0], ca[1]), N.beginPath(), N.moveTo(T[0][0], T[0][1]), N.lineTo(T[1][0], T[1][1]), N.lineTo(T[2][0], T[2][1]), N.closePath(), N.fillStyle = D, N.strokeStyle = E, N.lineWidth = 2 * F, N.lineJoin = "miter", N.miterLimit = 100, F && N.stroke(), N.fill()) : (T = "m" + T[0][0] + "," + T[0][1] + " l" + T[1][0] + "," + T[1][1] + " " + T[2][0] + "," + T[2][1] + " xe", ca[2] = F && /^(r|b)/i.test(d.string()) ? 8 === parseFloat(a.browser.version, 10) ? 2 : 1 : 0, u.css({
					antialias: "" + ( - 1 < C.string().indexOf("center")),
					left: ca[0] - ca[2] * Number("x" === K),
					top: ca[1] - ca[2] * Number("y" === K),
					width: G + F,
					height: J + F
				}).each(function(d) {
					var e = a(this);
					e[e.prop ? "prop": "attr"]({
						coordsize: G + F + " " + (J + F),
						path: T,
						fillcolor: D,
						filled: !!d,
						stroked: !d
					}).css({
						display: F || d ? "block": "none"
					}); ! d && "" === e.html() && e.html('\x3cvml:stroke weight\x3d"' + 2 * F + 'px" color\x3d"' + E + '" miterlimit\x3d"1000" joinstyle\x3d"miter"  style\x3d"behavior:url(#default#VML); display:inline-block;" /\x3e')
				}));
				e !== o && m.position(d)
			},
			position: function(d) {
				var e = v.tip,
				k = {},
				r = Math.max(0, l.offset),
				s,
				B,
				z;
				if (l.corner === o || !e) return o;
				d = d || m.corner;
				s = d.precedance;
				B = g(d);
				z = [d.x, d.y];
				"x" === s && z.reverse();
				a.each(z,
				function(e, g) {
					var m;
					if ("center" === g) m = "y" === s ? "left": "top",
					k[m] = "50%",
					k["margin-" + m] = -Math.round(B["y" === s ? "width": "height"] / 2) + r;
					else {
						m = j(d, g, n);
						var l;
						l = a.browser.mozilla;
						var o = d.y + (l ? "": "-") + d.x;
						l = (l ? "-moz-": a.browser.webkit ? "-webkit-": "") + (l ? "border-radius-" + o: "border-" + o + "-radius");
						l = parseInt((v.titlebar && "top" === d.y ? v.titlebar: v.content).css(l), 10) || parseInt(u.css(l), 10) || 0;
						k[g] = e ? F ? j(d, g) : 0 : r + (l > m ? l: 0)
					}
				});
				k[d[s]] -= B["x" === s ? "width": "height"];
				e.css({
					top: "",
					bottom: "",
					left: "",
					right: "",
					margin: ""
				}).css(k);
				return k
			},
			destroy: function() {
				v.tip && v.tip.remove();
				u.unbind(".qtip-tip")
			}
		});
		m.init()
	}
	function k(g, j, k, m) {
		function Z() {
			var d = [j.show.target[0], j.hide.target[0], H.rendered && V.tooltip[0], j.position.container[0], j.position.viewport[0], e, document];
			H.rendered ? a([]).pushStack(a.grep(d,
			function(a) {
				return "object" === typeof a
			})).unbind(S) : j.show.target.unbind(S + "-create")
		}
		function Y() {
			function d(a) {
				L.is(":visible") && H.reposition(a)
			}
			function m(a) {
				if (L.hasClass(E)) return o;
				clearTimeout(H.timers.inactive);
				H.timers.inactive = setTimeout(function() {
					H.hide(a)
				},
				j.hide.inactive)
			}
			function l(d) {
				if (L.hasClass(E) || ia || ka) return o;
				var e = a(d.relatedTarget || d.target),
				g = e.closest(F)[0] === L[0],
				e = e[0] === v.show[0];
				clearTimeout(H.timers.show);
				clearTimeout(H.timers.hide);
				if ("mouse" === s.target && g || j.hide.fixed && /mouse(out|leave|move)/.test(d.type) && (g || e)) try {
					d.preventDefault(),
					d.stopImmediatePropagation()
				} catch(k) {} else 0 < j.hide.delay ? H.timers.hide = setTimeout(function() {
					H.hide(d)
				},
				j.hide.delay) : H.hide(d)
			}
			function r(a) {
				if (L.hasClass(E)) return o;
				clearTimeout(H.timers.show);
				clearTimeout(H.timers.hide);
				var d = function() {
					H.toggle(n, a)
				};
				0 < j.show.delay ? H.timers.show = setTimeout(d, j.show.delay) : d()
			}
			var s = j.position,
			v = {
				show: j.show.target,
				hide: j.hide.target,
				viewport: a(s.viewport),
				document: a(document),
				body: a(document.body),
				window: a(e)
			},
			z = a.trim("" + j.show.event).split(" "),
			D = a.trim("" + j.hide.event).split(" "),
			I = a.browser.msie && 6 === parseInt(a.browser.version, 10);
			L.bind("mouseenter" + S + " mouseleave" + S,
			function(a) {
				var d = "mouseenter" === a.type;
				d && H.focus(a);
				L.toggleClass(K, d)
			});
			j.hide.fixed && (v.hide = v.hide.add(L), L.bind("mouseover" + S,
			function() {
				L.hasClass(E) || clearTimeout(H.timers.hide)
			}));
			/mouse(out|leave)/i.test(j.hide.event) ? "window" === j.hide.leave && v.window.bind("mouseout" + S + " blur" + S,
			function(a) { / select | option / .test(a.target) && !a.relatedTarget && H.hide(a)
			}) : /mouse(over|enter)/i.test(j.show.event) && v.hide.bind("mouseleave" + S,
			function() {
				clearTimeout(H.timers.show)
			}); - 1 < ("" + j.hide.event).indexOf("unfocus") && v.body.bind("mousedown" + S,
			function(d) {
				var e = a(d.target); ! L.hasClass(E) && L.is(":visible");
				e[0] !== L[0] && 0 === e.parents(F).length && !e.closest(g).length && !e.attr("disabled") && H.hide(d)
			});
			"number" === typeof j.hide.inactive && (v.show.bind("qtip-" + k + "-inactive", m), a.each(u.inactiveEvents,
			function(a, d) {
				v.hide.add(V.tooltip).bind(d + S + "-inactive", m)
			}));
			a.each(D,
			function(d, e) {
				var g = a.inArray(e, z),
				j = a(v.hide); - 1 < g && j.add(v.show).length === j.length || "unfocus" === e ? (v.show.bind(e + S,
				function(a) {
					L.is(":visible") ? l(a) : r(a)
				}), delete z[g]) : v.hide.bind(e + S, l)
			});
			a.each(z,
			function(a, d) {
				v.show.bind(d + S, r)
			});
			"number" === typeof j.hide.distance && v.show.add(L).bind("mousemove" + S,
			function(a) {
				var d = ba.origin || {},
				e = j.hide.distance,
				g = Math.abs; (g(a.pageX - d.pageX) >= e || g(a.pageY - d.pageY) >= e) && H.hide(a)
			});
			"mouse" === s.target && (v.show.bind("mousemove" + S,
			function(a) {
				B = {
					pageX: a.pageX,
					pageY: a.pageY,
					type: "mousemove"
				}
			}), s.adjust.mouse && (j.hide.event && (L.bind("mouseleave" + S,
			function(a) { (a.relatedTarget || a.target) !== v.show[0] && H.hide(a)
			}), V.target.bind("mouseenter" + S + " mouseleave" + S,
			function(a) {
				ba.onTarget = "mouseenter" === a.type
			})), v.document.bind("mousemove" + S,
			function(a) {
				ba.onTarget && !L.hasClass(E) && L.is(":visible") && H.reposition(a || B)
			}))); (s.adjust.resize || v.viewport.length) && (a.event.special.resize ? v.viewport: v.window).bind("resize" + S, d); (v.viewport.length || I && "fixed" === L.css("position")) && v.viewport.bind("scroll" + S, d)
		}
		function W(e, j) {
			function k(e) {
				function g(d) {
					d && (delete l[d.src], clearTimeout(H.timers.img[d.src]), a(d).unbind(S));
					a.isEmptyObject(l) && (H.redraw(), j !== o && H.reposition(ba.event), e())
				}
				var n, l = {};
				if (0 === (n = m.find("img:not([height]):not([width])")).length) return g();
				n.each(function(e, j) {
					if (l[j.src] === d) {
						var k = 0; (function sa() {
							if (j.height || j.width || 3 < k) return g(j);
							k += 1;
							H.timers.img[j.src] = setTimeout(sa, 700)
						})();
						a(j).bind("error" + S + " load" + S,
						function() {
							g(this)
						});
						l[j.src] = j
					}
				})
			}
			var m = V.content;
			if (!H.rendered || !e) return o;
			a.isFunction(e) && (e = e.call(g, ba.event, H) || "");
			e.jquery && 0 < e.length ? m.empty().append(e.css({
				display: "block"
			})) : m.html(e);
			0 > H.rendered ? L.queue("fx", k) : (ka = 0, k(a.noop));
			return H
		}
		function ca(d, e) {
			var j = V.title;
			if (!H.rendered || !d) return o;
			a.isFunction(d) && (d = d.call(g, ba.event, H));
			if (d === o) return ja(o);
			d.jquery && 0 < d.length ? j.empty().append(d.css({
				display: "block"
			})) : j.html(d);
			H.redraw();
			e !== o && H.rendered && L.is(":visible") && H.reposition(ba.event)
		}
		function ha() {
			var d = oa + "-title";
			V.titlebar && ja();
			V.titlebar = a("\x3cdiv /\x3e", {
				"class": v + "-titlebar " + (j.style.widget ? "ui-widget-header": "")
			}).append(V.title = a("\x3cdiv /\x3e", {
				id: d,
				"class": v + "-title",
				"aria-atomic": n
			})).insertBefore(V.content).delegate(".ui-tooltip-close", "mousedown keydown mouseup keyup mouseout",
			function(d) {
				a(this).toggleClass("ui-state-active ui-state-focus", "down" === d.type.substr( - 4))
			}).delegate(".ui-tooltip-close", "mouseover mouseout",
			function(d) {
				a(this).toggleClass("ui-state-hover", "mouseover" === d.type)
			});
			j.content.title.button ? M() : H.rendered && H.redraw()
		}
		function M() {
			var d = j.content.title.button,
			e = "string" === typeof d ? d: "Close tooltip";
			V.button && V.button.remove();
			d.jquery ? V.button = d: V.button = a("\x3ca /\x3e", {
				"class": "ui-state-default ui-tooltip-close " + (j.style.widget ? "": v + "-icon"),
				title: e,
				"aria-label": e
			}).prepend(a("\x3cspan /\x3e", {
				"class": "ui-icon ui-icon-close",
				html: "\x26times;"
			}));
			V.button.appendTo(V.titlebar).attr("role", "button").click(function(a) {
				L.hasClass(E) || H.hide(a);
				return o
			});
			H.redraw()
		}
		function ja(a) {
			V.title && (V.titlebar.remove(), V.titlebar = V.title = V.button = r, a !== o && H.reposition())
		}
		function P() {
			var a = j.style.widget;
			L.toggleClass(D, a).toggleClass(I, j.style["default"] && !a);
			V.content.toggleClass(D + "-content", a);
			V.titlebar && V.titlebar.toggleClass(D + "-header", a);
			V.button && V.button.toggleClass(v + "-icon", !a)
		}
		function ua(a) {
			var d = 0,
			e, g = j;
			for (a = a.split("."); g = g[a[d++]];) d < a.length && (e = g);
			return [e || j, a.pop()]
		}
		var H = this,
		fa = document.body,
		oa = v + "-" + k,
		ia = 0,
		ka = 0,
		L = a(),
		S = ".qtip-" + k,
		V,
		ba;
		H.id = k;
		H.rendered = o;
		H.elements = V = {
			target: g
		};
		H.timers = {
			img: {}
		};
		H.options = j;
		H.checks = {};
		H.plugins = {};
		H.cache = ba = {
			event: {},
			target: a(),
			disabled: o,
			attr: m,
			onTarget: o
		};
		H.checks.builtin = {
			"^id$": function(d, e, g) {
				d = g === n ? u.nextid: g;
				e = v + "-" + d;
				d !== o && 0 < d.length && !a("#" + e).length && (L[0].id = e, V.content[0].id = e + "-content", V.title[0].id = e + "-title")
			},
			"^content.text$": function(a, d, e) {
				W(e)
			},
			"^content.title.text$": function(a, d, e) {
				if (!e) return ja(); ! V.title && e && ha();
				ca(e)
			},
			"^content.title.button$": function(a, d, e) {
				a = V.button;
				d = V.title;
				H.rendered && (e ? (d || ha(), M()) : a.remove())
			},
			"^position.(my|at)$": function(a, d, e) {
				"string" === typeof e && (a[d] = new s.Corner(e))
			},
			"^position.container$": function(a, d, e) {
				H.rendered && L.appendTo(e)
			},
			"^show.ready$": function() {
				H.rendered ? H.toggle(n) : H.render(1)
			},
			"^style.classes$": function(a, d, e) {
				L.attr("class", v + " qtip ui-helper-reset " + e)
			},
			"^style.widget|content.title": P,
			"^events.(render|show|move|hide|focus|blur)$": function(d, e, g) {
				L[(a.isFunction(g) ? "": "un") + "bind"]("tooltip" + e, g)
			},
			"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)": function() {
				var a = j.position;
				L.attr("tracking", "mouse" === a.target && a.adjust.mouse);
				Z();
				Y()
			}
		};
		a.extend(H, {
			render: function(d) {
				if (H.rendered) return H;
				var e = j.content.text,
				k = j.content.title.text,
				m = j.position,
				l = a.Event("tooltiprender");
				a.attr(g[0], "aria-describedby", oa);
				L = V.tooltip = a("\x3cdiv/\x3e", {
					id: oa,
					"class": v + " qtip ui-helper-reset " + I + " " + j.style.classes + " " + v + "-pos-" + j.position.my.abbrev(),
					width: j.style.width || "",
					height: j.style.height || "",
					tracking: "mouse" === m.target && m.adjust.mouse,
					role: "alert",
					"aria-live": "polite",
					"aria-atomic": o,
					"aria-describedby": oa + "-content",
					"aria-hidden": n
				}).toggleClass(E, ba.disabled).data("qtip", H).appendTo(j.position.container).append(V.content = a("\x3cdiv /\x3e", {
					"class": v + "-content",
					id: oa + "-content",
					"aria-atomic": n
				}));
				H.rendered = -1;
				ia = ka = 1;
				k && (ha(), a.isFunction(k) || ca(k, o));
				a.isFunction(e) || W(e, o);
				H.rendered = n;
				P();
				a.each(j.events,
				function(d, e) {
					a.isFunction(e) && L.bind("toggle" === d ? "tooltipshow tooltiphide": "tooltip" + d, e)
				});
				a.each(s,
				function() {
					"render" === this.initialize && this(H)
				});
				Y();
				L.queue("fx",
				function(a) {
					l.originalEvent = ba.event;
					L.trigger(l, [H]);
					ia = ka = 0;
					H.redraw(); (j.show.ready || d) && H.toggle(n, ba.event, o);
					a()
				});
				return H
			},
			get: function(a) {
				switch (a.toLowerCase()) {
				case "dimensions":
					a = {
						height: L.outerHeight(),
						width: L.outerWidth()
					};
					break;
				case "offset":
					a = s.offset(L, j.position.container);
					break;
				default:
					a = ua(a.toLowerCase()),
					a = a[0][a[1]],
					a = a.precedance ? a.string() : a
				}
				return a
			},
			set: function(d, e) {
				var g = /^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,
				k = /^content\.(title|attr)|style/i,
				m = o,
				s = o,
				v = H.checks,
				u;
				"string" === typeof d ? (u = d, d = {},
				d[u] = e) : d = a.extend(n, {},
				d);
				a.each(d,
				function(e, j) {
					var n = ua(e.toLowerCase()),
					l;
					l = n[0][n[1]];
					n[0][n[1]] = "object" === typeof j && j.nodeType ? a(j) : j;
					d[e] = [n[0], n[1], j, l];
					m = g.test(e) || m;
					s = k.test(e) || s
				});
				l(j);
				ia = ka = 1;
				a.each(d,
				function(a, d) {
					var e, g, j;
					for (e in v) for (g in v[e]) if (j = RegExp(g, "i").exec(a)) d.push(j),
					v[e][g].apply(H, d)
				});
				ia = ka = 0;
				L.is(":visible") && H.rendered && (m && H.reposition("mouse" === j.position.target ? r: ba.event), s && H.redraw());
				return H
			},
			toggle: function(d, e, g) {
				function m() {
					d ? (a.browser.msie && L[0].style.removeAttribute("filter"), L.css("overflow", ""), "string" === typeof s.autofocus && a(s.autofocus, L).focus(), E = a.Event("tooltipvisible"), E.originalEvent = e ? ba.event: r, L.trigger(E, [H]), s.target.trigger("qtip-" + k + "-inactive")) : L.css({
						display: "",
						visibility: "",
						opacity: "",
						left: "",
						top: ""
					})
				}
				if (!H.rendered) return d ? H.render(1) : H;
				var l = d ? "show": "hide",
				s = j[l],
				v = L.is(":visible"),
				u = !e || 2 > j[l].target.length || ba.target[0] === e.target,
				z = j.position,
				D = j.content,
				E; (typeof d).search("boolean|number") && (d = !v);
				if (!L.is(":animated") && v === d && u) return H;
				if (e) {
					if (/over|enter/.test(e.type) && /out|leave/.test(ba.event.type) && e.target === j.show.target[0] && L.has(e.relatedTarget).length) return H;
					ba.event = a.extend({},
					e)
				}
				E = a.Event("tooltip" + l);
				E.originalEvent = e ? ba.event: r;
				L.trigger(E, [H, 90]);
				if (E.isDefaultPrevented()) return H;
				a.attr(L[0], "aria-hidden", !d);
				d ? (ba.origin = a.extend({},
				B), H.focus(e), a.isFunction(D.text) && W(D.text, o), a.isFunction(D.title.text) && ca(D.title.text, o), !N && "mouse" === z.target && z.adjust.mouse && (a(document).bind("mousemove.qtip",
				function(a) {
					B = {
						pageX: a.pageX,
						pageY: a.pageY,
						type: "mousemove"
					}
				}), N = n), H.reposition(e, g), (E.solo = !!s.solo) && a(F, s.solo).not(L).qtip("hide", E)) : (clearTimeout(H.timers.show), delete ba.origin, N && !a(F + '[tracking\x3d"true"]:visible', s.solo).not(L).length && (a(document).unbind("mousemove.qtip"), N = o), H.blur(e));
				u && L.stop(0, 1);
				s.effect === o ? (L[l](), m.call(L)) : a.isFunction(s.effect) ? (s.effect.call(L, H), L.queue("fx",
				function(a) {
					m();
					a()
				})) : L.fadeTo(90, d ? 1 : 0, m);
				d && s.target.trigger("qtip-" + k + "-inactive");
				return H
			},
			show: function(a) {
				return H.toggle(n, a)
			},
			hide: function(a) {
				return H.toggle(o, a)
			},
			focus: function(d) {
				if (!H.rendered) return H;
				var e = a(F),
				g = parseInt(L[0].style.zIndex, 10),
				j = u.zindex + e.length;
				d = a.extend({},
				d);
				var k;
				L.hasClass(G) || (k = a.Event("tooltipfocus"), k.originalEvent = d, L.trigger(k, [H, j]), k.isDefaultPrevented() || (g !== j && (e.each(function() {
					this.style.zIndex > g && (this.style.zIndex -= 1)
				}), e.filter("." + G).qtip("blur", d)), L.addClass(G)[0].style.zIndex = j));
				return H
			},
			blur: function(d) {
				d = a.extend({},
				d);
				var e;
				L.removeClass(G);
				e = a.Event("tooltipblur");
				e.originalEvent = d;
				L.trigger(e, [H]);
				return H
			},
			reposition: function(d, g) {
				if (!H.rendered || ia) return H;
				ia = 1;
				var k = j.position.target,
				m = j.position,
				n = m.my,
				l = m.at,
				r = m.adjust,
				u = r.method.split(" "),
				z = L.outerWidth(),
				D = L.outerHeight(),
				E = 0,
				F = 0,
				I = a.Event("tooltipmove"),
				G = "fixed" === L.css("position"),
				J = m.viewport,
				C = {
					left: 0,
					top: 0
				},
				S = m.container,
				W = o,
				O = H.plugins.tip,
				M = {
					horizontal: u[0],
					vertical: u[1] = u[1] || u[0],
					enabled: J.jquery && k[0] !== e && k[0] !== fa && "none" !== r.method,
					left: function(a) {
						var d = "shift" === M.horizontal,
						e = -S.offset.left + J.offset.left + J.scrollLeft,
						g = "left" === n.x ? z: "right" === n.x ? -z: -z / 2,
						j = "left" === l.x ? E: "right" === l.x ? -E: -E / 2,
						k = O && O.size ? O.size.width || 0 : 0,
						m = O && O.corner && "x" === O.corner.precedance && !d ? k: 0,
						o = e - a + m,
						s = a + z - J.width - e + m,
						j = g - ("x" === n.precedance || n.x === n.y ? j: 0) - ("center" === l.x ? E / 2 : 0),
						v = "center" === n.x;
						d ? (m = O && O.corner && "y" === O.corner.precedance ? k: 0, j = ("left" === n.x ? 1 : -1) * g - m, C.left += 0 < o ? o: 0 < s ? -s: 0, C.left = Math.max( - S.offset.left + J.offset.left + (m && "center" === O.corner.x ? O.offset: 0), a - j, Math.min(Math.max( - S.offset.left + J.offset.left + J.width, a + j), C.left))) : (0 < o && ("left" !== n.x || 0 < s) ? C.left -= j: 0 < s && ("right" !== n.x || 0 < o) && (C.left -= v ? -j: j), C.left !== a && v && (C.left -= r.x), C.left < e && -C.left > s && (C.left = a));
						return C.left - a
					},
					top: function(a) {
						var d = "shift" === M.vertical,
						e = -S.offset.top + J.offset.top + J.scrollTop,
						g = "top" === n.y ? D: "bottom" === n.y ? -D: -D / 2,
						j = "top" === l.y ? F: "bottom" === l.y ? -F: -F / 2,
						k = O && O.size ? O.size.height || 0 : 0,
						m = O && O.corner && "y" === O.corner.precedance && !d ? k: 0,
						o = e - a + m,
						e = a + D - J.height - e + m,
						j = g - ("y" === n.precedance || n.x === n.y ? j: 0) - ("center" === l.y ? F / 2 : 0),
						s = "center" === n.y;
						d ? (m = O && O.corner && "x" === O.corner.precedance ? k: 0, j = ("top" === n.y ? 1 : -1) * g - m, C.top += 0 < o ? o: 0 < e ? -e: 0, C.top = Math.max( - S.offset.top + J.offset.top + (m && "center" === O.corner.x ? O.offset: 0), a - j, Math.min(Math.max( - S.offset.top + J.offset.top + J.height, a + j), C.top))) : (0 < o && ("top" !== n.y || 0 < e) ? C.top -= j: 0 < e && ("bottom" !== n.y || 0 < o) && (C.top -= s ? -j: j), C.top !== a && s && (C.top -= r.y), 0 > C.top && -C.top > e && (C.top = a));
						return C.top - a
					}
				};
				if (a.isArray(k) && 2 === k.length) l = {
					x: "left",
					y: "top"
				},
				C = {
					left: k[0],
					top: k[1]
				};
				else if ("mouse" === k && (d && d.pageX || ba.event.pageX)) l = {
					x: "left",
					y: "top"
				},
				d = (d && ("resize" === d.type || "scroll" === d.type) ? ba.event: d && d.pageX && "mousemove" === d.type ? d: B && B.pageX && (r.mouse || !d || !d.pageX) ? {
					pageX: B.pageX,
					pageY: B.pageY
				}: !r.mouse && ba.origin && ba.origin.pageX && j.show.distance ? ba.origin: d) || d || ba.event || B || {},
				C = {
					top: d.pageY,
					left: d.pageX
				};
				else {
					"event" === k ? d && d.target && "scroll" !== d.type && "resize" !== d.type ? k = ba.target = a(d.target) : k = ba.target: k = ba.target = a(k.jquery ? k: V.target);
					k = a(k).eq(0);
					if (0 === k.length) return H;
					k[0] === document || k[0] === e ? (E = s.iOS ? e.innerWidth: k.width(), F = s.iOS ? e.innerHeight: k.height(), k[0] === e && (C = {
						top: (J || k).scrollTop(),
						left: (J || k).scrollLeft()
					})) : k.is("area") && s.imagemap ? C = s.imagemap(k, l, M.enabled ? u: o) : "http://www.w3.org/2000/svg" === k[0].namespaceURI && s.svg ? C = s.svg(k, l) : (E = k.outerWidth(), F = k.outerHeight(), C = s.offset(k, S));
					C.offset && (E = C.width, F = C.height, W = C.flipoffset, C = C.offset);
					if (4.1 > s.iOS && 3.1 < s.iOS || 4.3 == s.iOS || !s.iOS && G) u = a(e),
					C.left -= u.scrollLeft(),
					C.top -= u.scrollTop();
					C.left += "right" === l.x ? E: "center" === l.x ? E / 2 : 0;
					C.top += "bottom" === l.y ? F: "center" === l.y ? F / 2 : 0
				}
				C.left += r.x + ("right" === n.x ? -z: "center" === n.x ? -z / 2 : 0);
				C.top += r.y + ("bottom" === n.y ? -D: "center" === n.y ? -D / 2 : 0);
				M.enabled ? (J = {
					elem: J,
					height: J[(J[0] === e ? "h": "outerH") + "eight"](),
					width: J[(J[0] === e ? "w": "outerW") + "idth"](),
					scrollLeft: G ? 0 : J.scrollLeft(),
					scrollTop: G ? 0 : J.scrollTop(),
					offset: J.offset() || {
						left: 0,
						top: 0
					}
				},
				S = {
					elem: S,
					scrollLeft: S.scrollLeft(),
					scrollTop: S.scrollTop(),
					offset: S.offset() || {
						left: 0,
						top: 0
					}
				},
				C.adjusted = {
					left: "none" !== M.horizontal ? M.left(C.left) : 0,
					top: "none" !== M.vertical ? M.top(C.top) : 0
				},
				C.adjusted.left + C.adjusted.top && L.attr("class", L[0].className.replace(/ui-tooltip-pos-\w+/i, v + "-pos-" + n.abbrev())), W && C.adjusted.left && (C.left += W.left), W && C.adjusted.top && (C.top += W.top)) : C.adjusted = {
					left: 0,
					top: 0
				};
				I.originalEvent = a.extend({},
				d);
				L.trigger(I, [H, C, J.elem || J]);
				if (I.isDefaultPrevented()) return H;
				delete C.adjusted;
				g === o || isNaN(C.left) || isNaN(C.top) || "mouse" === k || !a.isFunction(m.effect) ? L.css(C) : a.isFunction(m.effect) && (m.effect.call(L, H, a.extend({},
				C)), L.queue(function(d) {
					a(this).css({
						opacity: "",
						height: ""
					});
					a.browser.msie && this.style.removeAttribute("filter");
					d()
				}));
				ia = 0;
				return H
			},
			redraw: function() {
				if (1 > H.rendered || ka) return H;
				var a = j.position.container,
				d, e, g, k;
				ka = 1;
				j.style.height && L.css("height", j.style.height);
				j.style.width ? L.css("width", j.style.width) : (L.css("width", "").addClass(J), e = L.width() + 1, g = L.css("max-width") || "", k = L.css("min-width") || "", d = -1 < (g + k).indexOf("%") ? a.width() / 100 : 0, g = ( - 1 < g.indexOf("%") ? d: 1) * parseInt(g, 10) || e, k = ( - 1 < k.indexOf("%") ? d: 1) * parseInt(k, 10) || 0, e = g + k ? Math.min(Math.max(e, k), g) : e, L.css("width", Math.round(e)).removeClass(J));
				ka = 0;
				return H
			},
			disable: function(d) {
				"boolean" !== typeof d && (d = !L.hasClass(E) && !ba.disabled);
				H.rendered ? (L.toggleClass(E, d), a.attr(L[0], "aria-disabled", d)) : ba.disabled = !!d;
				return H
			},
			enable: function() {
				return H.disable(o)
			},
			destroy: function() {
				var d = g[0],
				e = a.attr(d, C),
				m = g.data("qtip");
				H.rendered && (L.remove(), a.each(H.plugins,
				function() {
					this.destroy && this.destroy()
				}));
				clearTimeout(H.timers.show);
				clearTimeout(H.timers.hide);
				Z();
				if (!m || H === m) a.removeData(d, "qtip"),
				j.suppress && e && (a.attr(d, "title", e), g.removeAttr(C)),
				g.removeAttr("aria-describedby");
				g.unbind(".qtip-" + k);
				delete z[H.id];
				return g
			}
		})
	}
	function l(d) {
		var e;
		if (!d || "object" !== typeof d) return o;
		if (d.metadata === r || "object" !== typeof d.metadata) d.metadata = {
			type: d.metadata
		};
		if ("content" in d) {
			if (d.content === r || "object" !== typeof d.content || d.content.jquery) d.content = {
				text: d.content
			};
			e = d.content.text || o; ! a.isFunction(e) && (!e && !e.attr || 1 > e.length || "object" === typeof e && !e.jquery) && (d.content.text = o);
			if ("title" in d.content) {
				if (d.content.title === r || "object" !== typeof d.content.title) d.content.title = {
					text: d.content.title
				};
				e = d.content.title.text || o; ! a.isFunction(e) && (!e && !e.attr || 1 > e.length || "object" === typeof e && !e.jquery) && (d.content.title.text = o)
			}
		}
		if ("position" in d && (d.position === r || "object" !== typeof d.position)) d.position = {
			my: d.position,
			at: d.position
		};
		if ("show" in d && (d.show === r || "object" !== typeof d.show)) d.show.jquery ? d.show = {
			target: d.show
		}: d.show = {
			event: d.show
		};
		if ("hide" in d && (d.hide === r || "object" !== typeof d.hide)) d.hide.jquery ? d.hide = {
			target: d.hide
		}: d.hide = {
			event: d.hide
		};
		if ("style" in d && (d.style === r || "object" !== typeof d.style)) d.style = {
			classes: d.style
		};
		a.each(s,
		function() {
			this.sanitize && this.sanitize(d)
		});
		return d
	}
	function m() {
		m.history = m.history || [];
		m.history.push(arguments);
		if ("object" === typeof console) {
			var a = console[console.warn ? "warn": "log"],
			d = Array.prototype.slice.call(arguments);
			"string" === typeof arguments[0] && (d[0] = "qTip2: " + d[0]);
			a.apply ? a.apply(console, d) : a(d)
		}
	}
	"use strict";
	var n = !0,
	o = !1,
	r = null,
	u, s, B, z = {},
	v = "ui-tooltip",
	D = "ui-widget",
	E = "ui-state-disabled",
	F = "div.qtip." + v,
	I = v + "-default",
	G = v + "-focus",
	K = v + "-hover",
	J = v + "-fluid",
	C = "oldtitle",
	N;
	u = a.fn.qtip = function(e, g, j) {
		var k = ("" + e).toLowerCase(),
		m = r,
		s = a.makeArray(arguments).slice(1),
		v = s[s.length - 1],
		B = this[0] ? a.data(this[0], "qtip") : r;
		if (!arguments.length && B || "api" === k) return B;
		if ("string" === typeof e) return this.each(function() {
			var e = a.data(this, "qtip");
			if (!e) return n;
			v && v.timeStamp && (e.cache.event = v);
			if ("option" !== k && "options" !== k || !g) e[k] && e[k].apply(e[k], s);
			else if (a.isPlainObject(g) || j !== d) e.set(g, j);
			else return m = e.get(g),
			o
		}),
		m !== r ? m: this;
		if ("object" === typeof e || !arguments.length) return B = l(a.extend(n, {},
		e)),
		u.bind.call(this, B, v)
	};
	u.bind = function(e, g) {
		return this.each(function(j) {
			function v(e) {
				function g() {
					G.render("object" === typeof e || D.show.ready);
					E.show.add(E.hide).unbind(I)
				}
				if (G.cache.disabled) return o;
				G.cache.event = a.extend({},
				e);
				G.cache.target = e ? a(e.target) : [d];
				0 < D.show.delay ? (clearTimeout(G.timers.show), G.timers.show = setTimeout(g, D.show.delay), F.show !== F.hide && E.hide.bind(F.hide,
				function() {
					clearTimeout(G.timers.show)
				})) : g()
			}
			var D, E, F, I, G;
			j = a.isArray(e.id) ? e.id[j] : e.id;
			j = !j || j === o || 1 > j.length || z[j] ? u.nextid++:z[j] = j;
			I = ".qtip-" + j + "-create";
			var J;
			a: {
				var K, P, N, H, fa = a(this),
				oa = a(document.body),
				ia = this === document ? oa: fa;
				P = fa.metadata ? fa.metadata(e.metadata) : r;
				N = "html5" === e.metadata.type && P ? P[e.metadata.name] : r;
				var ka = fa.data(e.metadata.name || "qtipopts");
				try {
					ka = "string" === typeof ka ? (new Function("return " + ka))() : ka
				} catch(L) {
					m("Unable to parse HTML5 attribute data: " + ka)
				}
				N = a.extend(n, {},
				u.defaults, e, "object" === typeof ka ? l(ka) : r, l(N || P));
				P = N.position;
				N.id = j;
				if ("boolean" === typeof N.content.text) if (J = fa.attr(N.content.attr), N.content.attr !== o && J) N.content.text = J;
				else {
					m("Unable to locate content for tooltip! Aborting render of tooltip on element: ", fa);
					J = o;
					break a
				}
				P.container.length || (P.container = oa);
				P.target === o && (P.target = ia);
				N.show.target === o && (N.show.target = ia);
				N.show.solo === n && (N.show.solo = oa);
				N.hide.target === o && (N.hide.target = ia);
				N.position.viewport === n && (N.position.viewport = P.container);
				P.at = new s.Corner(P.at);
				P.my = new s.Corner(P.my);
				if (a.data(this, "qtip")) if (N.overwrite) fa.qtip("destroy");
				else if (N.overwrite === o) {
					J = o;
					break a
				}
				N.suppress && (H = a.attr(this, "title")) && a(this).removeAttr("title").attr(C, H);
				K = new k(fa, N, j, !!J);
				a.data(this, "qtip", K);
				fa.bind("remove.qtip-" + j,
				function() {
					K.destroy()
				});
				J = K
			}
			G = J;
			if (G === o) return n;
			D = G.options;
			a.each(s,
			function() {
				"initialize" === this.initialize && this(G)
			});
			E = {
				show: D.show.target,
				hide: D.hide.target
			};
			F = {
				show: a.trim("" + D.show.event).replace(/ /g, I + " ") + I,
				hide: a.trim("" + D.hide.event).replace(/ /g, I + " ") + I
			};
			/mouse(over|enter)/i.test(F.show) && !/mouse(out|leave)/i.test(F.hide) && (F.hide += " mouseleave" + I);
			E.show.bind("mousemove" + I,
			function(a) {
				B = {
					pageX: a.pageX,
					pageY: a.pageY,
					type: "mousemove"
				};
				G.cache.onTarget = n
			});
			E.show.bind(F.show, v); (D.show.ready || D.prerender) && v(g)
		})
	};
	s = u.plugins = {
		Corner: function(a) {
			a = ("" + a).replace(/([A-Z])/, " $1").replace(/middle/gi, "center").toLowerCase();
			this.x = (a.match(/left|right/i) || a.match(/center/) || ["inherit"])[0].toLowerCase();
			this.y = (a.match(/top|bottom|center/i) || ["inherit"])[0].toLowerCase();
			a = a.charAt(0);
			this.precedance = "t" === a || "b" === a ? "y": "x";
			this.string = function() {
				return "y" === this.precedance ? this.y + this.x: this.x + this.y
			};
			this.abbrev = function() {
				var a = this.x.substr(0, 1),
				d = this.y.substr(0, 1);
				return a === d ? a: "c" === a || "c" !== a && "c" !== d ? d + a: a + d
			};
			this.clone = function() {
				return {
					x: this.x,
					y: this.y,
					precedance: this.precedance,
					string: this.string,
					abbrev: this.abbrev,
					clone: this.clone
				}
			}
		},
		offset: function(a, d) {
			var e = a.offset(),
			g = document.body,
			j = d,
			k,
			m,
			n;
			if (j) {
				do
				if ("static" !== j.css("position") && (m = j.position(), e.left -= m.left + (parseInt(j.css("borderLeftWidth"), 10) || 0) + (parseInt(j.css("marginLeft"), 10) || 0), e.top -= m.top + (parseInt(j.css("borderTopWidth"), 10) || 0) + (parseInt(j.css("marginTop"), 10) || 0), !k && "hidden" !== (n = j.css("overflow")) && "visible" !== n && (k = j)), j[0] === g) break;
				while (j = j.offsetParent());
				k && k[0] !== g && (g = k, e.left += 1 * g.scrollLeft(), e.top += 1 * g.scrollTop())
			}
			return e
		},
		iOS: parseFloat(("" + (/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ""])[1]).replace("undefined", "3_2").replace("_", ".")) || o,
		fn: {
			attr: function(d, e) {
				if (this.length) {
					var g = this[0],
					j = a.data(g, "qtip");
					if ("title" === d && j && "object" === typeof j && j.options.suppress) {
						if (2 > arguments.length) return a.attr(g, C);
						j && "title" === j.options.content.attr && j.cache.attr && j.set("content.text", e);
						return this.attr(C, e)
					}
				}
				return a.fn.attr_replacedByqTip.apply(this, arguments)
			},
			clone: function(d) {
				a([]);
				var e = a.fn.clone_replacedByqTip.apply(this, arguments);
				d || e.filter("[" + C + "]").attr("title",
				function() {
					return a.attr(this, C)
				}).removeAttr(C);
				return e
			},
			remove: a.ui ? r: function(d, e) {
				a.ui || a(this).each(function() {
					e || (!d || a.filter(d, [this]).length) && a("*", this).add(this).each(function() {
						a(this).triggerHandler("remove")
					})
				})
			}
		}
	};
	a.each(s.fn,
	function(d, e) {
		if (!e || a.fn[d + "_replacedByqTip"]) return n;
		var g = a.fn[d + "_replacedByqTip"] = a.fn[d];
		a.fn[d] = function() {
			return e.apply(this, arguments) || g.apply(this, arguments)
		}
	});
	u.version = "nightly";
	u.nextid = 0;
	u.inactiveEvents = "click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" ");
	u.zindex = 15E3;
	u.defaults = {
		prerender: o,
		id: o,
		overwrite: n,
		suppress: n,
		content: {
			text: n,
			attr: "title",
			title: {
				text: o,
				button: o
			}
		},
		position: {
			my: "top left",
			at: "bottom right",
			target: o,
			container: o,
			viewport: o,
			adjust: {
				x: 0,
				y: 0,
				mouse: n,
				resize: n,
				method: "flip flip"
			},
			effect: function(d, e) {
				a(this).animate(e, {
					duration: 200,
					queue: o
				})
			}
		},
		show: {
			target: o,
			event: "mouseenter",
			effect: n,
			delay: 90,
			solo: o,
			ready: o,
			autofocus: o
		},
		hide: {
			target: o,
			event: "mouseleave",
			effect: n,
			delay: 0,
			fixed: o,
			inactive: o,
			leave: "window",
			distance: o
		},
		style: {
			classes: "",
			widget: o,
			width: o,
			height: o,
			"default": n
		},
		events: {
			render: r,
			move: r,
			show: r,
			hide: r,
			toggle: r,
			visible: r,
			focus: r,
			blur: r
		}
	};
	s.imagemap = function(d, e, g) {
		function j(a, d, e) {
			for (var g = 0,
			k = 1,
			m = 1,
			n = 0,
			l = 0,
			o = a.width,
			r = a.height; 0 < o && 0 < r && 0 < k && 0 < m;) {
				o = Math.floor(o / 2);
				r = Math.floor(r / 2);
				"left" === e.x ? k = o: "right" === e.x ? k = a.width - o: k += Math.floor(o / 2);
				"top" === e.y ? m = r: "bottom" === e.y ? m = a.height - r: m += Math.floor(r / 2);
				for (g = d.length; g--&&!(2 > d.length);) n = d[g][0] - a.offset.left,
				l = d[g][1] - a.offset.top,
				("left" === e.x && n >= k || "right" === e.x && n <= k || "center" === e.x && (n < k || n > a.width - k) || "top" === e.y && l >= m || "bottom" === e.y && l <= m || "center" === e.y && (l < m || l > a.height - m)) && d.splice(g, 1)
			}
			return {
				left: d[0][0],
				top: d[0][1]
			}
		}
		d.jquery || (d = a(d));
		var k = (d[0].shape || d.attr("shape")).toLowerCase(),
		m = (d[0].coords || d.attr("coords")).split(","),
		n = [];
		d = a('img[usemap\x3d"#' + d.parent("map").attr("name") + '"]');
		var l = d.offset(),
		o = {
			width: 0,
			height: 0,
			offset: {
				top: 1E10,
				right: 0,
				bottom: 0,
				left: 1E10
			}
		},
		r = 0,
		s = 0;
		l.left += Math.ceil((d.outerWidth() - d.width()) / 2);
		l.top += Math.ceil((d.outerHeight() - d.height()) / 2);
		if ("poly" === k) for (r = m.length; r--;) s = [parseInt(m[--r], 10), parseInt(m[r + 1], 10)],
		s[0] > o.offset.right && (o.offset.right = s[0]),
		s[0] < o.offset.left && (o.offset.left = s[0]),
		s[1] > o.offset.bottom && (o.offset.bottom = s[1]),
		s[1] < o.offset.top && (o.offset.top = s[1]),
		n.push(s);
		else n = a.map(m,
		function(a) {
			return parseInt(a, 10)
		});
		switch (k) {
		case "rect":
			o = {
				width: Math.abs(n[2] - n[0]),
				height: Math.abs(n[3] - n[1]),
				offset: {
					left: Math.min(n[0], n[2]),
					top: Math.min(n[1], n[3])
				}
			};
			break;
		case "circle":
			o = {
				width: n[2] + 2,
				height: n[2] + 2,
				offset: {
					left: n[0],
					top: n[1]
				}
			};
			break;
		case "poly":
			a.extend(o, {
				width: Math.abs(o.offset.right - o.offset.left),
				height: Math.abs(o.offset.bottom - o.offset.top)
			}),
			"centercenter" === e.string() ? o.offset = {
				left: o.offset.left + o.width / 2,
				top: o.offset.top + o.height / 2
			}: (o.offset = j(o, n.slice(), e), g && ("flip" === g[0] || "flip" === g[1]) && (o.flipoffset = j(o, n.slice(), {
				x: "left" === e.x ? "right": "right" === e.x ? "left": "center",
				y: "top" === e.y ? "bottom": "bottom" === e.y ? "top": "center"
			}), o.flipoffset.left -= o.offset.left, o.flipoffset.top -= o.offset.top)),
			o.width = o.height = 0
		}
		o.offset.left += l.left;
		o.offset.top += l.top;
		return o
	};
	s.tip = function(a) {
		var d = a.plugins.tip;
		return "object" === typeof d ? d: a.plugins.tip = new j(a)
	};
	s.tip.initialize = "render";
	s.tip.sanitize = function(a) {
		var d = a.style,
		e;
		d && "tip" in d && (e = a.style.tip, "object" !== typeof e && (a.style.tip = {
			corner: e
		}), /string|boolean/i.test(typeof e.corner) || (e.corner = n), "number" !== typeof e.width && delete e.width, "number" !== typeof e.height && delete e.height, "number" !== typeof e.border && e.border !== n && delete e.border, "number" !== typeof e.offset && delete e.offset)
	};
	a.extend(n, u.defaults, {
		style: {
			tip: {
				corner: n,
				mimic: o,
				width: 6,
				height: 6,
				border: n,
				offset: 0
			}
		}
	});
	s.modal = function(a) {
		var d = a.plugins.modal;
		return "object" === typeof d ? d: a.plugins.modal = new g(a)
	};
	s.modal.initialize = "render";
	s.modal.sanitize = function(a) {
		a.show && ("object" !== typeof a.show.modal ? a.show.modal = {
			on: !!a.show.modal
		}: "undefined" === typeof a.show.modal.on && (a.show.modal.on = n))
	};
	s.modal.zindex = u.zindex + 1E3;
	a.extend(n, u.defaults, {
		show: {
			modal: {
				on: o,
				effect: n,
				blur: n,
				escape: n
			}
		}
	})
})(jQuery, window);
var Base64 = {
	_keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",
	encode: function(a) {
		var e = "",
		d, g, j, k, l, m, n = 0;
		for (a = Base64._utf8_encode(a); n < a.length;) d = a.charCodeAt(n++),
		g = a.charCodeAt(n++),
		j = a.charCodeAt(n++),
		k = d >> 2,
		d = (d & 3) << 4 | g >> 4,
		l = (g & 15) << 2 | j >> 6,
		m = j & 63,
		isNaN(g) ? l = m = 64 : isNaN(j) && (m = 64),
		e = e + Base64._keyStr.charAt(k) + Base64._keyStr.charAt(d) + Base64._keyStr.charAt(l) + Base64._keyStr.charAt(m);
		return e
	},
	decode: function(a) {
		var e = "",
		d, g, j, k, l, m = 0;
		for (a = a.replace(/[^A-Za-z0-9\+\/\=]/g, ""); m < a.length;) d = Base64._keyStr.indexOf(a.charAt(m++)),
		g = Base64._keyStr.indexOf(a.charAt(m++)),
		k = Base64._keyStr.indexOf(a.charAt(m++)),
		l = Base64._keyStr.indexOf(a.charAt(m++)),
		d = d << 2 | g >> 4,
		g = (g & 15) << 4 | k >> 2,
		j = (k & 3) << 6 | l,
		e += String.fromCharCode(d),
		64 != k && (e += String.fromCharCode(g)),
		64 != l && (e += String.fromCharCode(j));
		return e = Base64._utf8_decode(e)
	},
	_utf8_encode: function(a) {
		a = a.replace(/\r\n/g, "\n");
		for (var e = "",
		d = 0; d < a.length; d++) {
			var g = a.charCodeAt(d);
			128 > g ? e += String.fromCharCode(g) : (127 < g && 2048 > g ? e += String.fromCharCode(g >> 6 | 192) : (e += String.fromCharCode(g >> 12 | 224), e += String.fromCharCode(g >> 6 & 63 | 128)), e += String.fromCharCode(g & 63 | 128))
		}
		return e
	},
	_utf8_decode: function(a) {
		for (var e = "",
		d = 0,
		g = c1 = c2 = 0; d < a.length;) g = a.charCodeAt(d),
		128 > g ? (e += String.fromCharCode(g), d++) : 191 < g && 224 > g ? (c2 = a.charCodeAt(d + 1), e += String.fromCharCode((g & 31) << 6 | c2 & 63), d += 2) : (c2 = a.charCodeAt(d + 1), c3 = a.charCodeAt(d + 2), e += String.fromCharCode((g & 15) << 12 | (c2 & 63) << 6 | c3 & 63), d += 3);
		return e
	}
}; (function(a) {
	a.extend({
		url: function(e, d) {
			var g = d || window.location.toString();
			"//" === g.substring(0, 2) ? g = "http:" + g: 1 === g.split("://").length && (g = "http://" + g);
			d = g.split("/");
			var j = "",
			k, l, m;
			m = d[2].split("@");
			1 === m.length ? m = m[0].split(":") : (j = m[0], m = m[1].split(":"));
			k = d[0];
			l = m[0];
			m = m[1] || "80";
			var n = "/" + d.slice(3, d.length).join("/").split("?")[0].split("#")[0];
			1 === n.split(".").length && "/" !== n[n.length - 1] && (n += "/");
			var o = l.split("."),
			r = n.split("/");
			if (e) {
				if ("hostname" === e) return l;
				if ("domain" === e) return o.slice( - 2).join(".");
				if ("tld" === e) return o.slice( - 1).join(".");
				if ("sub" === e) return o.slice(0, o.length - 2).join(".");
				if ("port" === e) return m || "80";
				if ("protocol" === e) return k.split(":")[0];
				if ("auth" === e) return j;
				if ("user" === e) return j.split(":")[0];
				if ("pass" === e) return j.split(":")[1] || "";
				if ("path" === e) return n;
				if ("." === e[0]) {
					if (e = e.substring(1), a.isNumeric(e)) return e = parseInt(e),
					o[0 > e ? o.length + e: e - 1] || ""
				} else {
					if (a.isNumeric(e)) return e = parseInt(e),
					r[0 > e ? r.length - 1 + e: e] || "";
					if ("file" === e) return r.slice( - 1)[0];
					if ("filename" === e) return r.slice( - 1)[0].split(".")[0];
					if ("fileext" === e) return r.slice( - 1)[0].split(".")[1] || "";
					if ("?" === e[0] || "#" === e[0]) {
						j = null;
						"?" === e[0] ? g = (g.split("?")[1] || "").split("#")[0] : "#" === e[0] && (g = g.split("#")[1] || "");
						if (!e[1]) return g;
						e = e.substring(1);
						g = g.split("\x26");
						k = 0;
						for (l = g.length; k < l; k++) if (j = g[k].split("\x3d"), j[0] === e) return j[1];
						return null
					}
				}
			} else return g;
			return ""
		}
	})
})(jQuery);
var _dmCheckInternetTimeout, _dmPostLock = {};
String.prototype.toCamel || (String.prototype.toCamel = function() {
	return this.replace(/( [a-z]|^[a-z])/g,
	function(a) {
		return a.toUpperCase()
	})
});
String.prototype.replaceAll = function(a, e) {
	return this.replace(RegExp(a, "g"), e)
};
"function" !== typeof String.prototype.fixUrl && (String.prototype.fixUrl = function() {
	var a;
	a = this.trim();
	2 < a.lastIndexOf("http://") ? a = a.substring(a.lastIndexOf("http://")) : 2 < a.lastIndexOf("https://") ? a = a.substring(a.lastIndexOf("https://")) : a.startsWith("http://www.www.") && (a = "http://www." + a.substring(15));
	a.startsWith("http") || (a = "http://" + a);
	var e = a.indexOf("/", 7),
	d = a.indexOf("?"); - 1 !== e || -1 !== d ? ( - 1 !== e && (a = a.substring(0, e).toLowerCase() + a.substring(e)), -1 !== d && (a = a.substring(0, d).toLowerCase() + a.substring(d))) : a = a.toLowerCase();
	return a
});
"function" !== typeof Array.prototype.contains && (Array.prototype.contains = function(a) {
	if ($ && "function" === typeof $.inArray) return - 1 != $.inArray(a, this);
	for (a = 0; a < this.length; a++) if (this[a] === obj) return ! 0;
	return ! 1
});
Array.prototype.removeDuplicate = function() {
	for (var a = {},
	e = [], d = 0; d < this.length; d++) {
		var g = this[d];
		a[g] || (a[g] = !0, e.push(g))
	}
	this.splice(0);
	Array.prototype.push.apply(this, e);
	return this
};
Array.prototype.remove = function(a, e) {
	var d = this.slice((e || a) + 1 || this.length);
	this.length = 0 > a ? this.length + a: a;
	return this.push.apply(this, d)
};
Array.prototype.removeValue = function(a) {
	return "undefined" === typeof jQuery ? this: jQuery.grep(this,
	function(e) {
		return e != a
	})
};
Array.prototype.removeElement = function() {
	for (var a, e = arguments,
	d = e.length,
	g; d && this.length;) for (a = e[--d]; - 1 !== (g = this.indexOf(a));) this.splice(g, 1);
	return this
};
Array.prototype.compare = function(a) {
	if (!a || this.length != a.length) return ! 1;
	for (var e = 0; e < this.length; e++) if (this[e] instanceof Array && a[e] instanceof Array) {
		if (!this[e].compare(a[e])) return ! 1
	} else if (this[e] != a[e]) return ! 1;
	return ! 0
}; (function(a) {
	a(document).ready(function() {
		a(document).unbind("keydown.common").bind("keydown.common",
		function(e) {
			a.dmHandleKeydown(e)
		})
	})
})(jQuery);
String.prototype.startsWith || (String.prototype.startsWith = function(a) {
	if ("[object Array]" === Object.prototype.toString.call(a)) {
		for (var e = 0; e < a.length; e++) if (this.startsWith(a[e])) return ! 0;
		return ! 1
	}
	return this.match("^" + a) == a || this.match("^" + a.toLowerCase()) == a.toLowerCase() || this.match("^" + a.toUpperCase()) == a.toUpperCase()
});
String.prototype.endsWith || (String.prototype.endsWith = function(a) {
	if ("[object Array]" === Object.prototype.toString.call(a)) {
		for (var e = 0; e < a.length; e++) if (this.endsWith(a[e])) return ! 0;
		return ! 1
	}
	return this.match(a + "$") == a || this.match(a.toLowerCase() + "$") == a.toLowerCase() || this.match(a.toUpperCase() + "$") == a.toUpperCase()
});
String.prototype.isUrl || (String.prototype.isUrl = function() {
	return /(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(this)
});
String.prototype.isNumeric || (String.prototype.isNumeric = function() {
	return this - 0 == this && 0 < this.length
});
Array.prototype.last || (Array.prototype.last = function(a) {
	return this[this.length + (a ? a: 0) - 1]
});
Array.prototype.filter || (Array.prototype.filter = function(a, e) {
	var d = this.length;
	if ("function" != typeof a) throw new TypeError;
	for (var g = [], j = 0; j < d; j++) if (j in this) {
		var k = this[j];
		a.call(e, k, j, this) && g.push(k)
	}
	return g
});
Function.prototype.clone || (Function.prototype.clone = function() {
	var a = this,
	e = function() {
		return a.apply(this, arguments)
	};
	for (key in this) e[key] = this[key];
	return e
});
$.extend({
	_dmAjaxCtx: {
		afterSucces: null,
		isUndoOn: !0
	},
	dmLinkTypes: [{
		type: "Phone",
		title: "undefined" !== typeof dmStr ? dmStr["ui.nee.linkEditor.20"] : "Phone",
		prefix: "tel:"
	},
	{
		type: "Email",
		title: "undefined" !== typeof dmStr ? dmStr["ui.nee.linkEditor.21"] : "Email",
		prefix: "mailto:"
	},
	{
		type: "SMS",
		title: "undefined" !== typeof dmStr ? dmStr["ui.nee.linkEditor.22"] : "SMS",
		prefix: "sms:"
	}],
	getLinkType: function(a) {
		var e = a ? {
			linkType: {
				type: "URL"
			},
			link: a
		}: void 0;
		e && $.each($.dmLinkTypes,
		function(d, g) {
			a && 0 == a.indexOf(g.prefix) && (e = {
				linkType: g,
				link: a.substr(g.prefix.length)
			})
		});
		return e
	},
	uniqueid: function() {
		return (new Date).getTime()
	},
	dmUndo: {
		set: function(a) {
			$._dmAjaxCtx.isUndoOn = a
		}
	},
	rgb2hex: function(a) {
		function e(a) {
			return ("0" + parseInt(a).toString(16)).slice( - 2)
		}
		"transparent" == a && (a = "rgba(0, 0, 0, 0)");
		_createSmallerRgb = function(a) {
			a = a.split(",");
			a[a.length - 2] = a[a.length - 2].concat(")");
			a.splice(a.length - 1, 1);
			a = a.join();
			return a = a.substr(0, 3) + a.substr(4)
		};
		if ("#" == a.substring(0, 1)) return a;
		3 == a.split(",").length - 1 && (a = _createSmallerRgb(a));
		a = a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
		if (null != a) return "#" + e(a[1]) + e(a[2]) + e(a[3])
	},
	hexToRgba: function(a, e) {
		A = 0 == e ? 0 : e / 100;
		if ("#" == a.substring(0, 1)) RGB = a,
		RGBA = "(" + parseInt(RGB.substring(1, 3), 16) + "," + parseInt(RGB.substring(3, 5), 16) + "," + parseInt(RGB.substring(5, 7), 16) + "," + A + ")";
		else if ("rgba" == a.substring(0, 4)) {
			var d;
			d = a.replace("rgba", "").split(",");
			d[3] = A + ")";
			RGBA = d
		} else RGBA = a.replace("rgb", "").replace(")", ", " + A + ")");
		return "rgba" + RGBA
	},
	isInDevMode: function() {
		return window.dev
	},
	log: function() {
		if ($.isInDevMode() && 0 < arguments.length) {
			var a = 1 < arguments.length ? Array.prototype.join.call(arguments, " ") : arguments[0];
			try {
				return console.log($.ts() + " " + a),
				!0
			} catch(e) {
				try {
					return opera.postError(a),
					!0
				} catch(d) {}
			}
			return ! 1
		}
	},
	dmLoad: function(a, e, d) {
		var g = $.Deferred();
		e && e.toLowerCase().endsWith(".jsp") && (dm_account_locale = dm_account_locale || 1, e = e + ( - 1 == e.indexOf("?") ? "?": "\x26") + "dm_lang\x3d" + dm_account_locale);
		$(a).load(e,
		function(e, k, l) {
			$._dmIsAuthErrorResponse(l) || "error" == k ? (g.reject(), $.dmDefaultXHRerror(l, k, "")) : "success" == k && (g.resolve($(a)), d && d($(a)))
		});
		return g.promise()
	},
	getColorBrigthness: function(a) {
		if (null != a) {
			if ( - 1 == a.indexOf("rgba")) {
				var e = /rgb\((\d+),\s*(\d+),\s*(\d+)\)/;
				a = e.exec(a);
				var e = parseInt(a[1], 10),
				d = parseInt(a[2], 10),
				g = parseInt(a[3], 10),
				e = (299 * e + 587 * d + 114 * g) / 1E3
			} else e = /rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d\.]+)\)/,
			a = e.exec(a),
			e = parseInt(a[1], 10),
			d = parseInt(a[2], 10),
			g = parseInt(a[3], 10),
			a = parseFloat(a[4], 10),
			e = (299 * e + 587 * d + 114 * g) / 1E3,
			0 == a && (e = 255);
			return e
		}
		return 255
	},
	buttonHasNoIcon: function(a) {
		return a && !a.find(".iconBg").is(":visible")
	},
	dmReloadWindow: function(a) {
		$(window).unbind("beforeunload");
		a ? location.href = a: location.reload("true")
	},
	dmHandleKeydown: function(a) {
		$.dmx.events.trigger("fwKeyDown", {
			alt: a.altKey,
			ctrl: a.ctrlKey || a.metaKey,
			keyCode: a.keyCode,
			target: a.target
		});
		if (a.altKey && a.ctrlKey) {
			if (isTestOrDevServer && 69 == a.keyCode) return $.dmGet({
				url: "/site_editor/testexception",
				success: function() {}
			}),
			!0;
			console.log(a.keyCode);
			if (79 == a.keyCode) return window.open($.dmx.site.baseUrl, "_blank"),
			!0;
			if (dm_account_support) {
				if (80 == a.keyCode) return window.open("/admin/support/site_info.jsp?sid\x3d" + $.dmx.site.id, "_blank"),
				!0;
				if (68 == a.keyCode) return window.open("/admin/support/show_page_data.jsp?attribute\x3ddesigntemplate\x26page_id\x3d" + $.dmx.page.id, "_blank"),
				!0;
				if (65 == a.keyCode) return window.open("/admin/support/account_info.jsp?aid\x3d" + $.dmx.site.accountOwnerID, "_blank"),
				!0;
				if (85 == a.keyCode) return window.open("/admin/support/url_rules.jsp?sid\x3d" + $.dmx.site.id, "_blank"),
				!0;
				if (67 == a.keyCode) return $("#settingsCssHtml").trigger("click"),
				!0;
				if (191 == a.keyCode) {
					var e = $('\x3cdiv class\x3d"dm_popup_admin"\x3ePossible Actions:\x3cbr/\x3e\x3cbr/\x3e\x3cspan\x3eO\x3c/span\x3eriginal Site\x3cbr/\x3eSite \x3cspan\x3eP\x3c/span\x3eages Info\x3cbr/\x3ePage \x3cspan\x3eD\x3c/span\x3eesign Template\x3cbr/\x3e\x3cspan\x3eA\x3c/span\x3eccount Info\x3cbr/\x3e\x3cspan\x3eU\x3c/span\x3eRL Rules\x3cbr/\x3eOpen \x3cspan\x3eC\x3c/span\x3eSS\x3cbr/\x3e\x3cspan\x3eE\x3c/span\x3exception Example Popup\x3cbr/\x3e\x3cspan\x3e?\x3c/span\x3e - This Help Popup\x3c/div\x3e');
					$("body").append(e);
					e.bind("click",
					function() {
						e.remove()
					});
					setTimeout(function() {
						e.remove()
					},
					1E4)
				}
			}
		}
		return ! 0
	},
	reloadTransitional: function() {
		$.ajax({
			type: "GET",
			url: "/new?sid\x3d" + $.dmx.site.id,
			async: !1,
			success: function() {
				$.dmReloadWindow()
			}
		})
	},
	dmLoadCss: function(a, e) {
		try {
			var d = e ? $(e).find("head") : $("head"),
			g;
			for (g in a) $(d).append("\x3clink\x3e"),
			$(d).children(":last").attr({
				rel: "stylesheet",
				type: "text/css",
				href: a[g]
			})
		} catch(j) {
			$.log(["Failed to load css files [", j.message, "]"].join(""))
		}
	},
	dmAlert: function(a) {
		alert(a)
	},
	dmPost: function(a) {
		a.type = "post";
		this.settings = $._dmGetPostSettingsExtend(a);
		return $.ajax(this.settings).promise()
	},
	dmPostWithHistory: function(a) {
		a.type = "post";
		this.settings = $._dmGetPostSettingsExtend(a, !0);
		$.ajax(this.settings)
	},
	dmPostWithHistoryAllPages: function(a) {
		a.type = "post";
		this.settings = $._dmGetPostSettingsExtend(a, !0, !0);
		$.ajax(this.settings)
	},
	dmPostAfterObjectSaved: function(a, e) {
		$._dmGetLock() ? (a.type = "post", this.settings = $._dmGetPostSettingsExtend(a, a.withHistory, a.allPagesHistory), $.ajax(this.settings)) : e && 20 < e ? $.log("failed getting lock") : (e || (e = 0), setTimeout(function() {
			$.dmPostAfterObjectSaved(a, e + 1)
		},
		300))
	},
	dmGet: function(a) {
		a.type = "get";
		this.settings = $._dmGetPostSettingsExtend(a);
		return $.ajax(this.settings).promise()
	},
	logXHREx: function(a, e, d) {
		var g = "";
		if (a.responseText) try {
			g = JSON.parse(a.responseText).message
		} catch(j) {
			$.log("Failed to parse server exception " + a.responseText)
		}
		g = e + "; " + d + "; " + a.status + "; " + g;
		$.log([$.ts(), " XHR failed [", g, "]"].join(""));
		return g
	},
	dmDefaultXHRerror: function(a, e, d, g) {
		if (!a.status || 0 == a.status || 12029 == a.status || 12031 == a.status) setTimeout("$._dmHandleNoInternet();", 3E3);
		else if ($._dmIsAuthErrorResponse(a)) $.dmReloadWindow();
		else {
			a.responseText || $.dmUnblockUI();
			$.logXHREx(a, e, d);
			var j = null;
			e = null;
			a.responseText && (j = $.parseJSON(a.responseText), g && g != this.dmDefaultXHRerror && (e = g(j)));
			if (!e && (j && "ResourceNotExist" == j.error_code && j.message.startsWith("Site") || "AccessForbidden" == j.error_code)) $.dmReloadWindow("/home");
			else if ($.dmUndo.set(!0), e) $.dmPreviewSaved(e.msg || " ");
			else if ($.dmPreviewSaved("Failed", !0, "Operation failed."), j) switch (j.error_code) {
			case "MissingElement":
				$.dmPreviewSaved("");
				a = function() {
					$.ajax({
						url: "/api/uis/pages/" + (j.pageId ? j.pageId: $.dmx.page.id) + "/recreatedesigntemplate",
						type: "post",
						success: function() {
							$("body").find(".popupWinExampleMask").hide();
							$.dmfw.reload({
								pageAlias: $.dmx.page.alias
							})
						}
					})
				};
				$("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.missingElementMsg.1"] + "\x3cbr/\x3e " + dmStr["ui.nee.missingElementMsg.2"], {
					initCallback: a,
					onNoCallback: a,
					triggerNow: !0,
					yesText: dmStr["ui.ok.u"],
					bindCloseToNo: !0,
					yesStyle: "width:160px",
					noStyle: "display:none"
				});
				break;
			case "DesignTemplateTooLarge":
				$.dmPreviewSaved("");
				$("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.commonframework.templateLarge"], {
					onNoCallback: function() {
						$.dmx && !$.dmx.site && $.dmfw.reload()
					},
					triggerNow: !0,
					yesText: dmStr["ui.ok.u"],
					bindCloseToNo: !1,
					yesStyle: "width:160px",
					noStyle: "display:none"
				});
				break;
			default:
				$("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.commonframework.1"] + " " + j.message + ".\n " + dmStr["ui.nee.commonframework.2"], {
					initCallback: function() {
						$.ajax({
							url: "/api/uis/site_editor/tellus?site\x3d" + $.dmx.site.alias + "\x26page\x3d" + $.dmx.page.alias,
							type: "get",
							success: function() {
								$("body").find(".popupWinExampleMask").hide();
								$.dmfw.reload({
									pageAlias: $.dmx.page.alias
								})
							}
						})
					},
					onNoCallback: function() {
						$("body").find(".popupWinExampleMask").hide();
						$.dmfw.reload({
							pageAlias: $.dmx.page.alias
						})
					},
					close: !1,
					triggerNow: !0,
					noText: dmStr["ui.nee.commonframework.3"],
					yesText: dmStr["ui.nee.commonframework.4"],
					bindCloseToNo: !0,
					yesStyle: "width:160px"
				})
			} else $("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.commonframework.5"], {
				initCallback: function() {
					$.ajax({
						url: "/api/uis/site_editor/tellus?site\x3d" + $.dmx.site.alias + "\x26page\x3d" + $.dmx.page.alias,
						type: "get",
						success: function() {
							$("body").find(".popupWinExampleMask").hide();
							$.dmfw.reload({
								pageAlias: $.dmx.page.alias
							})
						}
					})
				},
				onNoCallback: function() {
					$("body").find(".popupWinExampleMask").hide();
					$.dmfw.reload({
						pageAlias: $.dmx.page.alias
					})
				},
				triggerNow: !0,
				noText: dmStr["ui.nee.commonframework.3"],
				yesText: dmStr["ui.nee.commonframework.4"],
				bindCloseToNo: !0,
				yesStyle: "width:160px"
			})
		}
	},
	_dmHandleNoInternet: function() {
		try {
			$.dmfw && $.dmfw._closeEditorAll(),
			$._dmShowNoInternetMask(),
			$(window).unbind("resize.nointernet").bind("resize.nointernet",
			function() {
				$._dmShowNoInternetMask()
			}),
			clearTimeout(_dmCheckInternetTimeout),
			_dmCheckInternetTimeout = setTimeout(function() {
				$.dmCheckInternet()
			},
			1E4)
		} catch(a) {}
	},
	_dmShowNoInternetMask: function() {
		$("#dmNoInternetMaskWrapper").height($(document).height()).width($(window).width()).show();
		$("#dmNoInternetMask").height(document.body.offsetHeight).width($(window).width()).show()
	},
	dmCheckInternet: function(a) {
		clearTimeout(_dmCheckInternetTimeout);
		$.ajax({
			url: "/api/uis/site_editor/isalive?r\x3d" + (new Date).getTime(),
			type: "get",
			cache: !1,
			success: function() {
				clearTimeout(_dmCheckInternetTimeout);
				a ? ($(window).unbind("resize.nointernet"), $("#dmNoInternetMaskWrapper").hide()) : ($(window).unbind("resize.nointernet"), $("#dmNoInternetMaskWrapper").hide(), $.dmfw.reload({
					pageAlias: $.dmx.page.alias
				}))
			},
			error: function() {
				a ? $._dmHandleNoInternet() : (clearTimeout(_dmCheckInternetTimeout), _dmCheckInternetTimeout = setTimeout(function() {
					$.dmCheckInternet()
				},
				1E4))
			}
		})
	},
	_dmIsAuthErrorResponse: function(a) {
		return a && "1" == a.getResponseHeader("dm_login")
	},
	_dmRegisterPostLock: function(a) {
		_dmPostLock[a] = 1
	},
	_dmUnregisterPostLock: function(a) {
		delete _dmPostLock[a]
	},
	_dmGetLock: function() {
		var a = 0,
		e;
		for (e in _dmPostLock) _dmPostLock.hasOwnProperty(e) && a++;
		return 0 == a
	},
	_dmGetPostSettingsExtend: function(a, e, d) {
		var g = a.error;
		a.error = void 0;
		a = $.extend({
			cache: !1,
			async: !0,
			processData: !0,
			contentType: "application/json",
			error: function(a, d, e) {
				$.dmDefaultXHRerror(a, d, e, g || void 0)
			}
		},
		a);
		a.data && (a.data = JSON.stringify(a.data));
		a.url = "/api/uis" + a.url;
		try {
			_neeHistoryManagerUniqueID && (0 < a.url.indexOf("?") ? -1 == a.url.indexOf("\x26historyManagerID\x3d") && (a.url = a.url + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID) : a.url = a.url + "?historyManagerID\x3d" + _neeHistoryManagerUniqueID)
		} catch(j) {}
		var k = a.success;
		if ($._dmAjaxCtx.afterSuccess && $._dmAjaxCtx.isUndoOn && e) {
			var l = $._dmAjaxCtx.afterSuccess.clone();
			a.success = function(a, e, g) {
				try {
					$._dmIsAuthErrorResponse(g) ? $.dmDefaultXHRerror(g, e) : (k && k(a), d && (a = $.extend({
						saveAllPagesDesignTempaltes: !0
					},
					a)), l(a))
				} catch(j) {
					$.dmNotifyEx(j)
				}
			};
			$._dmAjaxCtx.afterSuccess = null
		} else a.success = function(a, d, e) {
			$._dmIsAuthErrorResponse(e) ? $.dmDefaultXHRerror(e, d) : (k && k(a), $._dmAjaxCtx.afterSuccess && (d = $._dmAjaxCtx.afterSuccess.clone()) && d(a))
		};
		return a
	},
	isEmpty: function(a) {
		for (var e in a) return ! 0;
		return ! 1
	},
	isListEmpty: function(a) {
		return ! a || 1 > a.length
	},
	domain: function(a) {
		return a.match(/:\/\/(www[0-9]?\.)?(.[^\/:]+)/)[2]
	},
	validateEmail: function(a) {
		return /^([a-zA-Z0-9])(([a-zA-Z0-9])*([\._\+-])*([a-zA-Z0-9]))*@(([a-zA-Z0-9\-])+(\.))+([a-zA-Z]{2,4})+$/.test(a)
	},
	validatePhoneNumber: function(a) {
		return /^(?:\+)?\(?([0-9]{0,})\)?[-. ]?([0-9]{0,})[-. ]?([0-9]{0,24})$/.test(a)
	},
	validateLongPhoneNumber: function(a) {
		return /^(?:\+)?\(?([0-9]{0,})\)?[-. ]?([0-9]{0,})[-. ]?([0-9]{0,24})$/.test(a)
	},
	validateURL: function(a, e) {
		var d = /\(?(?:(http|https|ftp):\/\/)?(?:((?:[^\W\s]|\.|-|[:]{1})+)@{1})?((?:www.)?(?:[^\W\s]|\.|-)+[\.][^\W\s]{2,4}|localhost(?=\/)|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d*))?([\/]?[^\s\?]*[\/]{1})*(?:\/?([^\s\n\?\[\]\{\}\#]*(?:(?=\.)){1}|[^\s\n\?\[\]\{\}\.\#]*)?([\.]{1}[^\s\?\#]*)?)?(?:\?{1}([^\s\n\#\[\]]*))?([\#][^\s\n]*)?\)?/;
		if (!d.test(a)) return 0 === a.indexOf("data:image");
		var g = !0;
		e && (g = a.toLowerCase(), g = -1 !== g.indexOf("jpeg") || -1 !== g.indexOf("jpg") || -1 !== g.indexOf("gif") || -1 !== g.indexOf("png") || -1 !== g.indexOf("bmp"));
		return d.test(a) && g
	},
	dmAnchorValue: function(a, e) {
		if (!a) return null;
		if (e)"undefined" !== typeof e.href && (e.dontMobilize ? a.attr("href", $.addParam(e.href, {
			n: "no_redirect",
			v: "true"
		})) : a.attr("href", e.href)),
		"undefined" !== typeof e.raw_url && ("" === e.raw_url ? a.removeAttr("raw_url") : a.attr("raw_url", e.raw_url));
		else {
			var d;
			if ("string" === $.type(d = a.attr("raw_url"))) return d;
			d = a.attr("href");
			d = d.replace("?no_redirect\x3dtrue\x26", "?");
			d = d.replace("?no_redirect\x3dtrue", "");
			d = d.replace("\x26no_redirect\x3dtrue\x26", "\x26");
			return d = d.replace("\x26no_redirect\x3dtrue", "")
		}
	},
	dmIsExternalUrl: function(a) {
		return ! (a || "").startsWith("/site")
	},
	addParam: function(a, e) {
		var d = e.n + "\x3d" + e.v;
		if ( - 1 != a.indexOf(d)) return a;
		a = -1 != a.indexOf("?") ? a + "\x26": a + "?";
		return a + d
	},
	changePage: function(a, e) {
		var d = void 0 === a.noHistory ? !1 : a.noHistory,
		g = function() {
			try {
				a.clientChange && (a.clientChange(a.params), !a.serverChange && !d && neeHistoryManager.updateHistory()),
				a.serverChange ? ($._dmAjaxCtx.afterSuccess = function(a) {
					d || neeHistoryManager.updateHistory(a);
					$.dmUIBlockControlled({
						region: "_changePage",
						op: "unblock"
					})
				},
				a.serverChange(a.params)) : $.dmUIBlockControlled({
					region: "_changePage",
					op: "unblock"
				})
			} catch(e) {
				$.dmUIBlockControlled({
					region: "_changePage",
					op: "unblock"
				}),
				$.dmNotifyEx(e)
			}
		};
		try {
			$.dmUIBlockControlled({
				region: "_changePage",
				op: "block"
			});
			var j = a.element || $.dmx.current.element;
			if (e || !j || $.dmx.isHeader(j)) g();
			else try {
				var k = $.dmx.page.alias,
				l = {
					suggestedAlias: $.dmx.rt.currentNavTitle ? $.dmx.rt.currentNavTitle: void 0,
					success: function() {
						try {
							NEFW.PREVIEW.get(0).contentWindow.updatePageAliasInHistory(k, $.dmx.page.alias)
						} catch(a) {}
						g()
					}
				},
				m = function() {
					var a = $.dmops.createPageWithCheck(l) || {}; ! a.pageCreated && !a.duplicateRequest && g()
				}; ! $.dmx.rt.isPageEqualToLiveUrl && $.dmx.page.alias != DEFAULT_PAGE_DESIGN_ALIAS && $.dmx.page.alias != HOME_PAGE_DESIGN_ALIAS && $.dmx.page.isTemplate ? ($.dmUIUnblockControlled("_changePage"), $.dmfw.showChangeAssignedPagePopup(function() {
					m()
				},
				$.dmx.page)) : m()
			} catch(n) {
				$.log("changePage: createPageWithCheck failed")
			}
		} catch(o) {
			$.dmUIUnblockControlled("_changePage"),
			$.dmNotifyEx(o)
		}
	},
	dmUIUnblockControlled: function(a) {
		$.dmUIBlockControlled({
			region: a,
			op: "unblock"
		})
	},
	dmUIBlockControlled: function(a) {
		"string" === typeof a && (a = {
			region: a,
			style: "wheel"
		});
		a = $.extend({
			region: "_global",
			msg: "",
			op: "block",
			style: "preview"
		},
		a);
		$.dmx[a.region] || ($.dmx[a.region] = {});
		if ("block" == a.op) {
			if ($.dmx[a.region].handleUIBlock || ($.dmx[a.region].handleUIBlock = !$.dmIsUIBlocked()), $.dmx[a.region].handleUIBlock) return "nowheel" == a.style ? $.dmBlockUI(null, !0) : "preview" == a.style ? $.dmPreviewSaving(a.msg) : "wheel" == a.style && $.dmBlockUI(a.container),
			!0
		} else if ($.dmx[a.region].handleUIBlock) return "preview" == a.style ? $.dmPreviewSaved(a.msg, a.msg) : "wheel" == a.style && $.dmUnblockUI(),
		$.dmx[a.region].handleUIBlock = void 0,
		!0;
		return ! 1
	},
	ts: function() {
		var a = new Date;
		return a.getHours() + ":" + a.getMinutes() + ":" + a.getSeconds() + ":" + a.getMilliseconds()
	},
	dmSynchronize: function(a) {
		var e = a.region,
		d = function() {
			1 == $.dmx[e]._mutext.counter ? $.dmx[e]._mutext = null: $.dmx[e]._mutext.counter--
		},
		g = function(e) {
			try {
				a.exec(e, {
					success: d,
					error: d
				})
			} catch(g) {
				d()
			}
		},
		j = function(a, d) {
			$.log($.ts() + " dmSynchronize:" + a + "[region: " + e + "; counter: " + d + "]")
		},
		k = !1,
		l = 0,
		m = function(a) {
			0 == l && j("start wait", a);
			setTimeout(function() {
				$.dmx[e]._mutext && $.dmx[e]._mutext.counter != a ? (k = !0, l += 10, 0 == l % 500 && j("waiting " + l + "ms", a), m(a)) : (j("end wait", a), g(k))
			},
			10)
		};
		$.dmx[e] || ($.dmx[e] = {});
		if (void 0 == $.dmx[e]._mutext) return $.dmx[e]._mutext = {
			counter: 1
		},
		g(k);
		var n = $.dmx[e]._mutext.counter;
		$.dmx[e]._mutext.counter++;
		m(n);
		return ! 0
	},
	dmNotify: function() {},
	dmSetToolTip: function(a, e, d, g, j) {
		d = d || $(a);
		var k = g || $(a);
		j = j || {};
		d.unbind("mouseenter").bind("mouseenter",
		function() {
			$.dmfw.showQTip({
				style: {
					classes: "ui-tooltip-light ui-tooltip-shadow dmtooltip",
					tip: j.tip || "topCenter",
					def: !1
				},
				selector: a,
				text: e,
				position: {
					at: j.at || "bottom center",
					my: j.my || "top center",
					adjust: j.adjust || {
						y: -1
					},
					target: k
				},
				dontHide: !1,
				hide: {
					event: "mouseout",
					fixed: !0,
					effect: function() {
						$(this).fadeOut("fast")
					}
				}
			})
		})
	},
	dmShowMsgOnPreview: function(a, e) {
		$notifyArea = $("#neeNotifyArea");
		if (0 < $notifyArea.length && (!$(".shellHeaderSaveBtn").length || $(".shellHeaderSaveBtn").is(":hidden"))) {
			var d = Math.floor(101 * Math.random());
			$notifyArea.text(a);
			$notifyArea.attr("index", d);
			"" != a.trim() && $notifyArea.show(); (!e || "noRemove" != e) && $notifyArea.delay(2500).filter("[index\x3d'" + d + "']").fadeOut(400,
			function() {
				$(this).hide()
			});
			return ! 0
		}
		return ! $(".designPanel").is(":hidden")
	},
	dmPreviewSaving: function(a) {
		a = a || dmStr["ui.nee.commonframework.6"];
		a = $.dmShowMsgOnPreview(a, "noRemove");
		$.dmBlockUI(null, a)
	},
	dmPreviewSaved: function(a, e, d) {
		a || (a = 1100 < $(window).width() ? dmStr["ui.nee.commonframework.7"] : dmStr["ui.nee.commonframework.8"]);
		$.dmUnblockUI();
		$.dmShowMsgOnPreview(a, !e ? "noRemove": "", d)
	},
	dmPreviewMessage: function(a) {
		if (a) {
			var e = $(".neePreviewMsg");
			e.find(".neePreviewMsg-content").empty();
			if (a.onLoad) a.onLoad(e.find(".neePreviewMsg-content"));
			a.offset && (a.offset.top && e.css("top", a.offset.top + "px"), a.offset.left && e.css("left", a.offset.left + "px"));
			a.additionalClass && e.addClass(a.additionalClass);
			a.flip ? (e.addClass("neePreviewMsgFlip"), $(".neePreviewMsg-w").addClass("neePreviewMsg-wFlipped"), $(".neePreviewMsg-icon").addClass("neePreviewMsg-iconFlipped"), e.find(".neePreviewMsg-corner").addClass("neePreviewMsg-cornerFlipped")) : (e.removeClass("neePreviewMsgFlip"), $(".neePreviewMsg-w").removeClass("neePreviewMsg-wFlipped"), $(".neePreviewMsg-icon").removeClass("neePreviewMsg-iconFlipped"), e.find(".neePreviewMsg-corner").removeClass("neePreviewMsg-cornerFlipped"));
			a.small ? e.addClass("neePreviewMsgSmall") : e.removeClass("neePreviewMsgSmall");
			e.mouseover(function() {
				$.deselectAllEditableElements()
			});
			e.fadeIn("fast")
		}
		return {
			hide: function() {
				$(".neePreviewMsg").hide()
			}
		}
	},
	dmNotifyEx: function(a) {
		$.log("Exception, " + (a ? a.stack: "JS error"));
		$.dmNotify("JS Error caught");
		$.dmUnblockUI()
	},
	dmBlockUI: function(a, e) {
		e ? $("#imageZone").hide() : $("#imageZone").center(a).show();
		$("#disabledImageZone").css({
			"z-index": "0",
			display: "block",
			cursor: "wait"
		}).show();
		setTimeout("$('#disabledImageZone').css('z-index' , '9999999');", 300)
	},
	dmIsUIBlocked: function() {
		return $("#disabledImageZone").is(":visible")
	},
	dmLoading: function(a) {
		a = jQuery.extend(!0, {},
		a);
		$("#imageZone").center(a).show().css("z-index", "9999999");
		$("#disabledImageZone").show().css({
			"z-index": "9999999",
			display: "block",
			cursor: "progress"
		})
	},
	dmUnblockUI: function() {
		$("#disabledImageZone").css("cursor", "").hide()
	},
	dmAddAllPagesButtons: function(a, e) {
		if (!$.dmx.currentPageObj().isHeader && !($.dmx.site.isBlog || a.attr("dmle_added_all_pages_root_page") && a.attr("dmle_added_all_pages_root_page") != $.dmx.currentPageObj().alias)) a.attr("dmle_added_all_pages") ? $.dmAddAllPagesButtonsUpdate(a) : $.dmAddAllPagesButtonsAdd(a),
		e && e()
	},
	dmHideAllPagesButtons: function() {
		$.dmfw.hideEditorButton({
			selector: ".orangeVariableButton"
		});
		$.dmfw.hideEditorButton({
			selector: ".blueVariableButton"
		})
	},
	dmAddAllPagesButtonsAdd: function(a) {
		$.dmfw.hideEditorButton({
			selector: ".orangeVariableButton"
		});
		$.dmfw.hideEditorButton({
			selector: ".blueVariableButton"
		});
		$.dmfw.showEditorButton({
			selector: ".orangeVariableButton",
			text: dmStr["ui.nee.commonframework.9"],
			width: "150px",
			click: function() {
				$.dmops.insertElementAllPages(a,
				function() {
					a.attr("dmle_added_all_pages", a.dmid());
					$.dmAddAllPagesButtonsUpdate(a)
				})
			}
		})
	},
	dmAddAllPagesButtonsUpdate: function(a) {
		$.dmfw.hideEditorButton({
			selector: ".orangeVariableButton"
		});
		$.dmfw.hideEditorButton({
			selector: ".blueVariableButton"
		});
		$.dmfw.showEditorButton({
			selector: ".blueVariableButton",
			text: dmStr["ui.nee.commonframework.10"],
			width: "230px",
			click: function() {
				$.dmops.deleteElements($(a), null, {
					allPages: !0,
					otherPagesOnly: !0
				});
				$.dmAddAllPagesButtonsAdd(a);
				a.removeAttr("dmle_added_all_pages")
			}
		})
	},
	dmSiteLinkForSave: function(a) {
		return $.dmfw.isDudaone() ? "/" + a: "/site/" + $.dmx.site.alias + "/" + a
	},
	dmx: {
		account: {},
		site: {},
		page: {},
		sitePages: [],
		siteNav: {},
		staticNavItems: {},
		rt: {},
		cache: {
			_objects: [],
			set: function(a, e) {
				$.dmx.cache._objects[a] = e
			},
			get: function(a) {
				return $.dmx.cache._objects[a]
			},
			clear: function(a) {
				$.dmx.cache._objects[a] = null
			},
			clearAll: function() {
				$.dmx.cache._objects = []
			}
		},
		events: function() {
			var a = {},
			e = function(a) {
				a = a || "";
				return {
					event: a.split(".")[0],
					namespace: -1 == a.indexOf(".") ? "_g": a
				}
			},
			d = function(d) {
				if (!d) return {};
				d = e(d).event;
				a[d] = a[d] || {};
				d = a[d];
				d._g = d._g || [];
				return d
			};
			return {
				bind: function(a, j, k) {
					k && $.dmx.events.unbind(a);
					k = e(a);
					a = d(a);
					k = k.namespace;
					a[k] = a[k] || [];
					a[k].push(j);
					return $.dmx.events
				},
				trigger: function(a, e) {
					var k = d(a),
					k = k || {};
					for (key in k) if (k.hasOwnProperty(key)) for (var l = k[key], m = e, n = key, l = l || [], o = l.length, r = 0; r < o; r++) {
						var u = l[r];
						if ("function" == typeof u) try {
							u(m)
						} catch(s) {
							$.log("Error in event: " + n + ", " + s.message)
						}
					}
					return $.dmx.events
				},
				unbind: function(g) {
					g = g || "";
					var j = e(g);
					"_g" == j.namespace ? a[j.event] = {}: d(g)[j.namespace] = [];
					return $.dmx.events
				},
				clearAll: function() {
					a = {};
					return $.dmx.events
				}
			}
		} (),
		locks: function() {
			var a = {};
			return {
				clearLocks: function() {
					a = {}
				},
				hasLockOnObject: function(e) {
					return a[JSON.stringify(e)]
				},
				setLockOnObject: function(e) {
					a[JSON.stringify(e)] = !0
				},
				removeLockOnObject: function(e) {
					a[JSON.stringify(e)] = !1
				}
			}
		} (),
		current: {
			editable: null,
			element: null
		},
		clear: function(a) {
			a = $.extend({
				pages: !0
			},
			a);
			a.pages && ($.dmx.page = {},
			$.dmx.sitePages = [], $.dmx.siteNav = {},
			$.dmx.staticNavItems = {},
			$.dmx.cache.clearAll())
		},
		set: function(a) {
			$.dmx.site = a.site;
			$.dmx.page = a.page;
			$.dmx.header = a.header;
			$.dmx.sitePages = a.site_pages;
			if (a.site_nav) {
				var e = a.site_nav.filter(function(a) {
					return a.inNavigationList
				});
				$.dmx.cache.set("siteNav", e);
				e = a.site_nav.filter(function(a) {
					return ! a.inNavigationList
				});
				$.dmx.cache.set("staticNavItems", e)
			}
			var e = $.dmx.site.webPlatform,
			d = $.dmx.site.compatible_platforms ? $.dmx.site.compatible_platforms.toUpperCase() : "";
			$.dmx.site.isBlog = "BLOG" === e.type ? !0 : !1;
			$.dmx.site.isBlogCompatible = "BLOGGER" === d || "WORDPRESS" === d ? !0 : !1;
			$.dmx.site.premiumFeatures = a.premiumFeatures || void 0;
			$.dmx.site.hasLogo = a.hasLogo || void 0;
			$.dmx.nonRewritableUrlExts = dm_nonRewriteUrlExts;
			try {
				$.dmfw.checkSitePublished()
			} catch(g) {}
		},
		addPage: function(a) {
			$.dmx.sitePages.push(a.page);
			if (a.navItem) {
				var e = $.dmx.getSiteNav();
				e.push(a.navItem);
				$.dmx.cache.set("siteNav", e)
			}
		},
		preview: {
			doc: function() {
				return $.dmfw.previewArea.contents().get(0)
			},
			wnd: function() {
				return $.dmfw.previewArea.get(0).contentWindow
			},
			all: function() {
				return $(".NEEPreviewInside")
			},
			event: {},
			_redrawListeners: {},
			getRedrawListeners: function() {
				return $.dmx.preview._redrawListeners
			},
			addRedrawListener: function(a, e) {
				$.dmx.preview._redrawListeners[a] = e
			},
			removeRedrawListener: function(a) {
				delete $.dmx.preview._redrawListeners[a]
			}
		},
		homePage: function() {
			for (var a = 0; a < $.dmx.sitePages.length; a++) {
				var e = $.dmx.sitePages[a];
				if (e.alias == HOME_PAGE_DESIGN_ALIAS) return e
			}
		},
		getNextAvailablePageTitle: function(a) {
			for (var e = $.map($.dmx.sitePages,
			function(a) {
				return a.title
			}), d = 0, g = a; - 1 < $.inArray(g, e);) d++,
			g = a + " " + d;
			return g
		},
		pageTemplates: function() {
			var a = [];
			$.each($.dmx.sitePages,
			function(e, d) { (d.isTemplate || d.alias == HOME_PAGE_DESIGN_ALIAS) && a.push(d)
			});
			return a
		},
		editablePages: function() {
			for (var a = [], e = 0; e < $.dmx.sitePages.length; e++) {
				var d = $.dmx.sitePages[e]; ! d.isHeader && !d.isDefault && a.push(d)
			}
			return a
		},
		pagesByField: function(a) {
			pagesByField = {};
			for (var e = 0; e < $.dmx.sitePages.length; e++) {
				var d = $.dmx.sitePages[e];
				pagesByField[d[a]] = d
			}
			return pagesByField
		},
		getPageByField: function(a, e) {
			return $.dmx.pagesByField(a)[e]
		},
		pagesByAlias: function() {
			return $.dmx.pagesByField("alias")
		},
		pagesById: function() {
			return $.dmx.pagesByField("id")
		},
		getFlattenNavList: function() {
			function a(e) {
				for (var d = [], g = 0; g < e.length; g++) d = d.concat([e[g]]),
				0 < e[g].subNav.length && (d = d.concat(a(e[g].subNav)));
				return d
			}
			return a($.dmx.getSiteNav())
		},
		knownNavTargets: function() {
			for (var a = $.dmx.getFlattenNavList(), e = [], d = 0; d < a.length; d++) {
				var g = a[d];
				g.deleted || e.push({
					type: "nav",
					id: g.elementID,
					alias: g.pageAlias,
					title: g.itemTitle,
					url: !g.pageFromScratch ? g.itemUrl: void 0,
					isPage: g.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS
				})
			}
			var j = $.dmx.editableNavLinks().map(function(a) {
				return a.alias
			});
			$.each($.dmx.sitePages,
			function(a, d) {
				if ( - 1 == j.indexOf(d.alias)) {
					var g = 0;
					try {
						g = d.rulesCount || 0
					} catch(n) {}
					d.alias != DEFAULT_PAGE_DESIGN_ALIAS && (d.alias != HOME_PAGE_DESIGN_ALIAS && (0 < g || d.isFromScratchLegacy)) && e.push({
						type: "page",
						id: d.id,
						alias: d.alias,
						title: d.title,
						isPage: !0
					})
				}
			});
			return e
		},
		editableLinks: function(a) {
			a = $.extend({
				uniqueNavLinkUrls: !1,
				includeDontMobilize: !0
			},
			a);
			for (var e = $.dmx.editablePages(), d = $.dmx.getFlattenNavList(), g = [], j = {},
			k = {},
			l = 0; l < d.length; l++) {
				var m = d[l];
				if (a.includeDontMobilize || m.pageAlias !== ORIGINAL_PAGE_ALIAS) {
					if (a.uniqueNavLinkUrls) {
						if (m.pageAlias == HOME_PAGE_DESIGN_ALIAS) continue;
						if (m.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS) {
							if (j[m.pageAlias]) continue
						} else if (k[m.itemUrl]) continue
					} else if (m.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS && m.pageAlias != HOME_PAGE_DESIGN_ALIAS && j[m.pageAlias]) continue;
					g.push({
						type: "nav",
						id: m.elementID,
						alias: m.pageAlias,
						title: m.itemTitle,
						url: !m.pageFromScratch ? m.itemUrl: void 0,
						isPage: m.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS
					});
					m.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS && m.pageAlias != HOME_PAGE_DESIGN_ALIAS ? j[m.pageAlias] = m.pageAlias: k[m.itemUrl] = m.itemUrl
				}
			}
			for (l = 0; l < e.length; l++) {
				a = e[l];
				d = 0;
				try {
					d = a.rulesCount || 0
				} catch(n) {}
				if (!j[a.alias] && (0 < d || a.isFromScratchLegacy)) g[a.alias == HOME_PAGE_DESIGN_ALIAS ? "unshift": "push"]({
					type: "page",
					id: a.id,
					alias: a.alias,
					title: a.title,
					isPage: !0
				})
			}
			return g
		},
		editableNavLinks: function() {
			return $.dmx.editableLinks().filter(function(a) {
				return a && "nav" == a.type
			})
		},
		currentPage: function(a) {
			return $.dmx.currentPageObj(a).id
		},
		currentPageObj: function(a) {
			var e = null;
			if (a && !$.isEmptyObject(a)) e = a;
			else if ($.dmx.current.element && !$.isEmptyObject($.dmx.current.element)) e = $($.dmx.current.element);
			else return $.dmx.page;
			return e.is(".dmHeader , .dmHeader * , .dmFooter, .dmFooter *, #fcontainer, #fcontainer *, .freeHeader, .freeHeader *") ? $.dmx.header: $.dmx.page
		},
		isHeader: function(a) {
			return $.dmx.currentPage(a) == $.dmx.header.id
		},
		isPremium: function() {
			return 3 == $.dmx.site.planId
		},
		treatAsPublishReseller: function() {
			return ! isWLSubUser && $.dmx.site.isOwnerReseller || $.dmui.getResource("showResellerScreenOnPublish", {
				product: $.dmx.site.dmProductType
			})
		},
		getSiteNav: function(a) {
			var e = $.dmx.cache.get("siteNav");
			if (e) if (a) a(e);
			else return e;
			else if (a) $.dmops.updateEditContext.all({
				success: function() {
					a($.dmx.cache.get("siteNav"))
				}
			});
			else return $.dmops.updateEditContext.all(),
			$.dmx.cache.get("siteNav")
		},
		getStaticNav: function() {
			var a = $.dmx.cache.get("staticNavItems");
			a || ($.dmops.updateEditContext.all(), a = $.dmx.cache.get("staticNavItems"));
			return a
		},
		pagesUI: {},
		editor: {
			valid: !0,
			updateButton: $(".updateButton"),
			cssDisableClass: "dmOpacity050",
			setValid: function(a) {
				this.valid = a; ! 1 == a ? $(".updateButton").addClass(this.cssDisableClass) : $(".updateButton").removeClass(this.cssDisableClass)
			}
		}
	},
	timeValidate: function(a) {
		var e = "",
		d = /^(\d{1,2}):(\d{2})(:00)?( )?([apAP][mM])?$/;
		if ("" != a) if (regs = a.match(d)) {
			if (regs[4]) {
				if (1 > regs[1] || 12 < regs[1]) e = "Invalid value for hours: " + regs[1]
			} else 23 < regs[1] && (e = "Invalid value for hours: " + regs[1]); ! e && 59 < regs[2] && (e = "Invalid value for minutes: " + regs[2])
		} else e = "Invalid time format: " + a;
		return "" != e ? {
			timeValid: !1,
			msg: e
		}: {
			timeValid: !0
		}
	},
	getClientTimeZone: function() {
		var a = (new Date).getTimezoneOffset() / 60,
		e = (new Date).toTimeString().toLowerCase(),
		d = !1; - 1 < navigator.userAgent.toLowerCase().indexOf("msie") ? 9 < e.length && (e = e.substr(9), 1 < e.length && -1 < e.indexOf("d") && (d = !0)) : -1 < e.indexOf("daylight") && (d = !0);
		d && (a += 1);
		0 !== a && (a = 0 > a ? Math.abs(a) : "-" + Math.abs(a));
		return a
	},
	dmString: function(a, e) {
		var d = dmStr[a];
		if (e) for (var g = 0; g < e.length; g++) d = d.replace("%s", e[g]);
		return d
	},
	fixSiteUrl: function(a) {
		if ("undefined" == typeof a) return null;
		a = a.trim();
		2 < a.lastIndexOf("http://") ? a = a.substring(a.lastIndexOf("http://")) : 2 < a.lastIndexOf("https://") ? a = a.substring(a.lastIndexOf("https://")) : a.startsWith("http://www.www.") && (a = "http://www." + a.substring(15));
		a.startsWith("http") || (a = "http://" + a);
		var e = a.indexOf("/", 7),
		d = a.indexOf("?"); - 1 != e || -1 != d ? ( - 1 != e && (a = a.substring(0, e).toLowerCase() + a.substring(e)), -1 != d && (a = a.substring(0, d).toLowerCase() + a.substring(d))) : a = a.toLowerCase();
		return a
	}
}); (function(a) {
	a.extend({
		getCookie: function(a) {
			for (var d = document.cookie.split(";"), g = "", j = "", k = "", l = 0; l < d.length; l++) if (g = d[l].split("\x3d"), j = g[0].replace(/^\s+|\s+$/g, ""), j == a) return 1 < g.length && (k = unescape(g[1].replace(/^\s+|\s+$/g, ""))),
			k;
			return null
		},
		setCookie: function(a, d, g, j, k) {
			var l = new Date;
			l.setTime(l.getTime());
			g && (g *= 36E5);
			l = new Date(l.getTime() + g);
			document.cookie = a + "\x3d" + escape(d) + (g ? ";expires\x3d" + l.toGMTString() : "") + (j ? ";path\x3d" + j: "") + (k ? ";secure": "")
		},
		parseUrlExtension: function(a) {
			null == a && (a = "");
			a = a.split("?")[0];
			var d = a.lastIndexOf(".");
			if ( - 1 == d) return null;
			a = a.substr(d);
			return 1 == a.len ? null: a.substr(1)
		},
		showError: function(e, d) {
			var g = dmStr["ui.nee.missingElementMsg.1"] + "\x3cbr/\x3e " + dmStr["ui.nee.missingElementMsg.2"];
			switch (e) {
			case "PageNotAvailable":
				g = dmStr["ui.nee.error.createPage.urlNotAvailable"].replace("%s", d.pageUrl)
			}
			a("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(g, {
				initCallback: a.dmfw.reload,
				onNoCallback: a.dmfw.reload,
				triggerNow: !0,
				yesText: dmStr["ui.ok.u"],
				bindCloseToNo: !0,
				yesStyle: "width:160px",
				noStyle: "display:none"
			})
		}
	})
})(jQuery); (function(a) {
	a.fn.rPosition = function(e) {
		null == e && (e = window.event);
		var d = a(this).get(0),
		d = a(d).offset();
		return {
			x: e.pageX - d.left,
			y: e.pageY - d.top
		}
	};
	a.fn.scrollTo = function(e) {
		a("html, body").animate({
			scrollTop: this.offset().top
		},
		e || 2E3)
	};
	a.fn.dmCss = function(e, d) {
		return ! d ? a(this).css(e) : "" == d ? a(this).css(e, "") : -1 != d.indexOf("!important") ? (d = d.replace("!important", ""), a(this).css(e, ""), a(this).each(function() {
			var g = a(this).attr("style");
			a(this).attr("style", (g ? g + ";": "") + e + ": " + d + " !important")
		}), a(this)) : a(this).css(e, d)
	};
	a.fn.center = function(e) {
		var d = 0,
		g = 0;
		try {
			e && (d = e.offset().top, g = e.offset().left)
		} catch(j) {}
		e = e || a(window);
		this.css("position", "absolute");
		this.css("top", d + (e.height() - this.outerHeight()) / 2 + e.scrollTop() + "px");
		this.css("left", g + (e.width() - this.outerWidth()) / 2 + e.scrollLeft() + "px");
		return this
	};
	a.fn.disable = function() {
		return this.attr("disabled", "disabled")
	};
	a.fn.enable = function() {
		return this.removeAttr("disabled")
	};
	a.fn.dmid = function(e) {
		return e ? a(this).attr("duda_id", e) : a(this).attr("duda_id")
	};
	a.fn.dmidForChlidrens = function() {
		a(this).children().each(function(e, d) {
			var g = a.dmfw.generateDMid();
			a(d).attr("id", g);
			a(d).dmid(g)
		})
	};
	a.fn.isReallyFirst = function() {
		return ! a(this).is(":first-child") ? !1 : 1 == a(this).parent().contents().get(0).nodeType
	};
	a.fn.inputFieldLostFocusHandler = function(e) {
		a(this).unbind("focusout");
		a(this).unbind("keypress");
		a(this).keypress(function(d) {
			13 == d.which && a(this).blur()
		});
		a(this).focusout(function(d) {
			e(a(this).attr("value"), d)
		})
	};
	a.fn.getDimPerc = function(e, d) {
		return "width" == e ? Math.round(100 * (parseFloat(a(this).innerWidth()) / parseFloat(d ? d.forceWidthScale: a(a(this).parent().getTopBlockElement().get(0)).innerWidth()))) : Math.round(100 * (parseFloat(a(this).innerHeight()) / parseFloat(d ? d.forceHeightScale: a(a(this).parent().getTopBlockElement().get(0)).innerHeight())))
	};
	a.fn.getMinDimPerc = function(e) {
		return "width" == e ? Math.round(100 * (parseFloat(a(this).css("minWidth")) / parseFloat(a(a(this).parent().getTopBlockElement().get(0)).innerWidth()))) : Math.round(100 * (parseFloat(a(this).css("minHeight")) / parseFloat(a(a(this).parent().getTopBlockElement().get(0)).innerHeight())))
	};
	a.fn.copyOuterHtml = function(e, d) {
		var g = a(this),
		j = g.is(".dmLocked"),
		k = a(e);
		if (g.get(0).nodeName.toLowerCase() != k.get(0).nodeName.toLowerCase()) g.replaceWith(k),
		g = k,
		g.dmid(g.attr("id"));
		else {
			var l = g.find("label").html();
			g.html(k.html());
			d && g.find("label").html(l);
			var m = k.get(0);
			a.each(m.attributes,
			function(a) {
				g.attr(m.attributes[a].name, m.attributes[a].value)
			})
		}
		j && (g.selectElement(), g.lockElement({
			hideTopBar: !0
		}))
	};
	a.fn.isAutoMargin = function() {
		var a = 2 * this.position().left,
		d;
		a: {
			for (d = this.parent(); d;) if ("inline" == d.css("display")) d = d.parent();
			else break a;
			d = this
		}
		a = 2 > d.innerWidth() - this.outerWidth() - a;
		d = "0px" == this.css("marginLeft");
		var g = "left" == this.css("float") || "right" == this.css("float");
		return a && d && !g ? !0 : !1
	};
	a.fn.blink = function(e) {
		function d(d) {
			d = d || a(this);
			d.data("blinkStop") || d.fadeOut(e.fadeOut, g)
		}
		function g(g) {
			g = g || a(this);
			g.data("blinkStop") || g.fadeIn(e.fadeIn, d)
		}
		if ("stop" == e) return this.data("blinkStop", !0).stop(!0, !0).show();
		this.data("blinkStop", !1);
		e = a.extend({},
		{
			fadeIn: 100,
			fadeOut: 300
		},
		e || {});
		d(this);
		return this
	};
	a.fn.preload = function() {
		this.each(function() {
			a("\x3cimg/\x3e")[0].src = this
		})
	};
	a.fn.darkenPreviewElement = function(e, d, g, j) {
		null == j && (j = {});
		var k = a("\x3cdiv\x3e\x3c/div\x3e");
		k.data("boundedElement", a(this));
		var l = "body"; ! a.dmx.preview.wnd().jQuery.DM.isBodyScrollable() && 0 < a.dmfw.getPreviewElement("#iscrollBody").has(a(this)).length && (l = "#site_content");
		a.dmfw.getPreviewElement(l).append(k);
		k.addClass(g ? "dmTransedLayoutElement": "dmDrakedElement");
		j.fixed && k.addClass("dmDrakedElementFixed");
		k.width(a(this).outerWidth());
		k.height(a(this).outerHeight(!0)); ! a.dmx.preview.wnd().jQuery.DM.isBodyScrollable() && !j.fixed ? k.css("top", a(this).position().top + "px") : k.css("top", a(this).offset().top + "px");
		k.css("left", a(this).offset().left + "px");
		null != e && (k.append(e), e.css("top", d.top + "px"), e.css("left", d.left + "px"), e.attr("class", e.attr("class")));
		k.fadeIn("fast")
	};
	a.fn.darkenPreviewIframe = function() {
		var e = a("\x3cdiv\x3e\x3c/div\x3e"),
		d = a(".neePreviewInnerDiv");
		d.append(e);
		e.addClass("dmDrakedElement");
		e.width(d.outerWidth(!0));
		e.height(d.outerHeight(!0));
		e.css("top", "40px").css("left", "1px");
		e.show()
	};
	a.fn.dmImgNaturalSize = function() {
		if (this) {
			var e = a(this);
			if (e.is("img")) {
				if (void 0 == e.prop("naturalWidth")) {
					var d = a("\x3cimg/\x3e").attr("src", e.attr("src"));
					e.prop("naturalWidth", d[0].width);
					e.prop("naturalHeight", d[0].height)
				}
				return {
					width: e.prop("naturalWidth"),
					height: e.prop("naturalHeight")
				}
			}
		}
		return {}
	}
})(jQuery); (function(a) {
	a.fn.hoverIntent = function(e, d) {
		var g = {
			sensitivity: 7,
			interval: 100,
			timeout: 0
		},
		g = a.extend(g, d ? {
			over: e,
			out: d
		}: e),
		j = 0,
		k = 0,
		l = 0,
		m = 0,
		n = function(a) {
			j = a.pageX;
			k = a.pageY
		},
		o = function(d, e) {
			e.hoverIntent_t = clearTimeout(e.hoverIntent_t);
			if (Math.abs(l - j) + Math.abs(m - k) < g.sensitivity) return a(e).unbind("mousemove", n),
			e.hoverIntent_s = 1,
			g.over.apply(e, [d]);
			l = j;
			m = k;
			e.hoverIntent_t = setTimeout(function() {
				o(d, e)
			},
			g.interval)
		},
		r = function(d) {
			var e = jQuery.extend({},
			d),
			j = this;
			j.hoverIntent_t && (j.hoverIntent_t = clearTimeout(j.hoverIntent_t));
			"mouseenter" == d.type ? (l = e.pageX, m = e.pageY, a(j).bind("mousemove", n), 1 != j.hoverIntent_s && (j.hoverIntent_t = setTimeout(function() {
				o(e, j)
			},
			g.interval))) : (a(j).unbind("mousemove", n), 1 == j.hoverIntent_s && (j.hoverIntent_t = setTimeout(function() {
				j.hoverIntent_t = clearTimeout(j.hoverIntent_t);
				j.hoverIntent_s = 0;
				g.out.apply(j, [e])
			},
			g.timeout)))
		};
		return this.bind("mouseenter", r).bind("mouseleave", r)
	}
})(jQuery); (function() {
	function a(a) {
		if (a && a.target) try {
			document.activeElement = a.target == document ? null: a.target
		} catch(d) {}
	}
	function e() {
		try {
			document.activeElement = null
		} catch(a) {}
	}
	try {
		document.activeElement || (document.addEventListener("focus", a, !0), document.addEventListener("blur", e, !0))
	} catch(d) {}
})(jQuery); (function(a) {
	var e = 0;
	a.getScrollbarWidth = function() {
		if (!e) if (a.browser.msie) {
			var d = a('\x3ctextarea cols\x3d"10" rows\x3d"2"\x3e\x3c/textarea\x3e').css({
				position: "absolute",
				top: -1E3,
				left: -1E3
			}).appendTo("body"),
			g = a('\x3ctextarea cols\x3d"10" rows\x3d"2" style\x3d"overflow: hidden;"\x3e\x3c/textarea\x3e').css({
				position: "absolute",
				top: -1E3,
				left: -1E3
			}).appendTo("body");
			e = d.width() - g.width();
			d.add(g).remove()
		} else d = a("\x3cdiv /\x3e").css({
			width: 100,
			height: 100,
			overflow: "auto",
			position: "absolute",
			top: -1E3,
			left: -1E3
		}).prependTo("body").append("\x3cdiv /\x3e").find("div").css({
			width: "100%",
			height: 200
		}),
		e = 100 - d.width(),
		d.parent().remove();
		return e
	}
})(jQuery); (function(a) {
	a.isMyStuffScrolling = function() {
		var d = a(document).height(),
		e = a(window).height();
		return d > e ? !0 : !1
	};
	a.getNavigationJSONElement = function(d) {
		var e = [];
		if (d && 0 < d.size()) {
			d = d.find(" \x3e li");
			for (var k = 0; k < d.size(); k++) {
				var l = a(d.get(k));
				if (!l.is(".dmHideFromNav")) {
					var m = l.find("a:first");
					e.push({
						id: "",
						a_class: m.attr("class"),
						a_target: !m.attr("target") || "" == m.attr("target") ? "": m.attr("target"),
						li_class: l.attr("class") + " " + l.attr("id"),
						href: m.attr("href"),
						text: l.find("div.navText:first").text(),
						sub: a.getNavigationJSONElement(l.find("ul:first")),
						font_icon: m.attr("icon-name") ? "hasFontIcon " + m.attr("icon-name") : ""
					})
				}
			}
		}
		return e
	};
	a.refreshDesktopNav = function(g, j) {
		var k = a.dmfw.getPreviewElement("ul#upperFloatingNavigation"),
		l,
		m;
		0 < k.length && (j = j || parseInt(k.attr("dmoffset")), l = k.find("li#desktopTopNavBtnHidden").removeClass("desktopTopNav"), m = k.find(".dmHomeButton:first"), 0 < m.length && (j -= 1), (m = g.length > j + 1) || (j += 1), k.find("\x3eli:not(#desktopTopNavBtnHidden, .dmHomeButton, .slideUpTrigger)").remove(), e(g.slice(0, j), k, l, "hasdmSub", "dmSub", 0, !0, !0, "desktopTopNav"), m && (m = d({
			id: "",
			text: "More",
			li_class: "desktopTopNav desktopTopNavMoreBtn dmUDNavigationItem_dmMore  navButtonLi"
		},
		l), m.append('\x3cul class\x3d"dmNavigationStyle_1 dmNavigation dmn"\x3e\x3c/ul\x3e'), m.appendTo(k), e(g.slice(j), m.find("ul"), l, "hasdmSub", "dmSub", 1, !0, !0)))
	};
	a.refreshTabletSideNav = function(e) {
		var j = a.dmfw.getPreviewElement("ul#leftSidebar"),
		k;
		if (0 < j.length) {
			k = j.find("li#leftSidebarBtnHidden");
			j.find("\x3eli:not(#leftSidebarBtnHidden, .dmHomeButton, .slideDownTrigger)").remove();
			for (j = 0; j < e.length; j++) {
				var l = d(e[j], k);
				l.insertBefore(k);
				l.html(l.html());
				l.attr("class", l.attr("class"))
			}
		}
	};
	a.refreshBottomBar = function(e, j) {
		var k = a.dmfw.getPreviewElement("ul#fixFoot");
		if (0 < k.length) {
			var l = k.find(".dmHomeButton:first"),
			m = k.find("li#footerBtnHidden:first");
			0 < l.size() && (j -= 1); (l = e.length > j + 1) || (j += 1);
			k.find("\x3eli:not(#footerBtnHidden, .dmHomeButton, .slideUpTrigger)").remove();
			k.find("\x3eli.slideUpTrigger").toggleClass("dmDisplay_None", !l);
			for (k = 0; k < j && k < e.length; k++) l = d(e[k], m),
			l.insertBefore(m),
			l.html(l.html()),
			l.attr("class", l.attr("class"));
			a.dmfw.getPreviewElement(".slideUpTrigger .navItemText").text(a.dmfw.getPreviewElement(".dmNav #dmMore a .navText").text())
		}
	};
	a.refreshTabBar = function(e, j) {
		var k = a.dmfw.getPreviewElement("ul#upperTabs");
		if (0 < k.length) {
			var l = k.find(".dmHomeButton:first"),
			m = k.find("li#tabBtnHidden:first");
			0 < l.size() && (j -= 1); (l = e.length > j + 1) || (j += 1);
			k.find("\x3eli:not(#tabBtnHidden, .dmHomeButton, .slideDownTrigger)").remove();
			k.find("\x3eli.slideDownTrigger").toggleClass("dmDisplay_None", !l);
			for (k = 0; k < j && k < e.length; k++) l = d(e[k], m),
			l.insertBefore(m),
			l.html(l.html()),
			l.attr("class", l.attr("class"));
			a.dmfw.getPreviewElement(".slideUpTrigger .navItemText").text(a.dmfw.getPreviewElement(".dmNav #dmMore a .navText").text())
		}
	};
	a.refreshSlideMenu = function(d, j) {
		var k = a.dmfw.getPreviewElement("#slideDownNav ul:first, #slideUpNav ul:first");
		if (0 < k.length) {
			j = j || k.parent().attr("dmoffset");
			var l = k.find("li#listBtnHidden:first");
			k.find("\x3eli:not(#listBtnHidden)").remove();
			var m = d.slice();
			j = j || 0;
			for (var n = 0; n < j; n++) m.shift();
			e(m, k, l, "hasdmSub", "dmSub", 0)
		}
	};
	var e = function(g, j, k, l, m, n, o, r, u) {
		for (var s = 0; s < g.length; s++) {
			var B = d(g[s], k);
			j.append(B);
			B.html(B.html());
			B.attr("class", B.attr("class"));
			o && 0 < n && B.addClass(m);
			2 == n ? B.addClass(m + "2") : 0 == n && u && B.addClass(u);
			if (0 < g[s].sub.length) {
				B.addClass(l);
				if (r) {
					var z = a('\x3cul class\x3d"dmNavigationStyle_1 dmNavigation dmn"\x3e');
					B.append(z)
				}
				e(g[s].sub, r ? z: j, k, l, m, n + 1, !0)
			}
		}
	},
	d = function(d, e) {
		var k = e.clone();
		k.removeClass("dmHideFromNav");
		k.attr("id", d.id);
		var l = a('\x3cdiv id\x3d"linkTemplate" type\x3d"text/x-jquery-tmpl"\x3e\x3c/div\x3e');
		l.append(k);
		return l.tmpl(d)
	};
	a.refreshLayoutNavigations = function(d) {
		var e = d || 3,
		k = a.getNavigationJSONElement(a.dmfw.getPreviewElement(".hiddenNavPlaceHolder \x3e ul"));
		a.refreshBottomBar(k, e);
		a.refreshTabBar(k, e);
		a.refreshSlideMenu(k);
		a.refreshDesktopNav(k, d);
		a.refreshTabletSideNav(k);
		a.dmx.site.isUsingLayout && a.dmx.preview.wnd().$.layoutManager.initLayout()
	}
})(jQuery); (function(a) {
	a.isIconClass = function(a) {
		return a && (a.startsWith("icon-") || a.startsWith("dm-icon-"))
	}
})(jQuery); (function() {
	function a(a) {
		e.push(a);
		window.postMessage(d, "*")
	}
	var e = [],
	d = "zero-timeout-message";
	window.addEventListener("message",
	function(a) {
		a.source == window && a.data == d && (a.stopPropagation(), 0 < e.length && e.shift()())
	},
	!0);
	window.setImmediate = window.setImmediate || a
})(); (function(a) {
	var e = !1;
	window.onerror = function() {
		e || (e = !0, a.dmUnblockUI(), a.dmNotifyEx(void 0), e = !1)
	}
})(jQuery); (function(a) {
	a(window).resize(function() {
		a.dmfw && a.dmfw.adjustScreenHeight()
	})
})(jQuery);
Array.prototype.remove = function(a, e) {
	var d = this.slice((e || a) + 1 || this.length);
	this.length = 0 > a ? this.length + a: a;
	return this.push.apply(this, d)
}; (function(a) {
	a.fn.single_double_click = function(e, d) {
		return this.each(function() {
			var g = 0,
			j = this;
			a(this).click(function(k) {
				g++;
				1 == g && !a(k.target).is(document) ? setTimeout(function() {
					1 == g ? e && e.call(j, k) : d && d.call(j, k);
					g = 0
				},
				200) : a(k.target).is(document) && (g = 0)
			})
		})
	};
	a.fn.getElementLocation = function() {
		return {
			top: this.position().top,
			left: this.position().left,
			width: this.width(),
			height: this.height()
		}
	}
})(jQuery); (function(a) {
	var e = function(a) {
		var d = [];
		a = a || "";
		if (a instanceof Array) d = a;
		else if (a = a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,
		function(a, d, e, g) {
			return d + d + e + e + g + g
		}), a = (a = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a)) ? {
			r: parseInt(a[1], 16),
			g: parseInt(a[2], 16),
			b: parseInt(a[3], 16)
		}: null) d[0] = a.r,
		d[1] = a.g,
		d[2] = a.b;
		return d
	},
	d = function(a, d, e) {
		return g(a) + g(d) + g(e)
	},
	g = function(a) {
		a = parseInt(a, 10);
		if (isNaN(a)) return "00";
		a = Math.max(0, Math.min(a, 255));
		return "0123456789ABCDEF".charAt((a - a % 16) / 16) + "0123456789ABCDEF".charAt(a % 16)
	};
	a.getLabDistance = function(a, d, e) {
		try {
			if (a && d) {
				Color && !e && (a = Color.convert(a, "lab"), d = Color.convert(d, "lab"));
				e = ["l", "a", "b"];
				for (var g = 0,
				n = 0; 3 > n; n++) g += Math.pow(a[e[n]] - d[e[n]], 2);
				return Math.sqrt(g)
			}
		} catch(o) {}
		return ! 1
	};
	a.getImageColor = function(a, e) {
		if (!a || -1 === a.indexOf(";base64,")) e && e(d(0, 0, 0));
		else {
			var g = new Image;
			g.onload = function() {
				var a = document.createElement("canvas");
				a.width = g.width;
				a.height = g.height;
				var j = a.getContext("2d");
				j.drawImage(g, 0, 0);
				for (var a = j.getImageData(0, 0, a.width, a.height), o, j = 3; j < a.data.length; j += 4) if (210 < a.data[j]) {
					o = d(a.data[j - 3], a.data[j - 2], a.data[j - 1]);
					break
				}
				e && (o ? e(o) : e(d(0, 0, 0)))
			};
			g.src = a
		}
	};
	a.convertUtils = a.convertUtils || {};
	a.convertUtils.colors = a.convertUtils.colors || {};
	a.convertUtils.colors.convertToRGB = e;
	a.convertUtils.colors.rgbToHex = d;
	a.changeColor = function(d, g) {
		var l = a.Deferred();
		try {
			var m = e(g);
			if (d && -1 != d.indexOf("png;base64") && 3 == m.length) {
				var n = new Image,
				o = !1,
				r = function() {
					if (!o) {
						o = !0;
						var a = document.createElement("canvas"),
						d = a.getContext("2d");
						a.height = n.height;
						a.width = n.width;
						d.drawImage(n, 0, 0);
						for (var e = d.getImageData(0, 0, n.width, n.height), g = 0; g < e.data.length; g += 4) e.data[g] = m[0],
						e.data[g + 1] = m[1],
						e.data[g + 2] = m[2];
						d.putImageData(e, 0, 0);
						a = a.toDataURL("image/png");
						l.resolve(a)
					}
				};
				n.onload = r;
				n.onerror = function() {
					l.reject(d)
				};
				n.src = d;
				n.style.display = "block";
				n.complete && r()
			} else l.resolve(d)
		} catch(u) {
			l.reject(d)
		}
		return l.promise()
	};
	a.fn.changeColor = function(d) {
		var e = a(this),
		g = e.attr("src");
		a.changeColor(g, d).done(function(a) {
			e.attr("src", a)
		})
	}
})(jQuery); (function(a) {
	function e(a, e) {
		var j = [],
		k = [],
		j = "",
		l = {};
		e = e || {};
		l.error = !1;
		if (!a) return l.jsonObj = [],
		l.jsonText = "[]",
		l;
		for (var j = a.split(/[\r\n]/g), m = 0; m < j.length; m++)"" == j[m].replace(/^[\s]*|[\s]*$/g, "") && (j.splice(m, 1), m--);
		k = [];
		if (! (m = e.colDel)) a: {
			if (m = j[0]) {
				if ( - 1 != m.indexOf("\t")) {
					m = "\t";
					break a
				}
				if ( - 1 != m.indexOf(";")) {
					m = ";";
					break a
				}
			}
			m = ","
		}
		for (var n = m,
		m = 0; m < j.length; m++) {
			for (var o = j,
			r = m,
			u = j[m], u = u.split(n), s = 0; s < u.length; s++) {
				var B = u[s].replace(/^[\s]*|[\s]*$/g, ""),
				z = "";
				if ('"' == B.charAt(0) || "'" == B.charAt(0)) z = B.charAt(0);
				"" != z && B.charAt(B.length - 1) == z && (z = "");
				if ("" != z) {
					var v = s + 1;
					for (v < u.length && (B = u[v].replace(/^[\s]*|[\s]*$/g, "")); v < u.length && B.charAt(B.length - 1) != z;) u[s] += "," + u[v],
					u.splice(v, 1),
					B = u[v].replace(/[\s]*$/g, "");
					v < u.length && (u[s] += "," + u[v], u.splice(v, 1))
				}
			}
			for (s = 0; s < u.length; s++) u[s] = u[s].replace(/^[\s]*|[\s]*$/g, ""),
			'"' == u[s].charAt(0) ? u[s] = u[s].replace(/^"|"$/g, "") : "'" == u[s].charAt(0) && (u[s] = u[s].replace(/^'|'$/g, ""));
			o[r] = u
		}
		if (e.noHeaderRow) k = j;
		else for (m = 1; m < j.length; m++) {
			0 < j[m].length && k.push({});
			for (n = 0; n < j[m].length; n++) k[m - 1][j[0][n]] = j[m][n]
		}
		j = JSON.stringify(k, null, "\t");
		l.jsonText = j;
		l.jsonObj = k;
		return l
	}
	a.convertUtils = a.convertUtils || {};
	a.convertUtils.formats = a.convertUtils.formats || {};
	a.convertUtils.formats.csvToJson = function(a, g) {
		g = g || {};
		var j = e(a, g);
		if (j.error) return g.error && g.error(j.error),
		{};
		g.success && g.success(j);
		return j.jsonObj
	};
	a.convertUtils.formats.csvFileToJson = function(a, g) {
		g = g || {};
		if (!a || !a.type.match("ms-excel")) g.error && g.error({
			nocsv: !0
		});
		else {
			var j = new FileReader;
			j.onload = function(a) {
				a = e(a.target.result, g);
				if (a.error) return g.error && g.error(a.error),
				{};
				g.success && g.success(a)
			};
			j.readAsText(a)
		}
	}
})(jQuery, this); (function(a) {
	var e;
	"undefined" == typeof e && (e = function() {});
	e.ObjTree = function() {
		return this
	};
	e.ObjTree.prototype.xmlDecl = '\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8" ?\x3e\n';
	e.ObjTree.prototype.attr_prefix = "-";
	e.ObjTree.prototype.parseXML = function(a) {
		var e;
		if (window.DOMParser) {
			e = new DOMParser;
			a = e.parseFromString(a, "application/xml");
			if (!a) return;
			e = a.documentElement
		} else window.ActiveXObject && (e = new ActiveXObject("Microsoft.XMLDOM"), e.async = !1, e.loadXML(a), e = e.documentElement);
		if (e) return this.parseDOM(e)
	};
	e.ObjTree.prototype.parseHTTP = function(a, e, j) {
		var k = {},
		l;
		for (l in e) k[l] = e[l];
		k.method || (k.method = "undefined" == typeof k.postBody && "undefined" == typeof k.postbody && "undefined" == typeof k.parameters ? "get": "post");
		if (j) {
			k.asynchronous = !0;
			var m = this,
			n = k.onComplete;
			k.onComplete = function(a) {
				var d;
				a && (a.responseXML && a.responseXML.documentElement) && (d = m.parseDOM(a.responseXML.documentElement));
				j(d, a);
				n && n(a)
			}
		} else k.asynchronous = !1;
		var o;
		if ("undefined" != typeof HTTP && HTTP.Request) {
			if (k.uri = a, a = new HTTP.Request(k)) o = a.transport
		} else if ("undefined" != typeof Ajax && Ajax.Request && (a = new Ajax.Request(a, k))) o = a.transport;
		if (j) return o;
		if (o && o.responseXML && o.responseXML.documentElement) return this.parseDOM(o.responseXML.documentElement)
	};
	e.ObjTree.prototype.parseDOM = function(a) {
		if (a) {
			this.__force_array = {};
			if (this.force_array) for (var e = 0; e < this.force_array.length; e++) this.__force_array[this.force_array[e]] = 1;
			e = this.parseElement(a);
			this.__force_array[a.nodeName] && (e = [e]);
			if (11 != a.nodeType) {
				var j = {};
				j[a.nodeName] = e;
				e = j
			}
			return e
		}
	};
	e.ObjTree.prototype.parseElement = function(a) {
		if (7 != a.nodeType) {
			if (3 == a.nodeType || 4 == a.nodeType) return null == a.nodeValue.match(/[^\x00-\x20]/) ? void 0 : a.nodeValue;
			var e, j = {};
			if (a.attributes && a.attributes.length) {
				e = {};
				for (var k = 0; k < a.attributes.length; k++) {
					var l = a.attributes[k].nodeName;
					if ("string" == typeof l) {
						var m = a.attributes[k].nodeValue;
						m && (l = this.attr_prefix + l, "undefined" == typeof j[l] && (j[l] = 0), j[l]++, this.addNode(e, l, j[l], m))
					}
				}
			}
			if (a.childNodes && a.childNodes.length) {
				l = !0;
				e && (l = !1);
				for (k = 0; k < a.childNodes.length && l; k++) m = a.childNodes[k].nodeType,
				3 == m || 4 == m || (l = !1);
				if (l) {
					e || (e = "");
					for (k = 0; k < a.childNodes.length; k++) e += a.childNodes[k].nodeValue
				} else {
					e || (e = {});
					for (k = 0; k < a.childNodes.length; k++) if (l = a.childNodes[k].nodeName, "string" == typeof l && (m = this.parseElement(a.childNodes[k])))"undefined" == typeof j[l] && (j[l] = 0),
					j[l]++,
					this.addNode(e, l, j[l], m)
				}
			}
			return e
		}
	};
	e.ObjTree.prototype.addNode = function(a, e, j, k) {
		this.__force_array[e] ? (1 == j && (a[e] = []), a[e][a[e].length] = k) : 1 == j ? a[e] = k: 2 == j ? a[e] = [a[e], k] : a[e][a[e].length] = k
	};
	e.ObjTree.prototype.writeXML = function(a) {
		a = this.hash_to_xml(null, a);
		return this.xmlDecl + a
	};
	e.ObjTree.prototype.hash_to_xml = function(a, e) {
		var j = [],
		k = [],
		l;
		for (l in e) if (e.hasOwnProperty(l)) {
			var m = e[l];
			l.charAt(0) != this.attr_prefix ? j[j.length] = "undefined" == typeof m || null == m ? "\x3c" + l + " /\x3e": "object" == typeof m && m.constructor == Array ? this.array_to_xml(l, m) : "object" == typeof m ? this.hash_to_xml(l, m) : this.scalar_to_xml(l, m) : k[k.length] = " " + l.substring(1) + '\x3d"' + this.xml_escape(m) + '"'
		}
		k = k.join("");
		l = j.join("");
		"undefined" == typeof a || null == a || (l = 0 < j.length ? l.match(/\n/) ? "\x3c" + a + k + "\x3e\n" + l + "\x3c/" + a + "\x3e\n": "\x3c" + a + k + "\x3e" + l + "\x3c/" + a + "\x3e\n": "\x3c" + a + k + " /\x3e\n");
		return l
	};
	e.ObjTree.prototype.array_to_xml = function(a, e) {
		for (var j = [], k = 0; k < e.length; k++) {
			var l = e[k];
			j[j.length] = "undefined" == typeof l || null == l ? "\x3c" + a + " /\x3e": "object" == typeof l && l.constructor == Array ? this.array_to_xml(a, l) : "object" == typeof l ? this.hash_to_xml(a, l) : this.scalar_to_xml(a, l)
		}
		return j.join("")
	};
	e.ObjTree.prototype.scalar_to_xml = function(a, e) {
		return "#text" == a ? this.xml_escape(e) : "\x3c" + a + "\x3e" + this.xml_escape(e) + "\x3c/" + a + "\x3e\n"
	};
	e.ObjTree.prototype.xml_escape = function(a) {
		return (a + "").replace(/&/g, "\x26amp;").replace(/</g, "\x26lt;").replace(/>/g, "\x26gt;").replace(/"/g, "\x26quot;")
	};
	e.formatXml = function(a) {
		a = a.replace(/(>)(<)(\/*)/g, "$1\n$2$3").replace(/ *(.*) +\n/g, "$1\n").replace(/(<.+>)(.+\n)/g, "$1\n$2");
		var e = "";
		a = a.split("\n");
		for (var j = 0,
		k = "other",
		l = {
			"single-\x3esingle": 0,
			"single-\x3eclosing": -1,
			"single-\x3eopening": 0,
			"single-\x3eother": 0,
			"closing-\x3esingle": 0,
			"closing-\x3eclosing": -1,
			"closing-\x3eopening": 0,
			"closing-\x3eother": 0,
			"opening-\x3esingle": 1,
			"opening-\x3eclosing": 0,
			"opening-\x3eopening": 1,
			"opening-\x3eother": 1,
			"other-\x3esingle": 0,
			"other-\x3eclosing": -1,
			"other-\x3eopening": 0,
			"other-\x3eother": 0
		},
		m = 0; m < a.length; m++) {
			for (var n = a[m], o = Boolean(n.match(/<.+\/>/)), r = Boolean(n.match(/<\/.+>/)), u = Boolean(n.match(/<[^!].*>/)), r = o ? "single": r ? "closing": u ? "opening": "other", o = k + "-\x3e" + r, k = r, r = "", j = j + l[o], u = 0; u < j; u++) r += "\t";
			e = "opening-\x3eclosing" == o ? e.substr(0, e.length - 1) + n + "\n": e + (r + n + "\n")
		}
		return e
	};
	a.convertUtils = a.convertUtils || {};
	a.convertUtils.formats = a.convertUtils.formats || {};
	a.convertUtils.formats.xmlToJson = function(a) {
		a = (new e.ObjTree).parseXML(a);
		return JSON.stringify(a)
	};
	a.convertUtils.formats.jsonToXml = function(a) {
		var g = new e.ObjTree;
		a = "string" === typeof a ? JSON.parse(a) : a;
		return e.formatXml(g.writeXML(a))
	}
})(jQuery, this); (function(a, e, d) {
	RGBtoHSV = function(a) {
		var e, k, l, m;
		e = a[0];
		k = a[1];
		l = a[2];
		min = Math.min(e, k, l);
		m = max = Math.max(e, k, l);
		delta = max - min;
		if (0 != max) a = delta / max;
		else return [ - 1, 0, d];
		e = e === max ? (k - l) / delta: k === max ? 2 + (l - e) / delta: 4 + (e - k) / delta;
		e *= 60;
		0 > e && (e += 360);
		return [e, a, m]
	};
	HSVtoRGB = function(a) {
		var d, e, l;
		e = a[0];
		l = a[1];
		a = a[2];
		if (0 === l) return e = l = a,
		[e, l, a];
		e /= 60;
		d = Math.floor(e);
		f = e - d;
		p = a * (1 - l);
		q = a * (1 - l * f);
		t = a * (1 - l * (1 - f));
		switch (d) {
		case 0:
			e = a;
			l = t;
			a = p;
			break;
		case 1:
			e = q;
			l = a;
			a = p;
			break;
		case 2:
			e = p;
			l = a;
			a = t;
			break;
		case 3:
			e = p;
			l = q;
			break;
		case 4:
			e = t;
			l = p;
			break;
		default:
			e = a,
			l = p,
			a = q
		}
		return [e, l, a]
	};
	a.convertUtils = a.convertUtils || {};
	a.convertUtils.colors = a.convertUtils.colors || {};
	a.convertUtils.colors.HSLtoRGB = function(a, d, e) {
		if (0 == d) e = d = a = e;
		else {
			var l = function(a, d, e) {
				0 > e && (e += 1);
				1 < e && (e -= 1);
				return e < 1 / 6 ? a + 6 * (d - a) * e: 0.5 > e ? d: e < 2 / 3 ? a + 6 * (d - a) * (2 / 3 - e) : a
			},
			m = 0.5 > e ? e * (1 + d) : e + d - e * d,
			n = 2 * e - m;
			e = l(n, m, a + 1 / 3);
			d = l(n, m, a);
			a = l(n, m, a - 1 / 3)
		}
		return [255 * e, 255 * d, 255 * a]
	};
	a.convertUtils.colors.RGBtoHSL = function(a, d, e) {
		a /= 255;
		d /= 255;
		e /= 255;
		var l = Math.max(a, d, e),
		m = Math.min(a, d, e),
		n,
		o = (l + m) / 2;
		if (l == m) n = m = 0;
		else {
			var r = l - m,
			m = 0.5 < o ? r / (2 - l - m) : r / (l + m);
			switch (l) {
			case a:
				n = (d - e) / r + (d < e ? 6 : 0);
				break;
			case d:
				n = (e - a) / r + 2;
				break;
			case e:
				n = (a - d) / r + 4
			}
			n /= 6
		}
		return [n, m, o]
	};
	a.convertUtils.colors.RGBStringToArray = function(a) {
		a = a.replace("rgb(", "");
		a = a.replace(")", "");
		return a.split(",")
	};
	a.convertUtils.colors.RGBObjectToString = function(a) {
		var d = "";
		return d = "rgb(" + a.red + "," + a.green + "," + a.blue + ")"
	};
	a.convertUtils.colors.RGBArrayToString = function(a) {
		var d = "";
		return d = "rgb(" + a[0] + "," + a[1] + "," + a[2] + ")"
	}
})(jQuery, this); (function(a) {
	var e = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");
	a.convertUtils = a.convertUtils || {};
	a.convertUtils.dates = a.convertUtils.dates || {};
	a.convertUtils.dates.getDateString = function(a) {
		a = new Date(a);
		return [e[a.getMonth()], " ", a.getDate(), ", ", a.getFullYear(), " ", a.getHours(), ":", 10 > a.getMinutes() ? "0" + a.getMinutes() : a.getMinutes()].join("")
	}
})(jQuery, this);
function isNumber(a) {
	return ! isNaN(parseInt(a)) && isFinite(a)
}
function getElementWidthInPercents(a) {
	var e = a.outerWidth();
	a = a.parent().outerWidth();
	return 100 * e / a
} (function(a) {
	a.fn.startAction = function(e) {
		e = e || {};
		e = e.minTime || 1E3;
		var d = a(this),
		g = a.Deferred();
		d.attr("disabled", "");
		d.data("counter", g);
		d.each(function() {
			a(this).data("original-text", a(this).text())
		});
		d.data("loading-text") && d.text(d.data("loading-text"));
		d.addClass("neeButtonLoading");
		setTimeout(function() {
			g.resolve()
		},
		e)
	};
	a.fn.forceEndAction = function() {
		var e = a(this);
		e.removeAttr("disabled");
		e.removeClass("neeButtonLoading");
		e.each(function() {
			a(this).text(a(this).data("end-text") || a(this).data("original-text"))
		});
		e.data("counter").reject()
	};
	a.fn.endAction = function(e) {
		e = e || {};
		var d = a(this);
		d.data("counter").done(function() {
			d.forceEndAction(e)
		})
	}
})(jQuery, this); (function(a) {
	var e = {
		put: function(a, d) { (d || window).location.hash = this.encoder(a)
		},
		get: function(d) {
			d = (d || window).location.hash.replace(/^#/, "");
			try {
				return a.browser.mozilla ? d: decodeURIComponent(d)
			} catch(e) {
				return d
			}
		},
		encoder: encodeURIComponent
	},
	d = {
		appState: void 0,
		callback: void 0,
		init: function() {},
		check: function() {},
		load: function() {}
	};
	a.history = d;
	var g = {
		init: function(g, k) {
			var l;
			l = a.extend({
				unescape: !1
			},
			k || {});
			var m = l.unescape;
			if (!0 === m) l = function(a) {
				return a
			};
			else {
				if (l = "string" == typeof m) {
					l = m.split("");
					var n = RegExp(a.map(l, encodeURIComponent).join("|"), "ig");
					l = m = function(a) {
						return a.replace(n, decodeURIComponent)
					}
				}
				l = l || "function" == typeof m ?
				function(a) {
					return m(encodeURIComponent(a))
				}: encodeURIComponent
			}
			e.encoder = l;
			d.callback = g;
			l = e.get();
			d.appState = l;
			"onhashchange" in window ? window.onhashchange = d.check: setInterval(d.check, 100)
		},
		check: function() {
			var a = e.get();
			a != d.appState && (d.appState = a, d.callback(a))
		},
		load: function(a) {
			a != d.appState && (e.put(a), d.appState = a)
		}
	}; (!a.browser.msie || !(8 > a.browser.version || 8 > document.documentMode)) && a.extend(d, g)
})(jQuery);
window.rangy = function() {
	function a(a, d) {
		var e = typeof a[d];
		return "function" == e || !!("object" == e && a[d]) || "unknown" == e
	}
	function e(a, d) {
		return !! ("object" == typeof a[d] && a[d])
	}
	function d(a, d) {
		return "undefined" != typeof a[d]
	}
	function g(a) {
		return function(d, e) {
			for (var g = e.length; g--;) if (!a(d, e[g])) return ! 1;
			return ! 0
		}
	}
	function j(a) {
		return a && s(a, u) && z(a, r)
	}
	function k(a) {
		window.alert("Rangy not supported in your browser. Reason: " + a);
		v.initialized = !0;
		v.supported = !1
	}
	function l() {
		if (!v.initialized) {
			var d, g = !1,
			m = !1;
			a(document, "createRange") && (d = document.createRange(), s(d, o) && z(d, n) && (g = !0), d.detach());
			if ((d = e(document, "body") ? document.body: document.getElementsByTagName("body")[0]) && a(d, "createTextRange")) d = d.createTextRange(),
			j(d) && (m = !0); ! g && !m && k("Neither Range nor TextRange are implemented");
			v.initialized = !0;
			v.features = {
				implementsDomRange: g,
				implementsTextRange: m
			};
			g = E.concat(D);
			m = 0;
			for (d = g.length; m < d; ++m) try {
				g[m](v)
			} catch(l) {
				e(window, "console") && a(window.console, "log") && window.console.log("Init listener threw an exception. Continuing.", l)
			}
		}
	}
	function m(a) {
		this.name = a;
		this.supported = this.initialized = !1
	}
	var n = "startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),
	o = "setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
	r = "boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),
	u = "collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),
	s = g(a),
	B = g(e),
	z = g(d),
	v = {
		version: "1.2.3",
		initialized: !1,
		supported: !0,
		util: {
			isHostMethod: a,
			isHostObject: e,
			isHostProperty: d,
			areHostMethods: s,
			areHostObjects: B,
			areHostProperties: z,
			isTextRange: j
		},
		features: {},
		modules: {},
		config: {
			alertOnWarn: !1,
			preferTextRange: !1
		}
	};
	v.fail = k;
	v.warn = function(a) {
		a = "Rangy warning: " + a;
		v.config.alertOnWarn ? window.alert(a) : "undefined" != typeof window.console && "undefined" != typeof window.console.log && window.console.log(a)
	}; ({}).hasOwnProperty ? v.util.extend = function(a, d) {
		for (var e in d) d.hasOwnProperty(e) && (a[e] = d[e])
	}: k("hasOwnProperty not supported");
	var D = [],
	E = [];
	v.init = l;
	v.addInitListener = function(a) {
		v.initialized ? a(v) : D.push(a)
	};
	var F = [];
	v.addCreateMissingNativeApiListener = function(a) {
		F.push(a)
	};
	v.createMissingNativeApi = function(a) {
		a = a || window;
		l();
		for (var d = 0,
		e = F.length; d < e; ++d) F[d](a)
	};
	m.prototype.fail = function(a) {
		this.initialized = !0;
		this.supported = !1;
		throw Error("Module '" + this.name + "' failed to load: " + a);
	};
	m.prototype.warn = function(a) {
		v.warn("Module " + this.name + ": " + a)
	};
	m.prototype.createError = function(a) {
		return Error("Error in Rangy " + this.name + " module: " + a)
	};
	v.createModule = function(a, d) {
		var e = new m(a);
		v.modules[a] = e;
		E.push(function(a) {
			d(a, e);
			e.initialized = !0;
			e.supported = !0
		})
	};
	v.requireModules = function(a) {
		for (var d = 0,
		e = a.length,
		g, j; d < e; ++d) {
			j = a[d];
			g = v.modules[j];
			if (!g || !(g instanceof m)) throw Error("Module '" + j + "' not found");
			if (!g.supported) throw Error("Module '" + j + "' not supported");
		}
	};
	var I = !1,
	B = function() {
		I || (I = !0, v.initialized || l())
	};
	if ("undefined" == typeof window) k("No window found");
	else if ("undefined" == typeof document) k("No document found");
	else return a(document, "addEventListener") && document.addEventListener("DOMContentLoaded", B, !1),
	a(window, "addEventListener") ? window.addEventListener("load", B, !1) : a(window, "attachEvent") ? window.attachEvent("onload", B) : k("Window does not have required addEventListener or attachEvent method"),
	v
} ();
rangy.createModule("DomUtil",
function(a, e) {
	function d(a) {
		for (var d = 0; a = a.previousSibling;) d++;
		return d
	}
	function g(a, d) {
		var e = [],
		g;
		for (g = a; g; g = g.parentNode) e.push(g);
		for (g = d; g; g = g.parentNode) if (z(e, g)) return g;
		return null
	}
	function j(a, d, e) {
		for (e = e ? a: a.parentNode; e;) {
			a = e.parentNode;
			if (a === d) return e;
			e = a
		}
		return null
	}
	function k(a) {
		a = a.nodeType;
		return 3 == a || 4 == a || 8 == a
	}
	function l(a, d) {
		var e = d.nextSibling,
		g = d.parentNode;
		e ? g.insertBefore(a, e) : g.appendChild(a);
		return a
	}
	function m(a) {
		if (9 == a.nodeType) return a;
		if ("undefined" != typeof a.ownerDocument) return a.ownerDocument;
		if ("undefined" != typeof a.document) return a.document;
		if (a.parentNode) return m(a.parentNode);
		throw Error("getDocument: no document found for node");
	}
	function n(a) {
		return ! a ? "[No node]": k(a) ? '"' + a.data + '"': 1 == a.nodeType ? "\x3c" + a.nodeName + (a.id ? ' id\x3d"' + a.id + '"': "") + "\x3e[" + a.childNodes.length + "]": a.nodeName
	}
	function o(a) {
		this._next = this.root = a
	}
	function r(a, d) {
		this.node = a;
		this.offset = d
	}
	function u(a) {
		this.code = this[a];
		this.codeName = a;
		this.message = "DOMException: " + this.codeName
	}
	var s = a.util;
	s.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || e.fail("document missing a Node creation method");
	s.isHostMethod(document, "getElementsByTagName") || e.fail("document missing getElementsByTagName method");
	var B = document.createElement("div");
	s.areHostMethods(B, ["insertBefore", "appendChild", "cloneNode"]) || e.fail("Incomplete Element implementation");
	s.isHostProperty(B, "innerHTML") || e.fail("Element is missing innerHTML property");
	B = document.createTextNode("test");
	s.areHostMethods(B, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"]) || e.fail("Incomplete Text Node implementation");
	var z = function(a, d) {
		for (var e = a.length; e--;) if (a[e] === d) return ! 0;
		return ! 1
	};
	o.prototype = {
		_current: null,
		hasNext: function() {
			return !! this._next
		},
		next: function() {
			var a = this._current = this._next,
			d;
			if (this._current) {
				if (! (d = a.firstChild)) for (d = null; a !== this.root && !(d = a.nextSibling);) a = a.parentNode;
				this._next = d
			}
			return this._current
		},
		detach: function() {
			this._current = this._next = this.root = null
		}
	};
	r.prototype = {
		equals: function(a) {
			return this.node === a.node & this.offset == a.offset
		},
		inspect: function() {
			return "[DomPosition(" + n(this.node) + ":" + this.offset + ")]"
		}
	};
	u.prototype = {
		INDEX_SIZE_ERR: 1,
		HIERARCHY_REQUEST_ERR: 3,
		WRONG_DOCUMENT_ERR: 4,
		NO_MODIFICATION_ALLOWED_ERR: 7,
		NOT_FOUND_ERR: 8,
		NOT_SUPPORTED_ERR: 9,
		INVALID_STATE_ERR: 11
	};
	u.prototype.toString = function() {
		return this.message
	};
	a.dom = {
		arrayContains: z,
		isHtmlNamespace: function(a) {
			var d;
			return "undefined" == typeof a.namespaceURI || null === (d = a.namespaceURI) || "http://www.w3.org/1999/xhtml" == d
		},
		parentElement: function(a) {
			a = a.parentNode;
			return 1 == a.nodeType ? a: null
		},
		getNodeIndex: d,
		getNodeLength: function(a) {
			var d;
			return k(a) ? a.length: (d = a.childNodes) ? d.length: 0
		},
		getCommonAncestor: g,
		isAncestorOf: function(a, d, e) {
			for (d = e ? d: d.parentNode; d;) {
				if (d === a) return ! 0;
				d = d.parentNode
			}
			return ! 1
		},
		getClosestAncestorIn: j,
		isCharacterDataNode: k,
		insertAfter: l,
		splitDataNode: function(a, d) {
			var e = a.cloneNode(!1);
			e.deleteData(0, d);
			a.deleteData(d, a.length - d);
			l(e, a);
			return e
		},
		getDocument: m,
		getWindow: function(a) {
			a = m(a);
			if ("undefined" != typeof a.defaultView) return a.defaultView;
			if ("undefined" != typeof a.parentWindow) return a.parentWindow;
			throw Error("Cannot get a window object for node");
		},
		getIframeWindow: function(a) {
			if ("undefined" != typeof a.contentWindow) return a.contentWindow;
			if ("undefined" != typeof a.contentDocument) return a.contentDocument.defaultView;
			throw Error("getIframeWindow: No Window object found for iframe element");
		},
		getIframeDocument: function(a) {
			if ("undefined" != typeof a.contentDocument) return a.contentDocument;
			if ("undefined" != typeof a.contentWindow) return a.contentWindow.document;
			throw Error("getIframeWindow: No Document object found for iframe element");
		},
		getBody: function(a) {
			return s.isHostObject(a, "body") ? a.body: a.getElementsByTagName("body")[0]
		},
		getRootContainer: function(a) {
			for (var d; d = a.parentNode;) a = d;
			return a
		},
		comparePoints: function(a, e, k, m) {
			var n;
			if (a == k) return e === m ? 0 : e < m ? -1 : 1;
			if (n = j(k, a, !0)) return e <= d(n) ? -1 : 1;
			if (n = j(a, k, !0)) return d(n) < m ? -1 : 1;
			e = g(a, k);
			a = a === e ? e: j(a, e, !0);
			k = k === e ? e: j(k, e, !0);
			if (a === k) throw Error("comparePoints got to case 4 and childA and childB are the same!");
			for (e = e.firstChild; e;) {
				if (e === a) return - 1;
				if (e === k) return 1;
				e = e.nextSibling
			}
			throw Error("Should not be here!");
		},
		inspectNode: n,
		fragmentFromNodeChildren: function(a) {
			for (var d = m(a).createDocumentFragment(), e; e = a.firstChild;) d.appendChild(e);
			return d
		},
		createIterator: function(a) {
			return new o(a)
		},
		DomPosition: r
	};
	a.DOMException = u
});
rangy.createModule("DomRange",
function(a) {
	function e(a, d) {
		return 3 != a.nodeType && (M.isAncestorOf(a, d.startContainer, !0) || M.isAncestorOf(a, d.endContainer, !0))
	}
	function d(a) {
		return M.getDocument(a.startContainer)
	}
	function g(a, d, e) {
		if (d = a._listeners[d]) for (var g = 0,
		j = d.length; g < j; ++g) d[g].call(a, {
			target: a,
			args: e
		})
	}
	function j(a) {
		return new ja(a.parentNode, M.getNodeIndex(a))
	}
	function k(a) {
		return new ja(a.parentNode, M.getNodeIndex(a) + 1)
	}
	function l(a, d, e) {
		var g = 11 == a.nodeType ? a.firstChild: a;
		M.isCharacterDataNode(d) ? e == d.length ? M.insertAfter(a, d) : d.parentNode.insertBefore(a, 0 == e ? d: M.splitDataNode(d, e)) : e >= d.childNodes.length ? d.appendChild(a) : d.insertBefore(a, d.childNodes[e]);
		return g
	}
	function m(a) {
		for (var e, g, j = d(a.range).createDocumentFragment(); g = a.next();) {
			e = a.isPartiallySelectedSubtree();
			g = g.cloneNode(!e);
			e && (e = a.getSubtreeIterator(), g.appendChild(m(e)), e.detach(!0));
			if (10 == g.nodeType) throw new P("HIERARCHY_REQUEST_ERR");
			j.appendChild(g)
		}
		return j
	}
	function n(a, d, e) {
		var g, j;
		for (e = e || {
			stop: !1
		}; g = a.next();) if (a.isPartiallySelectedSubtree()) if (!1 === d(g)) {
			e.stop = !0;
			break
		} else {
			if (g = a.getSubtreeIterator(), n(g, d, e), g.detach(!0), e.stop) break
		} else for (g = M.createIterator(g); j = g.next();) if (!1 === d(j)) {
			e.stop = !0;
			return
		}
	}
	function o(a) {
		for (var d; a.next();) a.isPartiallySelectedSubtree() ? (d = a.getSubtreeIterator(), o(d), d.detach(!0)) : a.remove()
	}
	function r(a) {
		for (var e, g = d(a.range).createDocumentFragment(), j; e = a.next();) {
			a.isPartiallySelectedSubtree() ? (e = e.cloneNode(!1), j = a.getSubtreeIterator(), e.appendChild(r(j)), j.detach(!0)) : a.remove();
			if (10 == e.nodeType) throw new P("HIERARCHY_REQUEST_ERR");
			g.appendChild(e)
		}
		return g
	}
	function u(a, d, e) {
		var g = !(!d || !d.length),
		j,
		k = !!e;
		g && (j = RegExp("^(" + d.join("|") + ")$"));
		var m = [];
		n(new B(a, !1),
		function(a) { (!g || j.test(a.nodeType)) && (!k || e(a)) && m.push(a)
		});
		return m
	}
	function s(a) {
		return "[" + ("undefined" == typeof a.getName ? "Range": a.getName()) + "(" + M.inspectNode(a.startContainer) + ":" + a.startOffset + ", " + M.inspectNode(a.endContainer) + ":" + a.endOffset + ")]"
	}
	function B(a, d) {
		this.range = a;
		this.clonePartiallySelectedTextNodes = d;
		if (!a.collapsed) {
			this.sc = a.startContainer;
			this.so = a.startOffset;
			this.ec = a.endContainer;
			this.eo = a.endOffset;
			var e = a.commonAncestorContainer;
			this.sc === this.ec && M.isCharacterDataNode(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc === e && !M.isCharacterDataNode(this.sc) ? this.sc.childNodes[this.so] : M.getClosestAncestorIn(this.sc, e, !0), this._last = this.ec === e && !M.isCharacterDataNode(this.ec) ? this.ec.childNodes[this.eo - 1] : M.getClosestAncestorIn(this.ec, e, !0))
		}
	}
	function z(a) {
		this.code = this[a];
		this.codeName = a;
		this.message = "RangeException: " + this.codeName
	}
	function v(a, d, e) {
		this.nodes = u(a, d, e);
		this._next = this.nodes[0];
		this._position = 0
	}
	function D(a) {
		return function(d, e) {
			for (var g, j = e ? d: d.parentNode; j;) {
				g = j.nodeType;
				if (M.arrayContains(a, g)) return j;
				j = j.parentNode
			}
			return null
		}
	}
	function E(a, d) {
		if (S(a, d)) throw new z("INVALID_NODE_TYPE_ERR");
	}
	function F(a) {
		if (!a.startContainer) throw new P("INVALID_STATE_ERR");
	}
	function I(a, d) {
		if (!M.arrayContains(d, a.nodeType)) throw new z("INVALID_NODE_TYPE_ERR");
	}
	function G(a, d) {
		if (0 > d || d > (M.isCharacterDataNode(a) ? a.length: a.childNodes.length)) throw new P("INDEX_SIZE_ERR");
	}
	function K(a, d) {
		if (ka(a, !0) !== ka(d, !0)) throw new P("WRONG_DOCUMENT_ERR");
	}
	function J(a) {
		if (L(a, !0)) throw new P("NO_MODIFICATION_ALLOWED_ERR");
	}
	function C(a, d) {
		if (!a) throw new P(d);
	}
	function N(a) {
		return !! a.startContainer && !!a.endContainer && !(!M.arrayContains(H, a.startContainer.nodeType) && !ka(a.startContainer, !0)) && !(!M.arrayContains(H, a.endContainer.nodeType) && !ka(a.endContainer, !0)) && a.startOffset <= (M.isCharacterDataNode(a.startContainer) ? a.startContainer.length: a.startContainer.childNodes.length) && a.endOffset <= (M.isCharacterDataNode(a.endContainer) ? a.endContainer.length: a.endContainer.childNodes.length)
	}
	function O(a) {
		F(a);
		if (!N(a)) throw Error("Range error: Range is no longer valid after DOM mutation (" + a.inspect() + ")");
	}
	function ra() {}
	function R(a) {
		a.START_TO_START = T;
		a.START_TO_END = db;
		a.END_TO_END = va;
		a.END_TO_START = za;
		a.NODE_BEFORE = kb;
		a.NODE_AFTER = X;
		a.NODE_BEFORE_AND_AFTER = Q;
		a.NODE_INSIDE = ma
	}
	function ea(a) {
		R(a);
		R(a.prototype)
	}
	function Z(a, d) {
		return function() {
			O(this);
			var e = this.startContainer,
			g = this.startOffset,
			j = this.commonAncestorContainer,
			m = new B(this, !0);
			e !== j && (e = M.getClosestAncestorIn(e, j, !0), g = k(e), e = g.node, g = g.offset);
			n(m, J);
			m.reset();
			j = a(m);
			m.detach();
			d(this, e, g, e, g);
			return j
		}
	}
	function Y(d, g, m) {
		function n(a, d) {
			return function(e) {
				F(this);
				I(e, ua);
				I(ia(e), H);
				e = (a ? j: k)(e); (d ? l: s)(this, e.node, e.offset)
			}
		}
		function l(a, d, e) {
			var j = a.endContainer,
			k = a.endOffset;
			if (d !== a.startContainer || e !== a.startOffset) {
				if (ia(d) != ia(j) || 1 == M.comparePoints(d, e, j, k)) j = d,
				k = e;
				g(a, d, e, j, k)
			}
		}
		function s(a, d, e) {
			var j = a.startContainer,
			k = a.startOffset;
			if (d !== a.endContainer || e !== a.endOffset) {
				if (ia(d) != ia(j) || -1 == M.comparePoints(d, e, j, k)) j = d,
				k = e;
				g(a, j, k, d, e)
			}
		}
		d.prototype = new ra;
		a.util.extend(d.prototype, {
			setStart: function(a, d) {
				F(this);
				E(a, !0);
				G(a, d);
				l(this, a, d)
			},
			setEnd: function(a, d) {
				F(this);
				E(a, !0);
				G(a, d);
				s(this, a, d)
			},
			setStartBefore: n(!0, !0),
			setStartAfter: n(!1, !0),
			setEndBefore: n(!0, !1),
			setEndAfter: n(!1, !1),
			collapse: function(a) {
				O(this);
				a ? g(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : g(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset)
			},
			selectNodeContents: function(a) {
				F(this);
				E(a, !0);
				g(this, a, 0, a, M.getNodeLength(a))
			},
			selectNode: function(a) {
				F(this);
				E(a, !1);
				I(a, ua);
				var d = j(a);
				a = k(a);
				g(this, d.node, d.offset, a.node, a.offset)
			},
			extractContents: Z(r, g),
			deleteContents: Z(o, g),
			canSurroundContents: function() {
				O(this);
				J(this.startContainer);
				J(this.endContainer);
				var a = new B(this, !0),
				d = a._first && e(a._first, this) || a._last && e(a._last, this);
				a.detach();
				return ! d
			},
			detach: function() {
				m(this)
			},
			splitBoundaries: function() {
				O(this);
				var a = this.startContainer,
				d = this.startOffset,
				e = this.endContainer,
				j = this.endOffset,
				k = a === e;
				M.isCharacterDataNode(e) && 0 < j && j < e.length && M.splitDataNode(e, j);
				M.isCharacterDataNode(a) && (0 < d && d < a.length) && (a = M.splitDataNode(a, d), k ? (j -= d, e = a) : e == a.parentNode && j >= M.getNodeIndex(a) && j++, d = 0);
				g(this, a, d, e, j)
			},
			normalizeBoundaries: function() {
				O(this);
				var a = this.startContainer,
				d = this.startOffset,
				e = this.endContainer,
				j = this.endOffset,
				k = function(a) {
					var d = a.nextSibling;
					d && d.nodeType == a.nodeType && (e = a, j = a.length, a.appendData(d.data), d.parentNode.removeChild(d))
				},
				m = function(g) {
					var k = g.previousSibling;
					if (k && k.nodeType == g.nodeType) {
						a = g;
						var m = g.length;
						d = k.length;
						g.insertData(0, k.data);
						k.parentNode.removeChild(k);
						a == e ? (j += d, e = a) : e == g.parentNode && (k = M.getNodeIndex(g), j == k ? (e = g, j = m) : j > k && j--)
					}
				},
				n = !0;
				M.isCharacterDataNode(e) ? e.length == j && k(e) : (0 < j && (n = e.childNodes[j - 1]) && M.isCharacterDataNode(n) && k(n), n = !this.collapsed);
				n ? M.isCharacterDataNode(a) ? 0 == d && m(a) : d < a.childNodes.length && (k = a.childNodes[d]) && M.isCharacterDataNode(k) && m(k) : (a = e, d = j);
				g(this, a, d, e, j)
			},
			collapseToPoint: function(a, d) {
				F(this);
				E(a, !0);
				G(a, d); (a !== this.startContainer || d !== this.startOffset || a !== this.endContainer || d !== this.endOffset) && g(this, a, d, a, d)
			}
		});
		ea(d)
	}
	function W(a) {
		a.collapsed = a.startContainer === a.endContainer && a.startOffset === a.endOffset;
		a.commonAncestorContainer = a.collapsed ? a.startContainer: M.getCommonAncestor(a.startContainer, a.endContainer)
	}
	function ca(a, d, e, j, k) {
		var m = a.startContainer !== d || a.startOffset !== e,
		n = a.endContainer !== j || a.endOffset !== k;
		a.startContainer = d;
		a.startOffset = e;
		a.endContainer = j;
		a.endOffset = k;
		W(a);
		g(a, "boundarychange", {
			startMoved: m,
			endMoved: n
		})
	}
	function ha(a) {
		this.startContainer = a;
		this.startOffset = 0;
		this.endContainer = a;
		this.endOffset = 0;
		this._listeners = {
			boundarychange: [],
			detach: []
		};
		W(this)
	}
	a.requireModules(["DomUtil"]);
	var M = a.dom,
	ja = M.DomPosition,
	P = a.DOMException;
	B.prototype = {
		_current: null,
		_next: null,
		_first: null,
		_last: null,
		isSingleCharacterDataNode: !1,
		reset: function() {
			this._current = null;
			this._next = this._first
		},
		hasNext: function() {
			return !! this._next
		},
		next: function() {
			var a = this._current = this._next;
			a && (this._next = a !== this._last ? a.nextSibling: null, M.isCharacterDataNode(a) && this.clonePartiallySelectedTextNodes && (a === this.ec && (a = a.cloneNode(!0)).deleteData(this.eo, a.length - this.eo), this._current === this.sc && (a = a.cloneNode(!0)).deleteData(0, this.so)));
			return a
		},
		remove: function() {
			var a = this._current,
			d, e;
			M.isCharacterDataNode(a) && (a === this.sc || a === this.ec) ? (d = a === this.sc ? this.so: 0, e = a === this.ec ? this.eo: a.length, d != e && a.deleteData(d, e - d)) : a.parentNode && a.parentNode.removeChild(a)
		},
		isPartiallySelectedSubtree: function() {
			return e(this._current, this.range)
		},
		getSubtreeIterator: function() {
			var a;
			if (this.isSingleCharacterDataNode) a = this.range.cloneRange(),
			a.collapse();
			else {
				a = new ha(d(this.range));
				var e = this._current,
				g = e,
				j = 0,
				k = e,
				m = M.getNodeLength(e);
				M.isAncestorOf(e, this.sc, !0) && (g = this.sc, j = this.so);
				M.isAncestorOf(e, this.ec, !0) && (k = this.ec, m = this.eo);
				ca(a, g, j, k, m)
			}
			return new B(a, this.clonePartiallySelectedTextNodes)
		},
		detach: function(a) {
			a && this.range.detach();
			this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null
		}
	};
	z.prototype = {
		BAD_BOUNDARYPOINTS_ERR: 1,
		INVALID_NODE_TYPE_ERR: 2
	};
	z.prototype.toString = function() {
		return this.message
	};
	v.prototype = {
		_current: null,
		hasNext: function() {
			return !! this._next
		},
		next: function() {
			this._current = this._next;
			this._next = this.nodes[++this._position];
			return this._current
		},
		detach: function() {
			this._current = this._next = this.nodes = null
		}
	};
	var ua = [1, 3, 4, 5, 7, 8, 10],
	H = [2, 9, 11],
	fa = [1, 3, 4, 5, 7, 8, 10, 11],
	oa = [1, 3, 4, 5, 7, 8],
	ia = M.getRootContainer,
	ka = D([9, 11]),
	L = D([5, 6, 10, 12]),
	S = D([6, 10, 12]),
	V = document.createElement("style"),
	ba = !1;
	try {
		V.innerHTML = "\x3cb\x3ex\x3c/b\x3e",
		ba = 3 == V.firstChild.nodeType
	} catch(La) {}
	a.features.htmlParsingConforms = ba;
	var Ga = "startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),
	T = 0,
	db = 1,
	va = 2,
	za = 3,
	kb = 0,
	X = 1,
	Q = 2,
	ma = 3;
	ra.prototype = {
		attachListener: function(a, d) {
			this._listeners[a].push(d)
		},
		compareBoundaryPoints: function(a, d) {
			O(this);
			K(this.startContainer, d.startContainer);
			var e = a == za || a == T ? "start": "end",
			g = a == db || a == T ? "start": "end";
			return M.comparePoints(this[e + "Container"], this[e + "Offset"], d[g + "Container"], d[g + "Offset"])
		},
		insertNode: function(a) {
			O(this);
			I(a, fa);
			J(this.startContainer);
			if (M.isAncestorOf(a, this.startContainer, !0)) throw new P("HIERARCHY_REQUEST_ERR");
			this.setStartBefore(l(a, this.startContainer, this.startOffset))
		},
		cloneContents: function() {
			O(this);
			var a, e;
			if (this.collapsed) return d(this).createDocumentFragment();
			if (this.startContainer === this.endContainer && M.isCharacterDataNode(this.startContainer)) return a = this.startContainer.cloneNode(!0),
			a.data = a.data.slice(this.startOffset, this.endOffset),
			e = d(this).createDocumentFragment(),
			e.appendChild(a),
			e;
			e = new B(this, !0);
			a = m(e);
			e.detach();
			return a
		},
		canSurroundContents: function() {
			O(this);
			J(this.startContainer);
			J(this.endContainer);
			var a = new B(this, !0),
			d = a._first && e(a._first, this) || a._last && e(a._last, this);
			a.detach();
			return ! d
		},
		surroundContents: function(a) {
			I(a, oa);
			if (!this.canSurroundContents()) throw new z("BAD_BOUNDARYPOINTS_ERR");
			var d = this.extractContents();
			if (a.hasChildNodes()) for (; a.lastChild;) a.removeChild(a.lastChild);
			l(a, this.startContainer, this.startOffset);
			a.appendChild(d);
			this.selectNode(a)
		},
		cloneRange: function() {
			O(this);
			for (var a = new ha(d(this)), e = Ga.length, g; e--;) g = Ga[e],
			a[g] = this[g];
			return a
		},
		toString: function() {
			O(this);
			var a = this.startContainer;
			if (a === this.endContainer && M.isCharacterDataNode(a)) return 3 == a.nodeType || 4 == a.nodeType ? a.data.slice(this.startOffset, this.endOffset) : "";
			var d = [],
			a = new B(this, !0);
			n(a,
			function(a) { (3 == a.nodeType || 4 == a.nodeType) && d.push(a.data)
			});
			a.detach();
			return d.join("")
		},
		compareNode: function(a) {
			O(this);
			var d = a.parentNode,
			e = M.getNodeIndex(a);
			if (!d) throw new P("NOT_FOUND_ERR");
			a = this.comparePoint(d, e);
			d = this.comparePoint(d, e + 1);
			return 0 > a ? 0 < d ? Q: kb: 0 < d ? X: ma
		},
		comparePoint: function(a, d) {
			O(this);
			C(a, "HIERARCHY_REQUEST_ERR");
			K(a, this.startContainer);
			return 0 > M.comparePoints(a, d, this.startContainer, this.startOffset) ? -1 : 0 < M.comparePoints(a, d, this.endContainer, this.endOffset) ? 1 : 0
		},
		createContextualFragment: ba ?
		function(a) {
			var d = this.startContainer,
			e = M.getDocument(d);
			if (!d) throw new P("INVALID_STATE_ERR");
			var g = null;
			1 == d.nodeType ? g = d: M.isCharacterDataNode(d) && (g = M.parentElement(d));
			g = null === g || "HTML" == g.nodeName && M.isHtmlNamespace(M.getDocument(g).documentElement) && M.isHtmlNamespace(g) ? e.createElement("body") : g.cloneNode(!1);
			g.innerHTML = a;
			return M.fragmentFromNodeChildren(g)
		}: function(a) {
			F(this);
			var e = d(this).createElement("body");
			e.innerHTML = a;
			return M.fragmentFromNodeChildren(e)
		},
		toHtml: function() {
			O(this);
			var a = d(this).createElement("div");
			a.appendChild(this.cloneContents());
			return a.innerHTML
		},
		intersectsNode: function(a, e) {
			O(this);
			C(a, "NOT_FOUND_ERR");
			if (M.getDocument(a) !== d(this)) return ! 1;
			var g = a.parentNode,
			j = M.getNodeIndex(a);
			C(g, "NOT_FOUND_ERR");
			var k = M.comparePoints(g, j, this.endContainer, this.endOffset),
			g = M.comparePoints(g, j + 1, this.startContainer, this.startOffset);
			return e ? 0 >= k && 0 <= g: 0 > k && 0 < g
		},
		isPointInRange: function(a, d) {
			O(this);
			C(a, "HIERARCHY_REQUEST_ERR");
			K(a, this.startContainer);
			return 0 <= M.comparePoints(a, d, this.startContainer, this.startOffset) && 0 >= M.comparePoints(a, d, this.endContainer, this.endOffset)
		},
		intersectsRange: function(a, e) {
			O(this);
			if (d(a) != d(this)) throw new P("WRONG_DOCUMENT_ERR");
			var g = M.comparePoints(this.startContainer, this.startOffset, a.endContainer, a.endOffset),
			j = M.comparePoints(this.endContainer, this.endOffset, a.startContainer, a.startOffset);
			return e ? 0 >= g && 0 <= j: 0 > g && 0 < j
		},
		intersection: function(a) {
			if (this.intersectsRange(a)) {
				var d = M.comparePoints(this.startContainer, this.startOffset, a.startContainer, a.startOffset),
				e = M.comparePoints(this.endContainer, this.endOffset, a.endContainer, a.endOffset),
				g = this.cloneRange(); - 1 == d && g.setStart(a.startContainer, a.startOffset);
				1 == e && g.setEnd(a.endContainer, a.endOffset);
				return g
			}
			return null
		},
		union: function(a) {
			if (this.intersectsRange(a, !0)) {
				var d = this.cloneRange(); - 1 == M.comparePoints(a.startContainer, a.startOffset, this.startContainer, this.startOffset) && d.setStart(a.startContainer, a.startOffset);
				1 == M.comparePoints(a.endContainer, a.endOffset, this.endContainer, this.endOffset) && d.setEnd(a.endContainer, a.endOffset);
				return d
			}
			throw new z("Ranges do not intersect");
		},
		containsNode: function(a, d) {
			return d ? this.intersectsNode(a, !1) : this.compareNode(a) == ma
		},
		containsNodeContents: function(a) {
			return 0 <= this.comparePoint(a, 0) && 0 >= this.comparePoint(a, M.getNodeLength(a))
		},
		containsRange: function(a) {
			return this.intersection(a).equals(a)
		},
		containsNodeText: function(a) {
			var d = this.cloneRange();
			d.selectNode(a);
			var e = d.getNodes([3]);
			return 0 < e.length ? (d.setStart(e[0], 0), a = e.pop(), d.setEnd(a, a.length), a = this.containsRange(d), d.detach(), a) : this.containsNodeContents(a)
		},
		createNodeIterator: function(a, d) {
			O(this);
			return new v(this, a, d)
		},
		getNodes: function(a, d) {
			O(this);
			return u(this, a, d)
		},
		getDocument: function() {
			return d(this)
		},
		collapseBefore: function(a) {
			F(this);
			this.setEndBefore(a);
			this.collapse(!1)
		},
		collapseAfter: function(a) {
			F(this);
			this.setStartAfter(a);
			this.collapse(!0)
		},
		getName: function() {
			return "DomRange"
		},
		equals: function(a) {
			return ha.rangesEqual(this, a)
		},
		isValid: function() {
			return N(this)
		},
		inspect: function() {
			return s(this)
		}
	};
	Y(ha, ca,
	function(a) {
		F(a);
		a.startContainer = a.startOffset = a.endContainer = a.endOffset = null;
		a.collapsed = a.commonAncestorContainer = null;
		g(a, "detach", null);
		a._listeners = null
	});
	a.rangePrototype = ra.prototype;
	ha.rangeProperties = Ga;
	ha.RangeIterator = B;
	ha.copyComparisonConstants = ea;
	ha.createPrototypeRange = Y;
	ha.inspect = s;
	ha.getRangeDocument = d;
	ha.rangesEqual = function(a, d) {
		return a.startContainer === d.startContainer && a.startOffset === d.startOffset && a.endContainer === d.endContainer && a.endOffset === d.endOffset
	};
	a.DomRange = ha;
	a.RangeException = z
});
rangy.createModule("WrappedRange",
function(a) {
	function e(a, d, e, g) {
		var m = a.duplicate();
		m.collapse(e);
		var n = m.parentElement();
		j.isAncestorOf(d, n, !0) || (n = d);
		if (!n.canHaveHTML) return new k(n.parentNode, j.getNodeIndex(n));
		d = j.getDocument(n).createElement("span");
		var l, o = e ? "StartToStart": "StartToEnd";
		do n.insertBefore(d, d.previousSibling),
		m.moveToElementText(d);
		while (0 < (l = m.compareEndPoints(o, a)) && d.previousSibling);
		o = d.nextSibling;
		if ( - 1 == l && o && j.isCharacterDataNode(o)) {
			m.setEndPoint(e ? "EndToStart": "EndToEnd", a);
			if (/[\r\n]/.test(o.data)) {
				n = m.duplicate();
				e = n.text.replace(/\r\n/g, "\r").length;
				for (e = n.moveStart("character", e); - 1 == n.compareEndPoints("StartToEnd", n);) e++,
				n.moveStart("character", 1)
			} else e = m.text.length;
			n = new k(o, e)
		} else o = (g || !e) && d.previousSibling,
		n = (e = (g || e) && d.nextSibling) && j.isCharacterDataNode(e) ? new k(e, 0) : o && j.isCharacterDataNode(o) ? new k(o, o.length) : new k(n, j.getNodeIndex(d));
		d.parentNode.removeChild(d);
		return n
	}
	function d(a, d) {
		var e, g, k = a.offset,
		m = j.getDocument(a.node),
		n = m.body.createTextRange(),
		l = j.isCharacterDataNode(a.node);
		l ? (e = a.node, g = e.parentNode) : (e = a.node.childNodes, e = k < e.length ? e[k] : null, g = a.node);
		m = m.createElement("span");
		m.innerHTML = "\x26#feff;";
		e ? g.insertBefore(m, e) : g.appendChild(m);
		n.moveToElementText(m);
		n.collapse(!d);
		g.removeChild(m);
		if (l) n[d ? "moveStart": "moveEnd"]("character", k);
		return n
	}
	a.requireModules(["DomUtil", "DomRange"]);
	var g, j = a.dom,
	k = j.DomPosition,
	l = a.DomRange;
	if (a.features.implementsDomRange && (!a.features.implementsTextRange || !a.config.preferTextRange)) {
		var m = function(a) {
			for (var d = o.length,
			e; d--;) e = o[d],
			a[e] = a.nativeRange[e]
		},
		n,
		o = l.rangeProperties,
		r,
		u;
		g = function(a) {
			if (!a) throw Error("Range must be specified");
			this.nativeRange = a;
			m(this)
		};
		l.createPrototypeRange(g,
		function(a, d, e, g, j) {
			var k = a.endContainer !== g || a.endOffset != j;
			if (a.startContainer !== d || a.startOffset != e || k) a.setEnd(g, j),
			a.setStart(d, e)
		},
		function(a) {
			a.nativeRange.detach();
			a.detached = !0;
			for (var d = o.length,
			e; d--;) e = o[d],
			a[e] = null
		});
		n = g.prototype;
		n.selectNode = function(a) {
			this.nativeRange.selectNode(a);
			m(this)
		};
		n.deleteContents = function() {
			this.nativeRange.deleteContents();
			m(this)
		};
		n.extractContents = function() {
			var a = this.nativeRange.extractContents();
			m(this);
			return a
		};
		n.cloneContents = function() {
			return this.nativeRange.cloneContents()
		};
		n.surroundContents = function(a) {
			this.nativeRange.surroundContents(a);
			m(this)
		};
		n.collapse = function(a) {
			this.nativeRange.collapse(a);
			m(this)
		};
		n.cloneRange = function() {
			return new g(this.nativeRange.cloneRange())
		};
		n.refresh = function() {
			m(this)
		};
		n.toString = function() {
			return this.nativeRange.toString()
		};
		var s = document.createTextNode("test");
		j.getBody(document).appendChild(s);
		var B = document.createRange();
		B.setStart(s, 0);
		B.setEnd(s, 0);
		try {
			B.setStart(s, 1),
			r = !0,
			n.setStart = function(a, d) {
				this.nativeRange.setStart(a, d);
				m(this)
			},
			n.setEnd = function(a, d) {
				this.nativeRange.setEnd(a, d);
				m(this)
			},
			u = function(a) {
				return function(d) {
					this.nativeRange[a](d);
					m(this)
				}
			}
		} catch(z) {
			r = !1,
			n.setStart = function(a, d) {
				try {
					this.nativeRange.setStart(a, d)
				} catch(e) {
					this.nativeRange.setEnd(a, d),
					this.nativeRange.setStart(a, d)
				}
				m(this)
			},
			n.setEnd = function(a, d) {
				try {
					this.nativeRange.setEnd(a, d)
				} catch(e) {
					this.nativeRange.setStart(a, d),
					this.nativeRange.setEnd(a, d)
				}
				m(this)
			},
			u = function(a, d) {
				return function(e) {
					try {
						this.nativeRange[a](e)
					} catch(g) {
						this.nativeRange[d](e),
						this.nativeRange[a](e)
					}
					m(this)
				}
			}
		}
		n.setStartBefore = u("setStartBefore", "setEndBefore");
		n.setStartAfter = u("setStartAfter", "setEndAfter");
		n.setEndBefore = u("setEndBefore", "setStartBefore");
		n.setEndAfter = u("setEndAfter", "setStartAfter");
		B.selectNodeContents(s);
		n.selectNodeContents = B.startContainer == s && B.endContainer == s && 0 == B.startOffset && B.endOffset == s.length ?
		function(a) {
			this.nativeRange.selectNodeContents(a);
			m(this)
		}: function(a) {
			this.setStart(a, 0);
			this.setEnd(a, l.getEndOffset(a))
		};
		B.selectNodeContents(s);
		B.setEnd(s, 3);
		r = document.createRange();
		r.selectNodeContents(s);
		r.setEnd(s, 4);
		r.setStart(s, 2);
		n.compareBoundaryPoints = -1 == B.compareBoundaryPoints(B.START_TO_END, r) & 1 == B.compareBoundaryPoints(B.END_TO_START, r) ?
		function(a, d) {
			d = d.nativeRange || d;
			a == d.START_TO_END ? a = d.END_TO_START: a == d.END_TO_START && (a = d.START_TO_END);
			return this.nativeRange.compareBoundaryPoints(a, d)
		}: function(a, d) {
			return this.nativeRange.compareBoundaryPoints(a, d.nativeRange || d)
		};
		a.util.isHostMethod(B, "createContextualFragment") && (n.createContextualFragment = function(a) {
			return this.nativeRange.createContextualFragment(a)
		});
		j.getBody(document).removeChild(s);
		B.detach();
		r.detach();
		a.createNativeRange = function(a) {
			a = a || document;
			return a.createRange()
		}
	} else a.features.implementsTextRange && (g = function(a) {
		this.textRange = a;
		this.refresh()
	},
	g.prototype = new l(document), g.prototype.refresh = function() {
		var a, d, g = this.textRange;
		a = g.parentElement();
		var k = g.duplicate();
		k.collapse(!0);
		d = k.parentElement();
		k = g.duplicate();
		k.collapse(!1);
		g = k.parentElement();
		d = d == g ? d: j.getCommonAncestor(d, g);
		d = d == a ? d: j.getCommonAncestor(a, d);
		0 == this.textRange.compareEndPoints("StartToEnd", this.textRange) ? d = a = e(this.textRange, d, !0, !0) : (a = e(this.textRange, d, !0, !1), d = e(this.textRange, d, !1, !1));
		this.setStart(a.node, a.offset);
		this.setEnd(d.node, d.offset)
	},
	l.copyComparisonConstants(g), n = function() {
		return this
	} (), "undefined" == typeof n.Range && (n.Range = g), a.createNativeRange = function(a) {
		a = a || document;
		return a.body.createTextRange()
	});
	a.features.implementsTextRange && (g.rangeToTextRange = function(a) {
		if (a.collapsed) return d(new k(a.startContainer, a.startOffset), !0);
		var e = d(new k(a.startContainer, a.startOffset), !0),
		g = d(new k(a.endContainer, a.endOffset), !1);
		a = j.getDocument(a.startContainer).body.createTextRange();
		a.setEndPoint("StartToStart", e);
		a.setEndPoint("EndToEnd", g);
		return a
	});
	g.prototype.getName = function() {
		return "WrappedRange"
	};
	a.WrappedRange = g;
	a.createRange = function(d) {
		d = d || document;
		return new g(a.createNativeRange(d))
	};
	a.createRangyRange = function(a) {
		a = a || document;
		return new l(a)
	};
	a.createIframeRange = function(d) {
		return a.createRange(j.getIframeDocument(d))
	};
	a.createIframeRangyRange = function(d) {
		return a.createRangyRange(j.getIframeDocument(d))
	};
	a.addCreateMissingNativeApiListener(function(d) {
		d = d.document;
		"undefined" == typeof d.createRange && (d.createRange = function() {
			return a.createRange(this)
		});
		d = d = null
	})
});
rangy.createModule("WrappedSelection",
function(a, e) {
	function d(a) {
		return (a || window).getSelection()
	}
	function g(a) {
		return (a || window).document.selection
	}
	function j(a, d, e) {
		var g = e ? "end": "start";
		e = e ? "start": "end";
		a.anchorNode = d[g + "Container"];
		a.anchorOffset = d[g + "Offset"];
		a.focusNode = d[e + "Container"];
		a.focusOffset = d[e + "Offset"]
	}
	function k(a) {
		a.anchorNode = a.focusNode = null;
		a.anchorOffset = a.focusOffset = 0;
		a.rangeCount = 0;
		a.isCollapsed = !0;
		a._ranges.length = 0
	}
	function l(d) {
		var e;
		d instanceof E ? (e = d._selectionNativeRange, e || (e = a.createNativeRange(v.getDocument(d.startContainer)), e.setEnd(d.endContainer, d.endOffset), e.setStart(d.startContainer, d.startOffset), d._selectionNativeRange = e, d.attachListener("detach",
		function() {
			this._selectionNativeRange = null
		}))) : d instanceof F ? e = d.nativeRange: a.features.implementsDomRange && d instanceof v.getWindow(d.startContainer).Range && (e = d);
		return e
	}
	function m(a) {
		var d = a.getNodes(),
		e;
		a: if (!d.length || 1 != d[0].nodeType) e = !1;
		else {
			e = 1;
			for (var g = d.length; e < g; ++e) if (!v.isAncestorOf(d[0], d[e])) {
				e = !1;
				break a
			}
			e = !0
		}
		if (!e) throw Error("getSingleElementFromRange: range " + a.inspect() + " did not consist of a single element");
		return d[0]
	}
	function n(a, d) {
		var e = new F(d);
		a._ranges = [e];
		j(a, e, !1);
		a.rangeCount = 1;
		a.isCollapsed = e.collapsed
	}
	function o(d) {
		d._ranges.length = 0;
		if ("None" == d.docSelection.type) k(d);
		else {
			var e = d.docSelection.createRange();
			if (e && "undefined" != typeof e.text) n(d, e);
			else {
				d.rangeCount = e.length;
				for (var g, m = v.getDocument(e.item(0)), l = 0; l < d.rangeCount; ++l) g = a.createRange(m),
				g.selectNode(e.item(l)),
				d._ranges.push(g);
				d.isCollapsed = 1 == d.rangeCount && d._ranges[0].collapsed;
				j(d, d._ranges[d.rangeCount - 1], !1)
			}
		}
	}
	function r(a, d) {
		for (var e = a.docSelection.createRange(), g = m(d), j = v.getDocument(e.item(0)), j = v.getBody(j).createControlRange(), k = 0, n = e.length; k < n; ++k) j.add(e.item(k));
		try {
			j.add(g)
		} catch(l) {
			throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
		}
		j.select();
		o(a)
	}
	function u(a, d, e) {
		this.nativeSelection = a;
		this.docSelection = d;
		this._ranges = [];
		this.win = e;
		this.refresh()
	}
	function s(a, d) {
		for (var e = v.getDocument(d[0].startContainer), e = v.getBody(e).createControlRange(), g = 0, j; g < rangeCount; ++g) {
			j = m(d[g]);
			try {
				e.add(j)
			} catch(k) {
				throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");
			}
		}
		e.select();
		o(a)
	}
	function B(a, d) {
		if (a.anchorNode && v.getDocument(a.anchorNode) !== v.getDocument(d)) throw new I("WRONG_DOCUMENT_ERR");
	}
	function z(a) {
		var d = [],
		e = new G(a.anchorNode, a.anchorOffset),
		g = new G(a.focusNode, a.focusOffset),
		j = "function" == typeof a.getName ? a.getName() : "Selection";
		if ("undefined" != typeof a.rangeCount) for (var k = 0,
		m = a.rangeCount; k < m; ++k) d[k] = E.inspect(a.getRangeAt(k));
		return "[" + j + "(Ranges: " + d.join(", ") + ")(anchor: " + e.inspect() + ", focus: " + g.inspect() + "]"
	}
	a.requireModules(["DomUtil", "DomRange", "WrappedRange"]);
	a.config.checkSelectionRanges = !0;
	var v = a.dom,
	D = a.util,
	E = a.DomRange,
	F = a.WrappedRange,
	I = a.DOMException,
	G = v.DomPosition,
	K, J, C = a.util.isHostMethod(window, "getSelection"),
	N = a.util.isHostObject(document, "selection"),
	O = N && (!C || a.config.preferTextRange);
	O ? (K = g, a.isSelectionValid = function(a) {
		a = (a || window).document;
		var d = a.selection;
		return "None" != d.type || v.getDocument(d.createRange().parentElement()) == a
	}) : C ? (K = d, a.isSelectionValid = function() {
		return ! 0
	}) : e.fail("Neither document.selection or window.getSelection() detected.");
	a.getNativeSelection = K;
	var C = K(),
	ra = a.createNativeRange(document),
	R = v.getBody(document),
	ea = D.areHostObjects(C, D.areHostProperties(C, ["anchorOffset", "focusOffset"]));
	a.features.selectionHasAnchorAndFocus = ea;
	var Z = D.isHostMethod(C, "extend");
	a.features.selectionHasExtend = Z;
	var Y = "number" == typeof C.rangeCount;
	a.features.selectionHasRangeCount = Y;
	var W = !1,
	ca = !0;
	if (D.areHostMethods(C, ["addRange", "getRangeAt", "removeAllRanges"]) && "number" == typeof C.rangeCount && a.features.implementsDomRange) {
		var ha = document.createElement("iframe");
		ha.frameBorder = 0;
		ha.style.position = "absolute";
		ha.style.left = "-10000px";
		R.appendChild(ha);
		var M = v.getIframeDocument(ha);
		M.open();
		M.write("\x3chtml\x3e\x3chead\x3e\x3c/head\x3e\x3cbody\x3e12\x3c/body\x3e\x3c/html\x3e");
		M.close();
		var ja = v.getIframeWindow(ha).getSelection(),
		P = M.documentElement.lastChild.firstChild,
		M = M.createRange();
		M.setStart(P, 1);
		M.collapse(!0);
		ja.addRange(M);
		ca = 1 == ja.rangeCount;
		ja.removeAllRanges();
		var ua = M.cloneRange();
		M.setStart(P, 0);
		ua.setEnd(P, 2);
		ja.addRange(M);
		ja.addRange(ua);
		W = 2 == ja.rangeCount;
		M.detach();
		ua.detach();
		R.removeChild(ha)
	}
	a.features.selectionSupportsMultipleRanges = W;
	a.features.collapsedNonEditableSelectionsSupported = ca;
	var H = !1;
	R && D.isHostMethod(R, "createControlRange") && (R = R.createControlRange(), D.areHostProperties(R, ["item", "add"]) && (H = !0));
	a.features.implementsControlRange = H;
	J = ea ?
	function(a) {
		return a.anchorNode === a.focusNode && a.anchorOffset === a.focusOffset
	}: function(a) {
		return a.rangeCount ? a.getRangeAt(a.rangeCount - 1).collapsed: !1
	};
	var fa;
	D.isHostMethod(C, "getRangeAt") ? fa = function(a, d) {
		try {
			return a.getRangeAt(d)
		} catch(e) {
			return null
		}
	}: ea && (fa = function(d) {
		var e = v.getDocument(d.anchorNode),
		e = a.createRange(e);
		e.setStart(d.anchorNode, d.anchorOffset);
		e.setEnd(d.focusNode, d.focusOffset);
		e.collapsed !== this.isCollapsed && (e.setStart(d.focusNode, d.focusOffset), e.setEnd(d.anchorNode, d.anchorOffset));
		return e
	});
	a.getSelection = function(a) {
		a = a || window;
		var d = a._rangySelection,
		e = K(a),
		j = N ? g(a) : null;
		d ? (d.nativeSelection = e, d.docSelection = j, d.refresh(a)) : (d = new u(e, j, a), a._rangySelection = d);
		return d
	};
	a.getIframeSelection = function(d) {
		return a.getSelection(v.getIframeWindow(d))
	};
	R = u.prototype;
	if (!O && ea && D.areHostMethods(C, ["removeAllRanges", "addRange"])) {
		R.removeAllRanges = function() {
			this.nativeSelection.removeAllRanges();
			k(this)
		};
		var oa = function(d, e) {
			var g = E.getRangeDocument(e),
			g = a.createRange(g);
			g.collapseToPoint(e.endContainer, e.endOffset);
			d.nativeSelection.addRange(l(g));
			d.nativeSelection.extend(e.startContainer, e.startOffset);
			d.refresh()
		};
		R.addRange = Y ?
		function(d, e) {
			if (H && N && "Control" == this.docSelection.type) r(this, d);
			else if (e && Z) oa(this, d);
			else {
				var g;
				W ? g = this.rangeCount: (this.removeAllRanges(), g = 0);
				this.nativeSelection.addRange(l(d));
				this.rangeCount = this.nativeSelection.rangeCount;
				if (this.rangeCount == g + 1) {
					if (a.config.checkSelectionRanges && (g = fa(this.nativeSelection, this.rangeCount - 1)) && !E.rangesEqual(g, d)) d = new F(g);
					this._ranges[this.rangeCount - 1] = d;
					j(this, d, L(this.nativeSelection));
					this.isCollapsed = J(this)
				} else this.refresh()
			}
		}: function(a, d) {
			d && Z ? oa(this, a) : (this.nativeSelection.addRange(l(a)), this.refresh())
		};
		R.setRanges = function(a) {
			if (H && 1 < a.length) s(this, a);
			else {
				this.removeAllRanges();
				for (var d = 0,
				e = a.length; d < e; ++d) this.addRange(a[d])
			}
		}
	} else if (D.isHostMethod(C, "empty") && D.isHostMethod(ra, "select") && H && O) R.removeAllRanges = function() {
		try {
			if (this.docSelection.empty(), "None" != this.docSelection.type) {
				var a;
				if (this.anchorNode) a = v.getDocument(this.anchorNode);
				else if ("Control" == this.docSelection.type) {
					var d = this.docSelection.createRange();
					d.length && (a = v.getDocument(d.item(0)).body.createTextRange())
				}
				a && (a.body.createTextRange().select(), this.docSelection.empty())
			}
		} catch(e) {}
		k(this)
	},
	R.addRange = function(a) {
		"Control" == this.docSelection.type ? r(this, a) : (F.rangeToTextRange(a).select(), this._ranges[0] = a, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, j(this, a, !1))
	},
	R.setRanges = function(a) {
		this.removeAllRanges();
		var d = a.length;
		1 < d ? s(this, a) : d && this.addRange(a[0])
	};
	else return e.fail("No means of selecting a Range or TextRange was found"),
	!1;
	R.getRangeAt = function(a) {
		if (0 > a || a >= this.rangeCount) throw new I("INDEX_SIZE_ERR");
		return this._ranges[a]
	};
	var ia;
	if (O) ia = function(d) {
		var e;
		a.isSelectionValid(d.win) ? e = d.docSelection.createRange() : (e = v.getBody(d.win.document).createTextRange(), e.collapse(!0));
		"Control" == d.docSelection.type ? o(d) : e && "undefined" != typeof e.text ? n(d, e) : k(d)
	};
	else if (D.isHostMethod(C, "getRangeAt") && "number" == typeof C.rangeCount) ia = function(d) {
		if (H && N && "Control" == d.docSelection.type) o(d);
		else if (d._ranges.length = d.rangeCount = d.nativeSelection.rangeCount, d.rangeCount) {
			for (var e = 0,
			g = d.rangeCount; e < g; ++e) d._ranges[e] = new a.WrappedRange(d.nativeSelection.getRangeAt(e));
			j(d, d._ranges[d.rangeCount - 1], L(d.nativeSelection));
			d.isCollapsed = J(d)
		} else k(d)
	};
	else if (ea && "boolean" == typeof C.isCollapsed && "boolean" == typeof ra.collapsed && a.features.implementsDomRange) ia = function(a) {
		var d;
		d = a.nativeSelection;
		d.anchorNode ? (d = fa(d, 0), a._ranges = [d], a.rangeCount = 1, d = a.nativeSelection, a.anchorNode = d.anchorNode, a.anchorOffset = d.anchorOffset, a.focusNode = d.focusNode, a.focusOffset = d.focusOffset, a.isCollapsed = J(a)) : k(a)
	};
	else return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),
	!1;
	R.refresh = function(a) {
		var d = a ? this._ranges.slice(0) : null;
		ia(this);
		if (a) {
			a = d.length;
			if (a != this._ranges.length) return ! 1;
			for (; a--;) if (!E.rangesEqual(d[a], this._ranges[a])) return ! 1;
			return ! 0
		}
	};
	var ka = function(a, d) {
		var e = a.getAllRanges(),
		g = !1;
		a.removeAllRanges();
		for (var j = 0,
		m = e.length; j < m; ++j) g || d !== e[j] ? a.addRange(e[j]) : g = !0;
		a.rangeCount || k(a)
	};
	R.removeRange = H ?
	function(a) {
		if ("Control" == this.docSelection.type) {
			var d = this.docSelection.createRange();
			a = m(a);
			for (var e = v.getDocument(d.item(0)), e = v.getBody(e).createControlRange(), g, j = !1, k = 0, n = d.length; k < n; ++k) g = d.item(k),
			g !== a || j ? e.add(d.item(k)) : j = !0;
			e.select();
			o(this)
		} else ka(this, a)
	}: function(a) {
		ka(this, a)
	};
	var L; ! O && ea && a.features.implementsDomRange ? (L = function(a) {
		var d = !1;
		a.anchorNode && (d = 1 == v.comparePoints(a.anchorNode, a.anchorOffset, a.focusNode, a.focusOffset));
		return d
	},
	R.isBackwards = function() {
		return L(this)
	}) : L = R.isBackwards = function() {
		return ! 1
	};
	R.toString = function() {
		for (var a = [], d = 0, e = this.rangeCount; d < e; ++d) a[d] = "" + this._ranges[d];
		return a.join("")
	};
	R.collapse = function(d, e) {
		B(this, d);
		var g = a.createRange(v.getDocument(d));
		g.collapseToPoint(d, e);
		this.removeAllRanges();
		this.addRange(g);
		this.isCollapsed = !0
	};
	R.collapseToStart = function() {
		if (this.rangeCount) {
			var a = this._ranges[0];
			this.collapse(a.startContainer, a.startOffset)
		} else throw new I("INVALID_STATE_ERR");
	};
	R.collapseToEnd = function() {
		if (this.rangeCount) {
			var a = this._ranges[this.rangeCount - 1];
			this.collapse(a.endContainer, a.endOffset)
		} else throw new I("INVALID_STATE_ERR");
	};
	R.selectAllChildren = function(d) {
		B(this, d);
		var e = a.createRange(v.getDocument(d));
		e.selectNodeContents(d);
		this.removeAllRanges();
		this.addRange(e)
	};
	R.deleteFromDocument = function() {
		if (H && N && "Control" == this.docSelection.type) {
			for (var a = this.docSelection.createRange(), d; a.length;) d = a.item(0),
			a.remove(d),
			d.parentNode.removeChild(d);
			this.refresh()
		} else if (this.rangeCount) {
			a = this.getAllRanges();
			this.removeAllRanges();
			d = 0;
			for (var e = a.length; d < e; ++d) a[d].deleteContents();
			this.addRange(a[e - 1])
		}
	};
	R.getAllRanges = function() {
		return this._ranges.slice(0)
	};
	R.setSingleRange = function(a) {
		this.setRanges([a])
	};
	R.containsNode = function(a, d) {
		for (var e = 0,
		g = this._ranges.length; e < g; ++e) if (this._ranges[e].containsNode(a, d)) return ! 0;
		return ! 1
	};
	R.toHtml = function() {
		var a = "";
		if (this.rangeCount) {
			for (var a = E.getRangeDocument(this._ranges[0]).createElement("div"), d = 0, e = this._ranges.length; d < e; ++d) a.appendChild(this._ranges[d].cloneContents());
			a = a.innerHTML
		}
		return a
	};
	R.getName = function() {
		return "WrappedSelection"
	};
	R.inspect = function() {
		return z(this)
	};
	R.detach = function() {
		this.win = this.anchorNode = this.focusNode = this.win._rangySelection = null
	};
	u.inspect = z;
	a.Selection = u;
	a.selectionPrototype = R;
	a.addCreateMissingNativeApiListener(function(d) {
		"undefined" == typeof d.getSelection && (d.getSelection = function() {
			return a.getSelection(this)
		});
		d = null
	})
});
rangy.createModule("CssClassApplier",
function(a, e) {
	function d(a, d) {
		return a.className && RegExp("(?:^|\\s)" + d + "(?:\\s|$)").test(a.className)
	}
	function g(a, e) {
		a.className ? d(a, e) || (a.className += " " + e) : a.className = e
	}
	function j(a) {
		return a.split(/\s+/).sort().join(" ")
	}
	function k(a, d) {
		return j(a.className) == j(d.className)
	}
	function l(a) {
		for (var d = a.parentNode; a.hasChildNodes();) d.insertBefore(a.firstChild, a);
		d.removeChild(a)
	}
	function m(a, d) {
		var e = a.cloneRange();
		e.selectNodeContents(d);
		var g = e.intersection(a),
		g = g ? g.toString() : "";
		e.detach();
		return "" != g
	}
	function n(a) {
		return a.getNodes([3],
		function(d) {
			return m(a, d)
		})
	}
	function o(a, d) {
		if (a.attributes.length != d.attributes.length) return ! 1;
		for (var e = 0,
		g = a.attributes.length,
		j, k; e < g; ++e) if (j = a.attributes[e], k = j.name, "class" != k && (k = d.attributes.getNamedItem(k), j.specified != k.specified || j.specified && j.nodeValue !== k.nodeValue)) return ! 1;
		return ! 0
	}
	function r(a, d) {
		for (var e = 0,
		g = a.attributes.length,
		j; e < g; ++e) if (j = a.attributes[e].name, (!d || !I.arrayContains(d, j)) && a.attributes[e].specified && "class" != j) return ! 0;
		return ! 1
	}
	function u(a) {
		var d;
		return a && 1 == a.nodeType && ((d = a.parentNode) && 9 == d.nodeType && "on" == d.designMode || C(a) && !C(a.parentNode))
	}
	function s(a) {
		return (C(a) || 1 != a.nodeType && C(a.parentNode)) && !u(a)
	}
	function B(a) {
		return a && 1 == a.nodeType && !N.test(J(a, "display"))
	}
	function z(a) {
		if (0 == a.data.length) return ! 0;
		if (O.test(a.data)) return ! 1;
		switch (J(a.parentNode, "whiteSpace")) {
		case "pre":
		case "pre-wrap":
		case "-moz-pre-wrap":
			return ! 1;
		case "pre-line":
			if (/[\r\n]/.test(a.data)) return ! 1
		}
		return B(a.previousSibling) || B(a.nextSibling)
	}
	function v(a, d, g, j) {
		var k, m = 0 == g;
		if (I.isAncestorOf(d, a)) return a;
		if (I.isCharacterDataNode(d)) if (0 == g) g = I.getNodeIndex(d),
		d = d.parentNode;
		else if (g == d.length) g = I.getNodeIndex(d) + 1,
		d = d.parentNode;
		else throw e.createError("splitNodeAt should not be called with offset in the middle of a data node (" + g + " in " + d.data);
		var n;
		n = d;
		var l = g;
		if (n = I.isCharacterDataNode(n) ? 0 == l ? !!n.previousSibling: l == n.length ? !!n.nextSibling: !0 : 0 < l && l < n.childNodes.length) {
			if (!k) {
				k = d.cloneNode(!1);
				for (k.id && k.removeAttribute("id"); m = d.childNodes[g];) k.appendChild(m);
				I.insertAfter(k, d)
			}
			return d == a ? k: v(a, k.parentNode, I.getNodeIndex(k), j)
		}
		return a != d ? (k = d.parentNode, d = I.getNodeIndex(d), m || d++, v(a, k, d, j)) : a
	}
	function D(a) {
		var d = a ? "nextSibling": "previousSibling";
		return function(e, g) {
			var j = e.parentNode,
			m = e[d];
			if (m) {
				if (m && 3 == m.nodeType) return m
			} else if (g && (m = j[d]) && 1 == m.nodeType && j.tagName == m.tagName && k(j, m) && o(j, m)) return m[a ? "firstChild": "lastChild"];
			return null
		}
	}
	function E(a) {
		this.firstTextNode = (this.isElementMerge = 1 == a.nodeType) ? a.lastChild: a;
		this.textNodes = [this.firstTextNode]
	}
	function F(a, d, e) {
		this.cssClass = a;
		var g, k, m = null;
		if ("object" == typeof d && null !== d) {
			e = d.tagNames;
			m = d.elementProperties;
			for (g = 0; k = ea[g++];) d.hasOwnProperty(k) && (this[k] = d[k]);
			g = d.normalize
		} else g = d;
		this.normalize = "undefined" == typeof g ? !0 : g;
		this.attrExceptions = [];
		g = document.createElement(this.elementTagName);
		this.elementProperties = {};
		for (var n in m) m.hasOwnProperty(n) && (Z.hasOwnProperty(n) && (n = Z[n]), g[n] = m[n], this.elementProperties[n] = g[n], this.attrExceptions.push(n));
		this.elementSortedClassName = this.elementProperties.hasOwnProperty("className") ? j(this.elementProperties.className + " " + a) : a;
		this.applyToAnyTagName = !1;
		a = typeof e;
		if ("string" == a)"*" == e ? this.applyToAnyTagName = !0 : this.tagNames = e.toLowerCase().replace(/^\s\s*/, "").replace(/\s\s*$/, "").split(/\s*,\s*/);
		else if ("object" == a && "number" == typeof e.length) {
			this.tagNames = [];
			g = 0;
			for (a = e.length; g < a; ++g)"*" == e[g] ? this.applyToAnyTagName = !0 : this.tagNames.push(e[g].toLowerCase())
		} else this.tagNames = [this.elementTagName]
	}
	a.requireModules(["WrappedSelection", "WrappedRange"]);
	var I = a.dom,
	G, K = function(a, d, e) {
		return d && e ? " ": ""
	};
	G = function(a, d) {
		a.className && (a.className = a.className.replace(RegExp("(?:^|\\s)" + d + "(?:\\s|$)"), K))
	};
	var J;
	"undefined" != typeof window.getComputedStyle ? J = function(a, d) {
		return I.getWindow(a).getComputedStyle(a, null)[d]
	}: "undefined" != typeof document.documentElement.currentStyle ? J = function(a, d) {
		return a.currentStyle[d]
	}: e.fail("No means of obtaining computed style properties found");
	var C;
	C = "boolean" == typeof document.createElement("div").isContentEditable ?
	function(a) {
		return a && 1 == a.nodeType && a.isContentEditable
	}: function(a) {
		return ! a || 1 != a.nodeType || "false" == a.contentEditable ? !1 : "true" == a.contentEditable || C(a.parentNode)
	};
	var N = /^inline(-block|-table)?$/i,
	O = /[^\r\n\t\f \u200B]/,
	ra = D(!1),
	R = D(!0);
	E.prototype = {
		doMerge: function() {
			for (var a = [], d, e, g = 0, j = this.textNodes.length; g < j; ++g) d = this.textNodes[g],
			e = d.parentNode,
			a[g] = d.data,
			g && (e.removeChild(d), e.hasChildNodes() || e.parentNode.removeChild(e));
			return this.firstTextNode.data = a.join("")
		},
		getLength: function() {
			for (var a = this.textNodes.length,
			d = 0; a--;) d += this.textNodes[a].length;
			return d
		},
		toString: function() {
			for (var a = [], d = 0, e = this.textNodes.length; d < e; ++d) a[d] = "'" + this.textNodes[d].data + "'";
			return "[Merge(" + a.join(",") + ")]"
		}
	};
	var ea = ["elementTagName", "ignoreWhiteSpace", "applyToEditableOnly"],
	Z = {
		"class": "className"
	};
	F.prototype = {
		elementTagName: "span",
		elementProperties: {},
		ignoreWhiteSpace: !0,
		applyToEditableOnly: !1,
		hasClass: function(a) {
			return 1 == a.nodeType && I.arrayContains(this.tagNames, a.tagName.toLowerCase()) && d(a, this.cssClass)
		},
		getSelfOrAncestorWithClass: function(a) {
			for (; a;) {
				if (this.hasClass(a, this.cssClass)) return a;
				a = a.parentNode
			}
			return null
		},
		isModifiable: function(a) {
			return ! this.applyToEditableOnly || s(a)
		},
		isIgnorableWhiteSpaceNode: function(a) {
			return this.ignoreWhiteSpace && a && 3 == a.nodeType && z(a)
		},
		postApply: function(a, d, e) {
			for (var g = a[0], j = a[a.length - 1], k = [], m, n = g, l = j, o = 0, r = j.length, s, u, B = 0, v = a.length; B < v; ++B) s = a[B],
			(u = ra(s, !e)) ? (m || (m = new E(u), k.push(m)), m.textNodes.push(s), s === g && (n = m.firstTextNode, o = n.length), s === j && (l = m.firstTextNode, r = m.getLength())) : m = null;
			if (a = R(j, !e)) m || (m = new E(j), k.push(m)),
			m.textNodes.push(a);
			if (k.length) {
				B = 0;
				for (v = k.length; B < v; ++B) k[B].doMerge();
				d.setStart(n, o);
				d.setEnd(l, r)
			}
		},
		createContainer: function(d) {
			d = d.createElement(this.elementTagName);
			a.util.extend(d, this.elementProperties);
			g(d, this.cssClass);
			return d
		},
		applyToTextNode: function(a) {
			var d = a.parentNode;
			1 == d.childNodes.length && I.arrayContains(this.tagNames, d.tagName.toLowerCase()) ? g(d, this.cssClass) : (d = this.createContainer(I.getDocument(a)), a.parentNode.insertBefore(d, a), d.appendChild(a))
		},
		isRemovable: function(a) {
			var d;
			if (d = a.tagName.toLowerCase() == this.elementTagName) if (d = j(a.className) == this.elementSortedClassName) {
				var e;
				a: {
					d = this.elementProperties;
					for (e in d) if (d.hasOwnProperty(e) && a[e] !== d[e]) {
						e = !1;
						break a
					}
					e = !0
				}
				d = e && !r(a, this.attrExceptions) && this.isModifiable(a)
			}
			return d
		},
		undoToTextNode: function(a, d, e) {
			d.containsNode(e) || (a = d.cloneRange(), a.selectNode(e), a.isPointInRange(d.endContainer, d.endOffset) && (v(e, d.endContainer, d.endOffset, [d]), d.setEndAfter(e)), a.isPointInRange(d.startContainer, d.startOffset) && (e = v(e, d.startContainer, d.startOffset, [d])));
			this.isRemovable(e) ? l(e) : G(e, this.cssClass)
		},
		applyToRange: function(a) {
			a.splitBoundaries();
			var d = n(a);
			if (d.length) {
				for (var e, g = 0,
				j = d.length; g < j; ++g) e = d[g],
				!this.isIgnorableWhiteSpaceNode(e) && !this.getSelfOrAncestorWithClass(e) && this.isModifiable(e) && this.applyToTextNode(e);
				a.setStart(d[0], 0);
				e = d[d.length - 1];
				a.setEnd(e, e.length);
				this.normalize && this.postApply(d, a, !1)
			}
		},
		applyToSelection: function(d) {
			d = d || window;
			d = a.getSelection(d);
			var e, g = d.getAllRanges();
			d.removeAllRanges();
			for (var j = g.length; j--;) e = g[j],
			this.applyToRange(e),
			d.addRange(e)
		},
		undoToRange: function(a) {
			a.splitBoundaries();
			var d = n(a),
			e,
			g,
			j = d[d.length - 1];
			if (d.length) {
				for (var k = 0,
				m = d.length; k < m; ++k) e = d[k],
				(g = this.getSelfOrAncestorWithClass(e)) && this.isModifiable(e) && this.undoToTextNode(e, a, g),
				a.setStart(d[0], 0),
				a.setEnd(j, j.length);
				this.normalize && this.postApply(d, a, !0)
			}
		},
		undoToSelection: function(d) {
			d = d || window;
			d = a.getSelection(d);
			var e = d.getAllRanges(),
			g;
			d.removeAllRanges();
			for (var j = 0,
			k = e.length; j < k; ++j) g = e[j],
			this.undoToRange(g),
			d.addRange(g)
		},
		getTextSelectedByRange: function(a, d) {
			var e = d.cloneRange();
			e.selectNodeContents(a);
			var g = e.intersection(d),
			g = g ? g.toString() : "";
			e.detach();
			return g
		},
		isAppliedToRange: function(a) {
			if (a.collapsed) return !! this.getSelfOrAncestorWithClass(a.commonAncestorContainer);
			for (var d = a.getNodes([3]), e = 0, g; g = d[e++];) if (!this.isIgnorableWhiteSpaceNode(g) && m(a, g) && this.isModifiable(g) && !this.getSelfOrAncestorWithClass(g)) return ! 1;
			return ! 0
		},
		isAppliedToSelection: function(d) {
			d = d || window;
			d = a.getSelection(d).getAllRanges();
			for (var e = d.length; e--;) if (!this.isAppliedToRange(d[e])) return ! 1;
			return ! 0
		},
		toggleRange: function(a) {
			this.isAppliedToRange(a) ? this.undoToRange(a) : this.applyToRange(a)
		},
		toggleSelection: function(a) {
			this.isAppliedToSelection(a) ? this.undoToSelection(a) : this.applyToSelection(a)
		},
		detach: function() {}
	};
	F.util = {
		hasClass: d,
		addClass: g,
		removeClass: G,
		hasSameClasses: k,
		replaceWithOwnChildren: l,
		elementsHaveSameNonClassAttributes: o,
		elementHasNonClassAttributes: r,
		splitNodeAt: v,
		isEditableElement: C,
		isEditingHost: u,
		isEditable: s
	};
	a.CssClassApplier = F;
	a.createCssClassApplier = function(a, d, e) {
		return new F(a, d, e)
	}
});
rangy.createModule("SaveRestore",
function(a, e) {
	function d(a, d) {
		var e = "selectionBoundary_" + +new Date + "_" + ("" + Math.random()).slice(2),
		g,
		j = l.getDocument(a.startContainer),
		k = a.cloneRange();
		k.collapse(d);
		g = j.createElement("span");
		g.id = e;
		g.style.lineHeight = "0";
		g.style.display = "none";
		g.className = "rangySelectionBoundary";
		g.appendChild(j.createTextNode(m));
		k.insertNode(g);
		k.detach();
		return g
	}
	function g(a, d, g, j) { (a = (a || document).getElementById(g)) ? (d[j ? "setStartBefore": "setEndBefore"](a), a.parentNode.removeChild(a)) : e.warn("Marker element has been removed. Cannot restore selection.")
	}
	function j(a, d) {
		return d.compareBoundaryPoints(a.START_TO_START, a)
	}
	function k(a, d) {
		var e = (a || document).getElementById(d);
		e && e.parentNode.removeChild(e)
	}
	a.requireModules(["DomUtil", "DomRange", "WrappedRange"]);
	var l = a.dom,
	m = "\ufeff";
	a.saveSelection = function(g) {
		g = g || window;
		var k = g.document;
		if (a.isSelectionValid(g)) {
			var m = a.getSelection(g),
			l = m.getAllRanges(),
			s = [],
			B,
			z;
			l.sort(j);
			for (var v = 0,
			D = l.length; v < D; ++v) B = l[v],
			B.collapsed ? (z = d(B, !1), s.push({
				markerId: z.id,
				collapsed: !0
			})) : (z = d(B, !1), B = d(B, !0), s[v] = {
				startMarkerId: B.id,
				endMarkerId: z.id,
				collapsed: !1,
				backwards: 1 == l.length && m.isBackwards()
			});
			for (v = D - 1; 0 <= v; --v) B = l[v],
			B.collapsed ? B.collapseBefore((k || document).getElementById(s[v].markerId)) : (B.setEndBefore((k || document).getElementById(s[v].endMarkerId)), B.setStartAfter((k || document).getElementById(s[v].startMarkerId)));
			m.setRanges(l);
			return {
				win: g,
				doc: k,
				rangeInfos: s,
				restored: !1
			}
		}
		e.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.")
	};
	a.restoreSelection = function(d, j) {
		if (!d.restored) {
			for (var k = d.rangeInfos,
			m = a.getSelection(d.win), l = [], B = k.length, z = B - 1, v, D; 0 <= z; --z) {
				v = k[z];
				D = a.createRange(d.doc);
				if (v.collapsed) if (v = (d.doc || document).getElementById(v.markerId)) {
					v.style.display = "inline";
					var E = v.previousSibling;
					E && 3 == E.nodeType ? (v.parentNode.removeChild(v), D.collapseToPoint(E, E.length)) : (D.collapseBefore(v), v.parentNode.removeChild(v))
				} else e.warn("Marker element has been removed. Cannot restore selection.");
				else g(d.doc, D, v.startMarkerId, !0),
				g(d.doc, D, v.endMarkerId, !1);
				1 == B && D.normalizeBoundaries();
				l[z] = D
			}
			1 == B && j && a.features.selectionHasExtend && k[0].backwards ? (m.removeAllRanges(), m.addRange(l[0], !0)) : m.setRanges(l);
			d.restored = !0
		}
	};
	a.removeMarkerElement = k;
	a.removeMarkers = function(a) {
		for (var d = a.rangeInfos,
		e = 0,
		g = d.length,
		j; e < g; ++e) j = d[e],
		j.collapsed ? k(a.doc, j.markerId) : (k(a.doc, j.startMarkerId), k(a.doc, j.endMarkerId))
	}
}); (function(a) {
	function e(a, d) {
		var e = typeof a[d];
		return "function" === e || !("object" != e || !a[d]) || "unknown" == e
	}
	function d(a, d, e) {
		return 0 > d && (d += a.value.length),
		typeof e == B && (e = d),
		0 > e && (e += a.value.length),
		{
			start: d,
			end: e
		}
	}
	function g() {
		return "object" == typeof document.body && document.body ? document.body: document.getElementsByTagName("body")[0]
	}
	var j, k, l, m, n, o, r, u, s, B = "undefined";
	a(document).ready(function() {
		function z(a, d) {
			return function() {
				var e = this.jquery ? this[0] : this,
				g = e.nodeName.toLowerCase();
				if (1 == e.nodeType && ("textarea" == g || "input" == g && "text" == e.type)) if (e = [e].concat(Array.prototype.slice.call(arguments)), e = a.apply(this, e), !d) return e;
				return d ? this: void 0
			}
		}
		var v = document.createElement("textarea");
		if (g().appendChild(v), typeof v.selectionStart != B && typeof v.selectionEnd != B) j = function(a) {
			var d = a.selectionStart,
			e = a.selectionEnd;
			return {
				start: d,
				end: e,
				length: e - d,
				text: a.value.slice(d, e)
			}
		},
		k = function(a, e, g) {
			e = d(a, e, g);
			a.selectionStart = e.start;
			a.selectionEnd = e.end
		},
		s = function(a, d) {
			d ? a.selectionEnd = a.selectionStart: a.selectionStart = a.selectionEnd
		};
		else {
			if (!e(v, "createTextRange") || !("object" == typeof document.selection && document.selection) || !e(document.selection, "createRange")) {
				g().removeChild(v);
				window.console && window.console.log && window.console.log("RangyInputs not supported in your browser. Reason: No means of finding text input caret position");
				return
			}
			j = function(a) {
				var d, e, g, j, k = 0,
				m = 0,
				n = document.selection.createRange();
				return n && n.parentElement() == a && (g = a.value.length, d = a.value.replace(/\r\n/g, "\n"), e = a.createTextRange(), e.moveToBookmark(n.getBookmark()), j = a.createTextRange(), j.collapse(!1), -1 < e.compareEndPoints("StartToEnd", j) ? k = m = g: (k = -e.moveStart("character", -g), k += d.slice(0, k).split("\n").length - 1, -1 < e.compareEndPoints("EndToEnd", j) ? m = g: (m = -e.moveEnd("character", -g), m += d.slice(0, m).split("\n").length - 1))),
				{
					start: k,
					end: m,
					length: m - k,
					text: a.value.slice(k, m)
				}
			};
			k = function(a, e, g) {
				e = d(a, e, g);
				g = a.createTextRange();
				var j = e.start - (a.value.slice(0, e.start).split("\r\n").length - 1);
				g.collapse(!0);
				e.start == e.end ? g.move("character", j) : (g.moveEnd("character", e.end - (a.value.slice(0, e.end).split("\r\n").length - 1)), g.moveStart("character", j));
				g.select()
			};
			s = function(a, d) {
				var e = document.selection.createRange();
				e.collapse(d);
				e.select()
			}
		}
		g().removeChild(v);
		m = function(a, d, e, g) {
			var j;
			d != e && (j = a.value, a.value = j.slice(0, d) + j.slice(e));
			g && k(a, d, d)
		};
		l = function(a) {
			var d = j(a);
			m(a, d.start, d.end, !0)
		};
		u = function(a) {
			var d, e = j(a);
			return e.start != e.end && (d = a.value, a.value = d.slice(0, e.start) + d.slice(e.end)),
			k(a, e.start, e.start),
			e.text
		};
		var D = function(a, d, e, g) {
			e = d + e.length;
			switch ("string" == typeof g ? g.toLowerCase() : "") {
			case "collapsetostart":
				k(a, d, d);
				break;
			case "collapsetoend":
				k(a, e, e);
				break;
			case "select":
				k(a, d, e)
			}
		};
		n = function(a, d, e, g) {
			var j = a.value;
			a.value = j.slice(0, e) + d + j.slice(e);
			"boolean" == typeof g && (g = g ? "collapseToEnd": "");
			D(a, e, d, g)
		};
		o = function(a, d, e) {
			var g = j(a),
			k = a.value;
			a.value = k.slice(0, g.start) + d + k.slice(g.end);
			D(a, g.start, d, e || "collapseToEnd")
		};
		r = function(a, d, e, g) {
			typeof e == B && (e = d);
			var k = j(a),
			m = a.value;
			a.value = m.slice(0, k.start) + d + k.text + e + m.slice(k.end);
			D(a, k.start + d.length, k.text, g || "select")
		};
		a.fn.extend({
			getSelection: z(j, !1),
			setSelection: z(k, !0),
			collapseSelection: z(s, !0),
			deleteSelectedText: z(l, !0),
			deleteText: z(m, !0),
			extractSelectedText: z(u, !1),
			insertText: z(n, !0),
			replaceSelectedText: z(o, !0),
			surroundSelectedText: z(r, !0)
		})
	})
})(jQuery); (function(a, e, d) {
	var g = function(a) {
		var g = {
			text: "",
			start: 0,
			end: 0
		};
		if (!a.value) return g;
		try {
			if (e.getSelection) g.start = a.selectionStart,
			g.end = a.selectionEnd,
			g.text = a.value.slice(g.start, g.end);
			else if (d.selection) {
				a.focus();
				var j = d.selection.createRange(),
				n = d.body.createTextRange();
				g.text = j.text;
				try {
					n.moveToElementText(a),
					n.setEndPoint("StartToStart", j)
				} catch(o) {
					n = a.createTextRange(),
					n.setEndPoint("StartToStart", j)
				}
				g.start = a.value.length - n.text.length;
				g.end = g.start + j.text.length
			}
		} catch(r) {}
		return g
	},
	j = {
		getPos: function(a) {
			a = g(a);
			return {
				start: a.start,
				end: a.end
			}
		},
		setPos: function(a, d, g) {
			g = this._caretMode(g);
			"start" == g ? d.end = d.start: "end" == g && (d.start = d.end);
			a.focus();
			try {
				if (a.createTextRange) {
					var j = a.createTextRange();
					0 <= e.navigator.userAgent.toLowerCase().indexOf("msie") && (d.start = a.value.substr(0, d.start).replace(/\r/g, "").length, d.end = a.value.substr(0, d.end).replace(/\r/g, "").length);
					j.collapse(!0);
					j.moveStart("character", d.start);
					j.moveEnd("character", d.end - d.start);
					j.select()
				} else a.setSelectionRange && a.setSelectionRange(d.start, d.end)
			} catch(o) {}
		},
		getText: function(a) {
			return g(a).text
		},
		_caretMode: function(a) {
			a = a || "keep"; ! 1 == a && (a = "end");
			switch (a) {
			case "keep":
			case "start":
			case "end":
				break;
			default:
				a = "keep"
			}
			return a
		},
		replace: function(d, e, j) {
			var n = g(d),
			o = d.value,
			r = a(d).scrollTop(),
			u = {
				start: n.start,
				end: n.start + e.length
			};
			d.value = o.substr(0, n.start) + e + o.substr(n.end);
			a(d).scrollTop(r);
			this.setPos(d, u, j)
		},
		insertBefore: function(d, e, j) {
			var n = g(d),
			o = d.value,
			r = a(d).scrollTop(),
			u = {
				start: n.start + e.length,
				end: n.end + e.length
			};
			d.value = o.substr(0, n.start) + e + o.substr(n.start);
			a(d).scrollTop(r);
			this.setPos(d, u, j)
		},
		insertAfter: function(d, e, j) {
			var n = g(d),
			o = d.value,
			r = a(d).scrollTop(),
			u = {
				start: n.start,
				end: n.end
			};
			d.value = o.substr(0, n.end) + e + o.substr(n.end);
			a(d).scrollTop(r);
			this.setPos(d, u, j)
		}
	};
	a.extend({
		selection: function(g) {
			g = "text" == (g || "text").toLowerCase();
			try {
				if (e.getSelection) {
					if (g) return e.getSelection().toString();
					var j = e.getSelection(),
					m;
					j.getRangeAt ? m = j.getRangeAt(0) : (m = d.createRange(), m.setStart(j.anchorNode, j.anchorOffset), m.setEnd(j.focusNode, j.focusOffset));
					return a("\x3cdiv\x3e\x3c/div\x3e").append(m.cloneContents()).html()
				}
				if (d.selection) return g ? d.selection.createRange().text: d.selection.createRange().htmlText
			} catch(n) {}
			return ""
		}
	});
	a.fn.extend({
		selection: function(a, d) {
			d = d || {};
			switch (a) {
			case "getPos":
				return j.getPos(this[0]);
			case "setPos":
				return this.each(function() {
					j.setPos(this, d)
				});
			case "replace":
				return this.each(function() {
					j.replace(this, d.text, d.caret)
				});
			case "insert":
				return this.each(function() {
					"before" == d.mode ? j.insertBefore(this, d.text, d.caret) : j.insertAfter(this, d.text, d.caret)
				});
			default:
				return j.getText(this[0])
			}
		}
	})
})(jQuery, window, window.document);
jQuery(function(a, e) {
	var d = a(window),
	g = a(document),
	j = a("body"),
	k = a("base").attr("href"),
	l = {
		filters: [],
		callbacks: {},
		loadFilter: e,
		modal: !1,
		closeOnEscape: !0,
		closeOnClick: !0,
		useKeyHandler: !1,
		showCloseButton: !0,
		closeButton: '\x3ca href\x3d"#" class\x3d"nyroModalClose nyroModalCloseButton nmReposition" title\x3d""\x3eClose\x3c/a\x3e',
		stack: !1,
		nonStackable: "form",
		header: e,
		footer: e,
		galleryLoop: !0,
		galleryCounts: !0,
		ltr: !0,
		imageRegex: "[^.].(jpg|jpeg|png|tiff|gif|bmp)((s*$)|\\?.)",
		selIndicator: "nyroModalSel",
		swfObjectId: e,
		swf: {
			allowFullScreen: "true",
			allowscriptaccess: "always",
			wmode: "transparent"
		},
		store: {},
		errorMsg: "An error occured",
		elts: {
			all: e,
			bg: e,
			load: e,
			cont: e,
			hidden: e
		},
		sizes: {
			initW: e,
			initH: e,
			w: e,
			h: e,
			minW: e,
			minH: e,
			wMargin: e,
			hMargin: e
		},
		anim: {
			def: e,
			showBg: e,
			hideBg: e,
			showLoad: e,
			hideLoad: e,
			showCont: e,
			hideCont: e,
			showTrans: e,
			hideTrans: e,
			resize: e
		},
		_open: !1,
		_bgReady: !1,
		_opened: !1,
		_loading: !1,
		_animated: !1,
		_transition: !1,
		_nmOpener: e,
		_nbContentLoading: 0,
		_scripts: "",
		_scriptsShown: "",
		saveObj: function() {
			this.opener.data("nmObj", this)
		},
		open: function() {
			this._nmOpener && this._nmOpener._close();
			this.getInternal()._pushStack(this.opener);
			this._bgReady = this._opened = !1;
			this._open = !0;
			this._initElts();
			this._load();
			this._nbContentLoading = 0;
			this._callAnim("showBg", a.proxy(function() {
				this._bgReady = !0;
				this._nmOpener && (this._nmOpener._bgReady = !1, this._nmOpener._loading = !1, this._nmOpener._animated = !1, this._nmOpener._opened = !1, this._nmOpener._open = !1, this._nmOpener.elts.cont = this._nmOpener.elts.hidden = this._nmOpener.elts.load = this._nmOpener.elts.bg = this._nmOpener.elts.all = e, this._nmOpener.saveObj(), this._nmOpener = e);
				this._contentLoading()
			},
			this))
		},
		resize: function(d) {
			d ? (this.elts.hidden.append(this.elts.cont.children().first().clone()), this.sizes.initW = this.sizes.w = this.elts.hidden.width(), this.sizes.initH = this.sizes.h = this.elts.hidden.height(), this.elts.hidden.empty()) : (this.sizes.w = this.sizes.initW, this.sizes.h = this.sizes.initH);
			this._unreposition();
			this.size();
			this._callAnim("resize", a.proxy(function() {
				this._reposition()
			},
			this))
		},
		size: function() {
			var a = this.getInternal().fullSize.viewH - this.sizes.hMargin,
			d = this.getInternal().fullSize.viewW - this.sizes.wMargin;
			this.sizes.minW && this.sizes.minW > this.sizes.w && (this.sizes.w = this.sizes.minW);
			this.sizes.minH && this.sizes.minH > this.sizes.h && (this.sizes.h = this.sizes.minH);
			if (this.sizes.h > a || this.sizes.w > d) this.sizes.h = Math.min(this.sizes.h, a),
			this.sizes.w = Math.min(this.sizes.w, d);
			this._callFilters("size")
		},
		getForNewLinks: function(d) {
			this.stack && (!d || this.isStackable(d)) ? (d = a.extend(!0, {},
			this), d._nmOpener = e, d.elts.all = e) : (d = a.extend({},
			this), d._nmOpener = this);
			d.filters = [];
			d.opener = e;
			d._open = !1;
			return d
		},
		isStackable: function(a) {
			return ! a.is(this.nonStackable)
		},
		keyHandle: function(a) {
			this.keyEvent = a;
			this._callFilters("keyHandle");
			this.keyEvent = e;
			delete this.keyEvent
		},
		getInternal: function() {
			return r
		},
		_close: function() {
			this.getInternal()._removeStack(this.opener);
			this._open = this._opened = !1;
			this._callFilters("close")
		},
		close: function() {
			this._close();
			this._callFilters("beforeClose");
			var a = this;
			this._unreposition();
			a._callAnim("hideCont",
			function() {
				a._callAnim("hideLoad",
				function() {
					a._callAnim("hideBg",
					function() {
						a._callFilters("afterClose");
						a.elts.cont.remove();
						a.elts.hidden.remove();
						a.elts.load.remove();
						a.elts.bg.remove();
						a.elts.all.remove();
						a.elts.cont = a.elts.hidden = a.elts.load = a.elts.bg = a.elts.all = e
					})
				})
			})
		},
		_initElts: function() { ! this.stack && 1 < this.getInternal().stack.length && (this.elts = this.getInternal().stack[this.getInternal().stack.length - 2].nmObj.elts);
			if (!this.elts.all || 0 == this.elts.all.closest("body").length) this.elts.all = this.elts.bg = this.elts.cont = this.elts.hidden = this.elts.load = e;
			this.elts.all || (this.elts.all = a("\x3cdiv /\x3e").appendTo(this.getInternal()._container));
			this.elts.bg || (this.elts.bg = a("\x3cdiv /\x3e").hide().appendTo(this.elts.all));
			this.elts.cont || (this.elts.cont = a("\x3cdiv /\x3e").hide().appendTo(this.elts.all));
			this.elts.hidden || (this.elts.hidden = a("\x3cdiv /\x3e").hide().appendTo(this.elts.all));
			this.elts.hidden.empty();
			this.elts.load || (this.elts.load = a("\x3cdiv /\x3e").hide().appendTo(this.elts.all));
			this._callFilters("initElts")
		},
		_error: function() {
			this._callFilters("error")
		},
		_setCont: function(d, e) {
			if (e) {
				var g = [],
				j = 0;
				d = d.replace(/\r\n/gi, "nyroModalLN").replace(/<script(.|\s)*?\/script>/gi,
				function(a) {
					g[j] = a;
					return '\x3cpre class\x3dnyroModalScript rel\x3d"' + j+++'"\x3e\x3c/pre\x3e'
				});
				var k = a("\x3cdiv\x3e" + d + "\x3c/div\x3e").find(e);
				if (k.length) d = k.html().replace(/<pre class="?nyroModalScript"? rel="?(.?)"?><\/pre>/gi,
				function(a, d) {
					return g[d]
				}).replace(/nyroModalLN/gi, "\r\n");
				else {
					this._error();
					return
				}
			}
			this.elts.hidden.append(this._filterScripts(d)).prepend(this.header).append(this.footer).wrapInner('\x3cdiv class\x3d"nyroModal' + ucfirst(this.loadFilter) + '" /\x3e');
			this.sizes.initW = this.sizes.w = this.elts.hidden.width();
			this.sizes.initH = this.sizes.h = this.elts.hidden.height();
			k = this.getInternal()._getOuter(this.elts.cont);
			this.sizes.hMargin = k.h.total;
			this.sizes.wMargin = k.w.total;
			this.size();
			this.loading = !1;
			this._callFilters("filledContent");
			this._contentLoading()
		},
		_filterScripts: function(d) {
			if ("string" != typeof d) return d;
			this._scripts = [];
			this._scriptsShown = [];
			for (var e = 0,
			g, j; - 1 < (e = d.indexOf("\x3cscript", e));) {
				g = d.indexOf("\x3c/script\x3e") + 9;
				j = a(d.substring(e, g));
				if (!j.attr("src") || "forceLoad" == j.attr("rel"))"shown" == j.attr("rev") ? this._scriptsShown.push(j.get(0)) : this._scripts.push(j.get(0));
				d = d.substring(0, e) + d.substr(g)
			}
			return d
		},
		_hasFilter: function(d) {
			var e = !1;
			a.each(this.filters,
			function(a, g) {
				e = e || g == d
			});
			return e
		},
		_delFilter: function(d) {
			this.filters = a.map(this.filters,
			function(a) {
				if (a != d) return a
			})
		},
		_callFilters: function(d) {
			this.getInternal()._debug(d);
			var e = [],
			g = this;
			a.each(this.filters,
			function(a, j) {
				e[j] = g._callFilter(j, d)
			});
			if (this.callbacks[d] && a.isFunction(this.callbacks[d])) this.callbacks[d](this);
			return e
		},
		_callFilter: function(d, g) {
			return s[d] && s[d][g] && a.isFunction(s[d][g]) ? s[d][g](this) : e
		},
		_callAnim: function(d, e) {
			this.getInternal()._debug(d);
			this._callFilters("before" + ucfirst(d));
			if (!this._animated) {
				this._animated = !0;
				a.isFunction(e) || (e = a.noop);
				var g = this.anim[d] || this.anim.def || "basic";
				if (!u[g] || !u[g][d] || !a.isFunction(u[g][d])) g = "basic";
				u[g][d](this, a.proxy(function() {
					this._animated = !1;
					this._callFilters("after" + ucfirst(d));
					e()
				},
				this))
			}
		},
		_load: function() {
			this.getInternal()._debug("_load"); ! this.loading && this.loadFilter && (this.loading = !0, this._callFilter(this.loadFilter, "load"))
		},
		_contentLoading: function() {
			if (!this._animated && this._bgReady) if (!this._transition && 0 < this.elts.cont.html().length && (this._transition = !0), this._nbContentLoading++, this.loading) {
				if (1 == this._nbContentLoading) {
					var d = this.getInternal()._getOuter(this.elts.load);
					this.elts.load.css({
						position: "fixed",
						top: (this.getInternal().fullSize.viewH - this.elts.load.height() - d.h.margin) / 2,
						left: (this.getInternal().fullSize.viewW - this.elts.load.width() - d.w.margin) / 2
					});
					this._transition ? (this._unreposition(), this._callAnim("showTrans", a.proxy(function() {
						this._contentLoading()
					},
					this))) : this._callAnim("showLoad", a.proxy(function() {
						this._contentLoading()
					},
					this))
				}
			} else this._opened || (this._opened = !0, this._transition ? (d = a.proxy(function() {
				this._writeContent();
				this._callFilters("beforeShowCont");
				this._callAnim("hideTrans", a.proxy(function() {
					this._transition = !1;
					this._callFilters("afterShowCont");
					this.elts.cont.append(this._scriptsShown);
					this._reposition()
				},
				this))
			},
			this), 1 == this._nbContentLoading ? (this._unreposition(), this._callAnim("showTrans", d)) : d()) : this._callAnim("hideLoad", a.proxy(function() {
				this._writeContent();
				this._callAnim("showCont", a.proxy(function() {
					this.elts.cont.append(this._scriptsShown);
					this._reposition()
				},
				this))
			},
			this)))
		},
		_writeContent: function() {
			this.elts.cont.empty().append(this.elts.hidden.contents()).append(this._scripts).append(this.showCloseButton ? this.closeButton: "").css({
				position: "fixed",
				width: this.sizes.w,
				height: this.sizes.h,
				top: (this.getInternal().fullSize.viewH - this.sizes.h - this.sizes.hMargin) / 2,
				left: (this.getInternal().fullSize.viewW - this.sizes.w - this.sizes.wMargin) / 2
			})
		},
		_reposition: function() {
			var d = this.elts.cont.find(".nmReposition");
			if (d.length) {
				var e = this.getInternal()._getSpaceReposition();
				d.each(function() {
					var d = a(this),
					g = d.offset();
					d.css({
						position: "fixed",
						top: g.top - e.top,
						left: g.left - e.left
					})
				});
				this.elts.cont.after(d)
			}
			this.elts.cont.css("overflow", "auto");
			this._callFilters("afterReposition")
		},
		_unreposition: function() {
			this.elts.cont.css("overflow", "");
			var a = this.elts.all.find(".nmReposition");
			a.length && this.elts.cont.append(a.removeAttr("style"));
			this._callFilters("afterUnreposition")
		}
	},
	m;
	if (a.browser.msie) {
		var n = a('\x3ctextarea cols\x3d"10" rows\x3d"2"\x3e\x3c/textarea\x3e').css({
			position: "absolute",
			top: -1E3,
			left: -1E3
		}).appendTo(j),
		o = a('\x3ctextarea cols\x3d"10" rows\x3d"2" style\x3d"overflow: hidden;"\x3e\x3c/textarea\x3e').css({
			position: "absolute",
			top: -1E3,
			left: -1E3
		}).appendTo(j);
		m = n.width() - o.width();
		n.add(o).remove()
	} else n = a("\x3cdiv /\x3e").css({
		width: 100,
		height: 100,
		overflow: "auto",
		position: "absolute",
		top: -1E3,
		left: -1E3
	}).prependTo(j).append("\x3cdiv /\x3e").find("div").css({
		width: "100%",
		height: 200
	}),
	m = 100 - n.width(),
	n.parent().remove();
	var r = {
		firstInit: !0,
		debug: !1,
		stack: [],
		fullSize: {
			w: 0,
			h: 0,
			wW: 0,
			wH: 0,
			viewW: 0,
			viewH: 0
		},
		nyroModal: function(e, k) {
			r.firstInit && (r._container = a("\x3cdiv /\x3e").appendTo(j), d.smartresize(a.proxy(r._resize, r)), g.bind("keydown.nyroModal", a.proxy(r._keyHandler, r)), r._calculateFullSize(), r.firstInit = !1);
			return this.nmInit(e, k).each(function() {
				r._init(a(this).data("nmObj"))
			})
		},
		nmInit: function(d, e) {
			return this.each(function() {
				var g = a(this);
				e ? g.data("nmObj", a.extend(!0, {
					opener: g
				},
				d)) : g.data("nmObj", g.data("nmObj") ? a.extend(!0, g.data("nmObj"), d) : a.extend(!0, {
					opener: g
				},
				l, d))
			})
		},
		nmCall: function() {
			return this.trigger("nyroModal")
		},
		nmManual: function(d, e) {
			a('\x3ca href\x3d"' + d + '"\x3e\x3c/a\x3e').nyroModal(e).trigger("nyroModal")
		},
		nmData: function(d, e) {
			this.nmManual("#", a.extend({
				data: d
			},
			e))
		},
		nmObj: function(d) {
			a.extend(!0, l, d)
		},
		nmInternal: function(d) {
			a.extend(!0, r, d)
		},
		nmAnims: function(d) {
			a.extend(!0, u, d)
		},
		nmFilters: function(d) {
			a.extend(!0, s, d)
		},
		nmTop: function() {
			return r.stack.length ? r.stack[r.stack.length - 1].nmObj: e
		},
		_debug: function(a) {
			this.debug && (window.console && window.console.log) && window.console.log(a)
		},
		_container: e,
		_init: function(d) {
			d.filters = [];
			a.each(s,
			function(e, g) {
				g.is && (a.isFunction(g.is) && g.is(d)) && d.filters.push(e)
			});
			d._callFilters("initFilters");
			d._callFilters("init");
			d.opener.unbind("nyroModal.nyroModal nmClose.nyroModal nmResize.nyroModal").bind({
				"nyroModal.nyroModal": function() {
					d.open();
					return ! 1
				},
				"nmClose.nyroModal": function() {
					d.close();
					return ! 1
				},
				"nmResize.nyroModal": function() {
					d.resize();
					return ! 1
				}
			})
		},
		_scrollWidth: m,
		_selNyroModal: function(d) {
			return a(d).data("nmObj") ? !0 : !1
		},
		_selNyroModalOpen: function(d) {
			d = a(d);
			return d.data("nmObj") ? d.data("nmObj")._open: !1
		},
		_keyHandler: function(d) {
			var e = a.nmTop();
			if (e && e.useKeyHandler) return e.keyHandle(d)
		},
		_pushStack: function(d) {
			this.stack = a.map(this.stack,
			function(a) {
				if (a.nmOpener != d.get(0)) return a
			});
			this.stack.push({
				nmOpener: d.get(0),
				nmObj: a(d).data("nmObj")
			})
		},
		_removeStack: function(d) {
			this.stack = a.map(this.stack,
			function(a) {
				if (a.nmOpener != d.get(0)) return a
			})
		},
		_resize: function() {
			var d = a(":nmOpen").each(function() {
				a(this).data("nmObj")._unreposition()
			});
			this._calculateFullSize();
			d.trigger("nmResize")
		},
		_calculateFullSize: function() {
			this.fullSize = {
				w: g.width(),
				h: g.height(),
				wW: d.width(),
				wH: d.height()
			};
			this.fullSize.viewW = Math.min(this.fullSize.w, this.fullSize.wW);
			this.fullSize.viewH = Math.min(this.fullSize.h, this.fullSize.wH)
		},
		_getCurCSS: function(d, e) {
			var g = parseInt(a.css(d, e, !0));
			return isNaN(g) ? 0 : g
		},
		_getOuter: function(a) {
			a = a.get(0);
			a = {
				h: {
					margin: this._getCurCSS(a, "marginTop") + this._getCurCSS(a, "marginBottom"),
					border: this._getCurCSS(a, "borderTopWidth") + this._getCurCSS(a, "borderBottomWidth"),
					padding: this._getCurCSS(a, "paddingTop") + this._getCurCSS(a, "paddingBottom")
				},
				w: {
					margin: this._getCurCSS(a, "marginLeft") + this._getCurCSS(a, "marginRight"),
					border: this._getCurCSS(a, "borderLeftWidth") + this._getCurCSS(a, "borderRightWidth"),
					padding: this._getCurCSS(a, "paddingLeft") + this._getCurCSS(a, "paddingRight")
				}
			};
			a.h.outer = a.h.margin + a.h.border;
			a.w.outer = a.w.margin + a.w.border;
			a.h.inner = a.h.padding + a.h.border;
			a.w.inner = a.w.padding + a.w.border;
			a.h.total = a.h.outer + a.h.padding;
			a.w.total = a.w.outer + a.w.padding;
			return a
		},
		_getSpaceReposition: function() {
			var e = this._getOuter(j),
			g = a.browser.msie && 8 > a.browser.version && !(screen.height <= d.height() + 23);
			return {
				top: d.scrollTop() - (!g ? e.h.border / 2 : 0),
				left: d.scrollLeft() - (!g ? e.w.border / 2 : 0)
			}
		},
		_getHash: function(a) {
			if ("string" == typeof a) {
				var d = a.indexOf("#");
				if ( - 1 < d) return a.substring(d)
			}
			return ""
		},
		_extractUrl: function(a) {
			var d = {
				url: e,
				sel: e
			};
			if (a) {
				var g = this._getHash(a),
				j = this._getHash(window.location.href),
				j = window.location.href.substring(0, window.location.href.length - j.length);
				a = a.substring(0, a.length - g.length);
				d.sel = g;
				a != j && a != k && (d.url = a)
			}
			return d
		}
	},
	u = {
		basic: {
			showBg: function(a, d) {
				a.elts.bg.css({
					opacity: 0.8
				}).show();
				d()
			},
			hideBg: function(a, d) {
				a.elts.bg.hide();
				d()
			},
			showLoad: function(a, d) {
				a.elts.load.show();
				d()
			},
			hideLoad: function(a, d) {
				a.elts.load.hide();
				d()
			},
			showCont: function(a, d) {
				a.elts.cont.show();
				d()
			},
			hideCont: function(a, d) {
				a.elts.cont.hide();
				d()
			},
			showTrans: function(a, d) {
				a.elts.cont.hide();
				a.elts.load.show();
				d()
			},
			hideTrans: function(a, d) {
				a.elts.cont.show();
				a.elts.load.hide();
				d()
			},
			resize: function(a, d) {
				a.elts.cont.css({
					width: a.sizes.w,
					height: a.sizes.h,
					top: (a.getInternal().fullSize.viewH - a.sizes.h - a.sizes.hMargin) / 2,
					left: (a.getInternal().fullSize.viewW - a.sizes.w - a.sizes.wMargin) / 2
				});
				d()
			}
		}
	},
	s = {
		basic: {
			is: function() {
				return ! 0
			},
			init: function(a) {
				"modal" == a.opener.attr("rev") && (a.modal = !0);
				a.modal && (a.closeOnEscape = a.closeOnClick = a.showCloseButton = !1);
				a.closeOnEscape && (a.useKeyHandler = !0)
			},
			initElts: function(a) {
				a.elts.bg.addClass("nyroModalBg");
				a.closeOnClick && a.elts.bg.unbind("click.nyroModal").bind("click.nyroModal",
				function(d) {
					d.preventDefault();
					a.close()
				});
				a.elts.cont.addClass("nyroModalCont");
				a.elts.hidden.addClass("nyroModalCont nyroModalHidden");
				a.elts.load.addClass("nyroModalCont nyroModalLoad")
			},
			error: function(a) {
				a.elts.hidden.addClass("nyroModalError");
				a.elts.cont.addClass("nyroModalError");
				a._setCont(a.errorMsg)
			},
			beforeShowCont: function(d) {
				d.elts.cont.find(".nyroModal").each(function() {
					var e = a(this);
					e.nyroModal(d.getForNewLinks(e), !0)
				}).end().find(".nyroModalClose").bind("click.nyroModal",
				function(a) {
					a.preventDefault();
					d.close()
				})
			},
			keyHandle: function(a) {
				27 == a.keyEvent.keyCode && a.closeOnEscape && (a.keyEvent.preventDefault(), a.close())
			}
		},
		custom: {
			is: function() {
				return ! 0
			}
		}
	};
	a.fn.extend({
		nm: r.nyroModal,
		nyroModal: r.nyroModal,
		nmInit: r.nmInit,
		nmCall: r.nmCall
	});
	a.extend({
		nmManual: r.nmManual,
		nmData: r.nmData,
		nmObj: r.nmObj,
		nmInternal: r.nmInternal,
		nmAnims: r.nmAnims,
		nmFilters: r.nmFilters,
		nmTop: r.nmTop
	});
	a.expr[":"].nyroModal = a.expr[":"].nm = r._selNyroModal;
	a.expr[":"].nmOpen = r._selNyroModalOpen
}); (function(a, e) {
	var d = function(a, d, e) {
		var l;
		return function() {
			var m = this,
			n = arguments;
			l ? clearTimeout(l) : e && a.apply(m, n);
			l = setTimeout(function() {
				e || a.apply(m, n);
				l = null
			},
			d || 100)
		}
	};
	jQuery.fn[e] = function(a) {
		return a ? this.bind("resize", d(a)) : this.trigger(e)
	}
})(jQuery, "smartresize");
function ucfirst(a) {
	a += "";
	return a.charAt(0).toUpperCase() + a.substr(1)
}
jQuery(function(a) {
	a.nmAnims({
		fade: {
			showBg: function(a, d) {
				a.elts.bg.fadeTo(250, 0.8, d)
			},
			hideBg: function(a, d) {
				a.elts.bg.fadeOut(d)
			},
			showLoad: function(a, d) {
				a.elts.load.fadeIn(d)
			},
			hideLoad: function(a, d) {
				a.elts.load.fadeOut(d)
			},
			showCont: function(a, d) {
				a.elts.cont.fadeIn(d)
			},
			hideCont: function(a, d) {
				a.elts.cont.css("overflow", "hidden").fadeOut(d)
			},
			showTrans: function(a, d) {
				a.elts.load.css({
					position: a.elts.cont.css("position"),
					top: a.elts.cont.css("top"),
					left: a.elts.cont.css("left"),
					width: a.elts.cont.css("width"),
					height: a.elts.cont.css("height"),
					marginTop: a.elts.cont.css("marginTop"),
					marginLeft: a.elts.cont.css("marginLeft")
				}).fadeIn(function() {
					a.elts.cont.hide();
					d()
				})
			},
			hideTrans: function(a, d) {
				a.elts.cont.css("visibility", "hidden").show();
				a.elts.load.css("position", a.elts.cont.css("position")).animate({
					top: a.elts.cont.css("top"),
					left: a.elts.cont.css("left"),
					width: a.elts.cont.css("width"),
					height: a.elts.cont.css("height"),
					marginTop: a.elts.cont.css("marginTop"),
					marginLeft: a.elts.cont.css("marginLeft")
				},
				function() {
					a.elts.cont.css("visibility", "");
					a.elts.load.fadeOut(d)
				})
			},
			resize: function(a, d) {
				a.elts.cont.animate({
					width: a.sizes.w,
					height: a.sizes.h,
					top: (a.getInternal().fullSize.viewH - a.sizes.h - a.sizes.hMargin) / 2,
					left: (a.getInternal().fullSize.viewW - a.sizes.w - a.sizes.wMargin) / 2
				},
				d)
			}
		}
	});
	a.nmObj({
		anim: {
			def: "fade"
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		title: {
			is: function(a) {
				return a.opener.is("[title]")
			},
			beforeShowCont: function(d) {
				d.elts.cont.offset();
				d.store.title = a("\x3ch1 /\x3e", {
					text: d.opener.attr("title")
				}).addClass("nyroModalTitle nmReposition");
				d.elts.cont.prepend(d.store.title)
			},
			close: function(a) {
				a.store.title && (a.store.title.remove(), a.store.title = e, delete a.store.title)
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		gallery: {
			is: function(d) {
				var e = d.opener.is("[rel]:not([rel\x3dexternal], [rel\x3dnofollow])");
				if (e) {
					var j = d.opener.attr("rel"),
					k = j.indexOf(" "),
					j = 0 < k ? j.substr(0, k) : j;
					2 > a('[href][rel\x3d"' + j + '"], [href][rel^\x3d"' + j + ' "]').length && (e = !1);
					e && (d.galleryCounts && !d._hasFilter("title")) && d.filters.push("title")
				}
				return e
			},
			init: function(a) {
				a.useKeyHandler = !0
			},
			keyHandle: function(a) {
				if (!a._animated && a._opened) if (39 == a.keyEvent.keyCode || 40 == a.keyEvent.keyCode) a.keyEvent.preventDefault(),
				a._callFilters("galleryNext");
				else if (37 == a.keyEvent.keyCode || 38 == a.keyEvent.keyCode) a.keyEvent.preventDefault(),
				a._callFilters("galleryPrev")
			},
			initElts: function(d) {
				var e = d.opener.attr("rel"),
				j = e.indexOf(" ");
				d.store.gallery = 0 < j ? e.substr(0, j) : e;
				d.store.galleryLinks = a('[href][rel\x3d"' + d.store.gallery + '"], [href][rel^\x3d"' + d.store.gallery + ' "]');
				d.store.galleryIndex = d.store.galleryLinks.index(d.opener)
			},
			beforeShowCont: function(a) {
				if (a.galleryCounts && a.store.title && a.store.galleryLinks && 1 < a.store.galleryLinks.length) {
					var e = a.store.title.html();
					a.store.title.html((e.length ? e + " - ": "") + (a.store.galleryIndex + 1) + "/" + a.store.galleryLinks.length)
				}
			},
			filledContent: function(d) {
				var e = this._getGalleryLink(d, -1),
				j = d.elts.hidden.find(" \x3e div");
				e && a("\x3ca /\x3e", {
					text: "previous",
					href: "#"
				}).addClass("nyroModalPrev").bind("click",
				function(a) {
					a.preventDefault();
					d._callFilters("galleryPrev")
				}).appendTo(j); (e = this._getGalleryLink(d, 1)) && a("\x3ca /\x3e", {
					text: "next",
					href: "#"
				}).addClass("nyroModalNext").bind("click",
				function(a) {
					a.preventDefault();
					d._callFilters("galleryNext")
				}).appendTo(j)
			},
			close: function(a) {
				a.store.gallery = e;
				a.store.galleryLinks = e;
				a.store.galleryIndex = e;
				delete a.store.gallery;
				delete a.store.galleryLinks;
				delete a.store.galleryIndex;
				a.elts.cont && a.elts.cont.find(".nyroModalNext, .nyroModalPrev").remove()
			},
			galleryNext: function(a) {
				this._getGalleryLink(a, 1).nyroModal(a.getForNewLinks(), !0).click()
			},
			galleryPrev: function(a) {
				this._getGalleryLink(a, -1).nyroModal(a.getForNewLinks(), !0).click()
			},
			_getGalleryLink: function(a, g) {
				if (a.store.gallery) {
					a.ltr || (g *= -1);
					var j = a.store.galleryIndex + g;
					if (a.store.galleryLinks && 0 <= j && j < a.store.galleryLinks.length) return a.store.galleryLinks.eq(j);
					if (a.galleryLoop && a.store.galleryLinks) return a.store.galleryLinks.eq(0 > j ? a.store.galleryLinks.length - 1 : 0)
				}
				return e
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		link: {
			is: function(a) {
				var e = a.opener.is("[href]");
				e && (a.store.link = a.getInternal()._extractUrl(a.opener.attr("href")));
				return e
			},
			init: function(a) {
				a.loadFilter = "link";
				a.opener.unbind("click.nyroModal").bind("click.nyroModal",
				function(e) {
					e.preventDefault();
					a.opener.trigger("nyroModal")
				})
			},
			load: function(d) {
				a.ajax({
					url: d.store.link.url,
					data: d.store.link.sel ? [{
						name: d.selIndicator,
						value: d.store.link.sel.substring(1)
					}] : e,
					success: function(a) {
						d._setCont(a, d.store.link.sel)
					},
					error: function() {
						d._error()
					}
				})
			}
		}
	})
});
jQuery(function(a) {
	a.nmFilters({
		dom: {
			is: function(a) {
				return a._hasFilter("link") && !a.store.link.url && a.store.link.sel
			},
			init: function(a) {
				a.loadFilter = "dom"
			},
			load: function(e) {
				e.store.domEl = a(e.store.link.sel);
				e.store.domEl.length ? e._setCont(e.store.domEl.contents()) : e._error()
			},
			close: function(a) {
				a.store.domEl && a.elts.cont && a.store.domEl.append(a.elts.cont.find(".nyroModalDom").contents())
			}
		}
	})
});
jQuery(function(a) {
	a.nmFilters({
		data: {
			is: function(a) {
				var d = a.data ? !0 : !1;
				d && a._delFilter("dom");
				return d
			},
			init: function(a) {
				a.loadFilter = "data"
			},
			load: function(a) {
				a._setCont(a.data)
			}
		}
	})
});
jQuery(function(a) {
	a.nmFilters({
		image: {
			is: function(a) {
				return RegExp(a.imageRegex, "i").test(a.opener.attr("href"))
			},
			init: function(a) {
				a.loadFilter = "image"
			},
			load: function(e) {
				var d = e.opener.attr("href");
				a("\x3cimg /\x3e").load(function() {
					e.elts.cont.addClass("nyroModalImg");
					e.elts.hidden.addClass("nyroModalImg");
					e._setCont(this)
				}).error(function() {
					e._error()
				}).attr("src", d)
			},
			size: function(a) {
				if (a.sizes.w != a.sizes.initW || a.sizes.h != a.sizes.initH) {
					var d = Math.min(a.sizes.w / a.sizes.initW, a.sizes.h / a.sizes.initH);
					a.sizes.w = a.sizes.initW * d;
					a.sizes.h = a.sizes.initH * d
				} (a.loading ? a.elts.hidden.find("img") : a.elts.cont.find("img")).attr({
					width: a.sizes.w,
					height: a.sizes.h
				})
			},
			close: function(a) {
				a.elts.cont && (a.elts.cont.removeClass("nyroModalImg"), a.elts.hidden.removeClass("nyroModalImg"))
			}
		}
	})
});
jQuery(function(a) {
	a.nmFilters({
		swf: {
			idCounter: 1,
			is: function(a) {
				return a._hasFilter("link") && a.opener.is('[href$\x3d".swf"]')
			},
			init: function(a) {
				a.loadFilter = "swf"
			},
			load: function(e) {
				e.swfObjectId || (e.swfObjectId = "nyroModalSwf-" + this.idCounter++);
				var d = e.store.link.url,
				g = '\x3cdiv\x3e\x3cobject classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id\x3d"' + e.swfObjectId + '" width\x3d"' + e.sizes.w + '" height\x3d"' + e.sizes.h + '"\x3e\x3cparam name\x3d"movie" value\x3d"' + d + '"\x3e\x3c/param\x3e',
				j = "";
				a.each(e.swf,
				function(a, d) {
					g += '\x3cparam name\x3d"' + a + '" value\x3d"' + d + '"\x3e\x3c/param\x3e';
					j += " " + a + '\x3d"' + d + '"'
				});
				g += '\x3cembed src\x3d"' + d + '" type\x3d"application/x-shockwave-flash" width\x3d"' + e.sizes.w + '" height\x3d"' + e.sizes.h + '"' + j + "\x3e\x3c/embed\x3e\x3c/object\x3e\x3c/div\x3e";
				e._setCont(g)
			}
		}
	})
});
jQuery(function(a) {
	a.nmFilters({
		form: {
			is: function(a) {
				var d = a.opener.is("form");
				d && (a.store.form = a.getInternal()._extractUrl(a.opener.attr("action")));
				return d
			},
			init: function(a) {
				a.loadFilter = "form";
				a.opener.unbind("submit.nyroModal").bind("submit.nyroModal",
				function(d) {
					d.preventDefault();
					a.opener.trigger("nyroModal")
				})
			},
			load: function(e) {
				var d = e.opener.serializeArray();
				e.store.form.sel && d.push({
					name: e.selIndicator,
					value: e.store.form.sel.substring(1)
				});
				a.ajax({
					url: e.store.form.url,
					data: d,
					type: e.opener.attr("method") ? e.opener.attr("method") : "get",
					success: function(a) {
						e._setCont(a, e.store.form.sel)
					},
					error: function() {
						e._error()
					}
				})
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		formFile: {
			is: function(a) {
				var e = a.opener.is('form[enctype\x3d"multipart/form-data"]');
				e && (a._delFilter("form"), a.store.form || (a.store.form = a.getInternal()._extractUrl(a.opener.attr("action"))));
				return e
			},
			init: function(a) {
				a.loadFilter = "formFile";
				a.store.formFileLoading = !1;
				a.opener.unbind("submit.nyroModal").bind("submit.nyroModal",
				function(e) {
					a.store.formFileIframe ? a.store.formFileLoading = !0 : (e.preventDefault(), a.opener.trigger("nyroModal"))
				})
			},
			initElts: function(d) {
				function g() {
					j && (j.remove(), j = e, delete j);
					d.store.formFileIframe.attr("src", "about:blank").remove();
					d.store.formFileIframe = e;
					delete d.store.formFileIframe
				}
				var j;
				d.store.form.sel && (j = a("\x3cinput /\x3e", {
					type: "hidden",
					name: d.selIndicator,
					value: d.store.form.sel.substring(1)
				}).appendTo(d.opener));
				d.store.formFileIframe = a('\x3ciframe name\x3d"nyroModalFormFile" src\x3d"javascript:\'\';" id\x3d"nyromodal-iframe-' + (new Date).getTime() + '"\x3e\x3c/iframe\x3e').hide().load(function() {
					if (d.store.formFileLoading) {
						d.store.formFileLoading = !1;
						var a = d.store.formFileIframe.unbind("load error").contents().find("body").not("script[src]");
						if (a && a.html() && a.html().length) g(),
						d._setCont(a.html(), d.store.form.sel);
						else {
							var e = 0;
							fct = function() {
								e++;
								var a = d.store.formFileIframe.unbind("load error").contents().find("body").not("script[src]");
								a && a.html() && a.html().length ? (d._setCont(a.html(), d.store.form.sel), g()) : 5 > e ? setTimeout(fct, 25) : (g(), d._error())
							};
							setTimeout(fct, 25)
						}
					}
				}).error(function() {
					g();
					d._error()
				});
				d.elts.all.append(d.store.formFileIframe);
				d.opener.attr("target", "nyroModalFormFile").submit()
			},
			close: function(a) {
				a.store.formFileLoading = !1;
				a.store.formFileIframe && (a.store.formFileIframe.remove(), a.store.formFileIframe = e, delete a.store.formFileIframe)
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		iframe: {
			is: function(a) {
				var e = a.opener.attr("target") || "",
				j = a.opener.attr("rel") || "",
				k = a.opener.get(0);
				return ! a._hasFilter("image") && ("_blank" == e.toLowerCase() || -1 < j.toLowerCase().indexOf("external") || k.hostname && k.hostname.replace(/:\d*$/, "") != window.location.hostname.replace(/:\d*$/, ""))
			},
			init: function(a) {
				a.loadFilter = "iframe"
			},
			load: function(d) {
				d.store.iframe = a('\x3ciframe src\x3d"javascript:\'\';" id\x3d"nyromodal-iframe-' + (new Date).getTime() + '" frameborder\x3d"0"\x3e\x3c/iframe\x3e');
				d._setCont(d.store.iframe)
			},
			afterShowCont: function(a) {
				a.store.iframe.attr("src", a.opener.attr("href"))
			},
			close: function(a) {
				a.store.iframe && (a.store.iframe.remove(), a.store.iframe = e, delete a.store.iframe)
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmFilters({
		iframeForm: {
			is: function(a) {
				var e = a._hasFilter("iframe") && a.opener.is("form");
				e && (a._delFilter("iframe"), a._delFilter("form"));
				return e
			},
			init: function(a) {
				a.loadFilter = "iframeForm";
				a.store.iframeFormLoading = !1;
				a.store.iframeFormOrgTarget = a.opener.attr("target");
				a.opener.unbind("submit.nyroModal").bind("submit.nyroModal",
				function(e) {
					a.store.iframeFormIframe ? a.store.iframeFormLoading = !0 : (e.preventDefault(), a.opener.trigger("nyroModal"))
				})
			},
			load: function(d) {
				d.store.iframeFormIframe = a('\x3ciframe name\x3d"nyroModalIframeForm" src\x3d"javascript:\'\';" id\x3d"nyromodal-iframe-' + (new Date).getTime() + '"\x3e\x3c/iframe\x3e');
				d._setCont(d.store.iframeFormIframe)
			},
			afterShowCont: function(a) {
				a.opener.attr("target", "nyroModalIframeForm").submit()
			},
			close: function(a) {
				a.store.iframeFormOrgTarget ? a.opener.attr("target", a.store.iframeFormOrgTarget) : a.opener.removeAttr("target");
				delete a.store.formFileLoading;
				delete a.store.iframeFormOrgTarget;
				a.store.iframeFormIframe && (a.store.iframeFormIframe.remove(), a.store.iframeFormIframe = e, delete a.store.iframeFormIframe)
			}
		}
	})
});
jQuery(function(a, e) {
	a.nmObj({
		embedlyUrl: "http://api.embed.ly/1/oembed",
		embedly: {
			key: e,
			wmode: "transparent",
			allowscripts: !0,
			format: "json"
		}
	});
	var d = [];
	a.nmFilters({
		embedly: {
			is: function(e) {
				if (e._hasFilter("link") && e._hasFilter("iframe") && e.opener.attr("href") && e.embedly.key) {
					if (d[e.opener.attr("href")]) return e.store.embedly = d[e.opener.attr("href")],
					e._delFilter("iframe"),
					!0;
					e.store.embedly = !1;
					var j = e.embedly;
					j.url = e.opener.attr("href");
					a.ajax({
						url: e.embedlyUrl,
						dataType: "jsonp",
						data: j,
						success: function(a) {
							"error" != a.type && (e.store.embedly = a, d[e.opener.attr("href")] = a, e._delFilter("iframe"), e.filters.push("embedly"), e._callFilters("initFilters"), e._callFilters("init"))
						}
					})
				}
				return ! 1
			},
			init: function(a) {
				a.loadFilter = "embedly"
			},
			load: function(d) {
				"photo" == d.store.embedly.type ? (d.filters.push("image"), a("\x3cimg /\x3e").load(function() {
					d.elts.cont.addClass("nyroModalImg");
					d.elts.hidden.addClass("nyroModalImg");
					d._setCont(this)
				}).error(function() {
					d._error()
				}).attr("src", d.store.embedly.url)) : d._setCont("\x3cdiv\x3e" + d.store.embedly.html + "\x3c/div\x3e")
			},
			size: function(a) {
				a.store.embedly.width && !a.sizes.height && (a.sizes.w = a.store.embedly.width, a.sizes.h = a.store.embedly.height)
			}
		}
	})
});
var tempCreateAccountOptions = null,
previewTimeout = null,
FW_CONSTANTS = {
	showPrompts: !0,
	promptMessageTimeout: null,
	tabReadyTimeout: null
},
tempCreateAccountOptions = null,
dmIsDudaone = window.isEditorDudaone ? !0 : !1,
previewTimeout = null;
$.extend({
	dmfw: {
		_this: {
			editables: {},
			editorArea: {}
		},
		previewArea: {},
		_init: function() {
			var a = {};
			$.dmfw.isDudaone() && (a = {
				navigation: ONENavigation,
				link: ONELink,
				paragraph: ONEParagraph,
				image: ONEImage,
				restaurantmenu: ONEMenu,
				photoGallery: ONEPhotoGallery,
				fbGallery: ONEFacebookGallery,
				header: ONEHeader,
				geolocation: ONEGeoLocation,
				form: ONEForm,
				imageSlider: ONEImageSlider
			});
			$.extend($.dmx, {});
			$.dmfw._this.editables = {};
			$.dmfw._this.editables.navigation = new NEENavigation;
			$.dmfw._this.editables.image = new NEEImage;
			$.dmfw._this.editables.paragraph = new NEEParagraph;
			$.dmfw._this.editables.clicktocall = new NEEClickToCall;
			$.dmfw._this.editables.clicktomap = new NEEClickToMap;
			$.dmfw._this.editables.clicktosms = new NEEClickToSms;
			$.dmfw._this.editables.fixedfooter = new NEEFixedFooter;
			$.dmfw._this.editables.header = new NEEHeader;
			$.dmfw._this.editables.link = new NEELink;
			$.dmfw._this.editables.youtube = new NEEYoutube;
			$.dmfw._this.editables.video = new NEEVideo;
			$.dmfw._this.editables.shareextension = new NEEShare;
			$.dmfw._this.editables.html = new NEEHtml;
			$.dmfw._this.editables.column = new NEEColumn;
			$.dmfw._this.editables.divider = new NEEDivider;
			$.dmfw._this.editables.sendbizinfo = new NEESendBizInfo;
			$.dmfw._this.editables.table = new NEETable;
			$.dmfw._this.editables.submitbutton = new NEESubmitButton;
			$.dmfw._this.editables.tabs = new NEETabs;
			$.dmfw._this.editables.emailextension = new NEEClickToEmail;
			$.dmfw._this.editables.imageSlider = new NEEImageSlider;
			$.dmfw._this.editables.photoGallery = new NEEPhotoGallery;
			$.dmfw._this.editables.fbGallery = new NEEFacebookGallery;
			$.dmfw._this.editables.list = new NEEList;
			$.dmfw._this.editables.form = new NEEForm;
			$.dmfw._this.editables.newsletter = new NEENewsletter;
			$.dmfw._this.editables.opentable = new NEEOpenTable;
			$.dmfw._this.editables.paypal = new NEEPayPal;
			$.dmfw._this.editables.googlecheckout = new NEEGoogleCheckout;
			$.dmfw._this.editables.twitterfeed = new NEETwitterFeed;
			$.dmfw._this.editables.rssfeed = new NEERSSFeed;
			$.dmfw._this.editables.restaurantmenu = new NEEMenu;
			$.dmfw._this.editables.hoursofoperation = new NEEHoursOfOperation;
			$.dmfw._this.editables.spacer = new NEESpacer;
			$.dmfw._this.editables.yelp = new NEEYelp;
			$.dmfw._this.editables.youtubefeed = new NEEYouTubeFeed;
			$.dmfw._this.editables.orphan = new NEEOrphan;
			$.dmfw._this.editables.facebook_like = new NEEFacebookLike;
			$.dmfw._this.editables.facebook_comments = new NEEFacebookComments;
			$.dmfw._this.editables.socialhub = new NEESocialHub;
			$.dmfw._this.editables.jalan_res = new NEEJalanReservation;
			$.dmfw._this.editables.jalan_gallery = new NEEJalanGallery;
			$.dmfw._this.editables.geolocation = new NEEGeoLocation;
			$.dmfw._this.editables.back_to_top = new NEEBackToTop;
			$.dmfw._this.editables.coupon = new NEECoupon;
			try {
				$.dmfw._this.editables.adsense = new NEEAdsense
			} catch(e) {
				$.log(e)
			}
			$.dmfw._this.editables.blog = new NEEBlog;
			$.dmfw.isDudaone() && ($.dmfw._this.editables.responsivecolumn = new ONEResponsiveCol, $.dmfw._this.editables.responsiverow = new ONEResponsiveRow, $.dmfw._this.editables.inlinemap = new NEEInlineMap, $.each(a,
			function(a, d) {
				$.dmfw._this.editables[a] = $.onefw.createExtendedEditable(d, $.dmfw._this.editables[a])
			}));
			$.dmfw.previewWrapper = $("#_preview_w");
			$.dmfw.previewArea = $("#_preview");
			$.dmfw._this.editorArea = $("#_editor");
			$.ptPayments.init();
			for (var d in $.dmfw._this.editables) if ($.dmfw._this.editables.hasOwnProperty(d) && (a = $.dmfw._this.editables[d]) && "function" === typeof a.bindEvents) try {
				$.dmfw._this.editables[d].bindEvents()
			} catch(g) {
				$.log(g)
			}
		},
		reload: function(a) {
			a = $.extend({
				siteAlias: $.dmx.site.alias,
				pageAlias: "home",
				tab: NEFW.NAV.maintabs("current"),
				url: ""
			},
			a);
			"_dm_transitional" === $.dmx.account ? $.reloadTransitional() : $.dmfw.isPT() || $.dmfw.isDudaone() ? $.dmfw.refreshPreview() : NEFW.open(a)
		},
		setCurrent: function(a, e) {
			$.dmx.current.editable = a;
			$.dmx.current.element = e
		},
		finalyzeRuntimeUrl: function(a, e) {
			e = e || "mobile";
			a += -1 == a.indexOf("?") ? "?": "\x26";
			return a + "nee\x3dtrue\x26showOriginal\x3dtrue\x26preview\x3dtrue\x26dm_try_mode\x3dtrue\x26dm_checkSync\x3d1\x26dm_device\x3d" + e
		},
		getByDmid: function(a) {
			return $.dmfw.getPreviewElement("[duda_id\x3d'" + a + "']")
		},
		editorUrl: "ONE" === dm_current_editor ? "/editor/dudaone/shell/one.widgetsEditor.jsp": "/editor/nee/editableObjects/common/nee.editableEditor.jsp",
		editables: function(a) {
			return a ? $.dmfw._this.editables[a] : $.dmfw._this.editables
		},
		getPreviewElement: function(a) {
			try {
				return $.dmfw.previewArea.contents().children().eq(0).find(a ? a: "body")
			} catch(e) {
				return {}
			}
		},
		isPT: function() {
			return "PT" === dm_current_editor
		},
		isDudaone: function() {
			return "ONE" === dm_current_editor
		},
		isMultiView: function() {
			return "all" == $("#Wrapper").data("device")
		},
		isForceWR: function(a) {
			if (!0 === dm_forced_wr) return ! 0;
			null != a.dmProductType && (a.DM_PRODUCT_ID = a.dmProductType);
			null == a.WEB_PLATFORM && (a.WEB_PLATFORM = "");
			if ("GOMO" == a.DM_PRODUCT_ID || $.dmui.getResource("forceWR", {
				product: a.DM_PRODUCT_ID
			})) return ! 0;
			a = $.uaMatch(navigator.userAgent);
			return (isIElessThen9 = "msie" == a.browser && (9 > a.version || 9 > document.documentMode)) ? !0 : 3 == accountLocale && "true" == commonProps["allow.pt.in.japanese"] ? !1 : !commonProps["pt.allowLocales"] && 1 != accountLocale ? !0 : !1
		},
		changeTabTo: function(a, e, d, g) {
			function j() {
				k += 1;
				50 < k && clearTimeout(FW_CONSTANTS.tabReadyTimeout);
				l = $(".rightPanel");
				0 < l.length && "" !== l.html().trim() ? (clearTimeout(FW_CONSTANTS.tabReadyTimeout), e()) : FW_CONSTANTS.tabReadyTimeout = setTimeout(j, 10);
				return ! 1
			}
			var k = 0,
			l, m = $("#_p_editor").find("div.leftPanel").find("div.slideBtn"),
			n = m.filter(".slideBtnSelected").index();
			if (!g && (a !== n || d)) m.eq(a - 1).trigger("click"),
			$.dmfw.isPT() && $.dmfw.setEditorBreadcrumb(null);
			if (e) FW_CONSTANTS.tabReadyTimeout = setTimeout(j, 10);
			else return ! 0
		},
		previewNavigateTo: function(a) {
			a = $.extend(!0, {},
			a);
			var e = "",
			d = a.skipPreviewReload,
			g = void 0,
			j = null,
			k = !1;
			if (a.url) k = $.dmfw.isMultiView(),
			e = a.url,
			g = a.target;
			else if (a.element) if (e = a.element.attr("href"), g = a.element.attr("target"), e.startsWith("#")) d = !0,
			e = $.dmfw.previewArea.attr("src") + e;
			else {
				if (e.startsWith("javascript")) {
					$.dmfw._maskedEval(e);
					return
				}
			} else if (a.page) {
				var e = a.page,
				l = e.siteAlias ? e.siteAlias: $.dmx.site.alias,
				m = e.device;
				if (!m) try {
					m = $.onefw ? $.onefw.device() : "mobile"
				} catch(n) {
					m = "mobile"
				}
				k = "all" == m;
				j = {
					siteAlias: l,
					pageAlias: e.alias,
					checkPremium: e.checkPremium || void 0,
					success: a.onContextUpdated
				};
				e = $.dmfw.finalyzeRuntimeUrl("/site/" + l + "/" + e.alias + (e.query ? "?" + e.query: ""), m)
			}
			0 == e.indexOf("http") && -1 == e.indexOf(window.location.origin) && "_blank" !== g ? $.previewExternalLink.setBackFromExternal(!1) : ($.previewExternalLink.removeBackBtn(), $.previewExternalLink.setLastEditePage(e));
			if (g) window.open(e, g);
			else if (e) if (e.startsWith(["mailto:", "tel:", "sms:"])) $.browser.msie || $("#_dm_hidden_frame").attr("src", e).load();
			else {
				j ? $.dmops.updateEditContext.clientOnly(j) : $.dmops.updateEditContext.reset();
				$.dmfw.closeEditor();
				try {
					$.browser.msie && $.dmfw.setPreviewEditPolicy(!1);
					try {
						var o = NEFW.PREVIEW.get(0).contentWindow;
						if ("about:blank" == o.location.href) if ($.dmfw.isDudaone()) $.dmIsExternalUrl(e) || $(".PreviewPaneInnerWrapper iframe").hide();
						else {
							var r = NEFW.PREVIEW.get(0).contentWindow.document,
							u = $("body", r),
							s = $("#disabledImageZone").clone();
							u.append(s);
							showDefaultLoader(s, o)
						} else $.dmfw.isDudaone() ? $.dmIsExternalUrl(e) || $(".PreviewPaneInnerWrapper iframe").hide() : NEFW.PREVIEW.get(0).contentWindow.replaceWithLoading()
					} catch(B) {}
					if (k) {
						var z = e.replace(/dm_device=[^&]*/g, "dm_device\x3ddesktop"),
						v = e.replace(/dm_device=[^&]*/g, "dm_device\x3dtablet"),
						D = e.replace(/dm_device=[^&]*/g, "dm_device\x3dmobile");
						$.dmfw.previewArea[0].contentWindow.location.replace(z);
						$(".PreviewPaneInnerWrapper.tablet iframe")[0].contentWindow.location.replace(v);
						$(".PreviewPaneInnerWrapper.mobile iframe")[0].contentWindow.location.replace(D)
					} else $.dmfw.previewArea[0].contentWindow.location.replace(e)
				} catch(E) {
					$.log(E)
				}
				d ? $.dmUnblockUI() : (a.onLoad && ($.dmx.onPreviewLoad = a.onLoad), a.onReady && ($.dmx.onPreviewReady = a.onReady), $.dmfw.previewArea.load())
			} else $.log("previewNavigateTo: invalid url")
		},
		_prepareOnPreviewLoad: function(a) {
			var e = !1;
			$.dmx._previewLoad || ($.dmx._previewLoad = {},
			e = !0);
			$.dmx._previewLoad.onLoad = a;
			return e
		},
		_maskedEval: function(a) {
			var e = {};
			for (p in this) e[p] = void 0; (new Function("with(this) { " + a + "}")).call(e)
		},
		_editViewState: {
			editors: [],
			eIndex: 1,
			visible: !1
		},
		_editors: function() {
			return $.dmfw._editViewState.editors
		},
		_closeEditorsCleanState: function(a) {
			a = a || {};
			for (a = $.extend({
				checkLast: !1,
				skipOnClose: a.skipOnClose
			},
			a); 0 < $.dmfw._editViewState.editors.length;) $.dmfw._closeEditorLast(a);
			$.dmfw._editViewState.editors = [];
			$.dmfw._editViewState.visible = !1
		},
		isUseLayout: function() {
			return $.dmx.site.isUsingLayout
		},
		isUseNewSelection: function() {
			return $.dmfw.isPT() ? $.ptfw.isUseNewSelection() : $.dmfw.isDudaone() ? $.onefw.isUseNewSelection() : useNewSelection
		},
		isUseNewSelectionContext: function() {
			return $.dmfw.isUseNewSelection() && useNewSelectionContext
		},
		openEditor: function(a, e, d, g) {
			$.dmfw._openEditor({
				editable: a,
				previewElement: e,
				itemData: d,
				extOptions: g || {},
				options: {
					closeAll: !0
				}
			})
		},
		_openEditor: function(a) {
			$.dmx.editor.valid = !0;
			var e = a.extOptions || {};
			if (e.forceOpen || !$.dmfw.isEditorOpen(a.previewElement)) {
				a.options.closeAll && ($.dmfw.closeEditor({
					keepPreview: !0,
					skipOnClose: a.options.skipOnCLose
				}), $.dmfw._closeEditorsCleanState());
				$.dmfw.isDudaone() && $.onefw.beforeOpenEditor($.dmfw._this.editorArea, a);
				var d = (a = $.extend({
					skipCurrent: !1,
					editable: $.dmx.current.editable,
					isEditor: !0
				},
				a)) && a.skipCurrent ? a.skipCurrent: !1,
				g = a && a.editable ? a.editable: $.dmx.current.editable,
				j = a && void 0 != a.isEditor ? a.isEditor: !0;
				d || $.dmfw.setCurrent(a.editable, a.previewElement);
				var k = "_dme_" + $.dmfw._editViewState.eIndex++;
				$.dmfw._this.editorArea.append("\x3cdiv class\x3d'dm-editor' id\x3d'" + k + "'\x3e\x3c/div\x3e");
				var k = "#" + k,
				l = $(k);
				d || l.data("current", $.extend(!0, {},
				$.dmx.current));
				0 < $.dmfw._editors().length && $($.dmfw._editors().last().id).hide();
				$.dmfw._showEditor(k);
				var m = a.previewElement,
				n = a.editable,
				o = a.itemData,
				r = a.options.breadParts,
				u = a.options.linkElement,
				d = "",
				d = g.editorUrl ? g.editorUrl(itemData) : $.dmfw.editorUrl;
				$.dmfw._editViewState.editors.push({
					id: k,
					editable: n,
					isEditor: j
				});
				$.dmLoad(l, d,
				function() {
					l.find(" .editorCloser").bind("click",
					function(a) { (!$(this).is(".updateButton") || $.dmx.editor.valid) && $.dmfw._closeEditorAll({
							element: this
						});
						a.preventDefault()
					});
					l.find(" .editorBack").bind("click",
					function(a) {
						$.dmx.editor.valid && $.dmfw._closeEditorLast({
							reopenLast: !0
						});
						a.preventDefault()
					});
					l.find("#contentTitle").text(g.title(m).replace("^", " "));
					r && $.dmfw.setEditorBreadcrumb({
						parts: r
					});
					g.showMindTouchHelp && $.ptMindTouch ? (l.find(".mindTouchHelp").attr("id", g.mindTouchId), $.ptMindTouch.showHelp(l.find(".mindTouchHelp"))) : l.find(".mindTouchHelp").hide();
					n.editorReady(l, {
						previewElement: m,
						itemData: o,
						tabToOpen: e.initTab || a.tabToOpen,
						linkElement: u
					});
					if (e.onEditorReady) e.onEditorReady();
					$.dmfw.isDudaone() && $.onefw.afterOpenEditor($.dmfw._this.editorArea, a)
				});
				g && g.type && l.addClass("editable_" + g.type)
			}
		},
		openGlobalEditor: function(a) {
			$.dmfw._openEditor($.extend({
				skipCurrent: !0,
				isEditor: !1,
				options: {
					closeAll: !1,
					breadParts: null
				}
			},
			a))
		},
		reopenEditor: function(a, e) {
			var d = a || $.dmx.current;
			e = e || {};
			var g = $.dmfw.getByDmid(d.element.dmid()),
			d = d.editable;
			$.dmfw.closeEditor({
				keepPreview: !0,
				skipOnClose: e.skipOnClose
			});
			g.selectElement({
				noEffect: !0,
				forceSelect: !0
			});
			g.lockElement();
			$.dmfw.openEditor(d, g);
			$.dmfw.preview.showEditableBar(g)
		},
		addEditor: function(a, e, d, g) {
			var j = null;
			0 < $.dmfw._editors().length && (j = [{
				click: function() {
					$.dmfw._closeEditorLast({
						reopenLast: !0
					})
				},
				title: $.dmfw._editorTitle($.dmfw._editors().last()).replace("^", " ")
			},
			{
				title: a.title(e).replace("^", " ")
			}]);
			g = $.extend(!0, {},
			g, {
				closeAll: !1,
				breadParts: j
			});
			$.dmfw._openEditor({
				editable: a,
				previewElement: e,
				itemData: d,
				options: g
			})
		},
		_editorTitle: function(a) {
			return a ? $(a.id).find("#contentTitle").text() : ""
		},
		_closeEditorAll: function(a) {
			a = a || {};
			var e = $.dmx.current.editable,
			d = $(a.element).hasClass("xButton"),
			g = FW_CONSTANTS.showPrompts,
			j = $.dmfw.isPT() || $.dmfw.isDudaone(),
			k = e && e.checkClose,
			l = !a.override && !d;
			if (g && j && k && l) e.checkClose(d);
			else {
				$(".popupWinExample").hasClass("dontCloseAutomatically") || $(".popupWinExample").find(".closeThis").click();
				e = a.keepPreview || !1;
				$.dmfw._closeEditorsCleanState(a);
				$(".neeWrapper").removeClass("neeWrapperShow");
				$(".neeOverlay").unFadeBackground([".neewrappershow", ".neePreview"]);
				$.dmfw._editViewState.visible = !1;
				try {
					if (!e) {
						var m = $.dmx.current.element;
						$.deselectAllEditableElements();
						$.dmfw.isDudaone() && m.selectElement();
						$.dmfw.preview.removeEditableBar({
							skipCloseEditor: !0
						})
					}
				} catch(n) {
					$.dmNotify("JS Error")
				}
			}
		},
		closeEditor: function(a) {
			var e = !0;
			if ($.dmfw.isPT() || $.dmfw.isDudaone()) e = $.dmfw.isEditorOpen($.dmx.current.element);
			null != a && !0 === a.forceShouldClose && (e = !0);
			e && $.dmfw._closeEditorAll(a)
		},
		closeEditorLast: function(a) {
			$.dmfw._closeEditorLast(a)
		},
		_closeEditorLast: function(a) {
			a = $.extend({
				checkLast: !0
			},
			a);
			if (a.checkLast && 1 == $.dmfw._editors().length) $.dmfw._closeEditorAll();
			else {
				editor = $.dmfw._editViewState.editors.pop();
				var e = !1;
				if (!a.skipOnClose && editor.editable.onEditorClose) editor.editable.onEditorClose(a.onEditorClose);
				else a.onEditorClose && (a.onEditorClose(), e = !0);
				if (!0 === a.forceExecuteOnClose && a.onEditorClose && !e) a.onEditorClose();
				$(editor.id).remove();
				a.reopenLast ? $.dmfw._editors().last() && (e = $($.dmfw._editors().last().id).data("current"), $.dmfw.setCurrent(e.editable, e.element), $.dmfw.reopenEditor($.dmx.current, {
					skipOnClose: !0
				})) : 0 < $.dmfw._editors().length && (e = $($.dmfw._editors().last().id).data("current"), $.dmfw.setCurrent(e.editable, e.element), $($.dmfw._editors().last().id).show()); (!a.keepPreview || !a.keepPreview) && !a.skipCloseEditableBar && $.dmfw.preview.removeEditableBar({
					skipCloseEditor: !0
				})
			}
		},
		_showEditor: function(a) {
			$.dmfw._editViewState.visible || ($(".neeWrapper").addClass("neeWrapperShow"), $(".neeOverlay").fadeBackground([".neewrappershow", ".neePreview"]), $.dmfw._editViewState.visible = !0);
			a && $(a).show()
		},
		refreshPreview: function(a, e) {
			a && ($.dmx.onPreviewReady = a);
			$.dmx.skipUndoReset = e;
			var d = void 0;
			try {
				d = NEFW.PREVIEW[0].contentWindow.location
			} catch(g) {
				$.log("Failed get preview window locaion: " + g.message)
			}
			try {
				if (d && d.pathname) {
					var j = d.pathname;
					j.startsWith("/site/") && $.dmx.page && (j = "/site/" + $.dmx.site.alias + "/" + $.dmx.page.alias);
					$.dmfw.previewNavigateTo({
						url: j + (d.search ? d.search: "")
					})
				} else $.dmfw.previewNavigateTo({
					page: {
						alias: "home"
					}
				})
			} catch(k) {
				$.log(k),
				$.dmfw.previewNavigateTo({
					page: {
						alias: "home"
					}
				})
			}
		},
		setEditorBreadcrumb: function(a) {
			var e = $($.dmfw._editors().last().id).find(".breadcrumb");
			a ? (e.neeBreadcrumbWidget(a), e.show()) : (e.children(".breadcrumb-part").remove(), e.find("span").andSelf().unbind("click").removeClass("breadcrumb-link"), $.dmfw.hideEditorBack())
		},
		showEditorBack: function(a) {
			$.dmfw.showEditorButton({
				selector: ".backButton",
				click: function(e) {
					$(e.target).hide();
					a(e)
				}
			})
		},
		initEditorCheckBox: function(a) {
			if (0 < $.dmfw._editors().length) {
				var e = $($.dmfw._editors().last().id).find(a.selector);
				e.show();
				void 0 !== a.val && e.find("[data-role\x3d'val']").val(a.val).prop("checked", a.val);
				a.change && e.find("[data-role\x3d'val']").unbind("change").bind("change",
				function(d) {
					a.change(d)
				})
			}
		},
		showEditorButton: function(a) {
			if (0 < $.dmfw._editors().length) {
				var e = $($.dmfw._editors().last().id).find(a.selector);
				e.show();
				a.text && (e.html(a.text), a.width && e.css("width", a.width));
				a.click && e.unbind("click").click(function(d) {
					a.click(d)
				});
				void 0 !== a.val && e.find("[data-role\x3d'val']").val(a.val)
			}
		},
		hideEditorButton: function(a) {
			0 < $.dmfw._editors().length && $($.dmfw._editors().last().id).find(a.selector).hide()
		},
		isEditorOpen: function(a) {
			for (var e = 0; e < $.dmfw._editViewState.editors.length; e++) {
				var d = $($.dmfw._editViewState.editors[e].id).data("current");
				if (!a && $.dmfw._editViewState.editors[e].isEditor || d && a && d.element.dmid() == a.dmid()) return ! 0
			}
			return ! 1
		},
		hideEditorBack: function() {
			$(".applyButton , .backButton").hide()
		},
		selectAndOpenEditor: function(a, e, d, g) {
			d = d || {};
			d.initTab = d.initTab || 0;
			$.deselectAllEditableElements();
			a && (1 < a.size() && (a = $(a.get(0))), a && (a.selectElement(void 0, g), a = $.dmfw.isUseNewSelectionContext() ? {
				hideTopBar: !0
			}: {},
			$.dmx.current.element.lockElement(a), e = {
				forceOpen: e
			},
			e = $.extend(e, d), $.dmfw.openEditor($.dmx.current.editable, $.dmx.current.element, null, e)))
		},
		preview: {
			_editableBar: {
				link: {
					priority: 0,
					alwaysOn: !0
				},
				image: {
					priority: 5,
					alwaysOn: !1
				},
				video: {
					priority: 5,
					alwaysOn: !1
				},
				youtube: {
					priority: 5,
					alwaysOn: !1
				},
				submitbutton: {
					priority: 5,
					alwaysOn: !0
				},
				imageSlider: {
					priority: 4,
					alwaysOn: !1
				},
				photoGallery: {
					priority: -1,
					alwaysOn: !1
				},
				yelp: {
					priority: -1,
					alwaysOn: !1
				},
				header: {
					priority: -1,
					alwaysOn: !1
				}
			},
			_editableForBar: function(a) {
				var e = Number.MAX_VALUE,
				d = null,
				g = null;
				$.each(a.editables({
					forEditableBar: !0
				}),
				function(a, k) {
					var l = $.dmfw.preview._editableBar[k.type];
					l && l.priority < e && (d = l, e = d.priority, g = k)
				});
				return ! d ? null: d.alwaysOn || $.dmfw.isEditorOpen() && !$.dmfw.isEditorOpen(a) ? g: null
			},
			removeEditableBar: function() {
				var a = $.dmx.preview._editBar; ! a || !a.bar ? 0 < $.dmfw.getPreviewElement(".ui-tooltip #inlineEditableBar").length && $.dmfw.getPreviewElement(".ui-tooltip").hide() : ($.dmx.preview.removeRedrawListener("editablebar"), a.bar.remove(), $.dmx.preview.wnd().dmQtip({
					op: "destroy",
					element: a.element
				}), $.dmx.preview._editBar = {})
			},
			showEditableBar: function(a) {
				if ($.dmfw.isPT() || $.dmfw.isDudaone() || !$.dmfw.isSelectedAny()) return ! 1;
				var e = $.dmfw.preview._editableForBar(a);
				if (!e) return ! 1;
				var d = e.inlineEdit && e.inlineEdit.bar ? e.inlineEdit.bar: {},
				g;
				if (!d.selectElement || !(g = d.selectElement(a))) return ! 1;
				if ((a = $.dmx.preview._editBar) && a.element && a.element.get(0) === g.get(0)) return ! 0;
				$.dmfw.preview.removeEditableBar();
				null != $.dmx.current && null != $.dmx.current.element && $.dmx.current.element.lockElement();
				$bar = $("\x3cdiv class\x3d'editable-bar'\x3e\x3c/div\x3e");
				$bar.appendTo($.dmfw.getPreviewElement("body"));
				$bar.attr("id", "inlineEditableBar");
				if (!d.onReady) return ! 1;
				d.onReady($bar, g);
				$('\x3cspan class\x3d"close"\x3e\x3c/span\x3e').click(function(a) {
					$.dmfw.preview.removeEditableBar();
					a.stopPropagation()
				}).appendTo($bar);
				$bar.find("a:nth-child(2)").css("margin-left", "15px");
				$bar.click(function(a) {
					a.stopPropagation()
				});
				$.dmx.preview.wnd().dmQtip({
					op: "show",
					element: g,
					content: $bar
				});
				$.dmx.preview._editBar = {
					editable: e,
					element: g,
					bar: $bar
				};
				$.dmx.preview.addRedrawListener("editablebar",
				function() {
					$.dmfw.preview.positionEditableBar()
				});
				return ! 0
			},
			positionEditableBar: function() {
				var a = $.dmx.preview._editBar;
				a && a.element && $.dmx.preview.wnd().dmQtip({
					op: "reposition",
					element: a.element
				})
			},
			cloneInlineElement: function(a) {
				a = a.clone();
				a.find("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS).andSelf().removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS);
				a.find(".inlineEditorParagraphSelected").andSelf().removeClass("inlineEditorParagraphSelected");
				a.find(".inlineEditorLinkSelected").andSelf().removeClass("inlineEditorLinkSelected");
				a.find(".dmNowInlineEditing").andSelf().removeClass("dmNowInlineEditing");
				a.find(".dmLocked").andSelf().removeClass("dmLocked");
				a.find("*").andSelf().removeAttr("contenteditable");
				$.each(a.find("*").andSelf().filter('*[class\x3d""]'),
				function(a, d) {
					$(d).removeAttr("class")
				});
				return a
			},
			testAndSetPlaceholder: function(a, e) {
				a && ($.dmfw.getPreviewElement(a).removeClass(e), $.each($.dmfw.getPreviewElement(a),
				function(a, g) {
					"" == jQuery.trim($(g).html()) && $(g).addClass(e)
				}))
			},
			dudaOneTestAndSetPlaceholder: function(a, e) {
				0 === $(a).find(e).length ? $.dmops.updateCurrentAttributes({
					attrToAdd: {
						"data-placeholder": "true"
					}
				}) : $.dmops.updateCurrentAttributes({
					attrToRemove: ["data-placeholder"]
				})
			}
		},
		loadToHistory: function(a) {
			$.history.load("wr@" + a + "@" + $.dmx.site.alias)
		},
		handleHistoryToken: function(a, e) {
			if ("" != a) {
				var d = a.split("@");
				if (0 < d.length) {
					var g = d[0];
					if ("wr" != g)"dashboard" == g && displayDashboard();
					else if (2 < d.length) {
						var j = d[2];
						$.dmx.site && $.dmx.site.alias && $.dmx.site.alias != j ? window.location.reload() : (navId = NAV_DESIGN_ID, g = d = d[1], "1stpublish" == d && ($.dmx.firstPublished = !0, g = "publish"), navId = "nav" + g, $.dmx.site && $.dmx.site.alias == j && !e ? ("1stpublish" == d && (navId = "refresh"), NEFW._navigateToSelectedTab(navId)) : $.dmops.updateEditContext.site({
							siteAlias: j,
							success: function(a) {
								NEFW.init();
								NEFW.open({
									siteAlias: j,
									tab: navId,
									siteVersion: 300,
									dmProduct: a.dmProductType
								})
							}
						}))
					}
				}
			} else NEFW.init()
		},
		accountCreatedSuccess: function(a) {
			a = a || {};
			dm_anonymus_user = dm_not_saved = !1;
			$.dmfw.isPT() ? $.ptShellContr._afterCreatingAccount() : ($(".shellclose").css("visibility", "visible"), $(".shellHeaderSaveBtn").hide(), $(window).unbind("beforeunload"), NEFW.NAV.maintabs("current") == NAV_PUBLISH_ID && NEFW.NAV.maintabs("nav", "refresh"));
			a.success ? (a.success(), $(".closeThis").click()) : ($(".neeCreateAccountPopupContent").html(""), $(".neeCreateAccountPopupConfirmation").show(), $(".neeCreateAccountPopupContent").append($(".neeCreateAccountPopupConfirmation")), $(".neeCreateAccountConfirmationBtn").click(function() {
				a.fbconnect && FB.ui({
					method: "apprequests",
					message: "I'm building a mobile website on dudamobile.com. Try it out",
					title: "Share DudaMobile with your friends"
				});
				$(".closeThis").click()
			}))
		},
		isIntuit: function() {
			return $.dmx.site.compatible_platforms && -1 != $.dmx.site.compatible_platforms.indexOf("INTUIT") && "INTUIT" === $.dmx.site.redirectProvider
		},
		openPopUpCreateAccount: function(a) {
			tempCreateAccountOptions = a = a || {};
			var e = function(a) {
				a = a || {};
				dm_anonymus_user = dm_not_saved = !1;
				$(".shellclose").css("visibility", "visible");
				$(".shellHeaderSaveBtn").hide();
				$(window).unbind("beforeunload");
				if (!$.dmfw.isPT()) {
					var d = "/home" + window.location.hash;
					if ($.browser.msie) {
						$.dmReloadWindow(d);
						return
					}
					window.History.pushState(null, null, d);
					NEFW.NAV.maintabs("current") == NAV_PUBLISH_ID && NEFW.NAV.maintabs("nav", "refresh")
				}
				a.success ? (a.success(), $(".closeThis").click()) : ($(".neeCreateAccountPopupContent").html(""), $(".neeCreateAccountPopupConfirmation").show(), $(".neeCreateAccountPopupContent").append($(".neeCreateAccountPopupConfirmation")), $(".neeCreateAccountConfirmationBtn").click(function() {
					a.afterConfirm && a.afterConfirm();
					$(".closeThis").click()
				}))
			};
			wrTrackEvent(WR_SITE_OPEN_CREATE_ACCOUNT);
			$(".neeCreateAccountPopup input").placeholder();
			a.title && $(".neeCreateAccountPopupTitle").text(a.title);
			a.signupBtnClass && $(".neeCreateAccountPopupBtn").addClass(a.signupBtnClass);
			a.loginBtnClass && $(".neeCreateAccountPopupExistUserBtn").addClass(a.loginBtnClass);
			$(".neeCreateAccountPopupNewUser").show();
			$(".neeCreateAccountExistUser").hide();
			$(".neeCreateAccountPopupMsg").text("");
			var d = function() {
				$(".neeCreateAccountPopupMsg").text("");
				if ("" == $(".neeCreateAccountPopupNewUser .password").val().trim()) $(".neeCreateAccountPopupMsg").text(dmStr["ui.nee.saveSitePopUp.32"]);
				else if (0 < $(".neeCreateAccountPopupNewUser .confirmPassword").length && $(".neeCreateAccountPopupNewUser .password").val() != $(".neeCreateAccountPopupNewUser .confirmPassword").val()) $(".neeCreateAccountPopupMsg").text(dmStr["ui.nee.saveSitePopUp.33"]);
				else {
					var d = {
						email: $(".neeCreateAccountPopupNewUser .email").val(),
						password: $(".neeCreateAccountPopupNewUser .password").val(),
						siteId: $.dmx.site.id,
						accountEditor: dm_account_editor,
						welcomeWithSite: !1
					};
					$.dmPost({
						url: "/accounts/createwithsite",
						data: d,
						success: function() {
							e(a);
							dmTrackNewUser(d.email);
							wrTrackEvent(WR_SITE_CREATE_ACCOUNT)
						},
						error: function(a) {
							if (a) return $(".neeCreateAccountPopupMsg").text(a.message),
							!0
						}
					})
				}
			};
			$(".neeCreateAccountPopupBtn").click(function() {
				d()
			});
			$(".neeCreateAccountExistUser .password").keypress(function(a) {
				13 == a.keyCode && d()
			});
			var g = function() {
				$(".neeCreateAccountPopupMsg").text("");
				var d = {
					j_username: $(".neeCreateAccountExistUser .email").val(),
					j_password: $(".neeCreateAccountExistUser .password").val(),
					siteid: $.dmx.site.id
				};
				$.dmPost({
					url: "/login",
					data: d,
					success: function() {
						e(a)
					},
					error: function(a) {
						if (a) return $(".neeCreateAccountPopupMsg").text(a.message),
						!0
					}
				})
			};
			$(".neeCreateAccountPopupExistUserBtn").click(function() {
				g()
			});
			$(".neeCreateAccountExistUser .password").keypress(function(a) {
				13 == a.keyCode && g()
			});
			$(".switchToLogin").click(function() {
				$(".neeCreateAccountPopupMsg").text("");
				$(".neeCreateAccountPopupNewUser").hide();
				$(".neeCreateAccountExistUser").show()
			});
			$(".switchToCreateAccount").click(function() {
				$(".neeCreateAccountPopupMsg").text("");
				$(".neeCreateAccountPopupNewUser").show();
				$(".neeCreateAccountExistUser").hide()
			})
		},
		showSignUpLogin: function(a) {
			function e() {
				var d = window.location.hash;
				$.browser.msie && ($.dmfw.isPT() ? 2 != $("#SideMenuWrapper").accordion("option", "active") && $.dmReloadWindow("/home") : a.success(function() {
					try {
						var a = d.split("@");
						1 < a.length && "publish" == a[1] && (a[1] = "1stpublish", d = a.join("@"))
					} catch(e) {
						$.log(e)
					}
					$.dmReloadWindow("/home" + d)
				}));
				var e = "/home" + window.location.hash;
				$.dmfw.isPT() ? $.ptShellContr._afterCreatingAccount() : (window.History.pushState(null, null, e), $(".shellclose").css("visibility", "visible"), $(".shellHeaderSaveBtn").hide());
				dm_anonymus_user = dm_not_saved = !1;
				$(window).unbind("beforeunload");
				a.success && a.success()
			}
			function d() {
				var d = void 0;
				a.validate && (d = a.validate());
				if (d) $(a.msgSelector).text(d);
				else if (g) if ($(a.pswdSelector).val() != $(a.confirmPswdSelector).val()) $(a.msgSelector).text(dmStr["ui.login.validation.4"]);
				else {
					var k = {
						email: $(a.emailSelector).val(),
						password: $(a.pswdSelector).val(),
						siteId: $.dmx.site.id,
						welcomeWithSite: !0,
						accountEditor: dm_account_editor
					};
					$.dmPost({
						url: "/accounts/createwithsite",
						data: k,
						success: function() {
							e();
							dmTrackNewUser(k.email);
							wrTrackEvent(WR_SITE_CREATE_ACCOUNT)
						},
						error: function(d) {
							if (d) return $(a.msgSelector).text(d.message),
							!0
						}
					})
				} else d = {
					j_username: $(a.emailSelector).val(),
					j_password: $(a.pswdSelector).val(),
					siteid: $.dmx.site.id
				},
				$.dmPost({
					url: "/login",
					data: d,
					success: function() {
						e()
					},
					error: function(d) {
						if (d) return $(a.msgSelector).text(d.message),
						!0
					}
				})
			}
			var g = a.initSignUp;
			wrTrackEvent(WR_SITE_REVIEW_PUBLISH_NEW_USER);
			a.display && a.display(g);
			$(a.switchSelector).click(function() {
				g = !g;
				a.display && a.display(g);
				$(a.msgSelector).text("")
			});
			$(a.submitSelector).unbind("click").click(function() {
				d()
			});
			$(a.emailSelector).unbind("keypress").keypress(function(a) {
				13 == a.keyCode && d()
			});
			$(a.pswdSelector).unbind("keypress").keypress(function(a) {
				13 == a.keyCode && d()
			})
		},
		gotoDashboard: function(a, e) {
			$.dmUIBlockControlled({
				region: "gotoDahaboard",
				op: "block",
				style: "wheel"
			});
			var d = $.dmui.getResource("returnToDashboardLink") || "/home"; ! $.dmx.site.alias || !0 == e ? window.location.href = d: $.dmops.updateEditContext.site({
				success: function() {
					$.dmx.site.needsRepublish ? ($.dmUIBlockControlled({
						region: "gotoDahaboard",
						op: "unblock",
						style: "wheel"
					}), $.dmfw.openRepublishPopup({
						callback: function() {
							window.location.href = d
						}
					})) : window.location.href = d
				}
			})
		},
		openPopup: function(a, e) {
			var d = $("\x3cdiv\x3e\x3c/div\x3e");
			d.neePopUpDiv(a, e);
			d.trigger("click")
		},
		openPopupFromUrl: function(a, e) {
			e = e || {};
			var d = $("\x3cdiv\x3e\x3c/div\x3e");
			$.dmLoad(d, a,
			function() {
				$.dmfw.openPopup(d.children(), e)
			})
		},
		openUpgradePopup: function(a) {
			var e = null,
			d = null,
			g = null,
			j = null,
			d = $.dmx.isPremium(),
			e = $.dmfw.isPT(),
			j = $.dmx.site.compatible_platforms && -1 != $.dmx.site.compatible_platforms.indexOf("INTUIT") && "INTUIT" === $.dmx.site.redirectProvider ? "intuitPaymentStyle": null,
			g = $.dmx.site.isOwnerReseller;
			d || $.dmfw.openPopupFromUrl(e ? "/editor/nee/mainTabs/nee.pt.upgradePopup.jsp?alias\x3d" + $.dmx.site.alias: "/editor/nee/mainTabs/nee.upgradePopup.jsp", {
				disableDrag: !0,
				popupAdditionalClass: j,
				init: function(d) {
					d.find("#neeUpgradeNowBtn").unbind("click").click(function() {
						$.dmfw.openPayment({
							token: a.token || ""
						})
					});
					d.find("#neeUpgradeNoTxBtn").unbind("click").click(function() {
						d.close()
					});
					g && (d.find("#premiumPlan P").addClass("resellerRibon"), d.find(".ptPublishPlanHeadPrice .price").text(dmStr["ui.pt.upgradePop.reseller.amount"]))
				}
			})
		},
		initManageSubscription: function(a) {
			wrTrackEvent(WR_SITE_OPEN_MANAGE_SUBS);
			$("#paymentHistoryToggle").click(function() {
				$(this).toggleClass("historyToggleOn");
				$("#paymentHistory").toggleClass("paymentHistoryShow")
			});
			$("#cancelSite").unbind("click").click(function() {
				wrTrackEvent(WR_SITE_CANCEL_SUBS_FIRST);
				$.dmfw.openPopupFromUrl("/editor/direct/html/dashboard/dashboard.downgradePopup.jsp", {
					forceWidth: "560px",
					forceHeight: "450px",
					popupAdditionalClass: "neeDowngradePopup",
					init: function() {
						$("#downgradeButton").unbind("click").click(function() {
							if (!$("#downgradeButton").hasClass("loading")) if (0 == $("#downgradeReason").val()) $("#downgradeReason").addClass("validationError");
							else if (9 == $("#downgradeReason").val() && "" == $("#downgradeMoreInfo").val()) $("#downgradeMoreInfo").addClass("validationError");
							else {
								$("#downgradeButton").addClass("loading");
								$.dmBlockUI();
								"undefined" === a && (a = null);
								a = a || $.dmx.site.id;
								var e = {
									reason: $("#downgradeReason").val(),
									more: $("#downgradeMoreInfo").val()
								};
								a ? $.dmPost({
									url: "/sites/" + a + "/downgrade",
									data: e,
									success: function() {
										$.dmUnblockUI();
										$("#downgradeRequest").hide();
										$("#downgradeConfirm").show();
										wrTrackEvent(WR_SITE_CANCEL_SUBS_SECOND);
										$("#downgradeButton").removeClass("loading")
									},
									error: function() {
										$.dmUnblockUI();
										$("#downgradeButton").removeClass("loading")
									}
								}) : ($("#downgradeButton").removeClass("loading"), $.dmUnblockUI(), $.log("Can't downgrade site: " + $.dmx.site.alias + ", site id is missing."))
							}
						});
						$("#downgradeReason").change(function() {
							wrTrackEvent(WR_SITE_CHANGE_DOWNGRADE_REASON, {
								reason: $("#downgradeReason option:selected").text()
							});
							$("#downgradeReason").removeClass("validationError");
							var a = ".bot" + $(this).val();
							$(".botTip").hide();
							$("#botPlaceHolder").hide();
							$("#downgradeMoreInfo").removeClass("smallTextarea");
							$(a).show();
							$(a).is(":visible") && $("#downgradeMoreInfo").addClass("smallTextarea");
							$("#startOver").unbind("click").click(function() {
								wrTrackEvent(WR_SITE_CLICK_DOWNGRADE_TIP, {
									reason: $("#downgradeReason option:selected").text()
								});
								$.dmfw.openCreateNewSitePopup(!0, $.dmx.site.alias, $.dmx.site.baseUrl, $.dmx.site.vertical, $.dmx.site.subCategory);
								$(".closeThis").click()
							})
						})
					}
				})
			})
		},
		isCurrenttabSupportRuntimeEdit: function() {
			return $.dmfw.isPT() ? !0 : $.dmfw.isDudaone() ? !$.onefw.inPreviewMode: "navdesign" == NEFW.NAV.maintabs("current") ? !0 : !1
		},
		getPreviewEditPolicy: function() {
			try {
				if ($.dmx.preview.wnd() && $.dmx.preview.wnd().getEventsFirePolicy) return $.dmx.preview.wnd().getEventsFirePolicy()
			} catch(a) {
				$.log()
			}
		},
		setPreviewEditPolicy: function(a) {
			try {
				if (!$.dmfw.isDudaone() || !$.onefw.inPreviewMode) $.dmx.preview.wnd() && $.dmx.preview.wnd().setEventsFirePolicy && $.dmx.preview.wnd().setEventsFirePolicy(a),
				$.dmx.preview.all().each(function(d, e) {
					e.contentWindow && e.contentWindow.setEventsFirePolicy && e.contentWindow.setEventsFirePolicy(a)
				})
			} catch(e) {
				$.log()
			}
		},
		openPartnerWelcomePopup: function() {
			isPTEnabled && isWLReseller && isShowWLResellerWelcome ? $.dmfw.openPopupFromUrl("/editor/nee/mainTabs//welcome/wlResellerWelcome.jsp", {
				forceWidth: "625px",
				forceHeight: "505px"
			}) : !isWLReseller && (isPTEnabled && isReseller && isShowResellerWelcome && "read" != $.getCookie("_dm_pt_welcome_1")) && ($.dmfw.openPopupFromUrl("/editor/nee/mainTabs//welcome/partnerWelcome.jsp", {
				forceWidth: "625px",
				forceHeight: "485px"
			}), $.setCookie("_dm_pt_welcome_1", "read", 8064, "/", !1))
		},
		openGOMOUpgradePopup: function(a) {
			$.dmfw.openPopupFromUrl("/editor/product/gomo/gomoUpgradePopup.jsp?v\x3d" + (new Date).getTime() + "\x26alias\x3d" + a, {
				forceWidth: "600px",
				forceHeight: "390px",
				dontCloseAutomatically: !0,
				disableDrag: !0
			})
		},
		openTryBFSPopup: function() {
			$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/ptMainTabs/welcomeErorrPages/nee.pt.error_content.jsp?v\x3d" + (new Date).getTime(), {
				forceWidth: "540px",
				forceHeight: "340px",
				dontCloseAutomatically: !0,
				disableDrag: !0,
				init: function() {
					wrTrackEvent("show_suggest_bfs_popup")
				}
			})
		},
		openCreateNewSitePopup: function(a, e, d, g, j) {
			var k = null,
			k = {
				forceWidth: "662px",
				forceHeight: "402px",
				popupAdditionalClass: "orangeFocus"
			},
			l = {
				forceWidth: "332px",
				forceHeight: "402px",
				popupAdditionalClass: "orangeFocus noBFS"
			},
			k = !1 == isBFSEnabled ? l: k;
			$.dmfw.openPopupFromUrl("/editor/nee/mainTabs//createSite/nee.createSite.jsp", $.extend(k, {
				init: function() {
					e && ($("#dm_site_name").val(e), $("#dm_site_original_alias").val(e));
					d && $("#dm_site_url").val(d);
					g && $("#dm_site_category").val(g);
					j && $("#dm_site_sub-category").val(j);
					a && $("#dm_site_recreate").val("true");
					var k = [];
					e && k.push(e);
					$("#dm_site_url").focus();
					$("#dm_site_url").change(function() {
						$(this).val($(this).val().trim());
						0 != $(this).val().indexOf("http") && $(this).val("http://" + $(this).val());
						$.dmPost({
							url: "/sites/allocatealiasfromurl?url\x3d" + $(this).val(),
							success: function(a) {
								$("#dm_site_name").val(a.value);
								k.push(a.value)
							}
						})
					});
					$("#dm_site_sub-category").change(function() {
						$.dmfw.hideQTip({
							selector: "#dm_site_sub-category"
						})
					});
					$("#convertForm").keyup(function(a) {
						13 == a.keyCode && !$(a.target).data("noSubmit") && $(this).submit()
					});
					$("#convertForm").submit(function() {
						if ("" == $("#dm_site_url").val() || "http://" == $("#dm_site_url").val()) return $.dmfw.showValidationError("#dm_site_url", dmStr["ui.create.1"]),
						!1;
						if (!1 == /^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test($("#dm_site_url").val())) return $.dmfw.showValidationError("#dm_site_url", dmStr["ui.create.2"]),
						!1;
						if ("" == $("#dm_site_name").val()) return $.dmfw.showValidationError("#dm_site_name", dmStr["ui.create.3"]),
						!1;
						if (!1 == /^[a-zA-Z0-9-_]*$/.test($("#dm_site_name").val())) return $.dmfw.showValidationError("#dm_site_name", dmStr["ui.create.4"]),
						!1;
						if (0 == $("#dm_site_sub-category").prop("selectedIndex")) return $.dmfw.showValidationError("#dm_site_sub-category", dmStr["ui.create.5"]),
						!1;
						$("#dm_site_sub-category").find(":selected").data("notbusiness") && $("#dm_site_category").val($("#dm_site_sub-category").val());
						if (0 <= $.inArray($("#dm_site_name").val(), k)) return ! 0;
						var a = $("#dm_site_name").val().trim();
						$.dmPost({
							url: "/sites/allocatealias?alias\x3d" + a,
							success: function() {
								k.push(a);
								$("#convertForm").submit()
							},
							error: function() {
								$.dmfw.showValidationError("#dm_site_name", dmStr["ui.create.6"]);
								return ! 0
							}
						});
						return ! 1
					})
				},
				showMindTouchHelp: !0,
				mindTouchStyle: "dashboardCreateSite",
				mindTouchId: "dmMtDashboardCreateSite"
			}))
		},
		openPinkyToeBetaPopup: function() { ! $.dmfw.isForceWR($.dmx.site) && (isPTEnabled && "read" != $.getCookie("_dm_pt_pinky")) && ($.dmfw.openPopupFromUrl("/editor/nee/mainTabs//welcome/pinkytoeBeta.jsp", {
				forceWidth: "650px",
				forceHeight: "550px",
				dontCloseAutomatically: !0
			}), $.setCookie("_dm_pt_pinky", "read", 8064, "/", !1))
		},
		switchToPinkyToe: function() {
			$.dmPost({
				url: "/accounts/" + dm_account_name + "/switcheditor/PT",
				success: function() {
					location.replace("/home/site/" + $.dmx.site.alias)
				}
			})
		},
		changeLanguage: function(a) {
			a = a || 1;
			if ((dm_account_locale || 1) != a) {
				var e = {
					url: "/account/changelocale?locale\x3d" + a,
					success: function() {
						$.dmUIBlockControlled({
							region: "locale.change",
							op: "unblock"
						});
						$(window).unbind("beforeunload");
						var d = window.location.href;
						d && (d = d.replace("/new#", "/new?dm_lang\x3d" + a + "#").replace(/dm_lang=\d+/, "dm_lang\x3d" + a));
						d == window.location.href ? window.location.reload(!0) : window.location.href = d
					},
					error: function() {
						$.dmUIBlockControlled({
							region: "locale.change",
							op: "unblock"
						})
					}
				};
				$.dmUIBlockControlled({
					region: "locale.change",
					op: "block",
					style: "wheel"
				});
				$.dmPost(e)
			}
		},
		changePalette: function(a, e) {
			$.dmLoading($.dmfw.isPT() ? $("#ptEditorArea") : $("#_editor_w"));
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/assignPalette/" + a,
				success: function(a) {
					var g = $.dmfw.previewArea[0].contentWindow;
					$.navigationUtil.clearNavShape($($.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav")));
					$.deselectAllEditableElements();
					$.dmfw.refreshPreview(function() {
						e && e()
					});
					g.refreshGlobalCssAndShowLoadingNEW && g.refreshGlobalCssAndShowLoadingNEW(a.value, 3E3);
					$.dmUIBlockControlled({
						region: "theme.change",
						op: "unblock"
					});
					setTimeout("neeHistoryManager.clearAndUpdateHistory();", 3200);
					wrTrackEvent(WR_SITE_CHANGE_THEME, {
						theme: $.dmx.site.baseThemeName
					})
				}
			});
			setTimeout(function() {
				$.dmUnblockUI()
			},
			3E3)
		},
		calcPalettes: function(a) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/calcPalettes/",
				success: function() {
					$.log("finished calcuating palettes");
					a && a()
				}
			})
		},
		restoreFromLayoutToTheme: function() {
			$.dmLoading($.dmfw.isPT() ? $("#ptEditorArea") : $("#_editor_w"));
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/restoreTheme/",
				success: function(a) {
					$.log("finished restoring theme");
					$.dmfw.refreshPreview();
					window.refreshGlobalCssAndShowLoadingNEW && window.refreshGlobalCssAndShowLoadingNEW(a.value, 3E3)
				}
			});
			setTimeout(function() {
				$.dmUnblockUI()
			},
			3E3)
		},
		changeLayout: function(a, e, d) {
			d = d || "mobile";
			$.dmfw.isPT() || ($.dmfw.isDudaone() ? $.dmLoading($("#previewWrapper")) : $.dmLoading($("#_editor_w")));
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/assignLayout/" + a + "/" + d,
				success: function(d) {
					$.dmx.site.layoutID = a;
					var j = $.dmfw.previewArea[0].contentWindow;
					$.navigationUtil.clearNavShape($($.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav")));
					$.deselectAllEditableElements();
					$.dmfw.refreshPreview(function() {
						$.dmUnblockUI();
						e && e()
					});
					j.refreshGlobalCssAndShowLoadingNEW && j.refreshGlobalCssAndShowLoadingNEW(d.css, 3E3);
					$.dmx.site.headerFixed = d.headerFixed;
					$.dmx.site.headerSkinny = d.headerSkinny;
					$.dmUIBlockControlled({
						region: "theme.change",
						op: "unblock"
					});
					setTimeout("neeHistoryManager.clearAndUpdateHistory();", 3200);
					wrTrackEvent(WR_SITE_CHANGE_THEME, {
						theme: $.dmx.site.baseThemeName
					})
				}
			})
		},
		_preloadDefaultImages: function() {
			$(["https://dm-direct.s3.amazonaws.com/defaultImages/clickToEditVideo.png", "https://dm-direct.s3.amazonaws.com/defaultImages/clickToEditPicture.png"]).preload()
		},
		checkSitePublished: function() {
			$.dmx.site.isPublished ? NEFW.NAV.maintabs("enable", "navredirect") : NEFW.NAV.maintabs("disable", "navredirect")
		},
		_processPageSyncStatus: function() {
			$.dmx.rt.sync || ($.dmx.rt.sync = {});
			$.dmx.rt.isPageOutOfSync && ($.dmx.rt.sync[$.dmx.page.id] = {},
			$.dmx.rt.sync[$.dmx.page.id].status = "ASK_FOR_SYNC");
			switch ($.dmx.rt.sync[$.dmx.page.id] ? $.dmx.rt.sync[$.dmx.page.id].status: "") {
			case "ASK_FOR_SYNC":
				$.log("Page '[alias: " + $.dmx.page.alias + "; url: " + $.dmx.rt.liveUrl + "] is not synchronized.");
				$.dmPreviewMessage({
					onLoad: function(a) {
						var e = "/editor/nee/editableObjects/common/nee.outofsync-msg.jsp";
						"GDWST" === $.dmx.site.dmProductType && (e = "/editor/nee/editableObjects/common/nee.outofsync-msg-wst.jsp");
						a.load(e,
						function() {
							a.find("#sync").click(function(a) {
								a.stopPropagation();
								$.dmops.updatePageWithLiveContent({
									success: function() {
										$.dmx.rt.sync[$.dmx.page.id].status = "ASK_CONFIRM_SYNC";
										$.dmx.rt.isPageAfterSync = !1;
										$.dmfw.previewNavigateTo({
											page: {
												alias: $.dmx.page.alias
											}
										})
									}
								})
							});
							a.find("#dont").click(function(a) {
								a.stopPropagation();
								$.dmPreviewSaving();
								$.dmPostWithHistory({
									url: "/pages/" + $.dmx.page.id + "/disableAutoSync/true",
									success: function() {
										delete $.dmx.rt.sync[$.dmx.page.id];
										$.dmPreviewSaved();
										$.dmPreviewMessage().hide()
									}
								})
							});
							a.find("#notNow").click(function() {
								var a = $.dmfw.getPreviewEditPolicy();
								$.dmfw.setPreviewEditPolicy(!1);
								$.dmPreviewMessage().hide();
								setTimeout(function() {
									$.dmfw.setPreviewEditPolicy(a)
								},
								100)
							})
						})
					},
					offset: {
						top: 483
					},
					small: !0,
					flip: !0,
					additionalClass: "GDWST" === $.dmx.site.dmProductType ? "dmWstPreviewSyncMessage": null
				});
				break;
			case "ASK_CONFIRM_SYNC":
				$.dmPreviewMessage({
					onLoad:
					function(a) {
						a.load("/editor/nee/editableObjects/common/nee.syncdone-msg.jsp",
						function() {
							a.find("#keep").click(function() {
								delete $.dmx.rt.sync[$.dmx.page.id];
								a.parents(".neePreviewMsg").hide()
							});
							a.find("#revert").click(function() {
								$.dmx.rt.isPageAfterSync = !1;
								$.dmops.revertUpdatePageWithLiveContent({
									success: function() {
										delete $.dmx.rt.sync[$.dmx.page.id];
										$.dmfw.previewNavigateTo({
											page: {
												alias: $.dmx.page.alias
											}
										})
									},
									error: function(a, d, g) {
										var j = JSON.parse(a.responseText);
										"InvalidState" == j.error_code ? (delete $.dmx.rt.sync[$.dmx.page.id], $.dmPreviewMessage({
											onLoad: function(a) {
												a.append(j.message)
											}
										})) : $.dmDefaultXHRerror(a, d, g)
									}
								})
							})
						})
					},
					offset: {
						top: 483
					},
					small: !0,
					flip: !0
				})
			}
		},
		isSelectedAny: function() {
			return 0 < $.dmfw.getPreviewElement("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS).length
		},
		initPoweredByCloser: function() {
			function a() {
				if ($.dmx.isPremium()) $.dmops.removePoweredBy();
				else {
					var a = $("\x3cdiv\x3e" + dmStr["ui.nee.framework.7"] + "\x3cbr\x3e"),
					e = $("\x3ca\x3e" + dmStr["ui.nee.framework.4"] + "\x3c/a\x3e"),
					j = $("\x3ca\x3e" + dmStr["ui.nee.framework.5"] + "\x3c/a\x3e"),
					k = $("\x3ca\x3e" + dmStr["ui.cancel"] + "\x3c/a\x3e");
					e.unbind("click").click(function() {
						$.dmops.removePoweredBy();
						$.dmPreviewMessage().hide();
						$.dmfw.openUpgradePopup({
							token: "design"
						});
						$.dmPreviewMessage().hide();
						wrTrackEvent(WR_SITE_REMOVE_FOOTER_UPGRADE_NOW)
					});
					j.unbind("click").click(function() {
						$.dmops.removePoweredBy();
						$.dmPreviewMessage().hide();
						NEFW.NAV.maintabs("current") == NAV_PUBLISH_ID && NEFW._navigateToSelectedTab("refresh");
						wrTrackEvent(WR_SITE_REMOVE_FOOTER_UPGRADE_LATER)
					});
					k.unbind("click").click(function() {
						$.dmPreviewMessage().hide()
					});
					var l = $("\x3cdiv\x3e\x3c/div\x3e");
					l.append(e);
					l.append(j);
					l.append(k);
					a.append(l);
					l.addClass("neePreviewMsgButtonsWrapper");
					$.dmPreviewMessage({
						onLoad: function(e) {
							e.empty();
							e.append(a)
						},
						offset: {
							top: 473
						},
						flip: !0,
						small: !1
					});
					wrTrackEvent(WR_SITE_REMOVE_FOOTER_CLICKED)
				}
			}
			var e = $.dmfw.getPreviewElement(".dmMobileFooterCloseButton");
			0 == e.length && (e = $("\x3cdiv\x3e\x3c/div\x3e"), $.dmfw.getPreviewElement("#mobileFooter").prepend(e), e.addClass("dmMobileFooterCloseButton"), e.attr("title", dmStr["ui.nee.framework.6"]));
			e.unbind("click.powerremove").bind("click.powerremove",
			function(d) {
				a(d)
			});
			$.dmfw.getPreviewElement("#powered").unbind("click.powerremove").bind("click.powerremove",
			function(d) {
				a(d)
			})
		},
		fireEventFromPreview: function(a, e) {
			var d = $(e);
			$.dmx.preview.event = a;
			if ($.dmx.multiSelect) _handleMultipleEvents(d, a);
			else if ("mouseover" == a.type) {
				var g = {
					event: a
				};
				$.dmfw.isDudaone() && (g.additionalIllegalSelections = [".dmRespRow:not(.dmHeader)"], $.respUtils.initRowEditor($(a.target), {}));
				d.selectElement(g)
			} else if ("mouseup" == a.type) null != _RTE_Element && null != _RTE_Element.element && (d.hasClass("dmNowInlineEditing") || d.is(".dmNowInlineEditing *")) && _RTE_Element.handleWindowEvents(a);
			else if ("mouseleave" != a.type) if ("click" == a.type) if ($(".dmPreviewHelperWrapper").hide("slow"), !d.hasClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET) && !d.is("." + INLINE_EDITOR_NOT_EDITABLE_ELEMET + " *")) {
				var j = !1,
				g = null,
				k = !1;
				if (0 < $.dmfw.getPreviewElement(".dmNowInlineEditing, .dmLocked").length && !d.hasClass("dmNowInlineEditing") && !d.is("#inlineEditorLinkBar, .DMInlineEditorNotEditableElement") && !d.is(".dmLocked, .dmLocked *") && !d.is(".dmRespRow")) $.dmfw.closeEditor({
					override: !0
				}),
				$.deselectAllEditableElements(),
				null != d && (d.selectElement({
					event: a,
					forceSelect: !0
				}), j = !0, $.dmfw.isDudaone() && (g = "outside-locked", k = !0));
				else if ((d.hasClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS) || d.is("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS + " *")) && !d.hasClass("dmNowInlineEditing") && !d.is(".dmNowInlineEditing *") && !d.is(".placeholder, .placeholder *")) try {
					if (d.is(".dmLocked, .dmLocked *") && !$.dmx.current.element.is(".dmRespRow")) {
						if (!$($(a.target).editable().element).is($($.dmx.current.editable.element)) && $(a.target).editable().priority <= $.dmx.current.editable.priority && ($(a.target).selectElement({
							event: a,
							forceSelect: !0
						}), j = !0), $.dmfw.isUseNewSelectionContext() && (!$.dmfw.isDudaone() || !$.dmfw.isEditorOpen())) $.dmx.current.editable.inlineEditor.editorUtils.editorTop.is(":hidden") && $.dmx.current.editable.inlineEditor.editorUtils.editorTop.fadeIn($.dmx.current.editable.inlineEditor.editorUtils.contextBoxFadeInDelay),
						$.dmx.current.editable.inlineEditor.editorUtils.redrawEditorContextBox({
							event: a
						})
					} else {
						$.dmfw.isUseNewSelectionContext() && (0 == $($(a.target).editable().element).find(".placeholder").length ? $(a.target).selectElement({
							forceReinitInlineEditor: !0,
							event: a
						}) : (g = "inside-placeholder", k = !0));
						var l = NEFW.PREVIEW.get(0).contentWindow,
						m = $($.dmx.current.element).offset().top - 36;
						$.dmx.preview.wnd().$.DM.isBodyScrollable() || (m -= $.dmx.preview.wnd().jQuery.layoutDevice.getTopFixedElementsOffset());
						if (!$.dmfw.isUseNewSelectionContext()) {
							var n = "body";
							$.dmx.preview.wnd().$.DM.isBodyScrollable() || (n = "#iscrollBody", m += $.getScrollingPosition()[1]);
							$.dmfw.getPreviewElement(n).scrollTop() > m && (l.setEventsFirePolicy(!1), $.dmops.scrollPreview(m, 500,
							function() {
								l.setEventsFirePolicy(!0)
							}))
						}
						j = !0
					}
				} catch(o) {
					$.log(o)
				}
				j && null != $.dmx.current.element && (j = $.dmx.current.editable.inlineEditor.editorUtils.controls.edit.handler, $.dmfw.isDudaone() && ("outside-locked" == g && $.dmx.current.element.selectElement(), $.respUtils.hideContextBox(), $.dmx.current.editable.inlineEditor.editorUtils.properties.allowTextEditing && (j = $.dmx.current.editable.inlineEditor.editorUtils.controls.inlineEdit.handler)), $.dmfw.isUseNewSelection() && !1 === $.dmx.current.editable.inlineEditor.editorUtils.properties.lockModeOpensEditor && (j = $.dmx.current.editable.inlineEditor.editorUtils.controls.lock.handler, d.is(".dmLockedNew, .dmLockedNew *") && (j = null)), null != j && !k && j($.dmx.current.element, d, a))
			} else {
				if (d.is("." + INLINE_EDITOR_COVER_CLASS_NEW) && (d = d.data("matchedEditable")) && d.element) $.dmx.current.element.is(d.element) || ($.deselectEditable($.dmx.current.editable), d.element.selectElement(), $.dmfw.closeEditor({
					override: !0
				})),
				j = d.inlineEditor.editorUtils.controls.lock.handler,
				j(d.element, d.element, a)
			} else if ("dbclick" == a.type) {
				$(e).is("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS + ", ." + INLINE_EDITOR_EDITED_ELEMENT_CLASS + " *") || ($.dmfw.closeEditor({
					override: !0
				}), $.deselectAllEditableElements(), d.selectElement({
					event: a
				}));
				if ($.dmx.current.editable && $.dmx.current.editable.inlineEditor && !0 === $.dmx.current.editable.inlineEditor.editorUtils.dbClicksAllowed) $.dmx.current.editable.inlineEditor.editorUtils.onDBclick(a);
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
			} else "keydown" == a.type && (!_RTE_Element || !_RTE_Element.element) && $(document).trigger(a)
		},
		initAdCloser: function() {
			function a() {
				if ($.dmx.isPremium()) $.dmops.removeAds();
				else if (!$.dmfw.getPreviewElement("#dmRoot").hasClass("dmEmulatorFree")) {
					var a = $("\x3cdiv\x3e" + dmStr["ui.nee.framework.3"] + "\x3cbr\x3e"),
					e = $("\x3ca\x3e" + dmStr["ui.nee.framework.4"] + "\x3c/a\x3e"),
					j = $("\x3ca\x3e" + dmStr["ui.nee.framework.5"] + "\x3c/a\x3e"),
					k = $("\x3ca\x3e" + dmStr["ui.cancel"] + "\x3c/a\x3e");
					e.unbind("click").click(function() {
						$.dmops.removeAds();
						$.dmPreviewMessage().hide();
						$.dmfw.openUpgradePopup({
							token: "design"
						});
						$.dmPreviewMessage().hide();
						wrTrackEvent(WR_SITE_REMOVE_ADS_UPGRADE_NOW)
					});
					j.unbind("click").click(function() {
						$.dmops.removeAds();
						$.dmPreviewMessage().hide();
						NEFW.NAV.maintabs("current") == NAV_PUBLISH_ID && NEFW._navigateToSelectedTab("refresh");
						wrTrackEvent(WR_SITE_REMOVE_ADS_UPGRADE_LATER)
					});
					k.unbind("click").click(function() {
						$.dmPreviewMessage().hide()
					});
					var l = $("\x3cdiv\x3e\x3c/div\x3e");
					l.append(e);
					l.append(j);
					l.append(k);
					a.append(l);
					l.addClass("neePreviewMsgButtonsWrapper");
					$.dmPreviewMessage({
						onLoad: function(e) {
							e.empty();
							e.append(a)
						},
						offset: {
							top: 28
						},
						flip: !1,
						small: !1
					});
					wrTrackEvent(WR_SITE_REMOVE_ADS_CLICKED)
				}
			}
			var e = $.dmfw.getPreviewElement(".dmAdCloseButton");
			0 == e.length && (e = $("\x3cdiv\x3e\x3c/div\x3e"), $.dmfw.getPreviewElement("#ad").append(e), e.addClass("dmAdCloseButton"), e.attr("title", dmStr["ui.nee.framework.2"]));
			e.unbind("click.adremove").bind("click.adremove",
			function(d) {
				a(d)
			});
			$.dmfw.getPreviewElement("#ad").unbind("click.adremove").bind("click.adremove",
			function(d) {
				a(d)
			})
		},
		changeVariation: function(a) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/assignStyle/" + a,
				success: function() {
					$.dmx.site.styleID = a;
					$.dmx.preview.wnd().jQuery.layoutManager.setCurrentVariation(a, commonProps);
					$.navigationUtil.clearNavShape($($.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav")));
					$.deselectAllEditableElements()
				}
			})
		},
		setCurrentVariation: function(a, e) {
			$.dmx.preview.wnd().jQuery.layoutManager.setCurrentVariation(a, commonProps, e || "mobile")
		},
		getCurrentVariation: function(a) {
			return $.dmx.preview.wnd().jQuery.layoutManager.getCurrentVariation(a || "mobile")
		},
		setCurrentLayout: function(a, e) {
			$.dmx.preview.wnd().jQuery.layoutManager.setCurrentLayout(a, e || "mobile")
		},
		getCurrentLayout: function(a) {
			return $.dmx.preview.wnd().jQuery.layoutManager.getCurrentLayout(a || "mobile")
		},
		setCurrentWidgetStyleID: function(a) {
			$.dmx.preview.wnd().jQuery.layoutManager.setCurrentWidgetStyleID(a)
		},
		getCurrentWidgetStyleID: function() {
			return $.dmx.preview.wnd().jQuery.layoutManager.getCurrentWidgetStyleID()
		},
		openPreviewPopup: function(a, e, d, g, j, k) {
			previewTimeout && clearTimeout(previewTimeout);
			a = a || $.dmx.site.alias;
			e = e || $.dmx.page.alias;
			d = $.dmx.page.isBFS ? "dmbfs": d || $.dmx.rt.liveUrl;
			j = j || $.dmx.site.id;
			g = g || $.dmx.site.devMobileUrl; ! a || !d || !e ? ($.dmBlockUI(null, !1), previewTimeout = setTimeout("$.dmfw.openPreviewPopup()", 1E3)) : null != $.dmx.site && "GDH" == $.dmx.site.dmProductType ? window.open("/site/" + a + "/" + e + "?dm_try_mode\x3dtrue\x26url\x3d" + encodeURIComponent(d), "_blank") : ($.dmUnblockUI(), $.dmfw.openPopupFromUrl("/editor/nee/mainTabs/nee.preview.jsp", {
				popupAdditionalClass: "neePreviewPopup",
				forceWidth: "1100px",
				forceHeight: "806px",
				init: function() {
					dm_not_saved && ($("#prmSend a").hide(), $("#prmSend").css("border-top", "none"));
					$("#neePrevieweviceWrapper").attr("class", "iPhone");
					$("#neePrevieweviceWrapper iframe").attr("src", "/site/" + a + "/" + e + "?preview\x3dtrue\x26dm_try_mode\x3dtrue\x26url\x3d" + encodeURIComponent(d));
					if (!0 == k) $("#prmSend").html("").css({
						height: "0",
						"border-top": "none"
					});
					else {
						var l = {
							mailType: "SHARE_SITE",
							siteAddress: g,
							siteId: j,
							msg: $("#neePreview .sendEmail #sendEmailMsg"),
							input: $("#neePreview .sendEmail input"),
							sendBtn: $("#neePreview .sendEmail #sendEmailButton")
						};
						$.dmops.sendSiteAddressMail(l)
					}
					$("#neePreview a").click(function(a) {
						a.preventDefault()
					})
				}
			}))
		},
		showChangeAssignedPagePopup: function(a, e) {
			$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/pages/nee.copyPageConfirmPopup.htm", {
				init: function(d) {
					$(d).find(".neeCopyPageConfirmTopText").html(dmStr["ui.nee.copyPagePopUp.1"].replace("%s", e.title));
					$(d).find(".continueEditPageText").html(dmStr["ui.nee.copyPagePopUp.2"].replace("%s", e.title));
					$(d).find(".editOriginalPageText").html(dmStr["ui.nee.copyPagePopUp.3"].replace("%s", e.title));
					$(d).find("#editOriginalPage").text(dmStr["ui.nee.copyPagePopUp.4"]);
					$(d).find("#continuEditPage").text(dmStr["ui.nee.copyPagePopUp.5"]);
					$(d).find("#continuEditPage").unbind("click").click(function() {
						a();
						d.close()
					});
					$(d).find("#editOriginalPage").unbind("click").click(function() {
						$.dmfw.previewNavigateTo({
							page: e
						});
						d.close()
					})
				},
				popupAdditionalClass: "copyPageConfirmPopupWrapper",
				disableDrag: !0
			})
		},
		openRepublishPopup: function(a) {
			function e(d) {
				d.find(".neeRepublishBigText").text(dmStr["ui.nee.upgradePopUp.4"]);
				d.find(".neeRepublishSmallText").text(dmStr["ui.nee.upgradePopUp.5"]);
				d.find(".neeYesRepublishBtn").text(dmStr["ui.nee.upgradePopUp.6"]).unbind("click").click(function() {
					$.dmsrv.publishSite(function() {
						a.callback && (a.callback(), d.close())
					})
				});
				d.find(".neeNoThanksBtn").unbind("click").click(function() {
					a.callback && (a.callback(), d.close())
				})
			}
			var d = $('\x3cdiv class\x3d"dmwrRepublishPopup"\x3e\x3cdiv class\x3d"neeRepublishPopupText"\x3e\x3cspan class\x3d"neeRepublishBigText"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan class\x3d"neeRepublishSmallText"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"neeRepublishPopupButtons"\x3e\x3cspan class\x3d"orangeBtn neeYesRepublishBtn"\x3e\x3c/span\x3e\x3cspan class\x3d"blueBtn neeNoThanksBtn"\x3e' + dmStr["ui.nee.publishPanel.1074"] + "\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e"),
			g = {};
			3 == accountLocale && (g.forceWidth = "400px");
			$.dmx.isPremium() ? (g.init = function(a) {
				e(a)
			},
			$.dmfw.openPopup(d, g)) : $.dmsrv.getSiteFeatures(function(j) {
				g.init = $.dmpub._hasFeatures(j.features) ?
				function(d) {
					d.find(".neeRepublishBigText").text(dmStr["ui.nee.upgradePopUp.1"]);
					d.find(".neeRepublishSmallText").text(dmStr["ui.nee.upgradePopUp.2"]);
					d.find(".neeYesRepublishBtn").text(dmStr["ui.nee.upgradePopUp.3"]).unbind("click").click(function() {
						$.dmfw.openPayment({
							token: "1stpublish",
							publish: !0
						})
					});
					d.find(".neeNoThanksBtn").unbind("click").click(function() {
						a.callback && (a.callback(), d.close())
					})
				}: function(a) {
					e(a)
				};
				$.dmfw.openPopup(d, g)
			})
		},
		adjustScreenHeight: function() {
			$.dmfw.isPT() ? $(".dmShellinnerWrapper").css("min-height", $(window).height() - 40 + "px") : $(".dmShellinnerWrapper").css("min-height", $(window).height() - 55 + "px")
		},
		refreshFBWidgets: function() {
			try {
				$.dmx.preview.wnd().FB.XFBML.parse()
			} catch(a) {}
		},
		showLoadingInEmulator: function() {
			$.dmops.scrollPreview(0);
			NEFW.PREVIEW.get(0).contentWindow.replaceWithLoading()
		},
		hideLoadingInEmulator: function(a) {
			$(".dmDrakedElement").remove();
			$.dmx.preview.wnd().jQuery.DM.setLoadingOnScreen(!1);
			a && a()
		},
		setEmulatorPremiumMode: function() {
			$.dmops.scrollPreview(0);
			var a = $('\x3cdiv class\x3d"dmEmulatorPremiumDarken"\x3e' + dmStr["ui.nee.golive.premium.1"] + "\x3c/div\x3e");
			$(".neePreview .dmPremiumDisplayMsg").remove();
			$.dmfw.darkenEmulator(1500, a, {
				top: 300,
				left: 55
			},
			function() {
				$.dmfw.getPreviewElement("#dmRoot").removeClass("dmEmulatorFree").addClass("dmEmulatorPremium");
				$.dmops.removeAds();
				$.dmx.site.isOwnerReseller && $.dmops.removePoweredBy()
			})
		},
		setEmulatorFreeMode: function() {
			$.dmops.scrollPreview(0);
			var a = $('\x3cdiv class\x3d"dmEmulatorFreeDarken"\x3e' + dmStr["ui.nee.golive.free.2"] + "\x3c/div\x3e");
			$.dmfw.darkenEmulator(1500, a, {
				top: 300,
				left: 70
			},
			function() {
				$.dmfw.getPreviewElement("#dmRoot").removeClass("dmEmulatorPremium").addClass("dmEmulatorFree");
				$.dmops.showAds();
				$.dmops.showPoweredBy();
				var a = $($.dmx.preview.wnd()).width();
				$.dmfw.showQTip({
					text: dmStr["ui.nee.golive.free.1"],
					selector: ".neePreview",
					style: {
						classes: "ui-tooltip-dm-ads-msg",
						width: a + "px"
					},
					position: {
						at: "top left",
						my: "top center",
						adjust: {
							x: a / 2 + 14,
							y: 80
						}
					},
					hide: {
						event: "click unfocus",
						fixed: !0,
						effect: function() {
							$(this).fadeOut("fast")
						}
					}
				});
				$($.dmx.preview.wnd()).unbind("scroll.emulatorPremium").bind("scroll.emulatorPremium",
				function() {
					$.dmfw.hideQTip({
						selector: ".neePreview"
					})
				})
			})
		},
		resetEmulatorPremiumMode: function() {
			$(".neePreview .dmPremiumDisplayMsg").remove();
			$.dmfw.hideQTip({
				selector: ".neePreview"
			});
			$.dmfw.getPreviewElement("#dmRoot").removeClass("dmEmulatorPremium").removeClass("dmEmulatorFree");
			$.dmx.site.isPublished || ($.dmops.removeAds(), $.dmx.site.isOwnerReseller && $.dmops.removePoweredBy())
		},
		hideQTip: function(a) {
			$(a.selector).qtip("toggle", !1)
		},
		hideAllQTips: function() {
			$.dmfw.hideQTip({
				selector: "*"
			})
		},
		showQTip: function(a) {
			var e = a.element || $(a.selector);
			a = $.extend({
				show: {
					solo: !1,
					event: !1,
					ready: !0,
					effect: function() {
						$(this).fadeIn("fast")
					}
				},
				hide: {
					event: "click",
					fixed: !0,
					effect: function() {
						$(this).fadeOut("slow")
					}
				},
				events: {},
				type: "info"
			},
			a);
			"error" == a.type && (a.style = "ui-tooltip-dm-error", a.events = a.events || {},
			a.events.visible || (a.events.visible = function(d, e) {
				a.dontHide || setTimeout(function() {
					e.hide()
				},
				3500)
			}), a.hide.event = "change keydown");
			return e.qtip({
				content: {
					text: a.text
				},
				show: a.show,
				position: a.position,
				hide: a.hide,
				events: a.events,
				style: a.style
			})
		},
		showPromptError: function(a, e, d) {
			$("#_editor").off("click.removePrompt").on("click.removePrompt", ".slideBtn, .editorCloser",
			function() {
				a.qtip("destroy")
			});
			FW_CONSTANTS.promptMessageTimeout && clearTimeout(FW_CONSTANTS.promptMessageTimeout);
			a && "" !== a && (d = d || {},
			d.destroy ? a.qtip("destroy") : a.eq(0).qtip({
				content: e,
				show: {
					event: !1,
					ready: !0,
					solo: !0
				},
				hide: {
					fixed: !0,
					when: {
						event: "click"
					}
				},
				position: {
					at: d.at || "center right",
					my: d.my || "center left",
					adjust: {
						x: d.adjustX || 0,
						y: d.adjustY || 0
					}
				},
				style: {
					width: d.maxWidth || "200px",
					classes: "promptStyle"
				}
			}), FW_CONSTANTS.promptMessageTimeout = setTimeout(function() {
				a.qtip("destroy")
			},
			3E3))
		},
		showValidationError: function(a, e, d, g) {
			var j = {
				at: "bottom center",
				my: "top center"
			};
			g && g.error_pos && (j = g.error_pos);
			a = $.extend({
				type: "error",
				selector: a,
				text: e,
				position: j,
				dontHide: !d
			},
			g);
			$.dmfw.showQTip(a)
		},
		darkenEmulator: function(a, e, d, g) {
			$.dmfw.getPreviewElement(".dm_wrapper").darkenPreviewElement(e, d);
			$.dmx.preview.wnd().jQuery.DM.setLoadingOnScreen(!0, [160, 200], !1, !0);
			setTimeout(function() {
				$.dmfw.getPreviewElement(".dmDrakedElement").remove();
				$.dmx.preview.wnd().jQuery.DM.setLoadingOnScreen(!1);
				g && g()
			},
			a)
		},
		toggleLayoutSkinnyHeader: function(a, e) {
			a ? $.dmx.preview.wnd().jQuery.layoutManager && $.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().fixHead && ($.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().fixHead.element.addClass("fixedHeaderLimitSize"), e && e()) : $.dmx.preview.wnd().jQuery.layoutManager && $.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().fixHead && ($.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().fixHead.element.removeClass("fixedHeaderLimitSize"), e && e())
		},
		getFromPreviewHistory: function() {
			try {
				return $.dmx.previewHistory ? ($.dmx.previewHistory.pop(), $.dmx.previewHistory.pop()) : null
			} catch(a) {
				return null
			}
		},
		addToPreviewHistory: function(a, e) {
			$.dmx.previewHistory || ($.dmx.previewHistory = []);
			if (0 < $.dmx.previewHistory.length) {
				var d = $.dmx.previewHistory.pop();
				d != a && !e && $.dmx.previewHistory.push(d)
			}
			$.dmx.previewHistory.push(a)
		},
		openPayment: function(a, e) {
			var d = null,
			d = !0 == jQuery.isEmptyObject($.dmx.site) ? e.id: $.dmx.site.id;
			a.token = $.dmfw.isPT() ? "pt." + a.token: "wr." + a.token;
			dm_account_withPaymentData ? $.dmfw.openOneclickPaymentForSite(a, e) : $.dmsrv.paymentUrl(d, a.token,
			function(a) {
				$(window).unbind("beforeunload");
				goToCrossDomainLink(a.value)
			},
			a)
		},
		openOneclickPaymentForSite: function(a, e) {
			a = a || {};
			var d = null,
			g = null,
			d = !0 == jQuery.isEmptyObject($.dmx.site) ? e.alias: $.dmx.site.alias,
			g = $.dmx.site.id;
			$.dmfw.openPopupFromUrl("/editor/payment/payment.oneclick.jsp?site\x3d" + d + "\x26returnTo\x3d" + a.token + (a.contract ? "\x26contract\x3d" + a.contract: ""), {
				forceWidth: "626px",
				init: function() {
					$("#redirect-now").length && $.dmReloadWindow($("#redirect-now").attr("href"));
					$(".closeThis").css("visibility", "visible");
					var d = $("#oneclickPlanSel").find(":selected");
					$("#oneClickPrice").text(d.data("currency") + d.attr("data-price"));
					$("#oneclickCont1 select").change(function() {
						d = $("#oneclickPlanSel").find(":selected");
						$("#oneClickPrice").text(d.data("currency") + d.attr("data-price"))
					});
					$("#oneclickPurcahse").click(function() {
						$.dmBlockUI();
						var e = "/payment/sites/" + g + "/purchase?contractId\x3d" + d.data("contractid");
						a.publish && (e += "\x26publish\x3dtrue");
						if (a) {
							var l = $("#oneclickPurcahse").text();
							$("#oneclickPurcahse").text(dmStr["ui.payment.processing"]);
							$("#oneclickPurcahse").addClass("loadingBtn");
							$.dmPost({
								url: e,
								success: function(e) {
									$.dmUnblockUI();
									$("#oneclickOrderNumber").empty().text(e.orderID);
									$("#oneClickRecurrence").empty().append(e.recurenceHtmlMsg);
									$("#oneclickDesc").empty().text(d.text());
									$("#oneInvoiceTotal").empty().append(e.invoice.currency.codeAsHtml + e.invoice.total);
									$(".closeThis").css("visibility", "hidden");
									$("#oneclickSuccess").show();
									$("#oneclickForm").hide();
									$.dmx.site.planId = e.updatedSitePlan;
									wrTrackEvent(SITE_UPGRADED);
									wrTrackEvent(WR_SITE_PREMIUM_PURCHASED, {
										oneclick: "true",
										total: e.invoice.total
									});
									optimizelyTrackEvent("sitePurchased");
									try {
										dmTrackEcommerce({
											orderId: e.invoice.id,
											total: e.invoice.total,
											customer: {
												city: e.invoice.customerCity,
												state: e.invoice.customerState,
												country: e.invoice.customerCountry
											}
										},
										{
											contract: e.invoice.contractName,
											product: e.invoice.productName,
											total: e.invoice.total,
											quantity: 1
										})
									} catch(g) {}
									$("#oneclickDone").click(function() {
										$(".closeThis").click();
										if (a.token.startsWith("pt.") && $.ptShellContr) try {
											$.ptShellContr._initUpgradeSave()
										} catch(d) {}
										switch (a.token) {
										case "dashboard":
										case "pt.dashboard":
										case "wr.dashboard":
											window.location.reload();
											break;
										case "publish":
										case "pt.publish":
										case "wr.publish":
											$.dmfw.isPT() ? $.ptShellContr.navigateToTab(PT_PUBLISH_ID) : ($("#navredirect").removeClass("neeStepsMenuDisbaled"), NEFW.navigateToTabWithHistory(NAV_PUBLISH_ID, $.dmx.site.alias));
											break;
										case "1stpublish":
										case "pt.1stpublish":
										case "wr.1stpublish":
											$.dmx.firstPublished = !0;
											$.dmfw.isPT() ? $.ptShellContr.navigateToTab(PT_PUBLISH_ID) : ($("#navredirect").removeClass("neeStepsMenuDisbaled"), NEFW.navigateToTabWithHistory("refresh", $.dmx.site.alias));
											break;
										case "pt.connect":
											$.dmredi.parameters.nextTimeUseBfsConnectScreen = !0;
											$.ptAccordContr._openTabRedirect();
											break;
										case "settings":
										case "pt.settings":
										case "wr.settings":
											window.location = "/home#wr@settings@" + $.dmx.site.alias;
											break;
										case "pt.redirect":
											$.ptAccordContr._openTabRedirect();
											break;
										case "redirect":
										case "wr.redirect":
											window.location = "/home#wr@redirect@" + $.dmx.site.alias
										}
									})
								},
								error: function() {
									var a;
									a = l;
									$("#oneclickPurcahse").text(a);
									$("#oneclickPurcahse").removeClass("loadingBtn");
									$.dmUnblockUI();
									$("#oneclickError").show();
									$("#oneclickForm").hide();
									return ! 0
								}
							})
						}
					})
				}
			})
		},
		openOneclickPaymentForAccount: function(a) {
			a = a || {};
			$.dmfw.openPopupFromUrl("/editor/payment/payment.oneclick.jsp?type\x3d" + a.type + "\x26returnTo\x3d" + a.token + (a.contract ? "\x26contract\x3d" + a.contract: ""), {
				forceWidth: "626px",
				init: function() {
					$("#redirect-now").length && $.dmReloadWindow($("#redirect-now").attr("href"));
					$(".closeThis").css("visibility", "visible");
					var e = $("#oneclickPlanSel").find(":selected");
					$("#oneClickPrice").text(e.data("currency") + e.attr("data-price"));
					$("#oneclickCont1 select").change(function() {
						e = $("#oneclickPlanSel").find(":selected");
						$("#oneClickPrice").text(e.data("currency") + e.attr("data-price"))
					});
					$("#oneclickPurcahse").click(function() {
						$.dmBlockUI();
						var d = "/payment/account/purchase?contractId\x3d" + e.data("contractid");
						if (a) {
							var g = $("#oneclickPurcahse").text();
							$("#oneclickPurcahse").text(dmStr["ui.payment.processing"]);
							$("#oneclickPurcahse").addClass("loadingBtn");
							$.dmPost({
								url: d,
								success: function(d) {
									$.dmUnblockUI();
									$("#oneclickOrderNumber").empty().text(d.orderID);
									$("#oneClickRecurrence").empty().append(d.recurenceHtmlMsg);
									$("#oneclickDesc").empty().text(e.text());
									$("#oneInvoiceTotal").empty();
									d.invoice && d.invoice.currency && $("#oneInvoiceTotal").append(d.invoice.currency.codeAsHtml + d.invoice.total);
									$(".closeThis").css("visibility", "hidden");
									$("#oneclickSuccess").show();
									$("#oneclickForm").hide();
									$("#oneclickDone").click(function() {
										$(".closeThis").click();
										window.location.href = "/home?paymentInProcess\x3d" + a.type
									})
								},
								error: function() {
									var a;
									a = g;
									$("#oneclickPurcahse").text(a);
									$("#oneclickPurcahse").removeClass("loadingBtn");
									$.dmUnblockUI();
									$("#oneclickError").show();
									$("#oneclickForm").hide();
									return ! 0
								}
							})
						}
					})
				}
			})
		},
		generateDMid: function() {
			return parseInt(1E9 + 1E9 * Math.abs(Math.random(0, 1E9)))
		}
	}
});
var _commonCfg = {};
$.extend({
	dmops: {
		scrollPreview: function(a, e, d) {
			null == e && (e = 500);
			if ($.browser.mozilla || $.browser.msie) $($.dmx.preview.wnd()).scrollTop(a),
			null != d && d();
			else {
				var g = "body, html";
				$.dmx.preview.wnd().$.DM.isBodyScrollable() || (g = "#iscrollBody");
				$.dmfw.getPreviewElement(g).animate({
					scrollTop: a
				},
				e,
				function() {
					null != d && d()
				})
			}
		},
		scrollPreviewToElement: function(a, e, d) {
			$.dmx.preview.wnd().jQuery.DM.scrollPreviewToElement(a, e, d)
		},
		applyPattern: function(a, e, d, g) {
			$.dmUIBlockControlled({
				region: "table.modify",
				op: "block",
				style: "wheel"
			});
			$.dmsrv.postToServ(function() {
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/changePatternDisplay/?elementId\x3d" + a.dmid(),
					data: {
						currentUrl: $.dmx.rt.liveUrl,
						item: e,
						designStyle: d
					},
					success: function(e) {
						var k = a,
						l = k.is(".dmLocked");
						e = $("\x3cdiv\x3e\x3c/div\x3e").append(e.value);
						var m = e.children(":not(.dmCustomHtml)").eq(0);
						if ("ot" == d || "reset" == d) m = e.children("table:not(.dmCustomHtml)").eq(0);
						k.replaceWith(m);
						k = m;
						k.attr("duda_id") || k.attr("duda_id", k.attr("id"));
						l && (k.selectElement(), k.lockElement());
						k.find("*").each(function() {
							$(this).attr("duda_id") || $(this).attr("duda_id", $(this).attr("id"))
						});
						k.html(k.html());
						"sdt" === d && $.dmx.preview.wnd().jQuery.DM.initSmartTables();
						setTimeout(function() {
							NEFW.PREVIEW.get(0).contentWindow.styleImages();
							$.dmx.current.editable.inlineEditor.draw()
						},
						120);
						$.dmUIBlockControlled({
							region: "table.modify",
							op: "unblock"
						});
						$.dmNotify("Shape changed");
						g && g()
					}
				})
			},
			!0)
		},
		createPageWithCheck: function(a) {
			try {
				var e = a && a.force ? !0 : !1;
				if ($.dmx.page.isBFS || !e && $.dmx.rt.isPageEqualToLiveUrl && $.dmx.page.alias != DEFAULT_PAGE_DESIGN_ALIAS) return {
					pageCreated: !1
				};
				var d = {};
				d.pageUrl = $.dmx.rt.liveUrl;
				a && a.pageUrl && (d.pageUrl = a.pageUrl);
				d.success = function(e) {
					$.dmx.locks.removeLockOnObject(d.pageUrl);
					$.dmops.updateEditContext.page(e);
					$.dmx.rt.isPageEqualToLiveUrl = !0;
					a.success && a.success(e)
				};
				a.error && (d.error = a.error);
				d.systemError = function(e) {
					$.dmx.locks.removeLockOnObject(d.pageUrl);
					a.systemError && a.systemError(e)
				};
				d.suggestedAlias = null;
				a && a.suggestedAlias && (d.suggestedAlias = a.suggestedAlias);
				d.setAsTemplate = !1;
				a && a.setAsTemplate && (d.setAsTemplate = a.setAsTemplate);
				if ($.dmx.locks.hasLockOnObject(d.pageUrl)) return {
					pageCreated: !1,
					error: !0,
					duplicateRequest: !0
				};
				$.dmx.locks.setLockOnObject(d.pageUrl);
				$.dmops.createPage(d);
				return {
					pageCreated: !0
				}
			} catch(g) {
				return $.dmx.locks.removeLockOnObject(d.pageUrl),
				$.logEx(g),
				{
					pageCreated: !1,
					error: !0
				}
			}
		},
		createPageBlank: function(a) {
			$.dmUIBlockControlled({
				region: "createPageBlank",
				op: "block",
				style: a.loadingStyle ? a.loadingStyle: "wheel"
			});
			a.siteId || (a.siteId = $.dmx.site.id);
			var e = {
				suggestedAlias: a.suggestedAlias,
				addToNav: a.addToNav,
				templateName: a.templateName
			};
			a.pageUrl && (e.pageUrl = a.pageUrl);
			a.dontMobilize && (e.dontMobilize = !0);
			a.pageTitle && (e.pageTitle = a.pageTitle);
			$.dmPost({
				url: "/sites/" + a.siteId + "/createpagefromscratch",
				data: e,
				success: function(d) {
					a.skipContextRefresh ? a.success && a.success(d) : $.dmops.updateEditContext.all({
						success: function() {
							a.success && a.success(d)
						}
					});
					$.dmUIBlockControlled({
						region: "createPageBlank",
						op: "unblock"
					})
				},
				error: function(d) {
					if (a.error) return a.error(d)
				}
			})
		},
		createPage: function(a) {
			a = a || {};
			var e = a.setAsTemplate;
			try {
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/createpage",
					data: {
						pageUrl: a.pageUrl,
						suggestedAlias: a.suggestedAlias,
						setAsTemplate: e
					},
					success: function(d) {
						$.dmops._addNewPage(d);
						a.skipContextUpdate || $.dmops.updateEditContext.page(d);
						_DragManager.element && (_DragManager.dragFromPage = d.id);
						a.success && a.success(d)
					},
					error: function(d) {
						try {
							switch (a.systemError && a.systemError(d), d.error_code) {
							case "PageNotAvailable":
								return $.showError("PageNotAvailable", {
									pageUrl: a.pageUrl
								}),
								!0;
							case "ResourceAlreadyExist":
								return $.showError("ResourceAlreadyExist", {
									pageUrl: a.pageUrl
								}),
								!0;
							default:
								return a.error ? a.error(d) : null
							}
						} catch(e) {
							return null
						}
					}
				})
			} catch(d) {
				a.systemError && a.systemError(d),
				$.logEx(d)
			}
		},
		updateEditContext: {
			site: function(a) {
				a = a || {};
				var e = "/sites/byalias/" + (a.siteAlias || $.dmx.site.alias) + "?withPlans\x3dtrue";
				a.withRedirect && (e += "\x26withRedirect\x3dtrue");
				$.dmGet({
					url: e,
					success: function(d) {
						$.dmx.site = d;
						var e = $.dmx.site.webPlatform,
						j = $.dmx.site.compatible_platforms ? $.dmx.site.compatible_platforms.toUpperCase() : "";
						$.dmx.site.isBlog = "BLOG" === e.type ? !0 : !1;
						$.dmx.site.isBlogCompatible = "BLOGGER" === j || "WORDPRESS" === j ? !0 : !1;
						a.success && a.success(d)
					}
				})
			},
			reset: function() {
				$.dmx.page = null
			},
			clientOnly: function(a) {
				if ($.dmx.site && $.dmx.site.alias == a.siteAlias && a.pageAlias) {
					var e = $.dmx.getPageByField("alias", a.pageAlias);
					if (e) {
						$.dmx.page = e;
						$.dmx.rt || ($.dmx.rt = {});
						void 0 != a.isPageEqualToLiveUrl && ($.dmx.rt.isPageEqualToLiveUrl = a.isPageEqualToLiveUrl, $.dmx.rt.isPageOutOfSync = a.isPageOutOfSync);
						a.pageUrl && ($.dmx.rt.liveUrl = a.pageUrl);
						a.success && a.success();
						return
					}
				}
				$.dmops.updateEditContext.all(a)
			},
			all: function(a) {
				a = $.extend({
					siteAlias: $.dmx.site.alias,
					pageAlias: $.dmx.page ? $.dmx.page.alias: null
				},
				a);
				if (a.siteAlias) {
					$.dmx.rt || ($.dmx.rt = {});
					void 0 != a.isPageEqualToLiveUrl && ($.dmx.rt.isPageEqualToLiveUrl = a.isPageEqualToLiveUrl, $.dmx.rt.isPageOutOfSync = a.isPageOutOfSync);
					var e = function(d) {
						try {
							a.pageUrl && ($.dmx.rt.liveUrl = a.pageUrl),
							$.dmUIBlockControlled({
								region: "_updateEditContext.all",
								op: "unblock",
								msg: " "
							}),
							a.success && a.success()
						} catch(e) {}
						d.success && d.success()
					};
					$.dmUIBlockControlled({
						region: "_updateEditContext.all",
						op: "block",
						msg: " "
					});
					$.dmSynchronize({
						region: "_updateEditContext.all",
						exec: function(d, g) {
							if ((d || a.useCache) && $.dmx.site.alias == a.siteAlias && $.dmx.page.alias == a.pageAlias) return e(g);
							$.dmGet({
								url: "/sitepage/" + a.siteAlias + (a.pageAlias ? "/" + a.pageAlias: "") + (a.checkPremium ? "?checkPremium\x3dtrue": ""),
								success: function(a) {
									$.dmx.set(a);
									e(g);
									$.dmops.prefetch()
								},
								error: function(a) {
									var d = function(a) {
										a = a || {};
										return $(a.markup || "\x3cdiv class\x3d'neeGDWSTUCStatusPopup'\x3e\x3cdiv class\x3d'topText'\x3eSorry...\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3e" + a.message + "\x3c/div\x3e\x3c/div\x3e")
									},
									e = function() {
										return {
											init: function() {},
											dontCloseAutomatically: !0,
											disableDrag: !0,
											popupAdditionalClass: "neeGDWSTUCStatusPopupWrapper"
										}
									};
									try {
										switch (a.error_code) {
										case "PageWithFramesetNotSupported":
											return $.dmfw.openPopup(d({
												message:
												"your website uses unsupported HTML framesets."
											}), e()),
											!0;
										case "SiteTooBig":
											return $.dmfw.openPopup(d({
												message:
												"this website is too big to be mobilized."
											}), e()),
											!0;
										default:
											return g.error ? g.error(a) : null
										}
									} catch(m) {
										return null
									}
								}
							})
						}
					})
				} else $.log("Can't update context: site alias is miising.")
			},
			page: function(a) {
				$.dmx.page = a;
				0 == $(".neeDraggingNow").length ? (neeHistoryManager.clearAndUpdateServer(), neeHistoryManager.clearClient({
					saveLast: !0
				})) : (neeHistoryManager.clearAndUpdateServer(), $.dmx.events.unbind("dragFinish.clearHistory").bind("dragFinish.clearHistory",
				function() {
					neeHistoryManager.clearAndUpdateClient({
						saveLast: !0
					});
					neeHistoryManager.updateServer();
					$.dmx.events.unbind("dragFinish.clearHistory")
				}))
			}
		},
		deleteElements: function(a, e, d) {
			var g = [],
			j = [];
			d = d || {};
			for (var k = 0; k < a.length; k++) {
				var l = a[k];
				j.push($(l));
				$(l).next()
			}
			for (k = 0; k < j.length; k++) g.push(j[k].dmid());
			var m = j[0],
			n = $.dmx.currentPage(m);
			$.changePage({
				clientChange: function() {
					if (!d.otherPagesOnly) {
						d.dontCloseEditor || $.dmfw.closeEditor({
							override: !0
						});
						n = $.dmx.currentPage(m);
						for (var a = 0; a < j.length; a++) j[a].remove();
						e && e();
						$.dmops.checkEmptyContent()
					}
				},
				serverChange: function() {
					if (d.allPages) {
						var a = "/pages/" + $.dmx.currentPage(m) + "/deleteElements/?allPages\x3d" + d.allPages + (d.otherPagesOnly ? "\x26otherPagesOnly\x3dtrue": "");
						$.dmPostWithHistoryAllPages({
							url: a,
							data: g,
							success: function() {
								$.dmNotify("Elements deleted.")
							}
						})
					} else a = "/pages/" + n + "/deleteElements/",
					$.dmPostWithHistory({
						url: a,
						data: g,
						success: function() {
							$.dmNotify("Elements deleted.")
						}
					})
				}
			})
		},
		deleteElement: function(a, e, d, g) {
			g = g || {};
			var j = null,
			k = a.next();
			null == d && (d = !0);
			k.is("[dmle_clear\x3d'true']") && (j = k);
			var l = $(a),
			m = $.dmx.currentPage(l);
			$.changePage({
				noHistory: void 0 == g.noHistory ? !1 : g.noHistory,
				clientChange: function() {
					d && $.dmfw.closeEditor({
						override: !0
					});
					m = $.dmx.currentPage(l);
					l.remove();
					e && e();
					$.dmops.checkEmptyContent()
				},
				serverChange: function() {
					var a = {
						url: "/pages/" + m + "/deleteElement/" + l.dmid(),
						success: function() {
							null != j && j.remove();
							if (g.onServerDone) g.onServerDone();
							$.dmNotify("Element deleted.")
						}
					};
					g.noHistory ? $.dmPost(a) : $.dmPostWithHistory(a)
				}
			})
		},
		redrawSelection: function() {
			var a = $.dmfw.getPreviewElement(".dmLocked , .inlineEditorEditedElement");
			0 < a.length && a.editable() && (a.editable().inlineEditor ? a.editable().inlineEditor.redraw(a) : $.dmx.current.editable.inlineEditor.draw(a));
			$.dmfw.isDudaone() && $.respUtils.redrawBars();
			var e = $.dmx.preview.getRedrawListeners();
			e && $.each(e,
			function(d) {
				e[d](a)
			})
		},
		checkEmptyContent: function() {
			$.dmfw.preview.testAndSetPlaceholder(".dmContent", "dmContentPlaceholder");
			$.dmfw.preview.testAndSetPlaceholder(".dmBody", "dmContentPlaceholder");
			$.dmfw.preview.testAndSetPlaceholder(".dmNewParagraph", "dmParagraphPlaceholder");
			$.dmfw.preview.testAndSetPlaceholder(".dmColumn \x3e .left, .dmColumn \x3e .right", "dmParagraphPlaceholder");
			$.dmfw.preview.testAndSetPlaceholder(".dmtabscont  \x3e div", "dmParagraphPlaceholder");
			$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder")
		},
		checkEmptyTitle: function() {
			$.dmfw.preview.testAndSetPlaceholder(".dm-title", "dmdmTitlePlaceholder")
		},
		handleNavIcon: function(a, e, d, g, j) {
			var k, l = g.linkdesign ? "linkdesign": "linkDesign";
			k = g[l].itemIcon;
			if (a) {
				g[l].itemIcon = a;
				for (var m = 0; m < g[l].backgroundCSS.length; m++) g[l].backgroundCSS[m] = g[l].backgroundCSS[m].replace(k, a)
			}
			$.dmfw.isDudaone() ? (k = $.dmfw.editables("navigation"), (k = k.getSelectors(!0)) && k.singleItem ? (k = k.singleItem + "." + g[l].itemClassName, k = k + " .navIcon, " + k + " .navItemIcon") : k = defaultItemselector + " .navIcon, *.navPlaceHolder UL.dmNav.dmNavCustom li a .navItemIcon") : k = $.dmfw.isPT() ? "dmHome" !== g[l].itemClassName ? "*.navPlaceHolder UL.dmNav.dmNavCustom li a." + g[l].itemClassName + " DIV.navIcon": "#dm *.navPlaceHolder a.dmHome.backToHome SPAN.icon": "dmHome" !== g[l].itemClassName ? "li a." + g[l].itemClassName + " *.navIcon": "#dm *.navPlaceHolder a.dmHome.backToHome SPAN.icon";
			var m = "url(" + a + ")",
			n = g.originalid ? "originalid": "elementID";
			g[l].navColor = e;
			return j.fontIcon ? $.dmops.changeFontIcon({
				iconName: a,
				changeGlobally: !0,
				selector: k,
				elementToChange: null,
				elementId: g[n].replace("_item", "a"),
				changeInHeader: [!0],
				dontCollapseNavigation: !0,
				color: e
			}) : $.dmops.changeIcon({
				isUserImg: j.isUserImg,
				isCoreImg: j.isCoreImg,
				BGImage: m,
				color: e,
				name: d,
				selector: k,
				elementToChange: null,
				changeGlobally: !0,
				elementId: g[n].replace("_item", "a"),
				changeInHeader: [!0],
				dontCollapseNavigation: !0,
				iconBG: m,
				noCurrent: !0
			})
		},
		removeFontIcon: function(a) {
			if (a && a.size()) for (var e = a.attr("class"), e = e ? e.split(" ") : [], d = 0; d < e.length; d++) {
				var g = e[d]; ($.isIconClass(g) || "hasFontIcon" === g) && a.removeClass(g)
			}
		},
		changeFontIcon: function(a) {
			a = a || {};
			var e = a.selector,
			d = a.elementToChange;
			a.changeGlobally || (e = "span.icon");
			a.color = a.color || "#000000";
			updateCssContext = {
				elementId: a.elementId,
				changeInHeader: a.changeInHeader,
				classesToRemove: ["dmUserImg"],
				attrToRemove: ["dmIconName", "dmColor"],
				classesToAdd: ["dmCoreImg"],
				attrToAdd: [{
					attr: "background-image",
					value: "none"
				},
				{
					attr: "color",
					value: a.color
				}]
			};
			a.iconName && (updateCssContext.attributesToAddToElement = [{
				attr: "icon-name",
				value: a.iconName
			}]);
			var g = function(d) {
				d && a.iconName && d.each(function(d, e) {
					var g = $(e);
					$.dmops.removeFontIcon(g);
					g.addClass(a.iconName);
					g.addClass("hasFontIcon");
					var j = {
						dmMore: "dmmoreicon",
						dmLess: "dmlessicon"
					} [g.parents("li:first").attr("id")];
					j && (0 == $.dmfw.getPreviewElement("[" + j + "]").size() && $.dmfw.getPreviewElement(".dmNav").attr(j, a.iconName), $.dmfw.getPreviewElement("[" + j + "]").attr(j, a.iconName), g.parents("a:first").attr("icon-name", a.iconName))
				})
			};
			return a.changeGlobally ? $.dmops.updateGlobalCssAndElement(updateCssContext, {
				className: a.forceClassName ? a.forceClassName: a.selector,
				clientOnly: !1,
				dontCollapseNavigation: a.dontCollapseNavigation,
				clientElementChange: g
			}) : $.dmops.updateCurrentCss(updateCssContext, {
				element: d,
				selector: e,
				clientChange: function(a) {
					updateCssContext.classesToRemove && d.removeClass(updateCssContext.classesToRemove.join(" "));
					updateCssContext.classesToAdd && d.addClass(updateCssContext.classesToAdd.join(" "));
					updateCssContext.attributesToRemoveFromElement && $.each(updateCssContext.attributesToRemoveFromElement,
					function(a, e) {
						d.removeAttr(e)
					});
					updateCssContext.attributesToAddToElement && $.each(updateCssContext.attributesToAddToElement,
					function(a, e) {
						d.attr(e.attr, e.value)
					});
					g(a)
				}
			})
		},
		changeIcon: function(a) {
			a = a || {};
			var e = a.selector,
			d = a.elementToChange,
			g = d,
			j = $.dmx.current.element;
			if (!a.noCurrent && (j.find(".icon").hasClass("hasFontIcon") || "none" != j.find(".icon").css("background-image") && null != j.find(".icon").css("background-image"))) e = "span.icon",
			g = j.find(".icon");
			if (a.iconBG) g = a.iconBG;
			else var g = g.hasClass("hasFontIcon") ? "url()": g.css("background-image"),
			j = g.indexOf("url(") + 4,
			k = g.indexOf(")"),
			g = g.substr(0, j) + a.BGImage + g.substr(k);
			updateCssContext = {
				elementId: a.elementId,
				changeInHeader: a.changeInHeader,
				classesToRemove: a.isUserImg ? ["dmCoreImg"] : ["dmUserImg"],
				attrToRemove: a.isUserImg ? ["dmIconName", "dmColor"] : [],
				classesToAdd: a.isUserImg ? ["dmUserImg"] : ["dmCoreImg"],
				attributesToRemoveFromElement: ["icon-name"],
				attrToAdd: a.isUserImg ? [{
					attr: "background-image",
					value: g
				}] : [{
					attr: "background-image",
					value: g
				},
				{
					attr: "dmIconName",
					value: "url(" + a.name + ")"
				},
				{
					attr: "dmColor",
					value: "url('" + a.color + "')"
				}]
			};
			g = function(d) {
				d && d.each(function(d, e) {
					var g = $(e);
					$.dmops.removeFontIcon(g);
					var j = a.isUserImg ? "dmUserImg": "dmCoreImg",
					k = a.isUserImg ? "dmCoreImg": "dmUserImg";
					g.is("div." + j) && !g.parents("a:first").is("." + j) && g.parents("a:first").addClass(j).removeClass(k)
				})
			};
			return a.changeGlobally ? $.dmops.updateGlobalCssAndElement(updateCssContext, {
				className: a.forceClassName ? a.forceClassName: a.selector,
				clientOnly: !1,
				dontCollapseNavigation: a.dontCollapseNavigation,
				clientElementChange: g
			}) : $.dmops.updateCurrentCss(updateCssContext, {
				element: d,
				selector: e,
				clientChange: function() {
					$.dmops.removeFontIcon(d.find(e + ", .hasFontIcon"));
					updateCssContext.classesToRemove && d.removeClass(updateCssContext.classesToRemove.join(" "));
					updateCssContext.classesToAdd && d.addClass(updateCssContext.classesToAdd.join(" "));
					updateCssContext.attributesToRemoveFromElement && $.each(updateCssContext.attributesToRemoveFromElement,
					function(a, e) {
						d.removeAttr(e)
					});
					updateCssContext.attributesToAddToElement && $.each(updateCssContext.attributesToAddToElement,
					function(a, e) {
						d.attr(e.attr, e.value)
					})
				}
			})
		},
		updateGlobalCssAndElement: function(a, e) {
			var d = $.Deferred();
			e = e || {};
			var g = e.className;
			if (g) {
				e.clientOnly || $.dmPreviewSaving();
				var j = $.dmfw.getPreviewElement(g);
				j.clearStyle(a);
				var k = [];
				j.each(function(a) {
					k[a] = $(this).attr("style") ? $(this).attr("style") : ""
				});
				if (e.clientOnly) j.changeCss(a),
				$.dmops.redrawSelection();
				else {
					j.changeCss(a);
					e.clientElementChange && e.clientElementChange(j);
					if (a.elementId) {
						var l = $.dmfw.getPreviewElement("#" + a.elementId);
						a.classesToAdd && l.addClass(a.classesToAdd.join(" "));
						a.classesToRemove && l.removeClass(a.classesToRemove.join(" "));
						a.attributesToRemoveFromElement && $.each(a.attributesToRemoveFromElement,
						function(a, d) {
							l.removeAttr(d)
						});
						a.attributesToAddToElement && $.each(a.attributesToAddToElement,
						function(a, d) {
							l.attr(d.attr, d.value)
						})
					}
					$.dmx.current.editable && $.dmx.current.editable.inlineEditor && $.dmx.current.editable.inlineEditor.draw();
					$.dmsrv.postToServ(function() {
						$.dmsrv.updateGlobalCSS(g, a,
						function() {
							for (var m = [], n = "", l = 0; l < a.attrToAdd.length; l++) {
								var r = a.attrToAdd[l].value,
								u = a.attrToAdd[l].attr;
								m.push({
									key: u,
									value: r
								});
								n = n + u + ": " + r + ";"
							}
							a.elementId && (a.classesToAdd = null, a.classesToRemove = null);
							NEFW.PREVIEW.get(0).contentWindow.updateCss(g, n, m, !0);
							e.dontCollapseNavigation || $.dmx.preview.wnd().initComponents(!0);
							j.attr("style",
							function(a) {
								return a < k.length ? k[a] : ""
							});
							d.resolve();
							e.success && e.success();
							$.dmx.current.editable && $.dmx.current.editable.inlineEditor && $.dmx.current.editable.inlineEditor.draw();
							$.dmPreviewSaved()
						})
					})
				}
			}
			return d.promise()
		},
		updateCurrentCss: function(a, e) {
			var d = $.Deferred();
			e = e || {};
			e.clientOnly || $.dmPreviewSaving();
			var g = e.element || $.dmx.current.element,
			j = e.tagName || g.get(0).nodeName.toLowerCase(),
			k = e.selector || null,
			l = e.notClearStyle ? !1 : !0,
			m = function() {
				e.clientChange && e.clientChange(elementToChange);
				elementToChange.changeCss(a);
				$.dmops.redrawSelection();
				e.afterClientChange && e.afterClientChange()
			};
			elementToChange = k ? g.find(k) : g;
			elementToChange = $(elementToChange);
			$(elementToChange).clearStyle(a);
			var n = [];
			elementToChange.each(function() {
				n.push($(this).attr("style") || "")
			});
			e.clientOnly ? m() : $.changePage({
				clientChange: function() {
					e.changeOnlyOnReturnFromServer ? $.dmUIBlockControlled({
						region: "cssChange",
						op: "block",
						style: "wheel"
					}) : m()
				},
				serverChange: function() {
					var o;
					e.deviceSpecific && (o = $.onefw ? $.onefw.device() : null);
					$.dmsrv.updateCSS(g, a, j, k,
					function(a) {
						e.changeOnlyOnReturnFromServer && (m(), $.dmUIBlockControlled({
							region: "cssChange",
							op: "unblock"
						}));
						$.dmops.refreshPageStyleCss(a.page, $.dmx.isHeader(g));
						a.device && "" != a.device && $.dmops.refreshPageStyleDeviceCss(a.device, $.dmx.isHeader(g));
						l && elementToChange.each(function(a) {
							$(this).attr("style", n[a])
						});
						d.resolve();
						e.success && e.success();
						$.dmops.redrawSelection();
						$.dmPreviewSaved()
					},
					{
						device: o,
						classes: e.classes || ""
					})
				}
			});
			return d.promise()
		},
		refreshGlobalCss: function(a, e) {
			var d = NEFW.PREVIEW.get(0).contentWindow;
			d.refreshGlobalCss(a, e || 0)
		},
		refreshGlobalCssThemeOnly: function(a) {
			NEFW.PREVIEW.get(0).contentWindow.refreshGlobalCssInternal(a, 0, !0)
		},
		refreshGlobalAndThemeCss: function(a, e) {
			NEFW.PREVIEW.get(0).contentWindow.refreshGlobalAndThemeCssInternal(a, e, 10)
		},
		refreshPageStyleCss: function(a, e) {
			NEFW.PREVIEW.get(0).contentWindow.refreshPageStyleCss(a, 0, e)
		},
		refreshPageStyleDeviceCss: function(a, e) {
			NEFW.PREVIEW.get(0).contentWindow.refreshPageStyleDeviceCss(a, 0, e)
		},
		updateCurrentAttributes: function(a, e) {
			e = e || {};
			var d = e.element || $.dmx.current.element;
			$.changePage({
				clientChange: function() {
					a.attrToAdd && $.each(a.attrToAdd,
					function(a, e) {
						d.attr(a, e)
					});
					a.attrToRemove && $.each(a.attrToRemove,
					function(a, e) {
						d.removeAttr(e)
					});
					$.dmops.redrawSelection()
				},
				serverChange: function() {
					$.dmsrv.updateElementAttributes(d, a)
				}
			})
		},
		_insertClearWidget: function(a, e) {
			$.changePage({
				clientChange: function() {},
				serverChange: function() {
					$.dmPostWithHistory({
						url: "/pages/" + e.pageId + "/insertElement",
						data: {
							markup: "\x3cspan duda_id\x3d'" + a.dmid() + "_clear' id\x3d'" + a.dmid() + "_clear' class\x3d'dmWidgetClear' dmle_clear\x3d'true'\x3e\x3c/span\x3e",
							parent: a.parent().dmid(),
							before: a.next().dmid()
						}
					});
					a.after("\x3cspan duda_id\x3d'" + a.dmid() + "_clear' class\x3d'dmWidgetClear' dmle_clear\x3d'true'\x3e\x3c/span\x3e")
				}
			})
		},
		insertElements: function(a, e, d, g) {
			$.dmfw.getPreviewElement("#dm").length && null != $.dmx.page && $.changePage({
				element: d,
				serverChange: function() {
					$.dmPreviewSaving();
					g = $.extend({},
					{
						pageId: a.pageID,
						openEditor: !1
					},
					g || {});
					console.log("*** amir " + g.pageId);
					$.dmPostWithHistory({
						url: "/pages/insertElements",
						data: a,
						success: function(a) {
							a = a.results;
							$.dmUndo.set(!0);
							if (!a || 0 == a.length) $.dmUnblockUI(),
							$.dmNotify("error inserting element");
							else if (null != a && 0 < a.length) for (var k = 0; k < a.length; k++) {
								var l = a[k],
								m = e[k],
								n = m.insertBefore,
								o = d;
								l.element = $(l.element);
								n && n.length && n.dmid() == o.dmid() ? o.prepend(l.element) : n && n.length ? n.before(l.element) : o && o.append(l.element);
								m.addClearWidget && $.dmops._insertClearWidget(elm, g);
								0 < l.element.length && (l.element = $(l.element[0])); ! 0 != g.skipEditableAfterInsert ? m.afterInsert && m.afterInsert(l.element) : g.afterInsert && g.afterInsert(l.element);
								0 < l.element.find("[dmle_actual_insert]").length && (l.element = l.element.find("[dmle_actual_insert]"));
								l.element.attr("class", l.element.attr("class"));
								$.dmops.checkEmptyContent();
								m.noSelectionInsert || l.element.selectElement({
									noEffect: !0
								});
								l.wrapperID && l.newWrapperID && (l.element.parent().contents().get(0) && 3 == l.element.parent().contents().get(0).nodeType ? $(l.element.parent().contents().get(0)).wrap('\x3cspan class\x3d"dmAutoInsertFix" duda_id\x3d' + l.newWrapperID + "/\x3e") : element.parent().contents().get(1) && 3 == l.element.parent().contents().get(1).nodeType && $(l.element.parent().contents().get(1)).wrap('\x3cspan class\x3d"dmAutoInsertFix" duda_id\x3d' + l.newWrapperID + "/\x3e"), l.element.parent().attr("replace_mode", "node_subtree").attr("dmle_replace", "true"));
								g.scrollToElement && $.dmops.scrollPreviewToElement(elm);
								g.hideAllSelection && $.hideAllSelection();
								$.dmPreviewSaved();
								wrTrackEvent(WR_SITE_ADD_WIDGET + "_" + m.type)
							}
						}
					})
				}
			})
		},
		insertElement: function(a, e, d, g) {
			$.dmfw.getPreviewElement("#dm").length && null != $.dmx.page && (!0 == a.isExtension ? $.dmops._insertExtensionElement(a, e, d, g) : $.dmops._insertStandardElement(a, e, d, g, !0 == a.isWidget))
		},
		insertElementAllPages: function(a, e) {
			$.changePage({
				serverChange: function() {
					for (var d = a.next(), g = d && 0 < d.length ? d.dmid() : null; null != g && 0 < g.indexOf("clear") || d.attr("dmle_clear") || 0 < d.length && 3 == d.get(0).nodeType;) g = (d = d.next()) && 0 < d.length ? d.dmid() : null;
					var j = $.dmx.sitePages.length > commonProps["editor.undo.allPages.maxSize"];
					$.dmPostAfterObjectSaved({
						url: "/pages/" + $.dmx.page.id + "/insertElementAllPages",
						data: {
							elementID: a.dmid(),
							parent: a.parent().dmid(),
							before: d && 0 < d.length ? d.dmid() : null
						},
						success: function(a) {
							e(a);
							j && neeHistoryManager.clearAndUpdateHistory()
						},
						withHistory: !j,
						allPagesHistory: !j
					})
				}
			})
		},
		copyElement: function() {
			var a = $.dmx.current.element;
			if (a) {
				var e = a.dmid(),
				d = $.dmx.currentPage();
				e && d && ($.dmUndo.set(!1), $.changePage({
					serverChange: function() {
						d = $.dmx.currentPage();
						$.dmPost({
							url: "/pages/" + d + "/copyElement/" + e,
							success: function() {
								dm_show_paste = !0
							},
							complete: function() {
								$.dmUndo.set(!0)
							}
						})
					}
				}))
			}
		},
		pasteElement: function(a, e) {
			dm_enable_copy && $.changePage({
				serverChange: function() {
					var d = $.dmx.currentPage();
					if (d) {
						var g;
						g = a ? {
							parent: a,
							before: e
						}: $.dmops._getInsertDefaultLocation({});
						d = "/pages/" + d + "/pasteElement/";
						g.parent && (d += g.parent.dmid() + "/");
						g.before && (g.before.length && g.before.dmid()) && (d += "?beforeId\x3d" + g.before.dmid());
						$.dmPostWithHistory({
							url: d,
							success: function(a) {
								if (a.markup) {
									a.css && $.dmops.refreshPageStyleCss(a.css, $.dmx.isHeader($.dmx.current.element));
									var d = $(a.markup);
									d.is(".dmCoupon") && d.show();
									a = d.attr("class") ? d.attr("class").split(/\s+/) : [];
									$.each(a,
									function(a, e) {
										d.removeClass(e)
									});
									g.before && g.before.length && g.before.dmid() == g.parent.dmid() ? g.parent.prepend(d) : g.before && g.before.length ? g.before.before(d) : g.parent && g.parent.append(d);
									$.each(a,
									function(a, e) {
										d.addClass(e)
									});
									d.html(d.html());
									d = $.dmfw.getByDmid(d.dmid());
									$.deselectAllEditableElements();
									d.selectElement();
									d.lockElement({
										hideTopBar: !0
									});
									$.dmx.current.editable.afterInsert && $.dmx.current.editable.afterInsert(d);
									$.dmops.scrollPreviewToElement(d);
									$.dmops.redrawSelection();
									$.dmfw.isDudaone() && $.respUtils.redrawBars()
								}
							}
						})
					}
				}
			})
		},
		moveElementBetweenPages: function(a, e, d, g, j, k) {
			$.changePage({
				serverChange: function() {
					$.dmsrv.moveElementBetweenPages(a, e, d.dmid(), g.dmid(), j,
					function(a) {
						if (a.markup) {
							a.css && $.dmops.refreshPageStyleCss(a.css, $.dmx.isHeader($.dmx.current.element));
							var e = $(a.markup),
							g = e.attr("class") ? e.attr("class").split(/\s+/) : [];
							$.each(g,
							function(a, d) {
								e.removeClass(d)
							});
							d.replaceWith(e);
							$.each(g,
							function(a, d) {
								e.addClass(d)
							});
							e.html(e.html());
							e = $.dmfw.getByDmid(e.dmid());
							k && k(a)
						}
					})
				}
			})
		},
		_getInsertDefaultLocation: function(a) {
			var e = {};
			if ($.dmfw.isDudaone()) return e.parent = $.dmfw.getPreviewElement(".dmRespRowsWrapper").find(".dmRespRow:first .dmRespColsWrapper").children(":first"),
			e.before = $.dmfw.getPreviewElement(".dmRespRowsWrapper").find(".dmRespRow:first .dmRespColsWrapper").children(":first").children(":first"),
			e.isDefault = !0,
			e;
			if ($.dmx.page.alias == HOME_PAGE_DESIGN_ALIAS && a.insertBeforeNav) return e.parent = $.dmfw.getPreviewElement(".allWrapper"),
			e.before = e.parent.find(":first"),
			e.isDefault = !0,
			e;
			a.isBlog ? (e.parent = $.dmfw.getPreviewElement("#dmFirstContainer"), e.before = e.parent) : (e.parent = $.dmfw.getPreviewElement(".dmContent"), e.before = e.parent.find(":first"));
			e.isDefault = !0;
			return e
		},
		_insertExtensionElement: function(a, e, d, g) {
			g = $.extend({},
			{
				insertBeforeNav: !(!a || !a.insertBeforeNav)
			},
			g || {});
			var j = !1;
			if (null == e) {
				var k = $.dmops._getInsertDefaultLocation(g);
				e = k.parent;
				d = k.before;
				j = k.isDefault;
				if (!e || !e.length) return
			}
			$.changePage({
				element: e,
				serverChange: function() {
					$.dmPreviewSaving();
					var k = {
						pageId: $.dmx.currentPage(e),
						openEditor: !0
					};
					g = $.extend({},
					k, g || {});
					k = "/pages/addExtension?" + ("pageId\x3d" + g.pageId + "\x26extId\x3d" + a.ext.id);
					e && (k += "\x26parentId\x3d" + e.dmid());
					d && (d.length && null != d.dmid()) && (k += "\x26insertBeforeId\x3d" + d.dmid());
					k += "\x26defaultLocation\x3d" + j;
					$.dmfw.isDudaone() && (k += "\x26device\x3d" + $.onefw.device());
					a.addClearWidget && $.dmUndo.set(!1);
					$.dmPostWithHistory({
						url: k,
						data: a.ext.defaults,
						success: function(j) {
							$.dmUndo.set(!0);
							if (!j || !j.markup) $.dmUnblockUI(),
							$.dmNotify("error inserting element");
							else {
								var k = $(j.markup),
								l = k.attr("class").split(/\s+/);
								$.each(l,
								function(a, d) {
									k.removeClass(d)
								});
								var r = !1;
								switch (j.location.location) {
								case "FIRST":
								case "LAST":
									if ((e = $.dmfw.getByDmid(j.location.parentId)) && e.length)"FIRST" == j.location.location ? (r = e.find(":first")) && "dmTop" == r.attr("id") ? k.insertAfter(r) : e.prepend(k) : e.append(k),
									r = !0;
									break;
								case "BEFORE":
									if ((d = $.dmfw.getByDmid(j.location.beforeId)) && d.length) d.before(k),
									r = !0
								}
								r || $.dmfw.getPreviewElement("#allWrapper").prepend(k);
								1 < k.length && (k = $(k[0]));
								$.each(l,
								function(a, d) {
									k.addClass(d)
								});
								k.html(k.html());
								a.addClearWidget && $.dmops._insertClearWidget(k, g);
								a.afterInsert && a.afterInsert(k);
								$.dmops.checkEmptyContent();
								k.selectElement({
									noEffect: !0
								});
								g.openEditor && (l = $.dmfw.isUseNewSelectionContext() ? {
									hideTopBar: !0
								}: {},
								k.lockElement(l), $.dmfw.openEditor($.dmfw.editables(a.ext.preId), k));
								g.scrollToElement && $.dmops.scrollPreviewToElement(k);
								g.hideAllSelection && $.hideAllSelection();
								j.wrapperID && (e.contents().get(0) && 3 == e.contents().get(0).nodeType ? $(e.contents().get(0)).wrap("\x3cspan duda_id\x3d" + j.wrapperID + "/\x3e") : k.parent().contents().get(1) && 3 == e.contents().get(1).nodeType ? $(e.contents().get(1)).wrap("\x3cspan duda_id\x3d" + j.wrapperID + "/\x3e") : k.parent().contents().get(2) && 3 == e.contents().get(2).nodeType && $(e.contents().get(2)).wrap("\x3cspan duda_id\x3d" + j.wrapperID + "/\x3e"), e.attr("replace_mode", "node_subtree").attr("dmle_replace", "true"));
								if (g.onInsert) g.onInsert(k);
								$.dmPreviewSaved();
								wrTrackEvent(WR_SITE_ADD_WIDGET + "_" + a.type)
							}
						}
					})
				}
			})
		},
		_insertStandardElement: function(a, e, d, g, j) {
			var k = !1;
			if (null == e) {
				g = $.extend({},
				{
					insertBeforeNav: !(!a || !a.insertBeforeNav)
				},
				g || {});
				var l = $.dmops._getInsertDefaultLocation(g);
				e = l.parent;
				d = l.before;
				k = l.isDefault;
				if (!e || !e.length) return
			}
			$.changePage({
				element: e,
				serverChange: function() {
					$.dmPreviewSaving();
					var m = {
						pageId: $.dmx.currentPage(e),
						openEditor: !0
					};
					g = $.extend({},
					m, g || {});
					a.addClearWidget && $.dmUndo.set(!1);
					m = "/pages/" + g.pageId + "/insertElement";
					j && (m = "/pages/newWidget?pageId\x3d" + g.pageId + "\x26widgetId\x3d" + a.widget.id, e && (m += "\x26parentId\x3d" + e.dmid()), d && (d.length && d.dmid()) && (m += "\x26insertBeforeId\x3d" + d.dmid()), k && (m += "\x26defaultLocation\x3dtrue"));
					$.dmPostWithHistory({
						url: m,
						data: j ? a.widget.defaults: {
							markup: null != a.defaultMarkup ? a.defaultMarkup(g.currentWidget) : "\x3cdiv\x3e\x3cbr/\x3e\x3cdiv\x3eClick here to edit\x3c/div\x3e\x3cbr/\x3e\x3c/div\x3e",
							parent: e ? e.dmid() : null,
							before: d && d.length ? d.dmid() : null,
							defaultLocation: k
						},
						success: function(j) {
							$.dmUndo.set(!0);
							if (!j || !j.element) $.dmUnblockUI(),
							$.dmNotify("error inserting element");
							else if (null != j) {
								var k = $(j.element);
								d && d.length && d.dmid() == e.dmid() ? e.prepend(k) : d && d.length ? d.before(k) : e && e.append(k);
								k.html(k.html());
								a.addClearWidget && $.dmops._insertClearWidget(k, g);
								0 < k.length && (k = $(k[0]));
								0 < k.find("[dmle_actual_insert]").length && (k = k.find("[dmle_actual_insert]"));
								a.afterInsert && a.afterInsert(k);
								k.attr("class", k.attr("class"));
								$.dmops.checkEmptyContent();
								a.noSelectionInsert || k.selectElement({
									noEffect: !0
								});
								if (g.openEditor && !a.noEditorOnInsert) {
									var m = $.dmfw.isUseNewSelectionContext() ? {
										hideTopBar: !0
									}: {};
									k.lockElement(m);
									$.dmfw.openEditor(a, k)
								}
								j.wrapperID && j.newWrapperID && (k.parent().contents().get(0) && 3 == k.parent().contents().get(0).nodeType ? $(k.parent().contents().get(0)).wrap("\x3cspan duda_id\x3d" + j.newWrapperID + "/\x3e") : element.parent().contents().get(1) && 3 == k.parent().contents().get(1).nodeType && $(k.parent().contents().get(1)).wrap("\x3cspan duda_id\x3d" + j.newWrapperID + "/\x3e"), k.parent().attr("replace_mode", "node_subtree").attr("dmle_replace", "true"));
								g.scrollToElement && $.dmops.scrollPreviewToElement(k);
								g.hideAllSelection && $.hideAllSelection();
								if (g.onInsert) g.onInsert(k);
								$.dmPreviewSaved();
								wrTrackEvent(WR_SITE_ADD_WIDGET + "_" + a.type)
							}
						}
					})
				}
			})
		},
		surroundCurrentWithLink: function(a, e) {
			$.changePage({
				params: {},
				clientChange: function() {},
				serverChange: function() {
					var d = e ? e: $.dmx.current.element,
					d = "/pages/" + $.dmx.currentPage() + "/surroundwithlink?elementid\x3d" + d.dmid();
					$.dmPostWithHistory({
						url: d,
						success: function(d) {
							d = $(d.value);
							e || ($.dmx.current.element.replaceWith(d), $.dmx.current.element = d.children().first(), $.dmx.current.element.selectElement(), $.dmx.current.element.lockElement());
							a && a(d)
						}
					})
				}
			})
		},
		populateEmptyLink: function(a, e) {
			$.changePage({
				serverChange: function() {
					var d = "/pages/" + $.dmx.currentPage() + "/populatemptylink?elementid\x3d" + a.dmid();
					$.dmPostWithHistory({
						url: d,
						success: function(d) {
							a.attr("href", d.value);
							a.attr("raw_url", $.dmx.site.baseUrl);
							e && e()
						}
					})
				}
			})
		},
		cropImage: function(a, e, d, g) {
			$.changePage({
				element: d && d.forceHeadelem ? d.forceHeadelem: null,
				serverChange: function() {
					var j = d && d.forceHeadelem || null,
					k = d && d.currElemDmid ? d.currElemDmid: $.dmx.current.element.dmid(),
					j = "/pages/" + $.dmx.currentPage(j) + "/cropimage?elementid\x3d" + k,
					l = d && d.imgElem ? d.imgElem: $.dmx.current.element,
					k = l.innerWidth(),
					m,
					n;
					k < e.w ? (m = k + "px", n = "auto") : (m = e.w + "px", n = e.h + "px");
					k = {
						imageSource: a,
						leftXPos: e.x,
						topYPos: e.y,
						cropWidth: e.w,
						cropHeight: e.h,
						widthToSet: m,
						heightToSet: n
					};
					l.isAutoMargin() && "block" == l.css("display") && (k.imgCenter = !0);
					d = d || {};
					d.dontUpdate = d.dontUpdate || $.dmfw.isDudaone();
					d && d.dontUpdate && (k.widthToSet = "", k.heightToSet = "");
					$.dmPreviewSaving();
					$.dmPostWithHistory({
						url: j,
						data: k,
						success: function(a) {
							_cropRes = a;
							l.attr("src", a.croppedImageSource);
							l.attr("dm_crop_dim", a.cropDimStr);
							l.attr("dm_orig_src", a.originalImageSource);
							l.load(function() {
								var a = {
									classesToRemove: null,
									attrToRemove: null,
									classesToAdd: null,
									attrToAdd: [{
										attr: "width",
										value: m
									},
									{
										attr: "height",
										value: n
									}]
								}; (!d || !d.dontUpdate) && $.dmops.updateCurrentCss(a, $.extend({
									clientOnly: !0
								},
								d));
								$.dmops.redrawSelection();
								$.dmPreviewSaved()
							});
							g && d && d.callback && d && d.callback(a)
						}
					})
				}
			})
		},
		editImageWithAviary: function(a, e) {
			featherEditor.launch({
				image: a,
				url: a.attr("src"),
				onSave: function(a, g) {
					e(a, g);
					featherEditor.close()
				}
			});
			return ! 1
		},
		updateCurrentImgSrc: function(a, e) {
			var d = (e = e || {}) && e.elem ? e.elem: $.dmx.current.element,
			g = e && e.forceHeadelem || null;
			$.changePage({
				params: {
					_imageSrc: a
				},
				clientChange: function(a) {
					d.removeAttr("dm_crop_dim");
					d.removeAttr("dm_orig_src");
					d.removeAttr("width");
					d.removeAttr("height");
					d.attr("style", {
						width: "initial",
						height: "initial"
					});
					"none" == d.css("display") && d.css("display", "block");
					d.attr("src", a._imageSrc);
					d.load(function() { ! d.is(".dmColumn *") && !$.dmfw.isDudaone() && ($.dmops.updateCurrentCss({
							classesToRemove: null,
							attrToRemove: null,
							classesToAdd: null,
							attrToAdd: [{
								attr: "width",
								value: "auto"
							},
							{
								attr: "height",
								value: "auto"
							}]
						},
						$.extend({
							clientOnly: !0
						},
						e)), NEFW.PREVIEW.get(0).contentWindow.styleImages());
						$.dmops.redrawSelection()
					})
				},
				serverChange: function(a) {
					a = "/pages/" + $.dmx.currentPage(g) + "/updateimagesrc?elementid\x3d" + d.dmid() + "\x26imgsrc\x3d" + encodeURIComponent(a._imageSrc) + "\x26resetSize\x3d" + !d.is(".dmColumn *") + "\x26downloadImage\x3d" + e.downloadImage;
					$.dmPostWithHistory({
						url: a,
						success: function() {
							e && e.callback && e.callback()
						}
					})
				}
			})
		},
		updatePageWithLiveContent: function(a) {
			$.dmUIBlockControlled({
				region: "_updatePageWithLiveContent",
				op: "block",
				msg: "Synchronizing..."
			});
			var e = $.extend({
				pageid: $.dmx.page.id
			},
			a),
			d = function() {
				$.dmUIBlockControlled({
					region: "_updatePageWithLiveContent",
					op: "unblock",
					msg: "Synchronized"
				})
			},
			g = $.dmx.page.url;
			$.dmPost({
				url: "/pages/" + e.pageid + "/syncpage/",
				success: function(a) {
					e.success && e.success(a);
					d()
				},
				error: function(a) {
					try {
						switch (a.error_code) {
						case "PageNotAvailable":
							return $.showError(a.error_code, {
								pageUrl: g
							}),
							d(),
							!0
						}
					} catch(e) {
						return null
					}
				}
			})
		},
		revertUpdatePageWithLiveContent: function(a) {
			$.dmUIBlockControlled({
				region: "_revertUpdatePageWithLiveContent",
				op: "block",
				msg: "Reverting..."
			});
			var e = $.extend({
				pageid: $.dmx.page.id
			},
			a);
			$.dmPost({
				url: "/pages/" + e.pageid + "/revertsyncpage/disableAutoSync/false",
				success: function(a) {
					e.success && e.success(a);
					$.dmUIBlockControlled({
						region: "_revertUpdatePageWithLiveContent",
						op: "unblock",
						msg: "Reverted"
					})
				}
			})
		},
		_addNewPage: function(a) {
			var e = !0;
			a && ($.each($.dmx.sitePages,
			function(d, g) {
				g.id == a.id && (e = !1)
			}), e && $.dmx.sitePages.push(a), $.dmx.events.trigger("pageAdded", {
				page: a
			}))
		},
		prefetch: function() {
			for (var a = [], e = $.dmx.getSiteNav(), d = 0; d < e.length; d++) ! e[d].pageFromScratch && "URL" == $.getLinkType(e[d].itemUrl).linkType.type && a.push(e[d].itemUrl);
			$.dmPost({
				url: "/pages/" + $.dmx.page.id + "/prefetch",
				data: a
			})
		},
		doSrvSendSiteAddressMail: function(a, e) {
			var d = !0; ! 1 == e.addTryModeParam && (d = !1);
			$.dmsrv.sendMail(a, e.mailType, e.siteAddress, e.siteId, d,
			function(a) {
				"Email sent successfully" == a.value ? e.callback.success() : e.callback.fail();
				$.dmUIBlockControlled({
					region: e.blockControllerRegsion,
					op: "unblock",
					msg: " "
				})
			})
		},
		sendSiteAddressMail: function(a) {
			var e = !0; ! 1 == a.addTryModeParam && (e = !1);
			a.msg.text("");
			a.input.val("");
			a.input.unbind("keyup").keyup(function() {
				a.msg.text("")
			});
			a.sendBtn.unbind("click").click(function() {
				a.msg.text("");
				var d = a.input.val();
				$.validateEmail(d) ? (a.input.blur(), $.dmUIBlockControlled({
					region: "_sendEmail",
					op: "block",
					msg: " "
				}), a.msg.css("color", "#666").text(dmStr["ui.nee.sendSiteEmail.1"]), a.callback = {},
				a.callback.success = function() {
					a.msg.css("color", "green").text(dmStr["ui.nee.sendSiteEmail.2"]);
					a.input.val("")
				},
				a.callback.fail = function() {
					a.msg.css("color", "red").text(dmStr["ui.nee.sendSiteEmail.3"])
				},
				a.addTryModeParam = e, a.blockControllerRegsion = "_sendEmail", $.dmops.doSrvSendSiteAddressMail(d, a)) : a.msg.css("color", "red").text(dmStr["ui.nee.sendSiteEmail.4"])
			});
			a.input.placeholder()
		},
		removeAds: function() { ! 1 != $.dmx.site.showAds && $.dmPostWithHistory({
				url: "/sites/" + $.dmx.site.id + "/toggleads/false"
			});
			$.dmfw.getPreviewElement("#ad").addClass("display_None");
			$.dmfw.getPreviewElement(".dmAdCloseButton").addClass("display_None");
			$.dmx.site.showAds = !1
		},
		showAds: function() { ! 0 != $.dmx.site.showAds && $.dmPostWithHistory({
				url: "/sites/" + $.dmx.site.id + "/toggleads/true"
			});
			$.dmfw.getPreviewElement("#ad").removeClass("display_None");
			$.dmfw.getPreviewElement(".dmAdCloseButton").removeClass("display_None");
			$.dmfw.initAdCloser();
			$.dmx.site.showAds = !0
		},
		removePoweredBy: function() { ! 1 != $.dmx.site.showPoweredBy && $.dmPostWithHistory({
				url: "/sites/" + $.dmx.site.id + "/togglepoweredby/false"
			});
			var a = $($.dmfw.getPreviewElement("#mobileFooter").find("a")[0]);
			a.is(".dmForceFooter, #classic_link") || a.addClass("display_None");
			$.dmfw.getPreviewElement(".dmMobileFooterCloseButton").addClass("display_None");
			$.dmx.site.showPoweredBy = !1
		},
		showPoweredBy: function() { ! 0 != $.dmx.site.showPoweredBy && $.dmPostWithHistory({
				url: "/sites/" + $.dmx.site.id + "/togglepoweredby/true"
			});
			var a = $($.dmfw.getPreviewElement("#mobileFooter").find("a")[0]);
			a.is(".dmForceFooter") || a.removeClass("display_None");
			$.dmfw.getPreviewElement(".dmMobileFooterCloseButton").removeClass("display_None");
			$.dmfw.initPoweredByCloser();
			$.dmx.site.showPoweredBy = !0
		},
		changePaletteColor: function(a, e, d) {
			$.dmPostWithHistory({
				url: "/sites/" + $.dmx.site.id + "/updatePalette/",
				data: {
					name: a,
					value: e
				},
				success: function(g) {
					$.dmops.refreshGlobalCss(g.value, 3E3);
					$.dmx.currentPalette[a] = e;
					d && d()
				}
			})
		},
		populateCurrentPalette: function(a) {
			$.dmGet({
				url: "/sites/" + $.dmx.site.id + "/getPalette/",
				success: function(e) {
					$.dmx.currentPalette = e.palette;
					a && a()
				}
			})
		}
	}
});
_commonCfg = {};
$.extend({
	dmsrv: {
		updateExtension: function(a, e, d) {
			d = d || {};
			var g = "/pages/updateext?",
			j = $.dmx.currentPage(),
			k = a.attr("dmle_extension"),
			l = $(a).dmid();
			null == e.surround && (e.surround = a.attr("surround"));
			null == e.icon && (e.icon = a.attr("icon"));
			null == e.wr && (e.wr = a.attr("wr"));
			g += "pageId\x3d" + j + "\x26extId\x3d" + k + "\x26elementId\x3d" + l;
			$.dmfw.isDudaone() && (g += "\x26device\x3d" + $.onefw.device());
			$.dmPostWithHistory({
				url: g,
				data: e,
				success: function(e) {
					d.forceCallback ? d.forceCallback(e) : e.value ? (a.copyOuterHtml(e.value), $.dmNotify("element updated"), d.successCallback && d.successCallback()) : ($.dmNotify("Error updating element"), d.errorCallback && d.errorCallback())
				}
			})
		},
		updateCSS: function(a, e, d, g, j, k) {
			var l = {},
			m = "/pages/updatecss?",
			n = $.dmx.currentPage(a),
			o = $(a).dmid(),
			r = "u_" + o.replace(".", "-");
			k = k || {};
			l.device = k.device || null;
			a.addClass(r);
			m += "pageId\x3d" + n;
			l.elementId = o;
			null != d && (l.tagName = d);
			if (null != r && (l.cssClass = r, null != g)) {
				a = "";
				g = g.split(",");
				for (d = 0; d < g.length; d++) a += r + k.classes + " " + g[d],
				d < g.length - 1 && (a += " , ");
				l.selector = a
			}
			l.extContext = e;
			$.dmPostWithHistory({
				url: m,
				data: l,
				success: function(a) {
					j && j(a)
				}
			})
		},
		updateCSSMultipleElements: function(a, e) {
			$.dmPostWithHistory({
				url: "/pages/updatecsstomultipleelements?",
				data: a,
				success: function(a) {
					e && e(a)
				}
			})
		},
		autoSyncPage: function(a, e, d) {
			$.dmPost({
				url: "/pages/" + a + "/autosync?autoSync\x3d" + e,
				success: d
			})
		},
		addToNav: function(a, e, d, g, j) {
			a = {
				url: "/pages/" + a + "/addToNav?itemTitle\x3d" + encodeURIComponent(e) + "\x26itemHref\x3d" + escape(d) + "\x26insertFirst\x3d" + (g || !1),
				success: function(a) {
					a ? j(a) : j()
				}
			};
			$.dmPostWithHistory(a)
		},
		dontMobilizeUrl: function(a, e, d) {
			$.dmUIBlockControlled("_dontMobilize");
			try {
				var g = {
					url: "/sites/" + $.dmx.site.id + "/dontmobilize/" + e,
					data: {
						value: a
					},
					success: function() {
						$.dmUnblockUI()
					}
				};
				d && (g.success = function(a) {
					d(a);
					$.dmUIUnblockControlled("_dontMobilize")
				});
				$.dmPost(g)
			} catch(j) {
				$.dmUIUnblockControlled("_dontMobilize")
			}
		},
		resetPageDesign: function(a, e) {
			$.dmUIBlockControlled("_resetPageDesign");
			try {
				var d = {
					url: "/pages/" + a + "/resetDesign",
					success: function() {
						$.dmUnblockUI();
						$.dmNotify("Page design was reset.")
					},
					error: function(a) {
						try {
							switch (a.error_code) {
							case "SiteTooBig":
							case "PageNotAvailable":
								return $.dmUnblockUI(),
								$("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.error.couldnotreset"] + "\x3cbr\x3e" + a.message, {
									triggerNow: !0,
									noText: "OK",
									yesText: "OK",
									forceWidth: "420px",
									yesStyle: "display:none"
								}),
								!0
							}
						} catch(d) {}
						return null
					}
				};
				e && (d.success = function(a) {
					e(a);
					$.dmUIUnblockControlled("_resetPageDesign")
				});
				$.dmPost(d)
			} catch(g) {
				$.dmUIUnblockControlled("_resetPageDesign")
			}
		},
		renamePage: function(a, e, d, g) {
			var j = {
				url: "/pages/" + a + "/rename?newTitle\x3d" + e,
				success: function() {
					var g = $.dmx.getPageByField("id", a);
					g && (g.title = e);
					d && d()
				}
			};
			g && (j.error = g);
			$.dmPost(j)
		},
		updateElementAttributes: function(a, e, d) {
			a = {
				url: "/pages/" + $.dmx.currentPage() + "/updateelementattributes/" + $(a).dmid(),
				data: e,
				success: function(a) {
					d && d(a);
					$.dmNotify("Element modified.")
				}
			};
			$.dmPostWithHistory(a)
		},
		updateGlobalCSS: function(a, e, d) {
			e = e || {};
			cssClassesToSend = a && -1 == a.constructor.toString().indexOf("Array") ? [a] : a;
			a = {
				cssClass: cssClassesToSend,
				attrToAdd: e.attrToAdd,
				attrToRemove: e.attrToRemove,
				classesToAdd: e.classesToAdd,
				classesToRemove: e.classesToRemove,
				attributesToAddToElement: e.attributesToAddToElement || [],
				attributesToRemoveFromElement: e.attributesToRemoveFromElement || []
			};
			e.changeInHeader && (a.changeInHeader = [!0]);
			var g = e.elementId ? "/?elementId\x3d" + e.elementId: "",
			j = e.elementId ? "\x26": "?",
			j = j + ("outsideTheme\x3d" + (e.outsideTheme || !1));
			e = e.device ? "\x26device\x3d" + e.device: "";
			$.dmPostWithHistory({
				url: "/sites/assignglobalcsstoelement/" + $.dmx.currentPage() + g + j + e,
				data: a,
				success: function(a) {
					d && d(a)
				}
			})
		},
		moveElement: function(a, e, d, g, j) {
			$.dmPostWithHistory({
				url: "/pages/" + a + "/moveelement/" + e + "/" + d + "/" + g,
				success: function(a) {
					j && j(a);
					$.dmops.checkEmptyContent()
				}
			})
		},
		moveElementBetweenPages: function(a, e, d, g, j, k) {
			a = "/pages/" + e + "/moveelementbetweenpages/" + a + "/" + d + "/" + g;
			j && (a += "?insertbeforeid\x3d" + j);
			$.dmPostWithHistory({
				url: a,
				success: function(a) {
					k && k(a);
					$.dmops.checkEmptyContent()
				}
			})
		},
		updatePageHead: function(a, e, d) {
			$.dmPostWithHistory({
				url: "/pages/" + a + "/updatehead",
				data: e,
				success: function(a) {
					d && d(a)
				}
			})
		},
		getSiteFeatures: function(a) {
			$.dmGet({
				url: "/sites/" + $.dmx.site.id + "/getpremiumfeatures",
				success: function(e) {
					a && a(e)
				}
			})
		},
		deleteFeatures: function(a, e) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/deletefeatures",
				data: a,
				success: function(a) {
					e && e(a)
				}
			})
		},
		publishSite: function(a, e, d) {
			var g = !0;
			"undefined" === typeof d && (g = !1, $.dmUIBlockControlled("_publishSite"));
			try {
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/publish",
					success: function(d) {
						$.dmx.site.isPublished = !0;
						$.dmfw.checkSitePublished();
						a && a(d);
						g || $.dmUIUnblockControlled("_publishSite")
					},
					error: function(a) {
						g || $.dmUIUnblockControlled("_publishSite");
						return e && e(a)
					}
				})
			} catch(j) {
				$.dmUIUnblockControlled("_publishSite")
			}
		},
		unpublishSite: function(a) {
			$.dmUIBlockControlled("_unpublishSite");
			try {
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/unpublish",
					success: function(d) {
						$.dmx.site.isPublished = !1;
						$.dmfw.checkSitePublished();
						a && a(d);
						$.dmUIUnblockControlled("_unpublishSite")
					}
				})
			} catch(e) {
				$.dmUIUnblockControlled("_unpublishSite")
			}
		},
		rollbackSite: function(a) {
			$.dmUIBlockControlled("_rollbackSite");
			try {
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/rollback",
					success: function(d) {
						a && a(d);
						$.dmUIUnblockControlled("_rollbackSite")
					}
				})
			} catch(e) {
				$.dmUIUnblockControlled("_rollbackSite")
			}
		},
		assignSiteDomain: function(a, e, d) {
			$.dmUIBlockControlled("_assignSiteDomain");
			try {
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/assigndomain?domain\x3d" + escape(a),
					success: function(d) {
						$.dmx.site.domain = a;
						e && e(d);
						$.dmUIUnblockControlled("_assignSiteDomain")
					},
					error: function(a) {
						if (d) return d(a)
					}
				})
			} catch(g) {
				$.dmUIUnblockControlled("_assignSiteDomain")
			}
		},
		paymentUrl: function(a, e, d, g) {
			g = g || {};
			var j = "";
			g.premiumType && (j = "\x26premiumType\x3d" + g.premiumType);
			g.contract && (j += "\x26contract\x3d" + g.contract);
			$.dmPost({
				url: "/sites/" + a + "/paymenturl?onDone\x3d" + e + "\x26isV3\x3dtrue" + j,
				success: function(a) {
					d && d(a)
				}
			})
		},
		sendMail: function(a, e, d, g, j, k) {
			$.dmPost({
				url: "/sites/" + (g ? g: $.dmx.site.id) + "/sendmail",
				data: {
					emailAddress: a,
					mailType: e,
					siteAddress: d,
					addTryMode: j
				},
				success: function(a) {
					k && k(a)
				}
			})
		},
		assignPageToUrl: function(a, e, d) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/assignpagetourl?pageAlias\x3d" + a + "\x26linkUrl\x3d" + escape(e),
				success: function(a) {
					d && d(a)
				}
			})
		},
		removeUrlRule: function(a, e) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/removeUrlRule?urlPattern\x3d" + escape(a),
				success: function(a) {
					e && e(a)
				}
			})
		},
		updateUrlRule: function(a, e, d, g) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/updateUrlRule?oldPattern\x3d" + escape(a) + "\x26newPattern\x3d" + escape(e) + "\x26pageAlias\x3d" + escape(d),
				success: function(a) {
					g && g(a)
				}
			})
		},
		setAsTemplate: function(a) {
			a = a || {};
			var e = "/pages/" + a.pageId + "/setAsTemplate?setAsTemplate\x3d" + a.setAsTemplate;
			a.pageTitle && (e += "\x26title\x3d" + a.pageTitle);
			$.dmPost({
				url: e,
				success: function(d) {
					a.success && a.success(d)
				}
			})
		},
		setHeaderFixed: function(a) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/setHeaderFixed/" + a.isOn,
				success: function(e) {
					$.dmx.site.headerFixed = a.isOn;
					a.success && a.success(e)
				}
			})
		},
		setHeaderSkinny: function(a) {
			$.dmPost({
				url: "/sites/" + $.dmx.site.id + "/setHeaderSkinny/" + a.isOn,
				success: function(e) {
					$.dmx.site.headerSkinny = a.isOn;
					a.success && a.success(e)
				}
			})
		},
		setTipWasShown: function(a) {
			$.dmPost({
				url: "/accounts/" + dm_account_name + "/setshowntip/" + a,
				success: function() {}
			})
		},
		postToServ: function(a, e) {
			a && $.changePage({
				clientChange: function() {},
				serverChange: function() {
					a && a()
				}
			},
			!e)
		},
		isPaymentNeeded: function(a) {
			a = a || {};
			return $.dmGet({
				url: "/sites/" + (a.siteId || $.dmx.site.id) + "/ispaymentneeded",
				success: function(e) {
					a.success && a.success(e)
				},
				error: function() {}
			})
		}
	}
});
var neeHistoryManager = new NEEHistoryManager,
_neeHistoryManagerDebug = !1,
_neeHistoryManagerUniqueID = (new Date).getTime(),
_neeHistoryManagerErrorMsg = "Oops... Something went wrong, please refresh the page."; (function(a) {
	a(document).ready(function() {
		neeHistoryManager.init()
	})
})(jQuery);
function NEEHistoryManager() {}
function NEEUndoData(a) {
	this.globalCSS = a.globalCSS;
	this.pageCSS = a.pageCSS;
	this.headerPageCSS = a.headerPageCSS;
	this.themeCSS = a.themeCSS;
	this.bodyHTML = a.bodyHTML
}
NEEHistoryManager.prototype.undoValuesEqual = function(a, e) {
	return a.themeCSS == e.themeCSS && a.pageCSS == e.pageCSS && a.bodyHTML == e.bodyHTML
};
NEEHistoryManager.prototype.init = function() {
	this.currentRequestNumber = 0;
	this.undoStack = [];
	this.redoStack = [];
	this.rebind()
};
NEEHistoryManager.prototype.rebind = function() {
	var a = $("#editorSettingsTopBar, .shellHeaderWrapper");
	_neeHistoryManagerDebug && $.log("NEEHistoryManager rebind");
	var e = this;
	$(document).unbind("keyup.histmgr").bind("keyup.histmgr",
	function(a) {
		e.handleKeyDown(a)
	});
	a.find(".undoBtn2").addClass("undoBtn");
	a.find(".redoBtn2").addClass("redoBtn");
	a.find(".undoBtn").off("click.histmgr").on("click.histmgr",
	function() {
		e.undo()
	});
	a.find(".redoBtn").off("click.histmgr").on("click.histmgr",
	function() {
		e.redo()
	});
	this.addFirstHistoryIfNeeed();
	this._showUndoButtons();
	this._updateUndoButtonsStatus()
};
NEEHistoryManager.prototype.addFirstHistoryIfNeeed = function() {
	this.undoStack && (0 == this.undoStack.length && NEFW.PREVIEW) && this.updateHistory()
};
NEEHistoryManager.prototype.remove = function() {
	_neeHistoryManagerDebug && $.log("NEEHistoryManager remove");
	if (0 < this.undoStack.length || 0 < this.redoStack.length || 0 < this.currentRequestNumber) this.clear(),
	this._updateUndoButtonsStatus();
	this._hideUndoButtons();
	$(document).unbind("keydown.histmgr");
	$(document.body).off("click.histmgr", ".shellHeaderWrapper .undoBtn");
	$(document.body).off("click.histmgr", ".shellHeaderWrapper .redoBtn")
};
NEEHistoryManager.prototype.handleKeyDown = function(a) {
	try {
		if (document.activeElement) {
			var e = "TEXTAREA" == document.activeElement.tagName || "INPUT" == document.activeElement.tagName;
			if (e) return ! 0;
			$(document.activeElement).parents().each(function() {
				if ("TEXTAREA" == this.tagName || "INPUT" == this.tagName || $(this).hasClass("CodeMirror")) e = !0
			});
			if (e) return ! 0
		}
	} catch(d) {}
	if (a.metaKey || a.ctrlKey) 90 == a.keyCode ? (_neeHistoryManagerDebug && $.log("history manager: ctrl-z pressed"), this.undo()) : 89 == a.keyCode && (_neeHistoryManagerDebug && $.log("history manager: ctrl-y pressed"), this.redo());
	return ! 0
};
NEEHistoryManager.prototype.clearAndUpdateServer = function() {
	try {
		var a = {
			url: "/pages/" + $.dmx.currentPage() + "/clearAndUpdatePageHistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
			error: $.dmDefaultXHRerror
		};
		$.dmPost(a)
	} catch(e) {
		$.log(e)
	}
};
NEEHistoryManager.prototype.updateServer = function() {
	try {
		var a = {
			url: "/pages/" + $.dmx.currentPage() + "/updatepagehistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
			error: $.dmDefaultXHRerror
		};
		$.dmPost(a)
	} catch(e) {
		$.log(e)
	}
};
NEEHistoryManager.prototype.clearAndUpdateClient = function(a) {
	a = a || {};
	try {
		if (_neeHistoryManagerDebug && $.log("history-manager: clearing and updating history"), NEFW.PREVIEW) {
			var e = NEFW.PREVIEW.get(0).contentWindow,
			d = new NEEUndoData({
				globalCSS: e.getGlobalCSSToString(),
				pageCSS: e.getPageCSSToString(),
				headerPageCSS: e.getHeaderPageCSSToString(),
				bodyHTML: NEFW.PREVIEW.contents().eq(0).find(".dmOuter").html(),
				themeCSS: e.getGlobalThemeCSSToString()
			});
			_neeHistoryManagerDebug && $.log("history-manager: got new undo data (clear and update)");
			if (a.saveLast) {
				var g = this.undoStack.pop();
				this.undoStack = [];
				g && this.undoStack.push(g)
			} else this.undoStack = [];
			this.undoStack.push(d);
			this.undoStack.length > commonProps["editor.undo.max.history"] && this.undoStack.splice(0, 1);
			this.redoStack = [];
			this.currentRequestNumber = 0;
			this._updateUndoButtonsStatus()
		}
	} catch(j) {
		$.log(j)
	}
};
NEEHistoryManager.prototype.clearAndUpdateHistory = function(a) {
	a = a || {};
	try {
		if (_neeHistoryManagerDebug && $.log("history-manager: clearing and updating history"), NEFW.PREVIEW) {
			var e = NEFW.PREVIEW.get(0).contentWindow,
			d = new NEEUndoData({
				globalCSS: e.getGlobalCSSToString(),
				pageCSS: e.getPageCSSToString(),
				headerPageCSS: e.getHeaderPageCSSToString(),
				bodyHTML: NEFW.PREVIEW.contents().eq(0).find(".dmOuter").html(),
				themeCSS: e.getGlobalThemeCSSToString()
			});
			_neeHistoryManagerDebug && $.log("history-manager: got new undo data (clear and update)");
			if (a.saveLast) {
				var g = this.undoStack.pop();
				this.undoStack = [];
				g && this.undoStack.push(g)
			} else this.undoStack = [];
			this.undoStack.push(d);
			this.undoStack.length > commonProps["editor.undo.max.history"] && this.undoStack.splice(0, 1);
			this.redoStack = [];
			var j = {
				url: "/pages/" + $.dmx.currentPage() + "/clearAndUpdatePageHistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
				error: $.dmDefaultXHRerror
			};
			$.dmPost(j);
			this.currentRequestNumber = 0;
			this._updateUndoButtonsStatus()
		}
	} catch(k) {
		$.log(k)
	}
};
NEEHistoryManager.prototype._showUndoButtons = function() {
	$(".undoRedoWrapper").css("visibility", "visible")
};
NEEHistoryManager.prototype._hideUndoButtons = function() {
	$(".undoRedoWrapper").css("visibility", "hidden")
};
NEEHistoryManager.prototype._updateUndoButtonsStatus = function() {
	_neeHistoryManagerDebug && $.log("history-manager: updating undo buttons status");
	1 < this.undoStack.length ? $(".shellHeaderWrapper .undoBtnGray").addClass("undoBtn").removeClass("undoBtnGray") : $(".shellHeaderWrapper .undoBtn").addClass("undoBtnGray").removeClass("undoBtn");
	0 < this.redoStack.length ? $(".shellHeaderWrapper .redoBtnGray").addClass("redoBtn").removeClass("redoBtnGray") : $(".shellHeaderWrapper .redoBtn").addClass("redoBtnGray").removeClass("redoBtn");
	1 >= this.undoStack.length && 0 == this.redoStack.length ? $(".shellHeaderWrapper .undoRedoSep").addClass("transparentForty") : $(".shellHeaderWrapper .undoRedoSep").removeClass("transparentForty")
};
NEEHistoryManager.prototype.updateHistory = function(a) {
	try {
		if (_neeHistoryManagerDebug && $.log("history-manager: updating history"), NEFW.PREVIEW) {
			var e = NEFW.PREVIEW.get(0).contentWindow;
			if (e && e.getGlobalThemeCSSToString && e.getPageCSSToString && e.getHeaderPageCSSToString) {
				var d = new NEEUndoData({
					globalCSS: e.getGlobalCSSToString(),
					pageCSS: e.getPageCSSToString(),
					headerPageCSS: e.getHeaderPageCSSToString(),
					bodyHTML: NEFW.PREVIEW.contents().eq(0).find(".dmOuter").html(),
					themeCSS: e.getGlobalThemeCSSToString()
				}),
				e = void 0;
				0 < this.undoStack.length && (e = this.undoStack[this.undoStack.length - 1]);
				if (!e || !this.undoValuesEqual(d, e)) {
					_neeHistoryManagerDebug && $.log("history-manager: got new undo data");
					this.undoStack.push(d);
					this.undoStack.length > commonProps["editor.undo.max.history"] && this.undoStack.splice(0, 1);
					this.redoStack = [];
					d = "";
					a && a.saveAllPagesDesignTempaltes && (d = "\x26saveAllPagesDesignTempaltesParam\x3dtrue");
					var g = {
						url: "/pages/" + $.dmx.currentPage() + "/updatepagehistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID + d,
						error: $.dmDefaultXHRerror
					};
					$.dmPost(g);
					this.currentRequestNumber++;
					this._updateUndoButtonsStatus()
				}
			}
		}
	} catch(j) {
		$.log(j)
	}
};
NEEHistoryManager.prototype.undo = function() {
	if (this.hasUndo()) {
		var a = this.undoStack.pop(),
		e = this.undoStack[this.undoStack.length - 1];
		if (e) {
			this._closeEditor();
			var d = NEFW.PREVIEW.contents().scrollTop();
			_neeHistoryManagerDebug && $.log("history-manager: undo");
			NEFW.PREVIEW.contents().eq(0).find(".dmOuter").get(0).innerHTML = e.bodyHTML;
			NEFW.PREVIEW.contents().scrollTop(d);
			setTimeout(function() {
				NEFW.PREVIEW.contents().scrollTop(d)
			},
			50);
			this.redoStack.push(a);
			a = {
				url: "/pages/" + $.dmx.currentPage() + "/undoPageHistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
				error: this.servelCallErrorHandler,
				success: function() {
					$.dmops.refreshPageStyleCss(e.pageCSS);
					$.dmops.refreshPageStyleCss(e.headerPageCSS, !0);
					$.dmops.refreshGlobalAndThemeCss(e.themeCSS, e.globalCSS)
				}
			};
			$.dmPost(a);
			this.currentRequestNumber++;
			this._updateUndoButtonsStatus()
		}
		this._cleanAfterUndoRedo();
		$.dmNotify("undo done")
	}
};
NEEHistoryManager.prototype.servelCallErrorHandler = function(a) {
	try {
		switch (a.error_code) {
		case "InvalidState":
			return neeHistoryManager.clear(),
			$.dmx.page && $.dmx.page.alias && $.dmfw.reload({
				pageAlias: $.dmx.page.alias
			}),
			!0;
		default:
			return null
		}
	} catch(e) {
		return null
	}
};
NEEHistoryManager.prototype.redo = function() {
	if (this.hasRedo()) {
		var a = this.redoStack.pop();
		if (a) {
			this._closeEditor();
			var e = NEFW.PREVIEW.contents().scrollTop();
			_neeHistoryManagerDebug && $.log("history-manager: redo");
			NEFW.PREVIEW.contents().eq(0).find(".dmOuter").get(0).innerHTML = a.bodyHTML;
			NEFW.PREVIEW.contents().scrollTop(e);
			setTimeout(function() {
				NEFW.PREVIEW.contents().scrollTop(e)
			},
			50);
			this.undoStack.push(a);
			var d = {
				url: "/pages/" + $.dmx.currentPage() + "/redoPageHistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
				error: this.servelCallErrorHandler,
				success: function() {
					$.dmops.refreshPageStyleCss(a.pageCSS);
					$.dmops.refreshPageStyleCss(a.headerPageCSS, !0);
					$.dmops.refreshGlobalAndThemeCss(a.themeCSS, a.globalCSS)
				}
			};
			$.dmPost(d);
			this.currentRequestNumber++;
			this._updateUndoButtonsStatus()
		}
		this._cleanAfterUndoRedo();
		$.dmNotify("redo done")
	}
};
NEEHistoryManager.prototype._closeEditor = function() {
	$.dmfw._closeEditorAll();
	$.dmfw.preview.removeEditableBar({
		skipCloseEditor: !0
	})
};
NEEHistoryManager.prototype._cleanAfterUndoRedo = function() {
	this._closeEditor();
	setTimeout("neeHistoryManager._closeEditor();", 300);
	$.dmfw.getPreviewElement("." + INLINE_EDITOR_SELECTION_ELEMET).remove();
	$.dmfw.getPreviewElement(".inlineEditorImageSelected, .inlineEditorEditedElement").removeClass("inlineEditorImageSelected").removeClass("inlineEditorEditedElement");
	$.dmfw.getPreviewElement(".dmDrakedElement").remove();
	$.dmfw.getPreviewElement(".dmDropAreasMinHeight").removeClass("dmDropAreasMinHeight");
	NEFW.PREVIEW.get(0).contentWindow.hideLoading();
	NEFW.PREVIEW.get(0).contentWindow.styleImages();
	setTimeout("NEFW.PREVIEW.get(0).contentWindow.styleImages()", 300);
	$.dmx.cache.clearAll();
	var a = NEFW.PREVIEW.contents();
	$.each($.dmfw.editables(),
	function(d, e) {
		e.docReady(a)
	});
	$.dmfw.initAdCloser();
	$.dmfw.initPoweredByCloser();
	setTimeout('$("#_cssHtml .tabSelect").click();', 1E3);
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initImageSlider(!1);
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTwitterFeed();
	$.dmx.preview.wnd().jQuery.layoutManager && $.dmx.preview.wnd().jQuery.layoutManager.initLayout();
	try {
		$.dmfw.refreshFBWidgets()
	} catch(e) {}
};
NEEHistoryManager.prototype.hasUndo = function() {
	return 1 < this.undoStack.length
};
NEEHistoryManager.prototype.hasRedo = function() {
	return 0 < this.redoStack.length
};
NEEHistoryManager.prototype.clearClient = function(a) {
	a = a || {};
	_neeHistoryManagerDebug && $.log("history-manager: clear");
	a.saveLast ? (a = this.undoStack.pop(), this.undoStack = [], a && this.undoStack.push(a)) : this.undoStack = [];
	this.redoStack = [];
	this.currentRequestNumber = 0;
	this._updateUndoButtonsStatus()
};
NEEHistoryManager.prototype.clear = function() {
	_neeHistoryManagerDebug && $.log("history-manager: clear");
	this.undoStack = [];
	this.redoStack = [];
	$.dmPost({
		url: "/pages/clearPageHistory?requestnumber\x3d" + this.currentRequestNumber + "\x26historyManagerID\x3d" + _neeHistoryManagerUniqueID,
		error: $.dmDefaultXHRerror
	});
	this.currentRequestNumber = 0;
	this._updateUndoButtonsStatus()
}; (function(a) {
	function e(d) {
		return selector && (d = d.startsWith("#") ? a(url) : a("#" + url), d.length) ? d.html() : ""
	}
	function d(d, e, l) {
		options = options || {};
		e = e || g;
		l = l || g;
		d ? a.ajax({
			url: d,
			success: e,
			error: l
		}) : l()
	}
	var g = function() {};
	a.handlebarsManager = {
		loadTemplate: function(j, k) {
			function l() { (k.error || g)();
				n.reject()
			}
			function m(d) {
				var e;
				try {
					e = k.dontCompile ? g: Handlebars.compile(d)
				} catch(j) {
					l();
					return
				}
				e.templateMarkup = d;
				e.compiled = !k.dontCompile;
				a.dmx.cache.set(o, e);
				d = e; (k.success || g)(d);
				n.resolve(d)
			}
			k = k || {};
			var n = a.Deferred(),
			o = "hbTemplates." + j,
			r = a.dmx.cache.get(o);
			r && !k.forceReload ? r.compiled && !k.forceCompile ? ((k.success || g)(r), n.resolve(r)) : m(r.templateMarkup) : (r = r = {
				isScriptElement: k.isScriptElement,
				success: m,
				error: l
			},
			r.isScriptElement ? option.success(e(j)) : d(j, r.sucess, r.error));
			return n.promise()
		},
		loadTemplateMarkupFromScript: e,
		loadTemplateMarkupFromUrl: d
	}
})(jQuery, this);
var PLATFORM_PROVIDER = "platform",
PRODUCT_PROVIDER = "product";
$.extend({
	dmui: function() {
		return {
			getBodyClass: function(a) {
				return $.dmui.getResource("bodyClass", a)
			},
			getShellWrapperClass: function(a) {
				return $.dmui.getResource("shellWrapperClass", a)
			},
			getPublishPanelMarkup: function(a) {
				return $.dmui.getResource("publishPanel", a)
			},
			getRedirectPanelMarkup: function(a) {
				return $.dmui.getResource("redirectPanel", a)
			},
			getDynamicPublishPanelMarkup: function(a) {
				return $.dmui.getDynamicResource("publishPanel", a)
			},
			getDesignPanelMarkup: function(a) {
				return $.dmui.getResource("designPanel", a)
			},
			getIsInlineEdit: function(a) {
				return $.dmui.getResource("isInlineEdit", a)
			},
			postUpdateContext: function(a, e) {
				return $.dmui.getFlowInterceptor("postUpdateContext", e)(a)
			},
			onReload: function(a, e) {
				return $.dmui.getFlowInterceptor("onReload", e)(a)
			},
			onTemplatesTabReady: function(a, e) {
				return $.dmui.getFlowInterceptor("onTemplatesTabReady", e)(a)
			},
			onDesignTabReady: function(a, e) {
				return $.dmui.getFlowInterceptor("onDesignTabReady", e)(a)
			},
			onPublishTabReady: function(a, e) {
				return $.dmui.getFlowInterceptor("onPublishTabReady", e)(a)
			},
			onPreviewLoad: function(a, e) {
				return $.dmui.getFlowInterceptor("onPreviewLoad", e)(a)
			},
			onNavigate: function(a, e) {
				return $.dmui.getFlowInterceptor("onNavigate", e)(a)
			},
			registerProvider: function(a, e, d) {
				var g = {
					dm_account_roles: dm_account_roles
				}; ("function" === typeof d.activateProduct ? d.activateProduct(g) : 1) ? $.dmui.PROVIDERS[a][e] = d: (d = "function" === typeof d.alternateProvider ? d.alternateProvider(g) : null) && ($.dmui.PROVIDERS[a][e] = d)
			},
			getProductProvider: function(a) {
				var e = $.dmx.site.dmProductType;
				isWLSubUser && (e = "RESELLER");
				a && a.product && (e = a.product);
				return $.extend(!0, {},
				$.dmui.PROVIDERS.product.Default, $.dmui.PROVIDERS.product[e])
			},
			getPlatformProvider: function(a) {
				var e = $.dmx.site.webPlatform;
				a && a.platform && (e = a.platform);
				return $.extend(!0, {},
				$.dmui.PROVIDERS.platform.Default, $.dmui.PROVIDERS.platform[e])
			},
			getResource: function(a, e) {
				var d = $.dmui.getProductProvider(e),
				g = $.dmui.getPlatformProvider(e),
				j = $.extend(!0, {},
				$.dmui.DefaultProvider);
				d && (j = $.extend(!0, j, d));
				g && (j = $.extend(!0, j, g));
				return j.resources[a]
			},
			getDynamicResource: function(a, e) {
				var d = $.dmui.getProductProvider(e),
				g = $.dmui.getPlatformProvider(e),
				j = $.extend(!0, {},
				$.dmui.DefaultProvider);
				d && (j = $.extend(!0, j, d));
				g && (j = $.extend(!0, j, g));
				return j.dynamicResources[a](e)
			},
			getFlowInterceptor: function(a, e) {
				return function(d) {
					function g(e) {
						if (e && e.flowInterceptor && e.flowInterceptor[a]) e.flowInterceptor[a](d)
					}
					g($.dmui.DefaultProvider);
					g($.dmui.getProductProvider(e));
					g($.dmui.getPlatformProvider(e))
				}
			},
			DefaultProvider: {
				flowInterceptor: {
					postUpdateContext: function() {},
					onReload: function() {},
					onTemplatesTabReady: function() {},
					onDesignTabReady: function() {},
					onPublishTabReady: function() {},
					onPreviewLoad: function() {},
					onNavigate: function() {}
				},
				resources: {
					bodyClass: "",
					shellWrapperClass: "",
					designPanel: "/editor/nee/mainTabs/nee.designPanel.jsp",
					publishPanel: "/editor/nee/mainTabs/nee.publishPanel.jsp",
					redirectPanel: "/editor/nee/mainTabs/nee.redirectPanel.jsp",
					isInlineEdit: !0
				},
				dynamicResources: {
					publishPanel: function(a) {
						return $.dmui.getPublishPanelMarkup(a)
					}
				}
			},
			PROVIDERS: {
				product: {
					Default: {
						flowInterceptor: {
							onDesignTabReady: function() {
								_refreshBasicDesignViewForWidgets()
							},
							onPublishTabReady: function() {},
							onTemplatesTabReady: function() {}
						}
					}
				},
				platform: {
					Default: {}
				}
			}
		}
	} ()
});
var hexcase = 0,
b64pad = "";
function hex_sha1(a) {
	var e = 0;
	a = rstr2hex(rstr_sha1(str2rstr_utf8(a)));
	for (var d = 0; d < a.length; d++) e += a.charCodeAt(d);
	return e
}
function b64_sha1(a) {
	return rstr2b64(rstr_sha1(str2rstr_utf8(a)))
}
function any_sha1(a, e) {
	return rstr2any(rstr_sha1(str2rstr_utf8(a)), e)
}
function hex_hmac_sha1(a, e) {
	return rstr2hex(rstr_hmac_sha1(str2rstr_utf8(a), str2rstr_utf8(e)))
}
function b64_hmac_sha1(a, e) {
	return rstr2b64(rstr_hmac_sha1(str2rstr_utf8(a), str2rstr_utf8(e)))
}
function any_hmac_sha1(a, e, d) {
	return rstr2any(rstr_hmac_sha1(str2rstr_utf8(a), str2rstr_utf8(e)), d)
}
function sha1_vm_test() {
	return "a9993e364706816aba3e25717850c26c9cd0d89d" == hex_sha1("abc").toLowerCase()
}
function rstr_sha1(a) {
	return binb2rstr(binb_sha1(rstr2binb(a), 8 * a.length))
}
function rstr_hmac_sha1(a, e) {
	var d = rstr2binb(a);
	16 < d.length && (d = binb_sha1(d, 8 * a.length));
	for (var g = Array(16), j = Array(16), k = 0; 16 > k; k++) g[k] = d[k] ^ 909522486,
	j[k] = d[k] ^ 1549556828;
	d = binb_sha1(g.concat(rstr2binb(e)), 512 + 8 * e.length);
	return binb2rstr(binb_sha1(j.concat(d), 672))
}
function rstr2hex(a) {
	try {
		hexcase
	} catch(e) {
		hexcase = 0
	}
	for (var d = hexcase ? "0123456789ABCDEF": "0123456789abcdef", g = "", j, k = 0; k < a.length; k++) j = a.charCodeAt(k),
	g += d.charAt(j >>> 4 & 15) + d.charAt(j & 15);
	return g
}
function rstr2b64(a) {
	try {
		b64pad
	} catch(e) {
		b64pad = ""
	}
	for (var d = "",
	g = a.length,
	j = 0; j < g; j += 3) for (var k = a.charCodeAt(j) << 16 | (j + 1 < g ? a.charCodeAt(j + 1) << 8 : 0) | (j + 2 < g ? a.charCodeAt(j + 2) : 0), l = 0; 4 > l; l++) d = 8 * j + 6 * l > 8 * a.length ? d + b64pad: d + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k >>> 6 * (3 - l) & 63);
	return d
}
function rstr2any(a, e) {
	var d = e.length,
	g = [],
	j,
	k,
	l,
	m,
	n = Array(Math.ceil(a.length / 2));
	for (j = 0; j < n.length; j++) n[j] = a.charCodeAt(2 * j) << 8 | a.charCodeAt(2 * j + 1);
	for (; 0 < n.length;) {
		m = [];
		for (j = l = 0; j < n.length; j++) if (l = (l << 16) + n[j], k = Math.floor(l / d), l -= k * d, 0 < m.length || 0 < k) m[m.length] = k;
		g[g.length] = l;
		n = m
	}
	d = "";
	for (j = g.length - 1; 0 <= j; j--) d += e.charAt(g[j]);
	g = Math.ceil(8 * a.length / (Math.log(e.length) / Math.log(2)));
	for (j = d.length; j < g; j++) d = e[0] + d;
	return d
}
function str2rstr_utf8(a) {
	for (var e = "",
	d = -1,
	g, j; ++d < a.length;) g = a.charCodeAt(d),
	j = d + 1 < a.length ? a.charCodeAt(d + 1) : 0,
	55296 <= g && (56319 >= g && 56320 <= j && 57343 >= j) && (g = 65536 + ((g & 1023) << 10) + (j & 1023), d++),
	127 >= g ? e += String.fromCharCode(g) : 2047 >= g ? e += String.fromCharCode(192 | g >>> 6 & 31, 128 | g & 63) : 65535 >= g ? e += String.fromCharCode(224 | g >>> 12 & 15, 128 | g >>> 6 & 63, 128 | g & 63) : 2097151 >= g && (e += String.fromCharCode(240 | g >>> 18 & 7, 128 | g >>> 12 & 63, 128 | g >>> 6 & 63, 128 | g & 63));
	return e
}
function str2rstr_utf16le(a) {
	for (var e = "",
	d = 0; d < a.length; d++) e += String.fromCharCode(a.charCodeAt(d) & 255, a.charCodeAt(d) >>> 8 & 255);
	return e
}
function str2rstr_utf16be(a) {
	for (var e = "",
	d = 0; d < a.length; d++) e += String.fromCharCode(a.charCodeAt(d) >>> 8 & 255, a.charCodeAt(d) & 255);
	return e
}
function rstr2binb(a) {
	for (var e = Array(a.length >> 2), d = 0; d < e.length; d++) e[d] = 0;
	for (d = 0; d < 8 * a.length; d += 8) e[d >> 5] |= (a.charCodeAt(d / 8) & 255) << 24 - d % 32;
	return e
}
function binb2rstr(a) {
	for (var e = "",
	d = 0; d < 32 * a.length; d += 8) e += String.fromCharCode(a[d >> 5] >>> 24 - d % 32 & 255);
	return e
}
function binb_sha1(a, e) {
	a[e >> 5] |= 128 << 24 - e % 32;
	a[(e + 64 >> 9 << 4) + 15] = e;
	for (var d = Array(80), g = 1732584193, j = -271733879, k = -1732584194, l = 271733878, m = -1009589776, n = 0; n < a.length; n += 16) {
		for (var o = g,
		r = j,
		u = k,
		s = l,
		B = m,
		z = 0; 80 > z; z++) {
			d[z] = 16 > z ? a[n + z] : bit_rol(d[z - 3] ^ d[z - 8] ^ d[z - 14] ^ d[z - 16], 1);
			var v = safe_add(safe_add(bit_rol(g, 5), sha1_ft(z, j, k, l)), safe_add(safe_add(m, d[z]), sha1_kt(z))),
			m = l,
			l = k,
			k = bit_rol(j, 30),
			j = g,
			g = v
		}
		g = safe_add(g, o);
		j = safe_add(j, r);
		k = safe_add(k, u);
		l = safe_add(l, s);
		m = safe_add(m, B)
	}
	return [g, j, k, l, m]
}
function sha1_ft(a, e, d, g) {
	return 20 > a ? e & d | ~e & g: 40 > a ? e ^ d ^ g: 60 > a ? e & d | e & g | d & g: e ^ d ^ g
}
function sha1_kt(a) {
	return 20 > a ? 1518500249 : 40 > a ? 1859775393 : 60 > a ? -1894007588 : -899497514
}
function safe_add(a, e) {
	var d = (a & 65535) + (e & 65535);
	return (a >> 16) + (e >> 16) + (d >> 16) << 16 | d & 65535
}
function bit_rol(a, e) {
	return a << e | a >>> 32 - e
} (function(a, e, d) {
	function g(g, k) {
		function l(d) {
			a(m).each(function() {
				var e = a(this);
				this !== d.target && !e.has(d.target).length && e.triggerHandler(k, [d.target])
			})
		}
		k = k || g + d;
		var m = a(),
		n = g + "." + k + "-special-event";
		a.event.special[k] = {
			setup: function() {
				m = m.add(this);
				1 === m.length && a(e).bind(n, l)
			},
			teardown: function() {
				m = m.not(this);
				0 === m.length && a(e).unbind(n)
			},
			add: function(a) {
				var d = a.handler;
				a.handler = function(a, e) {
					a.target = e;
					d.apply(this, arguments)
				}
			}
		}
	}
	a.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),
	function(a) {
		g(a)
	});
	g("focusin", "focus" + d);
	g("focusout", "blur" + d);
	a.addOutsideEvent = g
})(jQuery, document, "outside"); (function(a) {
	function e(d) {
		var e = d.data;
		d.isDefaultPrevented() || (d.preventDefault(), a(this).ajaxSubmit(e))
	}
	function d(d) {
		var e = d.target,
		g = a(e);
		if (!g.is("[type\x3dsubmit],[type\x3dimage]")) {
			e = g.closest("[type\x3dsubmit]");
			if (0 === e.length) return;
			e = e[0]
		}
		var j = this;
		j.clk = e;
		"image" == e.type && (void 0 !== d.offsetX ? (j.clk_x = d.offsetX, j.clk_y = d.offsetY) : "function" == typeof a.fn.offset ? (g = g.offset(), j.clk_x = d.pageX - g.left, j.clk_y = d.pageY - g.top) : (j.clk_x = d.pageX - e.offsetLeft, j.clk_y = d.pageY - e.offsetTop));
		setTimeout(function() {
			j.clk = j.clk_x = j.clk_y = null
		},
		100)
	}
	function g() {
		if (a.fn.ajaxSubmit.debug) {
			var d = "[jquery.form] " + Array.prototype.join.call(arguments, "");
			window.console && window.console.log ? window.console.log(d) : window.opera && window.opera.postError && window.opera.postError(d)
		}
	}
	var j, k;
	j = void 0 !== a("\x3cinput type\x3d'file'/\x3e").get(0).files;
	k = void 0 !== window.FormData;
	var l = !!a.fn.prop;
	a.fn.attr2 = function() {
		if (!l) return this.attr.apply(this, arguments);
		var a = this.prop.apply(this, arguments);
		return a && a.jquery || "string" === typeof a ? a: this.attr.apply(this, arguments)
	};
	a.fn.ajaxSubmit = function(d) {
		function e(j) {
			function k(a) {
				var d = null;
				try {
					a.contentWindow && (d = a.contentWindow.document)
				} catch(e) {
					g("cannot get iframe.contentWindow document: " + e)
				}
				if (d) return d;
				try {
					d = a.contentDocument ? a.contentDocument: a.document
				} catch(j) {
					g("cannot get iframe.contentDocument: " + j),
					d = a.document
				}
				return d
			}
			function n() {
				function d() {
					try {
						var a = k(I).readyState;
						g("state \x3d " + a);
						a && "uninitialized" == a.toLowerCase() && setTimeout(d, 50)
					} catch(e) {
						g("Server abort: ", e, " (", e.name, ")"),
						r(ia),
						J && clearTimeout(J),
						J = void 0
					}
				}
				var e = u.attr2("target"),
				j = u.attr2("action");
				s.setAttribute("target", E);
				o || s.setAttribute("method", "POST");
				j != z.url && s.setAttribute("action", z.url); ! z.skipEncodingOverride && (!o || /post/i.test(o)) && u.attr({
					encoding: "multipart/form-data",
					enctype: "multipart/form-data"
				});
				z.timeout && (J = setTimeout(function() {
					G = !0;
					r(K)
				},
				z.timeout));
				var m = [];
				try {
					if (z.extraData) for (var l in z.extraData) z.extraData.hasOwnProperty(l) && (a.isPlainObject(z.extraData[l]) && z.extraData[l].hasOwnProperty("name") && z.extraData[l].hasOwnProperty("value") ? m.push(a('\x3cinput type\x3d"hidden" name\x3d"' + z.extraData[l].name + '"\x3e').val(z.extraData[l].value).appendTo(s)[0]) : m.push(a('\x3cinput type\x3d"hidden" name\x3d"' + l + '"\x3e').val(z.extraData[l]).appendTo(s)[0]));
					z.iframeTarget || (F.appendTo("body"), I.attachEvent ? I.attachEvent("onload", r) : I.addEventListener("load", r, !1));
					setTimeout(d, 15);
					try {
						s.submit()
					} catch(v) {
						document.createElement("form").submit.apply(s)
					}
				} finally {
					s.setAttribute("action", j),
					e ? s.setAttribute("target", e) : u.removeAttr("target"),
					a(m).remove()
				}
			}
			function r(d) {
				if (!C.aborted && !V) if (L = k(I), L || (g("cannot access response document"), d = ia), d === K && C) C.abort("timeout"),
				N.reject(C, "timeout");
				else if (d == ia && C) C.abort("server abort"),
				N.reject(C, "error", "server abort");
				else if (L && L.location.href != z.iframeSrc || G) {
					I.detachEvent ? I.detachEvent("onload", r) : I.removeEventListener("load", r, !1);
					d = "success";
					var e;
					try {
						if (G) throw "timeout";
						var j = "xml" == z.dataType || L.XMLDocument || a.isXMLDoc(L);
						g("isXml\x3d" + j);
						if (!j && (window.opera && (null === L.body || !L.body.innerHTML)) && --S) {
							g("requeing onLoad callback, DOM not available");
							setTimeout(r, 250);
							return
						}
						var m = L.body ? L.body: L.documentElement;
						C.responseText = m ? m.innerHTML: null;
						C.responseXML = L.XMLDocument ? L.XMLDocument: L;
						j && (z.dataType = "xml");
						C.getResponseHeader = function(a) {
							return {
								"content-type": z.dataType
							} [a]
						};
						m && (C.status = Number(m.getAttribute("status")) || C.status, C.statusText = m.getAttribute("statusText") || C.statusText);
						var n = (z.dataType || "").toLowerCase(),
						l = /(json|script|text)/.test(n);
						if (l || z.textarea) {
							var o = L.getElementsByTagName("textarea")[0];
							if (o) C.responseText = o.value,
							C.status = Number(o.getAttribute("status")) || C.status,
							C.statusText = o.getAttribute("statusText") || C.statusText;
							else if (l) {
								var s = L.getElementsByTagName("pre")[0],
								u = L.getElementsByTagName("body")[0];
								s ? C.responseText = s.textContent ? s.textContent: s.innerText: u && (C.responseText = u.textContent ? u.textContent: u.innerText)
							}
						} else "xml" == n && (!C.responseXML && C.responseText) && (C.responseXML = ba(C.responseText));
						try {
							var j = C,
							m = z,
							v = j.getResponseHeader("content-type") || "",
							B = "xml" === n || !n && 0 <= v.indexOf("xml"),
							E = B ? j.responseXML: j.responseText;
							B && "parsererror" === E.documentElement.nodeName && a.error && a.error("parsererror");
							m && m.dataFilter && (E = m.dataFilter(E, n));
							"string" === typeof E && ("json" === n || !n && 0 <= v.indexOf("json") ? E = La(E) : ("script" === n || !n && 0 <= v.indexOf("javascript")) && a.globalEval(E));
							ka = E
						} catch(O) {
							d = "parsererror",
							C.error = e = O || d
						}
					} catch(ha) {
						g("error caught: ", ha),
						d = "error",
						C.error = e = ha || d
					}
					C.aborted && (g("upload aborted"), d = null);
					C.status && (d = 200 <= C.status && 300 > C.status || 304 === C.status ? "success": "error");
					"success" === d ? (z.success && z.success.call(z.context, ka, "success", C), N.resolve(C.responseText, "success", C), D && a.event.trigger("ajaxSuccess", [C, z])) : d && (void 0 === e && (e = C.statusText), z.error && z.error.call(z.context, C, d, e), N.reject(C, "error", e), D && a.event.trigger("ajaxError", [C, z, e]));
					D && a.event.trigger("ajaxComplete", [C, z]);
					D && !--a.active && a.event.trigger("ajaxStop");
					z.complete && z.complete.call(z.context, C, d);
					V = !0;
					z.timeout && clearTimeout(J);
					setTimeout(function() {
						z.iframeTarget || F.remove();
						C.responseXML = null
					},
					100)
				}
			}
			var s = u[0],
			v,
			z,
			D,
			E,
			F,
			I,
			C,
			G,
			J,
			N = a.Deferred();
			N.abort = function(a) {
				C.abort(a)
			};
			if (j) for (v = 0; v < B.length; v++) j = a(B[v]),
			l ? j.prop("disabled", !1) : j.removeAttr("disabled");
			z = a.extend(!0, {},
			a.ajaxSettings, d);
			z.context = z.context || z;
			E = "jqFormIO" + (new Date).getTime();
			z.iframeTarget ? (F = a(z.iframeTarget), (v = F.attr2("name")) ? E = v: F.attr2("name", E)) : (F = a('\x3ciframe name\x3d"' + E + '" src\x3d"' + z.iframeSrc + '" /\x3e'), F.css({
				position: "absolute",
				top: "-1000px",
				left: "-1000px"
			}));
			I = F[0];
			C = {
				aborted: 0,
				responseText: null,
				responseXML: null,
				status: 0,
				statusText: "n/a",
				getAllResponseHeaders: function() {},
				getResponseHeader: function() {},
				setRequestHeader: function() {},
				abort: function(d) {
					var e = "timeout" === d ? "timeout": "aborted";
					g("aborting upload... " + e);
					this.aborted = 1;
					try {
						I.contentWindow.document.execCommand && I.contentWindow.document.execCommand("Stop")
					} catch(j) {}
					F.attr("src", z.iframeSrc);
					C.error = e;
					z.error && z.error.call(z.context, C, e, d);
					D && a.event.trigger("ajaxError", [C, z, e]);
					z.complete && z.complete.call(z.context, C, e)
				}
			}; (D = z.global) && 0 === a.active++&&a.event.trigger("ajaxStart");
			D && a.event.trigger("ajaxSend", [C, z]);
			if (z.beforeSend && !1 === z.beforeSend.call(z.context, C, z)) return z.global && a.active--,
			N.reject(),
			N;
			if (C.aborted) return N.reject(),
			N;
			if (j = s.clk) if ((v = j.name) && !j.disabled) z.extraData = z.extraData || {},
			z.extraData[v] = j.value,
			"image" == j.type && (z.extraData[v + ".x"] = s.clk_x, z.extraData[v + ".y"] = s.clk_y);
			var K = 1,
			ia = 2;
			j = a("meta[name\x3dcsrf-token]").attr("content");
			if ((v = a("meta[name\x3dcsrf-param]").attr("content")) && j) z.extraData = z.extraData || {},
			z.extraData[v] = j;
			z.forceSync ? n() : setTimeout(n, 10);
			var ka, L, S = 50,
			V, ba = a.parseXML ||
			function(a, d) {
				window.ActiveXObject ? (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(a)) : d = (new DOMParser).parseFromString(a, "text/xml");
				return d && d.documentElement && "parsererror" != d.documentElement.nodeName ? d: null
			},
			La = a.parseJSON ||
			function(a) {
				return window.eval("(" + a + ")")
			};
			return N
		}
		if (!this.length) return g("ajaxSubmit: skipping submit process - no element selected"),
		this;
		var o, r, u = this;
		"function" == typeof d ? d = {
			success: d
		}: void 0 === d && (d = {});
		o = d.type || this.attr2("method");
		r = d.url || this.attr2("action"); (r = (r = "string" === typeof r ? a.trim(r) : "") || window.location.href || "") && (r = (r.match(/^([^#]+)/) || [])[1]);
		d = a.extend(!0, {
			url: r,
			success: a.ajaxSettings.success,
			type: o || a.ajaxSettings.type,
			iframeSrc: /^https/i.test(window.location.href || "") ? "javascript:false": "about:blank"
		},
		d);
		r = {};
		this.trigger("form-pre-serialize", [this, d, r]);
		if (r.veto) return g("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),
		this;
		if (d.beforeSerialize && !1 === d.beforeSerialize(this, d)) return g("ajaxSubmit: submit aborted via beforeSerialize callback"),
		this;
		var s = d.traditional;
		void 0 === s && (s = a.ajaxSettings.traditional);
		var B = [],
		z,
		v = this.formToArray(d.semantic, B);
		d.data && (d.extraData = d.data, z = a.param(d.data, s));
		if (d.beforeSubmit && !1 === d.beforeSubmit(v, this, d)) return g("ajaxSubmit: submit aborted via beforeSubmit callback"),
		this;
		this.trigger("form-submit-validate", [v, this, d, r]);
		if (r.veto) return g("ajaxSubmit: submit vetoed via form-submit-validate trigger"),
		this;
		r = a.param(v, s);
		z && (r = r ? r + "\x26" + z: z);
		"GET" == d.type.toUpperCase() ? (d.url += (0 <= d.url.indexOf("?") ? "\x26": "?") + r, d.data = null) : d.data = r;
		var D = [];
		d.resetForm && D.push(function() {
			u.resetForm()
		});
		d.clearForm && D.push(function() {
			u.clearForm(d.includeHidden)
		});
		if (!d.dataType && d.target) {
			var E = d.success ||
			function() {};
			D.push(function(e) {
				var g = d.replaceTarget ? "replaceWith": "html";
				a(d.target)[g](e).each(E, arguments)
			})
		} else d.success && D.push(d.success);
		d.success = function(a, e, g) {
			for (var j = d.context || this,
			k = 0,
			n = D.length; k < n; k++) D[k].apply(j, [a, e, g || u, u])
		};
		if (d.error) {
			var F = d.error;
			d.error = function(a, e, g) {
				F.apply(d.context || this, [a, e, g, u])
			}
		}
		if (d.complete) {
			var I = d.complete;
			d.complete = function(a, e) {
				I.apply(d.context || this, [a, e, u])
			}
		}
		z = 0 < a('input[type\x3dfile]:enabled:not([value\x3d""])', this).length;
		r = "multipart/form-data" == u.attr("enctype") || "multipart/form-data" == u.attr("encoding");
		s = j && k;
		g("fileAPI :" + s);
		var G;
		if (!1 !== d.iframe && (d.iframe || (z || r) && !s)) d.closeKeepAlive ? a.get(d.closeKeepAlive,
		function() {
			G = e(v)
		}) : G = e(v);
		else if ((z || r) && s) {
			var K = new FormData;
			for (r = 0; r < v.length; r++) K.append(v[r].name, v[r].value);
			if (d.extraData) {
				r = a.param(d.extraData, d.traditional).split("\x26");
				s = r.length;
				z = [];
				var J, C;
				for (J = 0; J < s; J++) r[J] = r[J].replace(/\+/g, " "),
				C = r[J].split("\x3d"),
				z.push([decodeURIComponent(C[0]), decodeURIComponent(C[1])]);
				for (r = 0; r < z.length; r++) z[r] && K.append(z[r][0], z[r][1])
			}
			d.data = null;
			z = a.extend(!0, {},
			a.ajaxSettings, d, {
				contentType: !1,
				processData: !1,
				cache: !1,
				type: o || "POST"
			});
			d.uploadProgress && (z.xhr = function() {
				var e = a.ajaxSettings.xhr();
				e.upload && e.upload.addEventListener("progress",
				function(a) {
					var e = 0,
					g = a.loaded || a.position,
					j = a.total;
					a.lengthComputable && (e = Math.ceil(100 * (g / j)));
					d.uploadProgress(a, g, j, e)
				},
				!1);
				return e
			});
			z.data = null;
			var N = z.beforeSend;
			z.beforeSend = function(a, d) {
				d.data = K;
				N && N.call(this, a, d)
			};
			G = a.ajax(z)
		} else G = a.ajax(d);
		u.removeData("jqxhr").data("jqxhr", G);
		for (z = 0; z < B.length; z++) B[z] = null;
		this.trigger("form-submit-notify", [this, d]);
		return this
	};
	a.fn.ajaxForm = function(j) {
		j = j || {};
		j.delegation = j.delegation && a.isFunction(a.fn.on);
		if (!j.delegation && 0 === this.length) {
			var k = this.selector,
			l = this.context;
			if (!a.isReady && k) return g("DOM not ready, queuing ajaxForm"),
			a(function() {
				a(k, l).ajaxForm(j)
			}),
			this;
			g("terminating; zero elements found by selector" + (a.isReady ? "": " (DOM not ready)"));
			return this
		}
		return j.delegation ? (a(document).off("submit.form-plugin", this.selector, e).off("click.form-plugin", this.selector, d).on("submit.form-plugin", this.selector, j, e).on("click.form-plugin", this.selector, j, d), this) : this.ajaxFormUnbind().bind("submit.form-plugin", j, e).bind("click.form-plugin", j, d)
	};
	a.fn.ajaxFormUnbind = function() {
		return this.unbind("submit.form-plugin click.form-plugin")
	};
	a.fn.formToArray = function(d, e) {
		var g = [];
		if (0 === this.length) return g;
		var k = this[0],
		l = d ? k.getElementsByTagName("*") : k.elements;
		if (!l) return g;
		var s, B, z, v, D, E;
		s = 0;
		for (E = l.length; s < E; s++) if (D = l[s], (z = D.name) && !D.disabled) if (d && k.clk && "image" == D.type) k.clk == D && (g.push({
			name: z,
			value: a(D).val(),
			type: D.type
		}), g.push({
			name: z + ".x",
			value: k.clk_x
		},
		{
			name: z + ".y",
			value: k.clk_y
		}));
		else if ((v = a.fieldValue(D, !0)) && v.constructor == Array) {
			e && e.push(D);
			B = 0;
			for (D = v.length; B < D; B++) g.push({
				name: z,
				value: v[B]
			})
		} else if (j && "file" == D.type) if (e && e.push(D), v = D.files, v.length) for (B = 0; B < v.length; B++) g.push({
			name: z,
			value: v[B],
			type: D.type
		});
		else g.push({
			name: z,
			value: "",
			type: D.type
		});
		else null !== v && "undefined" != typeof v && (e && e.push(D), g.push({
			name: z,
			value: v,
			type: D.type,
			required: D.required
		}));
		if (!d && k.clk && (l = a(k.clk), s = l[0], (z = s.name) && !s.disabled && "image" == s.type)) g.push({
			name: z,
			value: l.val()
		}),
		g.push({
			name: z + ".x",
			value: k.clk_x
		},
		{
			name: z + ".y",
			value: k.clk_y
		});
		return g
	};
	a.fn.formSerialize = function(d) {
		return a.param(this.formToArray(d))
	};
	a.fn.fieldSerialize = function(d) {
		var e = [];
		this.each(function() {
			var g = this.name;
			if (g) {
				var j = a.fieldValue(this, d);
				if (j && j.constructor == Array) for (var k = 0,
				l = j.length; k < l; k++) e.push({
					name: g,
					value: j[k]
				});
				else null !== j && "undefined" != typeof j && e.push({
					name: this.name,
					value: j
				})
			}
		});
		return a.param(e)
	};
	a.fn.fieldValue = function(d) {
		for (var e = [], g = 0, j = this.length; g < j; g++) {
			var k = a.fieldValue(this[g], d);
			null === k || ("undefined" == typeof k || k.constructor == Array && !k.length) || (k.constructor == Array ? a.merge(e, k) : e.push(k))
		}
		return e
	};
	a.fieldValue = function(d, e) {
		var g = d.name,
		j = d.type,
		k = d.tagName.toLowerCase();
		void 0 === e && (e = !0);
		if (e && (!g || d.disabled || "reset" == j || "button" == j || ("checkbox" == j || "radio" == j) && !d.checked || ("submit" == j || "image" == j) && d.form && d.form.clk != d || "select" == k && -1 == d.selectedIndex)) return null;
		if ("select" == k) {
			var l = d.selectedIndex;
			if (0 > l) return null;
			for (var g = [], k = d.options, B = (j = "select-one" == j) ? l + 1 : k.length, l = j ? l: 0; l < B; l++) {
				var z = k[l];
				if (z.selected) {
					var v = z.value;
					v || (v = z.attributes && z.attributes.value && !z.attributes.value.specified ? z.text: z.value);
					if (j) return v;
					g.push(v)
				}
			}
			return g
		}
		return a(d).val()
	};
	a.fn.clearForm = function(d) {
		return this.each(function() {
			a("input,select,textarea", this).clearFields(d)
		})
	};
	a.fn.clearFields = a.fn.clearInputs = function(d) {
		var e = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
		return this.each(function() {
			var g = this.type,
			j = this.tagName.toLowerCase();
			if (e.test(g) || "textarea" == j) this.value = "";
			else if ("checkbox" == g || "radio" == g) this.checked = !1;
			else if ("select" == j) this.selectedIndex = -1;
			else if ("file" == g) / MSIE / .test(navigator.userAgent) ? a(this).replaceWith(a(this).clone(!0)) : a(this).val("");
			else if (d && (!0 === d && /hidden/.test(g) || "string" == typeof d && a(this).is(d))) this.value = ""
		})
	};
	a.fn.resetForm = function() {
		return this.each(function() { ("function" == typeof this.reset || "object" == typeof this.reset && !this.reset.nodeType) && this.reset()
		})
	};
	a.fn.enable = function(a) {
		void 0 === a && (a = !0);
		return this.each(function() {
			this.disabled = !a
		})
	};
	a.fn.selected = function(d) {
		void 0 === d && (d = !0);
		return this.each(function() {
			var e = this.type;
			"checkbox" == e || "radio" == e ? this.checked = d: "option" == this.tagName.toLowerCase() && (e = a(this).parent("select"), d && (e[0] && "select-one" == e[0].type) && e.find("option").selected(!1), this.selected = d)
		})
	};
	a.fn.ajaxSubmit.debug = !1
})("undefined" != typeof jQuery ? jQuery: window.Zepto); (function(a) {
	a.extend({
		previewExternalLink: {
			lastEditedPage: "",
			thereIsPreviewBtn: !1,
			setBackFromExternal: function(e) {
				var d = this,
				g = a("#PreviewPaneWrapper .PreviewPaneInnerWrapper"),
				j = "#_preview",
				k = document.createElement("div"),
				l = document.createElement("a");
				a(l).html(dmStr["ui.back"]);
				a(l).attr("id", "previewBackButton");
				a(k).attr("id", "previewBackButtonWarper");
				var m = a("#previewBackButtonWarper");
				a(k).append(l);
				0 < m.length && m.remove();
				0 === a("#previewBackButtonWarper").length && !1 === d.thereIsPreviewBtn && (!0 == e && (j = "#iframeWindow", g = a("#neePrevieweviceWrapper .neeIframeWrapper"), 0 == g.length && (g = a(".PreviewPaneInnerWrapper"), j = "#_preview")), window.setTimeout(function() {
					g.append(k)
				},
				2E3), a(k).css("z-index", parseInt(g.css("z-index")) + 1), a(l).on("click",
				function(a) {
					a.preventDefault();
					d.backToLastEditePage(j);
					d.removeBackBtn()
				}), d.thereIsPreviewBtn = !0)
			},
			setLastEditePage: function(a) {
				this.lastEditedPage = a
			},
			backToLastEditePage: function(e) {
				a("#backBtnWarper").remove();
				this.thereIsPreviewBtn = !1;
				a && a.ptPages && (a.ptPages.arrivedFromClick = !1);
				e ? a(e).attr("src", this.lastEditedPage) : a("iframe#_preview").attr("src", this.lastEditedPage)
			},
			removeBackBtn: function() {
				this.thereIsPreviewBtn = !1;
				a("#previewBackButtonWarper").remove()
			}
		}
	})
})(jQuery); (function(a) {
	var e = function(d, e) {
		this.options = e;
		this.$elementFilestyle = [];
		this.$element = a(d)
	};
	e.prototype = {
		clear: function() {
			this.$element.val("");
			this.$elementFilestyle.find(":text").val("")
		},
		destroy: function() {
			this.$element.removeAttr("style").removeData("filestyle").val("");
			this.$elementFilestyle.remove()
		},
		icon: function(a) {
			if (!0 === a) this.options.icon || (this.options.icon = !0, this.$elementFilestyle.find("label").prepend(this.htmlIcon()));
			else if (!1 === a) this.options.icon && (this.options.icon = !1, this.$elementFilestyle.find("i").remove());
			else return this.options.icon
		},
		input: function(a) {
			if (!0 === a) {
				if (!this.options.input) {
					this.options.input = !0;
					this.$elementFilestyle.prepend(this.htmlInput());
					a = "";
					var d = [];
					void 0 === this.$element[0].files ? d[0] = {
						name: this.$element[0].value
					}: d = this.$element[0].files;
					for (var e = 0; e < d.length; e++) a += d[e].name.split("\\").pop() + ", ";
					"" !== a && this.$elementFilestyle.find(":text").val(a.replace(/\, $/g, ""))
				}
			} else if (!1 === a) this.options.input && (this.options.input = !1, this.$elementFilestyle.find(":text").remove());
			else return this.options.input
		},
		buttonText: function(a) {
			if (void 0 !== a) this.options.buttonText = a,
			this.$elementFilestyle.find("label span").html(this.options.buttonText);
			else return this.options.buttonText
		},
		classButton: function(a) {
			if (void 0 !== a) this.options.classButton = a,
			this.$elementFilestyle.find("label").attr({
				"class": this.options.classButton
			}),
			-1 !== this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) ? this.$elementFilestyle.find("label i").addClass("icon-white") : this.$elementFilestyle.find("label i").removeClass("icon-white");
			else return this.options.classButton
		},
		classIcon: function(a) {
			if (void 0 !== a) this.options.classIcon = a,
			-1 !== this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) ? this.$elementFilestyle.find("label").find("i").attr({
				"class": "icon-white " + this.options.classIcon
			}) : this.$elementFilestyle.find("label").find("i").attr({
				"class": this.options.classIcon
			});
			else return this.options.classIcon
		},
		classInput: function(a) {
			if (void 0 !== a) this.options.classInput = a,
			this.$elementFilestyle.find(":text").addClass(this.options.classInput);
			else return this.options.classInput
		},
		htmlIcon: function() {
			if (this.options.icon) {
				var a = ""; - 1 !== this.options.classButton.search(/btn-inverse|btn-primary|btn-danger|btn-warning|btn-success/i) && (a = " icon-white ");
				return '\x3ci class\x3d"' + a + this.options.classIcon + '"\x3e\x3c/i\x3e '
			}
			return ""
		},
		htmlInput: function() {
			return this.options.input ? '\x3cinput type\x3d"text" class\x3d"' + this.options.classInput + '" disabled\x3e ': ""
		},
		constructor: function() {
			var d = this,
			e = "",
			e = this.$element.attr("id"),
			k = [];
			if ("" === e || !e) e = "filestyle-" + a(".bootstrap-filestyle").length,
			this.$element.attr({
				id: e
			});
			e = this.htmlInput() + '\x3clabel for\x3d"' + e + '" class\x3d"' + this.options.classButton + '"\x3e' + this.htmlIcon() + "\x3cspan\x3e" + this.options.buttonText + "\x3c/span\x3e\x3c/label\x3e";
			this.$elementFilestyle = a('\x3cdiv class\x3d"bootstrap-filestyle" style\x3d"display: inline;"\x3e' + e + "\x3c/div\x3e");
			this.$element.css({
				position: "fixed",
				left: "-500px"
			}).after(this.$elementFilestyle);
			this.$element.change(function() {
				var a = "";
				void 0 === this.files ? k[0] = {
					name: this.value
				}: k = this.files;
				for (var e = 0; e < k.length; e++) a += k[e].name.split("\\").pop() + ", ";
				"" !== a && d.$elementFilestyle.find(":text").val(a.replace(/\, $/g, ""))
			}); - 1 < window.navigator.userAgent.search(/firefox/i) && this.$elementFilestyle.find("label").click(function() {
				d.$element.click();
				return ! 1
			})
		}
	};
	var d = a.fn.filestyle;
	a.fn.filestyle = function(d, j) {
		var k = "",
		l = this.each(function() {
			if ("file" === a(this).attr("type")) {
				var m = a(this),
				n = m.data("filestyle"),
				l = a.extend({},
				a.fn.filestyle.defaults, d, "object" === typeof d && d);
				n || (m.data("filestyle", n = new e(this, l)), n.constructor());
				"string" === typeof d && (k = n[d](j))
			}
		});
		return void 0 !== typeof k ? k: l
	};
	a.fn.filestyle.defaults = {
		buttonText: "Choose file",
		input: !0,
		icon: !0,
		classButton: "btn",
		classInput: "input-large",
		classIcon: "icon-folder-open"
	};
	a.fn.filestyle.noConflict = function() {
		a.fn.filestyle = d;
		return this
	};
	a(".filestyle").each(function() {
		var d = a(this),
		e = {
			buttonText: d.attr("data-buttonText"),
			input: "false" === d.attr("data-input") ? !1 : !0,
			icon: "false" === d.attr("data-icon") ? !1 : !0,
			classButton: d.attr("data-classButton"),
			classInput: d.attr("data-classInput"),
			classIcon: d.attr("data-classIcon")
		};
		d.filestyle(e)
	})
})(window.jQuery);
var Colors = new
function() {
	function a() {
		var e = 0,
		d = 0,
		g = 0,
		j = 0,
		k = 0,
		l = 0;
		this.SetRGB = function(a, n, o) {
			if (isNaN(a) || isNaN(n) || isNaN(o)) return ! 1;
			a /= 255;
			e = 1 < a ? 1 : 0 > a ? 0 : a;
			n /= 255;
			d = 1 < n ? 1 : 0 > n ? 0 : n;
			o /= 255;
			g = 1 < o ? 1 : 0 > o ? 0 : o;
			a = Math.max(Math.max(e, d), g);
			n = Math.min(Math.min(e, d), g);
			l = a;
			k = 0;
			0 != a && (k = 1 - n / a);
			j = 0;
			n != a && (n = a - n, j = e == a ? (d - g) / n: d == a ? 2 + (g - e) / n: 4 + (e - d) / n, j *= 60, 0 > j && (j += 360));
			return ! 0
		};
		this.Red = function() {
			return Math.round(255 * e)
		};
		this.Green = function() {
			return Math.round(255 * d)
		};
		this.Blue = function() {
			return Math.round(255 * g)
		};
		this.SetHSV = function(a, n, o) {
			if (isNaN(a) || isNaN(n) || isNaN(o)) return ! 1;
			j = 360 <= a ? 359.99 : 0 > a ? 0 : a;
			k = 1 < n ? 1 : 0 > n ? 0 : n;
			l = 1 < o ? 1 : 0 > o ? 0 : o;
			g = d = e = l;
			if (! (0 == l || 0 == k)) {
				n = j / 60;
				a = Math.floor(n);
				var r = n - a;
				n = l * (1 - k);
				o = l * (1 - k * r);
				r = l * (1 - k * (1 - r));
				switch (a) {
				case 0:
					e = l;
					d = r;
					g = n;
					break;
				case 1:
					e = o;
					d = l;
					g = n;
					break;
				case 2:
					e = n;
					d = l;
					g = r;
					break;
				case 3:
					e = n;
					d = o;
					g = l;
					break;
				case 4:
					e = r;
					d = n;
					g = l;
					break;
				default:
					e = l,
					d = n,
					g = o
				}
			}
			return ! 0
		};
		this.Hue = function() {
			return j
		};
		this.Saturation = function() {
			return k
		};
		this.Value = function() {
			return l
		};
		this.SetHexString = function(a) {
			if (null == a || "string" != typeof a) return ! 1;
			"#" == a.substr(0, 1) && (a = a.substr(1));
			if (6 != a.length) return ! 1;
			var d = parseInt(a.substr(0, 2), 16),
			e = parseInt(a.substr(2, 2), 16);
			a = parseInt(a.substr(4, 2), 16);
			return this.SetRGB(d, e, a)
		};
		this.HexString = function() {
			var a = this.Red().toString(16);
			1 == a.length && (a = "0" + a);
			var d = this.Green().toString(16);
			1 == d.length && (d = "0" + d);
			var e = this.Blue().toString(16);
			1 == e.length && (e = "0" + e);
			return (a + d + e).toUpperCase()
		};
		this.Complement = function() {
			var d = 180 <= j ? j - 180 : j + 180,
			e = l * (k - 1) + 1,
			g = l * k / e,
			r = new a;
			r.SetHSV(d, g, e);
			return r
		}
	}
	this.ColorFromHSV = function(e, d, g) {
		var j = new a;
		j.SetHSV(e, d, g);
		return j
	};
	this.ColorFromRGB = function(e, d, g) {
		var j = new a;
		j.SetRGB(e, d, g);
		return j
	};
	this.ColorFromHex = function(e) {
		var d = new a;
		d.SetHexString(e);
		return d
	}
};
function Position(a, e) {
	this.X = a;
	this.Y = e;
	this.Add = function(a) {
		var e = new Position(this.X, this.Y);
		null != a && (isNaN(a.X) || (e.X += a.X), isNaN(a.Y) || (e.Y += a.Y));
		return e
	};
	this.Subtract = function(a) {
		var e = new Position(this.X, this.Y);
		null != a && (isNaN(a.X) || (e.X -= a.X), isNaN(a.Y) || (e.Y -= a.Y));
		return e
	};
	this.Min = function(a) {
		var e = new Position(this.X, this.Y);
		if (null == a) return e; ! isNaN(a.X) && this.X > a.X && (e.X = a.X); ! isNaN(a.Y) && this.Y > a.Y && (e.Y = a.Y);
		return e
	};
	this.Max = function(a) {
		var e = new Position(this.X, this.Y);
		if (null == a) return e; ! isNaN(a.X) && this.X < a.X && (e.X = a.X); ! isNaN(a.Y) && this.Y < a.Y && (e.Y = a.Y);
		return e
	};
	this.Bound = function(a, e) {
		return this.Max(a).Min(e)
	};
	this.Check = function() {
		var a = new Position(this.X, this.Y);
		isNaN(a.X) && (a.X = 0);
		isNaN(a.Y) && (a.Y = 0);
		return a
	};
	this.Apply = function(a) {
		"string" == typeof a && (a = document.getElementById(a));
		null != a && (isNaN(this.X) || (a.style.left = this.X + "px"), isNaN(this.Y) || (a.style.top = this.Y + "px"))
	}
}
var pointerOffset = new Position(0, 0 <= navigator.userAgent.indexOf("Firefox") ? 1 : 0),
circleOffset = new Position(5, 5),
arrowsOffset = new Position(0, 4),
arrowsLowBounds = new Position(0, -4),
arrowsUpBounds = new Position(0, 128),
circleLowBounds = new Position( - 5, -5),
circleUpBounds = new Position(127, 127);
function correctOffset(a, e, d) {
	return d ? a.Subtract(e) : a.Add(e)
}
function hookEvent(a, e, d) {
	"string" == typeof a && (a = document.getElementById(a));
	null != a && (a.addEventListener ? a.addEventListener(e, d, !1) : a.attachEvent && a.attachEvent("on" + e, d))
}
function unhookEvent(a, e, d) {
	"string" == typeof a && (a = document.getElementById(a));
	null != a && (a.removeEventListener ? a.removeEventListener(e, d, !1) : a.detachEvent && a.detachEvent("on" + e, d))
}
function cancelEvent(a) {
	a = a ? a: window.event;
	a.stopPropagation && a.stopPropagation();
	a.preventDefault && a.preventDefault();
	a.cancelBubble = !0;
	a.cancel = !0;
	return a.returnValue = !1
}
function getMousePos(a) {
	a = a ? a: window.event;
	a = isNaN(a.layerX) ? new Position(a.offsetX, a.offsetY) : new Position(a.layerX, a.layerY);
	return correctOffset(a, pointerOffset, !0)
}
function getEventTarget(a) {
	a = a ? a: window.event;
	return a.target ? a.target: a.srcElement
}
function absoluteCursorPostion(a) {
	a = a ? a: window.event;
	return isNaN(window.scrollX) ? new Position(a.clientX + document.documentElement.scrollLeft + document.body.scrollLeft, a.clientY + document.documentElement.scrollTop + document.body.scrollTop) : new Position(a.clientX + window.scrollX, a.clientY + window.scrollY)
}
function dragObject(a, e, d, g, j, k, l, m) {
	function n(d) {
		if (!v && D && !E) return v = !0,
		null != j && j(d, a),
		B = absoluteCursorPostion(d),
		z = new Position(parseInt(a.style.left), parseInt(a.style.top)),
		z = z.Check(),
		hookEvent(document, "mousemove", o),
		hookEvent(document, "mouseup", r),
		cancelEvent(d)
	}
	function o(e) {
		if (v && !E) {
			var j = absoluteCursorPostion(e),
			j = j.Add(z).Subtract(B),
			j = j.Bound(d, g);
			j.Apply(a);
			null != k && k(j, a);
			return cancelEvent(e)
		}
	}
	function r(a) {
		u();
		return cancelEvent(a)
	}
	function u() {
		v && !E && (unhookEvent(document, "mousemove", o), unhookEvent(document, "mouseup", r), z = B = null, null != l && l(a), v = !1)
	}
	"string" == typeof a && (a = document.getElementById(a));
	if (null != a) {
		if (null != d && null != g) {
			var s = d.Min(g);
			g = d.Max(g);
			d = s
		}
		var B = null,
		z = null,
		v = !1,
		D = !1,
		E = !1;
		this.Dispose = function() {
			E || (this.StopListening(!0), l = k = j = g = d = e = a = null, E = !0)
		};
		this.StartListening = function() { ! D && !E && (D = !0, hookEvent(e, "mousedown", n))
		};
		this.StopListening = function(a) {
			D && !E && (unhookEvent(e, "mousedown", n), D = !1, a && v && u())
		};
		this.IsDragging = function() {
			return v
		};
		this.IsListening = function() {
			return D
		};
		this.IsDisposed = function() {
			return E
		};
		"string" == typeof e && (e = document.getElementById(e));
		null == e && (e = a);
		m || this.StartListening()
	}
}
function arrowsDown(a, e) {
	var d = getMousePos(a);
	getEventTarget(a) == e && (d.Y += parseInt(e.style.top));
	d = correctOffset(d, arrowsOffset, !0);
	d = d.Bound(arrowsLowBounds, arrowsUpBounds);
	d.Apply(e);
	arrowsMoved(d)
}
function circleDown(a, e) {
	var d = getMousePos(a);
	getEventTarget(a) == e && (d.X += parseInt(e.style.left), d.Y += parseInt(e.style.top));
	d = correctOffset(d, circleOffset, !0);
	d = d.Bound(circleLowBounds, circleUpBounds);
	d.Apply(e);
	circleMoved(d)
}
function arrowsMoved(a) {
	a = correctOffset(a, arrowsOffset, !1);
	currentColor.SetHSV(359.99 * (133 - a.Y) / 132, currentColor.Saturation(), currentColor.Value());
	colorChanged("arrows")
}
function circleMoved(a) {
	a = correctOffset(a, circleOffset, !1);
	var e = 1 - a.X / 132;
	a = 1 - a.Y / 132;
	currentColor.SetHSV(currentColor.Hue(), 1 - e, a);
	colorChanged("circle")
}
function colorChanged(a) {
	document.getElementById("hexBox").value = currentColor.HexString();
	document.getElementById("redBox").value = currentColor.Red();
	document.getElementById("greenBox").value = currentColor.Green();
	document.getElementById("blueBox").value = currentColor.Blue();
	if ("arrows" == a || "box" == a) document.getElementById("gradientBox").style.backgroundColor = "#" + Colors.ColorFromHSV(currentColor.Hue(), 1, 1).HexString();
	"box" == a && (document.getElementById("arrows").style.top = 133 - 132 * currentColor.Hue() / 359.99 - arrowsOffset.Y + "px", a = new Position(132 * (1 - (1 - currentColor.Saturation())), 132 * (1 - currentColor.Value())), a = correctOffset(a, circleOffset, !0), a.Apply("circle"), endMovement());
	document.getElementById("quickColor").style.backgroundColor = "#" + currentColor.HexString()
}
function endMovement() {
	document.getElementById("staticColor").style.backgroundColor = "#" + currentColor.HexString()
}
function hexBoxChanged() {
	currentColor.SetHexString(document.getElementById("hexBox").value);
	colorChanged("box")
}
function redBoxChanged() {
	currentColor.SetRGB(parseInt(document.getElementById("redBox").value), currentColor.Green(), currentColor.Blue());
	colorChanged("box")
}
function greenBoxChanged() {
	currentColor.SetRGB(currentColor.Red(), parseInt(document.getElementById("greenBox").value), currentColor.Blue());
	colorChanged("box")
}
function blueBoxChanged() {
	currentColor.SetRGB(currentColor.Red(), currentColor.Green(), parseInt(document.getElementById("blueBox").value));
	colorChanged("box")
}
function hueBoxChanged() {
	currentColor.SetHSV(parseFloat(document.getElementById("hueBox").value), currentColor.Saturation(), currentColor.Value());
	colorChanged("box")
}
function saturationBoxChanged() {
	currentColor.SetHSV(currentColor.Hue(), parseFloat(document.getElementById("saturationBox").value) / 100, currentColor.Value());
	colorChanged("box")
}
function valueBoxChanged() {
	currentColor.SetHSV(currentColor.Hue(), currentColor.Saturation(), parseFloat(document.getElementById("valueBox").value) / 100);
	colorChanged("box")
}
function fixPNG(a) {
	if (document.body.filters) {
		var e = navigator.appVersion.split("MSIE"),
		e = parseFloat(e[1]);
		5.5 > e || 7 <= e || (a.outerHTML = "\x3cspan " + (a.id ? "id\x3d'" + a.id + "' ": "") + ' style\x3d"width:' + a.width + "px; height:" + a.height + "px;" + ("display:inline-block;" + a.style.cssText) + ";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'" + a.src + "', sizingMethod\x3d'scale');\"\x3e\x3c/span\x3e")
	}
}
function fixGradientImg() {
	fixPNG(document.getElementById("gradientImg"))
} (function(a) {
	var e = function(a, e) {
		return this.convert(a, e)
	};
	e.prototype = {
		_rgb: {
			r: {
				min: 0,
				max: 255
			},
			g: {
				min: 0,
				max: 255
			},
			b: {
				min: 0,
				max: 255
			}
		},
		_hsv: {
			h: {
				min: 0,
				max: 359
			},
			s: {
				min: 0,
				max: 100
			},
			v: {
				min: 0,
				max: 100
			}
		},
		_xyz: {
			x: {
				min: 0,
				max: 95.047
			},
			y: {
				min: 0,
				max: 100
			},
			z: {
				min: 0,
				max: 108.883
			}
		},
		_lab: {
			l: {
				min: 0,
				max: 100
			},
			a: {
				min: -128,
				max: 127
			},
			b: {
				min: -128,
				max: 127
			}
		},
		_white: {
			x: 95.047,
			y: 100,
			z: 108.883
		},
		_human: {
			red: "FF0000",
			tan: "D2B48C",
			aqua: "00FFFF",
			blue: "0000FF",
			cyan: "00FFFF",
			gold: "FFD700",
			gray: "808080",
			lime: "00FF00",
			navy: "000080",
			peru: "CD853F",
			pink: "FFC0CB",
			plum: "DDA0DD",
			snow: "FFFAFA",
			teal: "008080",
			azure: "F0FFFF",
			beige: "F5F5DC",
			black: "000000",
			brown: "A52A2A",
			coral: "FF7F50",
			green: "008000",
			ivory: "FFFFF0",
			khaki: "F0E68C",
			linen: "FAF0E6",
			olive: "808000",
			wheat: "F5DEB3",
			white: "FFFFFF",
			bisque: "FFE4C4",
			indigo: "4B0082",
			maroon: "800000",
			orange: "FFA500",
			orchid: "DA70D6",
			purple: "800080",
			salmon: "FA8072",
			sienna: "A0522D",
			silver: "C0C0C0",
			tomato: "FF6347",
			violet: "EE82EE",
			yellow: "FFFF00",
			crimson: "DC143C",
			darkred: "8B0000",
			dimgray: "696969",
			fuchsia: "FF00FF",
			hotpink: "FF69B4",
			magenta: "FF00FF",
			oldlace: "FDF5E6",
			skyblue: "87CEEB",
			thistle: "D8BFD8",
			cornsilk: "FFF8DC",
			darkblue: "00008B",
			darkcyan: "008B8B",
			darkgray: "A9A9A9",
			deeppink: "FF1493",
			honeydew: "F0FFF0",
			lavender: "E6E6FA",
			moccasin: "FFE4B5",
			seagreen: "2E8B57",
			seashell: "FFF5EE",
			aliceblue: "F0F8FF",
			burlywood: "DEB887",
			cadetblue: "5F9EA0",
			chocolate: "D2691E",
			darkgreen: "006400",
			darkkhaki: "BDB76B",
			firebrick: "B22222",
			gainsboro: "DCDCDC",
			goldenrod: "DAA520",
			indianred: "CD5C5C",
			lawngreen: "7CFC00",
			lightblue: "ADD8E6",
			lightcyan: "E0FFFF",
			lightgrey: "D3D3D3",
			lightpink: "FFB6C1",
			limegreen: "32CD32",
			mintcream: "F5FFFA",
			mistyrose: "FFE4E1",
			olivedrab: "6B8E23",
			orangered: "FF4500",
			palegreen: "98FB98",
			peachpuff: "FFDAD9",
			rosybrown: "BC8F8F",
			royalblue: "4169E1",
			slateblue: "6A5ACD",
			slategray: "708090",
			steelblue: "4682B4",
			turquoise: "40E0D0",
			aquamarine: "7FFFD4",
			blueviolet: "8A2BE2",
			chartreuse: "7FFF00",
			darkorange: "FF8C00",
			darkorchid: "9932CC",
			darksalmon: "E9967A",
			darkviolet: "9400D3",
			dodgerblue: "1E90FF",
			ghostwhite: "F8F8FF",
			lightcoral: "F08080",
			lightgreen: "90EE90",
			mediumblue: "0000CD",
			papayawhip: "FFEFD5",
			powderblue: "B0E0E6",
			sandybrown: "F4A460",
			whitesmoke: "F5F5F5",
			floralwhite: "FFFAF0",
			forestgreen: "228B22",
			darkmagenta: "8B008B",
			deepskyblue: "00BFFF",
			navajowhite: "FFDEAD",
			yellowgreen: "9ACD32",
			greenyellow: "ADFF2F",
			lightsalmon: "FFA07A",
			lightyellow: "FFFFE0",
			saddlebrown: "8B4513",
			springgreen: "00FF7F",
			darkseagreen: "8FBC8F",
			antiquewhite: "FAEBD7",
			lemonchiffon: "FFFACD",
			lightskyblue: "87CEFA",
			mediumorchid: "BA55D3",
			mediumpurple: "9370D8",
			midnightblue: "191970",
			darkslateblue: "483D8B",
			darkslategray: "2F4F4F",
			darkturquoise: "00CED1",
			darkgoldenrod: "B8860B",
			lavenderblush: "FFF0F5",
			lightseagreen: "20B2AA",
			palegoldenrod: "EEE8AA",
			paleturquoise: "AFEEEE",
			palevioletred: "D87093",
			blanchedalmond: "FFEBCD",
			cornflowerblue: "6495ED",
			darkolivegreen: "556B2F",
			lightslategray: "778899",
			lightsteelblue: "B0C4DE",
			mediumseagreen: "3CB371",
			mediumslateblue: "7B68EE",
			mediumturquoise: "48D1CC",
			mediumvioletred: "C71585",
			mediumaquamarine: "66CDAA",
			mediumspringgreen: "00FA9A",
			lightgoldenrodyellow: "FAFAD2"
		},
		_round: function(a, e) {
			a = (a + "").replace(RegExp("^([-\\d]*)(\\.\\d{1," + (e || 3) + "})?.*"), "$1$2");
			return a - 0
		},
		_hex2rgb: function(a) {
			var e = {
				r: 0,
				g: 0,
				b: 0
			};
			3 == a.length ? (e.r = parseInt(a.substring(0, 1) + a.substring(0, 1), 16), e.g = parseInt(a.substring(1, 2) + a.substring(1, 2), 16), e.b = parseInt(a.substring(2, 3) + a.substring(2, 3), 16)) : (e.r = parseInt(a.substring(0, 2), 16), e.g = parseInt(a.substring(2, 4), 16), e.b = parseInt(a.substring(4, 6), 16));
			return e
		},
		_hex2hsv: function(a) {
			var g = e.prototype;
			a = g._hex2rgb(a);
			return g._rgb2hsv(a)
		},
		_hex2lab: function(a) {
			var g = e.prototype;
			a = g._hex2xyz(a);
			return g._xyz2lab(a)
		},
		_hex2xyz: function(a) {
			var g = e.prototype;
			a = g._hex2rgb(a);
			return g._rgb2xyz(a)
		},
		_rgb2hsv: function(a) {
			var e = a.r / 255,
			j = a.g / 255;
			a = a.b / 255;
			var k = 0,
			l = 0,
			k = 0,
			m = {
				h: 0,
				s: 0,
				v: 0
			};
			e >= j && e >= j ? (l = e, k = j > a ? a: j) : j >= a && j >= e ? (l = j, k = e > a ? a: e) : (l = a, k = j > e ? e: j);
			m.v = l;
			m.s = l ? (l - k) / l: 0;
			m.s ? (k = l - k, m.h = e == l ? (j - a) / k: j == l ? 2 + (a - e) / k: 4 + (e - j) / k, m.h = parseInt(60 * m.h), 0 > m.v && (m.v += 360)) : m.h = 0;
			m.s = parseInt(100 * m.s);
			m.v = parseInt(100 * m.v);
			return m
		},
		_rgb2lab: function(a) {
			var g = e.prototype;
			a = g._rgb2xyz(a);
			return g._xyz2lab(a)
		},
		_rgb2xyz: function(a) {
			var g = "";
			a = {
				r: a.r / 255,
				g: a.g / 255,
				b: a.b / 255
			};
			var j = null;
			for (g in a) a[g] = 0.04045 < a[g] ? Math.pow((a[g] + 0.055) / 1.055, 2.4) : a[g] / 12.92,
			a[g] *= 100;
			j = {
				x: 0.4124 * a.r + 0.3576 * a.g + 0.1805 * a.b,
				y: 0.2126 * a.r + 0.7152 * a.g + 0.0722 * a.b,
				z: 0.0193 * a.r + 0.1192 * a.g + 0.9505 * a.b
			};
			for (g in j) j[g] = e.prototype._round(j[g]);
			return j
		},
		_rgb2hex: function(a) {
			var e = "",
			j = {};
			j.r = a.r.toString(16);
			j.g = a.g.toString(16);
			j.b = a.b.toString(16);
			for (e in j) 2 > j[e].length && (j[e] += j[e]);
			return j.r + j.g + j.b
		},
		_hsv2rgb: function(a) {
			var e = 0,
			j = 0,
			k = 0,
			l = 0,
			m = 0,
			k = a.h,
			m = a.s;
			a = a.v;
			var n = {
				r: 0,
				g: 0,
				b: 0
			};
			if (0 == m) n.r = 0 == b ? n.g = n.b = 0 : n.g = n.b = parseInt(255 * b / 100);
			else {
				360 == k && (k = 0);
				k /= 60;
				m /= 100;
				a /= 100;
				e = parseInt(k);
				j = k - e;
				k = a * (1 - m);
				l = a * (1 - m * j);
				m = a * (1 - m * (1 - j));
				switch (e) {
				case 0:
					n.r = a;
					n.g = m;
					n.b = k;
					break;
				case 1:
					n.r = l;
					n.g = a;
					n.b = k;
					break;
				case 2:
					n.r = k;
					n.g = a;
					n.b = m;
					break;
				case 3:
					n.r = k;
					n.g = l;
					n.b = a;
					break;
				case 4:
					n.r = m;
					n.g = k;
					n.b = a;
					break;
				case 5:
					n.r = a,
					n.g = k,
					n.b = l
				}
				n.r = parseInt(255 * n.r);
				n.g = parseInt(255 * n.g);
				n.b = parseInt(255 * n.b)
			}
			return n
		},
		_hsv2lab: function(a) {
			var g = e.prototype;
			a = g._hsv2xyz(a);
			return g._xyz2lab(a)
		},
		_hsv2xyz: function(a) {
			var g = e.prototype;
			a = g._hsv2rgb(a);
			return g._rgb2xyz(a)
		},
		_hsv2hex: function(a) {
			var g = e.prototype;
			a = g._hsv2rgb(a);
			return g._rgb2hex(a)
		},
		_lab2rgb: function(a) {
			var g = e.prototype;
			a = g._lab2xyz(a);
			return g._xyz2rgb(a)
		},
		_lab2hsv: function(a) {
			var g = e.prototype;
			a = g._lab2rgb(a);
			return g._rgb2hsv(a)
		},
		_lab2xyz: function(a) {
			var g = "",
			j = 0,
			k = {},
			l = e.prototype,
			m = l._white;
			k.y = (a.l + 16) / 116;
			k.x = a.a / 500 + k.y;
			k.z = k.y - a.b / 200;
			for (g in k) j = Math.pow(k[g], 3),
			k[g] = 0.008856 < j ? j: (k[g] - 16 / 116) / 7.787,
			k[g] = l._round(k[g] * m[g]);
			return {
				x: k.x,
				y: k.y,
				z: k.z
			}
		},
		_lab2hex: function(a) {
			var g = e.prototype;
			a = g._lab2rgb(a);
			return g._rgb2hex(a)
		},
		_xyz2rgb: function(a) {
			var g = "",
			j = a.x / 100,
			k = a.y / 100;
			a = a.z / 100;
			var l = {};
			l.r = 3.2406 * j + -1.5372 * k + -0.4986 * a;
			l.g = -0.9689 * j + 1.8758 * k + 0.0415 * a;
			l.b = 0.0557 * j + -0.204 * k + 1.057 * a;
			for (g in l) l[g] = e.prototype._round(l[g]),
			l[g] = 0.0031308 < l[g] ? 1.055 * Math.pow(l[g], 1 / 2.4) - 0.055 : 12.92 * l[g],
			l[g] = Math.round(255 * l[g]);
			return l
		},
		_xyz2hsv: function(a) {
			var g = e.prototype;
			a = g._xyz2rgb(a);
			return g._rgb2hsv(a)
		},
		_xyz2lab: function(a) {
			var g = "",
			j = {},
			k = e.prototype._white;
			for (g in a) j[g] = a[g] / k[g],
			j[g] = 0.008856 < j[g] ? Math.pow(j[g], 1 / 3) : 7.787 * j[g] + 16 / 116;
			return {
				l: 116 * j.y - 16,
				a: 500 * (j.x - j.y),
				b: 200 * (j.y - j.z)
			}
		},
		_xyz2hex: function(a) {
			var g = e.prototype;
			a = g._xyz2rgb(a);
			return g._rgb2hex(a)
		},
		type: function(a) {
			var e = "",
			j = "";
			if ("object" == typeof a) {
				for (e in a) a[e] -= 0;
				if (!isNaN(a.r) || !isNaN(a.g)) return "rgb";
				if (!isNaN(a.h) || !isNaN(a.s)) return "hsv";
				if (!isNaN(a.x) || !isNaN(a.z)) return "xyz";
				if (!isNaN(a.l) || !isNaN(a.a)) return "lab";
				if (!isNaN(a.c) || !isNaN(a.m) || !isNaN(a.k)) return "cmyk"
			} else if ("number" == typeof a || "string" == typeof a) return j = a.substring(0, 4),
			"rgb(" == j || "rgba" == j ? "css": "hex";
			return ! 1
		},
		validate: function(a, g) {
			g = g || !1;
			var j = e.prototype,
			k = j.type(a),
			l = "",
			m = "",
			n = m = null;
			if (k) {
				"css" == k ? (n = j._rgb, k = "rgb", m = a.replace(/rgb(a)?\(|\)/g, "").split(/,\s?/), a = {
					r: m[0],
					g: m[1],
					b: m[2]
				}) : n = j["_" + k];
				switch (k) {
				case "css":
				case "rgb":
				case "hsv":
				case "lab":
				case "xyz":
				case "cmyk":
					for (l in n) ! a[l] || a[l] < n[l].min ? a[l] = n[l].min: a[l] > n[l].max && (a[l] = "hsv" == k && "h" == l ? 0 : n[l].max);
					break;
				case "hex":
					(m = j._human[a.toLowerCase()]) ? a = m: (a = ("" + a).toUpperCase().replace(/^#/g, "").replace(/[^A-F0-9]/g, "0"), l = a.length, 6 > l && 3 < l ? a += "000000".substring(l, 6 - l) : 6 > l && 3 > l ? a += "000".substring(l, 3 - l) : 6 < l && (a = a.substring(0, 6)))
				}
				return g ? {
					type: k,
					raw: a
				}: a
			}
			return ! 1
		},
		convert: function(a, g) {
			g = g || "rgb";
			var j = "",
			k = e.prototype,
			l = k.validate(a, !0);
			return l && (j = "_" + l.type + "2" + g, k[j]) ? k[j](l.raw) : !1
		},
		invert: function(a, g) {
			g = g || "rgb";
			var j = "",
			k = e.prototype,
			l = null;
			if (l = k.validate(a, !0)) {
				l = k["_" + l.type + "2rgb"](l.raw);
				for (j in l) l[j] = 255 - l[j];
				return "rgb" != g ? k["_rgb2" + g](l) : l
			}
			return ! 1
		}
	};
	e.type = e.prototype.type;
	e.invert = e.prototype.invert;
	e.convert = e.prototype.convert;
	e.validate = e.prototype.validate; (a || window).Color = e
})(window);
var INLINE_EDITOR_CLASS = "inlineEditor",
INLINE_EDITOR_CLASS_LEFT = "inlineEditorLeftBar",
INLINE_EDITOR_CLASS_RIGHT = "inlineEditorRightBar",
INLINE_EDITOR_CLASS_BOTTOM = "inlineEditorBottomBar",
INLINE_EDITOR_CLASS_TOP = "inlineEditorTopBar",
INLINE_EDITOR_CLASS_NEW = "inlineEditorNew",
INLINE_EDITOR_COVER_CLASS_NEW = "inlineEditorCoverNew",
INLINE_EDITOR_SELECTION_OVERLAY = "inlineEditorSelectionOverlayNew",
INLINE_EDITOR_CLASS_LEFT_NEW = "inlineEditorLeftBarNew",
INLINE_EDITOR_CLASS_RIGHT_NEW = "inlineEditorRightBarNew",
INLINE_EDITOR_CLASS_BOTTOM_NEW = "inlineEditorBottomBarNew",
INLINE_EDITOR_CLASS_TOP_NEW = "inlineEditorTopBarNew",
INLINE_EDITOR_CLASS_NEW_ONE = "inlineEditorNewOne",
INLINE_EDITOR_COVER_CLASS_NEW_ONE = "inlineEditorCoverNewOne",
INLINE_EDITOR_CLASS_LEFT_NEW_ONE = "inlineEditorLeftBarNewOne",
INLINE_EDITOR_CLASS_RIGHT_NEW_ONE = "inlineEditorRightBarNewOne",
INLINE_EDITOR_CLASS_BOTTOM_NEW_ONE = "inlineEditorBottomBarNewOne",
INLINE_EDITOR_CLASS_TOP_NEW_ONE = "inlineEditorTopBarNewOne",
INLINE_EDITOR_CLASS_NEW_CONTEXT = "inlineEditorNewContext",
INLINE_SELECTION_TEMP_COVER_ELEMENT = "dmTempCoverImage",
INLINE_EDITOR_CLASS_NEW_LOCKED = "inlineEditorNewSelectionBarsLocked",
INLINE_EDITOR_CLASS_NEW_SELECTED = "inlineEditorNewSelectionBarsSelected",
INLINE_EDITOR_ID = "inlineEditor",
INLINE_EDITOR_SELECTOR = "." + INLINE_EDITOR_CLASS,
INLINE_EDITOR_COVER_ID = "inlineEditorCover",
INLINE_EDITOR_EDITED_ELEMENT_CLASS = "inlineEditorEditedElement",
INLINE_EDITOR_EDITED_ELEMENT_ID = "inlineEditorEditedElement",
INLINE_EDITOR_EDITED_WRAPPER_CLASS = "inlineEditorEditedElementWrapper",
INLINE_EDITOR_EDITED_WRAPPER_SELECTOR = "." + INLINE_EDITOR_EDITED_WRAPPER_CLASS,
INLINE_EDITOR_FRONT_ELEMENT = "inlineEditorBringToFrontPath",
INLINE_EDITOR_ELEMET = "DMInlineEditorElement",
INLINE_EDITOR_NOT_EDITABLE_ELEMET = "DMInlineEditorNotEditableElement",
INLINE_EDITOR_SELECTION_ELEMET = "DMSelectionElement",
RTE_INLINE_EDITOR_CLASS = "inlineReachTextEditor",
RTE_INLINE_EDITOR_ID = "inlineReachTextEditor",
RTE_INLINE_EDITOR_CLASS_LEFT = "inlineReachTextEditorLeftBar",
RTE_INLINE_EDITOR_CLASS_RIGHT = "inlineReachTextEditorRightBar",
RTE_INLINE_EDITOR_CLASS_BOTTOM = "inlineReachTextEditorBottomBar",
RTE_INLINE_EDITOR_SELECTOR = "#" + RTE_INLINE_EDITOR_ID,
INLINE_MARKED_ELEMENT = "neeInlineMarkedElement",
_DragManager = new PreviewDrag;
function PreviewDrag() {
	this.originalElement = this.element = null;
	this.placeHolder;
	this.mouseYwhenFoundDropArea;
	this.draggedVisual = null;
	this.windowUsed = "outer";
	this.scrollDownIndicator;
	this.scrollUpIndicator;
	this.dragRequestDelay = this.dragTimeout = 0;
	this.dragKey = "";
	this.dragFromPage = null;
	this.verticalColumnThresholdToFind = 50;
	this.dragClonedElement = !0;
	this.dropped = this.isInitialized = !1;
	this.generalProps = {
		useDarkenMode: !$.dmfw.isDudaone()
	};
	this.dragFrameworkProps = {
		isFromFramework: !1,
		frameworkOnDone: null,
		editableToCreate: null,
		previewCover: null
	}
}
PreviewDrag.prototype.getDraggedKey = function() {
	return this.dragFrameworkProps.isFromFramework ? this.dragFrameworkProps.editableToCreate.type: this.dragKey
};
PreviewDrag.prototype.getDraggedFromPage = function() {
	return this.dragFromPage
};
PreviewDrag.prototype.init = function() {
	var a = "",
	e = "",
	d, g, j;
	this.windowUsed = "outer";
	$.dmfw.isDudaone() && $.respUtils.removeRowEditor();
	this.dragFrameworkProps.isFromFramework ? this.isInitialized = !0 : null != _DragManager.element && (a = _DragManager.element.editable(), e = a.dragImageParams(), a.dragImageParams ? (a = e.editableDraggedImg, (e = e.editableDraggedText) && (e = e.replace("^", ""))) : (a = "/editor/nee/images/contentBtns/title.png", e = "Paragraph"), $.dmfw.isDudaone() && (this.dragClonedElement = !1), this.isInitialized = !0);
	this.isInitialized ? (d = $('\x3cdiv style\x3d"position:absolute;"\x3e\x3c/div\x3e'), d.appendTo($("#_preview_w")), d.height(NEFW.PREVIEW.outerHeight()), d.width(NEFW.PREVIEW.outerWidth()), d.offset(NEFW.PREVIEW.offset()), d.addClass("previewIframeCover"), this.dragFrameworkProps.previewCover = d, this.generatePlaceHolder(), this.scrollDownIndicator = $("\x3cdiv\x3e\x3c/div\x3e"), this.scrollUpIndicator = $("\x3cdiv\x3e\x3c/div\x3e"), this.dragFrameworkProps.isFromFramework || (d = $("\x3cdiv/\x3e"), d.addClass("contentIconBtn ui-draggable dragCursor contentIconBtnSelectedDrag draggingCursor ui-draggable-dragging"), d.attr({
		text: "no",
		currnum: "4",
		title: "",
		key: "clicktocall",
		display: "none",
		position: "absolute"
	}), g = $("\x3cdiv/\x3e"), g.addClass("contentImgDiv").css({
		height: "auto",
		width: "auto"
	}), j = $("\x3cimg/\x3e"), j.attr("src", a), j.appendTo(g), g.appendTo(d), a = $("\x3cdiv/\x3e"), a.text(e), g.append(a), this.draggedVisual = d), this.draggedVisual.addClass("neeDraggingNow").addClass("dmDrag")) : ($(this.element).show(), this.stop());
	return this.isInitialized
};
PreviewDrag.prototype.generatePlaceHolder = function(a, e) {
	var d = {
		position: "relative",
		left: "auto",
		width: "100%"
	};
	d.border = $.dmfw.isUseNewSelection() ? "2px #ff6500 dashed": "3px #ff6500 dashed";
	d.color = "#ff6600";
	d.background = "#ffd0b2";
	d["text-align"] = "center";
	d["line-height"] = "25px";
	d["text-decoration"] = "none";
	d["font-weight"] = "normal";
	d["font-size"] = $.dmfw.isUseNewSelection() ? "14px": "16px";
	d.padding = "0px";
	d.margin = "0px";
	$.dmfw.isDudaone() ? e = "": d.height = "25px";
	if (null == this.placeHolder || $.browser.msie && 9 <= $.browser.version) this.placeHolder = $("\x3cdiv\x3e\x3c/div\x3e"),
	this.placeHolder.addClass("inlineEditorDraggingPlaceHolder"),
	$.dmfw.isDudaone() ? this.placeHolder.addClass("dmDragAndDropPlaceHolder noneDroppableArea") : this.placeHolder.removeClass("dmDragAndDropPlaceHolder");
	var g = "";
	if (!$.dmfw.isDudaone()) for (var j in d) g += j + ":" + d[j] + " !important; ";
	if (null != a) for (j in a) g += j + ":" + a[j] + " !important; ";
	null != e ? this.placeHolder.html(e) : this.placeHolder.html(dmStr["ui.nee.drag.1"]);
	this.placeHolder.css("cssText", g);
	this.placeHolder.css("display", "none");
	null != _DropManager && (_DropManager.placeHolder = this.placeHolder)
};
PreviewDrag.prototype.stop = function() {
	$.dmfw.getPreviewElement(".dmDraggedDomElement, .dmDraggedDomElementScaled, .dmDropAreasMinHeight").removeClass("dmDraggedDomElement dmDraggedDomElementScaled dmDropAreasMinHeight");
	this.element = null;
	null != this.placeHolder && (this.placeHolder.hide(), this.placeHolder.remove(), $.dmfw.getPreviewElement("div.inlineEditorDraggingPlaceHolder").remove());
	null != this.scrollDownIndicator && this.scrollDownIndicator.remove();
	this.scrollDownIndicator = null;
	null != this.scrollUpIndicator && this.scrollUpIndicator.remove();
	this.scrollUpIndicator = null;
	this.dragClonedElement ? null != this.draggedVisual && this.draggedVisual.remove() : this.draggedVisual.css({
		left: "",
		top: "",
		position: "",
		"z-index": ""
	});
	this.draggedVisual = null;
	_DropManager.stop();
	null != this.dragFrameworkProps.frameworkOnDone && this.dragFrameworkProps.frameworkOnDone();
	null != this.dragFrameworkProps.previewCover && (this.dragFrameworkProps.previewCover.remove(), this.dragFrameworkProps.previewCover = null);
	$.dmx.preview.wnd().clearScrollInterval("up");
	$.dmx.preview.wnd().clearScrollInterval("down");
	clearTimeout(_DragManager.dragTimeout);
	_DragManager.dragTimeout = 0;
	clearTimeout(_DragManager.dragRequestDelay);
	_DragManager.dragRequestDelay = 0;
	$.dmfw.getPreviewElement("." + INLINE_MARKED_ELEMENT).removeClass(INLINE_MARKED_ELEMENT);
	$.dmfw.getPreviewElement(".dmDrakedElement").remove();
	$.dmfw.getPreviewElement(".dmTransedLayoutElement").remove();
	$.dmfw.isDudaone() && ($.dmfw.getPreviewElement(".dmPlaceHolderRespRowNew").remove(), $.dmfw.getPreviewElement(".dmConsiderOutElement").removeClass("dmConsiderOutElement"), $.respUtils.dragManager.destroyColumnPlaceholder(), $.respUtils.dragManager.destroyFooterMarkers());
	$($.dmx.preview.wnd()).unbind("mousemove");
	$($.dmx.preview.wnd()).unbind("mouseup");
	$(window).unbind("mousemove");
	$(window).unbind("mouseup");
	$($.dmx.preview.wnd()).unbind("mousemove.startdrag");
	this.dropped = this.isInitialized = !1;
	this.dragClonedElement = !0
};
PreviewDrag.prototype.dragRequest = function(a, e, d, g) {
	clearTimeout(this.dragRequestDelay);
	this.dragRequestDelay = setTimeout(function() {
		var d = function() {
			$($.dmx.preview.doc()).unbind("mouseup.fastclick");
			$.dmfw.setPreviewEditPolicy(!1);
			if (_DragManager.dragFrameworkProps.isFromFramework = g) _DragManager.element = a,
			_DragManager.dragInsert(e);
			else {
				var d = $.dmx.current.editable;
				null != d && (_DragManager.element = "function" == typeof d.getCorrectElementForMove ? d.getCorrectElementForMove(a) : a, _DragManager.originalElement = a, _DragManager.dragMove(e))
			}
			$.deselectAllEditableElements()
		},
		k = !1;
		if (g) $.dmfw.isEditorOpen() ? $.dmfw.closeEditor({
			keepPreview: !0,
			forceExecuteOnClose: !0,
			onEditorClose: function() {
				d()
			}
		}) : d();
		else $($.dmx.preview.wnd()).off("mousemove.startdrag").on("mousemove.startdrag",
		function(a) {
			if (!k && (2 < Math.abs(e.clientX - a.clientX) || 2 < Math.abs(e.clientY - a.clientY))) $($.dmx.preview.wnd()).unbind("mousemove.startdrag"),
			$.dmfw.isEditorOpen() ? $.dmfw.closeEditor({
				keepPreview: !0,
				forceExecuteOnClose: !0,
				onEditorClose: function() {
					d()
				}
			}) : d(),
			a.preventDefault(),
			a.stopPropagation(),
			k = !0
		})
	},
	d);
	$($.dmx.preview.wnd()).unbind("mouseup.fastclick").bind("mouseup.fastclick",
	function() {
		_DragManager.stop()
	})
};
PreviewDrag.prototype.requestInsert = function(a, e, d, g) {
	this.dragFrameworkProps.frameworkOnDone = g;
	this.dragFrameworkProps.isFromFramework = !0;
	this.dragFrameworkProps.editableToCreate = $.dmfw.editables(e);
	this.draggedVisual = a;
	this.dragRequest(null, d, 0, !0)
};
PreviewDrag.prototype.requestMove = function(a, e, d) {
	null != d && $.extend(this.generalProps, d);
	this.dragKey = $.dmx.current.editable.type;
	this.dragFromPage = $.dmx.currentPage(a);
	this.dragRequest($(a), e, 0, !1)
};
PreviewDrag.prototype.findDropArea = function(a) {
	var e = _DropManager.getDroppingAreaByPoint(a),
	d = e.editable,
	g = e.correctElement,
	e = e.actionPosition;
	null != d && ($.dmfw.getPreviewElement("." + INLINE_MARKED_ELEMENT).removeClass(INLINE_MARKED_ELEMENT), _DropManager.markPlace(a, d, g, e), _DragManager.recalcDarkenElementsPositions())
};
PreviewDrag.prototype.initPlaceholderRows = function(a) {
	if (null != $.respUtils && (null == _DragManager.element || _DragManager.element && !_DragManager.element.is(".dmRespRow"))) {
		a = a.closest(".dmRespRow");
		var e = $(),
		d = $();
		0 < a.length && !$.respUtils.isRowEmpty(a) && (!a.is(".dmPlaceHolderRespRow") && !a.is(".dmHoveredRowWithPlaceholders") && ($.dmfw.getPreviewElement(".dmHoveredRowWithPlaceholders").removeClass("dmHoveredRowWithPlaceholders"), a.addClass("dmHoveredRowWithPlaceholders"), a.prev().is(".dmPlaceHolderRespRow") || ($.dmfw.getPreviewElement(".dmPlaceHolderRespRowNewPrev").remove(), e = $.respUtils.getNewEmptyRow({
			insertBefore: a
		}).addClass("dmPlaceHolderRespRow dmPlaceHolderRespRowNew dmPlaceHolderRespRowNewPrev")), a.next().is(".dmPlaceHolderRespRow") || ($.dmfw.getPreviewElement(".dmPlaceHolderRespRowNewNext").remove(), d = $.respUtils.getNewEmptyRow({
			insertAfter: a
		}).addClass("dmPlaceHolderRespRow dmPlaceHolderRespRowNew dmPlaceHolderRespRowNewNext")), setTimeout(function() {
			e.find(".dmRespCol").css("opacity", "1");
			d.find(".dmRespCol").css("opacity", "1")
		},
		0)), 0 == a.length && ($.dmfw.getPreviewElement(".dmPlaceHolderRespRowNewPrev").remove(), $.dmfw.getPreviewElement(".dmPlaceHolderRespRowNewNext").remove(), _DragManager.placeHolder.remove()))
	}
};
PreviewDrag.prototype.recalcDarkenElementsPositions = function() {
	$.dmfw.getPreviewElement(".dmDrakedElement").each(function(a, e) {
		var d = 0,
		g = $(e).data("boundedElement"),
		d = g.offset().top;
		$(e).offset({
			top: d,
			left: g.offset().left
		})
	})
};
PreviewDrag.prototype.initInsertScrollers = function() {
	NEFW.PREVIEW.contents().get(0);
	NEFW.PREVIEW.get(0)
};
PreviewDrag.prototype.initMoveScrollers = function() {
	NEFW.PREVIEW.contents().get(0);
	var a = NEFW.PREVIEW.get(0).contentWindow;
	this.scrollDownIndicator.appendTo($.dmfw.getPreviewElement("body"));
	this.scrollDownIndicator.addClass("inlineEditorDraggingScrollDownIndicatorWrapper");
	var e = jQuery("\x3cdiv\x3e\x3c/div\x3e"),
	d = jQuery("\x3cdiv\x3e\x3c/div\x3e");
	e.appendTo(this.scrollDownIndicator);
	d.appendTo(this.scrollDownIndicator);
	e.addClass("inlineEditorDraggingScrollDownIndicatorArrow");
	d.addClass("inlineEditorDraggingScrollDownIndicatorBottom");
	this.scrollDownIndicator.css("width", $(a).width());
	this.scrollDownIndicator.unbind("mouseenter").bind("mouseenter",
	function() {
		a.initInterval("down")
	});
	this.scrollDownIndicator.unbind("mouseleave").bind("mouseleave",
	function() {
		a.clearScrollInterval("down")
	});
	this.scrollDownIndicator.fadeIn(400);
	this.scrollUpIndicator.appendTo($.dmfw.getPreviewElement("body"));
	this.scrollUpIndicator.addClass("inlineEditorDraggingScrollUpIndicatorWrapper");
	e = jQuery("\x3cdiv\x3e\x3c/div\x3e");
	d = jQuery("\x3cdiv\x3e\x3c/div\x3e");
	d.appendTo(this.scrollUpIndicator);
	e.appendTo(this.scrollUpIndicator);
	e.addClass("inlineEditorDraggingScrollUpIndicatorArrow");
	d.addClass("inlineEditorDraggingScrollUpIndicatorBottom");
	this.scrollUpIndicator.css("width", $(a).width());
	this.scrollUpIndicator.unbind("mouseenter").bind("mouseenter",
	function() {
		a.initInterval("up")
	});
	this.scrollUpIndicator.unbind("mouseleave").bind("mouseleave",
	function() {
		a.clearScrollInterval("up")
	});
	this.scrollUpIndicator.fadeIn(400)
};
PreviewDrag.prototype.dragInsert = function() {
	if (this.init() && (_DropManager.init(this.placeHolder), this.initInsertScrollers(), this.handleDragStart("insert"), $.dmfw.isDudaone() || ($.dmx.preview.wnd().jQuery.DM.isUseIscroll() ? ($.getFreeHeaderElement().addClass("dmDropAreasMinHeight"), $.getFreeFooterElement().addClass("dmDropAreasMinHeight"), $.getContentBodyElement().addClass("dmDropAreasMinHeight")) : ($.dmfw.getPreviewElement(".dmHeader").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".dmFooter").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".dmBody").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".dmHeader").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".freeHeader").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".dmFooter").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".freeFooter").addClass("dmDropAreasMinHeight"), $.dmfw.getPreviewElement(".dmBody").addClass("dmDropAreasMinHeight"))), this.markFixedPlaceholders(), this.generalProps.useDarkenMode)) {
		var a = dmStr["ui.nee.inline.dragging.3"];
		$('\x3cspan class\x3d"dmDropAreasText dmDropAreaFixedHeader"\x3e' + dmStr["ui.nee.inline.dragging.5"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + a + "\x3c/span\x3e\x3c/span\x3e");
		$('\x3cspan class\x3d"dmDropAreasText dmDropAreaFixedFooter"\x3e' + dmStr["ui.nee.inline.dragging.6"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + a + "\x3c/span\x3e\x3c/span\x3e");
		a = {};
		0 < $.getFixedHeaderElement().length && (a = {
			fixed: !0
		},
		$.getFixedHeaderElement().darkenPreviewElement(null, {
			top: 10
		},
		!0, a));
		0 < $.getFixedFooterElement().length && (a = {
			fixed: !0
		},
		$.getFixedFooterElement().darkenPreviewElement(null, {
			top: 10
		},
		!0, a))
	}
};
PreviewDrag.prototype.markFixedPlaceholders = function() {
	if ($.dmfw.isDudaone()) {
		$.respUtils.initPlaceHolders();
		var a = $.getFreeFooterElement();
		0 == a.find(".dmRespRow, .dmRespDesignRow").length && (newRowBefore = $.respUtils.getNewEmptyRow({
			appendInside: a.find(".dmFooterResp")
		}).addClass("dmPlaceHolderRespRow dmPlaceHolderRespRowNew"))
	}
};
PreviewDrag.prototype.getScaledPlaceholderOffset = function(a) {
	var e = 0,
	d = 0;
	$.dmx.preview.wnd().jQuery.DM.isBodyScrollable() && (e += $.getScrollingPosition()[1], d += $.getScrollingPosition()[0]);
	e += parseInt(a.clientY - this.draggedVisual.outerHeight(!0) / 4);
	d += parseInt(a.clientX - this.draggedVisual.outerWidth(!0) / 4);
	return {
		top: e,
		left: d
	}
};
PreviewDrag.prototype.dragMove = function(a) {
	if (this.init()) {
		_DropManager.init(this.placeHolder);
		this.initMoveScrollers();
		var e, d = {
			top: 0,
			left: 0
		};
		$.dmfw.isDudaone() ? ($.deselectAllEditableElements(), e = $("\x3cdiv\x3e\x3c/div\x3e"), e.css("display", "none"), e.data("original-style", _DragManager.element.attr("style")), e.data("original-classes", _DragManager.element.attr("class")), this.handleDragStart("move", "inner"), this.draggedVisual = _DragManager.element, e.insertAfter(this.draggedVisual), this.draggedVisual.width(_DragManager.element.width()), this.draggedVisual.height(_DragManager.element.height()), this.draggedVisual.addClass("dmDraggedDomElement dmConsiderOutElement noneDroppableArea"), e.addClass("dmDragSpotKeeperElement dmConsiderOutElement noneDroppableArea"), 100 < this.draggedVisual.width() && 100 < this.draggedVisual.height() && this.draggedVisual.addClass("dmDraggedDomElementScaled"), d = this.getScaledPlaceholderOffset(a)) : (this.handleDragStart("move"), this.draggedVisual.css("display", "none"), this.draggedVisual.css("position", "absolute"), this.draggedVisual.appendTo($("body")), e = parseInt(a.clientY) + parseInt(NEFW.PREVIEW.offset().top - 35), a = parseInt(a.clientX) + parseInt(NEFW.PREVIEW.offset().left - 35), d = {
			top: e,
			left: a
		},
		this.element.hide());
		this.draggedVisual.attr("class", this.draggedVisual.attr("class"));
		this.draggedVisual.css("z-index", "3000");
		setTimeout(function() {
			_DragManager.draggedVisual.offset(d)
		},
		0);
		this.draggedVisual.show();
		$.removeRichTextEditor();
		$.getFreeFooterElement().addClass("dmDropAreasMinHeight");
		this.markFixedPlaceholders();
		0 < $.getFreeHeaderElement().length && 0 < $.getFreeHeaderElement().height() && $.getFreeHeaderElement().addClass("dmDropAreasMinHeight");
		$.getFreeFooterElement().addClass("dmDropAreasMinHeight");
		$.getContentBodyElement().addClass("dmDropAreasMinHeight");
		if (this.generalProps.useDarkenMode) {
			e = dmStr["ui.nee.inline.dragging.3"];
			var g = $('\x3cspan class\x3d"dmDropAreasText dmDropAreaBody"\x3e' + dmStr["ui.nee.inline.dragging.4"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + e + "\x3c/span\x3e\x3c/span\x3e");
			$('\x3cspan class\x3d"dmDropAreasText dmDropAreaFixedHeader"\x3e' + dmStr["ui.nee.inline.dragging.5"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + e + "\x3c/span\x3e\x3c/span\x3e");
			a = $('\x3cspan class\x3d"dmDropAreasText dmDropAreaHeader"\x3e' + dmStr["ui.nee.inline.dragging.5"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + e + "\x3c/span\x3e\x3c/span\x3e");
			$('\x3cspan class\x3d"dmDropAreasText dmDropAreaFixedFooter"\x3e' + dmStr["ui.nee.inline.dragging.6"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + e + "\x3c/span\x3e\x3c/span\x3e");
			e = $('\x3cspan class\x3d"dmDropAreasText dmDropAreaFooter"\x3e' + dmStr["ui.nee.inline.dragging.6"] + '\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + e + "\x3c/span\x3e\x3c/span\x3e");
			if (this.element.isFreeHeaderElement()) {
				if (0 < $.getContentBodyElement().length) {
					var j = {
						top: 10
					};
					$.getContentBodyElement().darkenPreviewElement(g, j)
				}
				0 < $.getFreeFooterElement().length && (a = {
					top: 10
				},
				$.getFreeFooterElement().darkenPreviewElement(e, a))
			} else this.element.isFreeFooterElement() ? (0 < $.getContentBodyElement().length && (j = {
				top: $.getContentBodyElement().outerHeight(!0) - 55
			},
			$.getContentBodyElement().darkenPreviewElement(g, j)), 0 < $.getFreeHeaderElement().length && (g = {
				top: 10
			},
			$.getFreeHeaderElement().darkenPreviewElement(a, g))) : this.element.isBodyElement() && (0 < $.getFreeHeaderElement().length && 0 < $.getFreeHeaderElement().height() && (g = {
				top: 10
			},
			$.getFreeHeaderElement().darkenPreviewElement(a, g)), 0 < $.getFreeFooterElement().length && (a = {
				top: 10
			},
			$.getFreeFooterElement().darkenPreviewElement(e, a)));
			e = {};
			0 < $.getFixedHeaderElement().length && (g = {
				top: 10
			},
			e = {
				fixed: !0
			},
			$.getFixedHeaderElement().darkenPreviewElement(null, g, !0, e));
			0 < $.getFixedFooterElement().length && (a = {
				top: 10
			},
			e = {
				fixed: !0
			},
			$.getFixedFooterElement().darkenPreviewElement(null, a, !0, e))
		}
		a = window;
		"inner" == this.windowUsed && (a = $.dmx.preview.wnd(), $(window).off("mouseup").on("mouseup",
		function() {
			_DragManager.isPlaceholderAttachedToDom() ? ($(_DragManager.element).show(), _DragManager.draggedVisual.replaceWith($(_DragManager.element))) : ($.dmfw.setPreviewEditPolicy(!0), $(_DragManager.element).show());
			_DragManager.stop()
		}));
		$(a).unbind("mouseup").bind("mouseup",
		function(a) {
			_DragManager.isPlaceholderAttachedToDom() ? _DropManager.dropMoveNow($(_DragManager.element),
			function() {
				$.dmfw.setPreviewEditPolicy(!0);
				_DragManager.stop()
			},
			a) : ($.dmfw.setPreviewEditPolicy(!0), $(_DragManager.element).show(), _DragManager.stop())
		})
	}
};
PreviewDrag.prototype.reinitDraggedElementOnDrop = function() {
	var a = $.dmfw.getPreviewElement(".dmDragSpotKeeperElement"),
	e = a.data("originalClasses") ? a.data("originalClasses") : "",
	d = a.data("originalStyle") ? a.data("originalStyle") : "";
	this.draggedVisual.attr("class", e);
	this.draggedVisual.attr("style", d);
	a.remove()
};
PreviewDrag.prototype.handleDragStart = function(a, e) {
	var d = window;
	if ("move" == a) {
		if (($.browser.mozilla || "inner" == e) && "outer" != e) this.windowUsed = "inner",
		d = $.dmx.preview.wnd(),
		this.dragFrameworkProps.previewCover.remove()
	} else "insert" == a && (this.windowUsed = "outer", d = window);
	var g = NEFW.PREVIEW;
	$(d).off("mousemove.drag").on("mousemove.drag",
	function(d) {
		var e = {
			x: 0,
			y: 0
		};
		if ("inner" == _DragManager.windowUsed) {
			$.browser.mozilla ? e = {
				y: g.offset().top,
				x: g.offset().left
			}: $.dmx.preview.wnd().jQuery.DM.isBodyScrollable() && (e = {
				y: e.y + $.getScrollingPosition()[1],
				x: e.x + $.getScrollingPosition()[0]
			});
			e.y += d.clientY - _DragManager.draggedVisual.outerHeight(!0) / 4;
			e.x += d.clientX - _DragManager.draggedVisual.outerWidth(!0) / 4;
			var l = {
				top: e.y,
				left: e.x
			};
			_DragManager.draggedVisual.offset(l);
			e = {
				x: d.clientX,
				y: d.clientY
			}
		} else "outer" == _DragManager.windowUsed && ("move" == a && (e.y = d.clientY - 35 + window.pageYOffset, e.x = d.clientX - 35 + window.pageXOffset, l = {
			top: e.y,
			left: e.x
		},
		_DragManager.draggedVisual.offset(l), e = {
			x: d.clientX,
			y: d.clientY
		}), e = g.rPosition(d));
		l = 40;
		$.dmfw.isDudaone() && ("tablet" == $.onefw.device() ? l = 80 : "desktop" == $.onefw.device() && (l = 120));
		if (0 <= e.x && e.x <= g.outerWidth() && 0 <= e.y && e.y <= g.outerHeight()) {
			e.y <= l ? ($.dmx.preview.wnd().initInterval("up", e.y, l), $.dmx.preview.wnd().clearScrollInterval("down")) : e.y >= g.outerHeight() - l ? ($.dmx.preview.wnd().initInterval("down", e.y, g.outerHeight() - l), $.dmx.preview.wnd().clearScrollInterval("up")) : ($.dmx.preview.wnd().clearScrollInterval("up"), $.dmx.preview.wnd().clearScrollInterval("down"));
			clearTimeout(_DragManager.dragTimeout);
			l = 10;
			if (_DragManager.isPlaceholderAttachedToDom() || "move" == a) l = 100;
			_DragManager.dragTimeout = setTimeout(function() {
				clearTimeout(_DragManager.dragTimeout);
				_DragManager.dropped || _DragManager.findDropArea(e)
			},
			l);
			if (!_DragManager.dropped && $.dmfw.isDudaone()) $.respUtils.dragManager.onMoveOnPreview(d, e)
		} else clearTimeout(_DragManager.dragTimeout),
		clearTimeout(_DragManager.dragRequestDelay),
		$.dmfw.getPreviewElement("." + INLINE_MARKED_ELEMENT).removeClass(INLINE_MARKED_ELEMENT),
		$.dmfw.getPreviewElement(".dmPlaceHolderRespRowNew, .dmDragAndDropPlaceHolder").remove(),
		_DragManager.placeHolder.remove(),
		_DragManager.recalcDarkenElementsPositions()
	})
};
PreviewDrag.prototype.isPlaceholderAttachedToDom = function() {
	return this.placeHolder.is($.dmfw.getPreviewElement(".dmInner *"))
};
var _DropManager = new PreviewDrop;
function PreviewDrop() {}
PreviewDrop.prototype.init = function() {};
PreviewDrop.prototype.stop = function() {};
PreviewDrop.prototype.markPlace = function(a, e, d, g) {
	if (null != _DragManager.placeHolder && ($(d).addClass(INLINE_MARKED_ELEMENT), g != _DragManager.placeHolder.data("markedPlace") || $(d).get(0) !== _DragManager.placeHolder.data("markedElm"))) {
		_DragManager.placeHolder.hide();
		_DragManager.placeHolder.data("markedPlace", g);
		_DragManager.placeHolder.data("markedElm", $(d).get(0));
		_DragManager.placeHolder.data("targetEditable", e);
		$(d).isFreeHeaderElement() ? $.dmfw.isDudaone() || _DragManager.placeHolder.html(dmStr["ui.nee.inline.dragging.1"]) : $(d).isFreeFooterElement() ? $.dmfw.isDudaone() || _DragManager.placeHolder.html(dmStr["ui.nee.inline.dragging.2"]) : e.generatePlaceHolder ? e.generatePlaceHolder(_DragManager.originalElement) : _DragManager.generatePlaceHolder();
		_DragManager.mouseYwhenFoundDropArea = a.y + $.getScrollingPosition()[1];
		"outside-top" == g ? _DragManager.placeHolder.insertBefore($(d)) : "outside-bottom" == g ? _DragManager.placeHolder.insertAfter($(d)) : "inside-top" == g ? _DragManager.placeHolder.prependTo($(d)) : "inside-bottom" == g && _DragManager.placeHolder.appendTo($(d));
		d.hasClass("dmContentPlaceholder") && (_DragManager.placeHolder.css("left", 1 * d.offset().left + 1 * d.css("padding-left") + "px"), _DragManager.placeHolder.attr("style", _DragManager.placeHolder.attr("style") + "width : 272px !important;"), _DragManager.placeHolder.css("position", "absolute"));
		d.is(".dmRespColEmptyPlaceHolder, .dmRespRow.dmPlaceHolderRespRow .dmRespCol") || (_DragManager.placeHolder.show(), $.dmx.preview.wnd().jQuery.DM.afterDropPositionFoundHook());
		if ($.dmfw.isDudaone() && !_DragManager.dragFrameworkProps.isFromFramework) {
			var j = _DragManager.getScaledPlaceholderOffset({
				clientX: a.x,
				clientY: a.y
			});
			setTimeout(function() {
				_DragManager.draggedVisual.offset(j)
			},
			0)
		}
		_DragManager.placeHolder.attr("class", _DragManager.placeHolder.attr("class"))
	}
};
PreviewDrop.prototype.dropInsertNow = function(a) {
	a.onInsert = function(a) {
		$.dmfw.setPreviewEditPolicy(!0);
		$.dmfw.isDudaone() && (a.closest(".dmRespColEmptyPlaceHolder").removeClass("dmRespColEmptyPlaceHolder"), $.respUtils.initPlaceHolders(), $.dmops.redrawSelection());
		setTimeout(function() {
			$.dmops.redrawSelection()
		},
		1E3)
	};
	_DragManager.dropped = !0;
	if (_DragManager.isPlaceholderAttachedToDom()) {
		for (var e = _DragManager.placeHolder.next(), d = e && 0 < e.length ? e.dmid() : null; null != d && 0 < d.indexOf("clear") || e.attr("dmle_clear") || 0 < e.length && 3 == e.get(0).nodeType;) d = (e = e.next()) && 0 < e.length ? e.dmid() : null;
		_DragManager.placeHolder.isReallyFirst() && (e = _DragManager.placeHolder.parent());
		try {
			if (e.is(".dmRespRow.dmPlaceHolderRespRow .dmRespCol")) {
				var g = e.closest(".dmRespRow.dmPlaceHolderRespRow");
				$.dmfw.setPreviewEditPolicy(!1);
				$.respUtils.insertNewRow(g.parent(), g.next(), null, 1, $.dmx.currentPage(g),
				function(d) {
					$.dmops.insertElement(_DragManager.dragFrameworkProps.editableToCreate, d.find(".dmRespCol"), d.find(".dmRespCol"), a)
				})
			} else $.dmops.insertElement(_DragManager.dragFrameworkProps.editableToCreate, _DragManager.placeHolder.parent(), e, a)
		} catch(j) {
			$.dmfw.setPreviewEditPolicy(!0),
			console.log("error on inserting new row with element")
		}
	} else $.dmfw.setPreviewEditPolicy(!0);
	_DragManager.stop()
};
PreviewDrop.prototype.dropMoveNow = function(a, e, d) {
	if (null != _DragManager.placeHolder) {
		_DragManager.dropped = !0;
		$.dmfw.setPreviewEditPolicy(!1);
		var g = _DragManager.placeHolder;
		if (null != g.data("targetEditable") && g.data("targetEditable").handleDropDifferent && g.data("targetEditable").handleDropDifferent(_DragManager.originalElement)) {
			var j = {};
			switch (g.data("targetEditable").type) {
			case "imageSlider":
				j = {
					src: _DragManager.originalElement.attr("src"),
					element: _DragManager.originalElement,
					editableInnerElement: g.data("targetEditable").element
				};
				break;
			case "photoGallery":
				j = {
					src: _DragManager.originalElement.attr("src"),
					element: _DragManager.originalElement,
					editableInnerElement: g.data("targetEditable").element
				}
			}
			j.onDone = function() {
				$.dmops.deleteElement(_DragManager.element, null, !1);
				_DragManager.stop()
			};
			j.editableInnerElement.selectElement();
			g.data("targetEditable").handleDropDifferentImpl(j);
			$(_DragManager.element).show()
		} else {
			var k = null,
			l = _DropManager.placeHolder.is(".dmPlaceHolderRespRow *");
			$.changePage({
				element: _DropManager.placeHolder,
				clientChange: function() {
					if (l) a.show();
					else {
						var d = _DropManager.placeHolder.next();
						d.is("[dmle_clear]") && _DropManager.placeHolder.insertAfter(d);
						a.parent();
						_DropManager.placeHolder.parent().is("ul, ol") && !a.is("li") && (k = $("\x3cli\x3e\x3c/li\x3e"), k.attr("duda_id", a.dmid()), k.append(a.clone()), a.detach());
						var e = null == k ? a: k;
						_DragManager.dragClonedElement ? _DragManager.draggedVisual.hide() : (e.addClass("displayNone"), e.removeClass("dmDraggedDomElementScaled"), setTimeout(function() {
							_DragManager.reinitDraggedElementOnDrop()
						},
						0));
						setTimeout(function() {
							_DropManager.placeHolder.replaceWith(e);
							e.hide();
							e.removeClass("displayNone");
							e.fadeIn(400);
							null != k ? $(k.children().get(0)).show() : a.show();
							a.editable().initOnDrop && a.editable().initOnDrop();
							$.dmfw.setPreviewEditPolicy(!0)
						},
						0)
					}
				},
				serverChange: function() {
					setTimeout(function() {
						null != k && (a = k);
						var g = null,
						j = null,
						j = a.isReallyFirst() ? a.parent() : a.next();
						j.is("[dmle_clear]") && (j = j.next());
						j && j.length && (g = j.dmid());
						var o = function(g) {
							if (g && (g.wasMoved || g.markup)) a.find("*").andSelf().filter("img").removeAttr("style"),
							NEFW.PREVIEW.get(0).contentWindow.styleImages(),
							setTimeout("NEFW.PREVIEW.get(0).contentWindow.styleImages()", 300),
							null != k && g.parentID && a.parent().dmid() != g.parentID ? (k.attr("duda_id", g.parentID), k.addClass("dmAutoInsertFix")) : g.newWrapperID && (a.parent().contents().get(0) && 3 == a.parent().contents().get(0).nodeType ? $(a.parent().contents().get(0)).wrap('\x3cspan class\x3d"dmAutoInsertFix" duda_id\x3d' + g.newWrapperID + "/\x3e") : a.parent().contents().get(1) && 3 == a.parent().contents().get(1).nodeType && $(a.parent().contents().get(1)).wrap('\x3cspan class\x3d"dmAutoInsertFix" duda_id\x3d' + g.newWrapperID + "/\x3e"), a.parent().attr("replace_mode", "node_subtree").attr("dmle_replace", "true"));
							$.dmx.events.trigger("dragFinish");
							null != e && e();
							$.dmfw.isDudaone() && setTimeout(function() {
								a.closest(".dmRespColEmptyPlaceHolder").removeClass("dmRespColEmptyPlaceHolder");
								$.respUtils.initPlaceHolders()
							},
							200);
							$.deselectAllEditableElements();
							if (l) a.selectElement();
							else {
								var j = $.elementFromPoint(d.clientX, d.clientY);
								j && setTimeout(function() {
									$(j).selectElement()
								},
								200)
							}
						},
						r = _DragManager.getDraggedFromPage(),
						u = l ? $.dmx.currentPage(_DropManager.placeHolder) : $.dmx.currentPage(a);
						null == r || r == u ? l ? (g = _DropManager.placeHolder.closest(".dmRespRow.dmPlaceHolderRespRow"), $.respUtils.insertNewRow(g.parent(), g.next(), null, 1, u,
						function(d) {
							d.find(".dmRespCol").append(a);
							a.show();
							$.dmsrv.moveElement($.dmx.currentPage(a), a.dmid(), d.find(".dmRespCol").dmid(), null, o)
						})) : $.dmsrv.moveElement($.dmx.currentPage(a), a.dmid(), a.parent().dmid(), g, o) : l ? (g = _DropManager.placeHolder.closest(".dmRespRow.dmPlaceHolderRespRow"), $.respUtils.insertNewRow(g.parent(), g.next(), null, 1, u,
						function(d) {
							d.find(".dmRespCol").append(a);
							a.show();
							$.dmops.moveElementBetweenPages(r, u, a, d.find(".dmRespCol"), null, o);
							null != e && e()
						})) : $.dmops.moveElementBetweenPages(r, u, a, a.parent(), g, o)
					},
					0)
				}
			})
		}
	}
};
PreviewDrop.prototype.getDroppingAreaByPoint = function(a) {
	function e(a, d, e, g) {
		a = !1;
		var j = null,
		j = _DragManager.dragFrameworkProps.isFromFramework ? "function" == typeof _DragManager.dragFrameworkProps.editableToCreate.getDummyElement ? _DragManager.dragFrameworkProps.editableToCreate.getDummyElement() : $("\x3cdiv\x3e\x3c/div\x3e") : _DragManager.element,
		k = !1;
		_DragManager.dragFrameworkProps.isFromFramework && (k = !0); - 1 != g.indexOf("inside") && $.isLegalInside(j, d, e, g, k) && (a = !0); - 1 != g.indexOf("outside") && $.isLegalOutside(j, d, e, g, k) && (a = !0);
		$.isBasicLegalCheck(j, e, k) || (a = !1);
		return a
	}
	var d = NEFW.PREVIEW.get(0).contentWindow,
	g = Number.MAX_VALUE,
	j = null,
	k = null,
	l = null,
	m = [],
	n = null,
	o = 20,
	r = $.dmfw.getPreviewElement("div.dmContent");
	0 < r.length && (o = parseInt(r.css("padding-left")));
	a.x > o && a.x < $(d).width() - o && (n = _DropManager.getMatchedEditableElementForDrop(null, a));
	if (null != n && (d = _DropManager.decideIfEditableIsInsideViewPort(n), !d.top && !d.bottom && (n = _DropManager.getMatchedEditableElementForDrop(null, {
		x: $($.dmx.preview.wnd()).outerWidth() / 2,
		y: a.y
	})), null != n)) {
		var u = n.element,
		n = null,
		s = a.y + $.getScrollingPosition()[1],
		B = a.x + $.getScrollingPosition()[0];
		a = null;
		a = _DragManager.element && _DragManager.element.is(".dmRespRow") ? $(u) : $(u).find("*:visible").add($(u).filter(function() {
			return $(this).is(":visible")
		})).filter(function() {
			var a = 0 < $(this).width() || 0 < $(this).height() || $(this).hasClass("dmFooter") || $(this).hasClass("dmContent") || $(this).hasClass("dmHeader"),
			d = $.decideIfElementIsInsideViewPort($(this));
			return a = 0 != $(this).css("opacity") && "hidden" != $(this).css("visibility") && a && (d.top || d.bottom)
		});
		a.each(function(a, d) {
			a: {
				var n = _DropManager.getMatchedEditableElementForDrop($(d));
				if (null != n) {
					var o = $(n.element);
					if (null != o.attr("duda_id")) {
						var r = o.attr("duda_id");
						if (m[r]) break a;
						else m[r] = !0
					}
					var r = o.offset().top,
					I = o.offset().top + o.outerHeight();
					if (Math.abs(s - r) < g || Math.abs(s - I) < g) {
						var G = _DropManager.decideWhereToInsert(u, n),
						K = {};
						K.pageX = B;
						K.pageY = s;
						K = o.rPosition(K);
						$.dmx.preview.wnd().$.DM.isBodyScrollable() || (K.x -= $.getScrollingPosition()[0], K.y -= $.getScrollingPosition()[1]);
						var J = o.outerHeight(),
						G = K.y < J / 2 ? G + "-top": G + "-bottom",
						J = e(K, n, o, G); ! J && -1 != G.indexOf("inside") && (G = G.replace("inside", "outside"), J = e(K, n, o, G));
						if (J) if (K = Math.min(Math.abs(s - r), Math.abs(s - I)), J = _DropManager.decideIfEditableIsInsideViewPort(n), (Math.abs(s - r) == K || !_DragManager.isPlaceholderAttachedToDom() && !J.bottom) && J.top) ! _DragManager.isPlaceholderAttachedToDom() && !J.bottom && (G = G.replace("bottom", "top")),
						g = Math.abs(s - r),
						j = n,
						k = o,
						l = G;
						else if ((Math.abs(s - I) == K || !_DragManager.isPlaceholderAttachedToDom() && !J.top) && J.bottom) ! _DragManager.isPlaceholderAttachedToDom() && !J.top && (G = G.replace("top", "bottom")),
						g = Math.abs(s - I),
						j = n,
						k = o,
						l = G
					}
				}
			}
		})
	}
	return {
		editable: j,
		correctElement: k,
		actionPosition: l
	}
};
PreviewDrop.prototype.decideWhereToInsert = function(a, e) {
	var d = !1;
	$(e.element).find("*").andSelf().each(function(e, g) {
		$(g).is($(a)) && (d = !0)
	});
	var g = "outside";
	if (d && (e.allowedOperations(e.element, _DragManager.getDraggedKey()).insertInsideTop || e.allowedOperations(e.element, _DragManager.getDraggedKey()).insertInsideBottom)) g = "inside";
	return g
};
PreviewDrop.prototype.decideIfEditableIsInsideViewPort = function(a) {
	if (null == a || null == a.element) return ! 1;
	a = $(a.element);
	return $.decideIfElementIsInsideViewPort(a)
};
PreviewDrop.prototype.getMatchedEditableElementForDrop = function(a, e) {
	if (null == a) {
		var d = a = $.elementFromPoint(e.x, e.y),
		g = !1,
		j = null;
		do
		if ($(a).is(".dmRespColsWrapper")) {
			if (j = $(a).closest(".dmRespRow, dmRespDesignRow"), e.y = Math.max(0, e.y - _DragManager.verticalColumnThresholdToFind), d = a, a = $.elementFromPoint(e.x, e.y), !$(a).closest($(a).closest(".dmRespRow, dmRespDesignRow")).is(j)) {
				g = !0;
				try {
					a = $(d).find(".dmRespCol").eq(0).children().get(0)
				} catch(k) {}
			}
		} else g = !0;
		while (!g && 0 < e.y)
	} else a = $(a);
	if (null == a) return null;
	g = null;
	d = !1;
	if (_DragManager.element && _DragManager.element.is(".dmRespRow")) g = "responsiverow",
	d = !0;
	else {
		var j = Number.MAX_VALUE,
		l;
		for (l in _inlineCfg.editables) _inlineCfg.editables[l].isMember(a) && _inlineCfg.editables[l].priority < j && (g = l, j = _inlineCfg.editables[l].priority)
	}
	if (null != g) {
		if (l = $(_inlineCfg.editables[g].getCorrectElement(a)), !l.hasClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS) && !l.is(INLINE_EDITOR_EDITED_ELEMENT_CLASS + " *")) return null != _inlineCfg.editables[g].getCorrectElementForDrop && (l = _inlineCfg.editables[g].getCorrectElementForDrop(a, _DragManager.element)),
		g = jQuery.extend(!0, {},
		_inlineCfg.editables[g]),
		g.setCorrectElement(l, !0),
		!d && !$.isLegalDropArea(l) || null == g.element ? null: g
	} else return null
};
var NEPreviewMGR = new NEPreviewManager;
function NEPreviewManager() {}
NEPreviewManager.prototype.init = function(a) {
	this.editorUtils.init(a)
};
function NEEInlineEditor(a) {
	this.editorUtils = new NEEinlineEditorUtils(a)
}
NEEInlineEditor.prototype.init = function(a) {
	this.editorUtils.init(a)
};
NEEInlineEditor.prototype.initMultipleSelection = function(a) {
	this.editorUtils.initMultipleSelection(a)
};
NEEInlineEditor.prototype.remove = function() {
	this.editorUtils.removeEditor()
};
NEEInlineEditor.prototype.draw = function(a) {
	this.editorUtils.draw(a)
};
NEEInlineEditor.prototype.redraw = function(a) {
	this.editorUtils.redraw(a)
};
NEEInlineEditor.prototype.clone = function() {
	var a = new NEEInlineEditor(this.editorUtils.editable);
	a.editorUtils = this.editorUtils.clone();
	return a
};
function NEEinlineEditorUtils(a) {
	this.editorUniqueId = this.editorBottom = this.editorRight = this.editorLeft = this.editorBorderTop = this.selectionOverlay = this.editorCover = this.editorTop = null;
	this.editable = a;
	this.dbClicksAllowed = !1;
	this.contextBoxFadeInDelay = 0;
	this.properties = {
		title: dmStr["ui.title"] + ":",
		isDelete: !0,
		isEdit: !0,
		isMovable: !0,
		isExpandable: !0,
		isCollapsable: !1,
		isRemoveallExpandable: !1,
		isRemoveallCollapsable: !1,
		isUnderTable: !1,
		padding: "inner",
		lockModeOpensEditor: !1,
		useSeparateTextEditMode: !1,
		hasHide: !1,
		hoverDisplayEditor: !1,
		useCoverElement: !1,
		isImportable: !1,
		isCopy: !0,
		isPaste: !0,
		isHideOnDevice: !0,
		allowTextEditing: !1,
		hasAlign: "ONE" == dm_current_editor ? !0 : !1,
		useSelectionOverlay: "ONE" == dm_current_editor ? !0 : !1,
		selectionOverlay: {
			overlayTitle: !1,
			edit: !0,
			more: !0,
			background: -1,
			replace: !1,
			deleteElement: !0,
			buttonsOffset: null
		}
	};
	var e = this;
	$.dmx.events.unbind("fwKeyDown.delete").bind("fwKeyDown.delete",
	function(a) {
		var e = a.srcElement || a.target;
		if (46 == a.keyCode || 8 == a.keyCode) if (! ("INPUT" === e.tagName.toUpperCase() && ("TEXT" === e.type.toUpperCase() || "PASSWORD" === e.type.toUpperCase()) || "TEXTAREA" === e.tagName.toUpperCase() || "true" == e.getAttribute("contenteditable"))) if ($.dmfw.isEditorOpen()) {
			if (8 == a.keyCode) return event.preventDefault(),
			!1
		} else {
			try {
				$.dmx.current.editable.inlineEditor.editorUtils.controls.remove.handler()
			} catch(j) {}
			event.preventDefault();
			return ! 1
		}
	});
	$.dmx.events.unbind("fwKeyDown.copy").bind("fwKeyDown.copy",
	function(a) {
		if (a.ctrl && 67 == a.keyCode && (a = a.srcElement || a.target, !("INPUT" === a.tagName.toUpperCase() && ("TEXT" === a.type.toUpperCase() || "PASSWORD" === a.type.toUpperCase()) || "TEXTAREA" === a.tagName.toUpperCase()) && !$.dmfw.isEditorOpen())) try {
			$.dmx.current.editable.inlineEditor.editorUtils.controls.copy.handler()
		} catch(e) {}
	});
	$.dmx.events.unbind("fwKeyDown.paste").bind("fwKeyDown.paste",
	function(a) {
		if (a.ctrl && 86 == a.keyCode && (a = a.srcElement || a.target, !("INPUT" === a.tagName.toUpperCase() && ("TEXT" === a.type.toUpperCase() || "PASSWORD" === a.type.toUpperCase()) || "TEXTAREA" === a.tagName.toUpperCase()) && !$.dmfw.isEditorOpen())) $.dmx.current.element ? $.dmops.pasteElement($.dmx.current.element.parent(), $.dmx.current.element) : $.dmfw.isDudaone() ? (a = $.dmfw.getPreviewElement(".dmContent").find(".dmRespRow").eq(0).find(".dmRespCol").eq(0), $.dmops.pasteElement(a, a.children().eq(0))) : $.dmops.pasteElement()
	});
	this.controls = {
		remove: {
			element: null,
			title: e.editable.inlineEditorProperties.deleteTitle || dmStr["ui.delete"],
			tooltip: e.editable.inlineEditorProperties.tooltips ? e.editable.inlineEditorProperties.tooltips["delete"] : null,
			buttonClassName: "DMInlineEditorDeleteBtn",
			iterable: !0,
			handler: function(d) {
				if (e.properties.isDelete && (d = d || $(e.editable.element), a.getCorrectElementForDelete && (d = a.getCorrectElementForDelete(d)), !a.onDelete || a.onDelete(d))) if (e.properties.hideOnDelete) $.dmops.updateCurrentCss({
					attrToAdd: [{
						attr: "display",
						value: "none"
					}]
				},
				{
					element: d,
					success: function() {
						$.dmfw.closeEditor();
						a.inlineEditor.editorUtils.removeEditor();
						$.dmfw.isDudaone() && ($.respUtils.initPlaceHolders(), $.respUtils.redrawBars())
					}
				});
				else {
					var g = null;
					null != $.respUtils && (g = d.closest(".dmRespRow, .dmRespDesignRow"));
					var j = !1;
					d.addClass("dmConsiderOutElement");
					$.respUtils && $.respUtils.isRowEmpty(g) && (j = !0);
					d.removeClass("dmConsiderOutElement");
					$.dmops.deleteElement(d,
					function() {
						a.inlineEditor && a.inlineEditor.editorUtils.removeEditor();
						$.dmfw.isDudaone() && setTimeout(function() {
							j && $.respUtils.deleteRow(g);
							$.respUtils.initPlaceHolders();
							$.respUtils.redrawBars();
							$.respUtils.resize.drawResizer(g.find(".dmRespColResizer"))
						},
						500)
					},
					!0, {
						noHistory: j
					})
				}
			}
		},
		hide: {
			element: null,
			title: dmStr["ui.delete"],
			buttonClassName: "DMInlineEditorHideBtn",
			iterable: !0,
			handler: function(d) {
				d = d || $(e.editable.element);
				a.getCorrectElementForDelete && (d = a.getCorrectElementForDelete(d));
				d = "." + d.attr("id");
				$.dmops.updateGlobalCssAndElement({
					attrToAdd: [{
						attr: "display",
						value: "none"
					}]
				},
				{
					className: d,
					clientOnly: !1,
					success: function() {
						a.inlineEditor.editorUtils.removeEditor()
					}
				})
			}
		},
		edit: {
			element: null,
			title: dmStr["ui.edit"],
			buttonClassName: "DMInlineEditorEditBtn",
			iterable: !0,
			handler: function(d, g, j) {
				$.extend(!0, {},
				e.properties, a.inlineEditorProperties).isEdit && (d = d || $(e.editable.element), $.dmfw.isUseNewSelectionContext() ? (j && "dbclick" == j.type && d.lockElement({
					hideTopBar: !0
				}), $.dmfw.isDudaone() && d.lockElement({
					hideTopBar: !0
				}), a.inlineEditor.editorUtils.editorTop.fadeOut(200)) : d.lockElement(), $.dmfw.isEditorOpen(d) ? "navigation" == a.type && $.dmfw.preview.showEditableBar(g) : ($.dmfw.openEditor(a, d, {
					event: j
				}), "blog" != a.type && $.dmfw.preview.showEditableBar(g)));
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
			}
		},
		lock: {
			element: null,
			title: "",
			buttonClassName: "DMInlineEditorLockBtn",
			iterable: !1,
			handler: function(d) {
				var g = $.extend(!0, {},
				e.properties, a.inlineEditorPropertie);
				d = d || $(e.editable.element);
				d.lockElement();
				g.isMovable && d.addClass("dmLockedNew");
				$.dmfw.isEditorOpen() && $.dmfw.closeEditor({
					keepPreview: !0,
					forceShouldClose: !0,
					forceExecuteOnClose: !0,
					onEditorClose: function() {}
				});
				e.initMoveAction(!1)
			}
		},
		inlineEdit: {
			element: null,
			title: dmStr["ui.inline.editor.2"],
			buttonClassName: "DMInlineEditorInlineEditBtn",
			iterable: !1,
			toggle: !1,
			handler: function() {
				e.controls.inlineEdit.toggle ? e.disableInlineEdit() : e.enableInlineEdit();
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
			}
		},
		goToLink: {
			element: null,
			title: dmStr["ui.inline.editor.1"],
			buttonClassName: "DMInlineEditorGoToLinkBtn",
			iterable: !0,
			event: null,
			handler: function(a) {
				if (e.controls.goToLink.event) if (a = $(e.controls.goToLink.event.target), a.is("a") || (a = a.closest("a")), a.is("A") && null != a.attr("dmGoto")) a.trigger("click");
				else if (a.is("A") && null != a.attr("href") && a.attr("href").startsWith("#")) {
					var g = a.attr("href").replace("#", "");
					a = $.dmfw.getPreviewElement("#" + g);
					0 == a.length && (a = $.dmfw.getPreviewElement("a[name\x3d" + g + "]"));
					0 < a.length && $.dmops.scrollPreviewToElement(a)
				} else $.dmfw.closeEditor(),
				$.deselectAllEditableElements(),
				$.dmfw.previewNavigateTo({
					element: a
				})
			}
		},
		editParent: {
			element: null,
			title: "Edit Parent",
			buttonClassName: "DMInlineEditorEditParentBtn",
			iterable: !0,
			handler: function(a) {
				a = a.closest(e.properties.editParentSelector);
				$.dmfw.selectAndOpenEditor(a);
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
			}
		},
		importContent: {
			element: null,
			title: "Import Content",
			buttonClassName: "DMInlineEditorImportContentParentBtn",
			iterable: !0,
			handler: function(a) {
				$.contentImport.open(a);
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
			}
		},
		copy: {
			element: null,
			title: dmStr["ui.copy"],
			buttonClassName: "DMInlineEditorCopyBtn",
			iterable: !0,
			handler: function(d) {
				e.properties.isCopy && dm_enable_copy && (d = d || $(e.editable.element), a.getCorrectElementForCopy && (d = a.getCorrectElementForCopy(d)), $.dmops.copyElement(d), a.inlineEditor.editorUtils.editorTop.fadeOut(200))
			}
		},
		paste: {
			element: null,
			title: dmStr["ui.paste"],
			buttonClassName: "DMInlineEditorCopyBtn",
			iterable: !0,
			handler: function(d) {
				dm_enable_copy && (d = d || $(e.editable.element), a.getPasteLocation && a.getPasteLocation(d) ? (d = a.getPasteLocation(d), $.dmops.pasteElement(d.parent, d.before)) : $.dmops.pasteElement(d.parent(), d), a.inlineEditor.editorUtils.editorTop.fadeOut(200), a.inlineEditor.editorUtils.hideSelectionOverlay())
			}
		},
		hideOnDevice: {
			element: null,
			title: "Hide on {device}",
			buttonClassName: "DMInlineEditorHideOnDeviceBtn",
			iterable: !0,
			clickparams: null,
			handler: function(a, e, j, k) {
				a = $(a);
				$.onefw.device();
				e = $(e).closest(".DMInlineEditorHideOnDeviceBtn");
				var l = j = "",
				m = "";
				switch (k.device) {
				case "mobile":
					j = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.MOBILE;
					l = "dm-icon-hide-phone";
					m = "dm-icon-phone2";
					break;
				case "tablet":
					j = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.TABLET;
					l = "dm-icon-hide-tablet";
					m = "dm-icon-tablet";
					break;
				case "desktop":
					j = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.DESKTOP,
					l = "dm-icon-hide-pc",
					m = "dm-icon-pc"
				}
				k = {};
				a.hasClass(j) ? (e.removeClass("DMInlineEditorDisabled"), e.find(".icon").removeClass(l).addClass(m), k = {
					classesToRemove: [j],
					attrToRemove: [],
					classesToAdd: [],
					attrToAdd: null
				}) : (e.addClass("DMInlineEditorDisabled"), e.find(".icon").addClass(l).removeClass(m), k = {
					classesToRemove: null,
					attrToRemove: [],
					classesToAdd: [j],
					attrToAdd: null
				});
				$.dmops.updateCurrentCss(k, {
					element: a,
					success: function() {}
				});
				$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay();
				$.dmx.events.trigger("hideElementOnDevice", {})
			}
		},
		linkEditor: {
			element: null,
			title: dmStr["ui.inline.editor.3"],
			buttonClassName: "DMInlineEditorEditLinkBtn",
			iterable: !0,
			event: null,
			handler: function(a) {
				if (e.controls.linkEditor.event) {
					a = $(e.controls.linkEditor.event.target);
					var g = "paragraph" == $.dmx.current.editable.type && a.is("a"),
					j = "image" == $.dmx.current.editable.type && (a.is("img") || 0 < a.find("img:first").length);
					g && ($.dmfw.isEditorOpen() || $.dmfw.openEditor(e.editable, $(e.editable.element), null, {
						onEditorReady: function() {
							_RTE_Element.openSecondaryEditor(a, j ? "image": "link")
						}
					}));
					j && $.dmfw.addEditor($.dmfw.editables("image"), a)
				}
			}
		},
		expand: {
			element: null,
			title: dmStr["ui.expand"],
			buttonClassName: "DMInlineEditorExpandBtn",
			iterable: !0,
			handler: function(a) {
				var g = $.dmfw.isEditorOpen();
				a = a || $(e.editable.element);
				var j = NEFW.PREVIEW.get(0).contentWindow,
				k = $(a).expandSelection(),
				k = k.selectElement({
					isCollapsable: !0,
					forceSelect: !0
				});
				null != k && k.isSelected() ? (j._runtimeProperties.lastSelectedElements[j._runtimeProperties.lastSelectedElements.length] = $(a), k.lockElement(), $.dmops.scrollPreviewToElement(k), g && setTimeout(function() {
					$.dmfw.closeEditor({
						keepPreview: !0
					});
					$.dmfw.openEditor($.dmx.current.editable, k)
				},
				100)) : NEFW.PREVIEW.get(0).contentWindow._runtimeProperties.lastSelectedElements = []
			}
		},
		removeAllExpand: {
			element: null,
			title: dmStr["ui.expand"],
			buttonClassName: "DMInlineEditorExpandBtn",
			iterable: !1,
			handler: function(a) {
				a = a || $(e.editable.element);
				var g = $.dmx.preview.wnd(),
				j = a.offset().top,
				k = $(a).expandSelection(),
				k = k.selectElement({
					forceSelect: !0,
					isRemoveallCollapsable: !0,
					title: dmStr["ui.nee.inline.1"],
					multipleRemoveSelection: !0
				});
				if (null != k && k.isSelected()) {
					var k = $.dmx.current.element,
					l = $.dmx.current.editable.inlineEditor.clone();
					l.initMultipleSelection({
						title: dmStr["ui.nee.inline.1"]
					});
					k.multiLockElement({
						inlineEditor: l
					});
					l.editorUtils.overlay.data("alterSelection", k);
					$.dmx.selectedElements.push({
						element: k,
						inlineEditor: l
					});
					k.selectElement({
						isRemoveallCollapsable: !0,
						multipleRemoveSelection: !0
					});
					g._runtimeProperties.lastSelectedElements[g._runtimeProperties.lastSelectedElements.length] = $(a);
					a = k.offset().top;
					j = g.pageYOffset - (j - a);
					g.setEventsFirePolicy(!1);
					$.dmops.scrollPreview(j, 500,
					function() {
						g.setEventsFirePolicy(!0)
					})
				} else NEFW.PREVIEW.get(0).contentWindow._runtimeProperties.lastSelectedElements = []
			}
		},
		removeAllCollapse: {
			element: null,
			title: dmStr["ui.collapse"],
			buttonClassName: "DMInlineEditorCollapseBtn",
			iterable: !1,
			handler: function(a) {
				a = a || $(e.editable.element);
				for (var g = [], j = 0; j < $.dmx.selectedElements.length; j++) {
					var k = $.dmx.selectedElements[j];
					0 < k.element.find(a).size() || a.is(k.element) ? k.inlineEditor.remove() : g.push($.dmx.selectedElements[j])
				}
				$.dmx.selectedElements = g;
				var l = $.dmx.preview.wnd(),
				g = a.offset().top;
				a = $(a).collapseSelection();
				0 < a.length && (0 < l._runtimeProperties.lastSelectedElements.length ? a.selectElement({
					isRemoveallCollapsable: !0,
					title: dmStr["ui.nee.inline.1"],
					multipleRemoveSelection: !0
				}) : a.selectElement({
					forceSelect: !0,
					isRemoveallCollapsable: !1,
					title: dmStr["ui.nee.inline.1"],
					multipleRemoveSelection: !0
				}), j = $.dmx.current.element, k = $.dmx.current.editable.inlineEditor.clone(), k.initMultipleSelection({
					title: dmStr["ui.nee.inline.1"]
				}), j.multiLockElement({
					inlineEditor: k
				}), k.editorUtils.overlay.data("alterSelection", j), $.dmx.selectedElements.push({
					element: j,
					inlineEditor: k
				}), 0 < l._runtimeProperties.lastSelectedElements.length ? a.selectElement({
					isRemoveallCollapsable: !0,
					multipleRemoveSelection: !0
				}) : a.selectElement({
					isRemoveallCollapsable: !1,
					multipleRemoveSelection: !0
				}), a = a.offset().top, g = l.pageYOffset - (g - a), l.setEventsFirePolicy(!1), $.dmops.scrollPreview(g, 500,
				function() {
					l.setEventsFirePolicy(!0)
				}))
			}
		},
		collapse: {
			element: null,
			title: dmStr["ui.collapse"],
			buttonClassName: "DMInlineEditorCollapseBtn",
			iterable: !0,
			handler: function(a) {
				var g = $.dmfw.isEditorOpen();
				a = a || $(e.editable.element);
				var j = NEFW.PREVIEW.get(0).contentWindow,
				k = $(a).collapseSelectionElement();
				0 < k.length && (0 < j._runtimeProperties.lastSelectedElements.length ? k.selectElement({
					forceSelect: !0,
					isCollapsable: !0
				}) : k.selectElement({
					forceSelect: !0,
					isCollapsable: !1
				}), k.lockElement(), $.dmops.scrollPreviewToElement(k), g && setTimeout(function() {
					$.dmfw.closeEditor({
						keepPreview: !0
					}); ! 1 != $.dmx.current.editable.inlineEditorProperties.isEdit && $.dmfw.openEditor($.dmx.current.editable, k)
				},
				100))
			}
		},
		table: {
			element: null,
			title: dmStr["ui.nee.inline.2"],
			buttonClassName: "DMInlineEditorTableBtn",
			iterable: !0,
			handler: function(a) {
				a = a || $(e.editable.element);
				var g = $.dmx.preview.wnd(),
				j = $(a).getContainingTable();
				if ((j = j.selectElement({
					forceSelect: !0,
					isCollapsable: !0
				})) && j.isSelected()) g._runtimeProperties.lastSelectedElements[g._runtimeProperties.lastSelectedElements.length] = $(a),
				j.lockElement(),
				$.dmops.scrollPreviewToElement(j),
				setTimeout(function() {
					$.dmfw.closeEditor({
						keepPreview: !0
					});
					$.dmfw.openEditor($.dmx.current.editable, j)
				},
				100),
				$.dmx.current.editable.inlineEditor.editorUtils.editorTop.fadeOut(200)
			}
		},
		align: {
			element: null,
			title: "",
			iterable: !0,
			handler: function(a, e) {
				switch (e) {
				case "left":
					$.alignElement(a, "left");
					break;
				case "right":
					$.alignElement(a, "right");
					break;
				case "center":
					$.alignElement(a, "center")
				}
				$.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide();
				return ! 1
			}
		}
	}
}
NEEinlineEditorUtils.prototype.activateButton = function(a, e) {
	null != a && (e ? (a.css("background-position", "-50px 0px"), a.data("forceBackground", !0)) : (a.css("background-position", "0px 0px"), a.data("forceBackground", !1)))
};
NEEinlineEditorUtils.prototype.initBars = function(a) {
	this.editorTop = $("\x3cdiv\x3e\x3c/div\x3e");
	this.editorCover = $("\x3cdiv\x3e\x3c/div\x3e");
	this.selectionOverlay = this.generateSelectionOverlay();
	this.editorBorderTop = $("\x3cdiv\x3e\x3c/div\x3e");
	this.editorLeft = $("\x3cdiv\x3e\x3c/div\x3e");
	this.editorRight = $("\x3cdiv\x3e\x3c/div\x3e");
	this.editorBottom = $("\x3cdiv\x3e\x3c/div\x3e");
	var e = "body";
	$.dmx.preview.wnd().$.DM.isBodyScrollable() || 0 < $.dmfw.getPreviewElement("#iscrollBody").has($(this.editable.element)).length && (e = "#iscrollBody");
	this.editorCover.data("matchedEditable", this.editable);
	this.editorTop.appendTo($.dmfw.getPreviewElement(e));
	this.editorCover.appendTo($.dmfw.getPreviewElement(e));
	this.selectionOverlay.appendTo($.dmfw.getPreviewElement(e));
	this.editorBorderTop.appendTo($.dmfw.getPreviewElement(e));
	this.editorLeft.appendTo($.dmfw.getPreviewElement(e));
	this.editorRight.appendTo($.dmfw.getPreviewElement(e));
	this.editorBottom.appendTo($.dmfw.getPreviewElement(e));
	this.editorTop.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET).attr("id", INLINE_EDITOR_ID + "_" + this.editorUniqueId);
	this.editorCover.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET).attr("id", INLINE_EDITOR_COVER_ID + "_" + this.editorUniqueId);
	this.selectionOverlay.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET).addClass(INLINE_EDITOR_SELECTION_OVERLAY);
	this.editorBorderTop.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET);
	this.editorLeft.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET);
	this.editorRight.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET);
	this.editorBottom.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET);
	$.dmfw.isUseNewSelection() ? $.dmfw.isUseNewSelectionContext() ? (this.editorTop.addClass(INLINE_EDITOR_CLASS_NEW).addClass(INLINE_EDITOR_CLASS_NEW_CONTEXT), this.editorCover.addClass(INLINE_EDITOR_COVER_CLASS_NEW), this.selectionOverlay.addClass(INLINE_EDITOR_SELECTION_OVERLAY), this.editorBorderTop.addClass(INLINE_EDITOR_CLASS_TOP_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorLeft.addClass(INLINE_EDITOR_CLASS_LEFT_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorRight.addClass(INLINE_EDITOR_CLASS_RIGHT_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorBottom.addClass(INLINE_EDITOR_CLASS_BOTTOM_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), $.dmfw.isDudaone() && (this.editorTop.addClass(INLINE_EDITOR_CLASS_NEW_ONE), this.editorCover.addClass(INLINE_EDITOR_COVER_CLASS_NEW_ONE), this.selectionOverlay.addClass(INLINE_EDITOR_SELECTION_OVERLAY), this.editorBorderTop.addClass(INLINE_EDITOR_CLASS_TOP_NEW_ONE), this.editorLeft.addClass(INLINE_EDITOR_CLASS_LEFT_NEW_ONE), this.editorRight.addClass(INLINE_EDITOR_CLASS_RIGHT_NEW_ONE), this.editorBottom.addClass(INLINE_EDITOR_CLASS_BOTTOM_NEW_ONE))) : (this.editorTop.addClass(INLINE_EDITOR_CLASS_NEW), this.editorBorderTop.addClass(INLINE_EDITOR_CLASS_TOP_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorLeft.addClass(INLINE_EDITOR_CLASS_LEFT_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorRight.addClass(INLINE_EDITOR_CLASS_RIGHT_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED), this.editorBottom.addClass(INLINE_EDITOR_CLASS_BOTTOM_NEW).addClass(INLINE_EDITOR_CLASS_NEW_SELECTED)) : (this.editorTop.addClass(INLINE_EDITOR_CLASS), this.editorBorderTop.addClass(INLINE_EDITOR_CLASS_TOP), this.editorLeft.addClass(INLINE_EDITOR_CLASS_LEFT), this.editorRight.addClass(INLINE_EDITOR_CLASS_RIGHT), this.editorBottom.addClass(INLINE_EDITOR_CLASS_BOTTOM));
	a.editorTopClass && this.editorTop.addClass(a.editorTopClass);
	a.editorCoverClass && this.editorCover.addClass(a.editorCoverClass);
	a.editorBorderTopClass && this.editorBorderTop.addClass(a.editorBorderTopClass);
	a.editorBottomClass && this.editorBottom.addClass(a.editorBottomClass);
	a.editorLeftClass && this.editorLeft.addClass(a.editorLeftClass);
	a.editorRightClass && this.editorRight.addClass(a.editorRightClass);
	this.editorTop.hide();
	this.editorCover.hide();
	this.selectionOverlay.hide();
	this.editorBorderTop.hide();
	this.editorRight.hide();
	this.editorLeft.hide();
	this.editorBottom.hide();
	this.selectionOverlay.attr("class", this.selectionOverlay.attr("class"));
	this.selectionOverlay.find("*").each(function() {
		$(this).attr("class", $(this).attr("class"))
	});
	$.dmx.multiSelect && (this.overlay = $("\x3cdiv\x3e\x3c/div\x3e"), this.overlay.appendTo($.dmfw.getPreviewElement(e)), this.overlay.attr("duda_id", "dmSelectorOverlay"), this.overlay.hide())
};
NEEinlineEditorUtils.prototype.generateSelectionOverlay = function() {
	var a = $.extend(!0, {},
	this.properties.selectionOverlay);
	$.extend(a, this.editable.inlineEditorProperties.selectionOverlay);
	var e = this.properties,
	d = this.editable,
	g = $("\x3cdiv\x3e\x3c/div\x3e"),
	j = $("\x3cdiv\x3e\x3c/div\x3e");
	g.append(j);
	j.addClass("dmSelectionOverlayInside DMInlineEditorNotEditableElement");
	var k = null;
	a.overlayTitle && (k = $("\x3cdiv\x3e" + a.overlayTitle + "\x3c/div\x3e"), j.append(k), k.addClass("dmSelectionOverlayButton dmSelectionOverlayTitleButton DMInlineEditorNotEditableElement"));
	a.edit && (k = $("\x3ca\x3eEdit\x3c/a\x3e"), j.append(k), k.addClass("dmSelectionOverlayButton dmSelectionOverlayEditButton DMInlineEditorNotEditableElement"), k.off("click.edit").on("click.edit",
	function() {
		$.extend(!0, {},
		e, d.inlineEditorProperties).allowTextEditing ? ($.dmx.current.editable.inlineEditor.editorUtils.enableInlineEdit(), range = rangy.createRange(), range.selectNodeContents($.dmx.current.element.get(0)), selection = rangy.getSelection(), selection.setSingleRange(range), $.dmx.current.element.find(".placeholder").remove(), $.dmops.updateCurrentAttributes({
			attrToRemove: ["data-dmtmpl"]
		}), $.respUtils.removeRowEditor()) : $.dmfw.selectAndOpenEditor($.dmx.current.element);
		$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
	})); - 1 != a.background && (k = $("\x3ca\x3eBackground\x3c/a\x3e"), j.append(k), k.addClass("dmSelectionOverlayButton dmSelectionOverlayBackgroundButton DMInlineEditorNotEditableElement"), k.off("click.editbg").on("click.editbg",
	function() {
		$.dmfw.selectAndOpenEditor($.dmx.current.element, !1, {
			initTab: a.background
		});
		$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
	}));
	a.replace && (k = $("\x3ca\x3eReplace\x3c/a\x3e"), j.append(k), k.addClass("dmSelectionOverlayButton dmSelectionOverlayReplaceButton DMInlineEditorNotEditableElement"), k.off("click.replace").on("click.replace",
	function() {
		$.extend(!0, {},
		e, d.inlineEditorProperties);
		$("#_editor").hide();
		$.dmfw.selectAndOpenEditor($.dmx.current.element, !1, {
			initTab: a.background,
			onEditorReady: function() {
				d.onTabChange = function() {
					$("#headerLogoChange").trigger("click");
					d.onTabChange = null;
					$.dmx.events.bind("imageChanged",
					function() {
						$.dmfw.closeEditor();
						$("#_editor").show();
						$.dmx.events.unbind("imageChanged")
					});
					var a = d.onEditorClose;
					d.onEditorClose = function() {
						a && a();
						$("#_editor").show();
						$.dmx.events.unbind("imageChanged");
						d.onEditorClose = a
					}
				}
			}
		});
		$.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()
	}));
	if (a.more) {
		k = $("\x3ca\x3e\x3c/a\x3e");
		j.append(k);
		k.addClass("dmSelectionOverlayButton dm-icon-reorder dmSelectionOverlayMoreButton DMInlineEditorNotEditableElement");
		var l = k;
		k.off("click.more").on("click.more",
		function(a) {
			var g = $.extend(!0, {},
			e, d.inlineEditorProperties);
			$.dmx.current.editable.inlineEditor.editorUtils.editorTop.is(":hidden") && $.dmx.current.editable.inlineEditor.editorUtils.editorTop.fadeIn(g.contextBoxFadeInDelay);
			$.dmx.current.editable.inlineEditor.editorUtils.redrawEditorContextBox({
				event: a,
				offsetTop: l.offset().top,
				offsetLeft: l.offset().left + l.outerWidth()
			})
		})
	}
	if (a.deleteElement && $.extend(!0, {},
	e, d.inlineEditorProperties).isDelete) {
		var m = $.dmx.current.element,
		k = $("\x3ca\x3e\x3c/a\x3e");
		j.append(k);
		k.addClass("dmSelectionOverlayButton dmSelectionOverlayDeleteElementButton dm-icon-x2 DMInlineEditorNotEditableElement");
		k.off("click.deletecolumn").on("click.deletecolumn",
		function() {
			$.dmx.current.editable.inlineEditor.editorUtils.controls.remove.handler(m)
		})
	}
	return g
};
NEEinlineEditorUtils.prototype.hideSelectionOverlay = function() {
	null != this.selectionOverlay && this.selectionOverlay.hide()
};
NEEinlineEditorUtils.prototype.showSelectionOverlay = function() {
	null != this.selectionOverlay && this.selectionOverlay.show()
};
NEEinlineEditorUtils.prototype.displayBars = function(a) {
	this.draw();
	if (null == a.hideSelectionBars || !1 == a.hideSelectionBars) a.noEffect ? ($.dmfw.isUseNewSelection() ? this.editorBorderTop.show() : this.editorTop.show(), this.editorLeft.show(), this.editorRight.show(), this.editorBottom.show()) : ($.dmfw.isUseNewSelection() ? (!0 === a.hoverDisplayEditor || $.dmx.multiSelect) && this.editorTop.fadeIn(200) : this.editorTop.fadeIn(200), this.editorBorderTop.fadeIn(200), this.editorLeft.fadeIn(200), this.editorRight.fadeIn(200), this.editorBottom.fadeIn(200)); ! 0 === a.useCoverElement && this.editorCover.show();
	if (!0 === a.useSelectionOverlay) {
		this.selectionOverlay.fadeIn(200);
		var e = this.selectionOverlay.find(".dmSelectionOverlayInside");
		a.selectionOverlay.buttonsOffset ? e.offset(a.selectionOverlay.buttonsOffset) : (e.css("left", this.selectionOverlay.outerWidth() / 2 - e.outerWidth() / 2 + "px"), e.css("top", this.selectionOverlay.outerHeight() / 2 - e.outerHeight() / 2 + "px"))
	}
};
NEEinlineEditorUtils.prototype.enableInlineEdit = function(a) {
	null == a && (a = !1);
	var e = this.editable,
	d = $.extend(!0, {},
	this.properties);
	$.extend(d, e.inlineEditorProperties);
	if (d.isEdit && d.allowTextEditing && (!1 === this.controls.inlineEdit.toggle || a)) $.initRichTextEditor(e.element, a),
	$.dmfw.isUseNewSelectionContext() && this.removeMoveAction(),
	this.removeDBclickEdit(),
	this.activateButton(this.controls.inlineEdit.element, !0),
	this.controls.inlineEdit.toggle = !0
};
NEEinlineEditorUtils.prototype.disableInlineEdit = function() {
	var a = $.dmx.current.editable,
	e = $.extend(!0, {},
	this.properties);
	$.extend(e, a.inlineEditorProperties); ! 0 === this.controls.inlineEdit.toggle && ($.removeRichTextEditor(!1), this.initMoveAction(!0, !0), this.initDBclickEdit(), this.activateButton(this.controls.inlineEdit.element, !1), this.controls.inlineEdit.toggle = !1)
};
NEEinlineEditorUtils.prototype.initMultipleSelection = function(a) {
	a && $.extend(this.properties, a);
	this.initBars(this.properties);
	null != this.properties.title && (a = $('\x3cdiv style\x3d"color:white; font-weight:bold;font-size:14px;font-family: Arial;line-height: 31px;float: left;padding-left: 6px;"\x3e' + this.properties.title + "\x3c/div\x3e"), this.editorTop.append(a));
	this.setEditorControls({
		isRemoveallExpandable: !0,
		isRemoveallCollapsable: this.properties.isRemoveallCollapsable
	});
	this.displayBars(this.properties);
	this.overlay.addClass("selectorOverlay");
	this.editorTop.unbind("click").click(function(a) {
		a.preventDefault();
		a.stopPropagation()
	})
};
NEEinlineEditorUtils.prototype.showBar = function(a) {
	a ? (this.editorTop.show(), this.editorBorderTop.hide()) : (this.editorBorderTop.show(), this.editorTop.hide())
};
NEEinlineEditorUtils.prototype.init = function(a) {
	a && (this.properties = $.extend(!0, {},
	this.properties, a));
	$.dmfw.isDudaone() && this.properties.useSelectionOverlay && (this.properties.lockModeOpensEditor = !0);
	$.dmx.multiSelect ? this.initMultipleSelection(a) : (this.editorUniqueId = hex_sha1(String((new Date).getTime())), this.initBars(this.properties), null != this.properties.title && this.editorTop.append(this.addTitle()), this.setEditorControls(this.properties), this.editorTop.find("*").each(function() {
		var a = $(this);
		a.attr("class", a.attr("class"))
	}), this.displayBars(this.properties), this.initDBclickEdit(), (null == a.noMoveInit || !1 === a) && this.initMoveAction(!1, !$.dmfw.isUseNewSelection()))
};
NEEinlineEditorUtils.prototype.onDBclick = function(a) {
	var e = $(this.editable.element); ! 1 === this.properties.useSeparateTextEditMode ? $.dmx.current.editable.inlineEditor.editorUtils.controls.edit.handler(e, $(a.target), a) : this.properties.allowTextEditing && $.initRichTextEditor(e, !0);
	this.removeMoveAction();
	this.removeDBclickEdit();
	this.activateButton(this.controls.inlineEdit.element, !0)
};
NEEinlineEditorUtils.prototype.initDBclickEdit = function() {
	this.dbClicksAllowed = !0
};
NEEinlineEditorUtils.prototype.removeDBclickEdit = function() {
	this.dbClicksAllowed = !1
};
NEEinlineEditorUtils.prototype.initFarAwayMode = function() {
	var a = this;
	$($.dmx.preview.wnd()).unbind("mousemove.faraway" + this.editorUniqueId).bind("mousemove.faraway" + this.editorUniqueId,
	function(e) {
		if (!$(e.target).is("." + INLINE_EDITOR_CLASS_NEW_CONTEXT + ", ." + INLINE_EDITOR_CLASS_NEW_CONTEXT + " *")) if (a.editorTop) {
			if (a.editorTop.is(":visible")) {
				var d = a.editorTop,
				g = e.pageX;
				e = e.pageY;
				var j = Math.max(d.offset().left - 50, 0),
				k = d.offset().left + d.outerWidth() + 50,
				l = Math.max(d.offset().top - 50, 0),
				d = d.offset().top + d.outerHeight() + 50;
				g >= j && g <= k && e >= l && e <= d || a.editorTop.fadeOut(200)
			}
		} else $($.dmx.preview.wnd()).unbind("mousemove.faraway" + a.editorUniqueId)
	})
};
NEEinlineEditorUtils.prototype.removeFarAwayMode = function() {
	$($.dmx.preview.wnd()).unbind("mousemove.faraway" + this.editorUniqueId)
};
NEEinlineEditorUtils.prototype.initMoveAction = function(a, e) {
	var d = !1;
	null == e && (e = !0);
	var g = $.extend(!0, {},
	this.properties);
	$.extend(g, $.dmx.current.editable.inlineEditorProperties);
	$.dmfw.isUseNewSelection() ? !0 === g.isMovable && ($.dmfw.isEditorOpen() && !1 === g.useSeparateTextEditMode || (d = !0)) : !0 === g.isMovable && (d = !0);
	if (d) {
		var j = $(this.editable.element),
		d = this.editorTop;
		$.dmfw.isUseNewSelection() && (d = j, g.useCoverElement && (d = this.editorCover));
		e && d.addClass("dmMarkedAsDragged");
		d.unbind("mousedown.inline_editor_drag").bind("mousedown.inline_editor_drag",
		function(a) {
			if (1 == a.which) {
				a.preventDefault();
				a.stopPropagation();
				var d = j;
				$.dmx.current.element = $.dmfw.getPreviewElement("[duda_id\x3d" + $(d).attr("duda_id") + "]");
				d = d || $.dmx.current.element;
				$.hasDefaultMove(a.target) || _DragManager.requestMove(d, a)
			}
		})
	} else ! 0 === a && this.removeMoveAction()
};
NEEinlineEditorUtils.prototype.removeMoveAction = function() {
	var a = $(this.editable.element),
	e = this.editorTop;
	$.dmfw.isUseNewSelection() && (e = a);
	e.removeClass("dmLockedNew");
	e.removeClass("dmMarkedAsDragged");
	e.unbind("mousedown.inline_editor_drag")
};
NEEinlineEditorUtils.prototype.clone = function() {
	var a = new NEEinlineEditorUtils(this.editable);
	a.editorTop = this.editorTop.clone();
	a.editorLeft = this.editorLeft.clone();
	a.editorRight = this.editorRight.clone();
	a.editorBottom = this.editorBottom.clone();
	a.properties = this.properties;
	a.overlay = this.overlay.clone();
	a.editorBorderTop = this.editorBorderTop.clone();
	a.editorUniqueId = this.editorUniqueId;
	a.editable = this.editable;
	a.dbClicksAllowed = this.dbClicksAllowed;
	a.contextBoxFadeInDelay = this.contextBoxFadeInDelay;
	return a
};
NEEinlineEditorUtils.prototype.redraw = function(a) {
	this.draw(a, this.properties)
};
NEEinlineEditorUtils.prototype.draw = function(a, e) {
	if (this.editorTop) {
		var d = $.dmfw.isUseNewSelection() ? 150 : 250,
		g = 2;
		a = a || $(this.editable.element);
		var j = e && (e.top || 0 == e.top) ? e.top: 31;
		"navigation" == $.dmx.current.editable.type && !$.dmx.current.editable.forceElement && (0 < a.find("UL:visible").length && (a = a.find("UL:visible")), 0 < a.find("a.dmHome").length && (a = a.find("a.dmHome")));
		$.dmfw.isDudaone() && (g = 1);
		var k = $(a).outerWidth(),
		l = $(a).outerHeight();
		"navigation" == this.editable.type && 0 == l && (l = $(this.editable.element).outerHeight());
		k = parseInt(k, 10);
		k < d && (k = d);
		$.dmfw.isUseNewSelection() || this.editorTop.width(k);
		var m = Math.max($(a).offset().top - g, 0);
		if (!$.dmx.preview.wnd().$.DM.isBodyScrollable() && 0 < $.dmfw.getPreviewElement("#iscrollBody").has($(a)).length) var n = $.getScrollingPosition()[1],
		m = m - $.dmx.preview.wnd().jQuery.layoutDevice.getTopFixedElementsOffset() + parseInt(n);
		if ("fixed" == $(a).css("position") || "fixed" == $(a).parent().css("position")) null != $(a).css("top") && (m = parseInt($(a).css("top")) - g);
		var o = Math.max(m - j, 0),
		n = null,
		r = Math.max($(a).offset().left - g, 0),
		u = r,
		s = null;
		this.editorCover.width($(a).outerWidth());
		this.editorCover.height($(a).outerHeight());
		this.editorCover.offset({
			top: $(a).offset().top,
			left: $(a).offset().left
		});
		this.selectionOverlay.width($(a).outerWidth());
		this.selectionOverlay.height($(a).outerHeight());
		this.selectionOverlay.offset({
			top: 0 == m ? m: m + g,
			left: 0 == r ? r: r + g
		});
		null == this.editable || null == this.editable.drawBottomBar || this.editable.drawBottomBar && !this.editable.drawBottomBar() ? 0 < m - j || (n = m + l) : n = m + l;
		$(a).outerWidth() < d && (d = (d - $(a).outerWidth()) / 2, 0 <= u - d && (u -= d));
		u + k > $(NEFW.PREVIEW.get(0).contentWindow).width() && (u = $(NEFW.PREVIEW.get(0).contentWindow).width() - k, s = $(NEFW.PREVIEW.get(0).contentWindow).width() - $(a).offset().left - $(a).outerWidth(), 0 > s - k && (s = null));
		k = $($.dmx.preview.wnd());
		$.dmx.preview.wnd().$.DM.isBodyScrollable() || 0 < $.dmfw.getPreviewElement("#iscrollBody").has($(a)).length && (k = $.dmfw.getPreviewElement("#site_content"));
		$.dmfw.isUseNewSelection() && (s = k.outerWidth() - (r + $(a).outerWidth()));
		k = $.dmfw.isUseNewSelection() && $.dmfw.isUseNewSelectionContext();
		n ? this.editorTop.css("top", n + "px") : this.editorTop.css("top", o + "px");
		null != s ? this.editorTop.css("right", s).css("left", "auto") : this.editorTop.css("left", u).css("right", "auto");
		k && this.properties.event && this.redrawEditorContextBox(this.properties);
		o = g;
		$.dmfw.isUseNewSelection() && (o = 2 * g);
		this.editorLeft.height(l + o);
		n ? (this.editorLeft.css("top", m), this.editorLeft.height(n - m + o)) : this.editorLeft.css("top", m);
		this.editorLeft.css("left", r);
		this.overlay && (this.overlay.height(l + "px"), this.overlay.css("top", m), this.overlay.css("left", r + 1), this.overlay.width(1 * $(a).outerWidth() + "px"));
		this.editorBorderTop && (this.editorBorderTop.height("0px"), this.editorBorderTop.css("top", m), this.editorBorderTop.css("left", r), $(a).outerWidth() < $($.dmx.preview.wnd()).width() ? this.editorBorderTop.width($(a).outerWidth() + g) : this.editorBorderTop.width($(a).outerWidth() - g));
		this.editorRight.height(l + o);
		n ? (this.editorRight.css("top", m), this.editorRight.height(n - m + o)) : this.editorRight.css("top", m);
		$(a).outerWidth() < $($.dmx.preview.wnd()).width() ? this.editorRight.css("left", r + $(a).outerWidth() + g + "px") : this.editorRight.css("left", r + $(a).outerWidth() - g + "px");
		$(a).outerWidth() < $($.dmx.preview.wnd()).width() ? this.editorBottom.width($(a).outerWidth() + g) : this.editorBottom.width($(a).outerWidth() - g);
		n ? $.dmfw.isUseNewSelection() ? this.editorBottom.css("top", n + g + "px") : this.editorBottom.css("top", m + "px") : this.editorBottom.css("top", m + l + g + "px");
		this.editorBottom.css("left", r + 1)
	}
};
NEEinlineEditorUtils.prototype.addLinkCapabilities = function(a, e) {
	if (a) {
		var d = {},
		g = $.extend(!0, {},
		this.properties, $.dmx.current.editable.inlineEditorProperties);
		e.allowEdit && ("paragraph" == $.dmx.current.editable.type && $(a.target).is("a")) && (this.controls.linkEditor.event = a, this.controls.linkEditor.element = this.addEditorButton(this.controls.linkEditor, $(a.target), d), this.controls.linkEditor.element.insertAfter(g.hasAlign ? this.editorTop.children().eq(1) : this.editorTop.children().eq(0)), this.controls.linkEditor.element.attr("class", this.controls.linkEditor.element.attr("class")));
		e.allowGoTo && (this.controls.goToLink.event = a, this.controls.goToLink.element = this.addEditorButton(this.controls.goToLink, $(this.editable.element), d), this.controls.goToLink.element.insertAfter(g.hasAlign ? this.editorTop.children().eq(1) : this.editorTop.children().eq(0)), this.controls.goToLink.element.attr("class", this.controls.goToLink.element.attr("class")), "paragraph" == $.dmx.current.editable.type && this.controls.edit.element.find("div").html(dmStr["ui.inline.editor.4"]))
	}
};
NEEinlineEditorUtils.prototype.removeLinkCapabilities = function() {
	this.controls.linkEditor.element && this.controls.linkEditor.element.remove();
	this.controls.goToLink.element && this.controls.goToLink.element.remove();
	this.controls.edit.element && this.controls.edit.element.find("div").html(this.controls.edit.title)
};
NEEinlineEditorUtils.prototype.redrawEditorContextBox = function(a) {
	var e = !0,
	d = $.dmx.preview.wnd(),
	g = 0,
	j = 0,
	k = 0,
	l = $(this.editable.element);
	if (a.event) {
		this.editorTop.css("left", "auto").css("right", "auto");
		j = this.editorTop.outerHeight() / -2;
		this.removeLinkCapabilities();
		var k = "navigation" == $.dmx.current.editable.type && $(a.event.target).is("a, .dmNav a *, .dmNavigationWithLink a *"),
		g = "table" == $.dmx.current.editable.type && $(a.event.target).is("a"),
		m = "socialhub" == $.dmx.current.editable.type && ($(a.event.target).is("a") || $(a.event.target).parent().is("a")),
		n = "paragraph" == $.dmx.current.editable.type && ($(a.event.target).is("a") || $(a.event.target).is("a *")) && !$.dmfw.isDudaone(),
		o = ("image" == $.dmx.current.editable.type || "imageSlider" == $.dmx.current.editable.type) && $(a.event.target).is("img") && $(a.event.target).is("a *"),
		r = "link" == $.dmx.current.editable.type,
		u = $(a.event.target).is(".dmHome, .dmHome *"),
		s = $(a.event.target).is(".dmRssA, .dmRssA *"),
		B = $(a.event.target).is(".dmLinkList\x3e.dmListItem\x3ea.itemContainer *, .dmPrettyList .listItem a[href] *"),
		z = ($(a.event.target).is("a") ? $(a.event.target) : $(a.event.target).closest("a")).attr("href"),
		v = !1;
		if (null != z && (z.startsWith("sms:") || z.startsWith("tel:") || z.startsWith("mailto:"))) v = !0;
		k = {
			allowGoTo: (n || k || o || r || u || s || B || g || m) && !v,
			allowEdit: n || k || o || r
		}; (k.allowEdit || k.allowGoTo) && this.addLinkCapabilities(a.event, k);
		$.dmx.preview.wnd().$.DM.isBodyScrollable() || (0 == $.dmfw.getPreviewElement("#iscrollBody").has($(l)).length ? e = !1 : d = $.dmfw.getPreviewElement("#iscrollBody"));
		j = a.offsetTop ? a.offsetTop: a.event.clientY + $.getScrollingPosition()[1] + j;
		k = a.offsetLeft ? a.offsetLeft: a.event.clientX + $.getScrollingPosition()[0] + 10;
		this.editorTop.outerWidth() + k > $($.dmx.preview.wnd()).width() && (k -= this.editorTop.outerWidth(), k -= 20);
		$.dmx.preview.wnd().$.DM.isBodyScrollable() || (j = e ? j - $.dmx.preview.wnd().jQuery.layoutDevice.getTopFixedElementsOffset() : j - $.getScrollingPosition()[1]);
		g = j + this.editorTop.outerHeight();
		$.dmx.preview.wnd().$.DM.isBodyScrollable() || 0 < $.dmfw.getPreviewElement("#iscrollBody").has($(l)).length && (g += $.dmx.preview.wnd().jQuery.layoutDevice.getTopFixedElementsOffset())
	}
	m = e ? $.getScrollingPosition()[1] : 0;
	$(d).height() + m < g && (j = $(d).height() + m - this.editorTop.outerHeight(), $.dmx.preview.wnd().$.DM.isBodyScrollable() || 0 < $.dmfw.getPreviewElement("#iscrollBody").has($(l)).length && (j -= $.dmx.preview.wnd().jQuery.layoutDevice.getTopFixedElementsOffset()));
	e ? $.getScrollingPosition()[1] > j && (j = $.getScrollingPosition()[1]) : 0 > j && (j = 0);
	a = this.editorTop.is(":visible") || !0 === a.show;
	this.editorTop.hide();
	this.editorTop.css("top", j);
	this.editorTop.css("left", k);
	a && this.editorTop.show();
	this.initFarAwayMode()
};
NEEinlineEditorUtils.prototype.setEditorControls = function(a) {
	function e() {
		if (!0 == a.isDelete && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = -100 : (o.imageSrc = "/editor/nee/images/inlineEditorDelete.png", o.imageSrcHover = "/editor/nee/images/inlineEditorDeleteOver.png"), this.controls.remove.element = this.addEditorButton(this.controls.remove, $(this.editable.element), o), this.editorTop.append(this.controls.remove.element), this.controls.remove.tooltip && !this.controls.remove.element.data("qtip"))) {
			var d = this.controls.remove.tooltip,
			e = this.controls.remove.element;
			$.dmfw.isPT() && $.ptToolTips.setToolTip(void 0, d, e, e, $.ptToolTips.getOptions("inlineEditor"), !1, !0)
		}
	}
	function d() { ! 0 == a.hasHide && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = -100 : (o.imageSrc = "/editor/nee/images/inlineEditorDelete.png", o.imageSrcHover = "/editor/nee/images/inlineEditorDeleteOver.png"), this.controls.hide.element = this.addEditorButton(this.controls.hide, $(this.editable.element), o), this.editorTop.append(this.controls.hide.element))
	}
	function g() {
		if (!0 == a.isEdit && (!$.dmfw.isDudaone() || !a.selectionOverlay.edit)) {
			var d = !1,
			e = $.extend({},
			o),
			g = $.extend({},
			o);
			$.dmfw.isUseNewSelection() ? (e.buttonImageLeftPosition = -50, !1 !== a.lockModeOpensEditor && !0 !== a.hoverDisplayEditor && (e.hidden = !0), !0 === a.useSeparateTextEditMode && !0 === a.allowTextEditing && (g.buttonImageLeftPosition = -125, this.controls.inlineEdit.element = this.addEditorButton(this.controls.inlineEdit, $(this.editable.element), g), this.editorTop.append(this.controls.inlineEdit.element), d = !0)) : (e.imageSrc = "/editor/nee/images/inlineEditorSettings.png", e.imageSrcHover = "/editor/nee/images/inlineEditorSettingsOver.png");
			this.controls.edit.element = this.addEditorButton(this.controls.edit, $(this.editable.element), e);
			d || this.editorTop.append(this.controls.edit.element)
		}
	}
	function j() { ! $.dmfw.isDudaone() && (!0 == a.isExpandable && !$($(this.editable.element)).parent().is(".dmBody")) && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = -25 : (o.imageSrc = "/editor/nee/images/inlineEditorIncrease.png", o.imageSrcHover = "/editor/nee/images/inlineEditorIncreaseOver.png"), this.controls.expand.element = this.addEditorButton(this.controls.expand, $(this.editable.element), o), this.editorTop.append(this.controls.expand.element))
	}
	function k() { ! 0 == a.isRemoveallExpandable && !$(this.editable.element).parent().is(".dmBody") && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = -25 : (o.imageSrc = "/editor/nee/images/inlineEditorIncrease.png", o.imageSrcHover = "/editor/nee/images/inlineEditorIncreaseOver.png"), this.controls.expand.element = this.addEditorButton(this.controls.removeAllExpand, $(this.editable.element), o), this.editorTop.append(this.controls.expand.element))
	}
	function l() { ! $.dmfw.isDudaone() && !0 == a.isCollapsable && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = 0 : (o.imageSrc = "/editor/nee/images/inlineEditorDecrease.png", o.imageSrcHover = "/editor/nee/images/inlineEditorDecreaseOver.png"), this.controls.collapse.element = this.addEditorButton(this.controls.collapse, $(this.editable.element), o), this.editorTop.append(this.controls.collapse.element))
	}
	function m() { ! 0 == a.isRemoveallCollapsable && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = 0 : (o.imageSrc = "/editor/nee/images/inlineEditorDecrease.png", o.imageSrcHover = "/editor/nee/images/inlineEditorDecreaseOver.png"), this.controls.collapse.element = this.addEditorButton(this.controls.removeAllCollapse, $(this.editable.element), o), this.editorTop.append(this.controls.collapse.element))
	}
	function n() { ! 0 == a.isUnderTable && ($.dmfw.isUseNewSelection() ? o.buttonImageLeftPosition = -75 : (o.imageSrc = "/editor/nee/images/tableBtn.png", o.imageSrcHover = "/editor/nee/images/tableBtnGray.png"), this.controls.table.element = this.addEditorButton(this.controls.table, $(this.editable.element), o), this.editorTop.append(this.controls.table.element))
	}
	var o = {
		newSelectionBoxImg: "/editor/nee/images/selection/inlineEditorSelectionBoxes.png",
		newSelectionButtonsImg: "/editor/nee/images/selection/inlineEditorSelectionButtons.png"
	};
	if ($.dmfw.isUseNewSelectionContext()) {
		$.dmfw.isDudaone() && (a.hasAlign && (this.controls.align.element = this.addEditorAlignButtons(this.controls.align)), a.isImportable && (o.buttonImageLeftPosition = -100, this.controls.importContent.element = this.addEditorButton(this.controls.importContent, $(this.editable.element), o), this.editorTop.append(this.controls.importContent.element)));
		g.call(this);
		a.editParentSelector && (this.controls.editParent.title = a.editParentTitle, this.controls.editParent.element = this.addEditorButton(this.controls.editParent, $(this.editable.element), o), this.editorTop.append(this.controls.editParent.element));
		n.call(this);
		a.isCopy && dm_enable_copy && (o.buttonImageLeftPosition = -100, this.controls.copy.element = this.addEditorButton(this.controls.copy, $(this.editable.element), o), this.editorTop.append(this.controls.copy.element));
		a.isPaste && ("undefined" != typeof dm_show_paste && dm_show_paste) && (o.buttonImageLeftPosition = -100, this.controls.paste.element = this.addEditorButton(this.controls.paste, $(this.editable.element), o), this.editorTop.append(this.controls.paste.element));
		j.call(this);
		k.call(this);
		l.call(this);
		m.call(this);
		if (!0 == a.isHideOnDevice && $.dmfw.isDudaone()) {
			var r, u, s = this;
			o.buttonImageLeftPosition = -100;
			r = $("\x3cdiv\x3eHide On Device\x3c/div\x3e");
			r.append($("\x3cdiv\x3e\x3c/div\x3e").addClass("dm-icon-chevron-right arrow"));
			this.editorTop.append(r);
			r.addClass("DMInlineEditorElement DMInlineEditorHideOnDeviceGeneralBtn");
			var B = $("\x3cdiv\x3e\x3c/div\x3e");
			r.append(B);
			B.addClass("DMInlineEditorHideOnDeviceContainer DMInlineEditorNotEditableElement");
			r.off("mouseover.checksize").on("mouseover.checksize",
			function() {
				s.editorTop.offset().left + s.editorTop.outerWidth() + B.outerWidth() > $($.dmx.preview.wnd()).width() ? B.addClass("leftSide") : B.removeClass("leftSide")
			});
			this.controls.hideOnDevice.element = r;
			var z = this.controls.hideOnDevice.title;
			this.controls.hideOnDevice.clickparams = {
				device: "desktop"
			};
			this.controls.hideOnDevice.title = z.replace("{device}", "desktop");
			this.controls.hideOnDevice.element = this.addEditorButton(this.controls.hideOnDevice, $(this.editable.element), o);
			r = $("\x3cdiv\x3e\x3c/div\x3e").addClass("dm-icon-pc icon");
			this.controls.hideOnDevice.element.prepend(r);
			u = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.DESKTOP;
			$(this.editable.element).hasClass(u) && (this.controls.hideOnDevice.element.addClass("DMInlineEditorDisabled"), r.addClass("dm-icon-hide-pc").removeClass("dm-icon-pc"));
			B.append(this.controls.hideOnDevice.element);
			this.controls.hideOnDevice.clickparams = {
				device: "tablet"
			};
			this.controls.hideOnDevice.title = z.replace("{device}", "tablet");
			this.controls.hideOnDevice.element = this.addEditorButton(this.controls.hideOnDevice, $(this.editable.element), o);
			r = $("\x3cdiv\x3e\x3c/div\x3e").addClass("dm-icon-tablet icon");
			this.controls.hideOnDevice.element.prepend(r);
			u = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.TABLET;
			$(this.editable.element).hasClass(u) && (this.controls.hideOnDevice.element.addClass("DMInlineEditorDisabled"), r.addClass("dm-icon-hide-tablet").removeClass("dm-icon-tablet"));
			B.append(this.controls.hideOnDevice.element);
			this.controls.hideOnDevice.clickparams = {
				device: "mobile"
			};
			this.controls.hideOnDevice.title = z.replace("{device}", "mobile");
			this.controls.hideOnDevice.element = this.addEditorButton(this.controls.hideOnDevice, $(this.editable.element), o);
			r = $("\x3cdiv\x3e\x3c/div\x3e").addClass("dm-icon-phone2 icon");
			this.controls.hideOnDevice.element.prepend(r);
			u = $.onefw.CONSTANTS.HIDE_ELEMENT_CSS_CLASS.MOBILE;
			$(this.editable.element).hasClass(u) && (this.controls.hideOnDevice.element.addClass("DMInlineEditorDisabled"), r.addClass("dm-icon-hide-phone").removeClass("dm-icon-phone2"));
			B.append(this.controls.hideOnDevice.element);
			this.controls.hideOnDevice.title = z
		}
		e.call(this);
		d.call(this);
		if (!0 === a.useCoverElement) {
			var v = this;
			this.editorCover.unbind("click.coverclick").bind("click.coverclick",
			function(a) {
				v.redrawEditorContextBox({
					event: a,
					show: !0
				})
			})
		}
	} else d.call(this),
	e.call(this),
	g.call(this),
	j.call(this),
	k.call(this),
	l.call(this),
	m.call(this),
	n.call(this)
};
NEEinlineEditorUtils.prototype.removeEditor = function() {
	null != this.editorTop && (this.editorTop.remove(), this.editorTop = null);
	null != this.editorCover && (this.editorCover.remove(), this.editorCover = null);
	null != this.selectionOverlay && (this.selectionOverlay.remove(), this.selectionOverlay = null);
	null != this.editorBorderTop && (this.editorBorderTop.remove(), this.editorBorderTop = null);
	null != this.editorLeft && (this.editorLeft.remove(), this.editorLeft = null);
	null != this.editorRight && (this.editorRight.remove(), this.editorRight = null);
	null != this.editorBottom && (this.editorBottom.remove(), this.editorBottom = null);
	null != this.overlay && (this.overlay.remove(), this.overlay = null);
	$.dmfw.isUseNewSelection() && $.dmfw.isUseNewSelectionContext() && this.removeFarAwayMode()
};
NEEinlineEditorUtils.prototype.addTitle = function() {
	if ($.dmfw.isUseNewSelection()) {
		if ($.dmfw.isUseNewSelectionContext()) {
			var a;
			a = this.properties.dynamicTitle ? this.properties.dynamicTitle: $("\x3cdiv\x3e" + this.properties.title + "\x3c/div\x3e");
			a.css("font-size", "11px");
			a.css("text-align", "center");
			a.css("color", "#ffffff");
			$.dmfw.isDudaone() ? a.css("background", "#296598") : "OPENTABLE" == $.dmx.site.dmProductType ? a.css("background", "#9E0B0F") : "YAHOO" == $.dmx.site.dmProductType ? a.css("background", "#6A30A3") : a.css("background", "#f38630");
			a.css("height", "26px");
			a.css("line-height", "26px");
			a.css("padding", "0px 5px");
			a.css("text-transform", "uppercase");
			return a
		}
		return $("\x3cdiv\x3e\x3c/div\x3e")
	}
	a = $("\x3cdiv\x3e\x3c/div\x3e");
	a.css("background", "url(/editor/nee/images/inlineEditorDragDotsIndicator.png)");
	a.css("background-repeat", "no-repeat");
	a.css("width", "9px");
	a.css("height", "17px");
	a.css("display", "inline-block");
	a.css("padding-right", "4px");
	a.css("position", "relative");
	a.css("top", "3px");
	a.addClass(INLINE_EDITOR_ELEMET);
	var e = null,
	e = this.properties.dynamicTitle ? this.properties.dynamicTitle: $("\x3cdiv\x3e" + this.properties.title + "\x3c/div\x3e");
	e.css("float", "left");
	e.css("color", "#FFFFFF");
	e.css("height", "31px");
	e.css("line-height", "31px");
	e.css("padding-left", "4px");
	e.css("font-family", "Arial");
	e.css("font-size", "15px");
	e.css("font-weight", "normal");
	e.addClass(INLINE_EDITOR_ELEMET);
	a.prependTo(e);
	return e
};
NEEinlineEditorUtils.prototype.addEditorAlignButtons = function(a) {
	var e = $("\x3cdiv\x3e\x3c/div\x3e");
	this.editorTop.append(e);
	e.addClass("DMInlineEditorAlignBtnsWrapOuter DMInlineEditorElement");
	var d = $("\x3cdiv\x3e\x3c/div\x3e");
	e.append(d);
	d.addClass("DMInlineEditorAlignBtnsWrap");
	e = $("\x3cdiv\x3e\x3c/div\x3e");
	d.append(e);
	e.addClass("DMInlineEditorAlignBtn DMInlineEditorAlignBtnLeft dm-icon-align-left").attr("id", "dmInlineEditorAlignLeft");
	var g = this;
	e.off("click.align").on("click.align",
	function() {
		g.editorTop.find(".DMInlineEditorAlignBtnSelected").removeClass("DMInlineEditorAlignBtnSelected");
		$(this).addClass("DMInlineEditorAlignBtnSelected");
		a.handler($.dmx.current.element, "left")
	});
	e = $("\x3cdiv\x3e\x3c/div\x3e");
	d.append(e);
	e.addClass("DMInlineEditorAlignBtn DMInlineEditorAlignBtnCenter dm-icon-align-center").attr("id", "dmInlineEditorAlignCenter");
	e.off("click.align").on("click.align",
	function() {
		g.editorTop.find(".DMInlineEditorAlignBtnSelected").removeClass("DMInlineEditorAlignBtnSelected");
		$(this).addClass("DMInlineEditorAlignBtnSelected");
		a.handler($.dmx.current.element, "center")
	});
	e = $("\x3cdiv\x3e\x3c/div\x3e");
	d.append(e);
	e.addClass("DMInlineEditorAlignBtn DMInlineEditorAlignBtnRight dm-icon-align-right").attr("id", "dmInlineEditorAlignRight");
	e.off("click.align").on("click.align",
	function() {
		g.editorTop.find(".DMInlineEditorAlignBtnSelected").removeClass("DMInlineEditorAlignBtnSelected");
		$(this).addClass("DMInlineEditorAlignBtnSelected");
		a.handler($.dmx.current.element, "right")
	});
	d = "left";
	"paragraph" !== $.dmx.current.element.editable().type ? (d = $.dmx.current.element.css("float"), "none" == d && !$.dmx.current.element.isAutoMargin() && (d = null), "none" == d && (d = "center")) : d = $.dmx.current.element.css("text-align");
	"left" == d ? this.editorTop.find("#dmInlineEditorAlignLeft").addClass("DMInlineEditorAlignBtnSelected") : "center" == d ? this.editorTop.find("#dmInlineEditorAlignCenter").addClass("DMInlineEditorAlignBtnSelected") : "right" == d && this.editorTop.find("#dmInlineEditorAlignRight").addClass("DMInlineEditorAlignBtnSelected")
};
NEEinlineEditorUtils.prototype.addEditorButton = function(a, e, d) {
	var g = a.title,
	j = a.buttonClassName,
	k = null;
	if ($.dmfw.isUseNewSelection()) $.dmfw.isUseNewSelectionContext() ? (k = $("\x3cdiv\x3e\x3c/div\x3e"), k.css("height", "25px"), k.css("line-height", "25px"), k.css("text-align", "left"), k.css("cursor", "pointer"), k.css("border-top", "1px solid #dadada"), k.css("color", "#666666"), k.addClass(INLINE_EDITOR_ELEMET), k.addClass(j), !0 === d.hidden && k.hide(), g = $("\x3cdiv\x3e\x3c/div\x3e").html(g), g.css("height", "25px"), g.css("line-height", "25px"), g.css("text-transform", "capitalize"), g.css("font-size", "12px"), g.css("padding", "0px 5px"), k.append(g), $.dmfw.isDudaone() && (k.css("height", ""), k.css("line-height", ""), g.css("padding", ""), k.css("border-top", ""), k.css("color", ""), g.css("height", ""), g.css("line-height", ""), g.css("font-size", ""), g.css("padding", "")), k.unbind("mouseover").bind("mouseover",
	function() {
		var a = k.data("forceBackground");
		null == a && (a = !1);
		a || ($.dmfw.isDudaone() ? (k.css("color", "#FFF"), k.css("background-color", "#2d6598")) : "OPENTABLE" == $.dmx.site.dmProductType ? k.css("color", "#9E0B0F") : "YAHOO" == $.dmx.site.dmProductType ? k.css("color", "#6A30A3") : k.css("color", "#db7422"))
	}), k.unbind("mouseout").bind("mouseout",
	function() {
		var a = k.data("forceBackground");
		null == a && (a = !1);
		a || ($.dmfw.isDudaone() ? (k.css("color", ""), k.css("background-color", "")) : k.css("color", "#333333"))
	})) : (k = $("\x3cdiv\x3e\x3c/div\x3e"), k.attr("title", g), k.css("float", "right"), k.css("height", "25px"), k.css("width", "25px"), k.css("text-align", "center"), k.css("margin", "3px 0px 0px 0px"), k.css("cursor", "pointer"), k.css("background", "url(" + d.newSelectionBoxImg + ")"), k.css("background-repeat", "no-repeat"), k.addClass(INLINE_EDITOR_ELEMET), k.addClass(j), !0 === d.hidden && k.hide(), g = $("\x3cdiv\x3e\x3c/div\x3e"), g.css("height", "25px"), g.css("width", "25px"), g.css("background", "url(" + d.newSelectionButtonsImg + ")"), g.css("background-repeat", "no-repeat"), g.css("background-position", d.buttonImageLeftPosition + "px 0px"), k.append(g), k.unbind("mouseover").bind("mouseover",
	function() {
		var a = k.data("forceBackground");
		null == a && (a = !1);
		a || k.css("background-position", "-25px 0px")
	}), k.unbind("mouseout").bind("mouseout",
	function() {
		var a = k.data("forceBackground");
		null == a && (a = !1);
		a || k.css("background-position", "0px 0px")
	}));
	else {
		var l = d.imageSrc,
		m = d.imageSrcHover,
		k = $("\x3cdiv\x3e\x3c/div\x3e");
		k.attr("title", g);
		k.css("float", "right");
		k.css("height", "19px");
		k.css("width", "20px");
		k.css("text-align", "center");
		k.css("margin", "4px 4px");
		k.css("cursor", "pointer");
		k.css("background", "url(" + l + ")");
		k.css("background-repeat", "no-repeat");
		k.addClass(INLINE_EDITOR_ELEMET);
		k.addClass(j);
		k.unbind("mouseover").bind("mouseover",
		function() {
			k.css("background", "url(" + m + ")");
			k.css("background-repeat", "no-repeat")
		});
		k.unbind("mouseout").bind("mouseout",
		function() {
			k.css("background", "url(" + l + ")");
			k.css("background-repeat", "no-repeat")
		})
	}
	var n = a.clickparams;
	k.unbind("click").click(function(d) {
		1 == d.which && (a.handler(e, $(d.target), d, n), d.preventDefault(), d.stopPropagation())
	});
	k.unbind("mousedown").bind("mousedown",
	function(a) {
		1 == a.which && (a.preventDefault(), a.stopPropagation())
	});
	return k
};
var _inlineCfg = {}; (function(a) {
	a.fn.selectElement = function(e, d) {
		e = e || {};
		var g = a(this);
		null != g.data("alterSelection") && (g = g.data("alterSelection"));
		var j = null,
		k = Number.MAX_VALUE,
		l;
		for (l in _inlineCfg.editables) _inlineCfg.editables[l].isMember(g) && _inlineCfg.editables[l].priority < k && (j = l, k = _inlineCfg.editables[l].priority);
		if (null != j) {
			if (d || a.isLegalSelection(a(_inlineCfg.editables[j].getCorrectElement(g)), e)) {
				a.dmfw.getPreviewElement(".dmTempCoverImage").remove();
				if (a(_inlineCfg.editables[j].getCorrectElement(g)).hasClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS)) e.forceReinitInlineEditor && (e.event && (_inlineCfg.editables[j].inlineEditor.editorUtils.properties.event = e.event), !1 === _inlineCfg.editables[j].inlineEditor.editorUtils.properties.useSelectionOverlay && _inlineCfg.editables[j].inlineEditor.redraw(a.dmx.current.element));
				else if (0 == a.dmfw.getPreviewElement(".dmLocked").length || !0 === e.forceSelect || a.dmfw.isDudaone() && !a.dmfw.isEditorOpen()) {
					null == e.isCollapsable && (a.dmx.preview.wnd()._runtimeProperties.lastSelectedElements = []);
					a.deselectAllEditableElements();
					_inlineCfg.editables[j].setCorrectElement(g);
					a.dmfw.setCurrent(_inlineCfg.editables[j], a(_inlineCfg.editables[j].element));
					a(_inlineCfg.editables[j].element).is(".dmContent", ".dmHeader", ".dmFooter") && (e.isExpandable = !1, e.isDelete = !1);
					_inlineCfg.editables[j].editInline(_inlineCfg.editables[j], e);
					_inlineCfg.editables[j].selectInline();
					a(_inlineCfg.editables[j].element).addClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS);
					var m = a.dmfw.getPreviewElement("body, ." + INLINE_EDITOR_CLASS + ", ." + INLINE_EDITOR_CLASS_LEFT + ", ." + INLINE_EDITOR_CLASS_RIGHT + ", ." + INLINE_EDITOR_CLASS_BOTTOM + ", ." + INLINE_EDITOR_CLASS_TOP);
					a.dmfw.isUseNewSelection() && (m = a.dmfw.getPreviewElement("body, ." + INLINE_EDITOR_CLASS_NEW + ", ." + INLINE_EDITOR_CLASS_LEFT_NEW + ", ." + INLINE_EDITOR_CLASS_RIGHT_NEW + ", ." + INLINE_EDITOR_CLASS_BOTTOM_NEW + ", ." + INLINE_EDITOR_CLASS_TOP_NEW));
					a.dmfw.isDudaone() && (m = m.add(a(_inlineCfg.editables[j].element)));
					m.unbind("mouseleave.select").bind("mouseleave.select",
					function(d) { ! a(d.relatedTarget).is(INLINE_EDITOR_SELECTOR) && (!a(d.relatedTarget).is(INLINE_EDITOR_SELECTOR + " *") && !a(d.relatedTarget).is(RTE_INLINE_EDITOR_SELECTOR)) && (0 == a.dmfw.getPreviewElement(".dmNowInlineEditing, .dmLocked, .dmMultiLocked").length && !a(d.relatedTarget).is("." + INLINE_EDITOR_ELEMET + " * , ." + INLINE_EDITOR_ELEMET) && !a(d.relatedTarget).hasClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET) && !a(d.relatedTarget).is("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS + ", ." + INLINE_EDITOR_EDITED_ELEMENT_CLASS + " *")) && (a.deselectAllEditableElements(), m.unbind("mouseleave.select"))
					})
				} else if (!0 === _inlineCfg.editables[j].inlineEditorProperties.useCoverElement) {
					k = "body";
					a.dmx.preview.wnd().$.DM.isBodyScrollable() || 0 < a.dmfw.getPreviewElement("#iscrollBody").has(a(this.editable.element)).length && (k = "#iscrollBody");
					var n = _inlineCfg.editables[j].getCorrectElement(g),
					g = a("\x3cdiv\x3e\x3c/div\x3e").appendTo(a.dmfw.getPreviewElement(k));
					g.addClass(INLINE_EDITOR_NOT_EDITABLE_ELEMET).addClass(INLINE_EDITOR_SELECTION_ELEMET).addClass(INLINE_SELECTION_TEMP_COVER_ELEMENT);
					g.width(a(n).outerWidth());
					g.height(a(n).outerHeight());
					g.offset(n.offset());
					g.off("click.cvr").on("click.cvr",
					function() {
						a.deselectAllEditableElements();
						n.selectElement();
						n.lockElement()
					})
				}
				return a(_inlineCfg.editables[j].element)
			}
		} else return null
	};
	a.fn.isSelected = function() {
		return a(this).hasClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS)
	};
	a.fn.selectElementText = function() {
		var e = a(this).get(0),
		d = NEFW.PREVIEW.get(0).contentWindow,
		g = NEFW.PREVIEW.contents().get(0);
		g.selection ? g.selection.empty() : d.getSelection && d.getSelection().removeAllRanges();
		g.selection ? (g = g.body.createTextRange(), g.moveToElementText(e), g.select()) : d.getSelection && (g = g.createRange(), g.selectNode(e), d.getSelection().addRange(g))
	};
	a.fn.lockElement = function(e) {
		e = e || {};
		var d = e.lockClassName || "dmLocked",
		g = "",
		j = "";
		a.dmfw.isUseNewSelection() && (g = INLINE_EDITOR_CLASS_NEW_LOCKED, j = INLINE_EDITOR_CLASS_NEW_SELECTED);
		var k = a(this),
		l = e.inlineEditor || a.dmx.current.editable.inlineEditor;
		k.hasClass(d) || (k.addClass(d), null != l.editorUtils.editorBottom && (l.editorUtils.editorBottom.stop(!0, !0), l.editorUtils.editorBottom.css("opacity", "1").addClass(g).removeClass(j)), null != l.editorUtils.editorLeft && (l.editorUtils.editorLeft.stop(!0, !0), l.editorUtils.editorLeft.css("opacity", "1").addClass(g).removeClass(j)), null != l.editorUtils.editorRight && (l.editorUtils.editorRight.stop(!0, !0), l.editorUtils.editorRight.css("opacity", "1").addClass(g).removeClass(j)), null != l.editorUtils.editorTop && (l.editorUtils.editorTop.stop(!0, !0), l.editorUtils.editorTop.css("opacity", "1"), a.dmfw.isUseNewSelection() && !0 !== e.hideTopBar && l.editorUtils.editorTop.fadeIn(l.editorUtils.contextBoxFadeInDelay)), null != l.editorUtils.editorBorderTop && (l.editorUtils.editorBorderTop.stop(!0, !0), l.editorUtils.editorBorderTop.css("opacity", "1").addClass(g).removeClass(j)), null != l.editorUtils.overlay && (l.editorUtils.overlay.show(), l.editorUtils.overlay.stop(!0, !0)))
	};
	a.fn.multiLockElement = function(e) {
		e = e || {};
		var d = a(this),
		g = e.inlineEditor || a.dmx.current.editable.inlineEditor;
		d.addClass("dmMultiLocked");
		null != g.editorUtils.editorBottom && (g.editorUtils.editorBottom.stop(!0, !0), g.editorUtils.editorBottom.css("opacity", "1"));
		null != g.editorUtils.editorLeft && (g.editorUtils.editorLeft.stop(!0, !0), g.editorUtils.editorLeft.css("opacity", "1"));
		null != g.editorUtils.editorRight && (g.editorUtils.editorRight.stop(!0, !0), g.editorUtils.editorRight.css("opacity", "1"));
		null != g.editorUtils.editorTop && (g.editorUtils.editorTop.stop(!0, !0), g.editorUtils.editorTop.css("opacity", "1"));
		null != g.editorUtils.overlay && (g.editorUtils.overlay.show(), g.editorUtils.overlay.stop(!0, !0));
		null != g.editorUtils.editorBorderTop && (g.editorUtils.editorBorderTop.stop(!0, !0), g.editorUtils.editorBorderTop.css("opacity", "1"));
		g.editorUtils.overlay.bind("mouseleave",
		function() {
			g.editorUtils.showBar(!1);
			g.editorUtils.overlay.unbind("mouseleave")
		});
		d.find(".dmMultiLocked").each(function(d, e) {
			e = a(e);
			e.removeClass("dmMultiLocked");
			for (var g = [], m = 0; m < a.dmx.selectedElements.length; m++) {
				var n = a.dmx.selectedElements[m];
				0 < n.element.find(e).size() || e.is(n.element) ? n.inlineEditor.remove() : g.push(a.dmx.selectedElements[m])
			}
			a.dmx.selectedElements = g
		})
	};
	a.fn.getTopBlockElement = function() {
		for (var e = a(this), d = e.css("display"), g = !1; ("inline" == d || "none" == d || "list-item" == d || e.is("*:only-child, a") || 0 == e.siblings().filter(function() {
			return ! a(this).hasClass("inlineEditorDraggingPlaceHolder")
		}).length) && !g && !e.attr("dmle_design_option");) a.isLegalSelection(e) ? e.isDedicatedContentElement() ? g = !0 : e.parent().is(".dmRespCol") ? g = !0 : (e = e.parent(), d = e.css("display")) : g = !0;
		return e
	};
	a.fn.isDedicatedContentElement = function() {
		return a(this).is("figure, section")
	};
	a.fn.expandSelection = function() {
		var e = a(this).parent();
		NEFW.PREVIEW.get(0);
		return e.getTopBlockElement()
	};
	a.fn.getContainingTable = function() {
		return a(this).parent().closest("[dmle_table\x3d'table'], [dmle_design_option^\x3d'table'],table")
	};
	a.fn.collapseSelectionElement = function() {
		var e = NEFW.PREVIEW.get(0).contentWindow;
		if (0 < e._runtimeProperties.lastSelectedElements.length) {
			var d = e._runtimeProperties.lastSelectedElements[e._runtimeProperties.lastSelectedElements.length - 1];
			e._runtimeProperties.lastSelectedElements.splice(e._runtimeProperties.lastSelectedElements.length - 1, 1);
			return d
		}
		return a([])
	};
	a.fn.outerHTML = function() {
		if (a(this).attr("outerHTML")) return a(this).attr("outerHTML");
		var e = a(this).wrap("\x3cdiv\x3e\x3c/div\x3e").parent().html();
		a(this).unwrap();
		return e
	};
	a.fn.getTextNodes = function(e) {
		function d(a) {
			if (3 == a.nodeType)(e || !k.test(a.nodeValue)) && j.push(a);
			else for (var g = 0,
			n = a.childNodes.length; g < n; ++g) d(a.childNodes[g])
		}
		var g = a(this).get(0),
		j = [],
		k = /^\s*$/;
		d(g);
		return j
	};
	a.fn.editable = function() {
		var e = Number.MAX_VALUE,
		d = this,
		g = null;
		a.each(a.dmfw.editables(),
		function(a, k) {
			k.isMember(d) && k.priority < e && (g = k, e = k.priority)
		});
		return g
	};
	a.fn.editables = function(e) {
		var d = [],
		g = this;
		a.each(a.dmfw.editables(),
		function(a, k) {
			k.isMember(g, e) && d.push(k)
		});
		return d
	};
	a.fn.isHeaderElement = function() {
		return a(this).is(".dmHeader, .dmHeader *")
	};
	a.fn.isFooterElement = function() {
		return a(this).is(".dmFooter, .dmFooter *")
	};
	a.fn.isBodyElement = function() {
		return a(this).is(".dmBody, .dmBody *")
	};
	a.fn.isFreeHeaderElement = function() {
		return a.dmfw.isUseLayout() ? a(this).is(".freeHeader, .freeHeader *") : a(this).isHeaderElement()
	};
	a.fn.isFixedHeaderElement = function() {
		return a(this).is(".fixedHeader, .fixedHeader *")
	};
	a.fn.isFreeFooterElement = function() {
		return a(this).isFooterElement()
	};
	a.fn.isFixedFooterElement = function() {
		return a(this).is(".fixedFooter, .fixedFooter *")
	}
})(jQuery);
$.extend({
	getFreeHeaderElement: function() {
		return $.dmx.preview.wnd().jQuery.DM.isUseLayout() ? $.dmfw.getPreviewElement(".freeHeader") : $.dmfw.getPreviewElement(".dmHeader")
	},
	getFixedHeaderElement: function() {
		return $.dmfw.getPreviewElement(".fixedHeader")
	},
	getFreeFooterElement: function() {
		return $.dmfw.getPreviewElement(".dmFooter")
	},
	getFixedFooterElement: function() {
		return $.dmfw.getPreviewElement(".fixedFooter")
	},
	getContentBodyElement: function() {
		$.dmx.preview.wnd().jQuery.DM.isUseIscroll();
		return $.dmfw.getPreviewElement("#dmFirstContainer")
	},
	_dmInlineInit: function(a) {
		_inlineCfg.editables = a
	},
	selectElement: function(a) {
		$(a).selectElement()
	},
	deselectEditable: function(a) {
		$(a.element).removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS).removeClass("dmNowInlineEditing").removeClass("dmLocked").removeClass("dmLockedNew").removeClass("dmMarkedAsDragged");
		a.deselectInline && a.deselectInline();
		null != a.inlineEditor && a.inlineEditor.remove();
		0 < $(a.element).length && ($(a.element).unbind("mouseleave").unbind("mouseleave.select").unbind("mouseleave.hovered"), a.element = null)
	},
	deselectAllEditableElements: function() {
		try {
			$.dmfw.getPreviewElement(".dmNowInlineEditing , .dmLocked, .dmLockedNew, .dmMarkedAsDragged").removeClass("dmNowInlineEditing").removeClass("dmLocked").removeClass("dmLockedNew").removeClass("dmMarkedAsDragged");
			$.dmfw.getPreviewElement(".inlineEditorEditedElement, .inlineEditorClickToCallSelected , .inlineEditorClickToMapSelected , .inlineEditorClickToSmsSelected , .inlineEditorColumnsSelected , .inlineEditorFooterSelected , .inlineEditorHeaderSelected , .inlineEditorHtmlSelected , .inlineEditorImageSelected , .inlineEditorLinkSelected , .inlineEditorNavigationSelected , .inlineEditorParagraphSelected , .inlineEditorShareSelected , .inlineEditorvideoSelected , .inlineEditoryoutubeSelected, [contenteditable], .inlineEditorHoursOfOperationSelected", ".inlineEditorSocailHubSelected").removeClass("inlineEditorClickToCallSelected").removeClass("inlineEditorClickToMapSelected").removeClass("inlineEditorClickToSmsSelected").removeClass("inlineEditorColumnsSelected").removeClass("inlineEditorFooterSelected").removeClass("inlineEditorHeaderSelected").removeClass("inlineEditorHtmlSelected").removeClass("inlineEditorImageSelected").removeClass("inlineEditorLinkSelected").removeClass("inlineEditorNavigationSelected").removeClass("inlineEditorParagraphSelected").removeClass("inlineEditorShareSelected").removeClass("inlineEditorvideoSelected").removeClass("inlineEditoryoutubeSelected").removeClass("inlineEditorHoursOfOperationSelected").removeClass("inlineEditorSocailHubSelected").removeAttr("contenteditable").removeClass("inlineEditorEditedElement");
			$($.dmx.preview.wnd()).unbind("mouseup.fastclick");
			for (var a in _inlineCfg.editables) null != _inlineCfg.editables[a].element && $(_inlineCfg.editables[a].element).removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS),
			_inlineCfg.editables[a].deselectInline && _inlineCfg.editables[a].deselectInline(),
			null != _inlineCfg.editables[a].inlineEditor && (_inlineCfg.editables[a].inlineEditor.editorUtils.removeMoveAction(), _inlineCfg.editables[a].inlineEditor.editorUtils.removeDBclickEdit(), _inlineCfg.editables[a].inlineEditor.remove(), _inlineCfg.editables[a].inlineEditor = null),
			0 < $(_inlineCfg.editables[a].element).length && ($(_inlineCfg.editables[a].element).unbind("mouseleave").unbind("mouseleave.select").unbind("mouseleave.hovered"), _inlineCfg.editables[a].element = null);
			$.removeRichTextEditor();
			$.dmfw.setCurrent(null, null)
		} catch(e) {
			$.log("Error on deselect all editables:"),
			e.message && $.log(e.message)
		}
	},
	deselectHoveredElements: function() {
		$.dmfw.getPreviewElement(".dmNowInlineEditing:not('dmMultiLocked') , .dmLocked:not('dmMultiLocked')").removeClass("dmNowInlineEditing").removeClass("dmLocked");
		$.dmfw.getPreviewElement(".inlineEditorEditedElement, .inlineEditorClickToCallSelected , .inlineEditorClickToMapSelected , .inlineEditorClickToSmsSelected , .inlineEditorColumnsSelected , .inlineEditorFooterSelected , .inlineEditorHeaderSelected , .inlineEditorHtmlSelected , .inlineEditorImageSelected , .inlineEditorLinkSelected , .inlineEditorNavigationSelected , .inlineEditorParagraphSelected , .inlineEditorShareSelected , .inlineEditorvideoSelected , .inlineEditoryoutubeSelected, [contenteditable], .inlineEditorHoursOfOperationSelected, .inlineEditorSocailHubSelected").removeClass("inlineEditorClickToCallSelected").removeClass("inlineEditorClickToMapSelected").removeClass("inlineEditorClickToSmsSelected").removeClass("inlineEditorColumnsSelected").removeClass("inlineEditorFooterSelected").removeClass("inlineEditorHeaderSelected").removeClass("inlineEditorHtmlSelected").removeClass("inlineEditorImageSelected").removeClass("inlineEditorLinkSelected").removeClass("inlineEditorNavigationSelected").removeClass("inlineEditorParagraphSelected").removeClass("inlineEditorShareSelected").removeClass("inlineEditorvideoSelected").removeClass("inlineEditoryoutubeSelected").removeClass("inlineEditorHoursOfOperationSelected").removeClass("inlineEditorSocailHubSelected").removeAttr("contenteditable").removeClass("inlineEditorEditedElement");
		for (var a in _inlineCfg.editables) $(_inlineCfg.editables[a].element).removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS),
		_inlineCfg.editables[a].deselectInline && _inlineCfg.editables[a].deselectInline(),
		null != _inlineCfg.editables[a].inlineEditor && _inlineCfg.editables[a].inlineEditor.remove(),
		0 < $(_inlineCfg.editables[a].element).length && ($(_inlineCfg.editables[a].element).unbind("mouseleave").unbind("mouseleave.select").unbind("mouseleave.hovered"), _inlineCfg.editables[a].element = null)
	},
	replaceContent: function(a, e) {
		NEFW.PREVIEW.contents().get(0);
		var d = NEFW.PREVIEW.get(0).contentWindow,
		g = "",
		j = null,
		k = null;
		if (d.getSelection) if (d = d.getSelection(), d.rangeCount) {
			if (j = d.focusNode, null == j && (j = d.focusNode.parentElement), 3 == j.nodeType) {
				for (var k = d.getRangeAt(0).startOffset, d = d.getRangeAt(0).endOffset, l = j.textContent, m = !0, n = 0; n < j.parentElement.childNodes.length; n++) {
					var o = $(j.parentElement.childNodes[n]).outerHTML();
					o != l ? g += o: "inlineEditor" == $(j.parentElement).attr("generator") && $(j.parentElement).html() == $(a).html() ? (m = !1, $(j.parentElement).attr("style", $(j.parentElement).attr("style") + $(a).attr("style"))) : g += l.substr(0, k) + a + l.substr(d)
				}
				m && $(j.parentElement).html(g.replace('generator\x3d"inlineEditor"', ""));
				k = $(j.parentElement)
			}
		} else g = "",
		null != $(e).attr("style") && (g = $(e).attr("style")),
		$(e).attr("style", g + $(a).attr("style")),
		k = $(e);
		return k
	},
	getSelectedText: function() {
		var a = NEFW.PREVIEW.contents().get(0),
		e = NEFW.PREVIEW.get(0).contentWindow,
		d = "";
		e.getSelection ? d = e.getSelection() : a.getSelection ? d = a.getSelection() : a.selection && (d = a.selection.createRange().text);
		return d
	},
	getSelectionParentElement: function() {
		var a = NEFW.PREVIEW.contents().get(0),
		e = NEFW.PREVIEW.get(0).contentWindow,
		d = null;
		e.getSelection ? (a = e.getSelection(), a.rangeCount && (d = a.getRangeAt(0).commonAncestorContainer, 1 != d.nodeType && (d = d.parentNode))) : a.selection && "Control" != a.selection.type && (d = a.selection.createRange().parentElement());
		return d
	},
	getSelectionHtml: function() {
		var a = NEFW.PREVIEW.contents().get(0),
		e = NEFW.PREVIEW.get(0).contentWindow,
		d = "";
		if ("undefined" != typeof e.getSelection) {
			if (e = e.getSelection(), e.rangeCount) {
				for (var a = a.createElement("div"), d = 0, g = e.rangeCount; d < g; ++d) a.appendChild(e.getRangeAt(d).cloneContents());
				d = a.innerHTML
			}
		} else "undefined" != typeof a.selection && "Text" == a.selection.type && (d = a.selection.createRange().htmlText);
		return d
	},
	replaceSelectionWithHtml: function(a) {
		var e;
		if (window.getSelection && window.getSelection().getRangeAt) {
			e = window.getSelection().getRangeAt(0);
			e.deleteContents();
			var d = document.createElement("div");
			d.innerHTML = a;
			a = document.createDocumentFragment();
			for (var g; g = d.firstChild;) a.appendChild(g);
			e.insertNode(a)
		} else document.selection && document.selection.createRange && (e = document.selection.createRange(), a = 3 == node.nodeType ? node.data: node.outerHTML, e.pasteHTML(a))
	},
	getScrollingPosition: function(a) {
		null == a && (a = !1);
		if ($.dmx.preview.wnd().jQuery.DM.isBodyScrollable() || a) {
			a = NEFW.PREVIEW.contents().get(0);
			var e = NEFW.PREVIEW.get(0).contentWindow,
			d = [0, 0];
			"undefined" != typeof e.pageYOffset ? d = [e.pageXOffset, e.pageYOffset] : "undefined" != typeof a.documentElement.scrollTop && 0 < a.documentElement.scrollTop ? d = [a.documentElement.scrollLeft, a.documentElement.scrollTop] : "undefined" != typeof a.body.scrollTop && (d = [a.body.scrollLeft, a.body.scrollTop])
		} else {
			d = [0, 0];
			try {
				d = [$.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().iscrollBody.element.scrollLeft(), $.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().iscrollBody.element.scrollTop()]
			} catch(g) {
				d = [0, 0]
			}
		}
		return d
	},
	showSelection: function() {
		var a = $.dmx.current.editable;
		null != a && (null != a.inlineEditor.editorUtils.editorLeft && a.inlineEditor.editorUtils.editorLeft.css("display", "block"), null != a.inlineEditor.editorUtils.editorRight && a.inlineEditor.editorUtils.editorRight.css("display", "block"), null != a.inlineEditor.editorUtils.editorBottom && a.inlineEditor.editorUtils.editorBottom.css("display", "block"))
	},
	hideSelection: function() {
		var a = $.dmx.current.editable;
		null != a && (null != a.inlineEditor.editorUtils.editorLeft && a.inlineEditor.editorUtils.editorLeft.css("display", "none"), null != a.inlineEditor.editorUtils.editorRight && a.inlineEditor.editorUtils.editorRight.css("display", "none"), null != a.inlineEditor.editorUtils.editorBottom && a.inlineEditor.editorUtils.editorBottom.css("display", "none"))
	},
	hideAllSelection: function() {
		var a = $.dmx.current.editable;
		null != a && (null != a.inlineEditor.editorUtils.editorTop && a.inlineEditor.editorUtils.editorTop.css("display", "none"), null != a.inlineEditor.editorUtils.editorLeft && a.inlineEditor.editorUtils.editorLeft.css("display", "none"), null != a.inlineEditor.editorUtils.editorRight && a.inlineEditor.editorUtils.editorRight.css("display", "none"), null != a.inlineEditor.editorUtils.editorBottom && a.inlineEditor.editorUtils.editorBottom.css("display", "none"), null != a.inlineEditor.editorUtils.editorBorderTop && a.inlineEditor.editorUtils.editorBorderTop.css("display", "none"))
	},
	decideIfElementIsInsideViewPort: function(a) {
		var e = a.offset().top; ! $.dmx.preview.wnd().$.DM.isBodyScrollable() && 0 < $.dmfw.getPreviewElement("#iscrollBody").has(a).length && (e = $(a).offset().top - $.dmfw.getPreviewElement("#iscrollBody").offset().top, 0 < $.dmfw.getPreviewElement("#iscrollBody").has(a).length && (e += $.getScrollingPosition()[1]));
		a = e + a.outerHeight();
		var d = NEFW.PREVIEW.get(0).contentWindow,
		g = $.getScrollingPosition()[1],
		d = g + d.innerHeight;
		return {
			top: e >= g && e <= d,
			bottom: a >= g && a <= d
		}
	}
}); (function(a) {
	var e = !1,
	d = !0;
	a.elementFromPoint = function(g, j) {
		a.browser.msie && null != _DragManager && (_DragManager.draggedVisual.hide(), _DragManager.dragFrameworkProps.previewCover.hide());
		var k = a.dmx.preview.doc(),
		l = a.dmx.preview.wnd();
		if (!k.elementFromPoint) return null;
		if (!e) {
			var m;
			if (0 < (m = a(k).scrollTop())) d = null == k.elementFromPoint(0, m + a(l).height() - 1);
			else if (0 < (m = a(k).scrollLeft())) d = null == k.elementFromPoint(m + a(l).width() - 1, 0);
			e = 0 < m
		}
		d || (g += a(k).scrollLeft(), j += a(k).scrollTop());
		k = k.elementFromPoint(g, j);
		a.browser.msie && null != _DragManager && (_DragManager.draggedVisual.show(), _DragManager.dragFrameworkProps.previewCover.show());
		return k
	}
})(jQuery);
var _RTE_Element = null,
_RTE_ElementDebug = !1,
RTE_UNDO_MAX_SIZE = 50;
$.extend({
	initRichTextEditor: function(a, e) {
		function d() {
			_RTE_Element.initializeEditor();
			a.focus();
			a.removeClass("dmParagraphPlaceholder").removeClass("dmTitlePlaceholder")
		}
		if (null == _RTE_Element || null == _RTE_Element.element || e) _RTE_ElementDebug && $.log("init"),
		a = $(a),
		a.lockElement(),
		_RTE_Element = new RTEObject(a),
		_RTE_ElementDebug && $.log("new stack"),
		_RTE_Element._RTE_stack = [],
		_RTE_Element._RTE_redo_stack = [],
		$.decideIfElementIsInsideViewPort(a).top ? d() : $.dmops.scrollPreview(a.offset().top - 41, 200,
		function() {
			d()
		});
		_RTE_Element.allowContentEditable(!0); ($.dmfw.isPT() || $.dmfw.isDudaone()) && $.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide()
	},
	removeRichTextEditor: function(a, e) {
		null != _RTE_Element && (_RTE_Element.dontRemoveEditor ? _RTE_Element.dontRemoveEditor = !1 : a && a != _RTE_Element.editorId || (_RTE_Element.remove(e), _RTE_Element = null))
	},
	setDescendantsCss: function(a, e) {
		a = $(a);
		$.each(a.find("*"),
		function(a, g) {
			g = $(g);
			var j = g.attr("style");
			null != j && -1 != j.indexOf(e) && g.dmCss(e, "")
		})
	}
});
function RTEObject(a) {
	var e = this;
	this.rangyTempClassName = "rangyTemp";
	this.RTE_Box = null;
	this.element = a;
	this.editorId = $(a).dmid();
	this.savedHtml = $(a).clone();
	this.parentHtml = $(a).parent().clone();
	this.keepEditableBar = this.dontRemoveEditor = this.needaRefresh = !1;
	this.controls = {
		color: this.createStyleEditableButton({
			id: "color",
			styleName: "color",
			widgetUrl: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			openWidget: function(a, e) {
				$("#widgetPlaceholder").neeColorPicker(a, dmStr["ui.text"].toLowerCase(), e, e)
			},
			initMethod: function() {
				var a = _RTE_Element.RTE_Box.find(".richTextEditorColorWrap#divToShowPalette");
				_RTE_Element.RTE_Box.find("#color").off("click.toggle").on("click.toggle",
				function() {
					_RTE_Element.RTE_Box.find(".dmRteControlButton_color")._openColorPaletteChange(function(a) {
						e.applyStyleOnSelection("color", a, null);
						e._addToUndo()
					},
					null, {
						elemToColor: _RTE_Element.RTE_Box.find(".DisplayBGselected")
					});
					a.is(":visible") ? a.fadeOut(300) : a.fadeIn(300)
				});
				_RTE_Element.RTE_Box.find(".DisplayBGselected").css("background-color", _RTE_Element.element.css("color"))
			}
		}),
		fontFamily: this.createStyleEditableButton({
			id: "fontFamily",
			styleName: "font-family",
			widgetUrl: "/editor/nee/mainTabs/neeDesign/nee.designHtmlFontFamily.jsp",
			openWidget: function(a, e) {
				$("#widgetPlaceholder").neeChangeFontFamily(a, e)
			},
			initMethod: function(a, e) {
				var j;
				j = $(".dmRteControlButton_fontFamily");
				var k = a;
				k && (k = k.split(" ")[0], -1 !== k.indexOf("'") && (k = k.substr(1, k.length - 2)), -1 !== k.indexOf(",") && (k = k.replace(/,/g, "")));
				j.find("#fontToShow").text(k);
				j.styleSelectBox(e, {
					width: 120,
					isFirstTime: !0
				});
				j = $("#fontFamily").find("a.dd-option, a.dd-selected");
				$.each(j,
				function(a, d) {
					var e = $(d).find("label");
					e.css({
						fontFamily: e.text()
					})
				});
				$("#fontFamily").off("click.closeothers").on("click.closeothers",
				function() {
					$(".changeColorPopup .closeColorPicker").trigger("click")
				})
			}
		}),
		fontSize: this.createStyleEditableButton({
			id: "fontSize",
			styleName: "font-size",
			widgetUrl: "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
			openWidget: function(a, e) {
				$("#widgetPlaceholder").neeChangeTextSize(a, e)
			},
			initMethod: function(a, e) {
				var j = _RTE_Element.RTE_Box.find("#fontSize");
				j.val(_RTE_Element.element.css("font-size"));
				j.styleSelectBox(function(a) {
					e(a.selectedData.value)
				},
				{
					isFirstTime: !0
				});
				$("#fontSize").off("click.closeothers").on("click.closeothers",
				function() {
					$(".changeColorPopup .closeColorPicker").trigger("click")
				})
			}
		}),
		bold: this.createStyleToggleButton({
			id: "bold",
			styleName: "font-weight",
			styleOn: "bold",
			styleOff: "normal"
		}),
		italic: this.createStyleToggleButton({
			id: "italic",
			styleName: "font-style",
			styleOn: "italic",
			styleOff: "normal"
		}),
		underline: this.createStyleToggleButton({
			id: "underline",
			styleName: "text-decoration",
			styleOn: "underline",
			styleOff: "none"
		}),
		alignLeft: this.createStyleGroupButton({
			id: "alignLeft",
			styleName: "text-align",
			styleOn: "left",
			group: "align",
			additionalStyles: {
				display: "block"
			},
			wrapSelection: !0,
			addToClick: !$.dmfw.isDudaone() ? null: function(a) {
				var e = !1,
				j = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
				_RTE_Element.reorderAlignButtons(a, !0);
				_RTE_Element.element.css(a.styleName) == a.styleOn && (e = !0);
				j.is(":visible") ? j.fadeOut(200) : j.fadeIn(200);
				return e
			},
			addToSetState: function(a) {
				_RTE_Element.reorderAlignButtons(a)
			}
		}),
		alignRight: this.createStyleGroupButton({
			id: "alignRight",
			styleName: "text-align",
			styleOn: "right",
			group: "align",
			additionalStyles: {
				display: "block"
			},
			wrapSelection: !0,
			addToClick: !$.dmfw.isDudaone() ? null: function(a) {
				var e = !1,
				j = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
				_RTE_Element.reorderAlignButtons(a, !0);
				_RTE_Element.element.css(a.styleName) == a.styleOn && (e = !0);
				j.is(":visible") ? j.fadeOut(200) : j.fadeIn(200);
				return e
			},
			addToSetState: function(a) {
				_RTE_Element.reorderAlignButtons(a)
			}
		}),
		alignCenter: this.createStyleGroupButton({
			id: "alignCenter",
			styleName: "text-align",
			styleOn: "center",
			group: "align",
			additionalStyles: {
				display: "block"
			},
			wrapSelection: !0,
			addToClick: !$.dmfw.isDudaone() ? null: function(a) {
				var e = !1,
				j = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
				_RTE_Element.reorderAlignButtons(a, !0);
				_RTE_Element.element.css(a.styleName) == a.styleOn && (e = !0);
				j.is(":visible") ? j.fadeOut(200) : j.fadeIn(200);
				return e
			},
			addToSetState: function(a) {
				_RTE_Element.reorderAlignButtons(a)
			}
		}),
		alignJustify: this.createStyleGroupButton({
			id: "alignJustify",
			styleName: "text-align",
			styleOn: "justify",
			group: "align",
			additionalStyles: {
				display: "block"
			},
			wrapSelection: !0,
			addToClick: !$.dmfw.isDudaone() ? null: function(a) {
				var e = !1,
				j = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
				_RTE_Element.reorderAlignButtons(a, !0);
				_RTE_Element.element.css(a.styleName) == a.styleOn && (e = !0);
				j.is(":visible") ? j.fadeOut(200) : j.fadeIn(200);
				return e
			},
			addToSetState: function(a) {
				_RTE_Element.reorderAlignButtons(a)
			}
		}),
		dirToggle: this.createStyleToggleButton({
			id: "dirToggle",
			styleName: "direction",
			styleOn: "ltr",
			styleOff: "rtl"
		}),
		link: this.createLinkButton({
			id: "link"
		}),
		bullets: this.createBulletsButton({
			id: "bullets",
			command: "insertUnorderedList",
			tag: "ul"
		}),
		numbers: this.createBulletsButton({
			id: "numbers",
			command: "insertOrderedList",
			tag: "ol"
		}),
		settings: this.createGenericButton({
			id: "settings",
			handler: function(a) {
				$.dmx.current.editable.inlineEditor.editorUtils.controls.edit.handler(_RTE_Element.element, $(a.target), a)
			}
		}),
		close: this.createGenericButton({
			id: "close",
			handler: function() {
				var a = $.dmx.current.element;
				$.removeRichTextEditor(e.editorId);
				$.deselectAllEditableElements();
				a.selectElement()
			}
		}),
		save: {
			element: null,
			buttonClassName: "DMRTESaveBtn",
			title: "Save",
			state: !1,
			iterable: !1,
			handler: function() {
				e.saveChanges(!0)
			}
		}
	}
}
RTEObject.prototype.createStyleToggleButton = function(a) {
	var e = this,
	d = {};
	d.id = a.id;
	d.hasEditor = !1;
	d.isToggle = !0;
	d.iterable = !0;
	d.state = !1;
	d.additionalStyles = a.additionalStyles;
	d.wrapSelection = a.wrapSelection;
	d.handler = function() {
		e.applyStyleOnSelection(a.styleName, d.state ? a.styleOff: a.styleOn, d.additionalStyles, d.wrapSelection);
		e._addToUndo();
		d.state = !d.state;
		this.element.toggleClass("on")
	};
	d.setState = function() {
		e._setToggleStyleState(d, a.styleName, a.styleOn)
	};
	return d
};
RTEObject.prototype.reorderAlignButtons = function(a, e) {
	if (null != _RTE_Element.RTE_Box && (this.element.css(a.styleName) == a.styleOn || e)) {
		var d = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
		$(".alignIndicator").remove();
		var g = _RTE_Element.RTE_Box.find("#" + a.id).clone().attr("id", a.id + "Indicator").addClass("alignIndicator");
		g.insertBefore(d);
		d = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
		g.off("click.tog").on("click.tog",
		function() {
			d.is(":visible") ? d.fadeOut(200) : d.fadeIn(200)
		})
	}
};
RTEObject.prototype.createStyleGroupButton = function(a) {
	var e = this,
	d = {};
	d.id = a.id;
	d.hasEditor = !1;
	d.isToggle = !1;
	d.iterable = !0;
	d.group = a.group;
	d.additionalStyles = a.additionalStyles;
	d.wrapSelection = a.wrapSelection;
	d.handler = function() {
		var g = !1;
		a.addToClick && (g = (g = a.addToClick(a)) || !1);
		g || (e.applyStyleOnSelection(a.styleName, a.styleOn, d.additionalStyles, d.wrapSelection), e._addToUndo())
	};
	d.setState = function() {
		a.addToSetState && a.addToSetState(a);
		e._setToggleStyleState(d, a.styleName, a.styleOn)
	};
	return d
};
RTEObject.prototype.createStyleEditableButton = function(a) {
	var e = this,
	d = {};
	d.id = a.id;
	d.hasEditor = !0;
	d.isToggle = !1;
	d.iterable = !0;
	d.state = !1;
	d.additionalStyles = a.additionalStyles;
	d._update = function(g) {
		e.applyStyleOnSelection(a.styleName, g, d.additionalStyles);
		e._addToUndo()
	};
	d._getCurrent = function() {
		return e._getStyleValues(a.styleName)[0]
	};
	d.handler = function() {
		$.dmLoad("#widgetPlaceholder", a.widgetUrl,
		function() {
			a.openWidget(d._getCurrent(), d._update);
			d.loaded = !0
		})
	};
	a.initMethod && (d.initMethod = function() {
		a.initMethod(d._getCurrent(), d._update)
	});
	d.setState = function() {
		d.loaded && $("#" + d.id).is(".selected") && a.openWidget(d._getCurrent(), d._update)
	};
	return d
};
RTEObject.prototype._openSecondaryEditor = function(a, e, d) {
	this.allowContentEditable(!1);
	var g = a.dmid();
	this.isModified() ? this.saveChanges(!1,
	function() {
		$.dmfw.addEditor($.dmfw.editables(e), $.dmfw.getByDmid(g), {
			parent: {
				element: $.dmx.current.element,
				editable: $.dmx.current.editable,
				selection: g
			}
		},
		d)
	}) : $.dmfw.addEditor($.dmfw.editables(e), a, {
		parent: {
			element: $.dmx.current.element,
			editable: $.dmx.current.editable,
			selection: g
		}
	},
	d)
};
RTEObject.prototype.createGenericButton = function(a) {
	var e = {};
	e.id = a.id;
	e.handler = a.handler;
	e.additionalClasses = a.additionalClasses;
	return e
};
RTEObject.prototype.createBulletsButton = function(a) {
	var e = this,
	d = {};
	d.id = a.id;
	d.hasEditor = !1;
	d.iterable = !0;
	d.state = !1;
	d.opened = !1;
	d.command = a.command ? a.command: "insertUnorderedList";
	d.tag = a.tag ? a.tag: "ul";
	d.handler = function() {
		if (!$("#" + d.id).is(".disabled")) {
			$("#" + d.id).toggleClass("on");
			var a = e.element.parent();
			a.attr("contenteditable", !0);
			NEFW.PREVIEW.get(0).contentWindow.document.execCommand(d.command, !1, null);
			if (!$.dmfw.getByDmid(e.element.dmid()).length || e.element.is("ul *, ol *") || 0 < e.element.siblings("ul:not([duda_id]),ol:not([duda_id])").length) e.dontRemoveEditor = !0,
			a.selectElement(),
			a.lockElement({
				hideTopBar: !0
			}),
			e.element = a,
			e.savedHtml = e.parentHtml,
			e.needsRefresh = !0;
			var j = e.element.find("ul, ol");
			j.each(function() {
				if (!$(this).dmid() && (e.needsRefresh && !$(this).is("[ulwrap] *") || $(this).is("p *"))) {
					var a = $(this).is("p *") ? "section": "div",
					d = rangy.saveSelection(NEFW.PREVIEW.get(0).contentWindow);
					$(this).wrap("\x3c" + a + " ulwrap\x3d'true'\x3e\x3c/" + a + "\x3e");
					e.needsRefresh = !0;
					rangy.restoreSelection(d)
				} ("none" == $(this).css("list-style-type") || "none" == $(this).css("list-style") || "0px" == $(this).css("padding-left")) && j.attr("class", "force-list")
			});
			a && a.removeAttr("contenteditable");
			e._handleAction();
			e.setControlsStates()
		}
	};
	d.setState = function() {
		rangy.getSelection(NEFW.PREVIEW.get(0).contentWindow).refresh();
		e.element.is("ul, ol") ? $("#" + d.id).addClass("disabled") : ($("#" + d.id).removeClass("disabled"), e._isSelectedElementOfWrappedByTag(d.tag) ? (d.state = !0, $("#" + d.id).addClass("on")) : (d.state = !1, $("#" + d.id).removeClass("on")))
	};
	return d
};
RTEObject.prototype.createLinkButton = function(a) {
	var e = this,
	d = {};
	d.id = a.id;
	d.hasEditor = !1;
	d.iterable = !0;
	d.state = !1;
	d.opened = !1;
	d.openLinkEditor = function(a) {
		this.keepEditableBar = !0;
		$.dmfw.isDudaone() ? e._openSecondaryEditor($.dmx.current.element, "paragraph", {
			linkElement: a
		}) : e._openSecondaryEditor(a, "link")
	};
	d.openWidgetOnExisting = function() {
		var a = e._getWrappingElement("a");
		d.openLinkEditor(a)
	};
	d.openWidgetOnNew = function() {
		var a = "",
		a = $.dmx.site.isFromScratch ? $.dmSiteLinkForSave("home") : $.dmfw.finalyzeRuntimeUrl($.dmSiteLinkForSave("home")),
		j = e._getWrappingElement("a");
		if (null != j && j.is("a")) j.attr("href", a),
		j.attr("raw_url", $.dmx.site.baseUrl);
		else if (j = "", $.dmx.site.isFromScratch || (j = "raw_url\x3d'" + $.dmx.site.baseUrl + "'"), j = e._wrapSelection("\x3ca style\x3d'margin-left:0px' href\x3d'" + a + "' " + j + "\x3e\x3c/a\x3e"), null == j) return;
		d.openLinkEditor(j)
	};
	d.handler = function() {
		if (!$("#" + d.id).is(".disabled")) if ($("#" + d.id).addClass("selected"), d.state) d.openWidgetOnExisting();
		else {
			var a = rangy.getSelection(NEFW.PREVIEW.get(0).contentWindow);
			a.refresh();
			a.isCollapsed ? ($("#" + d.id).removeClass("selected"), $("#welcomeText").show()) : d.openWidgetOnNew()
		}
	};
	d.setState = function() {
		if (e._isSelectedElementOfWrappedByTag("a", "href")) d.state = !0,
		$("#" + d.id).addClass("on"),
		$("#" + d.id).removeClass("disabled");
		else {
			d.state = !1;
			$("#" + d.id).removeClass("on");
			var a = rangy.getSelection(NEFW.PREVIEW.get(0).contentWindow);
			a.refresh();
			a.isCollapsed || "" == a.toString() ? $("#" + d.id).addClass("disabled") : $("#" + d.id).removeClass("disabled")
		}
	};
	return d
};
RTEObject.prototype.openSecondaryEditor = function(a, e) {
	this._openSecondaryEditor(a, e)
};
RTEObject.prototype.initializeEditor = function() {
	var a = $(this.element),
	e = this;
	this.element.addClass("dmNowInlineEditing");
	this.element.attr("contenteditable", !0);
	a.find("*").andSelf().filter("img").attr("contenteditable", !1);
	rangy.init();
	rangy.rangePrototype.isNodeStart = function(a) {
		var g = this.cloneRange();
		g.selectNode(a);
		g.setEnd(a, this.endOffset);
		return 0 == g.toString().trim().length && !e._isTextNode(a) || 0 == this.startOffset || e._isTextNode(a) && "" == a.textContent.substring(0, this.startOffset).trim()
	};
	rangy.rangePrototype.isNodeEnd = function(a) {
		var g = this.cloneRange();
		g.selectNode(a);
		g.setEndAfter(a);
		g = 0 == g.toString().trim().length;
		e._isTextNode(a) ? (a = this.endContainer.textContent.substring(this.endOffset).trim().replace(/^\s*[\n\r]+\s*[\n\r\s]*$/gm, "").replace(/^\s*[\n\r]+[\n\r\s]*/gm, "").replace(/[\n\r]+[\n\r\s]*\s*$/gm, ""), g = g || 0 == a.length) : g = g || this.endOffset + 1 >= a.childNodes.length;
		return g
	};
	this.setEditorControls();
	$.dmfw.isDudaone() || this.setControlsStates();
	this._addToUndo();
	$(document.body).on("click", "#undoBtn",
	function() {
		e._undo()
	});
	$(document.body).on("click", "#redoBtn",
	function() {
		e._redo()
	});
	$("body").off("keydown.rte").on("keydown.rte",
	function(a) {
		e._handleKeyDownUndo(a)
	});
	a.off("keydown.rte").on("keydown.rte",
	function(a) {
		e._handleKeyDown(a)
	});
	a.off("paste.rte").on("paste.rte",
	function() {
		e._handlePaste()
	});
	a.off("dragover.rte drop.rte").on("dragover.rte drop.rte",
	function(a) {
		a.preventDefault();
		return ! 1
	});
	a.off("keyup.rte").on("keyup.rte",
	function(a) {
		null != _RTE_Element && (e.fixSize(), !a.ctrlKey && !a.metaKey && e._addToUndo())
	});
	a.off("keypress.rte").on("keypress.rte",
	function(a) {
		null != _RTE_Element && (e.fixSize(), !a.ctrlKey && !a.metaKey && e._addToUndo())
	});
	a.off("mousedown.rte").on("mousedown.rte",
	function() {
		e._handleAction()
	});
	a.off("mouseup.rte").on("mouseup.rte",
	function() {
		e._handleAction()
	});
	a.off("cut.rte").on("cut.rte",
	function() {
		e._handleAction()
	});
	a.off("dragend.rte").on("dragend.rte",
	function() {
		e._handleAction()
	});
	a.off("drop.rte").on("drop.rte",
	function() {
		e._handleAction()
	});
	a.off("change.rte").on("change.rte",
	function() {
		e._handleAction()
	});
	$("#fontSize.textControl").click()
};
RTEObject.prototype._handleAction = function() {
	null != _RTE_Element && (this.fixSize(), this._addToUndo())
};
RTEObject.prototype.getAsterixClassName = function(a, e) {
	if (e && a) return "asterixTemp_" + a + "_" + e.hashCode() + "_asterix"
};
RTEObject.prototype._isAlreadyBlock = function(a, e, d) {
	return "display" == e && "block" == d && "inline" != a.dmCss("display") ? !0 : !1
};
RTEObject.prototype.applyStyleOnSelection = function(a, e, d, g) {
	var j = this,
	k = NEFW.PREVIEW.get(0).contentWindow;
	e.selectedData && (e = e.selectedData.value);
	if ("font-family" === a) {
		var l = $("#fontFamily").find("label.dd-selected-text");
		0 < l.length && l.css({
			"font-family": e
		})
	}
	l = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	l.refresh();
	var m = this.element,
	n = j.getAsterixClassName(a, e),
	o = RegExp("\\basterixTemp_" + a + ".*?\\b", "g");
	n && this.addAsterixCssRuleToPageCss(n, a, e);
	null == l.anchorNode && (m.focus(), l = rangy.getIframeSelection(NEFW.PREVIEW.get(0)));
	if (null != l.anchorNode) {
		var r = null;
		if (l.isCollapsed) r = m;
		else {
			var u = $(l.getRangeAt(0).commonAncestorContainer);
			this._isTextNode(u.get(0)) && (u = u.parent());
			var s = rangy.createRange(NEFW.PREVIEW.contents().get(0));
			s.selectNode(u.get(0));
			s.toString().trim() == l.getRangeAt(0).toString().trim() ? r = u: g && (r = this._wrapSelection("\x3cspan\x3e\x3c/span\x3e"))
		}
		if (r) r.dmCss(a, e + " !important"),
		d && $.each(d,
		function(a, d) {
			if (j._isAlreadyBlock(r, a, d)) return ! 0;
			r.dmCss(a, d + " !important")
		}),
		r && (r.get(0) && r.get(0).className) && (r.get(0).className = r.get(0).className.replace(o, "")),
		r.addClass(n),
		$.setDescendantsCss(r, a);
		else {
			rangy.createCssClassApplier(j.rangyTempClassName, {
				normalize: !0
			},
			"*").applyToSelection(k);
			var B = null,
			z = null;
			m.find("." + j.rangyTempClassName).each(function(g, k) {
				var m = null;
				k = $(k);
				if ("" != k.text()) {
					k.dmCss(a, e + " !important");
					k.addClass(n);
					k.removeClass(j.rangyTempClassName);
					d && $.each(d,
					function(a, d) {
						if (j._isAlreadyBlock(k, a, d)) return ! 0;
						k.dmCss(a, d + " !important")
					});
					var l = k.parent();
					k.text().trim() == l.text().trim() ? (l.html(k.text()), l.dmCss(a, e + " !important"), l.get(0).className && (l.get(0).className = l.get(0).className.replace(o, "")), l.addClass(n), d && $.each(d,
					function(a, d) {
						if (j._isAlreadyBlock(l, a, d)) return ! 0;
						l.dmCss(a, d + " !important")
					}), $.setDescendantsCss(l, a), m = l.get(0)) : m = k.get(0)
				}
				0 == g && (B = m);
				z = m
			});
			null != B && null != z && this.selectNode(B, z)
		}
		this.fixSize()
	}
};
RTEObject.prototype.selectNode = function(a, e) {
	var d = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	d.refresh();
	d.removeAllRanges();
	var g = rangy.createRange(NEFW.PREVIEW.contents().get(0)); ! e || a == e ? g.selectNodeContents($(a).get(0)) : (g.setStartBefore($(a).get(0)), g.setEndAfter($(e).get(0)));
	d.addRange(g)
};
RTEObject.prototype.isModified = function() {
	var a = this.cleanClientGeneratedClassesFromElement(this.savedHtml),
	e = this.cleanClientGeneratedClassesFromElement();
	NEFW.PREVIEW.get(0).contentWindow.styleImages(a);
	NEFW.PREVIEW.get(0).contentWindow.styleImages(e);
	$.each(a.find("*").andSelf().filter('*[class\x3d""]'),
	function(a, e) {
		$(e).removeAttr("class")
	});
	$.each(e.find("*").andSelf().filter('*[class\x3d""]'),
	function(a, e) {
		$(e).removeAttr("class")
	});
	return a.outerHTML() != e.outerHTML()
};
RTEObject.prototype.getSaveData = function() {
	var a = $(this.element),
	e = this.cleanClientGeneratedClassesFromElement(this.savedHtml).outerHTML(),
	d = this.cleanClientGeneratedClassesFromElement().outerHTML();
	return {
		htmlBefore: e,
		htmlAfter: d,
		elementID: a.dmid()
	}
};
RTEObject.prototype.onSavedFromLinkWidget = function(a) {
	this.onSaved(a.inlineEdit)
};
RTEObject.prototype.onSaved = function(a, e, d) {
	if (null != _RTE_Element) {
		"true" == a.sync_broken && $.dmNotify("Sync broken (temp message)");
		var g = this.element;
		if (0 <= a.markup.indexOf("dmNeedsRefresh") || this.needsRefresh && !e) {
			var j = g.dmid();
			0 <= a.markup.indexOf("ulwrap") && (j = $(a.markup).filter("[ulwrap]").dmid());
			$.dmfw.refreshPreview(function() {
				if (!e) {
					var a = $.dmfw.getByDmid(j);
					$.dmfw.selectAndOpenEditor(a)
				}
			})
		} else {
			$.dmops.refreshPageStyleCss(a.page_css, $.dmx.isHeader(g));
			var k = $(a.markup);
			k.show();
			a = g.css("display"); - 1 == a.indexOf("important") && (a += " !important");
			g.replaceWith(k);
			k.dmCss("display", a);
			a = g.data("events");
			k.data("events", a);
			null != g.attr("class") && $.each(g.attr("class").split(" "),
			function(a, d) {
				d.match(/asterixTemp_.+?_asterix/g) || k.addClass(d)
			});
			e ? $.removeRichTextEditor(this.editorId) : null != _RTE_Element && (this.element = k, this.element.focus(), $.dmx.current.editable.element = k, $.dmfw.setCurrent($.dmx.current.editable, k), this.savedHtml = this.element.clone());
			g = k.attr("class");
			k.attr("class", g);
			k.find("*").each(function() {
				var a = $(this).attr("class");
				$(this).attr("class", a)
			});
			$.dmfw.getPreviewElement("#tempstyle").html("");
			NEFW.runPreviewStyleImages();
			setTimeout("NEFW.runPreviewStyleImages()", 30);
			setTimeout("NEFW.runPreviewStyleImages()", 300);
			setTimeout("NEFW.runPreviewStyleImages()", 3E3);
			this._clearUndo();
			var l = NEFW.PREVIEW.contents();
			$.each($.dmfw.editables(),
			function(a, d) {
				d.docReady(l)
			});
			d && d();
			$.dmx.preview.wnd().jQuery.DM.afterAjaxGeneralInits(!0);
			$.dmx.preview.wnd().jQuery.DM.afterAjaxGeneralLoadInits()
		}
	}
};
RTEObject.prototype.saveAndLock = function(a) {
	this.allowContentEditable(!1);
	this.saveChanges(!1, a)
};
RTEObject.prototype.saveChanges = function(a, e) {
	var d = this;
	this.allowContentEditable(!1);
	null == a && (a = !0);
	try {
		this.isModified() ? $.changePage({
			clientChange: function() {},
			serverChange: function() {
				$.dmPostWithHistory({
					data: d.getSaveData(),
					url: "/pages/" + $.dmx.currentPage() + "/inlineedit",
					success: function(g) {
						d.onSaved(g, a, e)
					}
				})
			}
		}) : e && e()
	} catch(g) {
		$.dmNotify("js error")
	}
};
RTEObject.prototype.allowContentEditable = function(a) {
	null != this.element && (a ? $(this.element).attr("contenteditable", a) : ($(this.element).removeAttr("contenteditable"), $(this.element).find("*").andSelf().filter("img").removeAttr("contenteditable")))
};
RTEObject.prototype.remove = function(a) {
	null === a && (a = !1);
	$.dmfw.isDudaone() && this.saveChanges(!1, null);
	$(this.element).removeClass("dmNowInlineEditing").removeAttr("contenteditable");
	this.element.off("keydown.rte");
	this.element.off("mouseup.rte");
	this.element.off("paste.rte");
	this.element.off("keyup.rte");
	this.element.off("keypress.rte");
	$("body").off("keydown.rte");
	null != this.RTE_Box && (this.RTE_Box.remove(), $(".dmInlineRichTextEditorWrap").remove(), this.RTE_Box = null);
	this.allowContentEditable(!1);
	this.keepEditableBar || $.dmfw.preview.removeEditableBar();
	rangy.getIframeSelection(NEFW.PREVIEW.get(0)).removeAllRanges();
	a && $.deselectAllEditableElements()
};
RTEObject.prototype.isTextEditorVisible = function() {
	return 0 < $("#inlineRichTextEditor").length
};
RTEObject.prototype.handleWindowEvents = function(a) {
	"mouseup" == a.type && (a = $(a.target), !a.is("#inlineEditableBar *") && !a.is("#inlineEditableBar") && (this.setControlsStates(), $.dmfw.isUseNewSelectionContext() ? this.allowContentEditable(!0) : $.dmfw.preview.showEditableBar(a) || ($.dmfw.preview.removeEditableBar(), this.allowContentEditable(!0))))
};
RTEObject.prototype.setControlsStates = function() {
	$.each(this.controls,
	function(a, e) {
		e.iterable && e.setState()
	})
};
RTEObject.prototype._getStyleValues = function(a) {
	var e = [],
	d = $([]),
	g = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	g.refresh();
	g.isCollapsed ? (0 == g.getAllRanges().length && (d = NEFW.PREVIEW.contents().get(0), d = rangy.createRange(d), g.addRange(d)), d = $(this.element)) : (d = $(g.getRangeAt(0).getNodes([1])), 0 == d.length && (d = $(g.getRangeAt(0).getNodes()).parent()));
	d.each(function(d, g) {
		g = $(g);
		if ("" != g.text().trim()) {
			var l = g.dmCss(a);
			"font-weight" == a && "700" == l && (l = "bold");
			e.push(l)
		}
	});
	return e
};
RTEObject.prototype._isSelectedElementOfWrappedByTag = function(a, e) {
	var d = e ? a + "[" + e + "] , " + a + "[" + e + "] *": a + " , " + a + " *",
	g = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	g.refresh();
	if (g.isCollapsed) {
		g = g.anchorNode;
		if (!g) return ! 1;
		g = $(g.parentNode);
		return g.is(d)
	}
	var j = !0;
	setElements = $(g.getRangeAt(0).getNodes([1]));
	0 == setElements.length && (setElements = $(g.getRangeAt(0).getNodes()).parent());
	0 == setElements.length ? j = !1 : setElements.each(function(a, e) {
		e = $(e);
		e.is(d) || (j = !1)
	});
	return j
};
RTEObject.prototype._getWrappingElement = function(a) {
	var e = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	e.refresh();
	if (e.isCollapsed) {
		e = e.anchorNode;
		if (!e) return null;
		e = $(e.parentNode);
		return e.closest(a)
	}
	var d = null;
	setElements = $(e.getRangeAt(0).getNodes([1]));
	0 == setElements.length && (setElements = $(e.getRangeAt(0).getNodes()).parent());
	setElements.each(function(e, j) {
		j = $(j);
		d = j.closest(a)
	});
	return d
};
RTEObject.prototype._wrapSelection = function(a) {
	var e = this.element,
	d = this,
	g = NEFW.PREVIEW.get(0).contentWindow,
	j = rangy.getIframeSelection(NEFW.PREVIEW.get(0));
	j.refresh();
	var k = $(a);
	k.dmid(randomXToY(1E9, 2E9));
	if (j.isCollapsed) if (a = j.anchorNode) k.insertAfter($(a));
	else return null;
	else {
		rangy.createCssClassApplier(this.rangyTempClassName, {
			normalize: !0
		},
		"*").applyToSelection(g);
		a = e.find("." + this.rangyTempClassName);
		if (0 == a.length) return null;
		a.each(function(a, e) {
			e = $(e);
			e.removeClass(d.rangyTempClassName);
			var g = e.parent();
			e.text().trim() == g.text().trim() && d._isLegalWrap(k, g) && (g.html(e.text()), e = g);
			0 == a && k.insertBefore(e);
			e.appendTo(k)
		})
	}
	null != k && this.selectNode(k);
	return k
};
RTEObject.prototype._isLegalWrap = function(a, e) {
	if (e.dmid() == this.element.dmid()) return ! 1;
	var d = [];
	d.a = "h1 h2 h3 h4 form";
	var g = a.get(0).nodeName.toLowerCase(),
	j = e.get(0).nodeName.toLowerCase();
	return d[g] && -1 != d[g].indexOf(j) ? !1 : !0
};
RTEObject.prototype._setToggleStyleState = function(a, e, d) {
	e = this._getStyleValues(e);
	if (0 == e.length) a.state = !1,
	a.element.removeClass("on");
	else {
		for (var g = 0; g < e.length; g++) if (e[g] != d) {
			a.state = !1;
			a.element.removeClass("on");
			return
		}
		a.state = !0;
		a.element.addClass("on")
	}
};
RTEObject.prototype.addAsterixCssRuleToPageCss = function(a, e, d) {
	var g = $.dmfw.getPreviewElement("#tempstyle");
	g.attr("type", "text/css");
	0 == g.length && (g = document.createElement("style"), $(g).attr("id", "tempstyle"), g.type = "text/css", NEFW.PREVIEW.contents().get(0).getElementsByTagName("head")[0].appendChild(g), g = $(g));
	a = -1 === d.search(".*!importants*$") ? "#dm #dmStyle_innerContainer *." + a + " * {" + e + ":" + d + " !important;}": "#dm #dmStyle_innerContainer *." + a + " * {" + e + ":" + d + ";}";
	g.html(g.html() + a)
};
RTEObject.prototype.cleanClientGeneratedClassesFromElement = function(a, e) {
	null == a && (a = this.element);
	null == e && (e = !0);
	e && (a = a.clone());
	if (null != _RTE_Element) {
		a.attr("class") && a.attr("class", a.attr("class").replace(/asterixTemp_.+?_asterix/g, ""));
		try {
			a.html(a.html().replace(/asterixTemp_.+?_asterix/g, ""))
		} catch(d) {} (null == a.attr("class") || "" == a.attr("class")) && a.removeAttr("class");
		$.each(a.find("*").andSelf().filter('*[class\x3d""]'),
		function(a, d) {
			$(d).removeAttr("class")
		})
	}
	a.find("." + INLINE_EDITOR_EDITED_ELEMENT_CLASS).andSelf().removeClass(INLINE_EDITOR_EDITED_ELEMENT_CLASS);
	a.find(".inlineEditorParagraphSelected").andSelf().removeClass("inlineEditorParagraphSelected");
	a.find(".dmNowInlineEditing").andSelf().removeClass("dmNowInlineEditing");
	a.find(".dmLocked").andSelf().removeClass("dmLocked");
	a.find("*").andSelf().removeAttr("contenteditable");
	a.find("*").andSelf().removeAttr("aria-describedby");
	$.each(a.find("*").andSelf().filter('*[class\x3d""]'),
	function(a, d) {
		$(d).removeAttr("class")
	});
	return a
};
RTEObject.prototype.fixSize = function() {
	$.dmops.redrawSelection();
	setTimeout("$.dmops.redrawSelection()", 300)
};
RTEObject.prototype.initRichTextEditorButton = function(a, e) {
	var d = $("#" + a.id);
	a.initMethod ? a.initMethod() : d.click(function(a) {
		e(a)
	});
	return d
};
RTEObject.prototype.setEditorControls = function() {
	function a() {
		var a = $("#_preview_w"),
		g = "mobile" === $.onefw.device(),
		l = 0,
		m,
		n,
		o;
		d.RTE_Box.addClass("dmInlineRichTextEditorWrap DMInlineEditorNotEditableElement");
		var r = d.RTE_Box.outerWidth(!0) + 10;
		o = d.RTE_Box.outerHeight(!0);
		n = $.dmx.current.editable.inlineEditor.editorUtils.editorBorderTop.offset();
		m = a.offset();
		o = n.top + m.top - o;
		n = n.left + m.left;
		n + r > $(window).width() && (n = $(window).width() - r);
		g && (n = m.left - (d.RTE_Box.width() - a.width()) / 2);
		$.dmx.preview.wnd().$.DM.isBodyScrollable() && (l = parseInt($.getScrollingPosition()[1]));
		d.RTE_Box.offset({
			top: o - l,
			left: n
		});
		d.RTE_Box.html(d.RTE_Box.html());
		e();
		d.setControlsStates();
		var u = _RTE_Element.RTE_Box.find("#dmRteAlignTextWrap");
		d.RTE_Box.find(".alignIndicator").off("click.tog").on("click.tog",
		function() {
			u.is(":visible") ? u.fadeOut(200) : u.fadeIn(200)
		});
		d.RTE_Box.draggable({
			handle: ".dmRteDragHandler",
			iframeFix: !0
		})
	}
	function e() {
		$.each(_RTE_Element.controls,
		function(a, e) {
			var g = function(a) {
				e.hasEditor && ($(".textControl").removeClass("selected"), e.element.addClass("selected"), $("#welcomeText").hide());
				e.handler(a);
				e.group && (e.element.addClass("on"), $.each(d.controls,
				function(a, d) {
					d.group && (d.group == e.group && d != e) && d.element.removeClass("on")
				}))
			};
			$.dmfw.isDudaone() ? e.element = d.initRichTextEditorButton(e, g) : (e.element = $("#" + e.id), e.element.click(function(a) {
				g(a)
			}))
		})
	}
	var d = this;
	if ($.dmfw.isDudaone()) {
		d.RTE_Box = $("\x3cdiv\x3e\x3c/div\x3e");
		$("#PreviewPaneWrapper").append(d.RTE_Box);
		var g = $.dmx.cache.get("richtexteditor");
		null != g ? (d.RTE_Box.html(g.clone().html()), a()) : $.dmLoad(d.RTE_Box, "/editor/nee/inline/framework/inlineRichTextEditor.jsp",
		function() {
			a()
		})
	} else e()
};
String.prototype.hashCode = function() {
	var a = 0;
	if (0 == this.length) return a;
	for (var e = 0; e < this.length; e++) c = this.charCodeAt(e),
	a = (a << 5) - a + c,
	a &= a;
	return Math.abs(a)
};
RTEObject.prototype._handleKeyDownUndo = function(a) {
	if (a.ctrlKey || a.metaKey) 90 == a.keyCode ? (_RTE_ElementDebug && $.log("body: ctrl-z pressed"), this._undo(), this._cancelEvent(a)) : 89 == a.keyCode && (_RTE_ElementDebug && $.log("body: ctrl-y pressed"), this._redo(), this._cancelEvent(a))
};
RTEObject.prototype._handleKeyDown = function(a) {
	this.element.removeClass("dmParagraphPlaceholder").removeClass("dmTitlePlaceholder");
	if (a.ctrlKey || a.metaKey) 90 == a.keyCode ? (_RTE_ElementDebug && $.log("ctrl-z pressed"), this._undo(), this._cancelEvent(a)) : 89 == a.keyCode ? (_RTE_ElementDebug && $.log("ctrl-y pressed"), this._redo(), this._cancelEvent(a)) : 66 == a.keyCode ? this.controls.bold.handler() : 73 == a.keyCode ? this.controls.italic.handler() : 85 == a.keyCode && this.controls.underline.handler();
	else if (null != _RTE_Element) {
		var e = a.keyCode ? a.keyCode: a.which,
		d = rangy.getIframeSelection(NEFW.PREVIEW.get(0)),
		g = NEFW.PREVIEW.contents().get(0);
		if (d.isCollapsed) {
			var j = null;
			if (46 == e || 110 == e || 8 == e || 13 == e) j = d.getRangeAt(0);
			if (46 == e || 110 == e) {
				if (j.isNodeEnd(j.startContainer)) {
					g = $(j.startContainer);
					if (g.children().length > j.startOffset) g = $(g.children().get(j.startOffset));
					else return;
					for (var k = this._getNextElement(g); 0 == k.length && g.parent() != this.element.first();) g = g.parent(),
					k = this._getNextElement(g);
					k.first() == this.element.first() && (k = $(""));
					if (!this._isTextNode(g.first()[0]) && !jQuery.contains(this.element[0], g.first()[0])) this._cancelEvent(a);
					else if (0 < k.length && !this._isTextNode(k.first()[0]) && !jQuery.contains(this.element[0], k.first()[0])) this._cancelEvent(a);
					else {
						var l = this._getFirstDescendant(k),
						m = this._descendantHasDisplayInline(g.first(), !1),
						n = this._descendantHasDisplayInline(k.first(), !0);
						if (0 < k.length && ("BR" == k[0].tagName || "" == k.first().text().trim())) k.first().remove(),
						this._cancelEvent(a);
						else if (0 < l.length && ("BR" == l[0].tagName || "" == l.first().text().trim())) this._setDisplayInline(g.first(), !1),
						this._setDisplayInline(k.first(), !0),
						l.first().remove(),
						this._cancelEvent(a);
						else if (g.first() != this.element.first() && (m || n)) this._setDisplayInline(g.first(), !1),
						this._setDisplayInline(k.first(), !0),
						0 < k.length && ("BR" == k[0].tagName || "" == k.first().text().trim()) && k[0].parent.removeChild(k[0]),
						this._cancelEvent(a)
					}
				}
			} else if (8 == e) {
				if (j.isNodeStart(j.startContainer)) {
					g = $(j.startContainer);
					if (g.is("ul, ul *, ol, ol *")) return;
					if (!this._isTextNode(g.first()[0])) if (g.children().length > j.startOffset) g = $(g.children().get(j.startOffset));
					else return;
					for (k = this._getPreviousElement(g); 0 == k.length;) g = g.parent(),
					k = this._getPreviousElement(g);
					k.first() == this.element.first() && (k = $(""));
					if (!this._isTextNode(g.first()[0]) && !jQuery.contains(this.element[0], g.first()[0])) this._cancelEvent(a);
					else if (! (0 < k.length && !this._isTextNode(k.first()[0]) && !jQuery.contains(this.element[0], k.first()[0]))) if ("BR" == g[0].tagName) g.first().remove(),
					this._cancelEvent(a);
					else if (l = k.first().find("*").last(), m = this._descendantHasDisplayInline(g.first(), !0), n = this._descendantHasDisplayInline(k.first(), !1), 0 < k.length && ("BR" == k[0].tagName || "" == k.first().text().trim())) k.first().remove(),
					this._cancelEvent(a);
					else if (0 < l.length && ("BR" == l[0].tagName || "" == l.first().text().trim())) this._setDisplayInline(g.first(), !0),
					k.first() != this.element.first() && this._setDisplayInline(k.first(), !1),
					l.first().remove(),
					this._cancelEvent(a);
					else if (g.first() != this.element.first() && (m || n)) this._setDisplayInline(g.first(), !0),
					this._setDisplayInline(k.first(), !1),
					0 < k.length && ("BR" == k[0].tagName || "" == k.first().text().trim()) && k.first().remove(),
					this._cancelEvent(a)
				}
			} else 13 == e && (l = $(j.commonAncestorContainer).parent(), l.is("ul, ul *, ol, ol *") || (m = g.createElement("br"), k = l.outerHeight(), j.insertNode(m), l = l.outerHeight(), k == l && (m = g.createElement("br"), j.insertNode(m)), j.setStartAfter(m), this._cancelEvent(a))); (46 == e || 110 == e || 8 == e || 13 == e) && d.setSingleRange(j)
		} else 46 == e || 110 == e || 8 == e ? (d.deleteFromDocument(), this._cancelEvent(a)) : 13 == e && (j = d.getRangeAt(0), d.deleteFromDocument(), m = g.createElement("br"), j.insertNode(m), j.setStartAfter(m), this._cancelEvent(a), d.setSingleRange(j));
		this.fixSize()
	}
};
RTEObject.prototype._handlePaste = function() {
	var a = this;
	window.setTimeout(function() {
		var e = a.element.html(),
		d = $.dmfw.getPreviewElement(".dmNowInlineEditing");
		if (1 < d.length) {
			var g = d.first();
			a.element = g;
			e = a.element.html();
			d = d.not(g).filter(":not(.dmNowInlineEditing *)");
			0 < d.length && d.appendTo(g).removeClass("dmNowInlineEditing")
		}
		a.element.find("*").each(function() {
			var a = $(this).attr("class");
			a && a.match("nlineEditor") && $(this).removeAttr("class")
		});
		a.element.find("*").andSelf().filter("font").each(function() {
			var a = $(this).attr("size"),
			d = $(this).attr("face"),
			e = $(this).attr("color");
			if (a) switch (a) {
			case "1":
				$(this).dmCss("font-size", "10px");
				break;
			case "2":
				$(this).dmCss("font-size", "13px");
				break;
			case "3":
				$(this).dmCss("font-size", "16px");
				break;
			case "4":
				$(this).dmCss("font-size", "18px");
				break;
			case "5":
				$(this).dmCss("font-size", "24px");
				break;
			case "6":
				$(this).dmCss("font-size", "32px");
				break;
			case "7":
				$(this).dmCss("font-size", "48px");
				break;
			default:
				$(this).dmCss("font-size", "16px")
			}
			d && $(this).dmCss("font-family", d);
			e && $(this).dmCss("color", e)
		});
		a.element.find("*").andSelf().filter("b,strong").each(function() {
			$(this).dmCss("font-weight", "bold")
		});
		a.element.find("*").andSelf().filter("u").each(function() {
			$(this).dmCss("text-decoration", "underline")
		});
		a.element.find("*").andSelf().filter("i").each(function() {
			$(this).dmCss("font-style", "italic")
		});
		a.element.find("*").andSelf().filter("center").each(function() {
			$(this).dmCss("text-align", "center")
		});
		a.element.find("*").andSelf().each(function() {
			$(this).removeAttr("style")
		});
		a.element.find("*").filter("h1,h2,h3,h4,h5,p,div").each(function() {
			if (0 < $(this).parents("h1,h2,h3,h4,h5,p,em,i,strong,b,u").length) {
				var a = $("\x3cspan\x3e" + $(this).html() + "\x3c/span\x3e");
				$(this).attr("class") && a.attr("class", $(this).attr("class"));
				$(this).attr("style") && a.attr("style", $(this).attr("style"));
				a.dmCss("display", "block !important");
				$(this).replaceWith(a);
				if (null != $(this).attr("class")) for (var d = 0; d < $(this).attr("class").split(" ").length; d++) a.addClass($(this).attr("class").split(" ")[d])
			}
		});
		a.fixSize();
		a._addToUndo(!1, e)
	},
	0)
};
RTEObject.prototype._getNextElement = function(a) {
	a = $(a);
	for (a = a.nextAll().first(); 0 < a.length && "none" == a.dmCss("display");) a = a.nextAll().first();
	return a
};
RTEObject.prototype._getPreviousElement = function(a) {
	a = $(a);
	for (a = a.prevAll().first(); 0 < a.length && "none" == a.dmCss("display");) a = a.prevAll().first();
	return a
};
RTEObject.prototype._getFirstDescendant = function(a) {
	for (a = $(a); 0 < a.children().length;) a = a.children().first();
	return a
};
RTEObject.prototype._setDisplayInline = function(a, e) {
	for (a = $(a); 0 < a.length;) e ? (a.first().dmCss("display", "inline"), a = a.children().first()) : (a.last().dmCss("display", "inline"), a = a.children().last())
};
RTEObject.prototype._cancelEvent = function(a) {
	a.preventDefault();
	a.stopPropagation()
};
RTEObject.prototype._descendantHasDisplayInline = function(a, e) {
	a = $(a);
	for (var d = !1; 0 < a.length && !(d = a.dmCss("display") && "inline" != a.dmCss("display"));) a = e ? a.children().first() : a.children().last();
	return d
};
RTEObject.prototype._isTextNode = function(a) {
	return a.nodeType == Node.TEXT_NODE || a.nodeType == Node.CDATA_SECTION_NODE || a.nodeType == Node.COMMENT_NODE
};
RTEObject.prototype.undoValuesEqual = function(a, e) {
	return a.snapshot == e.snapshot && a.rootStyle == e.rootStyle && a.rootClass == e.rootClass && a.pageCSS == e.pageCSS
};
function RTEUndoData(a, e, d, g) {
	this.snapshot = a;
	this.rootStyle = e;
	this.rootClass = d;
	this.pageCSS = g
}
RTEObject.prototype._clearUndo = function() {
	_RTE_ElementDebug && $.log("clearing undo");
	_RTE_ElementDebug && $.log("new stack");
	this._RTE_stack = [];
	this._RTE_redo_stack = [];
	this._addToUndo();
	$(".inlineRichTextEditor #undoBtn, .inlineRichTextEditor #redoBtn").addClass("disabled")
};
RTEObject.prototype._addToUndo = function(a, e) {
	var d = NEFW.PREVIEW.get(0).contentWindow,
	g = this.element.html(),
	j = this.element.attr("style"),
	k = this.element.attr("class"),
	l = this._RTE_stack[this._RTE_stack.length - 1],
	d = new RTEUndoData(g, j, k, d.getPageCSSToString());
	if (0 == this._RTE_stack.length || !this.undoValuesEqual(l, d)) {
		_RTE_ElementDebug && $.log("adding to stack");
		e && (0 < this._RTE_stack.length && e == this._RTE_stack[this._RTE_stack.length - 1].currentHtmlSnapshot) && (_RTE_ElementDebug && $.log("popping (htmlbefore equals current)"), this._RTE_stack.pop());
		this._RTE_stack.push(d);
		this._RTE_stack.length > RTE_UNDO_MAX_SIZE && (_RTE_ElementDebug && $.log("over max size"), this._RTE_stack.splice(0, 1));
		if (void 0 == a || a) this._RTE_redo_stack = [],
		$(".inlineRichTextEditor #redoBtn").addClass("disabled");
		1 < this._RTE_stack.length && $(".inlineRichTextEditor #undoBtn").removeClass("disabled")
	}
};
RTEObject.prototype._undo = function() {
	_RTE_ElementDebug && $.log("undo");
	if (null != _RTE_Element && 1 < this._RTE_stack.length) {
		var a = NEFW.PREVIEW.get(0).contentWindow,
		e = this.element.html();
		this._RTE_redo_stack.push({
			snapshot: e,
			rootStyle: this.element.attr("style"),
			rootClass: this.element.attr("class"),
			pageCSS: a.getPageCSSToString()
		});
		_RTE_ElementDebug && $.log("popping");
		this._RTE_stack.pop();
		a = this._RTE_stack[this._RTE_stack.length - 1];
		this.element.html(a.snapshot);
		a.rootClass && this.element.attr("class", a.rootClass);
		a.rootStyle ? this.element.attr("style", a.rootStyle) : this.element.removeAttr("style");
		NEFW.PREVIEW.contents().eq(0).find("#pagestyle").html(a.pageCSS);
		this.setControlsStates();
		1 >= this._RTE_stack.length && $(".inlineRichTextEditor #undoBtn").addClass("disabled");
		$(".inlineRichTextEditor #redoBtn").removeClass("disabled");
		$.dmNotify("paragraph undo done");
		this.fixSize()
	}
};
RTEObject.prototype._redo = function() {
	_RTE_ElementDebug && $.log("redo");
	if (null != _RTE_Element && 0 < this._RTE_redo_stack.length) {
		var a = this._RTE_redo_stack.pop();
		this.element.html(a.snapshot);
		a.rootClass ? this.element.attr("class", a.rootClass) : this.element.removeAttr("class");
		a.rootStyle ? this.element.attr("style", a.rootStyle) : this.element.removeAttr("style");
		NEFW.PREVIEW.contents().eq(0).find("#pagestyle").html(a.pageCSS);
		this.setControlsStates();
		this._addToUndo(!1);
		$(".inlineRichTextEditor #undoBtn").removeClass("disabled");
		$.dmNotify("paragraph redo done");
		this.fixSize()
	}
};
function randomXToY(a, e) {
	var d = a + Math.random() * (e - a);
	return Math.round(d)
} (function(a) {
	var e = "#ad;#ad *;#mobileFooter *;#mobileFooter;.dmHome *;.dmHome;#backToHomePlaceHolder;:not(.dmContent, .dmContent *, .dmHeader, .dmHeader *, .dmFooter, .dmFooter *, .dmBody, .dmBody *, .freeHeader, .freeHeader *, .freeFooter, .freeFooter *);.inlineEditorDraggingScrollUpIndicatorWrapper;.inlineEditorDraggingScrollUpIndicatorWrapper *;.inlineEditorDraggingScrollDownIndicatorWrapper;.inlineEditorDraggingScrollDownIndicatorWrapper *;.inlineEditorDraggingPlaceHolder;.inlineEditorDraggingPlaceHolder*;.dmDrag;.expandableParent;.expandableNavigationContainer;.expandableNavigationContainer *;.dmNoScollableBody .freeHeader;.dmNoScollableBody .freeHeader *;.dmScollableBody .fixedHeaderLimitSize .freeHeader;.dmScollableBody .fixedHeaderLimitSize .freeHeader *;.dmTmplTitle;.dmTmplTitle *;.noneDroppableArea;.noneDroppableArea *".split(";");
	"ONE" == dm_current_editor && (e = e.concat(["*:has(.dmRespCol)", ".dmDraggedDomElementScaled", ".dmRespColResizer", ".dmConsiderOutElement", "[dmle_clear\x3d'true']"]));
	var d = "div p ul ol form table h1 h2 h3 h4 h5 h6 hr".split(" "),
	g = "strong a i b u input select textarea span p h1 h2 h3 h4 h5 h6 hr em".split(" "),
	j = [".dmColumn \x3e div.divider"],
	k = [];
	k.form = ["form"];
	k.a = ["a"];
	k.p = ["p"];
	k.div = "p h1 h2 h3 h4 h5 h6".split(" ");
	k.h1 = ["p"];
	k.h2 = ["p"];
	k.h3 = ["p"];
	k.h4 = ["p"];
	k.hr = ["p"];
	k.embed = ["em"];
	var l = [];
	l.td = ["tr"];
	l.tr = ["table", "tbody", "thead", "tfoot"];
	l.tfoot = ["table"];
	l.thead = ["table"];
	l.li = ["ul", "ol"];
	var m = [];
	m.tr = ["td", "th"];
	m.table = ["tr", "tbody", "thead", "tfoot"];
	m.tbody = ["tr"];
	m.thead = ["tr"];
	m.tfoot = ["tr"];
	a.extend({
		getTagName: function(a) {
			return a.is("[dmle_table]") ? a.attr("dmle_table") : a.get(0).tagName.toLowerCase()
		},
		isLegalDropArea: function(d) {
			d = a(d);
			var g = !0;
			d.dmid() || (g = !1);
			g && a.each(e,
			function(a, e) {
				d.is(e) && (g = !1)
			});
			return g
		},
		illegalParent: function(a, d, e) {
			null == e && (e = "");
			if ("a" == a && "li" == d && -1 != e.indexOf("dm_navGroup")) return ! 0;
			a = k[a];
			return null != a && -1 != a.indexOf(d) ? !0 : !1
		},
		isExpectedChild: function(a, d) {
			var e = m[d];
			return null != e ? -1 != e.indexOf(a) : !0
		},
		hasMandatoryParent: function(a, d) {
			var e = l[a];
			return null != e ? -1 != e.indexOf(d) : !0
		},
		isLegalInside: function(e, j, k, m) {
			m = m.substr(m.indexOf("-") + 1, m.length);
			null == e && (e = a("\x3cdiv\x3e\x3c/div\x3e"));
			e = a.getTagName(e);
			var l = a.getTagName(k),
			B = k.attr("id");
			return - 1 != d.indexOf(e) && -1 != g.indexOf(l) || a.illegalParent(e, l, B) || !a.isExpectedChild(e, l) || !a.hasMandatoryParent(e, l) || !("top" == m && j.allowedOperations(k, _DragManager.getDraggedKey()).insertInsideTop || "bottom" == m && j.allowedOperations(k, _DragManager.getDraggedKey()).insertInsideBottom) ? !1 : !0
		},
		isLegalOutside: function(d, e, g, j) {
			j = j.substr(j.indexOf("-") + 1, j.length);
			if (! ("top" == j && e.allowedOperations(g, _DragManager.getDraggedKey()).insertBefore || "bottom" == j && e.allowedOperations(g, _DragManager.getDraggedKey()).insertAfter)) return ! 1;
			var k = "div";
			null != d && (k = a.getTagName(d));
			d = a.getTagName(g.parent());
			var m = g.attr("id");
			if (!a.isExpectedChild(k, d) || !a.hasMandatoryParent(k, d)) return ! 1;
			ret = !0;
			g.parents().each(function() {
				var d = a.getTagName(a(this));
				if (a.illegalParent(k, d, m)) return ret = !1
			});
			return ret
		},
		isBasicLegalCheck: function(a, d, e) {
			a = !0;
			if (e && (d.isFixedHeaderElement() || d.isFixedFooterElement())) console.log("false position"),
			a = !1;
			return a
		},
		hasDefaultMove: function(d) {
			d = a(d);
			var e = !1;
			a.each(j,
			function(a, g) {
				d.is(g) && (e = !0)
			});
			return e
		}
	})
})(jQuery); (function(a) {
	var e = ".dmNotSelectableElement;.dmNotSelectableContainer;.dmNotSelectableContainer *;#ad;#ad *;#mobileFooter *;#mobileFooter;.dmHome *;.dmHome;.dmBody;:not(.dmOuter *);.allWrapper:not(.dmBlogInnerPostPage);.innerBar:not(.dm-bfs .innerBar)".split(";");
	"ONE" == dm_current_editor && (e = e.concat(".dmRespCol;.dmRespColResizer;.dmContent;.dmRespColsWrapper;.dmRespDesignRow;.dmRespRowsWrapper;* .dmNavigationWithLink;#innerBar".split(";")));
	a.extend({
		isLegalSelection: function(d, g) {
			g = g || {};
			var j = e;
			g.additionalIllegalSelections && (j = j.concat(g.additionalIllegalSelections));
			d = a(d);
			var k = !0;
			a.each(j,
			function(a, e) {
				d.is(e) && (k = !1)
			});
			d.dmid() || (k = !1);
			return ! 0 == g.multipleRemoveSelection && d.is(".dmContent") ? !1 : k
		}
	})
})(jQuery); (function(a) {
	var e = ".ui-facebook .albums .strip .prev;.ui-facebook .albums .strip .next;.dmMorePostsButton *;.dmMorePostsButton;.dmMore;.dmMore *;.dmLess;.dmLess *;#returnToMenuButtonElement;#flickr_badge_uber_wrapper;#flickr_badge_uber_wrapper *;.flexslider .flex-direction-nav li .prev;.flexslider .flex-direction-nav li .next;.dmPhotoGallery .photoGalleryViewAll;.dmImageSlider .flex-prev;.dmImageSlider .flex-next".split(";"),
	d = [],
	g = [];
	a(document).ready(function() {
		a.dmfw.isUseNewSelectionContext()
	});
	a.extend({
		isLegalFireClick: function(d) {
			d = a(d);
			var g = !0;
			a.each(e,
			function(a, e) {
				d.is(e) && (g = !1)
			});
			return g
		},
		isLegalFireHover: function(e) {
			e = a(e);
			var k = !0,
			l = a.dmfw.isPT() ? g: d;
			a.each(l,
			function(a, d) {
				e.is(d) && (k = !1)
			});
			return k
		}
	})
})(jQuery); (function(a) {
	a.fn.neeEditorTabs = function(e) {
		var d = this,
		g = [],
		j = e.tabs,
		k = a(this).find(".leftPanel"),
		l = a(this).find(".rightPanel"),
		m = a.dmx.current.editable && a.dmx.current.editable.widget && a.dmx.current.editable.widget.defaults && a.dmx.current.editable.widget.defaults.needs_premium_validation; (a.dmx.current.editable && a.dmx.current.editable.ext && a.dmx.current.editable.ext.defaults && a.dmx.current.editable.ext.defaults.needs_premium_validation || m) && k.find(".leftPanelPremiumRibbon").show();
		var n = j.type.filter(function(a) {
			return ! ("function" === typeof a.hideIf && a.hideIf())
		}),
		j = n.length;
		e = e.initTab || 0;
		e >= j && (e = 0);
		for (m = 0; m < j; m++) {
			var o = a('\x3cdiv class\x3d"slideBtn"\x3e\x3c/div\x3e');
			o.attr("id", m);
			var r = a('\x3cdiv class\x3d"slideBtnIcon"\x3e\x3c/div\x3e');
			r.addClass(n[m].imgSrc);
			a.dmfw.isDudaone() && r.addClass("dm-icon-" + n[m].imgSrc);
			o.append(r);
			var r = a('\x3cdiv class\x3d"slideBtnText"\x3e\x3c/div\x3e'),
			u = n[m].text; - 1 != u.indexOf("^") && (u = "\x3cspan\x3e" + u.replace("^", "\x3c/span\x3e\x3cspan\x3e") + "\x3c/span\x3e");
			r.append(u);
			o.append(r);
			g[m] = o;
			k.append(o);
			o.click(function(e) {
				if (a.dmx.editor.valid) {
					d.find(".applyButton").hide();
					var j = function() {
						for (var d = 0; d < n.length; d++) g[d].removeClass("slideBtnSelected"),
						g[d].find(".slideBtnIcon").removeClass("tebSelected");
						var j = Number(e.currentTarget.id),
						d = n[j].url,
						k = l.closest("#_editor");
						g[j].addClass("slideBtnSelected");
						g[j].find(".slideBtnIcon").addClass("tebSelected");
						l.empty();
						l.addClass("rightPanelLoaded");
						n[j].loadTab ? (n[j].loadTab(l), k.attr("data-selected-main-tab", n[j].text), k.attr("data-selected-secondary-tab", "none")) : a.dmLoad(l, d,
						function() {
							a.dmx.editor.valid = !0;
							l.show();
							if (n[j].onTabReady) {
								var d = n[j].onTabReady;
								n[j].toReturn ? d(l, n[j].toReturn) : d(l)
							}
							l.find("input").placeholder();
							k.attr("data-selected-main-tab", n[j].text);
							k.attr("data-selected-secondary-tab", "none")
						})
					},
					k = !1,
					m = d.find(".slideBtnSelected");
					0 < m.length && (m = m.attr("id"), m = n[m].onTabClose, 0 < d.find("#currentColorExample").length && d.neeAddColorsToSite([d.find("#currentColorExample").css("background-color")]), m && (k = !0, m(l, j)));
					k || (0 < d.find("#currentColorExample").length && d.neeAddColorsToSite([d.find("#currentColorExample").css("background-color")]), j())
				}
			})
		}
		g[e].trigger("click");
		return g
	};
	a.fn.neePagingWidget = function(e, d, g, j, k) {
		function l() {
			u.find(".neePagingBottom").empty();
			var d = r[0].clone(!0);
			u.append(d);
			var e = u.calculateElementsPerPage(a(v), d, null, j),
			e = Math.ceil(r.length / e);
			a(d).remove();
			G && k.empty && G.addClass("onePager");
			u.toggleClass("onePageOnly", 1 == e);
			for (var d = a('\x3cdiv class\x3d"pagingNumbersWrapperDiv"\x3e\x3c/div\x3e').addClass("paginfLeftNumbers").appendTo(G), g = 0; g < e; g++) {
				var m = a('\x3cdiv class\x3d"pagingNumbersWrapperDiv"\x3e\x3c/div\x3e').addClass("paginfCubeNumbers").html(g + 1).attr("currNum", g).appendTo(G);
				B[g] = m
			}
			e = a('\x3cdiv class\x3d"pagingNumbersWrapperDiv"\x3e\x3c/div\x3e').addClass("paginfRightNumbers").appendTo(G);
			a.dmfw.isDudaone() ? (d.addClass("dm-icon-left"), e.addClass("dm-icon-right")) : (d.html("\x3c"), e.html("\x3e"));
			e.unbind("click").click(function(d) {
				d.stopPropagation();
				a(this).hasClass("showAsDisable") || n(s + 1)
			});
			d.unbind("click").click(function(d) {
				d.stopPropagation();
				a(this).hasClass("showAsDisable") || n(s - 1)
			});
			u.find(".paginfCubeNumbers").unbind("click").click(function(d) {
				u.find(".pagingNumbersWrapperDiv").removeClass("selected");
				a(this).addClass("selected");
				d = Number(a(d.currentTarget).attr("currnum"));
				n(d)
			})
		}
		function m(d, e) {
			u.find(".pagingNumbersWrapperDiv").removeClass("selected");
			a(e).addClass("selected")
		}
		function n(d) {
			if ( - 1 < d && null != r && r != []) {
				if (r.length > K * d) {
					for (var e = K * s,
					g = e; g < e + K && g < r.length; g++) r[g].data("paged");
					z.children().detach();
					z.hide();
					z.prepend(o(r, d));
					z.fadeIn("fast");
					s = d
				}
				0 === d ? (0 < u.find(".neePagingLeftArrow").length && u.find(".neePagingLeftArrow").addClass("showAsDisable"), 0 < u.find(".paginfLeftNumbers").length && u.find(".paginfLeftNumbers").addClass("showAsDisable")) : (0 < u.find(".neePagingLeftArrow").length && u.find(".neePagingLeftArrow").removeClass("showAsDisable"), 0 < u.find(".paginfLeftNumbers").length && u.find(".paginfLeftNumbers").removeClass("showAsDisable"));
				r.length <= K * (d + 1) ? (0 < u.find(".neePagingRightArrow").length && u.find(".neePagingRightArrow").addClass("showAsDisable"), 0 < u.find(".paginfRightNumbers").length && u.find(".paginfRightNumbers").addClass("showAsDisable")) : (0 < u.find(".neePagingRightArrow").length && a(".neePagingRightArrow").removeClass("showAsDisable"), 0 < u.find(".paginfRightNumbers").length && u.find(".paginfRightNumbers").removeClass("showAsDisable"));
				0 < u.find(".pagingNumbersWrapperDiv").length && m(d, B[d])
			}
		}
		function o(d, e) {
			for (var g = a("\x3cdiv\x3e\x3c/div\x3e"), j = e * K, k = Math.min(j + K, d.length); j < k; j++) {
				var m = d[j],
				n;
				n = d[j];
				a(m).data("paged", n);
				g.append(n)
			}
			g.append('\x3cdiv style\x3d"clear:both;"');
			return g
		}
		k = k || {};
		var r = e,
		u = this;
		if (0 != r.length) {
			d > r.length && (d = null);
			var s = 0,
			B = [];
			e = a('\x3cdiv  id\x3d"neePagingWidget" class\x3d"neePagingWidget neeNoMark"\x3e\x3c/div\x3e');
			var z = a('\x3cdiv  id\x3d"neePagingContent" class\x3d"neePagingContent"\x3e\x3c/div\x3e'),
			v = a('\x3cdiv  id\x3d"neePagingContentWrapper" class\x3d"neePagingContentWrapper"\x3e\x3c/div\x3e');
			this.append(e);
			a.dmfw.isDudaone() && e.addClass("onePagingWidget");
			if ("arrows" == g || "both" == g) {
				var D = a('\x3cdiv class\x3d"neePagingLeftSide"\x3e\x3c/div\x3e'),
				E = a('\x3cdiv class\x3d"neePagingLeftArrow"\x3e\x3c/div\x3e');
				D.append(E);
				var F = a('\x3cdiv class\x3d"neePagingRightSide"\x3e\x3c/div\x3e'),
				I = a('\x3cdiv class\x3d"neePagingRightArrow"\x3e\x3c/div\x3e');
				F.append(I);
				e.append(D).append(v).append(F).append(a('\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e'));
				v.css("width", this.width() - 2 * (I.width() + 5) + "px");
				v.css("height", this.height());
				v.append(z);
				D = Math.floor(this.height() / 2) - Math.floor(I.height() / 2) + "px";
				I.css("margin-top", D);
				E.css("margin-top", D);
				I.unbind("click").click(function() {
					a(this).hasClass("showAsDisable") || n(s + 1)
				});
				E.unbind("click").click(function() {
					a(this).hasClass("showAsDisable") || n(s - 1)
				})
			}
			if ("numbers" == g || "both" == g) {
				var G = a('\x3cdiv class\x3d"neePagingBottom"\x3e\x3c/div\x3e');
				"both" != g ? (e.append(v).append(a('\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e')).append(G), v.css("width", this.width()), v.css("height", this.height()), v.append(z)) : e.append(a('\x3cdiv style\x3d"clear:both;"\x3e\x3c/div\x3e')).append(G);
				l()
			}
			e = r[0].clone(!0);
			this.append(e);
			var K = this.calculateElementsPerPage(a(v), e,
			function(a, d) {
				z.css("width", a + "px");
				z.css("height", d + "px");
				var e = Math.floor((v.width() - a) / 2);
				z.css("width", z.width() + e + "px");
				z.css("margin-left", e + "px")
			},
			j);
			a(e).remove();
			d && (s = Math.floor(d / K));
			n(s); ("numbers" == g || "both" == g) && s <= B.length && m(s, B[s]);
			u.redrawPaging = function() {
				l()
			};
			return u
		}
	};
	a.fn.calculateElementsPerPage = function(a, d, g, j) {
		elementWidth = d.outerWidth(!0);
		elementHeight = d.outerHeight(!0);
		d = parseInt(a.width());
		a = parseInt(a.height());
		d = d < elementWidth ? 1 : Math.floor(d / elementWidth);
		a < elementHeight ? a = 1 : (a = Math.floor(a / elementHeight), j && a > j && (a = j));
		g && g(d * elementWidth, a * elementHeight);
		return d * a
	};
	a.fn.changeCss = function(e) {
		var d = this;
		a.each(e,
		function(g) {
			e.classesToRemove && "classesToRemove" == g ? a.each(e.classesToRemove,
			function(a, e) {
				d.removeClass(e)
			}) : e.attributesToRemoveFromElement && "attributesToRemoveFromElement" == g ? a.each(e.attributesToRemoveFromElement,
			function(a, e) {
				d.removeAttr(e)
			}) : e.attrToRemove && "attrToRemove" == g ? a.each(e.attrToRemove,
			function(a, e) {
				try {
					d.dmCss(e, "")
				} catch(g) {}
			}) : e.classesToAdd && "classesToAdd" == g ? a.each(e.classesToAdd,
			function(a, e) {
				d.addClass(e)
			}) : e.attributesToAddToElement && "attributesToAddToElement" == g ? a.each(e.attributesToAddToElement,
			function(a, e) {
				d.attr(e.attr, e.value)
			}) : e.attrToAdd && "attrToAdd" == g && a.each(e.attrToAdd,
			function(a, e) {
				d.dmCss(e.attr, e.value + " !important")
			})
		})
	};
	a.fn.clearStyle = function(e) {
		var d = {
			"border-width": ["border-top-width", "border-bottom-width", "border-left-width", "border-right-width"],
			"border-color": ["border-top-color", "border-bottom-color", "border-left-color", "border-right-color"],
			"border-style": ["border-top-style", "border-bottom-style", "border-left-style", "border-right-style"]
		},
		g = this;
		a.each(e,
		function(j) {
			e.attrToRemove && "attrToRemove" == j ? a.each(e.attrToRemove,
			function(a, e) {
				try {
					g.css(e, "");
					var j = d[e];
					if (j) for (var n = 0; n < j.length; n++) g.css(j[n], "")
				} catch(o) {}
			}) : e.attrToAdd && "attrToAdd" == j && a.each(e.attrToAdd,
			function(a, e) {
				g.css(e.attr, "");
				var j = d[e.attr];
				if (j) for (var n = 0; n < j.length; n++) g.css(j[n], "")
			})
		})
	};
	a.fn.fadeBackground = function(e) {
		a.each(e,
		function(d, e) {
			a(e).addClass("neeKeepUnfaded")
		});
		this.addClass("neeFade")
	};
	a.fn.unFadeBackground = function(e) {
		a.each(e,
		function(d, e) {
			a(e).removeClass("neeKeepUnfaded")
		});
		this.removeClass("neeFade")
	};
	a.fn.neeSecondaryTabsControl = function(e, d, g) {
		var j = this,
		k = [],
		l = e.length;
		0 < a(j).find(".rightPanelTabsWrapper").length && a(j).find(".rightPanelTabsWrapper").remove();
		for (var m = a('\x3cdiv class\x3d"rightPanelTabsWrapper"\x3e\x3c/div\x3e'), n = 0; n < l; n++) {
			var o = a('\x3cdiv class\x3d"rightPanelTab"\x3e\x3c/div\x3e');
			o.attr("id", n);
			o.attr("identifier", e[n].identifier ? e[n].identifier: e[n].id);
			o.html(e[n].name.replace("^", " "));
			k[n] = o;
			o.appendTo(m);
			o.click(function(d) {
				var m = j.find(".slideRightPanelInner").eq(0),
				n = e[a(this).attr("id")];
				j.closest(".buttonTab").find(".applyButton").hide();
				var l = Number(d.currentTarget.id);
				d = e[l].url;
				a(k).each(function() {
					if (a(this).hasClass("tabSelect") && n.onClose) n.onClose()
				});
				for (var o = 0; o < e.length; o++) k[o].attr("class", "rightPanelTab");
				k[l].toggleClass("tabSelect");
				m.html("");
				g && (m.removeClass("allowSelectEnlargeDelete").removeClass("allowSelectEnlarge").removeClass("allowSelectOnly"), a.dmfw.isDudaone() && n.singleItemButtons ? n.singleItemButtons.enlargeButton && n.singleItemButtons.deleteButton ? m.addClass("allowSelectEnlargeDelete") : n.singleItemButtons.enlargeButton && !n.singleItemButtons.deleteButton && m.addClass("allowSelectEnlarge") : m.addClass("allowSelectOnly"));
				var v = m.closest("#_editor");
				m.attr("data-current-tab", a(this).attr("identifier"));
				a.dmLoad(m, d,
				function() { (a.dmfw.isPT() || a.dmfw.isDudaone()) && m.fadeIn();
					if (e[l].toReturn) e[l].onReady(e[l].toReturn);
					else e[l].onReady();
					v.attr("data-selected-secondary-tab", e[l].id)
				})
			})
		}
		a.dmfw.isDudaone() && j.is(".oneImagePicker") ? j.find(".oneImagePickerPopupHeader").after(m) : m.prependTo(j); (a.dmfw.isPT() || a.dmfw.isDudaone()) && 1 == e.length && m.addClass("displayNone").parent().addClass("showUpperTabLines");
		null != d ? k[d].trigger("click") : k[0].trigger("click")
	};
	a.fn.neeThirdTabControl = function(e) {
		var d = [],
		g = a('\x3cdiv id\x3d"thirdTabWrapper"\x3e\x3c/div\x3e').prependTo(this),
		j = e.tabs.length;
		this.find("#thirdTabWrapper").toggleClass("dmManyTabs", 3 < j);
		for (var k = 0; k < j; k++) {
			var l = a('\x3cspan class\x3d"ThirdTabInsideFilter ColorTabInsideFilter"\x3e\x3c/span\x3e').html(e.tabs[k].name.replace("^", " ")).attr("currNum", k);
			l.appendTo(g);
			d[k] = l;
			l.click(function(d) {
				currNum = d = Number(a(d.currentTarget).attr("currnum"));
				a(".ThirdTabInsideFilter").removeClass("ColorTabInsideFilterSelected");
				a(this).addClass("ColorTabInsideFilterSelected"); (a.dmfw.isPT() || a.dmfw.isDudaone()) && a(".slideRightPanelInner #placementForColorPickerColor").remove();
				e.callback && (e.tabs[d].toReturn ? e.callback(e.tabs[d].toReturn) : e.tabs[d].callback ? e.tabs[d].callback() : e.callback())
			})
		}
		d[0].trigger("click")
	};
	a.fn.neeAddBackgroundImagePlaceholder = function(e) {
		var d = this;
		if (a.dmfw.isPT() || a.dmfw.isDudaone()) d.ptAddBackgroundImagePlaceholder(e);
		else {
			var g = e.selector ? e.elem.find(e.selector) : e.elem,
			j = function(j) {
				if (j) {
					var o = d.parent().parent().parent().find(".openImagePickerPopUpWrapper").clone();
					o.find(".slideRightPanelInner").empty();
					d.find("#openPageBackgroundId").neePopUpDiv(o, a.extend({
						init: m,
						toChangeFunction: n,
						showIphone: !0
					},
					e))
				}
				o = g.css("background-image");
				if (0 < g.length && "" != o && "url(http://localhost:8080/non)" != o && "none" != o && -1 != o.indexOf("url(") && -1 == o.indexOf("svg+")) if (o = g.css("background-image"), o.startsWith("url")) {
					var r = o.indexOf("url(") + 4,
					z = o.indexOf(")"),
					o = o.substring(r, z);
					o.startsWith('"') && (o = o.substring(1, o.length - 1));
					k(o)
				} else k(o, !0);
				else l();
				j && d.find(".removeBgBtn").unbind("click").click(function() {
					l();
					var d = {
						classesToRemove: null,
						attrToRemove: null,
						attrToAdd: [{
							attr: "background-image",
							value: "none"
						}],
						classesToAdd: null
					};
					if (e.changeGlobally) {
						var g = e.forceClassName;
						g && a.dmops.updateGlobalCssAndElement(d, {
							className: g,
							clientOnly: !1
						})
					} else a.dmops.updateCurrentCss(d, e);
					e.callbackremove && e.callbackremove()
				})
			},
			k = function(d, e) {
				var g = function(g) { ! 1 == g ? l() : (bg = "url(" + d + ")", e && (bg = d), a(".favIconIphoneWrapper .imgBgPreviewImg").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", bg), a(".favIconIphoneWrapper .removeBgBtn").css("visibility", "inherit"), a(".favIconIphoneWrapper .noIcon").css("visibility", "hidden"), a(".favIconIphoneWrapper .vIcon").show())
				};
				a("\x3cimg\x3e", {
					src: d,
					load: function() {
						g(!0)
					},
					error: function() {
						g(!1)
					}
				})
			},
			l = function() {
				a(".favIconIphoneWrapper .imgBgPreviewImg").addClass("noImageInBackground").removeClass("imageDetected").attr("style", "");
				a(".favIconIphoneWrapper .removeBgBtn").css("visibility", "hidden");
				a(".favIconIphoneWrapper .noIcon").css("visibility", "inherit");
				a(".favIconIphoneWrapper .vIcon").hide()
			},
			m = function(a) {
				a.neeSecondaryIconTabs({
					tabs: {
						bgimage: [{
							uploadBiggerButton: !0
						}],
						upload: [{
							isChange: !1
						}],
						original_images: [],
						url: []
					},
					callback: n,
					forceClassName: e.forceClassName,
					changeGlobally: !0,
					selector: e.selector,
					uploadBiggerButton: !0,
					uponRemoveImage: function() {
						j(!1)
					}
				})
			},
			n = function(d) {
				k(d);
				if (e.callback) {
					var g = a.extend({},
					e);
					g.callback = null;
					e.callback(d, !1, g)
				}
				a(".popupWinExample").find("#3.rightPanelTab").click()
			};
			if (0 === d.find(".favIconIphoneText").length) {
				var o = a("\x3cdiv\x3e\x3c/div\x3e");
				o.appendTo(d).addClass("favIconIphoneWrapper").addClass("showImageBackPrev");
				var r = a('\x3cdiv class\x3d"favIconIphoneText"\x3e\x3c/div\x3e').appendTo(o);
				a('\x3cdiv class\x3d"favIconIphoneTextTitle"\x3e\x3c/div\x3e').html(dmStr["ui.nee.common.design.4"]).appendTo(r);
				a('\x3cdiv class\x3d"favIconIphoneTextContent"\x3e\x3c/div\x3e').html(dmStr["ui.nee.common.design.6"]).appendTo(r);
				r = a('\x3cdiv class\x3d"imgBtnWrapper"\x3e\x3c/div\x3e').appendTo(r);
				a('\x3cspan class\x3d"setImg blueBtn"\x3e' + dmStr["ui.nee.imagePicker.18"].toUpperCase() + "\x3c/span\x3e").attr("id", "openPageBackgroundId").appendTo(r);
				a('\x3cspan class\x3d"removeBgBtn blueBtn"\x3e' + dmStr["ui.remove"].toUpperCase() + "\x3c/span\x3e").appendTo(r);
				o = a('\x3cdiv class\x3d"iconPreviewWrapper"\x3e\x3c/div\x3e').appendTo(o);
				a('\x3cdiv class\x3d"noIcon"\x3e' + dmStr["ui.nee.common.design.7"] + "\x3c/div\x3e").appendTo(o);
				a('\x3cdiv class\x3d"vIcon"\x3e\x3c/div\x3e').appendTo(o);
				a('\x3cdiv class\x3d"imgBgPreviewImg noImageInBackground"\x3e\x3c/div\x3e').appendTo(o)
			}
			j(!0)
		}
	};
	a.fn.neeChangeTextSize = function(e, d, g) {
		g = g || {};
		var j = this;
		0 === j.find("#designTextInput").length && a.dmLoad(j, "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
		function() {
			j.neeChangeTextSize(e, d)
		});
		e || (e = 16);
		isNaN(e) && -1 != e.toLowerCase().indexOf("px") && (e = e.substr(0, e.length - 2));
		this.find("#sliderText").slider({
			range: "min",
			value: e,
			min: g.textMinSize ? g.textMinSize: 6,
			max: g.textMaxSize ? g.textMaxSize: 72,
			slide: function(a, d) {
				j.find("#designTextInput").val(d.value + "px");
				j.find("#textExample").css("font-size", d.value)
			},
			stop: function(a, e) {
				d(e.value + "px")
			}
		});
		this.find("#designTextInput").val(this.find("#sliderText").slider("value") + "px");
		this.find("#textExample").css("font-size", this.find("#sliderText").slider("value"));
		this.find('[id^\x3d"designTextInput"]').blur(function() {
			k()
		});
		this.find('[id^\x3d"designTextInput"]').keypress(function(a) {
			13 == a.keyCode && k()
		});
		var k = function() {
			var e = parseInt(a("#designTextInput").val(), 10);
			72 < e ? alert("the font is too big, max font is 72") : 6 > e ? alert("the font is too small, min font is 6") : j.find("#sliderText").slider("option", "value", e);
			j.find("#designTextInput").val(j.find("#sliderText").slider("value") + "px");
			j.find("#textExample").css("font-size", j.find("#sliderText").slider("value"));
			d(j.find("#sliderText").slider("value") + "px")
		}
	};
	a.fn.neeChangeFontFamily = function(e, d) {
		var g = this;
		e || (e = "Arial");
		0 === g.find("#currentFont").length && a.dmLoad(g, "/editor/nee/mainTabs/neeDesign/nee.designHtmlFontFamily.jsp",
		function() {
			g.neeChangeFontFamily(e, d)
		}); - 1 != e.indexOf("'") && (e = e.substr(1, e.length - 2)); - 1 != e.indexOf(",") && (e = e.replace(/,/g, ""));
		g.find("#currentFont").html(e.charAt(0).toUpperCase() + e.slice(1));
		g.find(".changebleFont").each(function() {
			e.toLowerCase() == a(this).html().toLowerCase() && a(this).css("color", "#FF6600")
		});
		g.find(".changebleFont").click(function(e) {
			g.find(".changebleFont").css("color", "");
			a(e.currentTarget).css("color", "orange");
			e = a(e.currentTarget).attr("dmff") || a(e.currentTarget).html();
			g.find("#currentFont").html(e);
			d("'" + e + "'")
		})
	};
	a.fn.neeOpenColorPicker = function(e, d, g) {
		a("#colorPickerWidget").remove(); - 1 == e.indexOf("#") && (e = a.rgb2hex(e));
		var j = this,
		k = a.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/siteColors/one.colorPicker.jsp": "/editor/nee/utils/newColorPicker/newColorPicker.jsp";
		j.show("fast");
		getCurrentColorFromCurrentElementToShow = function() {
			return e
		};
		a.dmLoad(j, k,
		function() {
			fixGradientImg();
			new dragObject("arrows", "hueBarDiv", arrowsLowBounds, arrowsUpBounds, arrowsDown, arrowsMoved, endMovement);
			new dragObject("circle", "gradientBox", circleLowBounds, circleUpBounds, circleDown, circleMoved, endMovement);
			colorChanged("box");
			g && (j.find("#gradientBox").mousedown(function() {
				j.find("#gradientBox").mousemove(function() {
					g(j.find("#thisColorBox #quickColor").css("background-color"))
				});
				g(j.find("#thisColorBox #quickColor").css("background-color"))
			}), j.find("#cancelBtn, #closeBtnCP").click(function() {
				j.empty();
				j.hide();
				g(e, !0)
			}));
			j.find("#doneBtn").click(function() {
				var a = j.find("#staticColor").css("background-color");
				j.empty();
				j.hide("fast");
				d(a)
			});
			j.find("#cancelBtn, #closeBtnCP").click(function() {
				j.empty();
				j.hide()
			})
		})
	};
	a.fn.neePopUpDiv = function(e, d) {
		function g(e) {
			function g(a) {
				var d;
				d = window.innerHeight ? window.innerHeight || screen.height: document.body.clientHeight || screen.height;
				yWithScroll = window.innerHeight && window.scrollMaxY ? window.innerHeight + window.scrollMaxY: document.body.scrollHeight > document.body.offsetHeight ? document.body.scrollHeight: document.body.offsetHeight;
				return a ? d: yWithScroll ? yWithScroll: d
			}
			var j = g();
			d.isConfirm && !d.dontRemoveCurrent && a("body").find(".popupWinExampleMask").remove();
			var n = 0 < navigator.userAgent.indexOf("Mac") ? " mac": "";
			d = d || {}; ! d.dontRemoveCurrent && 0 < a("body").find(".popupWinExampleMask").length && a("body").find(".popupWinExampleMask").remove();
			"undefined" == typeof d.classes && (d.classes = "");
			var o = a('\x3cdiv id\x3d"popupWinExampleMask" class\x3d"popupWinExampleMask' + n + " " + d.classes + '"\x3e\x3c/div\x3e').appendTo("body"),
			r = a('\x3cdiv class\x3d"popupWinExample"\x3e\x3c/div\x3e').appendTo(o),
			u = a('\x3cdiv class\x3d"closeThis"\x3e\x3c/div\x3e').appendTo(r);
			d && (d.showMindTouchHelp && a.ptMindTouch) && (n = a('\x3cdiv class\x3d"mindTouchHelp dm-iconquestion F1"\x3e\x3c/div\x3e'), n.attr("id", d.mindTouchId), d.mindTouchStyle && n.addClass(d.mindTouchStyle), n.appendTo(r), a.ptMindTouch.showHelp(n)); (a.dmfw.isPT() || a.dmfw.isDudaone()) && u.addClass("dm-icon-x2");
			r.append(e);
			d.popupAdditionalClass && r.addClass(d.popupAdditionalClass);
			o.css("height", j + "px");
			j = e.outerWidth() + (d.wide ? 100 : 0) + "px";
			d.isConfirm && (j = e.find(".confirmDeleteText").outerWidth() + (d.wide ? 100 : 0) + "px");
			d.maxScreenSize && (j = (0 < window.innerWidth ? window.innerWidth: screen.width) - 150 + "px");
			j = d.forceWidth ? d.forceWidth: j;
			r.css("width", j);
			j = e.outerHeight() + "px";
			d.maxScreenSize && (j = (0 < window.innerHeight ? window.innerHeight: screen.height) - 150 + "px", r.css("margin", "60px auto"), o.css("z-index", "2001"));
			j = d.forceHeight ? d.forceHeight: j;
			r.css("height", j);
			j = g(!0) / 2 - parseInt(r.css("height")) / 2 - 30;
			r.css("margin-top", 20 < j ? j + "px": "20px");
			a("html, body").animate({
				scrollTop: 0
			},
			"fast");
			d.dontCloseAutomatically && a(".popupWinExample").addClass("dontCloseAutomatically");
			d.showIphone && !a.dmfw.isDudaone() ? e.closest(".popupWinExample").position({
				my: "left",
				at: "right",
				offset: a.dmfw.isPT() ? "42 15": "15 15",
				of: "#_preview_w"
			}) : o.css("z-index", a.dmfw.isPT() ? "1001": "5001");
			e.show();
			d.disableDrag || r.draggable({
				drag: function() {
					a.dmfw.setPreviewEditPolicy && a.dmfw.setPreviewEditPolicy(!1)
				}
			});
			d.init && (d.toReturn ? d.init(d.toReturn, d) : d.init(e, d));
			u.unbind("click").click(function() {
				try {
					a.dmfw.setPreviewEditPolicy && (a.dmfw.isCurrenttabSupportRuntimeEdit() ? a.dmfw.setPreviewEditPolicy(!0) : a.dmfw.setPreviewEditPolicy(!1))
				} catch(g) {
					a.log(g)
				}
				d.maxScreenSize && o.css("z-index", "");
				d.popupAdditionalClass && r.removeClass(d.popupAdditionalClass);
				d.beforeClose && d.beforeClose(e);
				e.closest(".popupWinExampleMask").remove()
			});
			e.close = function() {
				u.trigger("click")
			}
		}
		var j = this;
		this.data("neePopUpDiv", {});
		d = d || {};
		d.isConfirm ? g(e) : a(this).unbind("click").click(function() {
			d.initBeforeClick && (d.toReturn ? d.initBeforeClick(d.toReturn) : d.initBeforeClick(j));
			g(e)
		})
	};
	a.fn.neeConfirmationPopUpDiv = function(e, d) {
		function g(g) {
			g.stopPropagation();
			var k = e;
			g = a('\x3cdiv class\x3d"confirmDeleteImage"\x3e\x3c/div\x3e');
			var l = d.yesStyle ? d.yesStyle: "",
			r = d.noStyle ? d.noStyle: "",
			u = d.yesClass ? d.yesClass: d.yesText ? "customText confirmDelete grayBtn": "confirmDelete grayBtn",
			s = d.noClass ? d.noClass: d.noText ? "customText blueBtn no": "notConfirmDelete blueBtn",
			l = d.yesText ? '\x3cspan id\x3d"confirmDelete" style\x3d\'' + l + "' class\x3d'" + u + "'\x3e" + d.yesText + "\x3c/span\x3e": '\x3cspan id\x3d"confirmDelete" style\x3d\'' + l + "' class\x3d'" + u + "'\x3e" + dmStr["ui.yes"].toUpperCase() + "\x3c/span\x3e",
			r = d.noText ? '\x3cspan id\x3d"notConfirmDelete" style\x3d\'' + r + "' class\x3d'" + s + "'\x3e" + d.noText + "\x3c/span\x3e": '\x3cspan id\x3d"notConfirmDelete" style\x3d\'' + r + "' class\x3d'" + s + "'\x3e" + dmStr["ui.no"].toUpperCase() + "\x3c/span\x3e";
			a('\x3cdiv class\x3d"confirmDeleteText"\x3e\x3c/div\x3e').appendTo(g).html(k);
			k = a('\x3cdiv class\x3d"confirmDeleteButtons"\x3e\x3c/div\x3e').appendTo(g);
			d.yesOnRight ? k.append(a(r)).append(a(l)) : k.append(a(l)).append(a(r));
			d.isConfirm = !0;
			j.neePopUpDiv(g, d);
			j.close || (j.close = function() {
				a("body").find(".popupWinExampleMask").hide()
			});
			a("body #notConfirmDelete").last().on("click",
			function(e) {
				a.dmfw.setPreviewEditPolicy && a.dmfw.setPreviewEditPolicy(!0);
				e.stopPropagation();
				a(this).closest(".popupWinExampleMask").hide();
				if (d.onNoCallback) d.onNoCallback(j)
			});
			a("body #confirmDelete").last().on("click",
			function(e) {
				a.dmfw.setPreviewEditPolicy && (a.dmfw.isCurrenttabSupportRuntimeEdit() ? a.dmfw.setPreviewEditPolicy(!0) : a.dmfw.setPreviewEditPolicy(!1));
				e.stopPropagation();
				a(this).closest(".popupWinExampleMask").hide();
				d.initCallback && (d.toReturn ? d.initCallback(d.toReturn) : d.initCallback(j))
			});
			if (d.bindCloseToNo) a(".popupWinExampleMask .closeThis").last().on("click",
			function(e) {
				a.log("x clicked");
				a.dmfw.setPreviewEditPolicy && a.dmfw.setPreviewEditPolicy(!0);
				e.stopPropagation();
				a(this).closest(".popupWinExampleMask").hide();
				if (d.onNoCallback) d.onNoCallback()
			})
		}
		var j = this;
		d = d || {};
		if (d.liveClick) {
			var k = j.attr("id") || j.attr("class").replaceAll(" ", "."),
			l = j.attr("id") ? "#": ".";
			a(document.body).off("click." + k);
			a(document.body).on("click." + k, l + k, g)
		} else a(j).on("click.gen", g);
		d.triggerNow && a(this).trigger("click")
	};
	a.fn.neeAddColorsToSite = function(e) {
		if (! (27 < a.dmx.site.colors.length) && !(1 > e.length)) {
			var d = e;
			for (e = 0; e < d.length; e++) d[e] = d[e] || "",
			d[e] = d[e].split(" ").join("");
			e = [];
			e = e.concat(d);
			for (var g = e.length,
			j = [], k = {},
			d = 0; d < g; d++) k[e[d]] = 0;
			for (d in k) j.push(d);
			e = j;
			d = [];
			for (g = 0; g < e.length; g++) - 1 == jQuery.inArray(e[g], a.dmx.site.colors) && (a.dmx.site.colors.push(e[g]), d.push(e[g]));
			0 < d.length && a.dmPost({
				url: "/sites/" + a.dmx.site.id + "/addrecentcolors",
				data: d
			})
		}
	};
	a.fn.dmQtip = function(e) {
		e = a.extend({
			position: {
				my: "left center",
				at: "right center"
			}
		},
		e, !0);
		var d = e.style && e.style.classes ? e.style.classes: "ui-tooltip-dm ui-tooltip-shadow";
		$this = a(this);
		$this.qtip({
			content: e.content,
			position: {
				my: e.position.my,
				at: e.position.at,
				target: $this
			},
			style: {
				classes: d
			},
			show: {
				target: $this
			}
		})
	};
	a.fn.dmColorOpacity = function(e) {
		e = e || {};
		var d;
		e.setColor ? (d = e.setColor, "#" == d.substring(0, 1) || "rgb(" == d.substring(0, 4) || "rgba(0,0,0,0)" == d.replace(/ /g, "") || "transparent" === d ? d = 100 : (d = d.split(","), 4 > d.length ? d = 100 : (d[3] = parseFloat(d[3]).toFixed(1), d = 100 * d[3]))) : d = 100;
		var g = a(this),
		j = g.find("#transInput"),
		k = function(a) {
			a.callback && a.callback(j.val())
		};
		g.find("#sliderTransColor").slider({
			range: "max",
			value: d,
			min: 0,
			max: 100,
			step: 10,
			slide: function(d, g) {
				j.val(g.value);
				var n = a.extend({
					clientOnly: !0
				},
				e);
				k(n)
			},
			stop: function() {
				k(e)
			}
		});
		j.val(d);
		j.blur(function() {
			k()
		});
		j.keypress(function(a) {
			13 == a.keyCode && k(e)
		})
	}
})(jQuery);
var NEEMultiPhotoControl = function() {
	var a;
	return {
		getInstance: function() {
			a || (a = {
				makeArrayOfMultiImagesSource: function(a, d) {
					if ("undefined" !== typeof a && "" != a) {
						var g = 2,
						j = [],
						k = [],
						l = d ? "$$$###": -1 != a.indexOf("http://") ? "http://": "https://",
						j = a.split(l);
						2 < j.length && (g = j.length);
						for (var m = 0; m < g;)"" != j[m] && k.push(d ? j[m] : l + j[m]),
						m++;
						return k
					}
				},
				refreshInFrame: function() {
					$.dmops.redrawSelection()
				},
				setCorrectIndexesFrame: function(a) {
					for (var d = 0; d < a.find("li").length; d++) $(a.find("li")[d]).attr("index", d)
				},
				getImageLi: function(a, d) {
					var g = a.attr("index"),
					j = $.dmx.current.element;
					$.dmx.current.element.is(".flex-container") ? g = $(j.find(".slides li").not(".clone").get(g)) : (j = j.find("li:not(.galleryContainer)"), g = d ? $(j.filter("[index\x3d'" + g + "']")) : $(j.get(g)));
					return g
				},
				getImagesLi: function(a) {
					for (var d = [], g = 0; g < a.length; g++) d.push(NEEMultiPhotoControl.getInstance().getImageLi(a[g]));
					return d
				},
				fixElementsIndexes: function(a) {
					a = a.find(".imageSliderSortableImagesWrapper li");
					for (var d = 0; d <= a.length; d++) $(a[d]).attr("index", d)
				},
				enablePhotoDragging: function(a, d) {
					var g = $(a).closest(".imageSliderSortableImagesWrapper");
					d ? g.sortable({
						disabled: !1
					}) : g.sortable({
						disabled: !0
					})
				},
				galleryAddHandlers: function(a) {
					a = $(a);
					var d = this;
					a.find(".operationsLineInPlaceholder").mousedown(function() {
						d.enablePhotoDragging(this, !1)
					});
					a.find(".operationsLineInPlaceholder").mouseup(function() {
						d.enablePhotoDragging(this, !0)
					})
				},
				handleTempPlachHoldersAddImagesNext: function(a) {
					var d = a.find(".imageSliderSortableImagesWrapper li").length ? a.find(".imageSliderSortableImagesWrapper li").length: 0,
					g = a.find(".smallTempPlaceHlderForImage").length;
					0 === d ? this.buildSmallPlaceHolder(a, 3 - g) : 1 == d ? 2 > g && this.buildSmallPlaceHolder(a, 2 - g) : 2 == d ? 1 > g && this.buildSmallPlaceHolder(a, 1) : 0 === g && this.buildSmallPlaceHolder(a, 1)
				},
				buildSmallPlaceHolder: function(a, d) {
					for (var g = a.find(".imageSliderSortableImagesWrapper"), j = 0; j < d; j++) $("\x3cdiv class\x3d'smallTempPlaceHlderForImage'\x3e\x3c/div\x3e").appendTo(g)
				},
				getCurrNumToPut: function(a) {
					return a.find(".imageSliderSortableImagesWrapper li").length
				}
			});
			return a
		}
	}
} (); (function(a) {
	a.fn.neeSecondaryIconTabs = function(d) {
		d = d || {};
		for (var e = this,
		g = [{
			id: "bfs_gallery",
			name: dmStr["ui.nee.common.image.22"],
			url: "/editor/nee/mainTabs/ptMainTabs/nee.BackgroundLabsCollection.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				g.useGalleryDefaults = !0;
				g.facebookImages = !1;
				g.unsplash = !0;
				e.neeSecondaryBgBackgroundLabsTab(g)
			}
		},
		{
			id: "bg_labs",
			name: dmStr["ui.nee.common.image.23"],
			url: "/editor/nee/mainTabs/ptMainTabs/nee.BackgroundLabsCollection.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				g.useGalleryDefaults = !1;
				g.facebookImages = !1;
				e.neeSecondaryBgBackgroundLabsTab(g)
			}
		},
		{
			id: "gallery_icon",
			name: dmStr["ui.nee.common.image.1"],
			url: a.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/common/nee.buttonsHtmlGallery.jsp": "/editor/nee/editableObjects/common/nee.buttonsHtmlGallery.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !0;
				e.neeSecondaryGalleryTab(g);
				a.dmfw.isDudaone() && e.adjustDudaoneIconPicker(d)
			}
		},
		{
			id: "facebook_images",
			name: "Facebook",
			url: "/editor/nee/mainTabs/ptMainTabs/nee.BackgroundLabsCollection.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				g.facebookImages = !0;
				e.neeSecondaryBgBackgroundLabsTab(g)
			}
		},
		{
			id: "upload_icon",
			name: dmStr["ui.nee.common.image.2"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlUpload.jsp?fontIcon\x3d" + a.dmfw.isPT() || a.dmfw.isDudaone(),
			singleItemButtons: {
				enlargeButton: !0,
				deleteButton: !0
			},
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !0;
				g.originalSiteImages = !1;
				e.neeSecondaryUploadTab(g)
			}
		},
		{
			id: "url_icon",
			name: dmStr["ui.nee.common.image.3"],
			url: a.dmfw.isDudaone() ? "/editor/dudaone/html/one.buttonsHtmlUrl.jsp": "/editor/nee/editableObjects/common/nee.buttonsHtmlUrl.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !0;
				e.neeSecondaryUrlTab(g)
			}
		},
		{
			id: "gallery",
			name: dmStr["ui.nee.common.image.1"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlGallery.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				e.neeSecondaryImageGalleryTab(g)
			}
		},
		{
			id: "original_images",
			name: dmStr["ui.nee.common.image.4"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlUpload.jsp?fontIcon\x3d" + a.dmfw.isPT() || a.dmfw.isDudaone(),
			singleItemButtons: {
				enlargeButton: !0,
				deleteButton: !1
			},
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				g.originalSiteImages = !0;
				e.neeSecondaryUploadTab(g)
			}
		},
		{
			id: "upload",
			name: dmStr["ui.nee.common.image.2"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlUpload.jsp?fontIcon\x3d" + a.dmfw.isPT() || a.dmfw.isDudaone(),
			singleItemButtons: {
				enlargeButton: !0,
				deleteButton: !0
			},
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				g.originalSiteImages = !1;
				e.neeSecondaryUploadTab(g);
				e.trigger("uploadTabReady")
			}
		},
		{
			id: "url",
			name: dmStr["ui.nee.common.image.3"],
			url: a.dmfw.isDudaone() ? "/editor/dudaone/html/one.buttonsHtmlUrl.jsp": "/editor/nee/editableObjects/common/nee.buttonsHtmlUrl.jsp",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				e.neeSecondaryUrlTab(g)
			}
		},
		{
			id: "bgimage",
			name: dmStr["ui.nee.common.image.5"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlBgImageSettings.jsp",
			identifier: "bgimageCustome",
			onReady: function() {
				var g = a.extend(!0, {},
				d);
				g.icon = !1;
				e.neeSecondaryBgImageSettingsTab(g)
			}
		}], m = d.tabs, n = [], o = 0; o < g.length; o++) null != m[g[o].id.toLowerCase()] && n.push(g[o]);
		if (a.dmfw.isPT() || a.dmfw.isDudaone()) {
			a.dmx.site.isFromScratch && !a.dmx.site.originalBaseUrl && (n = jQuery.grep(n,
			function(a) {
				return "original_images" != a.id
			}));
			var o = jQuery.grep(g,
			function(a) {
				return "bfs_gallery" == a.id
			})[0],
			r = jQuery.grep(g,
			function(a) {
				return "facebook_images" == a.id
			})[0];
			m.gallery_icon || (m.bg_labs ? a.dmx.site.metaData && a.dmx.site.metaData.facebookID ? n.splice(1, 0, r) : n.splice(1, 0, o) : (n.splice(1, 0, o), a.dmx.site.metaData && a.dmx.site.metaData.facebookID && n.splice(1, 0, r)));
			m = n.map(function(a) {
				return a.id
			});
			a.dmfw.isDudaone() && d.isImagePickerPopup && (o = a.inArray("bfs_gallery", m), (d.isIconPicker || d.hideGalleryTab) && -1 !== o ? n.splice(o, 1) : ( - 1 !== o ? (g = n.splice(o, 1), n = g.concat(n)) : n = [g[0]].concat(n), m = n.map(function(a) {
				return a.id
			}), g = a.inArray("original_images", m), -1 !== g && (g = n.splice(g, 1), n = g.concat(n))));
			a.dmfw.isDudaone() && (g = a.inArray("gallery_icon", m), -1 !== g && (n = [n[g]]))
		}
		this.neeSecondaryTabsControl(n, void 0, d.isImagePickerPopup);
		if (a.dmfw.isDudaone() && d.isImagePickerPopup) this.oneImageEditPopupAdjust(d)
	};
	a.fn.neeSecondaryUploadTab = function(d) {
		var e = this,
		g = [],
		m,
		n = a("#ptEditorArea"),
		o = a("#_editor"),
		r;
		r = a.dmfw.isPT() ? n: a.dmfw.isDudaone() ? this: o;
		d = d || {};
		d.originalSiteImages ? (e.find(".uploadForSlidePanelEditor").hide(), e.find(".uploadForOtherEditors").hide(), e.find(".uploadfileBtnWrapperDiv").hide()) : d.uploadBiggerButton ? (e.find(".uploadfileBtn").addClass("uploadForOtherEditors"), !1 === a.dmfw.isPT() && e.find(".uploadfileBtnWrapperDiv").addClass("ir"), e.find(".uploadForOtherEditors").show(), d.icon ? e.find(".uploadForOtherEditors").hover(function() {
			hover_intent = setTimeout(function() {
				a(".uploadfileBubble").css("display", "block")
			},
			600)
		},
		function() {
			try {
				clearTimeout(hover_intent)
			} catch(d) {}
			a(".uploadfileBubble").css("display", "none")
		}) : e.find(".uploadForOtherEditors").hover(function() {
			hover_intent = setTimeout(function() {
				a(".uploadfileBubbleBigger").css("display", "block")
			},
			600)
		},
		function() {
			try {
				clearTimeout(hover_intent)
			} catch(d) {}
			a(".uploadfileBubbleBigger").css("display", "none")
		})) : (e.find(".uploadfileBtn").addClass("uploadForSlidePanelEditor"), e.closest(".buttonTab").find(".backButton").is(":visible") && (e.find(".uploadfileBtnWrapperDiv").css("left", "60px").addClass("uploadForSlidePanelEditorWrapper"), e.find(".uploadfileBubbleBigger").css("left", "42px"), e.find(".uploadfileBubble").css("left", "42px")), e.find(".uploadForSlidePanelEditor").show(), d.icon ? e.find(".uploadForSlidePanelEditor").hover(function() {
			hover_intent = setTimeout(function() {
				a(".uploadfileBubble").css("display", "block")
			},
			600)
		},
		function() {
			try {
				clearTimeout(hover_intent)
			} catch(d) {}
			a(".uploadfileBubble").css("display", "none")
		}) : e.find(".uploadForSlidePanelEditor").hover(function() {
			hover_intent = setTimeout(function() {
				a(".uploadfileBubbleBigger").css("display", "block")
			},
			600)
		},
		function() {
			try {
				clearTimeout(hover_intent)
			} catch(d) {}
			a(".uploadfileBubbleBigger").css("display", "none")
		}));
		e.find(".uploadfileBtn").attr("multiple", "multiple");
		if (d.isMultipleUpload) {
			e.find(".uploadfileBtn").attr("multiple", "multiple");
			e.find(".selectMultiItemsBtn").show();
			var u = "";
			e.find(".selectMultiItemsBtn").unbind("click").click(function() {
				a(".clostThis").trigger("click");
				d.callback && d.callback(u, !0)
			})
		}
		_showImage = function(n, m) {
			var o = NEEMultiPhotoControl.getInstance().makeArrayOfMultiImagesSource(n);
			if (o) {
				for (var r = 0; r < o.length; r++) {
					var u = a('\x3cdiv class\x3d"imgPlaceholder"\x3e\x3c/div\x3e'),
					E = a("\x3cimg\x3e\x3c/img\x3e");
					E.attr("src", o[r]);
					u.append(E);
					g.unshift(o[r])
				}
				e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(g), 0, a.dmfw.isPT() || a.dmfw.isDudaone() ? "numbers": "both"); ! 0 == m && o && (a(e.find("#neePagingContent").find(".imgPlaceholder").get(0)).trigger("click"), d.isUserImg = !0, d.isCoreImg = !1, a(this).neeChangeImage(o[0], null, null, d))
			}
		};
		_findImagePlaceHolder = function(a, d) {
			if (d) for (var e = 0; e < a.length; e++) {
				if (!a[e].attr("occupied")) return a[e].attr("occupied", !0),
				a[e]
			} else for (e = a.length - 1; 0 <= e; e--) if (!a[e].attr("occupied")) return a[e].attr("occupied", !0),
			a[e]
		};
		_removeBadImagePlaceHolder = function(a) {
			for (var d = a.length - 1; 0 <= d; d--) if (!a[d].attr("occupied")) {
				a.splice(d, 1);
				m && m.redrawPaging();
				break
			}
		};
		_buildImgsHolders = function(n) {
			function m(n) {
				var o = a(n).parent().parent().find("img").attr("src");
				a.dmPostWithHistory({
					url: "/sites/" + a.dmx.site.id + "/deleteImage?img\x3d" + o,
					success: function() {
						var n = g.indexOf(o);
						g.splice(n, 1);
						for (var n = e.find(".uplodedImages").find(".imgPlaceholder"), m = 0; m < n.length; m++) a(n[m]).find("a").attr("title") == o && a(n[m]).hide();
						m = NEFW.PREVIEW.get(0).contentWindow;
						n = m.getPageCSSToString();
						m = m.getGlobalCSSToString();
						a.dmops.refreshPageStyleCss(n);
						a.dmops.refreshGlobalCss(m);
						a.dmfw.getPreviewElement("img[src\x3d'" + o + "']").attr("src", o);
						d.uponRemoveImage && d.uponRemoveImage()
					}
				})
			}
			for (var o = [], r = 0; r < n.length; r++) {
				var D = a('\x3cdiv class\x3d"imgPlaceholder"\x3e\x3c/div\x3e').attr("text", "no").attr("index", r);
				o.push(D)
			}
			for (r = 0; r < n.length; r++) a("\x3cimg/\x3e").error(function() {
				_removeBadImagePlaceHolder(o)
			}).attr("src", n[r]).load(function() {
				pic_real_width = this.width;
				pic_real_height = this.height;
				var e = a(this).attr("src"),
				g = !0;
				if (d.originalSiteImages) {
					if (50 > pic_real_width || 50 > pic_real_height || 5 <= pic_real_width / pic_real_height || 3.5 <= pic_real_height / pic_real_width) g = !1;
					if (6 >= pic_real_width || 6 >= pic_real_height) {
						_removeBadImagePlaceHolder(o);
						return
					}
				}
				var k = a("\x3cimg\x3e\x3c/img\x3e");
				k.attr("src", e);
				var n = _findImagePlaceHolder(o, g);
				n.click(function() {
					d.isMultipleUpload ? "yes" == a(this).attr("text") ? (u = u.replace(a(this).find("img").attr("src"), ""), a(this).removeClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderBox").removeClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").removeClass("selected").html(dmStr["ui.select"]), a(this).attr("text", "no")) : (a(this).attr("text", "yes"), a(this).addClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").addClass("selected").html(dmStr["ui.nee.imageSelected.1"].toLowerCase().toCamel()), a(this).find(".imgPlaceholderBox").addClass("imgPlaceholderSelected"), u += "$$$###" + a(this).find("img").attr("src")) : (a(".imgPlaceholder").attr("text", "no"), a(".divInDisplayDiv").attr("text", "no"), a(this).attr("text", "yes"), a(this).find(".divInDisplayDiv").attr("text", "yes"), a(".imgPlaceholder").addClass("imgPlaceholderSelected"), a.each(o,
					function(d, e) {
						a(e).removeClass("imgPlaceholderSelected");
						a(e).find(".imgPlaceholderSelectOption").html(dmStr["ui.select"])
					}), a(".imgPlaceholderBox").removeClass("imgPlaceholderSelected"), a(this).addClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").addClass("selected").html(dmStr["ui.nee.imageSelected.1"].toLowerCase().toCamel()), a(this).find(".imgPlaceholderBox").addClass("imgPlaceholderSelected"), null != d.callback ? (d.isUserImg = !0, d.isCoreImg = !1, d.selectedIcon = null, d.callback(a(this).find("img").attr("src"), null, null, d)) : (d.isUserImg = !0, d.isCoreImg = !1, d.selectedIcon = null, a(this).neeChangeImage(a(this).find("img").attr("src"), null, null, d)))
				});
				var l = a("\x3cdiv class\x3d'imgPlaceholderImgHold'\x3e\x3c/div\x3e").append(k).appendTo(n),
				k = e.split("/"),
				k = k[k.length - 1],
				g = a('\x3cdiv class\x3d"imgPlaceholderDisplayDiv"\x3e\x3c/div\x3e').appendTo(l);
				a("\x3cdiv class\x3d'imgPlaceholderBox'\x3e\x3c/div\x3e").append(l).append(g).appendTo(n);
				a("\x3ca\x3e\x3c/a\x3e").attr("href", e).attr("title", e).addClass("nyroModal").appendTo(g);
				var e = a("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("imgPlaceholderImageName"),
				n = a('\x3cspan class\x3d"imgPlaceholderDeleteOption"\x3e\x3c/span\x3e').appendTo(g),
				l = a('\x3cspan class\x3d"imgPlaceholderSelectOption blueBtn ptBlueBtn"\x3e' + dmStr["ui.select"] + "\x3c/span\x3e").appendTo(g),
				r = a('\x3cspan class\x3d"imgPlaceholderEnlargeOption"\x3e\x3c/span\x3e').appendTo(g);
				e.html(k).attr("title", k).css("display", "none");
				a.dmfw.isDudaone() && (n.addClass("dm-icon-trash2"), r.addClass("dm-icon-zoom-in"));
				n.neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.imagePicker.1"] + "\x3c/b\x3e\x3cbr /\x3e\t" + dmStr["ui.nee.imagePicker.2"], {
					initCallback: m,
					toReturn: n
				});
				d.originalSiteImages && n.hide();
				l.click(function(d) {
					d.stopPropagation();
					a(this).parent().parent().trigger("click")
				});
				r.click(function(d) {
					d.stopPropagation();
					a(this).parent().find(".nyroModal").nyroModal({
						callbacks: {
							size: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							},
							beforeShowBg: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							},
							beforeShowLoad: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							},
							beforeShowCont: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							},
							afterReposition: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							},
							afterresize: function() {
								var d = a(".nyroModalImage").outerHeight(),
								e = parseInt(a(".nyromodaltitle").css("top"));
								a(".nyromodaltitle").css("top", e + d + 20 + "px")
							}
						}
					}).nmCall()
				});
				g.mouseover(function() {
					a(this).find("img").show();
					a(this).find(".imgPlaceholderImageName").show()
				});
				g.mouseout(function() {
					a(this).find("img").hide();
					a(this).find(".imgPlaceholderImageName").hide()
				})
			});
			return o
		};
		a.dmLoading(r);
		a.dmGet({
			url: d.originalSiteImages ? "/sites/" + a.dmx.site.id + "/getoriginalsiteimages/": "/sites/" + a.dmx.site.id + "/getuploadedimages/",
			success: function(n) {
				a.dmUnblockUI();
				for (var o = n.length - 1; 0 <= o; o--) - 1 != n[o].indexOf("duda.cropped.") && n.splice(o, 1);
				g = n;
				0 == n.length && !d.originalSiteImages ? e.find(".uplodedImages").addClass("noImagesUploaded") : m = e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(n), 0, a.dmfw.isPT() || a.dmfw.isDudaone() ? "numbers": "both", a.dmfw.isDudaone() ? 3 : void 0)
			}
		});
		_limitAttach = function(d, e, g) {
			a.dmBlockUI(r);
			extArray = [".gif", ".jpeg", ".png", ".bmp", ".jpg"];
			allowSubmit = !1;
			if (e) {
				for (; - 1 != e.indexOf("\\");) e = e.slice(e.indexOf("\\") + 1);
				ext = e.slice(e.lastIndexOf(".")).toLowerCase();
				for (e = 0; e < extArray.length; e++) if (extArray[e] == ext) {
					allowSubmit = !0;
					break
				}
				if (allowSubmit) {
					e = document.createElement("iframe");
					e.setAttribute("id", "upload_iframe");
					e.setAttribute("name", "upload_iframe");
					e.setAttribute("width", "0");
					e.setAttribute("height", "0");
					e.setAttribute("border", "0");
					e.setAttribute("style", "width: 0; height: 0; border: none;"); (g || d.parentNode).appendChild(e);
					window.frames.upload_iframe.name = "upload_iframe";
					iframeId = document.getElementById("upload_iframe");
					var j = function() {
						var d = "";
						null != iframeId.detachEvent ? iframeId.detachEvent("onload", j) : iframeId.removeEventListener("load", j, !1);
						null != iframeId.contentDocument ? (d = iframeId.contentDocument.body.innerHTML, iframeId.contentDocument.body.innerHTML = "") : null != iframeId.contentWindow ? (d = iframeId.contentWindow.document.body.innerHTML, iframeId.contentWindow.document.body.innerHTML = "") : null != iframeId.document && (d = iframeId.document.body.innerHTML, iframeId.document.body.innerHTML = "");
						a.dmUnblockUI();
						_showImage(a.browser.msie ? a(d).selector: a(d).html(), !1);
						setTimeout("iframeId.parentNode.removeChild(iframeId)", 250)
					};
					null != iframeId.addEventListener && (iframeId.removeEventListener("load", j), iframeId.addEventListener("load", j, !0));
					null != iframeId.attachEvent && (iframeId.detachEvent("onload", j), iframeId.attachEvent("onload", j));
					d.setAttribute("target", "upload_iframe");
					d.setAttribute("action", "/editor/nee/imageUpload?maxUrlLen\x3d150\x26folder\x3d" + a.dmx.site.alias);
					d.setAttribute("method", "post");
					d.setAttribute("enctype", "multipart/form-data");
					d.setAttribute("encoding", "multipart/form-data");
					a("form #upload-form").encoding = "multipart/form-data";
					d.submit(function() {})
				} else a.dmUnblockUI(),
				a("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.imagePicker.3"] + extArray.join("  ") + "\x3cbr/\x3e" + dmStr["ui.nee.imagePicker.4"] + " " + dmStr["ui.nee.imagePicker.5"], {
					triggerNow: !0,
					yesText: dmStr["ui.ok.u"],
					noStyle: "display:none"
				})
			}
		};
		a("input[type\x3dfile]").not("#oneUploadImage").change(function() {
			e.find('[id\x3d"tempTry"]').trigger("click")
		})
	};
	a.fn.neeSecondaryGalleryTab = function(e) {
		e = e || {};
		var g = commonProps["editor.useFontIcons"];
		e.useFontIcon = !0;
		g = g && e.useFontIcon ? d: _getIconPerColor;
		e.iconPickerElement = this;
		g = a.proxy(g, this);
		this.find("#colorsLine").addColorsToIconFilter(g, e);
		e.callBackOnIconGallery && e.callBackOnIconGallery()
	};
	a.fn.addColorsToIconFilter = function(d, e) {
		e = e || {};
		e.onFilterChange = d;
		var g = "#0a0a0a",
		m = a.dmx.current.element; ! a.isEmptyObject(m) && m && (g = 0 < m.find(".hasFontIcon").length ? a.rgb2hex(m.find(".hasFontIcon").css("color")) : a.rgb2hex(m.css("color")));
		g = e.currColor || e.color || g; ! a.isEmptyObject(m) && (!m && null != m.attr("imgImage") && "false" != m.attr("imgImage")) && (g = m.attr("imgImage"));
		a._dmc.defaultPTIconsColors = a.dmx.site.colors && a.dmx.site.colors.slice(0, 10);
		var n = Color.convert(g, "lab"),
		o = !1;
		a(".smallColorCube:not(#exampleSquare)").each(function() {
			var d = a.rgb2hex(a(this).css("background-color")),
			d = Color.convert(d, "lab");
			if (n == d || 2.3 > a.getLabDistance(n, d, !0)) return a(this).addClass("smallColorCubeSelected"),
			o = !0,
			!1
		});
		o || a(this).find("#exampleSquare").addClass("smallColorCubeSelected");
		a("#exampleSquare").css("background-color", g);
		var r = function(n) {
			a("#exampleSquare").css("background-color", n);
			e.changeColorImmediately = !0;
			g = n;
			e.currColor = n;
			d(g, e)
		};
		if ("function" === typeof a.fn._openColorPaletteChange) a("#exampleSquare").off("click").on("click",
		function(d) {
			d.stopPropagation();
			0 >= a(this).find(".divToShowPalette").length && (a(".divToShowPalette").remove(), a(this)._openColorPaletteChange(r,
			function() {},
			{
				hideOpacity: !0
			}))
		});
		else a("#exampleSquare").unbind("click").click(function() {
			a("#placementForColorPickerIcon").neeOpenColorPicker(g, r)
		});
		a.dmx.events.bind("fontIconsRecieved.initIconPicker",
		function(n) {
			e.currColor = g;
			var m = e;
			m.filter = {
				searchTerm: "",
				category: ""
			};
			var o = m.iconPickerElement.find(".fileNameSelectInput"),
			r = [],
			v = {},
			D = [];
			a.each(n.icons,
			function(d, e) {
				var g = e.searchterm || e.classname.replace("dm-icon-", "").replace("icon-", "");
				r.push(g);
				a.each(e.categories || [],
				function(a, d) {
					v[d] = !0
				})
			});
			a.each(v,
			function(a) {
				D.push(a)
			});
			D.sort();
			var r = r.sort().removeDuplicate(),
			E = function(a) {
				a = a || "";
				m.filter = m.filter || {};
				m.filter.searchTerm !== a && (m.filter.searchTerm = a, d(m.currColor, m))
			},
			F = function(a) {
				a = a || "";
				m.filter = m.filter || {};
				m.filter.category !== a && (m.filter.category = a, d(m.currColor, m))
			};
			n = function() {
				a.each(D,
				function(d, e) {
					var g = "ui.icons.cat." + e.replace(" \x26 ", "_"),
					g = a('\x3cspan class\x3d"ptSelectOption ptIconselectOption addedDynamically" value\x3d"' + e + '"\x3e' + dmStr[g] + "\x3c/span\x3e");
					g.data("onReady",
					function() {
						F(e)
					});
					e == m.filter.category && g.addClass("toSelect");
					G.find(".ptSelectOptions").append(g)
				})
			};
			var I = function(a) {
				F(a.selectedData.value)
			};
			o.autocomplete({
				source: r,
				minLength: 4,
				change: function() {
					E(o.val())
				},
				select: function(a, d) {
					E(d.item.value)
				}
			});
			o.off("blur.icons").on("blur.icons",
			function(d) {
				a(d.relatedTarget).is(".ui-corner-all") || E(o.val())
			});
			o.off("keyup.enter").on("keyup.enter",
			function(a) {
				13 == a.which && this.blur()
			});
			o.val(m.filter.searchTerm);
			a.dmx.events.bind("noIconsFound.filterLine",
			function() {
				a.dmfw.showPromptError(o, dmStr["ui.icons.noIcons"], {
					at: "bottom center",
					my: "top center"
				})
			},
			!0);
			var G = m.iconPickerElement.find(".ptSelectBox");
			G.find(".allIcons").data("onReady",
			function() {
				F("")
			});
			G.find(".featured").data("onReady",
			function() {
				F("featured")
			});
			G.find(".addedDynamically").remove();
			m.filter = m.filter || {};
			if (a.dmfw.isDudaone()) {
				var K = D.map(function(a) {
					return {
						value: a,
						text: dmStr["ui.icons.cat." + a.replace(" \x26 ", "_")],
						selected: !1
					}
				});
				K.unshift({
					value: "",
					text: "All Icons",
					selected: !0
				});
				a("#categorySelect").styleSelectBox(I, {
					isFirstTime: !0,
					width: "130px"
				},
				K)
			} else n(D);
			n(D);
			"function" === typeof a.fn.neePtSelectBox && (G.removeClass("hiddenVisibility"), G.neePtSelectBox());
			a.dmx.events.unbind("fontIconsRecieved.initIconPicker")
		},
		!0);
		d(g, e)
	};
	_getCurElementShape = function() {
		var d = a.dmx.current.element || a(),
		e = "default";
		if (d.hasClass("navPlaceHolder")) e = a.navigationUtil.getActualCurNavShape();
		else for (var d = (d.attr("class") || "").split(" "), g = 0; g < d.length; g++) if (d[g].startsWith("shapeWidget")) {
			e = d[g];
			break
		}
		return e
	};
	var e = function(d) {
		a(".IconSelection").css("color", d).attr("dmColor", d);
		d = d.startsWith("rgb") ? d: a.convertUtils.colors.RGBArrayToString(a.convertUtils.colors.convertToRGB(d));
		d = 170 < a.getColorBrigthness(d);
		a(".IconSelection").toggleClass("brightIcons", d)
	},
	d = function(d, g) {
		function l(d) {
			var e = a('\x3cspan class\x3d"imgInsideIcon"\x3e\x3c/span\x3e');
			e.addClass(d.classname);
			e.attr("data-dm-icon", d.classname);
			e.attr("data-categories", JSON.stringify(d.categories || []));
			e.addClass("fontIcon");
			e.attr("title", (d.classname ? d.classname.replace("dm-icon-", "").replace("icon-", "") : "").toCamel());
			d.classname === g.selectedIcon && e.addClass("selectedIcon");
			return e
		}
		function m(e) {
			a.dmx.events.trigger("fontIconsRecieved", {
				curColor: d,
				options: g,
				icons: e
			});
			var m = g.filter || {},
			o = m.category,
			r = m.searchTerm || "",
			r = r.toLowerCase();
			e = a.grep(e,
			function(d) {
				var e = !0,
				g = (d.searchterm || d.classname || "").toLowerCase(),
				j = a.map(d.keywords || [],
				function(a) {
					return a.toLowerCase()
				});
				j.push(g);
				d = a.map(d.categories || [],
				function(a) {
					return a.toLowerCase()
				});
				o && (e = e && d.contains(o.toLowerCase()));
				r && (e = e && ( - 1 != g.indexOf(r) || -1 != j.indexOf(r) || -1 != d.indexOf(r)));
				return e
			});
			n.neeGetAllIcons(e,
			function(e, n) {
				var m = e.find("span.imgInsideIcon").attr("data-dm-icon");
				a(".selectedIcon").removeClass("selectedIcon");
				a.each(n || [],
				function(a, d) {
					d.removeClass("selectedIcon")
				});
				e.addClass("selectedIcon");
				g.selectedIcon = m;
				g.isUserImg = !1;
				g.isCoreImg = !0;
				var l = a.extend({},
				g);
				l.fontIcon = !0;
				a(this).neeChangeImage(m, d, null, l)
			},
			null, l, g)
		}
		var n = a(this);
		if (g.changeColorImmediately) {
			g.isUserImg = !1;
			g.isCoreImg = !0;
			var o = a.extend({},
			g);
			o.fontIcon = !0;
			a(this).neeChangeImage(null, d, null, o)
		}
		g.changeColorImmediately = !1;
		if (null != a._dmc.iconPicker.fontIcons) e(d),
		m(a._dmc.iconPicker.fontIcons);
		else {
			var r = null;
			a(".IconSelection").is(":visible") ? a.dmLoading(a(".IconSelection")) : (o = n.find(".IconSelection"), o.empty(), r = a("#disabledImageZone").clone(), r.find("#imageZone").css("top", "").css("left", ""), o.append(r), showDefaultLoader(r, o), n.data("loader", r));
			a.ajax({
				url: "/editor/nee/editableObjects/nee.icons.json?v\x3d" + (new Date).getTime(),
				type: "get",
				dataType: "json",
				success: function(g) {
					a.dmUnblockUI();
					r && r.remove();
					a._dmc.iconPicker.fontIcons = g;
					e(d);
					m(a._dmc.iconPicker.fontIcons)
				},
				error: function(d, e, g) {
					a.dmUnblockUI();
					console.log(e);
					console.dir(g)
				}
			})
		}
	};
	_getIconPerColor = function(d, g) {
		var l = _getCurElementShape();
		"default" == l ? (l = a.dmx.site.baseThemeName, l = (l ? "variables as colors" == l ? "default": l.split(".")[1] || "default": "default").toLowerCase()) : l = l.toLowerCase();
		var l = l || "two-tone",
		m = l + "_" + d,
		n = a(this);
		if (null != a._dmc.iconPicker[m]) e(d),
		n.neeGetAllIcons(a._dmc.iconPicker[m],
		function(e) {
			e = e.find("img").attr("src");
			g.isUserImg = !1;
			g.isCoreImg = !0;
			a(this).neeChangeImage(e, d, a._dmc.iconPicker[m][e], g)
		});
		else {
			var o = null;
			a(".IconSelection").is(":visible") ? a.dmLoading(a(".IconSelection")) : (l = n.find(".IconSelection"), l.empty(), o = a("#disabledImageZone").clone(), o.find("#imageZone").css("top", "").css("left", ""), l.append(o), showDefaultLoader(o, l), n.data("loader", o));
			a.dmPost({
				url: "/sites/" + a.dmx.site.id + "/geticonsinsize?",
				data: params = {
					newColor: d,
					shapeName: _getCurElementShape()
				},
				success: function(l) {
					a.dmUnblockUI();
					o && o.remove();
					a._dmc.iconPicker[m] = l;
					l = a._dmc.iconPicker[m];
					e(d);
					n.neeGetAllIcons(l,
					function(e) {
						e = e.find("img").attr("src");
						g.isUserImg = !1;
						g.isCoreImg = !0;
						a(this).neeChangeImage(e, d, a._dmc.iconPicker[m][e], g)
					})
				}
			})
		}
	};
	a.fn.neeGetAllIcons = function(d, e, g, m, n) {
		n = n || {};
		var o = function(d) {
			var e = a('\x3cimg class\x3d"imgInsideIcon"\x3e\x3c/img\x3e');
			e.attr("src", d);
			return e
		};
		g = g || a(this);
		m = m || o;
		var r = [],
		u = 0,
		s = 0,
		B = function(d) {
			var g = a('\x3cdiv class\x3d"iconForSelection"\x3e\x3c/div\x3e');
			d = m(d);
			g.attr("id", "iconNum" + u).attr("currNumEl", u).attr("text", "no").css("cursor", "pointer").append(d);
			d.is(".selectedIcon") && (g.addClass("selectedIcon"), s = u);
			r.push(g);
			g.mouseover(function() {
				"no" == a(this).attr("text") && a(this).css("border-color", "#4D4D4D")
			});
			g.mouseout(function() {
				"no" == a(this).attr("text") && a(this).css("border-color", "#E5E5E5")
			});
			g.click(function() {
				a(".iconForSelection").attr("text", "no");
				a(this).attr("text", "yes");
				a(".iconForSelection").css("border-color", "");
				a.dmfw.isDudaone() || a(this).css("border-color", "orange");
				e(a(this), r)
			});
			u++
		};
		if (d instanceof Array) a.each(d,
		function(a, d) {
			B(d)
		});
		else for (var z in d) B(z);
		d = 0; ! n.refreshPages && 0 < a(this).find(".IconSelection").find(".neePagingContent").length ? d = Number(a(a(this).find(".IconSelection").find(".neePagingContent").find(".iconForSelection")[0]).attr("currNumEl")) : a.dmui.getResource("pagingWidgetStartFirstPage") || (d = s);
		n.refreshPages = !1;
		0 != r.length ? (a(this).find(".IconSelection").empty(), a(this).find(".IconSelection").neePagingWidget(r, d, a.dmfw.isPT() || a.dmfw.isDudaone() ? "numbers": "both", void 0, {})) : a.dmx.events.trigger("noIconsFound")
	};
	a.fn.neeSecondaryImageGalleryTab = function() {};
	a.fn.neeSecondaryBgBackgroundLabsTab = function(d) {
		var e = this;
		a("#ptEditorArea");
		var g = (a.dmfw.isDudaone(), this),
		m = a('\x3cdiv class\x3d"oneUnsplash"\x3eThanks to \x3ca href\x3d"http://unsplash.com/""\x3ehttp://unsplash.com\x3c/a\x3e for some of the pics\x3c/div\x3e');
		d = d || {};
		_buildImgsHolders = function(g) {
			for (var m = [], l = 0, o = 0; o < g.length;) {
				if (!g[o].endsWith("/")) {
					var r = a('\x3cdiv class\x3d"imgPlaceholder"\x3e\x3c/div\x3e').attr("index", l).attr("occupied", !0);
					m.push(r);
					var D = a("\x3cdiv\x3e\x3c/div\x3e"); (d.useGalleryDefaults || d.facebookImages) && D.addClass("fromSiteGalleryBfs");
					D.css("background-image", "url(" + g[o] + ")");
					r.click(function() {
						function e(a) {
							if (a.startsWith("url")) {
								var d = a.indexOf("url(") + 4,
								g = a.indexOf(")");
								a = a.substring(d, g);
								a.startsWith('"') && (a = a.substring(1, a.length - 1))
							}
							return a
						}
						if (d.isMultipleUpload) {
							var g = e(a(this).find(".imgPlaceholderImgHoldTexture div").css("background-image"));
							"yes" == a(this).attr("text") ? (n = n.replace(g, ""), a(this).removeClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderBox").removeClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").removeClass("selected").html(dmStr["ui.select"]), a(this).attr("text", "no")) : (a(this).attr("text", "yes"), a(this).addClass("imgPlaceholderSelected"), a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").addClass("selected").html(dmStr["ui.nee.imageSelected.1"].toLowerCase().toCamel()), a(this).find(".imgPlaceholderBox").addClass("imgPlaceholderSelected"), n += "$$$###" + g)
						} else a(".imgPlaceholder").addClass("imgPlaceholderSelected"),
						a.each(m,
						function(d, e) {
							a(e).removeClass("imgPlaceholderSelected");
							a(e).find(".imgPlaceholderSelectOption").html(dmStr["ui.select"])
						}),
						a(".imgPlaceholderBox").removeClass("imgPlaceholderSelected"),
						a(this).find(".imgPlaceholderDisplayDiv").find(".imgPlaceholderSelectOption.imgPlaceholderSelectOption").addClass("selected").html(dmStr["ui.nee.imageSelected.1"].toLowerCase().toCamel()),
						a(this).addClass("imgPlaceholderSelected"),
						a(this).find(".imgPlaceholderBox").addClass("imgPlaceholderSelected"),
						g = a(this).find(".imgPlaceholderImgHoldTexture div").css("background-image"),
						g = e(g),
						d.callback(g, null, null, d)
					});
					var D = a("\x3cdiv class\x3d'imgPlaceholderImgHoldTexture'\x3e\x3c/div\x3e").append(D),
					E = a('\x3cdiv class\x3d"imgPlaceholderDisplayDiv"\x3e\x3c/div\x3e').appendTo(D);
					a("\x3cdiv class\x3d'imgPlaceholderBox'\x3e\x3c/div\x3e").append(D).append(E).appendTo(r);
					a("\x3cdiv class\x3d'imgPlaceholderBox'\x3e\x3c/div\x3e").append(D).append(E).appendTo(r);
					a('\x3cspan class\x3d"imgPlaceholderSelectOption blueBtn ptBlueBtn"\x3e' + dmStr["ui.select"] + "\x3c/span\x3e").appendTo(E).click(function(d) {
						d.stopPropagation();
						a(this).parent().parent().trigger("click")
					});
					E.mouseover(function() {
						a(this).find("img").show();
						a(this).find(".imgPlaceholderImageName").show()
					});
					E.mouseout(function() {
						a(this).find("img").hide();
						a(this).find(".imgPlaceholderImageName").hide()
					});
					l++
				}
				o++
			}
			d.facebookImages && 0 == g.length ? e.find(".uplodedImages").append(a("\x3cdiv class\x3d'noFacebookImagesBanner'\x3e" + dmStr["ui.nee.fbGallery.24"] + "\x3c/div\x3e")) : e.find(".noFacebookImagesBanner").remove();
			return m
		};
		if (d.isMultipleUpload) {
			e.find(".selectMultiItemsBtn").show();
			var n = "";
			e.find(".selectMultiItemsBtn").unbind("click").click(function() {
				a(".closeThis").trigger("click");
				d.callback && d.callback(n, !0)
			})
		}
		var o = d.useGalleryDefaults ? a.ptColor.siteImagesGalleryBfs: a.ptColor.siteTexturesToShow,
		r = d.useGalleryDefaults ? "bfsImages": "gallery";
		d.facebookImages ? 0 == a.ptColor.siteImagesFacebook.length ? (a.dmLoading(g), a.dmGet({
			url: "/sites/" + a.dmx.site.id + "/getfacebookalbumphotos?album\x3d" + encodeURIComponent("Timeline Photos") + "\x26limit\x3d100",
			success: function(d) {
				a.dmUnblockUI();
				a.ptColor.siteImagesFacebook = d;
				e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(d), 0, "numbers")
			}
		})) : e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(a.ptColor.siteImagesFacebook), 0, "numbers") : 0 == (d.useGalleryDefaults ? a.ptColor.siteImagesGalleryBfs: a.ptColor.siteTexturesToShow).length ? (a.dmLoading(g), a.dmGet({
			url: "/sites/" + r + "/gettextureimages/",
			success: function(g) {
				a.dmUnblockUI();
				d.useGalleryDefaults ? a.ptColor.siteImagesGalleryBfs = g: a.ptColor.siteTexturesToShow = g;
				e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(g), 0, "numbers");
				a.dmfw.isDudaone() && d.unsplash && e.find(".uplodedImages").prepend(m)
			}
		})) : (e.find(".uplodedImages").removeClass("noImagesUploaded").empty().neePagingWidget(_buildImgsHolders(o), 0, "numbers"), a.dmfw.isDudaone() && d.unsplash && e.find(".uplodedImages").prepend(m))
	};
	var g = function(d) {
		return function() {
			var e = d.data("neeSecondaryUrlTabOptions"),
			g = a("#urlEntered"),
			m = g.val(),
			n = {
				adjustY: 4,
				maxWidth: "180",
				at: "bottom center",
				my: "top center"
			};
			a.validateURL(m, !0) ? "" != m && !d.find("#urlPrev").hasClass("noImageLogo") && (e.isUserImg = !0, e.isCoreImg = !1, a(this).neeChangeImage(decodeURI(d.find("#urlPrev").attr("url")), null, null, e)) : a.dmfw.showPromptError(g, dmStr["ui.nee.widgets.3702"], n)
		}
	};
	a.fn.neeSecondaryUrlTab = function(d) {
		function e(d) {
			var g;
			g = d ? d: l.find("#urlEntered").val().trim();
			var j = function(d) { ! 1 == d ? (a("#urlPrev").css("background", "").addClass("noImageLogo"), d = (dmStr["ui.config.images.folder"] || "/editor/nee/images/") + "no-image-175" + (dmStr["ui.config.resource.postfix"] || "") + ".png", l.find(".urlPrevImage").attr("src", d).attr("alt", "")) : (l.find("#urlPrev").removeClass("noImageLogo"), d = "url(" + g + ") no-repeat", l.find("#urlPrev").attr("url", g), l.find(".urlPrevImage").attr("src", g).attr("alt", d))
			};
			g ? a("\x3cimg\x3e", {
				src: g,
				load: function() {
					j(!0)
				},
				error: function() {
					j(!1)
				}
			}) : j(!1)
		}
		var l = this;
		d = d || {};
		a('[id\x3d"urlEntered"]').keypress(function(a) {
			13 == a.keyCode && l.find("#urlEntered").trigger("blur")
		});
		a('[id\x3d"urlEntered"]').blur(function() {
			e()
		});
		a('[id\x3d"urlEntered"]').bind("paste",
		function() {
			setTimeout(function() {
				l.find("#urlEntered").trigger("blur")
			},
			0)
		});
		var m = "none";
		if (!d.isNotElement) {
			var n = d.forceClassName ? a.dmfw.getPreviewElement(d.forceClassName) : a.dmx.current.element;
			d.icon ? n instanceof jQuery && (0 < n.find(".icon").length && (m = n.find(".icon").css("background-image")), d.specificIconSelector && (m = n.find(d.specificIconSelector()).css("background-image"))) : n && (m = n.css("background-image"))
		}
		n = !1;
		if ("" != m && "url(http://localhost:8080/non)" != m && "none" != m && void 0 != m && -1 != m.indexOf("url(") && -1 == m.indexOf("svg+")) {
			if (m.startsWith("url")) {
				var n = m.indexOf("url(") + 4,
				o = m.indexOf(")"),
				m = m.substring(n, o);
				m.startsWith('"') && (m = m.substring(1, m.length - 1))
			}
			a("#urlEntered").val(m);
			e(m);
			n = !0
		}
		a('[id\x3d"useIcon"]').click(g(l));
		n || e();
		this.data("neeSecondaryUrlTabOptions", d)
	};
	a.fn.neeSecondaryBgImageSettingsTab = function(d) {
		var e = a.dmx.preview.wnd(),
		e = (d.elementToChange || e.$("div.dmInner")).css("background-attachment"),
		g = a.dmfw.isDudaone() ? a(".posButton") : a(".positionCircle"),
		m = a.dmfw.isDudaone() ? "selected": "circleOrange";
		d = d || {};
		0 == this.closest(".openImagePickerPopUpWrapper").length && (a("#imgRepeatPositionSettingWR").remove(), a.dmfw.isDudaone() ? a("#oneImgRepeatPositionSetting").show() : a("#imgRepeatPositionSettingPT").show());
		d.uploadBiggerButton ? (this.find(".customizeForBiggerDone").show(), this.find(".customizeForBiggerDone").unbind("click").click(function() {
			NEFW.PREVIEW.get(0).contentWindow.setEventsFirePolicy(!0);
			a("body").find(".popupWinExampleMask").hide()
		})) : this.find(".customizeForBiggerDone").hide();
		"fixed" !== e && a('div[data-action\x3d"bgscroll"]').toggleClass("neeOffButton neeOffButtonOne");
		var e = d.forceClassName ? a.dmfw.getPreviewElement(d.forceClassName) : d.selector ? a.dmx.current.element.find(d.selector) : d.element ? d.element: a.dmx.current.element,
		n = function(d, e) {
			if (e.changeGlobally) {
				var g = e.forceClassName;
				g ? e.updateInChangePage ? updateInChangePage(e.forceClassName, d.attrToAdd[0].attr, d.attrToAdd[0].value) : a.dmops.updateGlobalCssAndElement(d, {
					className: g,
					clientOnly: !1
				}) : a.dmops.updateCurrentCss(d, e)
			} else a.dmops.updateCurrentCss(d, e)
		};
		a("#" +
		function(a) {
			if ("0% 0%" == a) return "top_left";
			if ("0% 50%" == a) return "top_center";
			if ("0% 100%" == a) return "top_right";
			if ("50% 0%" == a) return "center_left";
			if ("50% 50%" == a) return "center_center";
			if ("50% 100%" == a) return "center_right";
			if ("100% 0%" == a) return "bottom_left";
			if ("100% 50%" == a) return "bottom_center";
			if ("100% 100%" == a) return "bottom_bottom"
		} (e.css("background-position"))).addClass("circleOrange");
		g.click(function() {
			g.removeClass(m);
			a(this).addClass(m);
			var e = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: "background-position",
					value: a(this).attr("id").replace("_", " ")
				}]
			};
			n(e, d)
		});
		a("#" + e.css("background-repeat")).addClass("repeatItemSelect");
		a(".repeatItem").click(function() {
			var e = a(this).data().bgattr,
			g = a(this).data().bgeffect,
			k = a(this).data().bgattrreset,
			m = a(this).data().bgeffectreset,
			e = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: e,
					value: g
				},
				{
					attr: k,
					value: m
				}]
			};
			a(".repeatItem").removeClass("repeatItemSelect");
			a(this).addClass("repeatItemSelect");
			n(e, d)
		});
		a('div[data-action\x3d"bgscroll"]').off("click.backgroundScroll").on("click.backgroundScroll",
		function() {
			var e = "scroll";
			a(this).hasClass("neeOffButtonOne") && (e = "fixed");
			e = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: "background-attachment",
					value: e
				}]
			};
			a(this).toggleClass("neeOffButton neeOffButtonOne");
			n(e, d)
		});
		a(".removeBgBtn").click(function() {
			n({
				classesToRemove: null,
				attrToRemove: null,
				attrToAdd: [{
					attr: "background-image",
					value: "none"
				}],
				classesToAdd: null
			},
			d);
			d.uploadBiggerButton && d.uponRemoveImage && d.uponRemoveImage()
		})
	};
	a.fn.neeChangeImage = function(d, e, g, m) {
		m = m || {};
		g = g || {};
		if (null != m.callback) m.callback(d, e, g, m);
		else {
			var n = m.elem ? m.elem: m.elementToChange || a.dmx.current.element,
			o = m.selector || g.selector,
			r = null;
			m.icon ? m.fontIcon ? a.dmops.changeFontIcon({
				iconName: d,
				changeGlobally: m.changeGlobally,
				forceClassName: m.forceClassName,
				selector: m.selector,
				color: e,
				elementToChange: n
			}) : a.dmops.changeIcon({
				isUserImg: m.isUserImg,
				isCoreImg: m.isCoreImg,
				BGImage: d,
				color: e,
				name: g,
				forceClassName: m.forceClassName,
				selector: m.selector,
				elementToChange: n,
				changeGlobally: m.changeGlobally
			}) : (e = [{
				attr: "background-image",
				value: "url('" + d + "')"
			},
			{
				attr: "background-repeat",
				value: "no-repeat"
			},
			{
				attr: "background-size",
				value: "auto"
			},
			{
				attr: "background-position",
				value: "top left"
			}], "none" != n.css("background-image") && (e = [{
				attr: "background-image",
				value: "url('" + d + "')"
			}]), r = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attributesToRemoveFromElement: ["icon-name"],
				attrToAdd: e
			},
			e = function(d) {
				d && d.each(function(d, e) {
					var g = a(e);
					a.dmops.removeFontIcon(g)
				})
			},
			m.changeGlobally ? m.updateInChangePage ? updateInChangePage(m.forceClassName, "background-image", "url('" + d + "')", !0) : a.dmops.updateGlobalCssAndElement(r, {
				className: m.forceClassName ? m.forceClassName: m.selector,
				clientOnly: !1,
				clientElementChange: e
			}) : a.dmops.updateCurrentCss(r, {
				element: n,
				selector: o,
				clientChange: function() {
					r.classesToRemove && n.removeClass(r.classesToRemove.join(" "));
					r.classesToAdd && n.addClass(r.classesToAdd.join(" "));
					r.attributesToRemoveFromElement && a.each(r.attributesToRemoveFromElement,
					function(a, d) {
						n.removeAttr(d)
					})
				}
			}))
		}
	};
	a.fn.oneImageEditPopupAdjust = function(d) {
		function e() {
			r.click()
		}
		var l = this,
		m, n, o = l.closest(".popupWinExample"),
		r,
		u = o.find(".closeThis"),
		s = l.find(".rightPanelTabsWrapper"),
		B = !1;
		this.hasClass("oneImagePicker") ? (m = l.find(".oneImagePickerPopupHeader"), n = l.find(".oneImagePickerPopupFooter"), m = m.find(".oneImagePickerTitle"), n.find(".oneImagePickerUploadButton"), r = n.find('[type\x3d"file"]')) : (m = a('\x3cdiv class\x3d"oneImagePickerPopupHeader"\x3e\x3cdiv class\x3d"oneImagePickerTitle"\x3e\x3c/div\x3e\x3c/div\x3e'), n = a(['\x3cform class\x3d"oneImagePickerPopupFooter"\x3e\n\t\x3cinput id\x3d"oneUploadImage" type\x3d"file" name\x3d"uploadfile" multiple\x3d"multiple" class\x3d"filestyle"\x3e', '\t\x3cdiv id\x3d"oneOkButton" class\x3d"ptOrangeBtn"\x3e' + dmStr["ui.done"] + "\x3c/div\x3e", "\x3c/form\x3e"].join("\n")), o.css({
			height: "570px",
			width: "860px"
		}), l.addClass("oneImagePicker"), l.prepend(m), l.append(n), m = m.find(".oneImagePickerTitle"), n.find(".oneImagePickerUploadButton"), r = n.find('[type\x3d"file"]'), r.filestyle({
			input: !1,
			classButton: "oneImagePickerUploadButton",
			classIcon: "dm-icon-image",
			buttonText: "Upload new image"
		}), d.isBgCustomize ? m.html("Customize Background") : m.html("Choose \x26 Place Images"), l.off("click", ".oneImagePickerUploadButton").on("click", ".oneImagePickerUploadButton", e));
		l.off("change", "form.oneImagePickerPopupFooter").on("change", "form.oneImagePickerPopupFooter",
		function() {
			B = !0;
			s.find('[identifier\x3d"upload"]').click()
		});
		l.off("uploadTabReady").on("uploadTabReady",
		function() {
			B && (B = !1, a.dmLoading(l), window._limitAttach(n[0], r.val(), l[0]))
		});
		a("#oneOkButton").off("click").on("click",
		function() {
			switch (l.find(".tabSelect").attr("identifier")) {
			case "url":
				g(l).call();
				u.click();
				break;
			case "url_icon":
				g(l).call();
				u.click();
				break;
			default:
				d.isMultipleUpload ? l.find(".selectMultiItemsBtn").click() : u.click()
			}
		});
		m = s.children();
		var z = m.length,
		v = o.width(),
		o = Math.floor(v / z),
		z = v - (z - 1) * o;
		m.filter(":not(.tabSelect)").css({
			width: o + "px"
		});
		m.filter(".tabSelect").css({
			width: z + "px"
		})
	};
	a.fn.adjustDudaoneIconPicker = function(a) {
		var d = this.closest("#_editor").find(".addImageButton");
		initButtonImage = function(d) {
			d.show();
			d.neeSecondaryIconTabs({
				tabs: {
					upload_icon: [],
					url_icon: []
				},
				isImagePickerPopup: !0,
				isIconPicker: !0,
				callback: a.callback
			})
		};
		d.data("neePopUpDiv") || d.neePopUpDiv(this.find("#headerToOpenChange"), {
			init: initButtonImage
		})
	}
})(jQuery);
$.extend({
	_dmc: {
		defaultIconsColors: "#0a0a0a #ffffff #ff0084 #6422f2 #2222f2 #22c8f2 #33f222 #ebf222 #ff6f00 #ff0000".split(" "),
		defaultPTIconsColors: "#0a0a0a #ffffff #ff0084 #6422f2 #2222f2 #22c8f2 #33f222".split(" "),
		iconPicker: {},
		_loadDefaultIcons: function() {
			$.isEmpty($._dmc.iconPicker) && $.ajax({
				url: "/editor/nee/utils/nee.dafaultIcons.js",
				dataType: "script",
				success: function() {
					$._dmc.iconPicker = $._dmc.iconPickerDefault
				}
			})
		}
	}
}); (function(a) {
	a.fn.neeSecondaryDesignTabs = function(g) {
		g = g || {};
		g.colorCallbacks = g.colorCallbacks || {};
		g.onReadyCallbacks = g.onReadyCallbacks || {};
		g.colorPreviewCallbacks = g.colorPreviewCallbacks || {};
		g.colorDefaults = g.colorDefaults || {};
		g.elementArray = g.elementArray || {};
		g.selectors = g.selectors || {};
		g.specForceClassName = g.specForceClassName || {};
		g.colorSelectors = g.colorSelectors || {};
		for (var j = this,
		k = a.dmx.current.element || g.currentPreviewElement,
		m = 0 < k.length ? k.get(0).nodeName.toLowerCase() : null, l = g.changeGlobally, B = g.forceClassName, z = [{
			id: "navpresets",
			name: dmStr["ui.nee.common.design.1"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: "A",
			selector: null,
			specificWidgetTemp: _buildNavPresets
		},
		{
			id: "menu_name",
			name: dmStr["ui.nee.common.design.3"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: "DIV",
			selector: g.selector || null,
			forceClassName: g.specForceClassName.menu_name || null
		},
		{
			id: "menu_desc",
			name: dmStr["ui.nee.common.design.5"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: "DIV",
			selector: g.selector || null,
			forceClassName: g.specForceClassName.menu_desc || null
		},
		{
			id: "background",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.bgSelector || g.selector || null,
			callback: g.colorCallbacks.background,
			changePreview: g.colorPreviewCallbacks.background,
			forceClassName: g.specForceClassName.background || null,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d, e) {
				if (d, e) {
					var k = j.find("#additionalWidgetPlaceholder");
					e && (k = e.find("#additionalWidgetPlaceholder"));
					k.neeAddBackgroundImagePlaceholder({
						elem: g.forceClassName ? a(a.dmfw.getPreviewElement(g.forceClassName).get(0)) : a.dmx.current.element,
						forceClassName: g.specForceClassName.backgroundBg || g.forceClassName,
						callback: g.colorCallbacks.bgimage ? g.colorCallbacks.bgimage: j.neeChangeImage,
						changeGlobally: l ? !0 : !1,
						selector: g.selector || g.specForceClassName.backgroundBg
					})
				}
			}
		},
		{
			id: "background-color",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.bgSelector || g.selector || null,
			callback: g.colorCallbacks.background,
			changePreview: g.colorPreviewCallbacks.background,
			forceClassName: g.specForceClassName.background || null,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e")
		},
		{
			id: "group_start_menu",
			name: "Menu"
		},
		{
			id: "group_start_item",
			name: "Item"
		},
		{
			id: "group_start_selected_item",
			name: "Selected Item"
		},
		{
			id: "group_start_single_item",
			name: "Single Item"
		},
		{
			id: "group_end"
		},
		{
			id: "single_item_icon_color",
			name: dmStr["ui.icon"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			callback: g.colorCallbacks.single_item_icon_color,
			changePreview: null,
			forceClassName: g.specForceClassName.single_item_icon_color
		},
		{
			id: "selected_item_icon_color",
			name: dmStr["ui.icon"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			callback: g.colorCallbacks.selected_item_icon_color,
			changePreview: null,
			forceClassName: g.specForceClassName.selected_item_icon_color
		},
		{
			id: "single_item_bg_color",
			extensionOf: "background",
			forceClassName: g.specForceClassName.single_item_bg_color,
			callback: g.colorCallbacks.single_item_bg_color
		},
		{
			id: "selected_item_bg_color",
			extensionOf: "background",
			forceClassName: g.specForceClassName.selected_item_bg_color,
			callback: g.colorCallbacks.selected_item_bg_color
		},
		{
			id: "selected_item_text_color",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			callback: g.colorCallbacks.selected_item_text_color,
			changePreview: null,
			forceClassName: g.specForceClassName.selected_item_text_color
		},
		{
			id: "selected_item_underline_color",
			name: "Underline",
			attr: "border-color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			callback: g.colorCallbacks.selected_item_underline_color,
			changePreview: null,
			forceClassName: g.specForceClassName.selected_item_underline_color
		},
		{
			id: "nav_color",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			paletteKey: "nav-color",
			callback: g.colorCallbacks.nav_color,
			changePreview: null,
			forceClassName: null
		},
		{
			id: "header_color",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: null,
			paletteKey: "header-color",
			callback: g.colorCallbacks.header_color,
			changePreview: null,
			forceClassName: null
		},
		{
			id: "layout_background",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			callback: g.colorCallbacks.layout_background,
			changePreview: g.colorPreviewCallbacks.background,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: a(a.dmfw.getPreviewElement(g.selectors.layout_background_img).get(0)),
					forceClassName: g.selectors.layout_background_img,
					callback: g.colorCallbacks.layout_background_img ? g.colorCallbacks.layout_background_img: j.neeChangeImage,
					changeGlobally: !0,
					selector: null
				})
			}
		},
		{
			id: "layout_active_background",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			callback: g.colorCallbacks.layout_active_background,
			changePreview: g.colorPreviewCallbacks.background,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: a(a.dmfw.getPreviewElement(g.selectors.layout_active_background_img).get(0)),
					forceClassName: g.selectors.layout_active_background_img,
					callback: g.colorCallbacks.layout_active_background_img ? g.colorCallbacks.layout_active_background_img: j.neeChangeImage,
					changeGlobally: !0,
					selector: null
				})
			}
		},
		{
			id: "layout_exp_button_bg",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			callback: g.colorCallbacks.layout_exp_button_bg,
			changePreview: g.colorPreviewCallbacks.background,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: a(a.dmfw.getPreviewElement(g.selectors.layout_exp_button_bg_img).get(0)),
					forceClassName: g.selectors.layout_exp_button_bg_img,
					callback: g.colorCallbacks.layout_exp_button_bg_img ? g.colorCallbacks.layout_exp_button_bg_img: j.neeChangeImage,
					changeGlobally: !0,
					selector: null
				})
			}
		},
		{
			id: "layout_exp_background",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			callback: g.colorCallbacks.layout_exp_background,
			changePreview: g.colorPreviewCallbacks.background,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: a(a.dmfw.getPreviewElement("ul.dmNavigation").get(0)),
					forceClassName: "ul.dmNavigation",
					callback: g.colorCallbacks.layout_exp_bgimage ? g.colorCallbacks.layout_exp_bgimage: j.neeChangeImage,
					changeGlobally: !0,
					selector: null
				})
			}
		},
		{
			id: "background_widgets",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: g.forceClassName ? a(a.dmfw.getPreviewElement(g.forceClassName).get(0)) : a.dmx.current.element,
					forceClassName: g.forceClassName,
					callback: j.neeChangeImage,
					selector: g.selector,
					changeGlobally: l ? !0 : !1
				})
			}
		},
		{
			id: "text",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.textSelector || g.selector || null,
			colorSelector: g.colorSelectors.text || null,
			callback: g.colorCallbacks.text,
			changePreview: g.colorPreviewCallbacks.text,
			forceClassName: g.specForceClassName.text || null
		},
		{
			id: "active_text",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.textSelector || g.selector || null,
			callback: g.colorCallbacks.active_text,
			changePreview: g.colorPreviewCallbacks.active_text
		},
		{
			id: "layout_exp_text",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.icons"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.textSelector || g.selector || null,
			callback: g.colorCallbacks.layout_exp_text,
			changePreview: g.colorPreviewCallbacks.text
		},
		{
			id: "layout_exp_button_text",
			name: dmStr["ui.icon"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.textSelector || g.selector || null,
			callback: g.colorCallbacks.layout_exp_button_text,
			changePreview: g.colorPreviewCallbacks.text
		},
		{
			id: "title",
			name: dmStr["ui.nee.common.design.8"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.titleTextSelector || g.selector || null,
			callback: g.colorCallbacks.text,
			changePreview: g.colorPreviewCallbacks.text
		},
		{
			id: "nav_arrow",
			name: dmStr["ui.nee.common.design.9"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.10"] + " ",
			tagName: "A",
			selector: null,
			forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a .navArrowBg",
			hideIf: _navHasNoArrows
		},
		{
			id: "exp_nav_bg",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: "A",
			selector: null,
			forceClassName: "DIV.expandableInnerMostContainer"
		},
		{
			id: "exp_nav_text",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: "A",
			selector: null,
			changePreview: a.navigationUtil.changePreviewExpandableMenuForegroundColor,
			callback: a.navigationUtil.changeExpandableMenuForegroundColor,
			forceClassName: "#dm DIV.expandableInnerMostContainer a"
		},
		{
			id: "exp_nav_shape",
			name: dmStr["ui.shape"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.12"] + " ",
			tagName: "A",
			selector: null,
			forceClassName: "SPAN#expandableButtonInPage",
			additionalWidget: a("\x3cdiv class\x3d'expandableShapePlaceHolder'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function() {
				a(".colorPickerWidget .colorPalette").hide();
				a(".expandableShapePlaceHolder").expandableNavigationShape()
			}
		},
		{
			id: "exp_button_alignment",
			name: dmStr["ui.general"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.12"] + " ",
			tagName: "A",
			selector: null,
			forceClassName: "SPAN#expandableButtonInPage",
			additionalWidget: a("\x3cdiv class\x3d'alignmentWidgetPlaceHolder'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function() {
				a(".colorPickerWidget .colorPalette").hide();
				a(".alignmentWidgetPlaceHolder").expandableNavigationAlignment()
			}
		},
		{
			id: "exp_button_label",
			name: dmStr["ui.nee.common.design.14"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.15"] + " ",
			tagName: "A",
			selector: null,
			forceClassName: "SPAN#expandableButtonInPage",
			changePreview: a.navigationUtil.changePreviewExpandableButtonForegroundColor,
			callback: a.navigationUtil.changeExpandableButtonForegroundColor
		},
		{
			id: "exp_button_bg",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.12"] + " ",
			tagName: "A",
			selector: null,
			forceClassName: "SPAN#expandableButtonInPage.menuButtonElement",
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(d) {
				d && j.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: a(a.dmfw.getPreviewElement("SPAN#expandableButtonInPage")),
					forceClassName: "SPAN#expandableButtonInPage.menuButtonElement",
					callback: function(d) {
						a.dmops.updateGlobalCssAndElement({
							attrToAdd: [{
								attr: "background-image",
								value: "url(" + d + ")"
							}]
						},
						{
							className: "SPAN#expandableButtonInPage.menuButtonElement",
							clientOnly: !1
						})
					},
					changeGlobally: !0
				})
			}
		},
		{
			id: "arrow",
			name: dmStr["ui.nee.common.design.9"],
			attr: "border-color",
			attrToWrite: dmStr["ui.nee.common.design.16"] + " ",
			callback: g.colorCallbacks.arrow,
			tagName: "A",
			selector: null,
			necessaryAttr: {
				attr: "border-style",
				value: "solid"
			},
			attrSpecificToGetColor: "border-top-color"
		},
		{
			id: "list_item_border",
			name: dmStr["ui.nee.common.design.22"],
			hideOpacity: !0,
			attr: "border-color",
			attrToWrite: dmStr["ui.nee.common.design.22"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: ".dmLinkList .itemContainer",
			attrSpecificToGetColor: "border-bottom-color",
			hideIf: function() {
				return a(a.dmx.current.element).hasClass("listItemNoDivider")
			}
		},
		{
			id: "list_item_arrows",
			name: dmStr["ui.nee.common.design.9"],
			attr: "background-color",
			attrToWrite: dmStr["ui.nee.common.design.19"] + " ",
			tagName: "A",
			selector: null,
			hideIf: function() { ! a(a.dmx.current.element).hasClass("listItemNoArrows")
			}
		},
		{
			id: "single_item_border",
			extensionOf: "border",
			forceClassName: g.specForceClassName.single_item_border
		},
		{
			id: "border",
			hideOpacity: !0,
			name: dmStr["ui.nee.common.design.17"],
			attr: "border-color",
			attrToWrite: dmStr["ui.nee.common.design.17"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.selector || null,
			forceClassName: g.specForceClassName.border || null,
			necessaryAttr: {
				attr: "border-style",
				value: "solid"
			},
			attrSpecificToGetColor: "border-top-color",
			additionalWidget: a("\x3cdiv id\x3d'borderColorSettings'\x3e\x3chr/\x3e\x3cbr/\x3e\x3cspan\x3e" + dmStr["ui.nee.twitter.14"] + ":\x3c/span\x3e \x3cinput id\x3d'borderSize' type\x3dtext' /\x3e\x3cdiv class\x3d'sliderBorderWrapper'\x3e\x3cdiv id\x3d'sliderBorder'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),
			additionalWidgetInit: function() {
				var d = function(d) {
					var e = {
						classesToRemove: null,
						attrToRemove: null,
						classesToAdd: null,
						attrToAdd: [{
							attr: "border-width",
							value: a("#borderSize").val()
						},
						{
							attr: "border-style",
							value: "solid"
						}]
					};
					l ? a.dmops.updateGlobalCssAndElement(e, {
						className: B,
						clientOnly: d ? d.clientOnly: !1
					}) : a.dmops.updateCurrentCss(e, d)
				},
				e = g.forceClassName ? a(a.dmfw.getPreviewElement(g.forceClassName).get(0)) : a.dmx.current.element;
				a("#sliderBorder").slider({
					range: "min",
					value: parseInt(e.css("border-left-width")),
					min: 0,
					max: 25,
					step: 1,
					slide: function(e, j) {
						a("#borderSize").val(j.value + "px");
						var k = a.extend({
							clientOnly: !0
						},
						g);
						d(k)
					},
					stop: function() {
						d(g)
					}
				});
				a("#borderSize").val(e.css("border-left-width"));
				a("#borderSize").blur(function() {
					d()
				});
				a("#borderSize").keypress(function(a) {
					13 == a.keyCode && d(g)
				})
			}
		},
		{
			id: "inner_border",
			hideOpacity: !0,
			name: "Inner Border",
			attr: "border-color",
			attrToWrite: dmStr["ui.nee.common.design.17"].toLowerCase() + " ",
			tagName: g.tagName || m,
			selector: g.inner_border_selector || null,
			forceClassName: g.inner_border_selector,
			necessaryAttr: {
				attr: "border-style",
				value: "solid"
			},
			attrSpecificToGetColor: "border-top-color",
			additionalWidget: a("\x3cdiv id\x3d'innerBorderColorSettings'\x3e\x3chr/\x3e\x3cbr/\x3e\x3cspan\x3e" + dmStr["ui.nee.twitter.14"] + ":\x3c/span\x3e \x3cinput id\x3d'innerBorderSize' type\x3dtext' /\x3e\x3cdiv class\x3d'sliderBorderWrapper'\x3e\x3cdiv id\x3d'sliderInnerBorder'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),
			additionalWidgetInit: function() {
				var d = function(d) {
					var e = {
						classesToRemove: null,
						attrToRemove: null,
						classesToAdd: null,
						attrToAdd: [{
							attr: "border-width",
							value: a("#innerBorderSize").val()
						},
						{
							attr: "border-style",
							value: "solid"
						}]
					};
					if (l) a.dmops.updateGlobalCssAndElement(e, {
						className: B,
						clientOnly: d ? d.clientOnly: !1
					});
					else {
						var g = {
							selector: d.inner_border_selector
						};
						jQuery.extend(g, d);
						a.dmops.updateCurrentCss(e, g)
					}
				},
				e = (g.inner_border_selector ? a(a.dmfw.getPreviewElement(g.inner_border_selector).get(0)) : a.dmx.current.element).css("border-left-width");
				a("#sliderInnerBorder").slider({
					range: "min",
					value: parseInt(e),
					min: 0,
					max: 25,
					step: 1,
					slide: function(e, j) {
						a("#innerBorderSize").val(j.value + "px");
						var k = a.extend({
							clientOnly: !0
						},
						g);
						d(k)
					},
					stop: function() {
						d(g)
					}
				});
				a("#innerBorderSize").val(e);
				a("#innerBorderSize").blur(function() {
					d()
				});
				a("#innerBorderSize").keypress(function(a) {
					13 == a.keyCode && d(g)
				})
			}
		},
		{
			id: "nav_icons_color",
			name: dmStr["ui.icons"],
			attr: "color",
			attrToWrite: dmStr["ui.icons"].toLowerCase() + " ",
			colorSelector: g.colorSelectors.nav_icons || null,
			callback: g.colorCallbacks.icons,
			tagName: "A",
			selector: null,
			hideIf: _navHasNoIcons,
			hideOpacity: !0
		},
		{
			id: "presets_old",
			name: dmStr["ui.nee.common.design.1"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: "A",
			selector: null
		},
		{
			id: "menu_divider_style",
			name: dmStr["ui.nee.common.design.22"],
			attr: "border-bottom-color",
			attrToWrite: dmStr["ui.nee.common.design.22"].toLowerCase() + " ",
			tagName: "DIV",
			selector: g.selector,
			forceClassName: g.specForceClassName.menu_divider_style || null,
			hideOpacity: !0,
			necessaryAttr: {
				attr: "border-bottom-style",
				value: "solid"
			}
		},
		{
			id: "yelp_reviews_divider",
			hideOpacity: !0,
			name: dmStr["ui.nee.common.design.22"],
			attr: "border-bottom-color",
			attrToWrite: dmStr["ui.nee.common.design.22"].toLowerCase() + " ",
			tagName: "DIV",
			selector: ".yelpReviewItem"
		},
		{
			id: "link",
			name: dmStr["ui.link"],
			attr: "color",
			attrToWrite: "Link ",
			selector: g.LnkSelector,
			forceClassName: g.specForceClassName.link || null
		},
		{
			id: "link_gb",
			name: dmStr["ui.link"],
			attr: "color",
			attrToWrite: "Link ",
			forceClassName: "*#dm div.dmContent A",
			colorDefaults: g.colorDefaults.link_gb,
			callback: g.colorCallbacks.link,
			changePreview: g.colorPreviewCallbacks.link
		},
		{
			id: "underline_links_pt",
			name: dmStr["ui.link"],
			attr: "background-color",
			attrToWrite: "Link ",
			callback: g.colorCallbacks.underline_links_pt,
			showOnlyAdditional: !0,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.underline_links_pt(j)
			}
		},
		{
			id: "font_type_pt",
			name: dmStr["ui.link"],
			attr: "background-color",
			attrToWrite: "Link ",
			callback: g.colorCallbacks.font_type_pt,
			showOnlyAdditional: !0,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.font_type_pt(j)
			}
		},
		{
			id: "font_size_pt",
			name: dmStr["ui.link"],
			attr: "background-color",
			attrToWrite: "Link ",
			callback: g.colorCallbacks.font_size_pt,
			showOnlyAdditional: !0,
			additionalWidget: a("\x3cdiv class\x3d'headerTextSizeChange'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.font_size_pt(j)
			}
		},
		{
			id: "heading_num1_pt",
			name: dmStr["ui.controls.design.heading"] + " 1",
			attr: "color",
			attrToWrite: "Heading 1 ",
			callback: g.colorCallbacks.heading_num1_pt,
			changePreview: g.colorPreviewCallbacks.heading_num1_pt,
			colorDefaults: g.colorDefaults.heading_num1_pt,
			forceClassName: "*#dm div.dmContent h1",
			additionalWidget: a("\x3cdiv class\x3d'warningHalert dm-icon-warning-sign oneIcon displayNone'\x3e\x3c/div\x3e\x3cdiv class\x3d'headerTextSizeChange'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.heading_num1_pt(j)
			}
		},
		{
			id: "heading_num2_pt",
			name: dmStr["ui.controls.design.heading"] + " 2",
			attr: "color",
			attrToWrite: "Heading 2 ",
			callback: g.colorCallbacks.heading_num2_pt,
			changePreview: g.colorPreviewCallbacks.heading_num2_pt,
			colorDefaults: g.colorDefaults.heading_num2_pt,
			forceClassName: "*#dm div.dmContent h2",
			additionalWidget: a("\x3cdiv class\x3d'warningHalert dm-icon-warning-sign oneIcon displayNone'\x3e\x3c/div\x3e\x3cdiv class\x3d'headerTextSizeChange'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.heading_num2_pt(j)
			}
		},
		{
			id: "heading_num3_pt",
			name: dmStr["ui.controls.design.heading"] + " 3",
			attr: "color",
			attrToWrite: "Heading 3 ",
			callback: g.colorCallbacks.heading_num3_pt,
			changePreview: g.colorPreviewCallbacks.heading_num3_pt,
			colorDefaults: g.colorDefaults.heading_num3_pt,
			forceClassName: "*#dm div.dmContent h3",
			additionalWidget: a("\x3cdiv class\x3d'warningHalert dm-icon-warning-sign oneIcon displayNone'\x3e\x3c/div\x3e\x3cdiv class\x3d'headerTextSizeChange'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.heading_num3_pt(j)
			}
		},
		{
			id: "heading_num4_pt",
			name: dmStr["ui.controls.design.heading"] + " 4",
			attr: "color",
			attrToWrite: "Heading 4 ",
			callback: g.colorCallbacks.heading_num4_pt,
			changePreview: g.colorPreviewCallbacks.heading_num4_pt,
			colorDefaults: g.colorDefaults.heading_num4_pt,
			forceClassName: "*#dm div.dmContent h4",
			additionalWidget: a("\x3cdiv class\x3d'warningHalert dm-icon-warning-sign oneIcon displayNone'\x3e\x3c/div\x3e\x3cdiv class\x3d'headerTextSizeChange'\x3e\x3c/div\x3e"),
			additionalWidgetInit: function(a) {
				a && g.onReadyCallbacks.heading_num4_pt(j)
			}
		}], v = z.map(function(a) {
			return a.id.toLowerCase()
		}), z = z.map(function(d) {
			var e = d;
			if (d.extensionOf) {
				var g = a.inArray(d.extensionOf, v); - 1 !== g && (e = a.extend(!0, {},
				z[g], d))
			}
			return e
		}), m = [{
			id: "menu_items",
			name: dmStr["ui.nee.navigation.4"],
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
			onReady: function() {
				g.menuItemsCallback()
			}
		},
		{
			id: "social_gallery_design",
			name: dmStr["ui.effects"],
			url: "/editor/nee/editableObjects/socialGallery/nee.socialGalleryCustomize.jsp",
			onReady: function() {
				g.onReady()
			}
		},
		{
			id: "navShape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/navigation/nee.navShapeEditor.jsp",
			onReady: function() {}
		},
		{
			id: "tabs_shape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/tabs/nee.tabsShapeEditor.jsp",
			onReady: function() {
				_initTabsShapes()
			}
		},
		{
			id: "sliderEffects",
			name: dmStr["ui.effects"],
			url: "/editor/nee/editableObjects/imageSlider/nee.imageSlider.designSliderCustomize.jsp",
			onReady: function() {
				g.onReadyCallbacks.slidereffects(j)
			}
		},
		{
			id: "exp_button_color",
			name: dmStr["ui.nee.widgets.10"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, g.elementArray.exp_button_color, "exp_button_color")
			},
			onClose: function() {
				d(z, g, g.elementArray.exp_button_color, "exp_button_color")
			}
		},
		{
			id: "footer_top_item_color",
			name: dmStr["ui.nee.item"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, g.elementArray.footer_top_item_color, "footer_top_item_color")
			},
			onClose: function() {
				d(z, g, g.elementArray.footer_top_item_color, "footer_top_item_color")
			}
		},
		{
			id: "footer_top_active_item_color",
			name: dmStr["ui.nee.activeItem"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, g.elementArray.footer_top_active_item_color, "footer_top_active_item_color")
			},
			onClose: function() {
				d(z, g, g.elementArray.footer_top_active_item_color, "footer_top_active_item_color")
			}
		},
		{
			id: "layout_exp_menu",
			name: dmStr["ui.nee.common.design.25"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, g.elementArray.layout_exp_menu, "layout_exp_menu")
			},
			onClose: function() {
				d(z, g, g.elementArray.layout_exp_menu, "layout_exp_menu")
			}
		},
		{
			id: "expandable_menu_color",
			name: dmStr["ui.nee.common.design.25"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, k, "expandable_menu_color")
			},
			onClose: function() {
				d(z, g, k, "expandable_menu_color")
			}
		},
		{
			id: "expandable_button_color",
			name: dmStr["ui.nee.common.design.26"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, k, "expandable_button_color")
			},
			onClose: function() {
				d(z, g, k, "expandable_button_color")
			}
		},
		{
			id: "list_design",
			name: dmStr["ui.nee.common.design.27"],
			url: "/editor/nee/editableObjects/common/nee.listDesignSettings.jsp",
			onReady: function() {
				j.neeSecondaryDesignListDesign(g)
			}
		},
		{
			id: "list_layout",
			name: dmStr["ui.nee.common.design.27"],
			url: "/editor/nee/editableObjects/list/nee.listLayout.jsp",
			onReady: function() {
				a.dmx.current.editable.bindLayoutAction()
			}
		},
		{
			id: "gallery_layout",
			name: "Layout",
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				g.galleryLayoutCallback()
			}
		},
		{
			id: "color",
			name: dmStr["ui.color"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				e(z, g, j, k, "color")
			},
			onClose: function() {
				d(z, g, k, "color")
			}
		},
		{
			id: "widgetShape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/navigation/nee.widgetShapeEditor.jsp",
			onReady: function() {
				_initWidgetShapes()
			},
			hideIf: function() {
				return a.dmfw.isDudaone()
			}
		},
		{
			id: "combined_style",
			name: dmStr["ui.nee.common.design.35"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				j.neeSecondaryTextAndTitleStyleTab(g)
			}
		},
		{
			id: "combined_style_review",
			name: dmStr["ui.nee.common.design.35"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				j.neeSecondaryTextAndTitleStyleTabYelp(g)
			}
		},
		{
			id: "shape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlBasicShape.jsp",
			onReady: function() {
				j.neeSecondaryShapeTab(g)
			},
			hideIf: function() {
				return a.dmfw.isDudaone() || a.browser.msie && (9 > a.browser.version || 9 > document.documentMode)
			}
		},
		{
			id: "list_shape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlBasicShape.jsp",
			onReady: function() {
				j.neeSecondaryShapeTab({
					isForChildren: !0
				})
			}
		},
		{
			id: "navcontshape",
			name: dmStr["ui.shape"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlBasicShape.jsp",
			onReady: function() {
				_initContainerShapes()
			},
			hideIf: function() {
				return a.browser.msie && (9 > a.browser.version || 9 > document.documentMode)
			}
		},
		{
			id: "resize",
			name: dmStr["ui.resize"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlResize.jsp",
			onReady: function() {
				j.neeSecondaryResizeTab()
			}
		},
		{
			id: "navsettings",
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationMoreSettings.jsp .editContentWrapper",
			name: dmStr["ui.settings"],
			onReady: function() {
				g.container.navigationGeneralSettingsTabReady()
			}
		},
		{
			id: "general_design_settings",
			name: dmStr["ui.spacing"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDesignSettings.jsp",
			onReady: function() {
				j.neeSecondaryDesignGenealSettingsTab(g)
			}
		},
		{
			id: "alignment_design_settings",
			name: dmStr["ui.alignment"],
			url: a.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/common/one.buttonsHtmlDesignAdvanced.jsp": "/editor/nee/editableObjects/common/nee.buttonsHtmlDesignAdvanced.jsp",
			onReady: function() {
				j.neeSecondaryDesignAlignmentSettingsTab()
			}
		},
		{
			id: "css",
			name: dmStr["ui.css.u"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlCSS.htm",
			onReady: function() {
				j.neeSecondaryCSSTab()
			}
		},
		{
			id: "html",
			name: dmStr["ui.html.u"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlHtml.jsp",
			onReady: function() {
				j.neeSecondaryHTMLTab()
			},
			hideIf: function() {
				return a.dmx.page.alias == DEFAULT_PAGE_DESIGN_ALIAS || isWLSubUser
			}
		},
		{
			id: "navhtml",
			name: dmStr["ui.html.u"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlHtml.jsp",
			onReady: function() {
				j.neeSecondaryHTMLTab({
					forceId: "elementWrapperDiv",
					inHeader: !0
				})
			},
			hideIf: function() {
				return isWLSubUser
			}
		},
		{
			id: "navCustomize",
			name: dmStr["ui.effects"],
			url: "/editor/nee/editableObjects/navigation/nee.navigation.designCustomize.jsp",
			onReady: function() {
				j.neeSecondaryNavCustomizeTab()
			}
		},
		{
			id: "socialhub_design",
			name: dmStr["ui.nee.socHub.7"],
			url: "/editor/nee/editableObjects/socialHub/nee.socialHubIconsStyle.jsp",
			onReady: function() {
				a.dmx.current.editable.designTab()
			}
		},
		{
			id: "socialhub_layout",
			name: dmStr["ui.nee.socHub.8"],
			url: "/editor/nee/editableObjects/socialHub/nee.socialHubLayout.jsp",
			onReady: function() {
				a.dmx.current.editable.layoutTab()
			}
		},
		{
			id: "text_style",
			name: dmStr["ui.nee.common.design.35"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
			onReady: function() {
				j.neeSecondaryTextStyleTab(g)
			}
		},
		{
			id: "title_text_style",
			name: dmStr["ui.nee.common.design.36"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
			onReady: function() {
				j.neeSecondaryTextStyleTab(a.extend({},
				g, {
					textSelector: g.titleTextSelector
				}))
			}
		},
		{
			id: "crop",
			name: dmStr["ui.nee.common.design.37"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlCrop.jsp",
			onReady: function() {
				j.neeSecondaryCropTab(g && g.sliderCropOptions)
			},
			onClose: function() {
				a.dmfw.hideEditorButton({
					selector: ".cropButton"
				})
			}
		}], D = g.tabs, E = [], F = 0; F < m.length; F++) D[m[F].id.toLowerCase()] && (!m[F].hideIf || !m[F].hideIf()) && E.push(m[F]);
		a(this).neeSecondaryTabsControl(E)
	};
	var e = function(d, e, g, j, k) {
		var m, l, v, D;
		if (e.justBackBtn) {
			var E = a(".footerEditable");
			0 < E.length && (E.find(".updateButton").hide(), E.find(".backButton").removeClass("ptGreyBtn").addClass("ptOrangeBtn"))
		}
		D = d.map(function(a) {
			return a.id.toLowerCase()
		});
		E = [];
		if (e.keepOrder) {
			l = e.tabs[k].length;
			k = e.tabs[k];
			for (m = 0; m < l; m++) v = jQuery.inArray(k[m], D),
			-1 !== v && (e.forceClassName && (d[v].forceClassName = d[v].forceClassName || e.forceClassName), (!d[v].hideIf || !d[v].hideIf()) && E.push(d[v]))
		} else for (m = 0; m < d.length; m++) - 1 != jQuery.inArray(d[m].id.toLowerCase(), e.tabs[k]) && (e.forceClassName && (d[m].forceClassName = d[m].forceClassName || e.forceClassName), (!d[m].hideIf || !d[m].hideIf()) && E.push(d[m]));
		d = {};
		e.changeGlobally && (d.changeGlobally = e.changeGlobally);
		d.previewElementToWorkOn = j;
		e.forceElementFromClassName && (d.specForceClassName = e.specForceClassName);
		g.neeSecondaryColorTab(E, d)
	},
	d = function(a, d, e, g) {
		for (var j = [], k = 0; k < a.length; k++) if ( - 1 != jQuery.inArray(a[k].id.toLowerCase(), d.tabs[g]) && !a[k].id.startsWith("group_")) {
			var m = e.css(a[k].attr);
			a[k].selector && (m = e.find(a[k].selector).css(a[k].attr));
			a[k].attrSpecificToGetColor && (m = e.css(a[k].attrSpecificToGetColor));
			j.push(m)
		}
		e.neeAddColorsToSite(j)
	};
	a.fn.neeSecondaryShapeTab = function(d) {
		options = d || {};
		d = options.useElement ? options.useElement: a.dmx.current.element;
		var e = options.isForChildren || options.isShapeForChildren ? 2 : 1;
		if (options.isForChildren || options.isShapeForChildren) options.selector = "";
		var g = {
			1 : "rectangle",
			2 : "rectangleToChildren"
		},
		j = {
			1 : "normalRounded",
			2 : "normalRoundedToChildren"
		},
		k = {
			1 : "bottomRounded",
			2 : "bottomRoundedToChildren"
		},
		m = {
			1 : "topRounded",
			2 : "topRoundedToChildren"
		},
		l = {
			1 : "shadowEffect",
			2 : "shadowEffectToChildren"
		},
		v = {
			1 : "threeDEffect",
			2 : "threeDEffectToChildren"
		};
		d.is("." + g[e]) ? a("#rectangle").addClass("shapeSelected") : d.is("." + j[e]) ? a("#normalRounded").addClass("shapeSelected") : d.is("." + k[e]) ? a("#bottomRounded").addClass("shapeSelected") : d.is("." + m[e]) ? a("#topRounded").addClass("shapeSelected") : a("#rectangle").addClass("shapeSelected");
		var D = function(a) {
			switch (a) {
			case "rectangle":
				return g[e];
			case "normalRounded":
				return j[e];
			case "bottomRounded":
				return k[e];
			case "topRounded":
				return m[e];
			case "shadowEffect":
				return l[e];
			case "threeDEffect":
				return v[e]
			}
		};
		options.hideShadowControl && a("#onOffBtnsShape").hide();
		a(".shape").click(function() {
			a(".shape").removeClass("shapeSelected");
			a(this).addClass("shapeSelected");
			var d = a(this).attr("id"),
			d = D(d);
			a.dmops.updateCurrentCss({
				classesToRemove: [g[e], j[e], k[e], m[e]],
				attrToRemove: null,
				classesToAdd: [d],
				attrToAdd: null
			},
			options)
		});
		var E = {
			initState: d.is("." + l[e]),
			onFn: function() {
				var d = {
					classesToRemove: null,
					attrToRemove: null,
					classesToAdd: [D("shadowEffect")],
					attrToAdd: null
				};
				a.dmops.updateCurrentCss(d, options)
			},
			offFn: function() {
				var d = {
					classesToRemove: null,
					attrToAdd: null,
					classesToRemove: [D("shadowEffect")],
					attrToAdd: null
				};
				a.dmops.updateCurrentCss(d, options)
			}
		};
		a("#shadowOnOff").onOffBtn(E);
		E = {
			initState: d.is("." + v[e]),
			onFn: function() {
				var d = {
					classesToRemove: null,
					attrToRemove: ["border-style", "border-color", "border-width"],
					classesToAdd: [D("threeDEffect")],
					attrToAdd: null
				};
				a.dmops.updateCurrentCss(d, options)
			},
			offFn: function() {
				var d = {
					classesToRemove: null,
					attrToAdd: null,
					classesToRemove: [D("threeDEffect")],
					attrToAdd: null
				};
				a.dmops.updateCurrentCss(d, options)
			}
		};
		a("#effect3dOnOff").onOffBtn(E)
	};
	a.fn.neeSecondaryColorTab = function(d, e) {
		if (a.dmfw.isPT() || a.dmfw.isDudaone()) this.neeSecondaryColorTabPT(d, e);
		else {
			for (var g = -1,
			j = e || {},
			k = j.previewElementToWorkOn || a.dmx.current.element,
			m = a(this).find(".ColorFilterMenu"), m = a('\x3cdiv id\x3d"ColorTextInsideFilter"\x3e\x3c/div\x3e').appendTo(m), l = d.length, v = 0; v < l; v++) a('\x3cspan class\x3d"ColorTabInsideFilter GreyBtn" id\x3d"' + d[v].attr + '" \x3e\x3c/span\x3e').html(d[v].name.replace("^", " ")).attr("currNum", v).appendTo(m);
			var D = function(e, k) {
				if (d[g].callback) d[g].changePreview && d[g].changePreview(e, k);
				else {
					var m = {
						classesToRemove: null,
						attrToRemove: [d[g].attrToRemove],
						classesToAdd: null,
						attrToAdd: [{
							attr: d[g].attr,
							value: e
						}]
					};
					d[g].necessaryAttr && m.attrToAdd.unshift(d[g].necessaryAttr);
					j.changeGlobally ? a.dmops.updateGlobalCssAndElement(m, {
						className: d[g].forceClassName,
						clientOnly: !0
					}) : d[g].selector ? a.dmops.updateCurrentCss(m, {
						selector: d[g].selector,
						tagName: d[g].tagName,
						clientOnly: !0
					}) : a.dmops.updateCurrentCss(m, {
						clientOnly: !0
					})
				}
			},
			E = function(e) {
				if (d[g].callback) d[g].callback(e);
				else {
					e = {
						classesToRemove: null,
						attrToRemove: d[g].attrToRemove ? [d[g].attrToRemove] : null,
						classesToAdd: null,
						attrToAdd: [{
							attr: d[g].attr,
							value: e
						}]
					};
					d[g].necessaryAttr && e.attrToAdd.unshift(d[g].necessaryAttr);
					if (j.changeGlobally) {
						var k = d[g].forceClassName;
						k && a.dmops.updateGlobalCssAndElement(e, {
							className: k,
							clientOnly: !1
						})
					} else d[g].selector ? a.dmops.updateCurrentCss(e, {
						selector: d[g].selector,
						tagName: d[g].tagName
					}) : a.dmops.updateCurrentCss(e, j);
					d[g].additionalWidgetInit && d[g].additionalWidgetInit(!1)
				}
			};
			a(".ColorTabInsideFilter").click(function(e) {
				a(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
				g = e = Number(a(e.currentTarget).attr("currnum"));
				a(".ColorTabInsideFilter").removeClass("ColorTabInsideFilterSelected");
				a(this).addClass("ColorTabInsideFilterSelected");
				if (d[e].specificWidget) d[e].specificWidget(a(".colorPickerWidget"));
				else {
					var j = k.css(d[e].attr);
					d[e].selector && (j = k.find(d[e].selector).css(d[e].attr));
					d[e].attrSpecificToGetColor && (j = k.css(d[e].attrSpecificToGetColor));
					d[e].forceClassName && (j = a(a.dmfw.getPreviewElement(d[g].forceClassName).get(0)).css(d[e].attr));
					a(".colorPickerWidget .colorPalette").show();
					a(".colorPickerWidget").neeColorPicker(j, d[e].attrToWrite, E, D);
					d[e].additionalWidget && (a(".slideRightPanelInner #additionalWidgetPlaceholder").append(d[e].additionalWidget), d[e].additionalWidgetInit && d[e].additionalWidgetInit(!0))
				}
			});
			a("#" + d[0].attr).trigger("click")
		}
	};
	a.fn.neeColorPicker = function(d, e, g, j) {
		if (a.dmfw.isPT() || a.dmfw.isDudaone()) this.neePtNewColorInnerScreen(d, e, g, j);
		else {
			this.currColor = d ? d: "#FFFFFF";
			var k = this.last();
			try {
				e = e.trim()
			} catch(m) {}
			d = "true" == dmStr["ui.noSpaceChar"] ? "": " ";
			a(k).find("#tabChanged").html(dmStr["ui.nee.common.design.2"] + d + e + d + dmStr["ui.color"].toLowerCase() + ": ");
			var l = a('\x3cdiv class\x3d"currendChanges"\x3e\x3c/div\x3e').appendTo(a(k).find(".colorCurrent").empty());
			a('\x3cdiv class\x3d"colorCube" id\x3d"currentColorExample" unselectable\x3d"on"\x3e\x3c/div\x3e').css("background-color", this.currColor).appendTo(l).attr("title", a.rgb2hex(this.currColor));
			"transparent" == this.currColor || "rgba(0, 0, 0, 0)" == this.currColor ? (k.find("#currentColorExample").addClass("noBg"), k.find("#currentColorExample").attr("title", dmStr["ui.nee.imagePicker.6"])) : k.find("#currentColorExample").removeClass("noBg");
			var v = a.dmx.site.colors;
			e = 28 < v.length ? 28 : v.length;
			l = a("\x3cdiv id\x3d'holdServerColors'\x3e\x3c/div\x3e");
			for (d = 0; d < e; d++) if ("undefined" != v[d]) {
				var D = a('\x3cdiv class\x3d"colorCube" unselectable\x3d"on" container\x3d"siteColorPalette"\x3e\x3c/div\x3e').attr("id", "serverColorNum" + d),
				E = v[d];
				D.css("background-color", E);
				D.attr("title", a.rgb2hex(E));
				l.append(D); ("transparent" == v[d] || "rgba(0,0,0,0)" == v[d]) && D.addClass("transparentSiteColor").attr("title", "transparent")
			}
			l.appendTo(a(this).find(".siteColorPalette").empty());
			l = "#012F0A #026721 #30A92A #97C000 #FEED01 #F69601 #EA4E01 #A40000 #EF2929 #E85095 #E60084 #930084 #2E1D87 #016DB5 #013C78 #000000 #474747 #8B8989 #CDC9C9 #FFFFFF transparent".split(" ");
			v = a("\x3cdiv\x3e\x3c/div\x3e");
			e = l.length;
			for (d = 0; d < e; d++) D = a('\x3cdiv class\x3d"colorCube" unselectable\x3d"on" container\x3d"standardColorPalette"\x3e\x3c/div\x3e').attr("id", "colorNum" + d),
			"transparent" == l[d] ? (D.css("background", "url(/editor/nee/images/design/noColor.png) no-repeat"), D.attr("title", dmStr["ui.nee.imagePicker.6"])) : (D.css("background-color", l[d]), D.attr("title", a.rgb2hex(l[d]))),
			v.append(D);
			v.appendTo(a(this).find(".standardColorPalette").empty());
			a('[id^\x3d"serverColorNum"],[id^\x3d"colorNum"]').click(function() {
				this.currColor = a(this).css("background-color");
				k.find("#currentColorExample").css("background-color", this.currColor).attr("title", a.rgb2hex(this.currColor));
				g(this.currColor);
				"transparent" == this.currColor || "rgba(0, 0, 0, 0)" == this.currColor ? k.find("#currentColorExample").addClass("noBg") : k.find("#currentColorExample").removeClass("noBg")
			});
			a(".triggerOpenColorPicker").unbind("click").click(function() {
				k.parent().find("#placementForColorPickerColor").neeOpenColorPicker(k.find("#currentColorExample").css("background-color"),
				function(d) {
					this.currColor = d;
					k.find("#currentColorExample").css("background-color", this.currColor).attr("title", a.rgb2hex(this.currColor));
					g(this.currColor);
					a(this).neeAddColorsToSite([this.currColor]);
					27 >= k.find('[id^\x3d"serverColorNum"]').length && (d = k.find("#serverColorNum0").clone(!0), d.attr("id", "serverColorNum" + k.find('[id^\x3d"serverColorNum"]').length), d.css("background-color", this.currColor), d.attr("title", a.rgb2hex(this.currColor)), k.find("#holdServerColors").append(d))
				},
				j)
			})
		}
	};
	_buildNavPresets = function(d) {
		d.append(a("\x3cdiv\x3ehere\x3c/div\x3e"))
	};
	a.fn.neeSecondaryDesignGenealSettingsTab = function(d) {
		d = d || {};
		var e = d.paddingElement || a.dmx.current.element,
		g = d;
		d.forceClassName && (e = a.dmfw.getPreviewElement(d.forceClassName + ":first"));
		d.hidePadding && (a(".paddingSetting").hide(), a(".marginSetting").css("margin-left", "20px"));
		var j = function(d, e) {
			e.deviceSpecific = !e.changeInAllDevices;
			var j = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: "x" == d ? [{
					attr: "padding-left",
					value: a("#paddingLeft").val()
				},
				{
					attr: "padding-right",
					value: a("#paddingRight").val()
				}] : [{
					attr: "padding-top",
					value: a("#paddingTop").val()
				},
				{
					attr: "padding-bottom",
					value: a("#paddingBottom").val()
				}]
			};
			g.changeGlobally ? a.dmops.updateGlobalCssAndElement(j, {
				clientOnly: e.clientOnly,
				className: g.forceClassName
			}) : a.dmops.updateCurrentCss(j, e);
			g.afterChangesCallback && g.afterChangesCallback()
		};
		a("#paddingTop").val(e.css("padding-top"));
		a("#paddingBottom").val(e.css("padding-bottom"));
		a("#paddingLeft").val(e.css("padding-left"));
		a("#paddingRight").val(e.css("padding-right"));
		a("#paddingTop , #paddingBottom").addClass("spaceInputSelected");
		var m = "y";
		a("#sliderPadding").slider({
			range: "min",
			value: parseInt(e.css("padding-top")),
			min: 0,
			max: 100,
			step: 1,
			slide: function(d, g) {
				"y" == m ? a("#paddingTop, #paddingBottom").val(g.value + "px") : a("#paddingLeft, #paddingRight").val(g.value + "px");
				j(m, {
					clientOnly: !0,
					element: e
				})
			},
			stop: function() {
				j(m, {
					element: e
				})
			}
		});
		a("#paddingTop , #paddingBottom").blur(function() {
			j("y", {
				element: e
			})
		});
		a("#paddingTop , #paddingBottom").keypress(function(a) {
			13 == a.keyCode && j("y", {
				element: e
			})
		});
		a("#paddingTop , #paddingBottom").focus(function() {
			a("#paddingTop , #paddingBottom").addClass("spaceInputSelected");
			a("#paddingLeft , #paddingRight").removeClass("spaceInputSelected");
			m = "y";
			a("#sliderPadding").slider("value", parseInt(e.css("padding-top")))
		});
		a("#paddingLeft , #paddingRight").blur(function() {
			j("x", {
				element: e
			})
		});
		a("#paddingLeft , #paddingRight").keypress(function(a) {
			13 == a.keyCode && j("x", {
				element: e
			})
		});
		a("#paddingLeft , #paddingRight").focus(function() {
			a("#paddingTop , #paddingBottom").removeClass("spaceInputSelected");
			a("#paddingLeft , #paddingRight").addClass("spaceInputSelected");
			m = "x";
			a("#sliderPadding").slider("value", parseInt(e.css("padding-left")))
		});
		var l = function(d, e) {
			e.deviceSpecific = !e.changeInAllDevices;
			var j = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: "x" == d ? [{
					attr: "margin-left",
					value: a("#marginLeft").val()
				},
				{
					attr: "margin-right",
					value: a("#marginRight").val()
				}] : [{
					attr: "margin-top",
					value: a("#marginTop").val()
				},
				{
					attr: "margin-bottom",
					value: a("#marginBottom").val()
				}]
			};
			g.changeGlobally ? a.dmops.updateGlobalCssAndElement(j, {
				clientOnly: e.clientOnly,
				className: g.forceClassName
			}) : a.dmops.updateCurrentCss(j, e);
			g.afterChangesCallback && !e.clientOnly && g.afterChangesCallback()
		},
		z = e.isAutoMargin();
		a("#marginTop").val(e.css("margin-top"));
		a("#marginBottom").val(e.css("margin-bottom"));
		a("#marginLeft").val(z ? "auto": e.css("margin-left"));
		a("#marginRight").val(z ? "auto": e.css("margin-right"));
		a("#marginTop , #marginBottom").addClass("spaceInputSelected");
		m = "y";
		a("#sliderMargin").slider({
			range: "min",
			value: parseInt(e.css("margin-top")),
			min: -20,
			max: 100,
			step: 1,
			slide: function(d, g) {
				"y" == m ? a("#marginTop, #marginBottom").val(g.value + "px") : a("#marginLeft, #marginRight").val(g.value + "px");
				l(m, {
					clientOnly: !0,
					element: e
				})
			},
			stop: function() {
				l(m, {
					element: e
				})
			}
		});
		a("#marginTop , #marginBottom").blur(function() {
			l("y", {
				element: e
			})
		});
		a("#marginTop , #marginBottom").keypress(function(a) {
			13 == a.keyCode && l("y", {
				element: e
			})
		});
		a("#marginTop , #marginBottom").focus(function() {
			a("#marginTop , #marginBottom").addClass("spaceInputSelected");
			a("#marginLeft , #marginRight").removeClass("spaceInputSelected");
			m = "y";
			a("#sliderMargin").slider("value", parseInt(e.css("margin-top")))
		});
		a("#marginLeft , #marginRight").blur(function() {
			l("x", {
				element: e
			})
		});
		a("#marginLeft , #marginRight").keypress(function(a) {
			13 == a.keyCode && l("x", {
				element: e
			})
		});
		a("#marginLeft , #marginRight").focus(function() {
			a("#marginTop , #marginBottom").removeClass("spaceInputSelected");
			a("#marginLeft , #marginRight").addClass("spaceInputSelected");
			m = "x";
			a("#sliderMargin").slider("value", parseInt(e.css("margin-left")))
		});
		d = d || {};
		d.showWidthHeight ? (a(".dimSettings #usePercOnOff").onOffBtn({
			initState: !1,
			onFn: function() {
				keepPropValue = !0;
				k({
					keepProp: function() {
						return ! 0
					},
					usePerc: !0,
					afterChangesCallback: g.afterChangesCallback ? g.afterChangesCallback: null
				})
			},
			offFn: function() {
				k({
					keepProp: function() {
						return ! 1
					},
					usePerc: !1,
					afterChangesCallback: g.afterChangesCallback ? g.afterChangesCallback: null
				})
			}
		}), k({
			keepProp: function() {
				return ! 1
			},
			usePerc: !1,
			hideWidth: d.hideWidth,
			hidePrec: d.hidePrec,
			forceHeightScale: d.forceHeightScale,
			afterChangesCallback: g.afterChangesCallback ? g.afterChangesCallback: null
		})) : (a(".dimSettings").prev().hide(), a(".dimSettings").hide())
	};
	var g = function() {
		var d = a.dmx.current.element,
		e = !d.hasClass("listItemNoArrows"),
		d = !d.hasClass("listItemNoDivider"),
		g = a("#listImageToChange"),
		j = a("#listImageToChangeButtons");
		e ? (g.attr("src", d ? "/editor/nee/images/slideEditors/listFull.png": "/editor/nee/images/slideEditors/listNoDividers.png"), j.attr("src", "/editor/nee/images/slideEditors/listButtonsFull.png")) : (g.attr("src", d ? "/editor/nee/images/slideEditors/listNoArrows.png": "/editor/nee/images/slideEditors/listNoArrowsNoDividers.png"), j.attr("src", "/editor/nee/images/slideEditors/listButtonsNoArrow.png"))
	},
	j = function(d) {
		"shapeListButtons" == d ? a(".listDividerSett").hide() : a(".listDividerSett").show()
	};
	a.fn.neeSecondaryDesignListDesign = function() {
		var d = a.dmx.current.element;
		g();
		var e = !1;
		a(".navShapeWrapper .navShapeItem").each(function() {
			var g = a(this).attr("shape_name"),
			k = m(a.dmx.current.element);
			j(k);
			g == k && !e && (a(this).addClass("navShapeItemOrange"), e = !0);
			a(this).unbind("click").click(function() {
				a(".navShapeWrapper .navShapeItem").removeClass("navShapeItemOrange");
				a(this).addClass("navShapeItemOrange");
				j(g);
				var e = [],
				k = "";
				"default" == g ? k = "default dmNoMargin": e.push(g);
				g != m(a.dmx.current.element) && a.dmops.updateCurrentCss({
					classesToRemove: ["default", "shapeListButtons", "dmNoMargin"],
					classesToAdd: e
				},
				{
					success: function() {
						d.addClass(k)
					},
					changeOnlyOnReturnFromServer: !0
				})
			})
		});
		a("#showArrows").onOffBtn({
			initState: !d.hasClass("listItemNoArrows"),
			onFn: function() {
				a.dmops.updateCurrentCss({
					classesToRemove: ["listItemNoArrows"]
				},
				{
					afterClientChange: function() {
						g()
					}
				})
			},
			offFn: function() {
				a.dmops.updateCurrentCss({
					classesToAdd: ["listItemNoArrows"]
				},
				{
					afterClientChange: function() {
						g()
					}
				})
			}
		});
		a("#showDivider").onOffBtn({
			initState: !d.hasClass("listItemNoDivider"),
			onFn: function() {
				a.dmops.updateCurrentCss({
					classesToRemove: ["listItemNoDivider"]
				},
				{
					afterClientChange: function() {
						g()
					}
				})
			},
			offFn: function() {
				a.dmops.updateCurrentCss({
					classesToAdd: ["listItemNoDivider"]
				},
				{
					afterClientChange: function() {
						g()
					}
				})
			}
		})
	};
	a.fn.neeSecondaryDesignAlignmentSettingsTab = function(d) {
		d = d || {};
		d.deviceSpecific = !d.changeInAllDevices;
		a(".applyButton").hide();
		var e = d && d.element ? d.element: a.dmx.current.element,
		g = d && d.forceHeadelem || null,
		j = e.css("float");
		"none" == j && !e.isAutoMargin() && (j = null);
		var k = "both" != e.next().css("clear") && null != j && "none" != j;
		"none" == j && (j = "center");
		var m = function() {
			var e = null,
			e = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: "float",
					value: "center" == j || !j ? "none": j
				},
				{
					attr: "margin-left",
					value: !j || "center" == j ? "auto": "4px"
				},
				{
					attr: "margin-right",
					value: !j || "center" == j ? "auto": "4px"
				}]
			};
			j ? e.attrToAdd.push({
				attr: "display",
				value: "block"
			}) : e.attrToRemove = ["display"];
			k || a.dmUndo.set(!1);
			a.dmops.updateCurrentCss(e, a.extend({
				success: function() {
					k || (a.dmUndo.set(!0), v(!0, d))
				}
			},
			d))
		};
		"left" == j ? a(".alignLeftBtn").addClass("alignLeftBtnSelect") : "center" == j ? a(".alignCenterBtn").addClass("alignCenterBtnSelect") : "right" == j && a(".alignRightBtn").addClass("alignRightBtnSelect");
		a(".alignLeftBtn").unbind("click").click(function() {
			a(this).addClass("alignLeftBtnSelect");
			a(".alignCenterBtn").removeClass("alignCenterBtnSelect");
			a(".alignRightBtn").removeClass("alignRightBtnSelect");
			j = "left";
			m();
			l.enable()
		});
		a(".alignRightBtn").unbind("click").click(function() {
			a(this).addClass("alignRightBtnSelect");
			a(".alignLeftBtn").removeClass("alignLeftBtnSelect");
			a(".alignCenterBtn").removeClass("alignCenterBtnSelect");
			j = "right";
			m();
			l.enable()
		});
		a(".alignCenterBtn").unbind("click").click(function() {
			a(this).addClass("alignCenterBtnSelect");
			a(".alignLeftBtn").removeClass("alignLeftBtnSelect");
			a(".alignRightBtn").removeClass("alignRightBtnSelect");
			j = "center";
			m();
			l.disable()
		});
		a("#resetAlign").unbind("click").click(function() {
			a(".alignRightBtn").removeClass("alignCenterBtnSelect");
			a(".alignLeftBtn").removeClass("alignLeftBtnSelect");
			a(".alignRightBtn").removeClass("alignRightBtnSelect");
			j = null;
			m();
			l.disable()
		});
		var l = null,
		v = function(d, e) {
			e = e || {};
			var j = e.element || a.dmx.current.element;
			a.changePage({
				clientChange: function() {},
				serverChange: function() {
					if (j.next().is(".dmWidgetClear") && d) a.dmops.updateCurrentCss({
						classesToRemove: null,
						attrToRemove: null,
						classesToAdd: null,
						attrToAdd: [{
							attr: "clear",
							value: "both"
						}]
					},
					{
						element: j.next()
					});
					else {
						var e = {
							url: "/pages/" + a.dmx.currentPage(g) + "/toggleClear/" + j.dmid() + "/" + d,
							success: function(e) {
								d ? e.value && j.after(e.value) : j.next().remove();
								a.dmops.redrawSelection()
							}
						};
						a.dmPostWithHistory(e)
					}
				}
			})
		},
		e = {
			initState: k,
			onFn: function() {
				k = !0;
				v(!1, d)
			},
			offFn: function() {
				k = !1;
				v(!0, d)
			}
		},
		l = a("#wrapTextOnOff").onOffBtn(e); (!j || "none" == j || "center" == j) && l.disable()
	};
	a.fn.neeSecondaryResizeTab = function(d) {
		var e = !0,
		g = {
			initState: !0,
			onFn: function() {
				e = !0;
				k({
					keepProp: function() {
						return ! 0
					},
					usePerc: !1,
					containerSelector: ".designResizeWrapper"
				},
				d)
			},
			offFn: function() {
				e = !1;
				k({
					keepProp: function() {
						return ! 1
					},
					usePerc: !1,
					containerSelector: ".designResizeWrapper"
				},
				d)
			}
		};
		a("#keepPropOnOff").onOffBtn({
			initState: !0,
			disabled: !0
		});
		var j = {
			initState: 0,
			first: {
				name: dmStr["ui.nee.imagePicker.14"],
				toggle: function() {
					e = !0;
					a("#keepPropOnOff").onOffBtn({
						initState: !0,
						disabled: !0
					});
					k({
						keepProp: function() {
							return e
						},
						usePerc: !0,
						containerSelector: ".designResizeWrapper"
					},
					d)
				}
			},
			last: {
				name: dmStr["ui.nee.imagePicker.15"],
				toggle: function() {
					a("#keepPropOnOff").onOffBtn(g);
					k({
						keepProp: function() {
							return e
						},
						usePerc: !1,
						containerSelector: ".designResizeWrapper"
					},
					d)
				}
			},
			classToAdd: d && d.classToAdd
		};
		a(".toggleDimensionsButtons").toggleModeWidget(j);
		k({
			keepProp: function() {
				return e
			},
			usePerc: !0,
			containerSelector: ".designResizeWrapper"
		},
		d)
	};
	a.fn.neeSecondaryCropTab = function(d) {
		var e = a(".imgToCrop"),
		g = (new Date).getTime();
		d && d.dontShowBtn ? "": a.dmfw.showEditorButton({
			selector: ".cropButton"
		});
		var j = d && d.originalSrc ? d && d.originalSrc: a.dmx.current.element ? a.dmx.current.element.attr("dm_orig_src") : null,
		k = d && d.imgSrc ? d.imgSrc: a.dmx.current.element.attr("src");
		j && (k = j);
		e.hide();
		k = String((k + "?" + g).replace(/\"/, ""));
		e.attr("src", k.replace(/\"/, ""));
		e.load(function() {
			var g = {
				drawBorders: !0,
				sideHandles: !1,
				keySupport: !1,
				boxWidth: 450,
				boxHeight: 350,
				aspectRatio: d.aspectRatio || "",
				onChange: function(d) {
					a("#cropWidthInput").val(d.w + "px");
					a("#cropHeightInput").val(d.h + "px")
				}
			},
			m = e.width(),
			l = e.height();
			g.setSelect = [];
			j ? (m = d && d.cropDim ? d.cropDim.split("_") : a.dmx.current.element.attr("dm_crop_dim").split("_"), g.setSelect[0] = m[0], g.setSelect[1] = m[1], g.setSelect[2] = parseInt(m[0]) + parseInt(m[2]), g.setSelect[3] = parseInt(m[1]) + parseInt(m[3])) : (g.setSelect[0] = parseInt(m / 4), g.setSelect[1] = parseInt(l / 4), g.setSelect[2] = parseInt(0.75 * m), g.setSelect[3] = parseInt(0.75 * l));
			var r;
			a(".imgToCrop").Jcrop(g,
			function() {
				r = this;
				a(".cropImgWrapper").css("padding-top", parseInt((parseInt(a(".cropWrapper").height()) - parseInt(a(".jcrop-holder").height())) / 2) + "px")
			});
			g = function(d, e) {
				a(d).inputFieldLostFocusHandler(function(a) {
					if (a) {
						var d = a.indexOf("px");
						a = 0 <= d ? a.substring(0, d) : a;
						d = r.tellSelect();
						d = [d.x, d.y, d.x2, d.y2];
						d[e] = parseInt(d[e - 2]) + parseInt(a);
						r.setSelect(d)
					}
				})
			};
			g("#cropWidthInput", 2);
			g("#cropHeightInput", 3);
			a(".cropButton").unbind("click");
			a(".cropButton").click(function() {
				var e = r.tellSelect();
				a.dmops.cropImage(k, e, d,
				function(a) {
					d && d.callback(a)
				})
			})
		})
	};
	var k = function(d, e) {
		d = d || {};
		e = e || {};
		e.deviceSpecific = !e.changeInAllDevices;
		var g = e && e.element ? e.element: a.dmx.current.element;
		d.hideWidth && (a(".widthSetting").hide(), a(".heightSetting").css("margin-top", "30px"));
		d.hidePrec && a(".usePercSettings").hide();
		var j = a(d.containerSelector || ".dimSettings"),
		k = d.usePerc,
		m = function(e, m, l) {
			var o = d.keepProp && d.keepProp(),
			v = null,
			v = "width" == e ? "height": "width";
			e = {
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: e,
					value: j.find(m).val()
				}]
			};
			o && e.attrToAdd.push({
				attr: v,
				value: "auto"
			});
			g.isAutoMargin() && "block" == g.css("display") && (e.attrToAdd.push({
				attr: "margin-left",
				value: "auto"
			}), e.attrToAdd.push({
				attr: "margin-right",
				value: "auto"
			}), e.attrToAdd.push({
				attr: "display",
				value: "block"
			}));
			e.attrToAdd.push({
				attr: "max-height",
				value: "1000px"
			});
			a.dmops.updateCurrentCss(e, l); ! l && d.afterChangesCallback && d.afterChangesCallback();
			o && !k && ("width" == v ? (l = parseInt(g.width()), j.find("#widthInput").val(l + "px"), j.find("#sliderWidth").slider({
				value: l
			})) : (l = parseInt(g.height()), j.find("#heightInput").val(l + "px"), j.find("#sliderHeight").slider({
				value: l
			})))
		};
		if (k) {
			var l = a(g).getDimPerc("width", e.forceSizes ? {
				forceWidthScale: e.forceWidthScale,
				forceHeightScale: e.forceHeightScale
			}: null);
			j.find("#sliderWidth").data("uiSlider") && j.find("#sliderWidth").slider("destroy");
			j.find("#sliderWidth").slider({
				range: "min",
				value: l,
				min: 0,
				max: 100,
				step: 1,
				slide: function(d, g) {
					j.find("#widthInput").val(g.value + "%");
					m("width", "#widthInput", a.extend({
						clientOnly: !0
					},
					e))
				},
				stop: function() {
					m("width", "#widthInput", e)
				}
			});
			j.find("#widthInput").val(l + "%");
			j.find("#widthInput").blur(function() {
				m("width", "#widthInput", e)
			});
			j.find("#widthInput").keypress(function(a) {
				13 == a.keyCode && m("width", "#widthInput", e)
			});
			j.find("#sliderHeight").css("display", "none");
			j.find("#heightInput").css("display", "none");
			j.find("#heightAutoCalcText").removeClass("displayNone")
		} else {
			j.find("#sliderHeight").css("display", "inline-block");
			j.find("#heightInput").css("display", "inline-block");
			j.find("#heightAutoCalcText").addClass("displayNone");
			j.find("#sliderWidth").data("uiSlider") && j.find("#sliderWidth").slider("destroy");
			l = Math.floor(d.forceWidthScale || e.forceWidthScale || a(g.parent().getTopBlockElement().get(0)).outerWidth(!0));
			j.find("#sliderWidth").slider({
				range: "min",
				value: g.width(),
				min: 0,
				max: l,
				step: 4,
				slide: function(d, g) {
					j.find("#widthInput").val(g.value + "px");
					m("width", "#widthInput", a.extend({
						clientOnly: !0
					},
					e))
				},
				stop: function() {
					m("width", "#widthInput", e)
				}
			});
			j.find("#widthInput").val(g.css("width"));
			j.find("#widthInput").blur(function() {
				m("width", "#widthInput", e)
			});
			j.find("#widthInput").keypress(function(a) {
				13 == a.keyCode && m("width", "#widthInput", e)
			});
			var v = d.keepProp && d.keepProp();
			v && m("width", "#widthInput", a.extend({},
			e));
			l = Math.floor(d.forceHeightScale || e.forceHeightScale || (v ? l * g.height() / g.width() : Math.max(480, g.parent().height())));
			j.find("#sliderHeight").data("uiSlider") && j.find("#sliderHeight").slider("destroy");
			j.find("#sliderHeight").slider({
				range: "min",
				value: g.height(),
				min: 0,
				max: l,
				step: 4,
				slide: function(d, g) {
					j.find("#heightInput").val(g.value + "px");
					m("height", "#heightInput", a.extend({
						clientOnly: !0
					},
					e))
				},
				stop: function() {
					m("height", "#heightInput", e)
				}
			});
			j.find("#heightInput").val(g.css("height"));
			j.find("#heightInput").blur(function() {
				m("height", "#heightInput", e)
			});
			j.find("#heightInput").keypress(function(a) {
				13 == a.keyCode && m("height", "#heightInput", e)
			})
		}
	};
	a.fn.neeSecondaryCSSTab = function() {
		a(".applyButton").show();
		var d = a.dmx.current.element.get(0).nodeName.toLowerCase(),
		e = d + ".u_" + a.dmx.current.element.dmid();
		a.dmx.current.element.addClass("u_" + a.dmx.current.element.dmid());
		var g = a.onefw ? "?device\x3d" + a.onefw.device() : "";
		if (g && "" != g) {
			var j = a("#elementDeviceCssWrapper .deviceDesc").data(a.onefw.device());
			j && a("#elementDeviceCssWrapper .deviceDesc").text(j)
		}
		d = {
			url: "/pages/" + a.dmx.currentPage() + "/getElementCss/" + a.dmx.current.element.dmid() + "/" + d + "/" + e + g,
			success: function(d) {
				a("#elementCss").val(d.general);
				d.deviceCss && "" != d.deviceCss && a("#elementDeviceCss").val(d.deviceCss)
			}
		};
		a.dmPostWithHistory(d);
		var k = function() {
			a.changePage({
				clientChange: function() {},
				serverChange: function() {
					var d = a.onefw ? "?device\x3d" + a.onefw.device() : "";
					a.dmPostWithHistory({
						url: "/pages/" + a.dmx.currentPage() + "/setElementCss/" + a.dmx.current.element.dmid() + "/" + e + d,
						data: {
							general: a("#elementCss").val(),
							deviceCss: "" != d ? a("#elementDeviceCss").val() : null
						},
						success: function(d) {
							a.dmops.refreshPageStyleCss(d.general, a.dmx.isHeader(a.dmx.current.element));
							d.deviceCss && "" != d.deviceCss && a.dmops.refreshPageStyleDeviceCss(d.deviceCss, a.dmx.isHeader(a.dmx.current.element));
							a.dmops.redrawSelection()
						}
					})
				}
			})
		};
		a(".applyButton").click(function() {
			k()
		});
		a("#elementCss").blur(function() {
			k()
		})
	};
	a.fn.neeSecondaryHTMLTab = function(d) {
		var e = a.dmx.current.element,
		g = a.dmx.currentPage();
		d = d || {};
		var j = d.inHeader ? "?inHeader\x3dtrue": "",
		k = d.forceId ? d.forceId: e.dmid(),
		m = null;
		a(".applyButton").show();
		a.dmPostWithHistory({
			url: "/pages/" + g + "/getElementHtml/" + k + j,
			success: function(e) {
				m = e.value;
				if (d.noRoot) {
					e = m.indexOf("\x3e");
					var g = m.lastIndexOf("\x3c");
					e = m.substring(e + 1, g);
					a("#elementHtml").val(e)
				} else a("#elementHtml").val(m)
			}
		});
		var l = function() {
			var l = null;
			if (d.noRoot) {
				var z = a(m),
				z = z.eq(0);
				z.html("$x$x$x");
				l = z.outerHTML();
				m = l = l.replace("$x$x$x", a("#elementHtml").val())
			} else l = a("#elementHtml").val();
			m = m.replace(RegExp("[\n\r]+", "g"), "\n");
			"string" === a.type(l) && ("" != l.trim() && (d.noRoot || m != l)) && a.changePage({
				clientChange: function() {},
				serverChange: function() {
					a.dmPostWithHistory({
						url: "/pages/" + g + "/setElementHtml/" + k + j,
						data: {
							value: l,
							currentUrl: a.dmx.rt.liveUrl
						},
						success: function(g) {
							if (d.inHeader) a.dmfw.refreshPreview(function() {
								a.navigationUtil.openNavigationEditor()
							});
							else if ( - 1 != g.value.indexOf("\x3cscript")) {
								var j = e.dmid();
								a.dmfw.refreshPreview(function() {
									a.dmfw.selectAndOpenEditor(a.dmfw.getByDmid(j))
								})
							} else {
								var k = e.is(".dmLocked");
								e.copyOuterHtml(g.value);
								k && (e.selectElement(), e.lockElement())
							}
						}
					})
				}
			})
		};
		a(".applyButton").unbind("click.htmlapply").unbind("click").bind("click.htmlapply",
		function() {
			l()
		});
		a("#elementHtml").blur(function() {
			l()
		});
		a.ptMindTouch && !a.ptMindTouch.shouldHideHelp() && (a(".warning").attr("id", "dmMtHtmlHelp"), a(".warning a").attr("href", "javascript: void(0)"), a(".warning a").removeAttr("target"))
	};
	_navHasNoArrows = function() {
		var d = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav").get(0)),
		e = a.navigationUtil.getActualCurNavShape(),
		e = a.navigationUtil.getShapeColorRestrictions()[e] || [];
		return - 1 != a.inArray("arrows", e) ? !0 : d.hasClass("navNoArrows")
	};
	_navHasNoBorder = function() {
		var d = a.navigationUtil.getActualCurNavShape(),
		d = a.navigationUtil.getShapeColorRestrictions()[d] || [];
		if ( - 1 != a.inArray("border", d)) return ! 0
	};
	_navHasNoIcons = function() {
		var d = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav").get(0)),
		e = a.navigationUtil.getActualCurNavShape(),
		e = a.navigationUtil.getShapeColorRestrictions()[e] || [];
		return - 1 != a.inArray("icons", e) || -1 != a.inArray(a.dmx.site.manifestID, [1010]) ? !0 : d.hasClass("navNoIcons")
	};
	a.fn.neeSecondarySliderCustomizeTab = function() {};
	a.fn.neeSecondaryNavCustomizeTab = function() {
		var d = a(".navigationDesignCustomize:first"),
		e = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav, UL.dmn")),
		g = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav, UL.dmn").get(0)),
		j = a.navigationUtil.getActualCurNavShape(),
		j = a.navigationUtil.getShapeRestrictions()[j] || [],
		k = function(d, g, j) {
			var k = g ? {
				classesToAdd: [d]
			}: {
				classesToRemove: [d]
			};
			a.dmsrv.postToServ(function() {
				a.dmPostWithHistory({
					url: "/pages/" + a.dmx.page.id + "/changeNavDesign",
					data: k,
					success: function() {
						g ? e.addClass(d) : e.removeClass(d);
						a.dmNotify(j + " changed")
					}
				})
			})
		};
		if ( - 1 != a.inArray("rounded", j)) d.find("#roundCustWrapper").hide();
		else {
			var m = !g.hasClass("navSquareCorners");
			d.find("#RoundedCornersOnOff").onOffBtn({
				initState: m,
				onFn: function() {
					k("navSquareCorners", !1, "Rounded corners")
				},
				offFn: function() {
					k("navSquareCorners", !0, "Rounded corners")
				}
			})
		}
		if ( - 1 != a.inArray("shadow", j)) d.find("#shadowCustWrapper").hide();
		else {
			var m = a(a.dmfw.getPreviewElement(".dmNav li a").get(0)),
			l = function(a) {
				return ! a || "none" == a || "" == a
			},
			v = [{
				attr: "-webkit-box-shadow",
				value: "black 0.1em 0.1em 0.2em"
			},
			{
				attr: "-moz-box-shadow",
				value: "black 0.1em 0.1em 0.2em"
			},
			{
				attr: "box-shadow",
				value: "black 0.1em 0.1em 0.2em"
			}],
			D = [{
				attr: "-webkit-box-shadow",
				value: "none"
			},
			{
				attr: "-moz-box-shadow",
				value: "none"
			},
			{
				attr: "box-shadow",
				value: "none"
			}],
			E = m.css("-webkit-box-shadow"),
			E = l(E) ? m.css("-moz-box-shadow") : E,
			E = l(E) ? m.css("box-shadow") : E;
			d.find("#ShadowOnOff").onOffBtn({
				initState: !l(E),
				onFn: function() {
					a.dmops.updateGlobalCssAndElement({
						attrToAdd: v
					},
					{
						className: "*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a",
						clientOnly: !1
					})
				},
				offFn: function() {
					a.dmops.updateGlobalCssAndElement({
						attrToAdd: D
					},
					{
						className: "*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a",
						clientOnly: !1
					})
				}
			})
		} - 1 != a.inArray("arrows", j) ? d.find("#arrowCustWrapper").hide() : (m = !g.hasClass("navNoArrows"), d.find("#ArrowsOnOff").onOffBtn({
			initState: m,
			onFn: function() {
				k("navNoArrows", !1, "Arrows")
			},
			offFn: function() {
				k("navNoArrows", !0, "Arrows")
			}
		}), a.layoutNav.isLayout && (l = g.find(".navArrowBottom:first").height(), m && (!l || 0 == l) && d.find("#arrowCustWrapper").hide())); - 1 != a.inArray("icons", j) ? d.find("#iconCustWrapper").hide() : (m = !g.hasClass("navNoIcons"), d.find("#IconBulletsOnOff").onOffBtn({
			initState: m,
			onFn: function() {
				k("navNoIcons", !1, "Icons")
			},
			offFn: function() {
				k("navNoIcons", !0, "Icons")
			}
		}), a.layoutNav.restrictions.hideIconEffectIfNoIcons && (l = a.dmfw.getPreviewElement(".dmNav li:visible .navIconBg:first").is(":visible"), m && !l && d.find("#iconCustWrapper").hide())); - 1 != a.inArray("text", j) ? d.find("#textCustWrapper").hide() : (m = !g.hasClass("navNoText"), d.find("#TextOnOff").onOffBtn({
			initState: m,
			onFn: function() {
				k("navNoText", !1, "Icons")
			},
			offFn: function() {
				k("navNoText", !0, "Icons")
			}
		}));
		d.find("#SemiTranspOnOff").onOffBtn({
			initState: !0,
			onFn: function() {},
			offFn: function() {}
		});
		g = a(a.dmfw.getPreviewElement(".dmNav li").get(0)).css("padding-bottom");
		d.find("#groupItemsOnOff").onOffBtn({
			initState: !(g && "0px" != g && "" != g),
			onFn: function() {
				a.dmsrv.postToServ(function() {
					a.dmsrv.updateGlobalCSS("*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a", {
						attrToAdd: [{
							attr: "padding-bottom",
							value: "0px"
						}]
					},
					function() {
						a(a.dmfw.getPreviewElement(".dmNav li")).css("padding-bottom", "0px");
						a.dmops.redrawSelection();
						a.dmNotify("Grouping changed")
					})
				})
			},
			offFn: function() {
				a.dmsrv.postToServ(function() {
					a.dmsrv.updateGlobalCSS("*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a", {
						attrToAdd: [{
							attr: "padding-bottom",
							value: "8px"
						}]
					},
					function() {
						a(a.dmfw.getPreviewElement(".dmNav li")).css("padding-bottom", "8px");
						a.dmops.redrawSelection();
						a.dmNotify("Grouping changed")
					})
				})
			}
		});
		a(".navigationDesignCustomize .wrapper:visible").filter(":first").find("hr").hide()
	};
	a.fn.neeSecondaryTextAndTitleStyleTab = function(d) {
		var e = this;
		d = d || {};
		var g = function(d) {
			e.find("#textEditor").remove();
			e.find("#colorPickerWrapper").hide();
			e.find(".shapeDesignWrapper").remove();
			a(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
			jQuery.ajax({
				url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
				async: !1,
				success: function(g) {
					e.find(".slideRightPanelInner:first").append(a(g));
					e.find(".slideRightPanelInner:first").neeSecondaryTextStyleTab(d)
				}
			})
		},
		j = [{
			name: dmStr["ui.nee.imagePicker.7"],
			callback: function() {
				g(d)
			}
		},
		{
			name: dmStr["ui.nee.imagePicker.8"],
			callback: function() {
				g(a.extend({},
				d, {
					textSelector: d.titleTextSelector
				}))
			}
		}];
		d.linkTextSelector && j.push({
			name: dmStr["ui.nee.imagePicker.9"],
			callback: function() {
				g(a.extend({},
				d, {
					textSelector: d.linkTextSelector
				}))
			}
		});
		e.find(".slideRightPanelInner:first").neeThirdTabControl({
			callback: !0,
			tabs: j
		})
	};
	a.fn.neeSecondaryTextAndTitleStyleTabYelp = function(d) {
		var e = this;
		d = d || {};
		var g = function(d) {
			e.find("#textEditor").remove();
			e.find("#colorPickerWrapper").hide();
			e.find(".shapeDesignWrapper").remove();
			e.find("#placementForColorPickerColor").remove();
			a(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
			jQuery.ajax({
				url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
				async: !1,
				success: function(g) {
					e.find(".slideRightPanelInner:first").append(a(g));
					e.find(".slideRightPanelInner:first").neeSecondaryTextStyleTab(d)
				}
			})
		};
		e.find(".slideRightPanelInner:first").neeThirdTabControl({
			callback: !0,
			tabs: [{
				name: dmStr["ui.nee.imagePicker.11"],
				callback: function() {
					g(a.extend({},
					d, {
						textSelector: ".yelpReviewText"
					}))
				}
			},
			{
				name: dmStr["ui.nee.imagePicker.12"],
				callback: function() {
					g(a.extend({},
					d, {
						textSelector: ".yelpReviewDate"
					}))
				}
			},
			{
				name: dmStr["ui.nee.imagePicker.13"],
				callback: function() {
					g(a.extend({},
					d, {
						textSelector: ".yelpReviewReviewer"
					}))
				}
			}]
		})
	};
	a.fn.neeSecondaryTextStyleTab = function(d) {
		var e = this;
		d = d || {};
		var g = d.textSizeSelector || d.textSelector || d.selector || null,
		j = d.elem || a.dmx.current.element,
		k = function(e, g, j) {
			d.changeGlobally ? (g = d.forceTextClassName || d.forceClassName, j && j.noInnerSelector && (g = d.forceClassName), d.updateInChangePage ? updateInChangePage(d.forceClassNameChangePage, e.attrToAdd[0].attr, e.attrToAdd[0].value) : a.dmops.updateGlobalCssAndElement(e, {
				className: g,
				clientOnly: !1
			})) : d.sendElementNotSelector ? a.dmops.updateCurrentCss(e, {
				element: d.element
			}) : a.dmops.updateCurrentCss(e, {
				selector: g
			})
		},
		m = function(d) {
			var e = {};
			e.id = d.id;
			e.state = !1;
			var m = d.noInnerSelector ? null: g;
			a("#" + e.id).click(function() {
				k({
					classesToRemove: null,
					attrToRemove: null,
					classesToAdd: null,
					attrToAdd: [{
						attr: d.styleName,
						value: e.state ? d.styleOff: d.styleOn
					}]
				},
				m);
				e.state = !e.state;
				a("#" + e.id).toggleClass("on")
			});
			var l = j;
			m && (l = l.find(m));
			l.css(d.styleName) == d.styleOn && (e.state = !0, a("#" + e.id).addClass("on"));
			return e
		},
		l = function(d) {
			var m = {};
			m.id = d.id;
			m.group = d.group;
			var l = d.noInnerSelector ? null: g,
			n = null;
			d.styleToRemove && (n = [d.styleToRemove]);
			a("#" + m.id).click(function() {
				k({
					classesToRemove: null,
					attrToRemove: n,
					classesToAdd: null,
					attrToAdd: [{
						attr: d.styleName,
						value: d.styleOn
					}]
				},
				l, d);
				a("#" + m.id).addClass("on");
				a.each(e.buttons,
				function(d, e) {
					e.group && (e.group == m.group && e != m) && a("#" + e.id).removeClass("on")
				})
			});
			var v = j;
			l && (v = v.find(l));
			v.css(d.styleName) == d.styleOn && (m.state = !0, a("#" + m.id).addClass("on"));
			return m
		},
		v = function(d) {
			var e = {};
			e.id = d.id;
			var m = d.noInnerSelector ? null: g,
			l = j;
			m && (l = l.find(m));
			e._update = function(a) {
				k({
					classesToRemove: null,
					attrToRemove: null,
					classesToAdd: null,
					attrToAdd: [{
						attr: d.styleName,
						value: a
					}]
				},
				m)
			};
			a("#" + e.id).click(function() {
				a(".textControl").removeClass("selected");
				a("#" + e.id).addClass("selected");
				a.dmLoad("#widgetPlaceholder", d.widgetUrl,
				function() {
					a("#welcomeText").hide();
					d.openWidget(l.css(d.styleName), e._update);
					e.loaded = !0
				})
			});
			return e
		};
		this.buttons = {
			bold: m({
				id: "bold",
				styleName: "font-weight",
				styleOn: "bold",
				styleOff: "normal"
			}),
			underline: m({
				id: "underline",
				styleName: "text-decoration",
				styleOn: "underline",
				styleOff: "none"
			}),
			italic: m({
				id: "italic",
				styleName: "font-style",
				styleOn: "italic",
				styleOff: "normal"
			}),
			color: v({
				id: "color",
				styleName: "color",
				widgetUrl: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
				openWidget: function(d, e) {
					a("#widgetPlaceholder").neeColorPicker(d, dmStr["ui.text"].toLowerCase(), e)
				}
			}),
			fontFamily: v({
				id: "fontFamily",
				styleName: "font-family",
				widgetUrl: "/editor/nee/mainTabs/neeDesign/nee.designHtmlFontFamily.jsp",
				openWidget: function(d, e) {
					a("#widgetPlaceholder").neeChangeFontFamily(d, e)
				}
			}),
			fontSize: v({
				id: "fontSize",
				styleName: "font-size",
				widgetUrl: "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
				openWidget: function(e, g) {
					if (d.limitTextRows) {
						var j = d.lineHeight || 1.2;
						g = function(a) {
							a = {
								classesToRemove: null,
								attrToRemove: null,
								classesToAdd: null,
								attrToAdd: [{
									attr: "font-size",
									value: a
								},
								{
									attr: "line-height",
									value: j + "em"
								},
								{
									attr: "max-height",
									value: parseInt(a) * j * d.limitTextRows + "px"
								}]
							};
							k(a, d.titleTextSelector)
						}
					}
					a("#widgetPlaceholder").neeChangeTextSize(e, g, d)
				}
			}),
			alignLeft: l({
				id: "alignLeft",
				styleName: "text-align",
				styleOn: "left",
				group: "align"
			}),
			alignRight: l({
				id: "alignRight",
				styleName: "text-align",
				styleOn: "right",
				group: "align"
			}),
			alignCenter: l({
				id: "alignCenter",
				styleName: "text-align",
				styleOn: "center",
				group: "align"
			}),
			alignJustify: l({
				id: "alignJustify",
				styleName: "text-align",
				styleOn: "justify",
				group: "align"
			}),
			dirLeft: l({
				id: "dirLeft",
				styleName: "direction",
				styleOn: "ltr",
				group: "direction",
				noInnerSelector: !0,
				styleToRemove: "text-align"
			}),
			dirRight: l({
				id: "dirRight",
				styleName: "direction",
				styleOn: "rtl",
				group: "direction",
				noInnerSelector: !0,
				styleToRemove: "text-align"
			})
		};
		d && d.afterTextButtonInit && d.afterTextButtonInit(e);
		a("#fontSize.textControl").click()
	};
	var l = function(a) {
		if (0 < a.length && (a = a.is("a") ? a: a.find("a:first"))) {
			a = (a = a.attr("class")) ? a.split(" ") : [];
			for (var d = 0; d < a.length; d++) if ( - 1 != a[d].indexOf("shapeWidget") || "default" == a[d]) return a[d]
		}
	},
	m = function(a) {
		if (0 < a.length) {
			a = (a = a.attr("class")) ? a.split(" ") : [];
			for (var d = 0; d < a.length; d++) if ( - 1 != a[d].indexOf("shape") || "default" == a[d]) return a[d]
		}
	};
	_initWidgetShapes = function() {
		var d = !1;
		a(".navShapeWrapper .navShapeItem").each(function() {
			var e = a(this).attr("shape_name");
			e == l(a.dmx.current.element) && !d && (a(this).addClass("navShapeItemOrange"), d = !0);
			a(this).unbind("click").click(function() {
				a(".navShapeWrapper .navShapeItem").removeClass("navShapeItemOrange");
				a(this).addClass("navShapeItemOrange");
				if (e != l(a.dmx.current.element)) {
					var d = {
						classesToRemove: "default shapeWidgetFull shapeWidgetRoundBgIcon shapeWidgetFloatRight shapeWidgetWin7 shapeWidgetHalf".split(" "),
						attrToRemove: "width height padding padding-top padding-bottom padding-right padding-left margin margin-top margin-bottom margin-left margin-right".split(" "),
						classesToAdd: [e],
						attrToAdd: null,
						changeWidgetShape: []
					};
					a.dmx.current.editable.getDefaultIconName && a.dmx.current.editable.getDefaultIconName() && (d.widgetDefaultIconName = [a.dmx.current.editable.getDefaultIconName()]);
					a.dmops.updateCurrentCss(d, {
						changeOnlyOnReturnFromServer: !0
					})
				}
			})
		})
	};
	_initTabsShapes = function() {
		var d = !1;
		a(".navShapeWrapper .navShapeItem").each(function() {
			var e = a(this).attr("shape_name");
			e == m(a.dmx.current.element) && !d && (a(this).addClass("navShapeItemOrange"), d = !0);
			a(this).unbind("click").click(function() {
				a(".navShapeWrapper .navShapeItem").removeClass("navShapeItemOrange");
				a(this).addClass("navShapeItemOrange");
				e != m(a.dmx.current.element) && a.dmops.updateCurrentCss({
					classesToRemove: "default shapeSimple shapeSimpleLineBottom shapeSimpleBottom shapeSimpleLeft shapeSimpleRight".split(" "),
					attrToRemove: null,
					classesToAdd: [e],
					attrToAdd: null
				})
			})
		})
	};
	_initContainerShapes = function() {
		var d = a(a.dmfw.getPreviewElement(".hiddenNavPlaceHolder UL.dmNav:first"));
		d.is(".rectangle") ? a("#rectangle").addClass("shapeSelected") : d.is(".normalRounded") ? a("#normalRounded").addClass("shapeSelected") : d.is(".bottomRounded") ? a("#bottomRounded").addClass("shapeSelected") : d.is(".topRounded") ? a("#topRounded").addClass("shapeSelected") : a("#rectangle").addClass("shapeSelected");
		a(".shape").click(function() {
			a(".shape").removeClass("shapeSelected");
			a(this).addClass("shapeSelected");
			var d = a(this).attr("id");
			_setNavContShapeClass([d], ["rectangle", "normalRounded", "bottomRounded", "topRounded"])
		});
		var e = {
			initState: d.is(".shadowEffect"),
			onFn: function() {
				_setNavContShapeClass(["shadowEffect"])
			},
			offFn: function() {
				_setNavContShapeClass(null, ["shadowEffect"])
			}
		};
		a("#shadowOnOff").onOffBtn(e);
		e = {
			initState: d.is(".threeDEffect"),
			onFn: function() {
				_setNavContShapeClass(["threeDEffect"])
			},
			offFn: function() {
				_setNavContShapeClass(null, ["threeDEffect"])
			}
		};
		a("#effect3dOnOff").onOffBtn(e)
	};
	_setNavContShapeClass = function(d, e) {
		var g = {
			classesToAdd: d,
			classesToRemove: e
		};
		a.dmsrv.postToServ(function() {
			a.dmPostWithHistory({
				url: "/pages/" + a.dmx.page.id + "/changeNavDesign",
				data: g,
				success: function() {
					var g = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav"));
					a.dmx.preview.wnd().jQuery.DM.expandNavigation();
					g.removeClass(e ? e.join(" ") : null);
					g.addClass(d ? d.join(" ") : null);
					var j = g.attr("class");
					g.attr("class", "");
					g.attr("class", j);
					a.dmx.preview.wnd().initComponents(!0);
					a.dmops.redrawSelection();
					setTimeout(function() {
						var a = g.attr("class");
						g.attr("class", "").hide().show().attr("class", a)
					},
					500);
					a.dmNotify("Shape changed")
				}
			})
		})
	};
	updateGlobalCssDesign = function(d, e, g) {
		g = g || {};
		var j = g.device || null;
		a.dmsrv.updateGlobalCSS(d, {
			attrToAdd: e,
			outsideTheme: g.outsideTheme || !1,
			device: j
		},
		function() {
			j && a.onefw.setDevicePreview({
				device: j
			})
		})
	};
	updateInChangePage = function(d, e, g, j, k, m, l, v, D) {
		a.changePage({
			clientChange: function() {
				updateInPreviewOnly(d, e, g, j, k, l, v, D)
			},
			serverChange: function() {
				l && v ? updateGlobalCssDesign(d, [{
					attr: e,
					value: g
				},
				{
					attr: "background-attachment",
					value: l.backgroundAttachment || "scroll"
				},
				{
					attr: "background-size",
					value: l.backgroundSize || "auto"
				},
				{
					attr: "background-repeat",
					value: l.backgroundRepeat || "no-repeat"
				},
				{
					attr: "background-position",
					value: l.backgroundPosition || "auto"
				}], {
					outsideTheme: m,
					device: D
				}) : j ? k ? updateGlobalCssDesign(d, [{
					attr: e,
					value: g
				},
				{
					attr: "background-size",
					value: "auto"
				},
				{
					attr: "background-repeat",
					value: "repeat"
				}], {
					outsideTheme: m,
					device: D
				}) : updateGlobalCssDesign(d, [{
					attr: e,
					value: g
				},
				{
					attr: "background-size",
					value: "auto"
				},
				{
					attr: "background-repeat",
					value: "no-repeat"
				}], {
					outsideTheme: m,
					device: D
				}) : updateGlobalCssDesign(d, [{
					attr: e,
					value: g
				}], {
					device: D
				})
			}
		})
	};
	updateInPreviewOnly = function(d, e, g, j, k, m, l, v) {
		if (!v || !(a.onefw && a.onefw.device() !== v)) if (v = NEFW.PREVIEW.get(0).contentWindow, j) {
			if (m && l) {
				k = m.backgroundAttachment || "scroll";
				l = m.backgroundSize || "auto";
				var D = m.backgroundRepeat || "no-repeat",
				E = m.backgroundPosition || "auto";
				m = "" + e + ":" + g + "; background-attachment:" + k + "; background-size:" + l + "; background-repeat:" + D + "; background-position:" + E + ";";
				j = [{
					key: e,
					value: g
				},
				{
					key: "background-attachment",
					value: k
				},
				{
					key: "background-size",
					value: l
				},
				{
					key: "background-repeat",
					value: D
				},
				{
					key: "background-position",
					value: E
				}];
				e = [{
					attr: e,
					value: g
				},
				{
					attr: "background-attachment",
					value: k
				},
				{
					attr: "background-size",
					value: l
				},
				{
					attr: "background-repeat",
					value: D
				},
				{
					attr: "background-position",
					value: E
				}]
			} else k ? (m = e + ": " + g + "; background-size: auto; background-repeat: repeat", j = [{
				key: e,
				value: g
			},
			{
				key: "background-size",
				value: "auto"
			},
			{
				key: "background-repeat",
				value: "repeat"
			}], e = [{
				attr: e,
				value: g
			},
			{
				attr: "background-size",
				value: "auto"
			},
			{
				attr: "background-repeat",
				value: "repeat"
			}]) : (m = e + ": " + g + "; background-size: auto;", j = [{
				key: e,
				value: g
			},
			{
				key: "background-size",
				value: "auto"
			}], e = [{
				attr: e,
				value: g
			},
			{
				attr: "background-size",
				value: "auto"
			}]);
			for (k = 0; k < d.length; k++) v.updateCss(d[k], m, j),
			a(a.dmfw.getPreviewElement(d[k])).clearStyle({
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: e
			})
		} else for (k = 0; k < d.length; k++) v.updateCss(d[k], e + ": " + g, [{
			key: e,
			value: g
		}]),
		a(a.dmfw.getPreviewElement(d[k])).clearStyle({
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: e,
				value: g
			}]
		})
	};
	_initNavShapes = function() {
		var d = !1;
		a(".navShapeWrapper .navShapeItem").each(function() {
			var e = a(this).attr("shape_name");
			e == a.navigationUtil.getActualCurNavShape() && !d && (a(this).addClass("navShapeItemOrange"), d = !0);
			a(this).unbind("click").click(function() {
				a(".navShapeWrapper .navShapeItem").removeClass("navShapeItemOrange");
				a(this).addClass("navShapeItemOrange");
				if (e != a.navigationUtil.getActualCurNavShape()) {
					var d = {
						shape: e,
						classesToRemove: ["navSquareCorners", "navNoArrows", "navNoIcons", "navNoText"]
					};
					a.dmUIBlockControlled({
						region: "navshape.modify",
						op: "block",
						style: "wheel"
					});
					a.dmsrv.postToServ(function() {
						a.dmPostWithHistory({
							url: "/pages/" + a.dmx.page.id + "/changeNavDesign",
							data: d,
							success: function(d) {
								wrTrackEvent(WR_SITE_NAV_SHAPE_CHANGE, {
									shape: e
								});
								var g = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav"));
								a.dmx.preview.wnd().jQuery.DM.expandNavigation();
								a.navigationUtil.clearNavShape(g);
								g.removeClass("default");
								g.attr("shape_class", e);
								g.addClass(e);
								if (d && d.length) for (g = 0; g < d.length; g++) {
									var j = d[g];
									if (j) {
										var k = j.globalClassName,
										j = j.attributesToChange;
										if (k && j && j["background-image"]) {
											var m = [],
											l = "";
											m.push({
												key: "background-image",
												value: j["background-image"]
											});
											l = l + "background-image: " + j["background-image"] + ";";
											NEFW.PREVIEW.get(0).contentWindow.updateCss(k, l, m)
										}
									}
								}
								setTimeout("$.dmx.preview.wnd().initComponents(true);", 100);
								setTimeout("$.dmops.redrawSelection();", 200);
								setTimeout(function() {
									a.dmUIBlockControlled({
										region: "navshape.modify",
										op: "unblock"
									})
								},
								300);
								a.dmNotify("Shape changed");
								wrTrackEvent(WR_SITE_NAV_SHAPE_CHANGE, {
									shape: e
								})
							}
						})
					})
				}
			})
		})
	}
})(jQuery); (function(a) {
	a.fn.onOffBtn = function(e) {
		function d(d, e) {
			d.state ? (d.removeClass("neeOffButton"), a.dmfw.isDudaone() && d.removeClass("neeOffButtonOne")) : (d.addClass("neeOffButton"), a.dmfw.isDudaone() && d.addClass("neeOffButtonOne"));
			e ? (d.addClass("neeOnOffButtonDisabled"), a.dmfw.isDudaone() && d.addClass("neeOnOffButtonDisabledOne")) : (d.removeClass("neeOnOffButtonDisabled"), a.dmfw.isDudaone() && d.removeClass("neeOnOffButtonDisabledOne"))
		}
		var g = a.extend({},
		{
			initState: !0,
			onFn: function() {},
			offFn: function() {}
		},
		e || {}),
		j = this;
		j.state = g.initState;
		j.addClass("neeOnButton");
		a.dmfw.isDudaone() && j.addClass("neeOnButtonOne");
		d(j, g.disabled);
		j.unbind("click");
		j.click(function() {
			if (!g.disabled) {
				j.state = !j.state;
				if (j.state) g.onFn();
				else g.offFn();
				d(j)
			}
		});
		j.disable = function() {
			g.disabled = !0;
			d(j, !0)
		};
		j.enable = function() {
			g.disabled = !1;
			d(j, !1)
		};
		return j
	};
	a.fn.toggleModeWidget = function(e) {
		function d(a, d, e) {
			a.unbind("click.toggleMode");
			a.bind("click.toggleMode",
			function() {
				k.state = d;
				e.toggle();
				g(k)
			})
		}
		function g(a) {
			function d(a, e) {
				a.removeClass("toggleModeOff");
				a.addClass("toggleModeOn");
				e.removeClass("toggleModeOn");
				e.addClass("toggleModeOff")
			}
			var e = a.find(".modeFirst"),
			g = a.find(".modeLast");
			0 == a.state ? d(e, g) : d(g, e)
		}
		var j = a.extend({},
		{
			initState: 0,
			first: {
				name: "First",
				toggle: function() {}
			},
			last: {
				name: "Last",
				toggle: function() {}
			}
		},
		e || {}),
		k = this;
		k.state = j.initState;
		var l = a("\x3cdiv class\x3d'toggleModeButtons'\x3e\x3c/div\x3e");
		e && e.classToAdd && l.addClass(e.classToAdd);
		e = a("\x3cspan class\x3d'modeFirst'\x3e" + j.first.name + "\x3c/span\x3e");
		var m = a("\x3cspan class\x3d'modeLast'\x3e" + j.last.name + "\x3c/span\x3e");
		l.append(e).append(m);
		k.empty();
		k.append(l);
		d(e, 0, j.first);
		d(m, 1, j.last);
		g(k)
	};
	a.fn.dmQrCodePopup = function(e) {
		e = a('\x3cdiv class\x3d"dmwrQRCodeWrapper"\x3e\x3cimg src\x3d"https://chart.googleapis.com/chart?cht\x3dqr\x26chs\x3d250x250\x26chl\x3d' + encodeURI(e.url) + '"/\x3e\x3cdiv class\x3d"dmwrQRCodeTextWrapper"\x3e\x3cspan class\x3d"dmwrQRCodeText"\x3e' + dmStr["ui.nee.publishPanel.300"] + "\x3c/span\x3e\x3c/div\x3e\x3c/div");
		a(this).neePopUpDiv(e)
	};
	a.fn.shareByEmailPopup = function(e) {
		var d = a('\x3cdiv class\x3d"dmwrSendEmailWrapper"\x3e\x3cdiv class\x3d"neeSendEmailText"\x3e' + dmStr["ui.nee.publishPanel.301"] + '\x3c/div\x3e\x3cdiv class\x3d"neeSendEmailInput"\x3e \x3cinput type\x3d"text" class\x3d"email" placeholder\x3d"' + dmStr["ui.nee.publishPanel.302"] + '"/\x3e\x3cspan class\x3d"neeSendEmailBtn orangeBtn ptOrangeBtn"\x3e' + dmStr["ui.nee.preview.popup.8"] + '\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"neeSendMailMsg"\x3e\x3c/div\x3e\x3c/div\x3e');
		a(this).neePopUpDiv(d, {
			init: function(d) {
				d = {
					mailType: e.mailType,
					siteAddress: e.siteAddress,
					msg: d.find(".neeSendMailMsg"),
					input: d.find(".neeSendEmailInput input"),
					sendBtn: d.find(".neeSendEmailBtn"),
					addTryModeParam: e.addTryModeParam
				};
				a.dmops.sendSiteAddressMail(d)
			}
		})
	};
	a.fn.inputURL = function(e, d) {
		var g = {
			inputBox: null,
			url: null,
			validateResponse: null,
			protocol: null,
			hostname: null,
			domain: null,
			path: null,
			fixDupliateDomain: !1,
			errorsMsg: null,
			errorsMsgParams: null,
			options: {
				protocol: "",
				hostname: "",
				domain: "",
				mustHavepPath: !1,
				changeOnInvalidProtocol: !1,
				changeOnInvalidHostName: !1,
				changeOnInvalidDomain: !1,
				fixDupliateDomain: !1
			},
			init: function(d, e) {
				this.inputBox = d;
				this.url = a(d).val();
				"object" == typeof e && (this.options = e);
				if ("" !== this.options.protocol && (this.protocol = this.url.substr(0, this.url.indexOf("://")), this.protocol !== this.options.protocol && (this.onInvalidProtocol(), null !== this.errorsMsg)) || "" !== this.options.hostname && (this.hostname = a.url("hostname", this.url), this.hostname.replace("www.", "") !== this.options.hostname.replace("www.", "") && (this.onInvalidDomain(), null !== this.errorsMsg)) || !0 == this.options.mustHavepPath && (this.checkPath(), null !== this.errorsMsg)) return this.onError(),
				this.validateResponse = !1;
				if (!1 == this.url.isUrl) return this.errorsMsg = a.dmString("nee.error.invalidUrl.1"),
				this.onError(),
				this.validateResponse = !1; ! 0 == this.options.fixDupliateDomain && this.checkDupliateDomain();
				return this.validateResponse = !0
			},
			onError: function() {
				a.dmfw.showValidationError(this.inputBox, a.dmString(this.errorsMsg, this.errorsMsgParams));
				a.dmx.editor.setValid(!1)
			},
			onInvalidProtocol: function() {
				if (!0 == this.options.changeOnInvalidProtocol) {
					var d = this.url.split(":");
					this.url = "http" !== d[0] && "https" !== d[0] ? this.options.protocol + "://" + this.url: this.url.replace(this.protocol, this.options.protocol);
					a(this.inputBox).val(this.url)
				} else this.errorsMsg = "ui.urlValidate.protocol",
				this.errorsMsgParams = [this.options.protocol.toUpperCase()]
			},
			onInvalidDomain: function() { ! 0 == this.options.changeOnInvalidDomain ? a(this.inputBox).val(a(this.inputBox).val().replace(this.domain, this.options.domain)) : (this.errorsMsg = "ui.urlValidate.domain", this.errorsMsgParams = [this.options.domain])
			},
			checkPath: function() {
				this.path = a.url("path", this.url);
				"/" == this.path && (this.errorsMsg = "ui.urlValidate.urlIncompleted")
			},
			checkDupliateDomain: function() {
				this.url.lastIndexOf(this.options.protocol + "://" + this.options.domain + "/")
			}
		};
		g.init(e, d);
		return g.validateResponse
	};
	a.fn.dmGeneralAutoComplete = function(e) {
		function d(a) {
			n.hide();
			var d = a;
			"url" == a.type ? d = a.id: e.facbookPages && (d = a.username ? "https://facebook.com/" + a.username: "https://facebook.com/pages/" + a.name + "/" + a.id);
			m.unbind("keypress.keyUp");
			e.callback && e.callback(d)
		}
		function g() {
			a(".fbPageswrapper").unbind("click.selectOption").on("click.selectOption", "ul li",
			function(e) {
				e.stopPropagation();
				e = eval("(" + a(this).attr("data-elem") + ")");
				d(e)
			})
		}
		function j(d) {
			n.find("ul").remove();
			if (0 == d.data.length) a("\x3cul/\x3e", {
				"class": "my-new-list emptyList",
				html: "No results found for your query. Check your spelling or try another term."
			}).appendTo(n),
			n.show();
			else {
				var j = [];
				if (e.facbookPages) {
					var k = j;
					a.each(d.data,
					function(a, d) {
						var e = d.picture && d.picture.data && d.picture.data.url ? "url(" + d.picture.data.url + ");": "",
						e = '\x3cli id\x3d"' + a + '" data-elem\x3d"' + JSON.stringify(d).replace(/\'/g, "\x26rsquo;").replace(/\"/g, "'") + '"\x3e\x3cdiv class\x3d"imgInfo" style\x3d"background-image: ' + e + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"genInfo"\x3e\x3cdiv class\x3d"genName"\x3e' + d.name + '\x3c/div\x3e\x3cdiv class\x3d"genCat"\x3e' + d.category + "\x3c/div\x3e";
						"url" != d.type && (e += '\x3cdiv class\x3d"genLikes"\x3e' + d.likes + " likes\x3c/div\x3e");
						k.push(e + "\x3c/div\x3e\x3c/li\x3e")
					});
					j = k
				}
				a("\x3cul/\x3e", {
					"class": "my-new-list",
					html: j.join("")
				}).appendTo(n);
				n.show();
				g()
			}
		}
		function k(a) {
			n.find("ul li").removeClass("itemhover");
			n.find("ul li").eq(a).addClass("itemhover");
			a = n.find("ul li").eq(a);
			currentRetWrap = a.attr("data-elem");
			r = eval("(" + currentRetWrap + ")");
			n.scrollTop(parseInt(a.index() * a.height()))
		}
		function l(a) {
			0 == n.find("ul li.itemhover").size() && (o = -1);
			"up" == a && -1 != o ? 0 != o && o--:"down" == a && o != n.find("ul li").size() - 1 && o++;
			k(o)
		}
		e = e || {};
		var m = a(this),
		n = a("\x3cdiv id\x3d'fbPageswrapper' class\x3d'fbPageswrapper'\x3e\x3c/div\x3e"),
		o = 0,
		r = null,
		u = m.data("dmfbat"),
		s = "";
		n.insertAfter(m);
		n.hide();
		n.css("width", e.width || m.outerWidth()).css("left", m.offset().left + "px");
		e.cssClass && n.addClass(e.cssClass);
		m.unbind("keypress").keypress(function(g) {
			g.stopPropagation();
			a(this).unbind("keyup").keyup(function(d) {
				38 == d.keyCode || (40 == d.keyCode || 13 == d.keyCode) || (d = a.trim(this.value), 2 <= d.length ? e.facbookPages && (e.webUrl && (s = d.replace(/\s+/g, " "), -1 == s.indexOf(".") ? s = "http://www." + s + ".com": -1 == s.indexOf("http") && (s = "http://" + s), data = {
					data: [{
						type: "url",
						id: s,
						name: s,
						category: "Your website URL",
						picture: {
							data: {
								url: "http://t1.gstatic.com/images?q\x3dtbn:ANd9GcTLSTPr2hncXSe1pCgMrkK8GSl2jP_-lei98c4UFvkSZHtycvBBuQ"
							}
						}
					}]
				},
				j(data)), a.getJSON("https://graph.facebook.com/search?fields\x3dusername,name,likes,picture,category\x26q\x3d" + d + "\x26type\x3dpage\x26limit\x3d20\x26access_token\x3d" + u,
				function(a) {
					e.webUrl && a.data.unshift({
						type: "url",
						id: s,
						name: s,
						category: "Your website URL",
						picture: {
							data: {
								url: "http://t1.gstatic.com/images?q\x3dtbn:ANd9GcTLSTPr2hncXSe1pCgMrkK8GSl2jP_-lei98c4UFvkSZHtycvBBuQ"
							}
						}
					});
					j(a)
				}).fail(function() {
					a.ajax({
						type: "get",
						cache: !1,
						async: !0,
						processData: !0,
						contentType: "application/json",
						url: "/api/uis/getfacebookauthtoken?force\x3dtrue",
						success: function(a) {
							u = a.value;
							m.data("dmfbat", u)
						}
					})
				})) : n.hide())
			});
			a(this).unbind("keydown").keydown(function(a) {
				a.stopPropagation();
				switch (a.keyCode) {
				case 38:
					l("up");
					break;
				case 40:
					l("down");
					break;
				case 13:
					null != r && d(r)
				}
			})
		});
		m.unbind("clickoutside").bind("clickoutside",
		function() {
			n.hide()
		})
	}
})(jQuery); (function(a) {
	var e = "link-page link-url link-url-special link-email link-call link-sms".split(" "),
	d = ["#", "javascript"],
	g = ["http:", "https:"].concat(d);
	a.fn.neeLinksWidget = function(j) {
		var k = this,
		l = {
			at: "bottom center",
			my: "top center"
		},
		m = a.dmfw.editables("link");
		k._current = {};
		k._data = {};
		k._options = {
			noTextToDisplay: !1,
			selectTextOnInit: !1
		};
		k._isDataValid = !1;
		k._currentQtipAt = null;
		this.close = function() {
			a.dmfw.hideEditorButton({
				selector: ".removeLinkButton"
			})
		};
		var n = function() {
			return "/pages/" + a.dmx.currentPage() + "/replaceelement/" + a.dmx.current.element.dmid()
		},
		o = function(a) { (url = a.attr("raw_url")) && a.attr("href", url).removeAttr("raw_url")
		},
		r = function(a) {
			return a.is(".dd-container") ? a.find(".dd-selected-value").val() : a.val()
		},
		u = function(d) {
			if (!a.dmx.site.originalBaseUrl) return d;
			d = d.replace(a.dmx.site.baseUrl, a.dmx.site.originalBaseUrl);
			return d.replace(a.dmx.site.normalizedBaseUrl, a.dmx.site.originalBaseUrl)
		},
		s = function(d) {
			return ! d || !a.dmx.site.originalBaseUrl || !d.startsWith("http") ? d: 0 == d.toLowerCase().localeCompare(a.dmx.site.originalBaseUrl.toLowerCase) ? a.dmx.site.baseUrl: d.replace(a.dmx.site.originalBaseUrl, a.dmx.site.normalizedBaseUrl)
		},
		B = function(a) {
			for (var e = 0; e < d.length; e++) if (a.startsWith(d[e])) return ! 0;
			return ! 1
		},
		z = function(d) {
			d = a.parseUrlExtension(d);
			return ! d || -1 == a.inArray(d, a.dmx.nonRewritableUrlExts)
		},
		v = function() {
			switch (k._data.id) {
			case "link-email":
				return k._data.value.startsWith("mailto:") ? k._data.value.substring(7) : k._data.value;
			case "link-call":
				return k._data.value.startsWith("tel:") ? k._data.value.substring(4) : k._data.value;
			case "link-sms":
				return k._data.value.startsWith("sms:") ? k._data.value.substring(4) : k._data.value;
			default:
				return k._data.value
			}
		},
		D = function(a) {
			return a.is(".dmButtonLink")
		},
		E = function(d, e) {
			var g = e = e.trim();
			try {
				g.startsWith(d) && (g = g.substring(d.length));
				if (1 > g.length) throw "invalid";
				g = g.replace(/[-,\+,(,), ]/g, "");
				if (!g.isNumeric()) throw "invalid";
				e.startsWith(d) || (e = d + e);
				return e
			} catch(j) {
				a.dmfw.showQTip({
					type: "error",
					selector: "tel:" == d ? "#phone": "#sms",
					text: dmStr["ui.nee.linkEditor.3"],
					position: l
				})
			}
		},
		F = function(a) {
			a = a.trim();
			for (var d = !1,
			e = 0; e < g.length; e++) if (a.startsWith(g[e])) {
				d = !0;
				break
			}
			d || (a = "http://" + a);
			return a.isUrl() ? a: null
		},
		I = function(d) {
			var g = d.$li,
			j = !0;
			if (d.updateSelected) {
				a: {
					for (j = 0; j < e.length; j++) if (g.hasClass(e[j])) {
						j = e[j];
						break a
					}
					j = null
				}
				var m = j,
				j = null,
				n = k._data.id;
				if (m) {
					var j = k.find("." + m),
					o = j.parents(".linkPanel");
					o.find(".expanded").addClass("displayNone");
					o.find(".collapsed").removeClass("displayNone");
					o.find("input[type\x3d'radio']").removeAttr("checked");
					j.find(".collapsed").addClass("displayNone");
					j.find(".expanded").removeClass("displayNone");
					j.find(".expanded input[type\x3d'radio']").attr("checked", !0)
				} else m = k.find("input[type\x3dradio]:checked"),
				j = k.find("." + m);
				k._data.id = m;
				n = n != k._data.id;
				"link-page" == m ? (k.find(".createNewPageBubble").addClass("displayNone"), "disabled" != j.find("#page-select").attr("disabled") ? (j.find("#page-select").focus(), k._data.value = r(j.find("#page-select")), n = !0) : n = !1) : "link-url" == m || "link-url-special" == m ? (m = s(j.find("#url").val()), m != k._data.value && (j.find("#url").focus(), k._data.value = m, k._data.dontMobilize = j.find("#mobilize").is(":checked"), k._data.isNewWindow = j.find("#newWindow").is(":checked"), n = !0)) : "link-email" == m ? j.find("#email").val() != k._data.value && (j.find("#email").focus(), k._data.value = j.find("#email").val(), n = !0) : "link-sms" == m ? k._data.value != j.find("#sms").val() && (j.find("#sms").focus(), k._data.value = j.find("#sms").val(), n = !0) : "link-call" == m && k._data.value != j.find("#phone").val() && (j.find("#phone").focus(), k._data.value = j.find("#phone").val(), n = !0);
				n && !k._data.value && (n = !1);
				j = n
			}
			if (j) {
				var v = k._current.element,
				u = k._data.isNavLink ? k._current.navLink.element: k._current.element;
				switch (k._data.id) {
				case "link-page":
					j = k.find("#page-select");
					k._data.value = r(j);
					break;
				case "link-email":
					j = k._data.value;
					j = j.trim();
					j.startsWith("mailto:") && (j = j.substring(7));
					/^([a-zA-Z0-9])(([a-zA-Z0-9])*([\._\+-])*([a-zA-Z0-9]))*@(([a-zA-Z0-9\-])+(\.))+([a-zA-Z]{2,4})+$/.test(j) ? j.startsWith("mailto:") || (j = "mailto:" + j) : (a.dmfw.showQTip({
						type: "error",
						selector: "#email",
						text: dmStr["ui.nee.linkEditor.2"],
						position: l
					}), k._currentQtipAt = a("#email"), j = null);
					if (null == (val = j)) return ! 1;
					k._data.value = val;
					break;
				case "link-call":
					if (null == (val = E("tel:", k._data.value))) return ! 1;
					k._data.value = val;
					break;
				case "link-sms":
					if (null == (val = E("sms:", k._data.value))) return ! 1;
					k._data.value = val
				}
				var z = a.extend({},
				k._data);
				delete z.isNewWindow;
				k._isDataValid = !0;
				a.changePage({
					clientChange: function() {},
					serverChange: function() {
						a.dmUIBlockControlled({
							region: "neeLinksWidget.modifyLink",
							op: "block",
							style: "preview"
						});
						var e;
						try {
							e = z.isNavLink ? a.dmx.header.id: a.dmx.currentPage()
						} catch(j) {
							e = a.dmx.homePage().id
						}
						a.dmfw.isDudaone() && "link-url" === z.id && (z.dontMobilize = !0);
						var m = u.is(".dmLocked");
						a.dmPostWithHistory({
							url: "/pages/" + e + "/modifylink/" + u.dmid(),
							data: z,
							error: function(d) {
								try {
									switch (d.error_code) {
									case "NonRewritableUrlExtension":
										return k._data.dontMobilize = !0,
										g.find("#mobilize").attr("checked", !0),
										a.dmfw.showQTip({
											type: "error",
											selector: "#mobilize",
											text: d.message,
											position: {
												at: "bottom right",
												my: "top left"
											}
										}),
										!0;
									case "CantsetDontMobilizeOnSiteBase":
										return k._data.dontMobilize = !1,
										g.find("#mobilize").attr("checked", !1),
										a.dmfw.showQTip({
											type: "error",
											selector: "#mobilize",
											text: dmStr["ui.nee.linkEditor.4"],
											position: {
												at: "bottom right",
												my: "top left"
											}
										}),
										!0;
									case "UrlTooLong":
										return a.dmfw.showQTip({
											type:
											"error",
											selector: "#url",
											text: dmStr["ui.nee.linkEditor.5"],
											position: l
										}),
										!0;
									default:
										return null
									}
								} catch(e) {
									return null
								} finally {
									a.dmUIBlockControlled({
										region:
										"neeLinksWidget.modifyLink",
										op: "unblock"
									})
								}
							},
							success: function(e) {
								try {
									var g = e.element;
									void 0 != g.text && (D(v) ? v.find(".text").text(g.text) : v.each(function() {
										var d = a(this);
										d.find("a span.navText") ? d.find(".navText:first").text(g.text) : v.text(g.text)
									}));
									if (g.attrs) for (var j in g.attrs) g.attrs.hasOwnProperty(j) && (null != g.attrs[j] ? v.attr(j, g.attrs[j]) : v.removeAttr(j));
									m && (v.selectElement(), v.lockElement(), a.dmfw.isDudaone() && (a.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide(), a.dmx.current.editable.inlineEditor.editorUtils.hideSelectionOverlay()));
									if (k._options.onSaved) k._options.onSaved(k._data);
									a.dmNotify("Link modified.");
									d.success && d.success();
									k._options.success && k._options.success()
								} finally {
									a.dmUIBlockControlled({
										region: "neeLinksWidget.modifyLink",
										op: "unblock"
									})
								}
							}
						})
					}
				})
			}
			return ! 0
		},
		G = function(d) {
			d.empty();
			var e = 0;
			a(a.dmx.editablePages()).each(function() {
				if (this.isFromScratchLegacy || this.isBFS) {
					var g = a("\x3coption /\x3e");
					g.attr("value", this.alias).text(this.title);
					"link-page" == k._data.id && k._data.value == this.alias && g.attr("selected", "selected");
					d.append(g);
					e++
				}
			});
			0 < e && a.dmfw.isPT() && a("#np-goto").css("visibility", "visible");
			return e
		},
		K = function(d) {
			var e = a.dmx.editablePages().filter(function(a) {
				return a.isFromScratchLegacy || a.isBFS
			}).map(function(a) {
				var d = !1;
				"link-page" == k._data.id && k._data.value == a.alias && (d = !0);
				return {
					text: a.title,
					value: a.alias,
					selected: d
				}
			}),
			g = e.length;
			d.data("ddslick") && d.ddslick("destroy");
			d = a('\x3cdiv id\x3d"page-select"\x3e\x3c/div\x3e');
			a(".onSiteLinkSelected .linkContent").prepend(d);
			d.styleSelectBox(function() {
				I({
					$li: k.find("#page-select").parents("li"),
					updateSelected: !0
				})
			},
			{
				isFirstTime: !0
			},
			e);
			0 < g && a("#np-goto").css("visibility", "visible");
			return g
		};
		k._options = a.extend({
			markupUrl: m.getMarkupUrl()
		},
		j);
		k._current = k._options.current ? k._options.current: a.dmx.current;
		k._data = {};
		k._data.isNavLink = k._current.navLink ? !0 : !1;
		k._data.text = k._current ? a.trim(a(k._current.element.get(0)).text()) : "";
		j = a.dmAnchorValue(k._current.element);
		if (j.startsWith("mailto:")) k._data.id = "link-email",
		k._data.value = j.substring(7);
		else if (j.startsWith("tel:")) k._data.id = "link-call",
		k._data.value = j.substring(4);
		else if (j.startsWith("sms:")) k._data.id = "link-sms",
		k._data.value = j.substring(4);
		else {
			j = k._current.element.attr("raw_url");
			var J;
			if (J = j) {
				J = j;
				if ( - 1 != (i = J.indexOf("?"))) J = J.substring(0, i);
				var C = "/site/" + a.dmx.site.alias;
				J = J == C || J == C + "/" ? !0 : !1
			}
			J && (j = a.dmx.site.baseUrl);
			if (j && j.startsWith("/site/" + a.dmx.site.alias + "/")) {
				if (k._data.id = "link-page", k._data.value = j.substring(("/site/" + a.dmx.site.alias + "/").length), -1 != (j = k._data.value.indexOf("?"))) k._data.value = k._data.value.substring(0, j)
			} else J = k._current.element.attr("href"),
			B(J) ? (k._data.id = "link-url-special", k._data.value = J, k._data.dontMobilize = !1, k._data.isNewWindow = !1) : (k._data.id = "link-url", k._data.value = j, k._data.isNewWindow = void 0 != k._current.element.attr("target"), k._data.dontMobilize = J.startsWith("/site/") ? !1 : !0, z(k._data.value) || k.find("#mobilize").attr("disabled", !0))
		}
		k._isDataValid = !0;
		a.dmLoad(k, k._options.markupUrl,
		function() {
			k.show();
			var d = function(d) {
				var g = a.trim(d.val()),
				j = !1;
				if ("textToDisplay" == d.attr("id")) {
					if (k._data.text != g) {
						if (e.onTitleChanged) e.onTitleChanged(g);
						else j = !0;
						k._data.text = g;
						if (j) {
							var m = k._current.element,
							n = k._data.isNavLink ? k._current.navLink.element: k._current.element;
							a.dmUIBlockControlled({
								region: "neeLinksWidget.modifyLinkText",
								op: "block",
								style: "preview"
							});
							var o = {
								text: k._data.text,
								textElementId: k._data.textElementId
							};
							a.changePage({
								serverChange: function() {
									a.dmPostWithHistory({
										url: "/pages/" + a.dmx.currentPage() + "/modifylinktext/" + n.dmid(),
										data: o,
										success: function() {
											try {
												if (D(m) ? m.find(".text").text(k._data.text) : m.text(k._data.text), k._options.onSaved) k._options.onSaved(k._data)
											} finally {
												a.dmUIBlockControlled({
													region: "neeLinksWidget.modifyLinkText",
													op: "unblock"
												})
											}
										}
									})
								}
							})
						}
						return
					}
				} else if (v() != g) {
					k._isDataValid = !1;
					if ("url" == d.attr("id")) {
						var j = B(g),
						r = !1;
						if (j) k._data.id = "link-url-special";
						else {
							g = F(g);
							if (null == g) {
								a.dmfw.showQTip({
									type: "error",
									selector: "#url",
									text: dmStr["ui.nee.linkEditor.1"],
									position: l
								});
								k._currentQtipAt = k.find("#url");
								return
							}
							k._data.id = "link-url";
							r = z(g)
						}
						var u = a(this).parents("li");
						j || !r ? u.find("#mobilize").attr("disabled", !0) : u.find("#mobilize").attr("disabled", !1);
						u.find("#newWindow").attr("disabled", j);
						d.val(g)
					}
					k._data.value = s(g);
					j = !0
				}
				j && (I({
					$li: k.parents("li"),
					updateSelected: !1
				}) || d.focus(), k._isDataValid || (k._data.value = ""))
			},
			e = k._options;
			e.noTextToDisplay ? (k.find(".textDisplayWrapper").hide(), k._data.text = void 0) : k.find("#textToDisplay").focus();
			a.dmx.site.isBlog && k.find("li.link-page").hide();
			e.noRemoveLink || a.dmfw.showEditorButton({
				selector: ".removeLinkButton",
				click: function() {
					var d = k._current.element;
					if (0 == d.children().length) {
						var e = a("\x3cspan\x3e\x3c/span\x3e").text(d.text());
						a.changePage({
							clientChange: function() {
								d.replaceWith(e)
							},
							serverChange: function() {
								a.dmPostWithHistory({
									url: "/pages/" + a.dmx.currentPage() + "/replaceelement/" + d.dmid(),
									data: {
										markup: e.outerHTML()
									},
									success: function() {}
								})
							}
						})
					} else a.dmops.updateCurrentAttributes({
						attrToRemove: ["href", "raw_url"]
					},
					{
						element: k._current.element
					});
					if (k._options.onLinkRemove) k._options.onLinkRemove(d);
					else a.dmfw.closeEditorLast()
				}
			});
			D(k._current.element) && (k._data.textElementId = k._current.element.find(".text").dmid());
			var g = a("#makeButtonOnOffBtn");
			k._current.element.is(".dmOnlyButton") && (k._options.noSurroundButton = !0);
			if (k._options.noSurroundButton) k.find(".linkAsButton").hide();
			else g.onOffBtn({
				initState: D(k._current.element),
				onFn: function() {
					var d = function() {
						var d = a.uniqueid();
						return "\x3cspan class\x3d'iconBg' duda_id\x3d'" + d + "'id\x3d'" + d + "'\x3e\x3cspan class\x3d'icon' duda_id\x3d'" + (d + 1) + "'id\x3d'" + (d + 1) + "'\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d'text' duda_id\x3d'" + (d + 2) + "'id\x3d'" + (d + 2) + "'\x3e" + a.dmx.current.element.html() + "\x3c/span\x3e"
					};
					a.changePage({
						clientChange: function() {
							a.dmx.current.element.addClass("dmButtonLink").addClass("dmWidget").addClass("dmWwr");
							a.dmx.current.element.html(d());
							a.dmfw.reopenEditor({
								element: a.dmx.current.element,
								editable: m
							},
							{
								skipOnClose: !0
							})
						},
						serverChange: function() {
							var d = a.dmfw.preview.cloneInlineElement(a.dmx.current.element);
							o(d.closest("a"));
							a.dmPostWithHistory({
								url: n(),
								data: {
									markup: d.outerHTML()
								},
								success: function() {}
							})
						}
					})
				},
				offFn: function() {
					a.changePage({
						clientChange: function() {
							a.dmx.current.element.removeClass("dmButtonLink").removeClass("dmWidget").removeClass("dmWwr");
							a.dmx.current.element.html(a.dmx.current.element.find(".text").html());
							a.dmfw.reopenEditor({
								element: a.dmx.current.element.closest("a"),
								editable: m
							})
						},
						serverChange: function() {
							var d = a.dmfw.preview.cloneInlineElement(a.dmx.current.element);
							o(d);
							a.dmPostWithHistory({
								url: n(),
								data: {
									markup: d.outerHTML()
								},
								success: function() {}
							})
						}
					})
				}
			});
			var g = function(d) {
				a.dmfw.isPT() ? a.dmfw.openPopupFromUrl("/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.addNewPage.jsp?alias\x3d" + a.dmx.site.alias, {
					init: function() {
						a.ptPages.initAddNewPageTemplates({
							noNavigate: !0,
							addToNav: !1,
							success: function(d) {
								k._data.id = "link-page";
								k._data.value = d.page.alias;
								C.removeAttr("disabled").css("color", "");
								G(C);
								I({
									$li: a(this).parents("li"),
									updateSelected: !1
								})
							}
						})
					},
					classes: "linkEditorPopup",
					dontRemoveCurrent: k.is(".popupWinExample *")
				}) : ca.show().find("#createNewPageInput").val(k._data.text).focus();
				d.stopPropagation();
				ca.find("#createNewPageInput").bind("clickoutside",
				function() {
					this.focus()
				});
				ca.bind("clickoutside",
				function() {
					a(this).unbind("clickoutside").hide()
				})
			},
			j = function() {
				a.addPage.open({
					callback: function(d) {
						var e;
						e = a("#page-select");
						K(e);
						e = a("#page-select").data("ddslick").settings.data.map(function(a) {
							return a.value
						});
						d = d.last();
						d = a.inArray(d, e);
						a("#page-select").ddslick("select", {
							index: d
						})
					},
					dontNavigate: !0
				})
			},
			r = function() {
				var d = k._current.element;
				a.dmfw._closeEditorAll();
				a.dmfw.previewNavigateTo({
					element: d,
					onLoad: function() {
						NEFW._navigateToSelectedTab(NAV_DESIGN_ID)
					}
				})
			},
			E = function() {
				var d = a("#pagesPanel");
				alias = a("#page-select").data("ddslick").selectedData.value;
				pageSelector = 'li[data-alias\x3d"' + alias + '"], li[data-alias\x3d"site/' + a.dmx.site.alias + "/" + alias + '"]';
				$pageButton = d.find(pageSelector);
				"open" === d.attr("state") ? $pageButton.find(".pageName").trigger("click") : (d.click(), setTimeout(function() {
					$pageButton.find(".pageName").trigger("click")
				},
				500))
			},
			C = k.find("#page-select"),
			J;
			J = a.dmfw.isDudaone() ? K(C) : G(C);
			var ca = k.find(".createNewPageBubble").hide();
			ca.find(".createNewPageLinks span").click(function(d) {
				var e = ca.find("#createNewPageInput").val();
				if (e) {
					var g = a(this);
					if (g.data("clicked")) return ! 1;
					g.data("clicked", !0);
					setTimeout(function() {
						g.data("clicked", !1)
					},
					300);
					var j = "np-edit-now" == a(this).attr("id");
					a.dmPreviewSaving();
					a.dmops.createPageBlank({
						suggestedAlias: e,
						addToNav: !1,
						success: function(d) {
							k._data.id = "link-page";
							k._data.value = d.page.alias;
							C.removeAttr("disabled").css("color", "");
							G(C);
							I({
								$li: a(this).parents("li"),
								updateSelected: !1,
								success: function() {
									j ? a.dmfw.previewNavigateTo({
										element: k._current.element,
										onLoad: function() {
											NEFW._navigateToSelectedTab(NAV_DESIGN_ID)
										}
									}) : C.find("option[value\x3d'n/a']").remove();
									ca.hide();
									a.dmPreviewSaved()
								}
							})
						}
					})
				} else d.stopPropagation()
			});
			k.find("#np-goto").click(a.dmfw.isDudaone() ? E: r);
			k.find("#np-create").click(a.dmfw.isDudaone() ? j: g);
			0 == J && (g = a("\x3coption selected\x3d'selected' value\x3d'n/a'\x3e" + dmStr["ui.nee.linkEditor.6"] + "\x3c/option\x3e"), C.append(g).attr("disabled", "disabled").css("color", "lightgray"));
			g = k.find(".linkPanel");
			g.find("#textToDisplay").val(k._data.text);
			g.find(".expanded").addClass("displayNone");
			g.find(".collapsed").removeClass("displayNone");
			g.find("input[type\x3d'radio']").removeAttr("checked");
			g = k.find("." + k._data.id);
			g.find(".collapsed").addClass("displayNone");
			g.find(".expanded").removeClass("displayNone");
			g.find(".expanded input[type\x3d'radio']").attr("checked", !0);
			g.find("#mobilize").attr("checked", k._data.dontMobilize);
			g.find("#newWindow").attr("checked", k._data.isNewWindow);
			"link-url-special" == k._data.id ? (k.find("#url").val(k._data.value), g.find("#mobilize").attr("disabled", !0), g.find("#newWindow").attr("disabled", !0)) : "link-url" == k._data.id ? (k.find("#url").val(u(k._data.value)), z(k._data.value) || g.find("#mobilize").attr("disabled", !0)) : (k.find("#url").attr("placeholder", m.getDefaultUrlPlaceHolder()), "link-page" == k._data.id ? k.find("#page-select").val(k._data.value) : "link-email" == k._data.id ? k.find("#email").val(k._data.value) : "link-call" == k._data.id ? k.find("#phone").val(k._data.value) : "link-sms" == k._data.id && k.find("#sms").val(k._data.value));
			e.selectTextOnInit && k.find("#textToDisplay").select();
			var ha = k.find(".linkPanel \x3e li").not(".textDisplayWrapper");
			k.find(":radio,.collapsed").click(function() {
				a(".qtip.ui-tooltip").qtip("hide");
				if (!k._isDataValid) switch (k._data.id) {
				case "link-email":
					k.find("#email").val("");
					break;
				case "link-call":
					k.find("#phone").val("");
					break;
				case "link-sms":
					k.find("#sms").val("")
				}
				I({
					$li:
					a(this).parents("li"),
					updateSelected: !0
				});
				if (a.dmfw.isDudaone()) {
					var d = a(this).closest("li");
					ha.removeClass("selected");
					d.addClass("selected")
				}
			});
			k.find("#mobilize").change(function() {
				k._data.dontMobilize = this.checked;
				var d = s(k.find("#url").val());
				null != F(d) && I({
					$li: a(this).parents("li"),
					updateSelected: !1
				})
			});
			k.find("#newWindow").change(function() {
				k._data.isNewWindow = this.checked;
				if (e.onNavTargetChange) e.onNavTargetChange(k._data.isNewWindow ? "_blank": "", !k._data.isNewWindow);
				else {
					var d = {},
					d = k._data.isNewWindow ? {
						attrToAdd: {
							target: "_blank"
						}
					}: {
						attrToRemove: ["target"]
					};
					a.dmsrv.updateElementAttributes(k._current.element, d,
					function(a) {
						k._data.isNewWindow ? k._current.element.attr("target", "_blank") : k._current.element.removeAttr("target");
						if (k._options.onSaved) k._options.onSaved(a)
					})
				}
			});
			k.find("#url").keyup(function() {
				var d = !z(a(this).val());
				d ? (k._data.dontMobilize = !0, k.find("#mobilize").attr("checked", !0)) : k.find("#mobilize").attr("checked", k._data.dontMobilize);
				k.find("#mobilize").attr("disabled", d)
			});
			k.find(":text").bind("keypress",
			function(e) {
				13 == (e.keyCode ? e.keyCode: e.which) && d(a(this))
			});
			k.find(":text").blur(function() {
				d(a(this))
			});
			k.find("#createNewPageInput").unbind("blur");
			k.find("#page-select").change(function() {
				I({
					$li: a(this).parents("li"),
					updateSelected: !0
				})
			});
			k.find(".doneBtn").click(function() {
				if (k._options.onDone) k._options.onDone(); (a.dmfw.isPT() || a.dmfw.isDudaone()) && a.ptPages.refreshPagesPT()
			})
		});
		return k
	}
})(jQuery); (function(a) {
	a.fn.neeBreadcrumbWidget = function(e) {
		if (e && e.parts) {
			this.children(".breadcrumb-part").each(function() {
				a(this).remove()
			});
			for (var d = this,
			g = null,
			j = d.children(".breadcrumb-first"), k = 0; k < e.parts.length; k++) {
				var l = e.parts[k];
				if (l.click) {
					l.title && (0 != k ? (j = a("\x3cspan\x3e\x26nbsp;\x3e\x26nbsp;\x3e" + l.title + "\x3c/span\x3e").attr("title", l.title), this.append(j)) : j.text(l.title));
					j.addClass("breadcrumb-link");
					var m = l.click,
					g = function(e) {
						d.children(".breadcrumb-link").removeClass("breadcrumb-link");
						m(e);
						a.dmfw.preview.removeEditableBar()
					};
					j.unbind("click").click(g)
				} else this.append(a('\x3cspan class\x3d"arrow breadcrumb-part"\x3e\x3e\x26nbsp;\x3c/span\x3e')),
				this.append(a('\x3cspan class\x3d"breadcrumb-part"\x3e' + l.title + "\x26nbsp;\x3c/span\x3e").attr("title", l.title))
			}
			a.dmfw.showEditorBack(g)
		}
	}
})(jQuery); (function(a) {
	a.fn.neeNavtoWidget = function() {
		var e = this,
		d = a(".neePreviewPagesPanelPhoneNavPopup"),
		g = d.find(".neePreviewPagesPanelNavPopupBody"),
		j = d.find(".neePreviewPagesPanelPhoneNavArrowClose");
		this.setCurrent = function(d) {
			if (a.dmx.site.isBlog) d = "default" == a.dmx.page.title ? "Blog Post": a.dmx.page.title;
			else {
				if (!d || "home" == a.dmx.page.title) d = a.dmx.page.title;
				"default" == d && (d = a.dmx.preview.wnd().Parameters.PageGuessedAlias)
			}
			e.find(".neePreviewPagesPanelPhoneNavText").html(d)
		};
		var k = function(d) {
			var e = a("\x3cdiv\x3e\x3c/div\x3e"),
			g = a("\x3cdiv\x3e\x3c/div\x3e");
			g.html("Blog Post");
			e.addClass("neePreviewPagesPanelPhoneNavItemWrapper");
			g.addClass("neePreviewPagesPanelPhoneNavItem");
			g.unbind("click").bind("click",
			function() {
				a.dmfw.previewNavigateTo({
					url: a.dmx.rt.blogFirststPostHref
				});
				j.trigger("click")
			});
			e.append(g);
			d.append(e)
		};
		e.find(".neePreviewPagesPanelPhoneNavText").unbind("click").bind("click",
		function() {});
		e.find(".neePreviewPagesPanelPhoneNavArrow, .neePreviewPagesPanelPhoneNavText").unbind("click").bind("click",
		function() {
			d.hasClass("show") ? j.trigger("click") : (d.addClass("show"), a.dmops.updateEditContext.all({
				success: function() {
					if (a.dmx.site.isBlog) {
						var d = !1;
						a.each(a.dmx.editablePages(),
						function(e, n) {
							if ("bpost" === n.alias) k(g),
							d = !0;
							else {
								var o = a("\x3cdiv\x3e\x3c/div\x3e"),
								r = a("\x3cdiv\x3e\x3c/div\x3e");
								r.html(n.title);
								o.addClass("neePreviewPagesPanelPhoneNavItemWrapper");
								r.addClass("neePreviewPagesPanelPhoneNavItem");
								r.unbind("click").bind("click",
								function() {
									n.alias && "original" != n.alias ? (a.dmx.pagesUI.curType = n.type, a.dmx.pagesUI.curId = n.id, a.dmfw.previewNavigateTo({
										page: {
											alias: n.alias,
											query: n.url ? "url\x3d" + escape(n.url) : void 0
										}
									})) : a.dmfw.previewNavigateTo({
										url: n.url
									});
									j.trigger("click")
								});
								o.append(r);
								g.append(o)
							}
						});
						d || k(g)
					} else a.each(a.dmx.editableLinks({
						uniqueNavLinkUrls: !0
					}),
					function(d, e) {
						var k = a("\x3cdiv\x3e\x3c/div\x3e"),
						l = a("\x3cdiv\x3e\x3c/div\x3e");
						e.type && ("page" == e.type && "home" == e.alias) && (e.title = dmStr["ui.home"]);
						l.html(e.title);
						k.addClass("neePreviewPagesPanelPhoneNavItemWrapper");
						l.addClass("neePreviewPagesPanelPhoneNavItem");
						l.unbind("click").bind("click",
						function() {
							e.alias && "original" != e.alias ? (a.dmx.pagesUI.curType = e.type, a.dmx.pagesUI.curId = e.id, a.dmfw.previewNavigateTo({
								page: {
									alias: e.alias,
									query: e.url ? "url\x3d" + escape(e.url) : void 0
								}
							})) : a.dmfw.previewNavigateTo({
								url: e.url
							});
							j.trigger("click")
						});
						k.attr("title", e.url);
						k.append(l);
						g.append(k)
					})
				}
			}))
		});
		j.unbind("click").bind("click",
		function() {
			d.removeClass("show");
			g.empty()
		});
		return e
	}
})(jQuery);
this.Handlebars = {}; (function(a) {
	a.VERSION = "1.0.0-rc.3";
	a.COMPILER_REVISION = 2;
	a.REVISION_CHANGES = {
		1 : "\x3c\x3d 1.0.rc.2",
		2 : "\x3e\x3d 1.0.0-rc.3"
	};
	a.helpers = {};
	a.partials = {};
	a.registerHelper = function(a, e, j) {
		j && (e.not = j);
		this.helpers[a] = e
	};
	a.registerPartial = function(a, e) {
		this.partials[a] = e
	};
	a.registerHelper("helperMissing",
	function(a) {
		if (2 !== arguments.length) throw Error("Could not find property '" + a + "'");
	});
	var e = Object.prototype.toString;
	a.registerHelper("blockHelperMissing",
	function(d, g) {
		var j = g.inverse ||
		function() {},
		k = g.fn,
		l = e.call(d);
		"[object Function]" === l && (d = d.call(this));
		return ! 0 === d ? k(this) : !1 === d || null == d ? j(this) : "[object Array]" === l ? 0 < d.length ? a.helpers.each(d, g) : j(this) : k(d)
	});
	a.K = function() {};
	a.createFrame = Object.create ||
	function(d) {
		a.K.prototype = d;
		d = new a.K;
		a.K.prototype = null;
		return d
	};
	a.logger = {
		DEBUG: 0,
		INFO: 1,
		WARN: 2,
		ERROR: 3,
		level: 3,
		methodMap: {
			"0": "debug",
			1 : "info",
			2 : "warn",
			3 : "error"
		},
		log: function(d, e) {
			if (a.logger.level <= d) {
				var j = a.logger.methodMap[d];
				"undefined" !== typeof console && console[j] && console[j].call(console, e)
			}
		}
	};
	a.log = function(d, e) {
		a.logger.log(d, e)
	};
	a.registerHelper("each",
	function(d, e) {
		var j = e.fn,
		k = e.inverse,
		l = 0,
		m = "",
		n;
		e.data && (n = a.createFrame(e.data));
		if (d && "object" === typeof d) if (d instanceof Array) for (var o = d.length; l < o; l++) n && (n.index = l),
		m += j(d[l], {
			data: n
		});
		else for (o in d) d.hasOwnProperty(o) && (n && (n.key = o), m += j(d[o], {
			data: n
		}), l++);
		0 === l && (m = k(this));
		return m
	});
	a.registerHelper("if",
	function(d, g) {
		"[object Function]" === e.call(d) && (d = d.call(this));
		return ! d || a.Utils.isEmpty(d) ? g.inverse(this) : g.fn(this)
	});
	a.registerHelper("unless",
	function(d, e) {
		var j = e.fn;
		e.fn = e.inverse;
		e.inverse = j;
		return a.helpers["if"].call(this, d, e)
	});
	a.registerHelper("with",
	function(a, e) {
		return e.fn(a)
	});
	a.registerHelper("log",
	function(d, e) {
		var j = e.data && null != e.data.level ? parseInt(e.data.level, 10) : 1;
		a.log(j, d)
	})
})(this.Handlebars);
var handlebars = function() {
	function a() {
		this.yy = {}
	}
	var e = {
		trace: function() {},
		yy: {},
		symbols_: {
			error: 2,
			root: 3,
			program: 4,
			EOF: 5,
			simpleInverse: 6,
			statements: 7,
			statement: 8,
			openInverse: 9,
			closeBlock: 10,
			openBlock: 11,
			mustache: 12,
			partial: 13,
			CONTENT: 14,
			COMMENT: 15,
			OPEN_BLOCK: 16,
			inMustache: 17,
			CLOSE: 18,
			OPEN_INVERSE: 19,
			OPEN_ENDBLOCK: 20,
			path: 21,
			OPEN: 22,
			OPEN_UNESCAPED: 23,
			OPEN_PARTIAL: 24,
			partialName: 25,
			params: 26,
			hash: 27,
			DATA: 28,
			param: 29,
			STRING: 30,
			INTEGER: 31,
			BOOLEAN: 32,
			hashSegments: 33,
			hashSegment: 34,
			ID: 35,
			EQUALS: 36,
			PARTIAL_NAME: 37,
			pathSegments: 38,
			SEP: 39,
			$accept: 0,
			$end: 1
		},
		terminals_: {
			2 : "error",
			5 : "EOF",
			14 : "CONTENT",
			15 : "COMMENT",
			16 : "OPEN_BLOCK",
			18 : "CLOSE",
			19 : "OPEN_INVERSE",
			20 : "OPEN_ENDBLOCK",
			22 : "OPEN",
			23 : "OPEN_UNESCAPED",
			24 : "OPEN_PARTIAL",
			28 : "DATA",
			30 : "STRING",
			31 : "INTEGER",
			32 : "BOOLEAN",
			35 : "ID",
			36 : "EQUALS",
			37 : "PARTIAL_NAME",
			39 : "SEP"
		},
		productions_: [0, [3, 2], [4, 2], [4, 3], [4, 2], [4, 1], [4, 1], [4, 0], [7, 1], [7, 2], [8, 3], [8, 3], [8, 1], [8, 1], [8, 1], [8, 1], [11, 3], [9, 3], [10, 3], [12, 3], [12, 3], [13, 3], [13, 4], [6, 2], [17, 3], [17, 2], [17, 2], [17, 1], [17, 1], [26, 2], [26, 1], [29, 1], [29, 1], [29, 1], [29, 1], [29, 1], [27, 1], [33, 2], [33, 1], [34, 3], [34, 3], [34, 3], [34, 3], [34, 3], [25, 1], [21, 1], [38, 3], [38, 1]],
		performAction: function(a, e, j, k, l, m) {
			a = m.length - 1;
			switch (l) {
			case 1:
				return m[a - 1];
			case 2:
				this.$ = new k.ProgramNode([], m[a]);
				break;
			case 3:
				this.$ = new k.ProgramNode(m[a - 2], m[a]);
				break;
			case 4:
				this.$ = new k.ProgramNode(m[a - 1], []);
				break;
			case 5:
				this.$ = new k.ProgramNode(m[a]);
				break;
			case 6:
				this.$ = new k.ProgramNode([], []);
				break;
			case 7:
				this.$ = new k.ProgramNode([]);
				break;
			case 8:
				this.$ = [m[a]];
				break;
			case 9:
				m[a - 1].push(m[a]);
				this.$ = m[a - 1];
				break;
			case 10:
				this.$ = new k.BlockNode(m[a - 2], m[a - 1].inverse, m[a - 1], m[a]);
				break;
			case 11:
				this.$ = new k.BlockNode(m[a - 2], m[a - 1], m[a - 1].inverse, m[a]);
				break;
			case 12:
				this.$ = m[a];
				break;
			case 13:
				this.$ = m[a];
				break;
			case 14:
				this.$ = new k.ContentNode(m[a]);
				break;
			case 15:
				this.$ = new k.CommentNode(m[a]);
				break;
			case 16:
				this.$ = new k.MustacheNode(m[a - 1][0], m[a - 1][1]);
				break;
			case 17:
				this.$ = new k.MustacheNode(m[a - 1][0], m[a - 1][1]);
				break;
			case 18:
				this.$ = m[a - 1];
				break;
			case 19:
				this.$ = new k.MustacheNode(m[a - 1][0], m[a - 1][1]);
				break;
			case 20:
				this.$ = new k.MustacheNode(m[a - 1][0], m[a - 1][1], !0);
				break;
			case 21:
				this.$ = new k.PartialNode(m[a - 1]);
				break;
			case 22:
				this.$ = new k.PartialNode(m[a - 2], m[a - 1]);
				break;
			case 24:
				this.$ = [[m[a - 2]].concat(m[a - 1]), m[a]];
				break;
			case 25:
				this.$ = [[m[a - 1]].concat(m[a]), null];
				break;
			case 26:
				this.$ = [[m[a - 1]], m[a]];
				break;
			case 27:
				this.$ = [[m[a]], null];
				break;
			case 28:
				this.$ = [[new k.DataNode(m[a])], null];
				break;
			case 29:
				m[a - 1].push(m[a]);
				this.$ = m[a - 1];
				break;
			case 30:
				this.$ = [m[a]];
				break;
			case 31:
				this.$ = m[a];
				break;
			case 32:
				this.$ = new k.StringNode(m[a]);
				break;
			case 33:
				this.$ = new k.IntegerNode(m[a]);
				break;
			case 34:
				this.$ = new k.BooleanNode(m[a]);
				break;
			case 35:
				this.$ = new k.DataNode(m[a]);
				break;
			case 36:
				this.$ = new k.HashNode(m[a]);
				break;
			case 37:
				m[a - 1].push(m[a]);
				this.$ = m[a - 1];
				break;
			case 38:
				this.$ = [m[a]];
				break;
			case 39:
				this.$ = [m[a - 2], m[a]];
				break;
			case 40:
				this.$ = [m[a - 2], new k.StringNode(m[a])];
				break;
			case 41:
				this.$ = [m[a - 2], new k.IntegerNode(m[a])];
				break;
			case 42:
				this.$ = [m[a - 2], new k.BooleanNode(m[a])];
				break;
			case 43:
				this.$ = [m[a - 2], new k.DataNode(m[a])];
				break;
			case 44:
				this.$ = new k.PartialNameNode(m[a]);
				break;
			case 45:
				this.$ = new k.IdNode(m[a]);
				break;
			case 46:
				m[a - 2].push(m[a]);
				this.$ = m[a - 2];
				break;
			case 47:
				this.$ = [m[a]]
			}
		},
		table: [{
			3 : 1,
			4 : 2,
			5 : [2, 7],
			6 : 3,
			7 : 4,
			8 : 6,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 5],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			1 : [3]
		},
		{
			5 : [1, 17]
		},
		{
			5 : [2, 6],
			7 : 18,
			8 : 6,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 19],
			20 : [2, 6],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			5 : [2, 5],
			6 : 20,
			8 : 21,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 5],
			20 : [2, 5],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			17 : 23,
			18 : [1, 22],
			21 : 24,
			28 : [1, 25],
			35 : [1, 27],
			38 : 26
		},
		{
			5 : [2, 8],
			14 : [2, 8],
			15 : [2, 8],
			16 : [2, 8],
			19 : [2, 8],
			20 : [2, 8],
			22 : [2, 8],
			23 : [2, 8],
			24 : [2, 8]
		},
		{
			4 : 28,
			6 : 3,
			7 : 4,
			8 : 6,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 5],
			20 : [2, 7],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			4 : 29,
			6 : 3,
			7 : 4,
			8 : 6,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 5],
			20 : [2, 7],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			5 : [2, 12],
			14 : [2, 12],
			15 : [2, 12],
			16 : [2, 12],
			19 : [2, 12],
			20 : [2, 12],
			22 : [2, 12],
			23 : [2, 12],
			24 : [2, 12]
		},
		{
			5 : [2, 13],
			14 : [2, 13],
			15 : [2, 13],
			16 : [2, 13],
			19 : [2, 13],
			20 : [2, 13],
			22 : [2, 13],
			23 : [2, 13],
			24 : [2, 13]
		},
		{
			5 : [2, 14],
			14 : [2, 14],
			15 : [2, 14],
			16 : [2, 14],
			19 : [2, 14],
			20 : [2, 14],
			22 : [2, 14],
			23 : [2, 14],
			24 : [2, 14]
		},
		{
			5 : [2, 15],
			14 : [2, 15],
			15 : [2, 15],
			16 : [2, 15],
			19 : [2, 15],
			20 : [2, 15],
			22 : [2, 15],
			23 : [2, 15],
			24 : [2, 15]
		},
		{
			17 : 30,
			21 : 24,
			28 : [1, 25],
			35 : [1, 27],
			38 : 26
		},
		{
			17 : 31,
			21 : 24,
			28 : [1, 25],
			35 : [1, 27],
			38 : 26
		},
		{
			17 : 32,
			21 : 24,
			28 : [1, 25],
			35 : [1, 27],
			38 : 26
		},
		{
			25 : 33,
			37 : [1, 34]
		},
		{
			1 : [2, 1]
		},
		{
			5 : [2, 2],
			8 : 21,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 19],
			20 : [2, 2],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			17 : 23,
			21 : 24,
			28 : [1, 25],
			35 : [1, 27],
			38 : 26
		},
		{
			5 : [2, 4],
			7 : 35,
			8 : 6,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 19],
			20 : [2, 4],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			5 : [2, 9],
			14 : [2, 9],
			15 : [2, 9],
			16 : [2, 9],
			19 : [2, 9],
			20 : [2, 9],
			22 : [2, 9],
			23 : [2, 9],
			24 : [2, 9]
		},
		{
			5 : [2, 23],
			14 : [2, 23],
			15 : [2, 23],
			16 : [2, 23],
			19 : [2, 23],
			20 : [2, 23],
			22 : [2, 23],
			23 : [2, 23],
			24 : [2, 23]
		},
		{
			18 : [1, 36]
		},
		{
			18 : [2, 27],
			21 : 41,
			26 : 37,
			27 : 38,
			28 : [1, 45],
			29 : 39,
			30 : [1, 42],
			31 : [1, 43],
			32 : [1, 44],
			33 : 40,
			34 : 46,
			35 : [1, 47],
			38 : 26
		},
		{
			18 : [2, 28]
		},
		{
			18 : [2, 45],
			28 : [2, 45],
			30 : [2, 45],
			31 : [2, 45],
			32 : [2, 45],
			35 : [2, 45],
			39 : [1, 48]
		},
		{
			18 : [2, 47],
			28 : [2, 47],
			30 : [2, 47],
			31 : [2, 47],
			32 : [2, 47],
			35 : [2, 47],
			39 : [2, 47]
		},
		{
			10 : 49,
			20 : [1, 50]
		},
		{
			10 : 51,
			20 : [1, 50]
		},
		{
			18 : [1, 52]
		},
		{
			18 : [1, 53]
		},
		{
			18 : [1, 54]
		},
		{
			18 : [1, 55],
			21 : 56,
			35 : [1, 27],
			38 : 26
		},
		{
			18 : [2, 44],
			35 : [2, 44]
		},
		{
			5 : [2, 3],
			8 : 21,
			9 : 7,
			11 : 8,
			12 : 9,
			13 : 10,
			14 : [1, 11],
			15 : [1, 12],
			16 : [1, 13],
			19 : [1, 19],
			20 : [2, 3],
			22 : [1, 14],
			23 : [1, 15],
			24 : [1, 16]
		},
		{
			14 : [2, 17],
			15 : [2, 17],
			16 : [2, 17],
			19 : [2, 17],
			20 : [2, 17],
			22 : [2, 17],
			23 : [2, 17],
			24 : [2, 17]
		},
		{
			18 : [2, 25],
			21 : 41,
			27 : 57,
			28 : [1, 45],
			29 : 58,
			30 : [1, 42],
			31 : [1, 43],
			32 : [1, 44],
			33 : 40,
			34 : 46,
			35 : [1, 47],
			38 : 26
		},
		{
			18 : [2, 26]
		},
		{
			18 : [2, 30],
			28 : [2, 30],
			30 : [2, 30],
			31 : [2, 30],
			32 : [2, 30],
			35 : [2, 30]
		},
		{
			18 : [2, 36],
			34 : 59,
			35 : [1, 60]
		},
		{
			18 : [2, 31],
			28 : [2, 31],
			30 : [2, 31],
			31 : [2, 31],
			32 : [2, 31],
			35 : [2, 31]
		},
		{
			18 : [2, 32],
			28 : [2, 32],
			30 : [2, 32],
			31 : [2, 32],
			32 : [2, 32],
			35 : [2, 32]
		},
		{
			18 : [2, 33],
			28 : [2, 33],
			30 : [2, 33],
			31 : [2, 33],
			32 : [2, 33],
			35 : [2, 33]
		},
		{
			18 : [2, 34],
			28 : [2, 34],
			30 : [2, 34],
			31 : [2, 34],
			32 : [2, 34],
			35 : [2, 34]
		},
		{
			18 : [2, 35],
			28 : [2, 35],
			30 : [2, 35],
			31 : [2, 35],
			32 : [2, 35],
			35 : [2, 35]
		},
		{
			18 : [2, 38],
			35 : [2, 38]
		},
		{
			18 : [2, 47],
			28 : [2, 47],
			30 : [2, 47],
			31 : [2, 47],
			32 : [2, 47],
			35 : [2, 47],
			36 : [1, 61],
			39 : [2, 47]
		},
		{
			35 : [1, 62]
		},
		{
			5 : [2, 10],
			14 : [2, 10],
			15 : [2, 10],
			16 : [2, 10],
			19 : [2, 10],
			20 : [2, 10],
			22 : [2, 10],
			23 : [2, 10],
			24 : [2, 10]
		},
		{
			21 : 63,
			35 : [1, 27],
			38 : 26
		},
		{
			5 : [2, 11],
			14 : [2, 11],
			15 : [2, 11],
			16 : [2, 11],
			19 : [2, 11],
			20 : [2, 11],
			22 : [2, 11],
			23 : [2, 11],
			24 : [2, 11]
		},
		{
			14 : [2, 16],
			15 : [2, 16],
			16 : [2, 16],
			19 : [2, 16],
			20 : [2, 16],
			22 : [2, 16],
			23 : [2, 16],
			24 : [2, 16]
		},
		{
			5 : [2, 19],
			14 : [2, 19],
			15 : [2, 19],
			16 : [2, 19],
			19 : [2, 19],
			20 : [2, 19],
			22 : [2, 19],
			23 : [2, 19],
			24 : [2, 19]
		},
		{
			5 : [2, 20],
			14 : [2, 20],
			15 : [2, 20],
			16 : [2, 20],
			19 : [2, 20],
			20 : [2, 20],
			22 : [2, 20],
			23 : [2, 20],
			24 : [2, 20]
		},
		{
			5 : [2, 21],
			14 : [2, 21],
			15 : [2, 21],
			16 : [2, 21],
			19 : [2, 21],
			20 : [2, 21],
			22 : [2, 21],
			23 : [2, 21],
			24 : [2, 21]
		},
		{
			18 : [1, 64]
		},
		{
			18 : [2, 24]
		},
		{
			18 : [2, 29],
			28 : [2, 29],
			30 : [2, 29],
			31 : [2, 29],
			32 : [2, 29],
			35 : [2, 29]
		},
		{
			18 : [2, 37],
			35 : [2, 37]
		},
		{
			36 : [1, 61]
		},
		{
			21 : 65,
			28 : [1, 69],
			30 : [1, 66],
			31 : [1, 67],
			32 : [1, 68],
			35 : [1, 27],
			38 : 26
		},
		{
			18 : [2, 46],
			28 : [2, 46],
			30 : [2, 46],
			31 : [2, 46],
			32 : [2, 46],
			35 : [2, 46],
			39 : [2, 46]
		},
		{
			18 : [1, 70]
		},
		{
			5 : [2, 22],
			14 : [2, 22],
			15 : [2, 22],
			16 : [2, 22],
			19 : [2, 22],
			20 : [2, 22],
			22 : [2, 22],
			23 : [2, 22],
			24 : [2, 22]
		},
		{
			18 : [2, 39],
			35 : [2, 39]
		},
		{
			18 : [2, 40],
			35 : [2, 40]
		},
		{
			18 : [2, 41],
			35 : [2, 41]
		},
		{
			18 : [2, 42],
			35 : [2, 42]
		},
		{
			18 : [2, 43],
			35 : [2, 43]
		},
		{
			5 : [2, 18],
			14 : [2, 18],
			15 : [2, 18],
			16 : [2, 18],
			19 : [2, 18],
			20 : [2, 18],
			22 : [2, 18],
			23 : [2, 18],
			24 : [2, 18]
		}],
		defaultActions: {
			17 : [2, 1],
			25 : [2, 28],
			38 : [2, 26],
			57 : [2, 24]
		},
		parseError: function(a) {
			throw Error(a);
		},
		parse: function(a) {
			var e = [0],
			j = [null],
			k = [],
			l = this.table,
			m = "",
			n = 0,
			o = 0,
			r = 0;
			this.lexer.setInput(a);
			this.lexer.yy = this.yy;
			this.yy.lexer = this.lexer;
			this.yy.parser = this;
			"undefined" == typeof this.lexer.yylloc && (this.lexer.yylloc = {});
			a = this.lexer.yylloc;
			k.push(a);
			var u = this.lexer.options && this.lexer.options.ranges;
			"function" === typeof this.yy.parseError && (this.parseError = this.yy.parseError);
			for (var s, B, z, v, D = {},
			E, F;;) {
				z = e[e.length - 1];
				if (this.defaultActions[z]) v = this.defaultActions[z];
				else {
					if (null === s || "undefined" == typeof s) s = void 0,
					s = this.lexer.lex() || 1,
					"number" !== typeof s && (s = this.symbols_[s] || s);
					v = l[z] && l[z][s]
				}
				if ("undefined" === typeof v || !v.length || !v[0]) {
					var I = "";
					if (!r) {
						F = [];
						for (E in l[z]) this.terminals_[E] && 2 < E && F.push("'" + this.terminals_[E] + "'");
						I = this.lexer.showPosition ? "Parse error on line " + (n + 1) + ":\n" + this.lexer.showPosition() + "\nExpecting " + F.join(", ") + ", got '" + (this.terminals_[s] || s) + "'": "Parse error on line " + (n + 1) + ": Unexpected " + (1 == s ? "end of input": "'" + (this.terminals_[s] || s) + "'");
						this.parseError(I, {
							text: this.lexer.match,
							token: this.terminals_[s] || s,
							line: this.lexer.yylineno,
							loc: a,
							expected: F
						})
					}
				}
				if (v[0] instanceof Array && 1 < v.length) throw Error("Parse Error: multiple actions possible at state: " + z + ", token: " + s);
				switch (v[0]) {
				case 1:
					e.push(s);
					j.push(this.lexer.yytext);
					k.push(this.lexer.yylloc);
					e.push(v[1]);
					s = null;
					B ? (s = B, B = null) : (o = this.lexer.yyleng, m = this.lexer.yytext, n = this.lexer.yylineno, a = this.lexer.yylloc, 0 < r && r--);
					break;
				case 2:
					F = this.productions_[v[1]][1];
					D.$ = j[j.length - F];
					D._$ = {
						first_line: k[k.length - (F || 1)].first_line,
						last_line: k[k.length - 1].last_line,
						first_column: k[k.length - (F || 1)].first_column,
						last_column: k[k.length - 1].last_column
					};
					u && (D._$.range = [k[k.length - (F || 1)].range[0], k[k.length - 1].range[1]]);
					z = this.performAction.call(D, m, o, n, this.yy, v[1], j, k);
					if ("undefined" !== typeof z) return z;
					F && (e = e.slice(0, -2 * F), j = j.slice(0, -1 * F), k = k.slice(0, -1 * F));
					e.push(this.productions_[v[1]][0]);
					j.push(D.$);
					k.push(D._$);
					v = l[e[e.length - 2]][e[e.length - 1]];
					e.push(v);
					break;
				case 3:
					return ! 0
				}
			}
			return ! 0
		},
		lexer: {
			EOF: 1,
			parseError: function(a, e) {
				if (this.yy.parser) this.yy.parser.parseError(a, e);
				else throw Error(a);
			},
			setInput: function(a) {
				this._input = a;
				this._more = this._less = this.done = !1;
				this.yylineno = this.yyleng = 0;
				this.yytext = this.matched = this.match = "";
				this.conditionStack = ["INITIAL"];
				this.yylloc = {
					first_line: 1,
					first_column: 0,
					last_line: 1,
					last_column: 0
				};
				this.options.ranges && (this.yylloc.range = [0, 0]);
				this.offset = 0;
				return this
			},
			input: function() {
				var a = this._input[0];
				this.yytext += a;
				this.yyleng++;
				this.offset++;
				this.match += a;
				this.matched += a;
				a.match(/(?:\r\n?|\n).*/g) ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++;
				this.options.ranges && this.yylloc.range[1]++;
				this._input = this._input.slice(1);
				return a
			},
			unput: function(a) {
				var e = a.length,
				j = a.split(/(?:\r\n?|\n)/g);
				this._input = a + this._input;
				this.yytext = this.yytext.substr(0, this.yytext.length - e - 1);
				this.offset -= e;
				a = this.match.split(/(?:\r\n?|\n)/g);
				this.match = this.match.substr(0, this.match.length - 1);
				this.matched = this.matched.substr(0, this.matched.length - 1);
				j.length - 1 && (this.yylineno -= j.length - 1);
				var k = this.yylloc.range;
				this.yylloc = {
					first_line: this.yylloc.first_line,
					last_line: this.yylineno + 1,
					first_column: this.yylloc.first_column,
					last_column: j ? (j.length === a.length ? this.yylloc.first_column: 0) + a[a.length - j.length].length - j[0].length: this.yylloc.first_column - e
				};
				this.options.ranges && (this.yylloc.range = [k[0], k[0] + this.yyleng - e]);
				return this
			},
			more: function() {
				this._more = !0;
				return this
			},
			less: function(a) {
				this.unput(this.match.slice(a))
			},
			pastInput: function() {
				var a = this.matched.substr(0, this.matched.length - this.match.length);
				return (20 < a.length ? "...": "") + a.substr( - 20).replace(/\n/g, "")
			},
			upcomingInput: function() {
				var a = this.match;
				20 > a.length && (a += this._input.substr(0, 20 - a.length));
				return (a.substr(0, 20) + (20 < a.length ? "...": "")).replace(/\n/g, "")
			},
			showPosition: function() {
				var a = this.pastInput(),
				e = Array(a.length + 1).join("-");
				return a + this.upcomingInput() + "\n" + e + "^"
			},
			next: function() {
				if (this.done) return this.EOF;
				this._input || (this.done = !0);
				var a, e, j;
				this._more || (this.match = this.yytext = "");
				for (var k = this._currentRules(), l = 0; l < k.length; l++) if ((e = this._input.match(this.rules[k[l]])) && (!a || e[0].length > a[0].length)) if (a = e, j = l, !this.options.flex) break;
				if (a) {
					if (e = a[0].match(/(?:\r\n?|\n).*/g)) this.yylineno += e.length;
					this.yylloc = {
						first_line: this.yylloc.last_line,
						last_line: this.yylineno + 1,
						first_column: this.yylloc.last_column,
						last_column: e ? e[e.length - 1].length - e[e.length - 1].match(/\r?\n?/)[0].length: this.yylloc.last_column + a[0].length
					};
					this.yytext += a[0];
					this.match += a[0];
					this.matches = a;
					this.yyleng = this.yytext.length;
					this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]);
					this._more = !1;
					this._input = this._input.slice(a[0].length);
					this.matched += a[0];
					a = this.performAction.call(this, this.yy, this, k[j], this.conditionStack[this.conditionStack.length - 1]);
					this.done && this._input && (this.done = !1);
					if (a) return a
				} else return "" === this._input ? this.EOF: this.parseError("Lexical error on line " + (this.yylineno + 1) + ". Unrecognized text.\n" + this.showPosition(), {
					text: "",
					token: null,
					line: this.yylineno
				})
			},
			lex: function() {
				var a = this.next();
				return "undefined" !== typeof a ? a: this.lex()
			},
			begin: function(a) {
				this.conditionStack.push(a)
			},
			popState: function() {
				return this.conditionStack.pop()
			},
			_currentRules: function() {
				return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules
			},
			topState: function() {
				return this.conditionStack[this.conditionStack.length - 2]
			},
			pushState: function(a) {
				this.begin(a)
			},
			options: {},
			performAction: function(a, e, j) {
				switch (j) {
				case 0:
					"\\" !== e.yytext.slice( - 1) && this.begin("mu");
					"\\" === e.yytext.slice( - 1) && (e.yytext = e.yytext.substr(0, e.yyleng - 1), this.begin("emu"));
					if (e.yytext) return 14;
					break;
				case 1:
					return 14;
				case 2:
					return "\\" !== e.yytext.slice( - 1) && this.popState(),
					"\\" === e.yytext.slice( - 1) && (e.yytext = e.yytext.substr(0, e.yyleng - 1)),
					14;
				case 3:
					return e.yytext = e.yytext.substr(0, e.yyleng - 4),
					this.popState(),
					15;
				case 4:
					return this.begin("par"),
					24;
				case 5:
					return 16;
				case 6:
					return 20;
				case 7:
					return 19;
				case 8:
					return 19;
				case 9:
					return 23;
				case 10:
					return 23;
				case 11:
					this.popState();
					this.begin("com");
					break;
				case 12:
					return e.yytext = e.yytext.substr(3, e.yyleng - 5),
					this.popState(),
					15;
				case 13:
					return 22;
				case 14:
					return 36;
				case 15:
					return 35;
				case 16:
					return 35;
				case 17:
					return 39;
				case 19:
					return this.popState(),
					18;
				case 20:
					return this.popState(),
					18;
				case 21:
					return e.yytext = e.yytext.substr(1, e.yyleng - 2).replace(/\\"/g, '"'),
					30;
				case 22:
					return e.yytext = e.yytext.substr(1, e.yyleng - 2).replace(/\\'/g, "'"),
					30;
				case 23:
					return e.yytext = e.yytext.substr(1),
					28;
				case 24:
					return 32;
				case 25:
					return 32;
				case 26:
					return 31;
				case 27:
					return 35;
				case 28:
					return e.yytext = e.yytext.substr(1, e.yyleng - 2),
					35;
				case 29:
					return "INVALID";
				case 31:
					return this.popState(),
					37;
				case 32:
					return 5
				}
			},
			rules: [/^(?:[^\x00]*?(?=(\{\{)))/, /^(?:[^\x00]+)/, /^(?:[^\x00]{2,}?(?=(\{\{|$)))/, /^(?:[\s\S]*?--\}\})/, /^(?:\{\{>)/, /^(?:\{\{#)/, /^(?:\{\{\/)/, /^(?:\{\{\^)/, /^(?:\{\{\s*else\b)/, /^(?:\{\{\{)/, /^(?:\{\{&)/, /^(?:\{\{!--)/, /^(?:\{\{![\s\S]*?\}\})/, /^(?:\{\{)/, /^(?:=)/, /^(?:\.(?=[} ]))/, /^(?:\.\.)/, /^(?:[\/.])/, /^(?:\s+)/, /^(?:\}\}\})/, /^(?:\}\})/, /^(?:"(\\["]|[^"])*")/, /^(?:'(\\[']|[^'])*')/, /^(?:@[a-zA-Z]+)/, /^(?:true(?=[}\s]))/, /^(?:false(?=[}\s]))/, /^(?:[0-9]+(?=[}\s]))/, /^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/, /^(?:\[[^\]]*\])/, /^(?:.)/, /^(?:\s+)/, /^(?:[a-zA-Z0-9_$-/] + ) / ,
			/^(?:$)/],
			conditions: {
				mu: {
					rules: [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 32],
					inclusive: !1
				},
				emu: {
					rules: [2],
					inclusive: !1
				},
				com: {
					rules: [3],
					inclusive: !1
				},
				par: {
					rules: [30, 31],
					inclusive: !1
				},
				INITIAL: {
					rules: [0, 1, 32],
					inclusive: !0
				}
			}
		}
	};
	a.prototype = e;
	e.Parser = a;
	return new a
} ();Handlebars.Parser = handlebars;Handlebars.parse = function(a) {
	if (a.constructor === Handlebars.AST.ProgramNode) return a;
	Handlebars.Parser.yy = Handlebars.AST;
	return Handlebars.Parser.parse(a)
};Handlebars.print = function(a) {
	return (new Handlebars.PrintVisitor).accept(a)
}; (function() {
	Handlebars.AST = {};
	Handlebars.AST.ProgramNode = function(a, e) {
		this.type = "program";
		this.statements = a;
		e && (this.inverse = new Handlebars.AST.ProgramNode(e))
	};
	Handlebars.AST.MustacheNode = function(a, e, d) {
		this.type = "mustache";
		this.escaped = !d;
		this.hash = e;
		d = this.id = a[0];
		a = this.params = a.slice(1);
		this.isHelper = (this.eligibleHelper = d.isSimple) && (a.length || e)
	};
	Handlebars.AST.PartialNode = function(a, e) {
		this.type = "partial";
		this.partialName = a;
		this.context = e
	};
	Handlebars.AST.BlockNode = function(a, e, d, g) {
		var j = a.id;
		if (j.original !== g.original) throw new Handlebars.Exception(j.original + " doesn't match " + g.original);
		this.type = "block";
		this.mustache = a;
		this.program = e;
		if ((this.inverse = d) && !this.program) this.isInverse = !0
	};
	Handlebars.AST.ContentNode = function(a) {
		this.type = "content";
		this.string = a
	};
	Handlebars.AST.HashNode = function(a) {
		this.type = "hash";
		this.pairs = a
	};
	Handlebars.AST.IdNode = function(a) {
		this.type = "ID";
		this.original = a.join(".");
		for (var e = [], d = 0, g = 0, j = a.length; g < j; g++) {
			var k = a[g];
			if (".." === k || "." === k || "this" === k) {
				if (0 < e.length) throw new Handlebars.Exception("Invalid path: " + this.original);
				".." === k ? d++:this.isScoped = !0
			} else e.push(k)
		}
		this.parts = e;
		this.string = e.join(".");
		this.depth = d;
		this.isSimple = 1 === a.length && !this.isScoped && 0 === d;
		this.stringModeValue = this.string
	};
	Handlebars.AST.PartialNameNode = function(a) {
		this.type = "PARTIAL_NAME";
		this.name = a
	};
	Handlebars.AST.DataNode = function(a) {
		this.type = "DATA";
		this.id = a
	};
	Handlebars.AST.StringNode = function(a) {
		this.type = "STRING";
		this.stringModeValue = this.string = a
	};
	Handlebars.AST.IntegerNode = function(a) {
		this.type = "INTEGER";
		this.integer = a;
		this.stringModeValue = Number(a)
	};
	Handlebars.AST.BooleanNode = function(a) {
		this.type = "BOOLEAN";
		this.bool = a;
		this.stringModeValue = "true" === a
	};
	Handlebars.AST.CommentNode = function(a) {
		this.type = "comment";
		this.comment = a
	}
})();
var errorProps = "description fileName lineNumber message name number stack".split(" ");Handlebars.Exception = function(a) {
	for (var e = Error.prototype.constructor.apply(this, arguments), d = 0; d < errorProps.length; d++) this[errorProps[d]] = e[errorProps[d]]
};Handlebars.Exception.prototype = Error();Handlebars.SafeString = function(a) {
	this.string = a
};Handlebars.SafeString.prototype.toString = function() {
	return this.string.toString()
}; (function() {
	var a = {
		"\x26": "\x26amp;",
		"\x3c": "\x26lt;",
		"\x3e": "\x26gt;",
		'"': "\x26quot;",
		"'": "\x26#x27;",
		"`": "\x26#x60;"
	},
	e = /[&<>"'`]/g,
	d = /[&<>"'`]/,
	g = function(d) {
		return a[d] || "\x26amp;"
	};
	Handlebars.Utils = {
		escapeExpression: function(a) {
			return a instanceof Handlebars.SafeString ? a.toString() : null == a || !1 === a ? "": !d.test(a) ? a: a.replace(e, g)
		},
		isEmpty: function(a) {
			return ! a && 0 !== a ? !0 : "[object Array]" === Object.prototype.toString.call(a) && 0 === a.length ? !0 : !1
		}
	}
})();Handlebars.Compiler = function() {};Handlebars.JavaScriptCompiler = function() {}; (function(a, e) {
	a.prototype = {
		compiler: a,
		disassemble: function() {
			for (var a = this.opcodes,
			d, e = [], g, j, k = 0, l = a.length; k < l; k++) if (d = a[k], "DECLARE" === d.opcode) e.push("DECLARE " + d.name + "\x3d" + d.value);
			else {
				g = [];
				for (var z = 0; z < d.args.length; z++) j = d.args[z],
				"string" === typeof j && (j = '"' + j.replace("\n", "\\n") + '"'),
				g.push(j);
				e.push(d.opcode + " " + g.join(" "))
			}
			return e.join("\n")
		},
		equals: function(a) {
			var d = this.opcodes.length;
			if (a.opcodes.length !== d) return ! 1;
			for (var e = 0; e < d; e++) {
				var g = this.opcodes[e],
				j = a.opcodes[e];
				if (g.opcode !== j.opcode || g.args.length !== j.args.length) return ! 1;
				for (var k = 0; k < g.args.length; k++) if (g.args[k] !== j.args[k]) return ! 1
			}
			return ! 0
		},
		guid: 0,
		compile: function(a, d) {
			this.children = [];
			this.depths = {
				list: []
			};
			this.options = d;
			var e = this.options.knownHelpers;
			this.options.knownHelpers = {
				helperMissing: !0,
				blockHelperMissing: !0,
				each: !0,
				"if": !0,
				unless: !0,
				"with": !0,
				log: !0
			};
			if (e) for (var g in e) this.options.knownHelpers[g] = e[g];
			return this.program(a)
		},
		accept: function(a) {
			return this[a.type](a)
		},
		program: function(a) {
			a = a.statements;
			var d;
			this.opcodes = [];
			for (var e = 0,
			g = a.length; e < g; e++) d = a[e],
			this[d.type](d);
			this.isSimple = 1 === g;
			this.depths.list = this.depths.list.sort(function(a, d) {
				return a - d
			});
			return this
		},
		compileProgram: function(a) {
			a = (new this.compiler).compile(a, this.options);
			var d = this.guid++,
			e;
			this.usePartial = this.usePartial || a.usePartial;
			this.children[d] = a;
			for (var g = 0,
			j = a.depths.list.length; g < j; g++) e = a.depths.list[g],
			2 > e || this.addDepth(e - 1);
			return d
		},
		block: function(a) {
			var d = a.mustache,
			e = a.program;
			a = a.inverse;
			e && (e = this.compileProgram(e));
			a && (a = this.compileProgram(a));
			var g = this.classifyMustache(d);
			"helper" === g ? this.helperMustache(d, e, a) : "simple" === g ? (this.simpleMustache(d), this.opcode("pushProgram", e), this.opcode("pushProgram", a), this.opcode("emptyHash"), this.opcode("blockValue")) : (this.ambiguousMustache(d, e, a), this.opcode("pushProgram", e), this.opcode("pushProgram", a), this.opcode("emptyHash"), this.opcode("ambiguousBlockValue"));
			this.opcode("append")
		},
		hash: function(a) {
			a = a.pairs;
			var d, e;
			this.opcode("pushHash");
			for (var g = 0,
			j = a.length; g < j; g++) d = a[g],
			e = d[1],
			this.options.stringParams ? this.opcode("pushStringParam", e.stringModeValue, e.type) : this.accept(e),
			this.opcode("assignToHash", d[0]);
			this.opcode("popHash")
		},
		partial: function(a) {
			var d = a.partialName;
			this.usePartial = !0;
			a.context ? this.ID(a.context) : this.opcode("push", "depth0");
			this.opcode("invokePartial", d.name);
			this.opcode("append")
		},
		content: function(a) {
			this.opcode("appendContent", a.string)
		},
		mustache: function(a) {
			var d = this.options,
			e = this.classifyMustache(a);
			"simple" === e ? this.simpleMustache(a) : "helper" === e ? this.helperMustache(a) : this.ambiguousMustache(a);
			a.escaped && !d.noEscape ? this.opcode("appendEscaped") : this.opcode("append")
		},
		ambiguousMustache: function(a, d, e) {
			a = a.id;
			var g = a.parts[0],
			j = null != d || null != e;
			this.opcode("getContext", a.depth);
			this.opcode("pushProgram", d);
			this.opcode("pushProgram", e);
			this.opcode("invokeAmbiguous", g, j)
		},
		simpleMustache: function(a) {
			a = a.id;
			"DATA" === a.type ? this.DATA(a) : a.parts.length ? this.ID(a) : (this.addDepth(a.depth), this.opcode("getContext", a.depth), this.opcode("pushContext"));
			this.opcode("resolvePossibleLambda")
		},
		helperMustache: function(a, d, e) {
			d = this.setupFullMustacheParams(a, d, e);
			a = a.id.parts[0];
			if (this.options.knownHelpers[a]) this.opcode("invokeKnownHelper", d.length, a);
			else {
				if (this.knownHelpersOnly) throw Error("You specified knownHelpersOnly, but used the unknown helper " + a);
				this.opcode("invokeHelper", d.length, a)
			}
		},
		ID: function(a) {
			this.addDepth(a.depth);
			this.opcode("getContext", a.depth);
			a.parts[0] ? this.opcode("lookupOnContext", a.parts[0]) : this.opcode("pushContext");
			for (var d = 1,
			e = a.parts.length; d < e; d++) this.opcode("lookup", a.parts[d])
		},
		DATA: function(a) {
			this.options.data = !0;
			this.opcode("lookupData", a.id)
		},
		STRING: function(a) {
			this.opcode("pushString", a.string)
		},
		INTEGER: function(a) {
			this.opcode("pushLiteral", a.integer)
		},
		BOOLEAN: function(a) {
			this.opcode("pushLiteral", a.bool)
		},
		comment: function() {},
		opcode: function(a) {
			this.opcodes.push({
				opcode: a,
				args: [].slice.call(arguments, 1)
			})
		},
		declare: function(a, d) {
			this.opcodes.push({
				opcode: "DECLARE",
				name: a,
				value: d
			})
		},
		addDepth: function(a) {
			if (isNaN(a)) throw Error("EWOT");
			0 !== a && !this.depths[a] && (this.depths[a] = !0, this.depths.list.push(a))
		},
		classifyMustache: function(a) {
			var d = a.isHelper,
			e = a.eligibleHelper,
			g = this.options;
			e && !d && (g.knownHelpers[a.id.parts[0]] ? d = !0 : g.knownHelpersOnly && (e = !1));
			return d ? "helper": e ? "ambiguous": "simple"
		},
		pushParams: function(a) {
			for (var d = a.length,
			e; d--;) if (e = a[d], this.options.stringParams) e.depth && this.addDepth(e.depth),
			this.opcode("getContext", e.depth || 0),
			this.opcode("pushStringParam", e.stringModeValue, e.type);
			else this[e.type](e)
		},
		setupMustacheParams: function(a) {
			var d = a.params;
			this.pushParams(d);
			a.hash ? this.hash(a.hash) : this.opcode("emptyHash");
			return d
		},
		setupFullMustacheParams: function(a, d, e) {
			var g = a.params;
			this.pushParams(g);
			this.opcode("pushProgram", d);
			this.opcode("pushProgram", e);
			a.hash ? this.hash(a.hash) : this.opcode("emptyHash");
			return g
		}
	};
	var d = function(a) {
		this.value = a
	};
	e.prototype = {
		nameLookup: function(a, d) {
			return /^[0-9]+$/.test(d) ? a + "[" + d + "]": e.isValidJavaScriptVariableName(d) ? a + "." + d: a + "['" + d + "']"
		},
		appendToBuffer: function(a) {
			return this.environment.isSimple ? "return " + a + ";": {
				appendToBuffer: !0,
				content: a,
				toString: function() {
					return "buffer +\x3d " + a + ";"
				}
			}
		},
		initializeBuffer: function() {
			return this.quotedString("")
		},
		namespace: "Handlebars",
		compile: function(a, d, e, g) {
			this.environment = a;
			this.options = d || {};
			Handlebars.log(Handlebars.logger.DEBUG, this.environment.disassemble() + "\n\n");
			this.name = this.environment.name;
			this.isChild = !!e;
			this.context = e || {
				programs: [],
				environments: [],
				aliases: {}
			};
			this.preamble();
			this.stackSlot = 0;
			this.stackVars = [];
			this.registers = {
				list: []
			};
			this.compileStack = [];
			this.inlineStack = [];
			this.compileChildren(a, d);
			a = a.opcodes;
			this.i = 0;
			for (l = a.length; this.i < l; this.i++) d = a[this.i],
			"DECLARE" === d.opcode ? this[d.name] = d.value: this[d.opcode].apply(this, d.args);
			return this.createFunctionContext(g)
		},
		nextOpcode: function() {
			return this.environment.opcodes[this.i + 1]
		},
		eat: function() {
			this.i += 1
		},
		preamble: function() {
			var a = [];
			if (this.isChild) a.push("");
			else {
				var d = this.namespace,
				e = "helpers \x3d helpers || " + d + ".helpers;";
				this.environment.usePartial && (e = e + " partials \x3d partials || " + d + ".partials;");
				this.options.data && (e += " data \x3d data || {};");
				a.push(e)
			}
			this.environment.isSimple ? a.push("") : a.push(", buffer \x3d " + this.initializeBuffer());
			this.lastContext = 0;
			this.source = a
		},
		createFunctionContext: function(a) {
			var d = this.stackVars.concat(this.registers.list);
			0 < d.length && (this.source[1] = this.source[1] + ", " + d.join(", "));
			if (!this.isChild) for (var e in this.context.aliases) this.source[1] = this.source[1] + ", " + e + "\x3d" + this.context.aliases[e];
			this.source[1] && (this.source[1] = "var " + this.source[1].substring(2) + ";");
			this.isChild || (this.source[1] += "\n" + this.context.programs.join("\n") + "\n");
			this.environment.isSimple || this.source.push("return buffer;");
			d = this.isChild ? ["depth0", "data"] : ["Handlebars", "depth0", "helpers", "partials", "data"];
			e = 0;
			for (var g = this.environment.depths.list.length; e < g; e++) d.push("depth" + this.environment.depths.list[e]);
			e = this.mergeSource();
			this.isChild || (g = Handlebars.COMPILER_REVISION, e = "this.compilerInfo \x3d [" + g + ",'" + Handlebars.REVISION_CHANGES[g] + "'];\n" + e);
			if (a) return d.push(e),
			Function.apply(this, d);
			a = "function " + (this.name || "") + "(" + d.join(",") + ") {\n  " + e + "}";
			Handlebars.log(Handlebars.logger.DEBUG, a + "\n\n");
			return a
		},
		mergeSource: function() {
			for (var a = "",
			d, e = 0,
			g = this.source.length; e < g; e++) {
				var j = this.source[e];
				j.appendToBuffer ? d = d ? d + "\n    + " + j.content: j.content: (d && (a += "buffer +\x3d " + d + ";\n  ", d = void 0), a += j + "\n  ")
			}
			return a
		},
		blockValue: function() {
			this.context.aliases.blockHelperMissing = "helpers.blockHelperMissing";
			var a = ["depth0"];
			this.setupParams(0, a);
			this.replaceStack(function(d) {
				a.splice(1, 0, d);
				return "blockHelperMissing.call(" + a.join(", ") + ")"
			})
		},
		ambiguousBlockValue: function() {
			this.context.aliases.blockHelperMissing = "helpers.blockHelperMissing";
			var a = ["depth0"];
			this.setupParams(0, a);
			var d = this.topStack();
			a.splice(1, 0, d);
			a[a.length - 1] = "options";
			this.source.push("if (!" + this.lastHelper + ") { " + d + " \x3d blockHelperMissing.call(" + a.join(", ") + "); }")
		},
		appendContent: function(a) {
			this.source.push(this.appendToBuffer(this.quotedString(a)))
		},
		append: function() {
			this.flushInline();
			var a = this.popStack();
			this.source.push("if(" + a + " || " + a + " \x3d\x3d\x3d 0) { " + this.appendToBuffer(a) + " }");
			this.environment.isSimple && this.source.push("else { " + this.appendToBuffer("''") + " }")
		},
		appendEscaped: function() {
			this.context.aliases.escapeExpression = "this.escapeExpression";
			this.source.push(this.appendToBuffer("escapeExpression(" + this.popStack() + ")"))
		},
		getContext: function(a) {
			this.lastContext !== a && (this.lastContext = a)
		},
		lookupOnContext: function(a) {
			this.push(this.nameLookup("depth" + this.lastContext, a, "context"))
		},
		pushContext: function() {
			this.pushStackLiteral("depth" + this.lastContext)
		},
		resolvePossibleLambda: function() {
			this.context.aliases.functionType = '"function"';
			this.replaceStack(function(a) {
				return "typeof " + a + " \x3d\x3d\x3d functionType ? " + a + ".apply(depth0) : " + a
			})
		},
		lookup: function(a) {
			this.replaceStack(function(d) {
				return d + " \x3d\x3d null || " + d + " \x3d\x3d\x3d false ? " + d + " : " + this.nameLookup(d, a, "context")
			})
		},
		lookupData: function(a) {
			this.push(this.nameLookup("data", a, "data"))
		},
		pushStringParam: function(a, d) {
			this.pushStackLiteral("depth" + this.lastContext);
			this.pushString(d);
			"string" === typeof a ? this.pushString(a) : this.pushStackLiteral(a)
		},
		emptyHash: function() {
			this.pushStackLiteral("{}");
			this.options.stringParams && this.register("hashTypes", "{}")
		},
		pushHash: function() {
			this.hash = {
				values: [],
				types: []
			}
		},
		popHash: function() {
			var a = this.hash;
			this.hash = void 0;
			this.options.stringParams && this.register("hashTypes", "{" + a.types.join(",") + "}");
			this.push("{\n    " + a.values.join(",\n    ") + "\n  }")
		},
		pushString: function(a) {
			this.pushStackLiteral(this.quotedString(a))
		},
		push: function(a) {
			this.inlineStack.push(a);
			return a
		},
		pushLiteral: function(a) {
			this.pushStackLiteral(a)
		},
		pushProgram: function(a) {
			null != a ? this.pushStackLiteral(this.programExpression(a)) : this.pushStackLiteral(null)
		},
		invokeHelper: function(a, d) {
			this.context.aliases.helperMissing = "helpers.helperMissing";
			var e = this.lastHelper = this.setupHelper(a, d, !0);
			this.push(e.name);
			this.replaceStack(function(a) {
				return a + " ? " + a + ".call(" + e.callParams + ") : helperMissing.call(" + e.helperMissingParams + ")"
			})
		},
		invokeKnownHelper: function(a, d) {
			var e = this.setupHelper(a, d);
			this.push(e.name + ".call(" + e.callParams + ")")
		},
		invokeAmbiguous: function(a, d) {
			this.context.aliases.functionType = '"function"';
			this.pushStackLiteral("{}");
			var e = this.setupHelper(0, a, d),
			g = this.lastHelper = this.nameLookup("helpers", a, "helper"),
			j = this.nameLookup("depth" + this.lastContext, a, "context"),
			k = this.nextStack();
			this.source.push("if (" + k + " \x3d " + g + ") { " + k + " \x3d " + k + ".call(" + e.callParams + "); }");
			this.source.push("else { " + k + " \x3d " + j + "; " + k + " \x3d typeof " + k + " \x3d\x3d\x3d functionType ? " + k + ".apply(depth0) : " + k + "; }")
		},
		invokePartial: function(a) {
			a = [this.nameLookup("partials", a, "partial"), "'" + a + "'", this.popStack(), "helpers", "partials"];
			this.options.data && a.push("data");
			this.context.aliases.self = "this";
			this.push("self.invokePartial(" + a.join(", ") + ")")
		},
		assignToHash: function(a) {
			var d = this.popStack(),
			e;
			this.options.stringParams && (e = this.popStack(), this.popStack());
			var g = this.hash;
			e && g.types.push("'" + a + "': " + e);
			g.values.push("'" + a + "': (" + d + ")")
		},
		compiler: e,
		compileChildren: function(a, d) {
			for (var e = a.children,
			g, j, k = 0,
			l = e.length; k < l; k++) {
				g = e[k];
				j = new this.compiler;
				var z = this.matchExistingProgram(g);
				null == z ? (this.context.programs.push(""), z = this.context.programs.length, g.index = z, g.name = "program" + z, this.context.programs[z] = j.compile(g, d, this.context), this.context.environments[z] = g) : (g.index = z, g.name = "program" + z)
			}
		},
		matchExistingProgram: function(a) {
			for (var d = 0,
			e = this.context.environments.length; d < e; d++) {
				var g = this.context.environments[d];
				if (g && g.equals(a)) return d
			}
		},
		programExpression: function(a) {
			this.context.aliases.self = "this";
			if (null == a) return "self.noop";
			var d = this.environment.children[a];
			a = d.depths.list;
			for (var e = [d.index, d.name, "data"], g = 0, j = a.length; g < j; g++) d = a[g],
			1 === d ? e.push("depth0") : e.push("depth" + (d - 1));
			if (0 === a.length) return "self.program(" + e.join(", ") + ")";
			e.shift();
			return "self.programWithDepth(" + e.join(", ") + ")"
		},
		register: function(a, d) {
			this.useRegister(a);
			this.source.push(a + " \x3d " + d + ";")
		},
		useRegister: function(a) {
			this.registers[a] || (this.registers[a] = !0, this.registers.list.push(a))
		},
		pushStackLiteral: function(a) {
			return this.push(new d(a))
		},
		pushStack: function(a) {
			this.flushInline();
			var d = this.incrStack();
			a && this.source.push(d + " \x3d " + a + ";");
			this.compileStack.push(d);
			return d
		},
		replaceStack: function(a) {
			var e = "",
			g = this.isInline(),
			j;
			g ? (j = this.popStack(!0), j instanceof d ? j = j.value: (e = this.stackSlot ? this.topStackName() : this.incrStack(), e = "(" + this.push(e) + " \x3d " + j + "),", j = this.topStack())) : j = this.topStack();
			a = a.call(this, j);
			g ? ((this.inlineStack.length || this.compileStack.length) && this.popStack(), this.push("(" + e + a + ")")) : (/^stack/.test(j) || (j = this.nextStack()), this.source.push(j + " \x3d (" + e + a + ");"));
			return j
		},
		nextStack: function() {
			return this.pushStack()
		},
		incrStack: function() {
			this.stackSlot++;
			this.stackSlot > this.stackVars.length && this.stackVars.push("stack" + this.stackSlot);
			return this.topStackName()
		},
		topStackName: function() {
			return "stack" + this.stackSlot
		},
		flushInline: function() {
			var a = this.inlineStack;
			if (a.length) {
				this.inlineStack = [];
				for (var e = 0,
				g = a.length; e < g; e++) {
					var j = a[e];
					j instanceof d ? this.compileStack.push(j) : this.pushStack(j)
				}
			}
		},
		isInline: function() {
			return this.inlineStack.length
		},
		popStack: function(a) {
			var e = this.isInline(),
			g = (e ? this.inlineStack: this.compileStack).pop();
			if (!a && g instanceof d) return g.value;
			e || this.stackSlot--;
			return g
		},
		topStack: function(a) {
			var e = this.isInline() ? this.inlineStack: this.compileStack,
			e = e[e.length - 1];
			return ! a && e instanceof d ? e.value: e
		},
		quotedString: function(a) {
			return '"' + a.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\n/g, "\\n").replace(/\r/g, "\\r") + '"'
		},
		setupHelper: function(a, d, e) {
			var g = [];
			this.setupParams(a, g, e);
			a = this.nameLookup("helpers", d, "helper");
			return {
				params: g,
				name: a,
				callParams: ["depth0"].concat(g).join(", "),
				helperMissingParams: e && ["depth0", this.quotedString(d)].concat(g).join(", ")
			}
		},
		setupParams: function(a, d, e) {
			var g = [],
			j = [],
			k = [],
			l,
			z;
			g.push("hash:" + this.popStack());
			l = this.popStack();
			if ((z = this.popStack()) || l) z || (this.context.aliases.self = "this", z = "self.noop"),
			l || (this.context.aliases.self = "this", l = "self.noop"),
			g.push("inverse:" + l),
			g.push("fn:" + z);
			for (z = 0; z < a; z++) l = this.popStack(),
			d.push(l),
			this.options.stringParams && (k.push(this.popStack()), j.push(this.popStack()));
			this.options.stringParams && (g.push("contexts:[" + j.join(",") + "]"), g.push("types:[" + k.join(",") + "]"), g.push("hashTypes:hashTypes"));
			this.options.data && g.push("data:data");
			g = "{" + g.join(",") + "}";
			e ? (this.register("options", g), d.push("options")) : d.push(g);
			return d.join(", ")
		}
	};
	for (var g = "break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "), j = e.RESERVED_WORDS = {},
	k = 0, l = g.length; k < l; k++) j[g[k]] = !0;
	e.isValidJavaScriptVariableName = function(a) {
		return ! e.RESERVED_WORDS[a] && /^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(a) ? !0 : !1
	}
})(Handlebars.Compiler, Handlebars.JavaScriptCompiler);Handlebars.precompile = function(a, e) {
	if (!a || "string" !== typeof a && a.constructor !== Handlebars.AST.ProgramNode) throw new Handlebars.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed " + a);
	e = e || {};
	"data" in e || (e.data = !0);
	var d = Handlebars.parse(a),
	d = (new Handlebars.Compiler).compile(d, e);
	return (new Handlebars.JavaScriptCompiler).compile(d, e)
};Handlebars.compile = function(a, e) {
	if (!a || "string" !== typeof a && a.constructor !== Handlebars.AST.ProgramNode) throw new Handlebars.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed " + a);
	e = e || {};
	"data" in e || (e.data = !0);
	var d;
	return function(g, j) {
		if (!d) {
			var k = Handlebars.parse(a),
			k = (new Handlebars.Compiler).compile(k, e),
			k = (new Handlebars.JavaScriptCompiler).compile(k, e, void 0, !0);
			d = Handlebars.template(k)
		}
		return d.call(this, g, j)
	}
};Handlebars.VM = {
	template: function(a) {
		var e = {
			escapeExpression: Handlebars.Utils.escapeExpression,
			invokePartial: Handlebars.VM.invokePartial,
			programs: [],
			program: function(a, e, j) {
				var k = this.programs[a];
				if (j) return Handlebars.VM.program(e, j);
				k || (k = this.programs[a] = Handlebars.VM.program(e));
				return k
			},
			programWithDepth: Handlebars.VM.programWithDepth,
			noop: Handlebars.VM.noop,
			compilerInfo: null
		};
		return function(d, g) {
			g = g || {};
			var j = a.call(e, Handlebars, d, g.helpers, g.partials, g.data),
			k = e.compilerInfo || [],
			l = k[0] || 1,
			m = Handlebars.COMPILER_REVISION;
			if (l !== m) {
				if (l < m) throw "Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version (" + Handlebars.REVISION_CHANGES[m] + ") or downgrade your runtime to an older version (" + Handlebars.REVISION_CHANGES[l] + ").";
				throw "Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version (" + k[1] + ").";
			}
			return j
		}
	},
	programWithDepth: function(a, e, d) {
		var g = Array.prototype.slice.call(arguments, 2);
		return function(d, k) {
			k = k || {};
			return a.apply(this, [d, k.data || e].concat(g))
		}
	},
	program: function(a, e) {
		return function(d, g) {
			g = g || {};
			return a(d, g.data || e)
		}
	},
	noop: function() {
		return ""
	},
	invokePartial: function(a, e, d, g, j, k) {
		g = {
			helpers: g,
			partials: j,
			data: k
		};
		if (void 0 === a) throw new Handlebars.Exception("The partial " + e + " could not be found");
		if (a instanceof Function) return a(d, g);
		if (Handlebars.compile) return j[e] = Handlebars.compile(a, {
			data: void 0 !== k
		}),
		j[e](d, g);
		throw new Handlebars.Exception("The partial " + e + " could not be compiled when running in runtime-only mode");
	}
};Handlebars.template = Handlebars.VM.template;
function genericEditable(a, e, d) {
	this.tabs = a || {};
	this.initTab = d || 0;
	this.title = function() {
		return e
	}
}
genericEditable.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.tabs,
		initTab: this.initTab || 0
	})
};genericEditable.prototype.open = function(a) {
	$.dmfw.openEditor(this, {},
	{},
	{
		onEditorReady: a
	})
};
function NEEPrototypeExtension() {
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.addClearWidget = !1;
	this.getDummyElement = function() {
		return $(this.defaultMarkup())
	};
	this.editorReady = function(a) {
		$(a).find(".buttonTab").neeEditorTabs({
			tabs: this.buttonTabInfo
		})
	}
}
function NEEPrototypeExtensionTitle() {
	this.generalFormTitleFeildLabel = $.dmString("ui.nee.widgets.27");
	this.hideFormTitleFeildLabel = !1;
	this.widgetRuntimeTitle = "";
	this.displayTitle = !0;
	this.extraAttribue = {};
	this.widgetTitle = {
		CssClass: "dmwidget-title",
		alrenativeCssClass: "",
		ElementSelector: "h3",
		cssClassToAdd: "",
		needUpdateCurrentCss: !1,
		interenalSelector: null,
		recreateTitleElement: !1,
		oldElementPointer: null,
		recreateTitleTemplate: null
	};
	this.handleTitleinit = function() {
		var a = this,
		e = $("div#generalWidgetTitleController");
		a.hideFormTitleFeildLabel && $("#generalTitleInputLabel").remove();
		$(e).find("div.titleInputContainer").find("label").html(a.generalFormTitleFeildLabel);
		if ($.dmx.current.editable.isWidget) {
			var d = a.widgetTitle.CssClass;
			"" !== a.widgetTitle.alrenativeCssClass && (d = a.widgetTitle.alrenativeCssClass);
			d = $.dmx.current.element.find("." + d);
			"none" == d.css("display") ? ($("#toggleTitleBtn").addClass("hideTitle"), $("#generalTitleInput").addClass("hideTitle"), $("#designTitleBtn").addClass("hideTitle"), d.attr("hide", "true")) : d.attr("hide", "false")
		} else if (d = a.widgetTitle.CssClass, "" !== a.widgetTitle.alrenativeCssClass && (d = a.widgetTitle.alrenativeCssClass), d = $.dmx.current.element.find("." + d), "none" == d.css("display") || 0 == d.length) $("#toggleTitleBtn").addClass("hideTitle"),
		$("#generalTitleInput").addClass("hideTitle"),
		$("#designTitleBtn").addClass("hideTitle"); ! $.dmfw.isPT() && !$.dmfw.isDudaone() ? ($("#toggleTitleBtn").remove(), $("#designTitleBtn").remove()) : (e.off("click", "#toggleTitleBtn").on("click", "#toggleTitleBtn", $.dmx.current.editable.handleTitle.toggleTitle), e.off("click", "#designTitleBtn").on("click", "#designTitleBtn", $.dmx.current.editable.handleTitle.designTitle));
		e = a.widgetRuntimeTitle ? a.widgetRuntimeTitle.replace("^", "") : "";
		$("input#generalTitleInput").val(e);
		if ("" == a.widgetRuntimeTitle || !a.widgetRuntimeTitle) $("#designTitleBtn").addClass("hideTitle"),
		$("#toggleTitleBtn").addClass("hideTitle");
		$("input#generalTitleInput").on("change",
		function() {
			a.triggerEditTitle()
		});
		$("input#generalTitleInput").on("keypress",
		function(d) {
			13 == d.keyCode ? a.triggerEditTitle() : "" !== $(this).val() && $("#generalTitleInput").removeClass("hideTitle")
		})
	};
	this.triggerEditTitle = function() {
		this.checkDesignBtnWhenEdit();
		null !== $.dmx.current.editable.genericUpdateTitle && "function" == typeof $.dmx.current.editable.genericUpdateTitle ? $.dmx.current.editable.genericUpdateTitle($("input#generalTitleInput").val(), $("input#generalTitleInput")) : this.updateWidgetTitle()
	};
	this.checkDesignBtnWhenEdit = function() {
		"" == $("input#generalTitleInput").val() ? ($("#designTitleBtn").addClass("hideTitle"), $("#toggleTitleBtn").addClass("hideTitle"), $("#generalTitleInput").addClass("hideTitle")) : ($("#designTitleBtn").removeClass("hideTitle"), $("#toggleTitleBtn").removeClass("hideTitle"), $("#generalTitleInput").removeClass("hideTitle"))
	};
	this.toggleTitle = function() {
		var a = $("#generalWidgetTitleController div#toggleTitleBtn");
		a.hasClass("hideTitle") ? (a.removeClass("hideTitle"), $("#generalTitleInput").removeClass("hideTitle"), $("#designTitleBtn").removeClass("hideTitle")) : (a.addClass("hideTitle"), $("#generalTitleInput").addClass("hideTitle"), $("#designTitleBtn").addClass("hideTitle"));
		"" == $("#generalTitleInput").val() && $("#designTitleBtn").addClass("hideTitle");
		if ($.dmx.current.editable.isExtension)"function" == typeof $.dmx.current.editable.updateToggleTitle && $.dmx.current.editable.updateToggleTitle();
		else {
			var a = $.dmx.current.element.find("h3.dmwidget-title"),
			e = "true" === a.attr("hide"),
			e = !e;
			$(this).parent().toggleClass("noTitle");
			$.dmx.current.element.find("h3.dmwidget-title").attr("hide", e);
			$.dmops.updateCurrentAttributes({
				attrToAdd: {
					hide: e
				}
			},
			{
				element: a
			})
		}
	};
	this.designTitle = function() {
		if (!$("#designTitleBtn").hasClass("hideTitle")) {
			var a = $("div.rightPanel");
			a.empty();
			$("\x3cdiv class\x3d'slideRightPanelInner /'\x3e").appendTo(a);
			a.neeSecondaryDesignTabs({
				selector: ".dmwidget-title",
				afterTextButtonInit: function(a) {
					a.find("#dirLeft,#dirRight").hide()
				},
				tabs: {
					color: ["background", "text", "border"],
					text_style: []
				},
				useCurElem: !0
			});
			$.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						"function" == typeof $.dmx.current.editable.genericResetUIAndBreadcrumbs ? $.dmx.current.editable.genericResetUIAndBreadcrumbs() : $.dmx.current.editable.handleTitle.resetUIAndBreadcrumbs()
					}
				},
				{
					title: dmStr["ui.nee.menu.2"].replace("^", "")
				}]
			})
		}
	};
	this.resetUIAndBreadcrumbs = function() {
		$(".slideBtn").first().click();
		$.dmfw.setEditorBreadcrumb(null);
		"function" == typeof $.dmx.current.editable.genericHeaderBackButton && $.dmx.current.editable.genericHeaderBackButton()
	};
	this.updateWidgetTitle = function() {
		var a = this,
		e = $("#generalTitleInput").val(),
		d = $.dmx.current.element.find("." + a.widgetTitle.CssClass),
		g = [a.widgetTitle.CssClass],
		j = $(d).dmid();
		if (a.widgetTitle.recreateTitleElement) {
			j = d.dmid();
			if (null == a.widgetTitle.recreateTitleTemplate) d = document.createElement("h3"),
			$(d).addClass(a.widgetTitle.CssClass),
			d.html(e);
			else {
				var k = document.createElement("div");
				$(k).html(a.loadTitleFromTemplate(e));
				d = $(k).children()[0];
				$(d).dmidForChlidrens()
			}
			j = $.dmfw.generateDMid();
			$(d).dmid(j);
			$(d).attr("id", "dm_" + j);
			$(d).attr("hide", "false");
			$(a.widgetTitle.oldElementPointer).replaceWith(d);
			d = $(d);
			d.html(d.html());
			d.attr("class", d.attr("class"))
		}
		0 == d.length && (d = $.dmx.current.element.find("." + a.widgetTitle.alrenativeCssClass), j = $(d).dmid());
		"" !== a.widgetTitle.alrenativeCssClass && d.addClass(a.widgetTitle.alrenativeCssClass);
		"" !== a.widgetTitle.cssClassToAdd && (d.addClass(a.widgetTitle.cssClassToAdd), g.push(a.widgetTitle.cssClassToAdd));
		a.widgetTitle.recreateTitleElement ? (k = $.dmx.current.element.outerHTML(), k = $(k).attr("class", "dmTwitterFeedWrapper").outerHTML(), $.dmPost({
			url: "/pages/" + $.dmx.page.id + "/changeelementmarkup/" + $.dmx.current.element.dmid(),
			data: {
				value: k
			},
			success: function() {
				$.dmx.current.element.find("." + a.widgetTitle.CssClass).html($.dmx.current.element.find("." + a.widgetTitle.CssClass).html())
			}
		}), a.widgetTitle.recreateTitleElement = !1) : $.changePage({
			clientChange: function() {},
			serverChange: function() {
				a.widgetTitle.needUpdateCurrentCss ? $.dmops.updateCurrentCss({
					classesToRemove: ["dmHideFromNav"],
					attrToRemove: null,
					classesToAdd: g,
					attrToAdd: null
				},
				{
					element: $(d),
					success: function() {
						null !== a.widgetTitle.interenalSelector ? $.dmx.current.element.find("." + a.widgetTitle.CssClass).find("." + a.widgetTitle.interenalSelector).html(e) : d.html(e);
						d.attr("hide", "false");
						$.dmPostWithHistory({
							url: "/pages/" + $.dmx.currentPage() + "/updateWidgetTitle",
							data: {
								title: e,
								titleId: j
							},
							success: function() {}
						})
					}
				}) : (null !== a.widgetTitle.interenalSelector ? ($.dmx.current.element.find("." + a.widgetTitle.CssClass).find("." + a.widgetTitle.interenalSelector).html(e), j = $.dmx.current.element.find("." + a.widgetTitle.CssClass).find("." + a.widgetTitle.interenalSelector).attr("duda_id")) : d.html(e), d.attr("hide", "false"), $.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/updateWidgetTitle",
					data: {
						title: e,
						titleId: j
					},
					success: function() {}
				}))
			}
		});
		"" != e ? ($("#generalWidgetTitleController div#toggleTitleBtn").removeClass("hideTitle"), $("#generalTitleInput").removeClass("hideTitle"), $("#designTitleBtn").removeClass("hideTitle")) : (d.attr("hide", "true"), $.dmops.updateCurrentAttributes({
			attrToAdd: {
				hide: "true"
			},
			attrToRemove: null
		},
		{
			element: $.dmx.current.element.find("h3")
		}));
		null !== $.dmx.current.editable.genericWidgetUpdateTitle && "function" == typeof $.dmx.current.editable.genericWidgetUpdateTitle && $.dmx.current.editable.genericWidgetUpdateTitle()
	};
	this.loadTitleFromTemplate = function(a) {
		var e = {
			title: a
		},
		d = document.createElement("h3");
		$.ajax({
			url: this.widgetTitle.recreateTitleTemplate + "?" + version,
			async: !1,
			success: function(a) {
				d = Handlebars.compile(a)(e)
			}
		});
		return d
	}
}
function NEEClickToCall() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.click2call.3"]
	};
	this.ext = {
		id: "clicktocall",
		preId: "clicktocall",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			phone: dmStr["ui.nee.click2call.number"],
			surround: !0,
			needs_premium_validation: !0,
			description: dmStr["ui.nee.click2call.8"],
			wr: !0,
			adwords: ""
		}
	};
	this.priority = 1;
	this.type = "clicktocall";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.mindTouchId = "dmMtClickToCall";
	this.showMindTouchHelp = !0;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/call.png",
			editableDraggedText: dmStr["ui.nee.widgets.1"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.click2call.3"]
	};
	this.rightPanelElementSelector = "#generalClickToCall";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.editorDesc = "Add your phone number to get users to call you by a click of a button.";
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/clicktocall/one.buttonsHtmlClickToCallGeneral.jsp": "/editor/nee/editableObjects/clickToCall/nee.buttonsHtmlClickToCallGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.clickToCallOnTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEClickToCall.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEClickToCall.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorClickToCallSelected")
};NEEClickToCall.prototype.clickToCallOnTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#phoneTextDesc").val(a.attr("description"));
	var e = function(a, d) {
		if (null != d && 0 < d.length) {
			for (var e = !1,
			g = 0; g < a.length; g++) if (a[g] == d) {
				e = !0;
				break
			}
			e || a.push(d)
		}
		$("#phoneNum").autocomplete({
			source: a
		})
	},
	d = a.attr("phone");
	d == dmStr["ui.nee.click2call.number"] && (d = null);
	var g = $.dmx.site.phoneNumbers;
	null == g ? $.dmGet({
		url: "/sites/" + $.dmx.site.id + "/foundphonenumbers",
		success: function(a) {
			g = a.list;
			$.dmx.site.phoneNumbers = g;
			e(a.list, d)
		}
	}) : e(g, d);
	$("#phoneNum").val(null != d ? d: dmStr["ui.nee.click2call.number"]);
	$('[id^\x3d"phone"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"phone"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var d = {
			phone: $("#phoneNum").val(),
			description: $("#phoneTextDesc").val(),
			adwords: a.attr("adwords"),
			needs_premium_validation: !0
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", d.description);
				a.attr("phone", d.phone);
				a.attr("adwords", d.adwords);
				a.find(".text").html(d.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, d)
			}
		})
	};
	var j = {
		initState: null != a.attr("adwords") && "" != a.attr("adwords"),
		onFn: function() {
			$(".adWordsTrackingContent").show();
			a.attr("adwords", "true");
			_updateInfo()
		},
		offFn: function() {
			$(".adWordsTrackingContent").hide();
			a.attr("adwords", "");
			_updateInfo()
		}
	};
	$("#adwordsOnOff").onOffBtn(j);
	$(".adWordsTrackingTitle .panelTitleQmark").dmQtip({
		content: dmStr["ui.nee.common.adwords.101"]
	});
	$.dmAddAllPagesButtons(a)
};NEEClickToCall.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToCallSelected"), this.disableEditInline())
};NEEClickToCall.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(".dmCall *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEClickToCall.prototype.getElementTagsSelectors = function() {
	return ".dmCall"
};NEEClickToCall.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEClickToCall.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEClickToCall.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEClickToCall.prototype.disableEditInline = function() {};NEEClickToCall.prototype.docReady = function() {};NEEClickToCall.prototype.getDefaultIconName = function() {
	return "phone.png"
};NEEClickToCall.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEClickToCall.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustX: 4,
			maxWidth: "180"
		},
		e = $("input#phoneNum:visible"),
		d = $.dmx.current.element.attr("phone"),
		g = e.val(),
		j = "" === d || void 0 === d || "" === g,
		g = g && !$.validateLongPhoneNumber(g);
		j || g || d === dmStr["ui.nee.click2call.number"] ? $.dmfw.showPromptError(e, dmStr[j ? "ui.nee.promptMassages.17": g ? "ui.nee.promptMassages.19": "ui.nee.promptMassages.1"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEClickToSms() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.click2sms.3"]
	};
	this.ext = {
		id: "clicktosms",
		preId: "clicktosms",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			phone: dmStr["ui.nee.click2call.number"],
			surround: !0,
			needs_premium_validation: !0,
			description: dmStr["ui.nee.click2sms.4"],
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "clicktosms";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/sms.png",
			editableDraggedText: dmStr["ui.nee.widgets.5"]
		}
	};
	this.mindTouchId = "dmMtClickToText";
	this.showMindTouchHelp = !0;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.click2sms.4"]
	};
	this.rightPanelElementSelector = "#generalClickToSms";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/clickToSms/nee.buttonsHtmlClickToSmsGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.clickToSmsOnTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: "More",
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEClickToSms.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEClickToSms.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorClickToSmsSelected")
};NEEClickToSms.prototype.clickToSmsOnTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#phoneNum").val(a.attr("phone"));
	$("#phoneTextDesc").val(a.attr("description"));
	$('[id^\x3d"phone"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"phone"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			phone: $("#phoneNum").val(),
			description: $("#phoneTextDesc").val(),
			needs_premium_validation: !0
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("phone", e.phone);
				a.find(".text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEClickToSms.prototype.clickToSmsOnTabReadyIcon = function(a) {
	$(a).neeSecondaryIconTabs()
};NEEClickToSms.prototype.clickToSmsOnTabReadyDesign = function(a) {
	$(a).neeSecondaryDesignTabs()
};NEEClickToSms.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToSmsSelected"), this.disableEditInline())
};NEEClickToSms.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmSms *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEClickToSms.prototype.getElementTagsSelectors = function() {
	return "A.dmSms"
};NEEClickToSms.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEClickToSms.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEClickToSms.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEClickToSms.prototype.disableEditInline = function() {};NEEClickToSms.prototype.docReady = function() {};NEEClickToSms.prototype.getDefaultIconName = function() {
	return "sms.png"
};NEEClickToSms.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEClickToSms.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustX: 4,
			maxWidth: "180"
		},
		e = $("input#phoneNum").val(),
		d = "" === e,
		g = $.dmx.current.element.attr("phone"),
		e = !$.validatePhoneNumber(e),
		j = d ? "ui.nee.promptMassages.17": e ? "ui.nee.promptMassages.19": "ui.nee.promptMassages.1";
		g === dmStr["ui.nee.click2call.number"] || d || e ? $.dmfw.showPromptError($("input#phoneNum"), dmStr[j], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEParagraph() {
	this.title = function() {
		return dmStr["ui.nee.paragraph.1"]
	};
	this.mindTouchId = "dmMtParagraph";
	this.showMindTouchHelp = !0;
	this.priority = 3;
	this.type = "paragraph";
	this.defaultMarkupStr = "\x3cdiv class\x3d'dmNewParagraph'\x3e\x3c/div\x3e";
	this.inlineEditor = null;
	this.noEditorOnInsert = !1;
	this.defaultMarkup = function(a) {
		return a && a.title == dmStr["ui.nee.paragraph.2"] ? "\x3ch1 class\x3d'dmNewParagraph'\x3eNew Title\x3c/h1\x3e": this.defaultMarkupStr
	};
	this.afterInsert = function() {};
	this.dragImageParams = function() {
		var a = {};
		return a = $.dmx.current.element.is("h1.dmNewParagraph") ? {
			editableDraggedImg: "/editor/nee/images/contentBtns/title.png",
			editableDraggedText: dmStr["ui.nee.widgets.27"]
		}: {
			editableDraggedImg: "/editor/nee/images/contentBtns/paragraph.png",
			editableDraggedText: dmStr["ui.nee.widgets.9"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.paragraph.1"],
		useSeparateTextEditMode: !1,
		allowTextEditing: !0,
		hasAlign: !1
	};
	this.neeEditorTabsButtons = null
}
this.editorDesc = "Add a textual paragraph to your site.";NEEParagraph.prototype.allowedOperations = function(a, e) {
	a = $(a);
	return a.is(".dmColumn *") ? {
		insertBefore: !1,
		insertAfter: !1,
		insertInsideTop: !0,
		insertInsideBottom: !0
	}: ("imageSlider" == e || "adsense" == e || "photoGallery" == e) && a.is(".dmtabs *,.dmColumn, .dmColumn *") || a.is(".dmLinkList *,.dmLinkList") ? {
		insertBefore: !1,
		insertAfter: !1,
		insertInsideTop: !1,
		insertInsideBottom: !1
	}: a.is('[dmle_design_option\x3d"list:dml;"]') ? {
		insertBefore: !0,
		insertAfter: !0,
		insertInsideTop: !1,
		insertInsideBottom: !1
	}: a.is(".dmtabscont, .dmtabscont \x3e div") ? {
		insertBefore: !1,
		insertAfter: !1,
		insertInsideTop: !0,
		insertInsideBottom: !0
	}: a.is(".dmDescription, .dmDescription *") || (a.is(".borderEffect, .borderEffect *") || a.is("p")) || a.is("h1, h2, h3, h4") ? {
		insertBefore: !0,
		insertAfter: !0,
		insertInsideTop: !1,
		insertInsideBottom: !1
	}: {
		insertBefore: !0,
		insertAfter: !0,
		insertInsideTop: !0,
		insertInsideBottom: !0
	}
};NEEParagraph.prototype.drawBottomBar = function() {
	return this._isTabContent() ? !0 : !1
};NEEParagraph.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEParagraph.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(this._getElementTagsSelectors()) && (e = $(a).is(".navWrapper") && !$(a).is(":has(a)") ? !1 : !0);
	return e
};NEEParagraph.prototype.setCorrectElement = function(a, e) {
	null == e && (e = !1);
	this.element = e ? a: this.getCorrectElement(a)
};NEEParagraph.prototype.getCorrectElement = function(a) {
	a = $(a);
	return a.is(".dmNewParagraph, .dmNewParagraph  *") && !a.is(".dmColumn *") && !a.is(".dmtabs *") ? $(a).closest(".dmNewParagraph") : a.is(".dmBlockElement , .dmBlockElement *") ? a.closest(".dmBlockElement") : a.is("[dmle_insert], [dmle_insert]  *") && !a.is(".dmColumn *") && !a.is(".dmtabs *") ? a.closest("[dmle_insert\x3d'true']") : a.is("input,select,textarea,.dmFooter") ? a: $(a).is(".dmLinkList *") ? a.closest('[dmle_design_option\x3d"list:dml;"]') : this._isBfsInnerBar(a) ? a.closest(".innerBar") : a.is("[data-dmtmpl\x3dtrue] .tempContainer, [data-dmtmpl\x3dtrue] .tempContainer *") ? a.closest("[data-dmtmpl\x3dtrue]") : a.getTopBlockElement()
};NEEParagraph.prototype.getCorrectElementForDelete = function(a) {
	return this._isLeftColumn(a) || this._isRightColumn(a) ? a.parent() : this._isTabContent(a) ? a.closest(".dmtabs") : this._isBfsInnerBar(a) ? a.closest(".innerBar") : a
};NEEParagraph.prototype.getPasteLocation = function(a) {
	return this._isContentArea(a) || this._isFooter(a) || a.is('[dmle_table\x3d"td"]') ? {
		parent: a,
		before: a.first()
	}: null
};NEEParagraph.prototype.getCorrectElementForMove = function(a) {
	return this.getCorrectElementForDelete(a)
};NEEParagraph.prototype.getCorrectElementForDrop = function(a, e) {
	if ($(a).is("[dmle_table\x3d'td']") && $(e).is("[dmle_table\x3d'tr']")) return $(a).parent();
	if (!$.dmx.preview.wnd().jQuery.DM.isUseLayout() && 0 < $.dmfw.getPreviewElement(".dmContent").length && $(a).offset().top == $.dmfw.getPreviewElement(".dmContent").offset().top) {
		if (!$(a).is(".dmColumn *")) return $.dmfw.getPreviewElement(".dmContent")
	} else return this.getCorrectElement(a)
};NEEParagraph.prototype._getElementTagsSelectors = function() {
	return ".dmOuter *"
};NEEParagraph.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorParagraphSelected")
};NEEParagraph.prototype.deselectInline = function() {
	null != this.element && $(this.element).removeClass("inlineEditorParagraphSelected")
};NEEParagraph.prototype.editInline = function(a, e) {
	var d = $(a.element),
	g = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(g, e);
	if (this._isContentArea(d)) g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.3"] + "\x3c/div\x3e"),
	g.isMovable = !1,
	g.isDelete = !1,
	g.isCopy = !1,
	g.isHideOnDevice = !1;
	else if (this._isFooter(d)) g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.footer"] + "\x3c/div\x3e"),
	g.isMovable = !1,
	g.isDelete = !1,
	g.isExpandable = !1,
	g.isCopy = !1;
	else if (_isUnderTable(this)) g.isUnderTable = !0;
	else if (this._isContainer(d)) g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.4"] + "\x3c/div\x3e"),
	g.isMovable = !1,
	g.isDelete = !1,
	g.isExpandable = !1;
	else if (this._isInput(d)) g.allowTextEditing = !1,
	g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.5"] + "\x3c/div\x3e");
	else if (this._isLeftColumn(d)) g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.columns.100"] + " \x3e " + dmStr["ui.nee.paragraph.6"] + "\x3c/div\x3e"),
	g.editParentSelector = ".dmColumn",
	g.editParentTitle = "Edit Columns";
	else if (this._isRightColumn(d)) g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.columns.100"] + " \x3e " + dmStr["ui.nee.paragraph.7"] + "\x3c/div\x3e"),
	g.editParentSelector = ".dmColumn",
	g.editParentTitle = "Edit Columns";
	else if (this._isTabContent(d)) {
		g.dynamicTitle = $("\x3cdiv\x3e\x3c/div\x3e");
		var d = $("\x3cspan class\x3d'" + INLINE_EDITOR_ELEMET + "'\x3e \x3e " + dmStr["ui.nee.paragraph.8"] + "\x3c/span\x3e"),
		j = $("\x3cspan class\x3d'" + INLINE_EDITOR_ELEMET + "' style\x3d'cursor:pointer;text-decoration:underline'\x3e" + dmStr["ui.nee.paragraph.9"] + "\x3c/span\x3e");
		j.click(function(a) {
			$.dmfw.selectAndOpenEditor($.dmx.current.element.closest(".dmtabs"));
			a.stopPropagation()
		});
		j.mousedown(function(a) {
			a.stopPropagation()
		});
		d.prepend(j);
		g.dynamicTitle.prepend(d);
		g.isMovable = !1;
		g.editParentSelector = ".dmtabs";
		g.editParentTitle = "Edit Tabs";
		g.isImportable = !0
	} else "h1" == d.get(0).nodeName.toLowerCase() && d.is(".dmNewParagraph") ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.2"] + "\x3c/div\x3e"), g.isImportable = !0) : "h1" == d.get(0).nodeName.toLowerCase() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.10"] + " 1\x3c/div\x3e"), g.isImportable = !0) : "h2" == d.get(0).nodeName.toLowerCase() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.10"] + " 2\x3c/div\x3e"), g.isImportable = !0) : "h3" == d.get(0).nodeName.toLowerCase() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.10"] + " 3\x3c/div\x3e"), g.isImportable = !0) : "h4" == d.get(0).nodeName.toLowerCase() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.10"] + " 4\x3c/div\x3e"), g.isImportable = !0) : this._isListView() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.11"] + "\x3c/div\x3e"), g.allowTextEditing = !1) : this._isBfsInnerBar() ? (g.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.paragraph.100"] + "\x3c/div\x3e"), g.isDelete = !1, g.isMovable = !1, g.allowTextEditing = !1) : this._isDmTop() ? g.isMovable = !1 : g.isImportable = !0;
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(g)
};NEEParagraph.prototype.docReady = function() {
	$.dmops.checkEmptyContent()
};_goToParagraphMode = function(a) {
	$.dmops.applyPattern($.dmx.current.element, "list", "dmc",
	function() {
		$(".toListButton").text(dmStr["ui.nee.paragraph.12"]).unbind("click").click(function() {
			_goToListMode(a)
		});
		isList = 1;
		$.dmfw.selectAndOpenEditor($.dmx.current.element, !0)
	})
};_goToListMode = function(a) {
	$.dmops.applyPattern($.dmx.current.element, "list", "dml",
	function() {
		$(".toListButton").text(dmStr["ui.nee.paragraph.13"]).unbind("click").click(function() {
			_goToParagraphMode(a)
		});
		isList = 2;
		$.dmfw.selectAndOpenEditor($.dmx.current.element, !0)
	})
};_displayParagraphListButton = function(a, e) {
	if (a) {
		var d = a.attr("dmle_design_option") ? a.attr("dmle_design_option") : "",
		g = 0,
		j;
		if (! (j = d.match(/list:dmc/))) if (j = d.match(/list:/)) if (a && a.size()) {
			j = a.find("li");
			var k = 0;
			j.each(function() {
				0 < $(this).find("a").size() && k++
			});
			j = 2 < k && k > 0.65 * j.size()
		} else j = !1;
		j && ($.dmfw.showEditorButton({
			selector: ".toListButton",
			click: function() {
				_goToListMode(e)
			}
		}), g = 1);
		d.match(/list:dml/) && ($(".toListButton").text(dmStr["ui.nee.paragraph.13"]).unbind("click"), $.dmfw.showEditorButton({
			selector: ".toListButton",
			click: function() {
				_goToParagraphMode(e)
			}
		}), $(".toListButton").text(dmStr["ui.nee.paragraph.13"]), g = 2);
		return g
	}
	return 0
};NEEParagraph.prototype.initTabReady = function() {
	$.dmx.current.editable.inlineEditor.editorUtils.enableInlineEdit()
};NEEParagraph.prototype.shouldHideTextTab = function() {
	return this._isBfsInnerBar()
};NEEParagraph.prototype.editorReady = function(a, e) {
	this.$ed = $(a);
	var d = 0,
	g = e.tabToOpen || 0;
	$.dmfw.hideEditorButton({
		selector: ".toListButton"
	});
	var d = _displayParagraphListButton($.dmx.current.element, this),
	j,
	k = this;
	j = {
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
		text: dmStr["ui.design"],
		imgSrc: "DesignImgIcon",
		onTabReady: function(a) {
			k.initTabReady();
			$.dmfw.hideEditorButton({
				selector: ".toListButton"
			});
			_displayParagraphListButton($.dmx.current.element, k);
			var e = {
				color: ["background", "text"]
			},
			g = {};
			1 < d ? (e.list_design = [], e.text_style = [], e.color.push("text"), e.color.push("list_item_border"), g.textSelector = " li\x3e a *", g.selector = " li ") : (e.shape = [], e.color.push("border"));
			k._isBfsInnerBar(k.element) && (delete e.shape, g.changeGlobally = !0, g.selector = "#dm #innerBar", g.specForceClassName = {
				text: "#dm #innerBar .innerPageTitle"
			},
			g.forceClassName = "#dm #innerBar");
			g.tabs = e;
			$(a).neeSecondaryDesignTabs(g)
		}
	};
	var l = {
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
		text: dmStr["ui.more"],
		imgSrc: "MoreImgIcon",
		onTabReady: function(a) {
			k.initTabReady();
			$.dmfw.hideEditorButton({
				selector: ".toListButton"
			});
			var d = {
				tabs: {
					general_design_settings: [],
					customize: [],
					css: [],
					html: []
				}
			};
			k._isBfsInnerBar(k.element) && (delete d.tabs.general_design_settings, delete d.tabs.html, d.changeGlobally = !0, d.selector = "#dm #innerBar", d.specForceClassName = {
				text: "#dm #innerBar .innerPageTitle"
			},
			d.forceClassName = "#dm #innerBar");
			$(a).neeSecondaryDesignTabs(d)
		}
	},
	m = {
		type: [{
			url: "/editor/nee/editableObjects/paragraph/nee.buttonsHtmlParagraphText.jsp",
			text: dmStr["ui.text"],
			imgSrc: "TextImgIcon",
			onTabReady: function() {
				$.dmx.current.editable.inlineEditor.editorUtils.enableInlineEdit(!0);
				$.dmfw.showEditorButton({
					selector: ".saveButton",
					click: function() {
						_RTE_Element && _RTE_Element.saveChanges(!1)
					}
				})
			},
			onTabClose: function(a, d) {
				$.dmfw.hideEditorButton({
					selector: ".saveButton"
				});
				null != _RTE_Element ? _RTE_Element.saveAndLock(d) : d && d()
			}
		},
		j, l]
	};
	k.shouldHideTextTab() && (m = {
		type: [j, l]
	});
	j = m;
	l = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border", "text"],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						customize: [],
						css: [],
						html: []
					}
				})
			}
		}]
	};
	"h1" == $.dmx.current.element.get(0).nodeName.toLowerCase() && $.dmx.current.element.is(".dmNewParagraph") ? $("#contentTitle").text(dmStr["ui.nee.paragraph.1"]) : "h1" == $.dmx.current.element.get(0).nodeName.toLowerCase() ? $("#contentTitle").text(dmStr["ui.nee.paragraph.10"] + " 1") : "h2" == $.dmx.current.element.get(0).nodeName.toLowerCase() ? $("#contentTitle").text(dmStr["ui.nee.paragraph.10"] + " 2") : "h3" == $.dmx.current.element.get(0).nodeName.toLowerCase() ? $("#contentTitle").text(dmStr["ui.nee.paragraph.10"] + " 3") : "h4" == $.dmx.current.element.get(0).nodeName.toLowerCase() && $("#contentTitle").text(dmStr["ui.nee.paragraph.10"] + " 4");
	this._isContentArea() ? ($("#contentTitle").text(dmStr["ui.nee.paragraph.3"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: l,
		initTab: g
	})) : this._isFooter() ? ($("#contentTitle").text(dmStr["ui.footer"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: j,
		initTab: g
	})) : this._isContainer() ? ($("#contentTitle").text(dmStr["ui.nee.paragraph.4"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: l,
		initTab: g
	})) : this._isInput() ? (j.type.remove(0), $("#contentTitle").text(dmStr["ui.nee.paragraph.5"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: j,
		initTab: g
	})) : this._isListView() ? ($("#contentTitle").text(dmStr["ui.nee.paragraph.11"]), j = {
		type: [j.type[1], j.type[2]]
	},
	this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: j,
		initTab: g
	})) : (g = {
		tabs: j,
		initTab: g
	},
	this.neeEditorTabsButtons = this.$ed.find(".buttonTab").neeEditorTabs(g));
	this._isLeftColumn() ? $.dmfw.setEditorBreadcrumb({
		parts: [{
			click: function(a) {
				$.dmx.current.element.parent().selectElement({
					forceSelect: !0
				});
				$.dmx.current.element.lockElement();
				$.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide();
				$.dmfw.openEditor($.dmx.current.editable, $.dmx.current.element);
				a.stopPropagation()
			},
			title: dmStr["ui.nee.paragraph.14"]
		},
		{
			title: dmStr["ui.nee.paragraph.6"]
		}]
	}) : this._isRightColumn() ? $.dmfw.setEditorBreadcrumb({
		parts: [{
			click: function(a) {
				$.dmx.current.element.parent().selectElement({
					forceSelect: !0
				});
				$.dmx.current.element.lockElement();
				$.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide();
				$.dmfw.openEditor($.dmx.current.editable, $.dmx.current.element);
				a.stopPropagation()
			},
			title: dmStr["ui.nee.paragraph.14"]
		},
		{
			title: dmStr["ui.nee.paragraph.7"]
		}]
	}) : this._isTabContent() ? $.dmfw.setEditorBreadcrumb({
		parts: [{
			click: function(a) {
				$.dmx.current.element.closest(".dmtabs").selectElement({
					forceSelect: !0
				});
				$.dmx.current.element.lockElement();
				$.dmx.current.editable.inlineEditor.editorUtils.editorTop.hide();
				$.dmfw.openEditor($.dmx.current.editable, $.dmx.current.element);
				a.stopPropagation()
			},
			title: dmStr["ui.nee.paragraph.9"]
		},
		{
			title: dmStr["ui.nee.paragraph.8"]
		}]
	}) : this._isBfsInnerBar();
	this.initTabReady()
};NEEParagraph.prototype._isContentArea = function() {
	return $.dmx.current.element.is(".dmContent")
};NEEParagraph.prototype._isFooter = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".dmFooter, #fcontainer")
};NEEParagraph.prototype._isListView = function(a) {
	a = a || $.dmx.current.element;
	return !! (a.attr("dmle_design_option") ? a.attr("dmle_design_option") : "").match(/list:dml/)
};NEEParagraph.prototype._isContainer = function(a) {
	a = a || $.dmx.current.element;
	$.browser.msie && !this._isListView() && $.dmx.current.element.find("div,p,img,td");
	return a.is(".dmContentPlaceholder") ? !0 : 0 < $.dmx.current.element.find(".dmNav").length
};NEEParagraph.prototype._isInput = function() {
	return $.dmx.current.element.is("input,select,textarea")
};NEEParagraph.prototype._isLeftColumn = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".dmColumn \x3e div:nth-child(1) ")
};NEEParagraph.prototype._isRightColumn = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".dmColumn \x3e div:nth-child(3) ")
};NEEParagraph.prototype._isTabContent = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".dmtabscont \x3e div")
};NEEParagraph.prototype._isBfsInnerBar = function(a) {
	a = a || $.dmx.current.element;
	return $(a).is(".dm-bfs .innerBar, .dm-bfs .innerBar *")
};NEEParagraph.prototype._isDmTop = function(a) {
	a = a || $.dmx.current.element;
	return $(a).is("#dmTop")
};NEEParagraph.prototype._isPlaceholder = function(a) {
	a = a || $.dmx.current.element;
	return $(a).is(".placeholder")
};NEEParagraph.prototype.getTitle = function() {
	return dmStr["ui.nee.paragraph.1"]
};NEEParagraph.prototype.onEditorClose = function(a) {
	null != _RTE_Element && _RTE_Element.isTextEditorVisible() && _RTE_Element.saveChanges(!0, a);
	$.dmops.checkEmptyContent()
};NEEParagraph.prototype.bindEvents = function() {
	$.dmx.events.unbind("navTitleChanged.innerTitle").bind("navTitleChanged.innerTitle",
	function(a) {
		$.dmfw.getPreviewElement(".dm-bfs .innerBar .innerPageTitle").text(a)
	})
};NEEParagraph.prototype.handlePlaceHolder = function() {};
function NEEImage(a) {
	this.options = a || {};
	this.itemData = this.options.itemData || {};
	this.parent = this.itemData.parent;
	this.title = function() {
		return dmStr["ui.nee.images.1"]
	};
	this.mindTouchId = "dmMtImage";
	this.showMindTouchHelp = !0;
	this.priority = 1;
	this.type = "image";
	this._defaultImageSrcUrl = dmStr["ui.config.widgets.image.placeholder"] ? dmStr["ui.config.widgets.image.placeholder"] : "http://dm-direct.s3.amazonaws.com/defaultImages/clickToEditPicture.png";
	this._defaultLogoSrcUrl = dmStr["ui.config.widgets.logo.placeholder"] ? dmStr["ui.config.widgets.logo.placeholder"] : "http://dudamobile-themes.s3.amazonaws.com/otf_theme/logohere.png";
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'imageWidget'\x3e\x3cimg src\x3d'" + this._defaultImageSrcUrl + "' style\x3d'margin-top:10px;margin-bottom:10px;' \x3e\x3c/img\x3e\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/image.png",
			editableDraggedText: dmStr["ui.nee.widgets.7"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.images.1"],
		selectionOverlay: {
			replace: !0
		}
	};
	this.linkEditor = this.onTabChange = null;
	this.allowedOperations = function(a) {
		return $(a) && $(a).is(".dmLinkList *") ? {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}: {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.inlineEdit = {
		bar: {
			selectElement: function(a) {
				return $(a).is("div") ? $(a) : null
			},
			onReady: function(a, d) {
				$("\x3ca href\x3d'javascript:void(0)'\x3eEdit Image\x3c/a\x3e").click(function(a) {
					$.dmfw.addEditor($.dmfw.editables("image"), d);
					a.stopPropagation()
				}).appendTo(a)
			}
		}
	}
}
NEEImage.prototype._isImageWithPlaceholder = function(a) {
	a = a || $.dmx.current.element;
	var e = !1;
	a.is(".imageWidget") && 0 < a.find(".placeholder").length && (e = !0);
	return e
};NEEImage.prototype.onTabReadyGeneralNew = function(a) {
	function e() {
		var a = "url(" + g.attr("src") + ")";
		$("#header_img-change-crop .imgBgPreviewImg").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", a);
		$("#header_image-resize").neeSecondaryResizeTab({
			classToAdd: "headerLogoToggleAddDesign"
		});
		$("#header_image-align").neeSecondaryDesignAlignmentSettingsTab()
	}
	function d(a, d) {
		var j = $.dmx.current.element.find(".placeholder"),
		k = {
			elem: g,
			callback: function() {
				e()
			}
		},
		k = $.extend(!0, k, d);
		$(".closeThis").trigger("click");
		$.dmops.updateCurrentImgSrc(a, k);
		$.dmx.events.trigger("imageChanged");
		l && (j.remove(), $.dmops.updateCurrentAttributes({
			attrToRemove: ["data-dmtmpl"]
		}))
	}
	var g = $.dmx.current.element.is("img") ? $.dmx.current.element: $.dmx.current.element.find("img");
	$("#header_top").hide();
	$("#header_img-link").show();
	$("#wrap-text-wrapper").show();
	$("#header_img-logo-edit").show();
	$(".slideRightPanelInner").addClass("slideRightPanelImg");
	var j = $("#headerToOpenChange").clone();
	$("#editImage").unbind("click").bind("click",
	function() {
		return $.dmops.editImageWithAviary(g,
		function(a, e) {
			d(e, {
				downloadImage: !0
			})
		})
	});
	_imageHasLink = function() {
		var a = $($.dmx.current.element).closest("a");
		if (!a || 0 >= a.length) return ! 1;
		a = $(a).attr("href");
		return ! a || 0 >= a.length ? !1 : !0
	};
	var k = "url(" + g.attr("src") + ")";
	$("#header_img-change-crop .imgBgPreviewImg").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", k);
	_imageHasLink() && ($("#headerLogoAddLink").hide(), $("#headerLogoChangeLink").show(), $("#headerLogoRemoveLink").show());
	$(document.body).on("click", ".toggleModeButtons span",
	function() {
		$(this).hasClass("toggleModeOn") && $(this).hasClass("modeFirst") ? $("#headerToggleShowOlyPrecent").hide() : $("#headerToggleShowOlyPrecent").show()
	});
	$("#headerLogoRemoveLink").click(function() {
		$.dmops.updateCurrentAttributes({
			attrToRemove: ["href", "raw_url"]
		},
		{
			element: $($.dmx.current.element).closest("a")
		})
	});
	$("#headerLogoChange").neePopUpDiv(j, {
		init: function(a) {
			a.show();
			a.neeSecondaryIconTabs({
				tabs: {
					upload: [{
						isChange: !1
					}],
					original_images: [],
					url: []
				},
				callback: d,
				uploadBiggerButton: !0,
				isImagePickerPopup: !0
			})
		},
		toChangeFunction: d,
		showIphone: !0
	});
	var l = 0 < $.dmx.current.element.find(".placeholder").length;
	l && $("#headerLogoChange").trigger("click");
	$("#headerLogoCrop").neePopUpDiv($("#headerToOpenCrop"), {
		init: function(a) {
			a.empty();
			var d = $("\x3cdiv class\x3d'headerLogoCropPop'\x3e\x3cdiv id\x3d'headerLogoCropPopTitle'\x3e" + dmStr["ui.crop"] + "\x3c/div\x3e\x3c/div\x3e");
			jQuery.ajax({
				url: "/editor/nee/editableObjects/common/nee.buttonsHtmlCrop.jsp",
				async: !1,
				success: function(j) {
					d.append($(j));
					j = $("\x3cdiv class\x3d'headerLogoCropPopBottom'\x3e\x3chr/\x3e\x3cdiv class\x3d'cropButton orangeBtn ptOrangeBtn'\x3e" + dmStr["ui.crop"].toUpperCase() + "\x3c/div\x3e\x3c/div\x3e");
					d.append(j);
					a.append(d);
					a.find(".doneBtn").click(function() {
						$(".closeThis").click()
					});
					a.show();
					j = g;
					a.neeSecondaryCropTab({
						originalSrc: "undefined" != j.attr("dm_orig_src") ? j.attr("dm_orig_src") : null,
						imgSrc: j.attr("src"),
						cropDim: j.attr("dm_crop_dim"),
						element: j,
						currElemDmid: j.dmid(),
						imgElem: j,
						uploadBiggerButton: !0,
						dontShowBtn: !0,
						callback: function() {
							$(".closeThis").trigger("click");
							e()
						}
					})
				}
			})
		},
		initBeforeClick: function(a) {
			a.find(".imgToCrop").empty()
		},
		showIphone: !0
	});
	a.on("click", "#headerLogoAddLink, #headerLogoRemoveLink",
	function() {
		"headerLogoAddLink" == $(this).attr("id") ? ($("#headerLogoAddLink").hide(), $("#headerLogoChangeLink").show(), $("#headerLogoRemoveLink").show()) : "headerLogoRemoveLink" == $(this).attr("id") && ($("#headerLogoChangeLink").hide(), $("#headerLogoRemoveLink").hide(), $("#headerLogoAddLink").show())
	});
	this.prepareLinkEditor(a.closest("#_editor"));
	$("#header_image-resize").neeSecondaryResizeTab({
		classToAdd: "headerLogoToggleAddDesign"
	});
	$("#header_image-align").neeSecondaryDesignAlignmentSettingsTab(); ! 0 == $.dmx.current.editable.isAfterInsert && ($.dmx.current.editable.isAfterInsert = !1, $("#headerLogoChange").trigger("click"))
};NEEImage.prototype.prepareLinkEditor = function() {
	$("#headerLogoAddLink, #headerLogoChangeLink").neePopUpDiv($("#headerToOpenLink"), {
		init: function(a) {
			a.empty();
			var e = $("\x3cdiv class\x3d'headerLogoCropPop'\x3e\x3cdiv id\x3d'headerLogoCropPopTitle' style\x3d'margin-top: -10px;'\x3e" + dmStr["ui.nee.header.404"] + "\x3c/div\x3e\x3c/div\x3e");
			jQuery.ajax({
				url: $.dmfw.editables("link").getMarkupUrl(),
				async: !1,
				success: function(d) {
					e.append($(d));
					d = $("\x3cdiv class\x3d'headerLogoCropPopBottom'\x3e\x3chr/\x3e\x3cdiv class\x3d'doneBtn blueBtn'\x3e" + dmStr["ui.done"].toUpperCase() + "\x3c/div\x3e\x3c/div\x3e");
					e.append(d);
					e.find("#linkPanelEditorWrapper").css("display", "none");
					a.append(e);
					a.find(".doneBtn").click(function() {
						$(".closeThis").click()
					});
					$.dmx.current.editable._linkTabReady($.dmx.current.editable, a)
				}
			})
		},
		initBeforeClick: function(a) {
			a.find(".imgToCrop").empty()
		},
		showIphone: !0,
		disableDrag: !0
	})
};NEEImage.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEImage.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEImage.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEImage.prototype.getCorrectElement = function(a) {
	a = $(a); ! a.is(".imageWidget") && a.parent().is(".imageWidget") && (a = a.parent());
	return a
};NEEImage.prototype.getCorrectElementForDrop = function(a) {
	return this.getCorrectElementForMove(a)
};NEEImage.prototype.getCorrectElementForDelete = function(a) {
	return this.getCorrectElementForMove(a)
};NEEImage.prototype.getCorrectElementForCopy = function(a) {
	return this.getCorrectElementForMove(a)
};NEEImage.prototype.getCorrectElementForMove = function(a) {
	null == a && (a = this.element);
	$(a).parent().is("a") && (0 == $(a).parent().getTextNodes().length && $(a).is(":only-child")) && (a = $(a).parent());
	if ($(a).is(":only-child")) {
		var e = !1;
		do $(a).parent().is("strong") || $(a).parent().is("u") || $(a).parent().is("font") || $(a).parent().is("em") || $(a).parent().is(".borderEffect") ? a = $(a).parent() : e = !0,
		$(a).is(":only-child") || (e = !0);
		while (!e);
		return a
	}
	return $(a)
};NEEImage.prototype.getElementTagsSelectors = function() {
	return "IMG, DIV.imageWidget"
};NEEImage.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorImageSelected")
};NEEImage.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorImageSelected"), this.disableEditInline())
};NEEImage.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this._isImageWithPlaceholder() && (d.useSelectionOverlay = !1);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEImage.prototype.disableEditInline = function() {};NEEImage.prototype.clone = function(a) {
	return new NEEImage(a)
};NEEImage.prototype.docReady = function() {};NEEImage.prototype._getLink = function() {
	return $($.dmx.current.element).closest("a")
};NEEImage.prototype.editorReady = function(a) {
	var e = $.dmx.current.element.find("img").attr("src");
	if (e === this._defaultImageSrcUrl || e === this._defaultLogoSrcUrl) this.isAfterInsert = !0;
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.getTabs(),
		initTab: 0
	})
};NEEImage.prototype.getTabs = function() {
	var a = this;
	return {
		type: [{
			url: this.getGeneralTabMarkupUrl(),
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				a.onTabReadyGeneralNew(e);
				if (a.onTabChange) a.onTabChange()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				$.dmfw.isPT() ? $(e).neePtSecondaryDesignTabs({
					tabs: {
						tab_colors: ["border"],
						tab_effects: ["eff_shadow", "eff_rounded_corners"]
					}
				}) : $(e).neeSecondaryDesignTabs({
					tabs: {
						color: ["border"],
						shape: []
					}
				});
				if (a.onTabChange) a.onTabChange()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				$(e).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					},
					paddingElement: null
				});
				if (a.onTabChange) a.onTabChange()
			}
		}]
	}
};NEEImage.prototype.onEditorClose = function() {};NEEImage.prototype._linkTabReady = function(a, e) {
	var d = $($.dmx.current.element).closest("a");
	if (!d || 0 >= d.length) $.dmBlockUI(),
	$.dmops.surroundCurrentWithLink(function(d) {
		a.openLinkEditor(e, d);
		$.dmUnblockUI()
	});
	else {
		var g = $(d).attr("href"); ! g || 0 >= g.length ? ($.dmPreviewSaving(), $.dmops.populateEmptyLink(d,
		function() {
			a.openLinkEditor(e, d);
			$.dmPreviewSaved()
		})) : a.openLinkEditor(e, d)
	}
};NEEImage.prototype.openLinkEditor = function(a, e) {
	var d = {};
	d.element = $(e);
	this.linkEditor = $(a.find("#linkPanelEditorWrapper")).neeLinksWidget({
		current: d,
		editable: $.dmfw.editables("link"),
		noTextToDisplay: !0,
		noSurroundButton: !0,
		noRemoveLink: !0
	})
};NEEImage.prototype.afterInsert = function() {
	NEFW.PREVIEW.get(0).contentWindow.styleImages()
};NEEImage.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustX: 4
		},
		e = $.dmx.current.element.attr("src");
		e && -1 < e.indexOf("clickToEditPicture.png") ? $.dmfw.showPromptError($("#headerLogoChange"), dmStr["ui.nee.promptMassages.20"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};NEEImage.prototype.handlePlaceHolder = function(a) {
	var e, d;
	a.setPlaceholder("imagePlaceholder", "dm-icon-w_paragraph",
	function(a) {
		e = $.dmx.current;
		d = e.editable.inlineEditor.editorUtils.controls; - 1 < a.className.indexOf("import") ? d.edit.handler(e.element, e.element) : -1 < a.className.indexOf("delete") && d.remove.handler(e.element)
	},
	{})
};NEEImage.prototype.getGeneralTabMarkupUrl = function() {
	return "/editor/nee/editableObjects/header/nee.header.jsp"
}; (function(a) {
	var e;
	a.fn.neeIconsWidget = function(d) {
		function g(a) {
			a = parseInt(a, 10);
			if (isNaN(a)) return "00";
			a = Math.max(0, Math.min(a, 255));
			return "0123456789ABCDEF".charAt((a - a % 16) / 16) + "0123456789ABCDEF".charAt(a % 16)
		}
		_getImageColor = function(a, d) {
			var e = new Image;
			e.onload = function() {
				var a;
				try {
					var j = document.createElement("canvas");
					j.width = e.width;
					j.height = e.height;
					var k = j.getContext("2d");
					k.drawImage(e, 0, 0);
					for (var l = k.getImageData(0, 0, j.width, j.height), j = 3; j < l.data.length; j += 4) if (210 < l.data[j]) {
						var m = l.data[j - 2],
						n = l.data[j - 1];
						a = g(l.data[j - 3]) + g(m) + g(n);
						break
					}
				} catch(o) {}
				d && (a ? d(a) : d(g(0) + g(0) + g(0)))
			};
			e.src = a
		};
		var j = function(d) {
			a("#contentHeader .breadcrumb-part:not(.arrow)").animate({
				opacity: "0"
			},
			"slow",
			function() {
				a.dmfw.setEditorBreadcrumb();
				a.dmfw.setEditorBreadcrumb({
					parts: [{
						click: function() {
							a.navigationUtil.restoreNavLinksUI(d.elementID)
						}
					},
					{
						title: d.itemTitle
					}]
				});
				a("#contentHeader .breadcrumb-part:not(.arrow)").css("opacity", "0");
				a("#contentHeader .breadcrumb-part:not(.arrow)").animate({
					opacity: "1"
				},
				"slow")
			})
		},
		k = function() {
			var d = a("\x3cdiv class\x3d'cl'\x3e\x3c/div\x3e;");
			a(this).find(".IconSelection").after(d);
			var g = e.wholeData.parentType,
			k;
			if (g) {
				k = filteredParent = g.filter(function(a) {
					return a && !a.deleted
				});
				if (filteredParent.length > a.dmx.site.siteSettings.visibleNavigationItems + 1) {
					k = [];
					for (g = 0; g < filteredParent.length; g++) g == a.dmx.site.siteSettings.visibleNavigationItems && k.push(a.dmx.getStaticNav()[0]),
					k.push(filteredParent[g]);
					k.push(a.dmx.getStaticNav()[1])
				}
				a.dmLoad(d, "/editor/nee/editableObjects/navigation/nee.navigation.nextPrevTab.jsp",
				function() {
					a(".nextPrevWrapper .prevDiv").unbind("click").click(function() {
						for (var d = 1; d < k.length; d++) if (k[d] == e.wholeData) {
							a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink("stop");
							e.wholeData = k[d - 1];
							"dmMore" == e.wholeData.elementID && (NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.fullCollapseNavigation(), a.dmops.redrawSelection());
							a.navigationUtil.selectNavigationItem(e.wholeData.elementID);
							j(e.wholeData);
							a(".nextPrevWrapper .nextDiv").removeClass("noLink");
							1 == d && a(".nextPrevWrapper .prevDiv").addClass("noLink");
							a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink({
								fadeIn: 500,
								fadeOut: 500
							}).one("mouseover",
							function() {
								a(this).blink("stop")
							});
							setTimeout(function() {
								a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink("stop")
							},
							1E3);
							break
						}
					});
					a(".nextPrevWrapper .nextDiv").unbind("click").click(function() {
						for (var d = 0; d < k.length - 1; d++) if (k[d] == e.wholeData) {
							a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink("stop");
							"dmMore" == e.wholeData.elementID && (NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.expandNavigation(), a.dmx.current.editable.inlineEditor.draw());
							e.wholeData = k[d + 1];
							a.navigationUtil.selectNavigationItem(e.wholeData.elementID);
							j(e.wholeData);
							a(".nextPrevWrapper .prevDiv").removeClass("noLink");
							d == k.length - 2 && a(".nextPrevWrapper .nextDiv").addClass("noLink");
							a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink({
								fadeIn: 500,
								fadeOut: 500
							}).one("mouseover",
							function() {
								a(this).blink("stop")
							});
							setTimeout(function() {
								a(a.dmfw.getPreviewElement("#" + e.wholeData.elementID + ":not(.hiddenNavPlaceHolder *)").find(".navIcon:first")).blink("stop")
							},
							1E3);
							break
						}
					});
					k[0] == e.wholeData && a(".nextPrevWrapper .prevDiv").addClass("noLink");
					k[k.length - 1] == e.wholeData && a(".nextPrevWrapper .nextDiv").addClass("noLink")
				})
			}
		},
		l = function(d, g, j, k) {
			a.dmops.handleNavIcon(d, g, j, e.wholeData, k)
		};
		e = d = a.extend({
			markupUrl: "/editor/nee/editableObjects/navigation/nee.iconEditor.htm"
		},
		d);
		var m = this,
		n = d.wholeData;
		m.data("selected", {});
		m.data("selected").iconUrl = n.linkDesign.itemIcon;
		m.data("selected").iconColor = n.linkDesign.navColor;
		m.data("settings", d);
		a.dmLoad(m, d.markupUrl,
		function() {
			m.show();
			var d = m.find(".iconPicker"),
			g = a.isIconClass(m.data("selected").iconUrl) ? m.data("selected").iconColor: null;
			a.getImageColor(m.data("selected").iconUrl,
			function(j) {
				d.neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					},
					callback: l,
					color: g || "#" + j,
					icon: m.data("selected").iconUrl,
					selectedIcon: m.data("selected").iconUrl,
					useFontIcon: !0,
					specificIconSelector: function() {
						return null == e ? null: "#" + e.wholeData.elementID + " .navIcon:first"
					},
					callBackOnIconGallery: a.proxy(k, m)
				});
				d.css("display", "block")
			})
		})
	}
})(jQuery); (function(a) {
	a.fn.neeNavLinkColor = function(e) {
		_changeImage = function(d, e) {
			a.dmops.updateGlobalCssAndElement({
				attrToAdd: [{
					attr: "background-image",
					value: "url(" + d + ")"
				}]
			},
			{
				className: e,
				clientOnly: !1
			})
		};
		e = a.extend({
			markupUrl: "/editor/nee/editableObjects/navigation/nee.linkColorEditor.jsp"
		},
		e);
		var d = this,
		g = e.wholeData;
		d.data("selected", {});
		d.data("selected").iconUrl = g.linkDesign.itemIcon;
		d.data("settings", e);
		a.dmLoad(d, e.markupUrl,
		function() {
			d.show();
			var e = d.find(".slideRightPanelInner:first"),
			g = d.data("settings").wholeData.elementID,
			l = a.dmx.current.element.find("#" + g);
			0 == l.length && (l = a(a.dmfw.getPreviewElement("#" + g)));
			a: {
				g = l;
				if (0 < g.length && (g = g.is("a") ? g: g.find("a:first"))) for (var g = (g = g.attr("class")) ? g.split(" ") : [], m = 0; m < g.length; m++) if ( - 1 != g[m].indexOf("dmUDNavigationItem") || "dmHome" == g[m]) {
					g = g[m];
					break a
				}
				g = void 0
			}
			var n = "dmHome" != g ? "*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a." + g: "#dm *.navPlaceHolder a.dmHome.backToHome",
			g = [{
				id: "background",
				name: dmStr["ui.background"],
				attr: "background-color",
				attrToRemove: "background-image",
				attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
				tagName: "A",
				selector: null,
				forceClassName: n,
				additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
				additionalWidgetInit: function(d) {
					d && e.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
						elem: a(a.dmfw.getPreviewElement(n)),
						forceClassName: n,
						callback: function(a) {
							_changeImage(a, n)
						},
						changeGlobally: !0
					})
				}
			},
			{
				id: "text",
				name: dmStr["ui.text"],
				attr: "color",
				attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
				tagName: "A",
				selector: "div",
				forceClassName: "dmHome" != g ? "*.navPlaceHolder UL.dmNav.dmNavCustom li\x3e a." + g + " DIV.navText": "#dm *.navPlaceHolder a.dmHome.backToHome SPAN.text"
			}];
			e.neeSecondaryColorTab(g, {
				previewElementToWorkOn: l,
				changeGlobally: !0
			});
			e.css("display", "block")
		})
	}
})(jQuery); (function(a) {
	var e = ["mobile", "desktop", "tablet"];
	a.fn.initMenuAlignButtons = function() {
		var d = a(this),
		e = a(a.dmfw.getPreviewElement(".expandableParent").get(0));
		if (0 < e.size()) {
			var j = d.find(".alignBtns");
			j.find(".alignLeftBtn").toggleClass("alignLeftBtnSelect", e.hasClass("alignLeft")).unbind("click").click(function() {
				a(this).is("alignLeftBtnSelect") || (j.find("span").removeClass("alignLeftBtnSelect").removeClass("alignRightBtnSelect").removeClass("alignCenterBtnSelect"), a(this).addClass("alignLeftBtnSelect"), k("left", "alignLeft"))
			});
			j.find(".alignRightBtn").toggleClass("alignRightBtnSelect", e.hasClass("alignRight")).unbind("click").click(function() {
				a(this).is("alignRightBtnSelect") || (j.find("span").removeClass("alignLeftBtnSelect").removeClass("alignRightBtnSelect").removeClass("alignCenterBtnSelect"), a(this).addClass("alignRightBtnSelect"), k("right", "alignRight"))
			});
			j.find(".alignCenterBtn").toggleClass("alignCenterBtnSelect", e.hasClass("alignMiddle")).unbind("click").click(function() {
				a(this).is("alignCenterBtnSelect") || (j.find("span").removeClass("alignLeftBtnSelect").removeClass("alignRightBtnSelect").removeClass("alignCenterBtnSelect"), a(this).addClass("alignCenterBtnSelect"), k("center", "alignMiddle"))
			})
		}
		var k = function(d, j) {
			e.removeClass("alignLeft").removeClass("alignRight").removeClass("alignMiddle");
			e.addClass(j);
			a.navigationUtil.postSet("exp_align", d,
			function() {})
		}
	};
	a.fn.expandableNavigationShape = function() {
		var d = a(this);
		d.empty();
		a.dmLoad(d, "/editor/nee/editableObjects/navigation/nee.expandableNavigationShape.htm",
		function() {})
	};
	a.fn.expandableNavigationAlignment = function() {
		var d = a(this);
		d.empty();
		a.dmLoad(d, "/editor/nee/editableObjects/navigation/nee.expandableNavigationAlignment.jsp",
		function() {
			a("#alignmentSettings .editContentBtnItem.alignButton").initMenuAlignButtons();
			var e = a(a.dmfw.getPreviewElement(".expandableParent").get(0)),
			j = function(j, k, l, m) {
				d.find(j).onOffBtn({
					initState: !e.hasClass(k),
					offFn: function() {
						e.removeClass(l);
						e.addClass(k);
						a.navigationUtil.postSet(m, "true",
						function() {})
					},
					onFn: function() {
						e.addClass(l);
						e.removeClass(k);
						a.navigationUtil.postSet(m, "false",
						function() {})
					}
				})
			};
			j("#paddingFromHeader", "noPaddingTop", "paddingTop", "exp_npt");
			j("#paddingFromSides", "noPaddingSide", "paddingSide", "exp_nps");
			j("#showMenuIcon", "hideMenuIcon", "showMenuIcon", "exp_hmi");
			j("#showMenuArrow", "hideMenuArrow", "showMenuArrow", "exp_hma");
			var k = a("#expandableMenuBtnTitle"),
			l = e.find("#expandableButtonInPage"),
			m = l.find(".expandableBtnText"),
			n = function(d) {
				d = a(d);
				d = (d.val() ? d.val() : "").trim();
				m.text(d);
				l.toggleClass("expandableButtonNoText", "" == d);
				k.val(d);
				a.navigationUtil.postSet("exp_btn_mnutitle", d,
				function() {})
			},
			o = m.text();
			k.val(o);
			k.blur(function() {
				n(this, o)
			}).keypress(function(a) {
				13 == a.keyCode && n(this, o)
			})
		})
	};
	a.extend({
		navigationUtil: {
			setNavigationEmptyBreadCrumb: function() {
				var d = this.getFirstBreadCrumbText();
				a.dmfw.setEditorBreadcrumb(null);
				a("#contentTitle.breadcrumb-first").text(d)
			},
			addToNavigation: function(d, e, j) {
				_allowCreateNewPageFromNavigation && (_allowCreateNewPageFromNavigation = !1, setTimeout(function() {
					_allowCreateNewPageFromNavigation = !0
				},
				600), a.dmUIBlockControlled({
					region: "navigation.addNew",
					op: "block",
					style: "wheel"
				}), a.dmsrv.postToServ(function() {
					a.dmsrv.addToNav(a.dmx.page.id, d, e, null,
					function(k) {
						var l = a.dmfw.editables("navigation");
						a.dmPreviewSaving();
						a(k.markup);
						var m = a("\x3cul\x3e\x3c/ul\x3e").append(k.markup);
						if (j) {
							var n = a.dmfw.finalyzeRuntimeUrl("/site/" + a.dmx.site.alias + "/home");
							m.find("a:first").attr("href", n);
							m.find("a:first").attr("raw_url", a.dmx.site.baseUrl)
						}
						_expandCollapse(!0);
						a(a.dmfw.getPreviewElement("#hiddenNavPlaceHolder #dmNav:first")).append(m.html());
						a(a.dmfw.getPreviewElement("#newNavigationElementPlaceHolder #dmNav:first")).append(m.html());
						a(a.dmfw.getPreviewElement("#expandableMainDiv #dmNav:first")).append(m.html());
						_expandCollapse(!1);
						_expandCollapse(!0);
						a.refreshLayoutNavigations();
						m = a.dmfw.getPreviewElement(k.id).find("a:first");
						m = {
							deleted: !1,
							depth: 0,
							elementID: k.id,
							inNavigationList: !0,
							itemTitle: d || dmStr["ui.nee.navigation.newItemTitle"],
							itemUrl: e || a.dmx.site.baseUrl,
							linkDesign: {
								backgroundCSS: [],
								backgroundColor: m.css("background-color"),
								iconImageName: "",
								itemClassName: k.id.replace("dm_navGroup", "dmUDNavigationItem_").replace("_item", ""),
								itemIcon: m.find(".navIcon").css("background-image")
							},
							pageAlias: HOME_PAGE_DESIGN_ALIAS,
							pageFromScratch: !1,
							pageID: a.dmx.homePage.id,
							subNav: []
						};
						a.dmx.getSiteNav().push(m);
						m = a("#navEditorInnerPanel");
						m.empty();
						a.dmLoad(m, "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
						function() {
							a.dmPreviewSaved();
							l.navigationLinksTabReady(k.id, !1, !0, j)
						});
						_allowCreateNewPageFromNavigation = !0;
						a.dmUIBlockControlled({
							region: "navigation.addNew",
							op: "unblock"
						})
					})
				}))
			},
			postSettings: function(d, e, j, k) {
				a.dmPostWithHistory({
					url: "/pages/" + d + "/changeNavSettings?settingName\x3d" + e + "\x26settingValueBoolean\x3d" + j,
					data: {},
					success: function(a) {
						k && k(a)
					}
				})
			},
			postSettingsInt: function(d, e, j, k) {
				d = "/pages/" + d + "/changeNavSettings?settingName\x3d" + e + "\x26settingValueInt\x3d" + j;
				"number" === typeof k && (d += "\x26deviceId\x3d" + k);
				a.dmPostWithHistory({
					url: d,
					data: {},
					success: function() {}
				})
			},
			rgbToHex: function(d, e, j) {
				return a.navigationUtil.toHex(d) + a.navigationUtil.toHex(e) + a.navigationUtil.toHex(j)
			},
			toHex: function(a) {
				a = parseInt(a, 10);
				if (isNaN(a)) return "00";
				a = Math.max(0, Math.min(a, 255));
				return "0123456789ABCDEF".charAt((a - a % 16) / 16) + "0123456789ABCDEF".charAt(a % 16)
			},
			restoreNavLinksUI: function(d) {
				var e = a(".rightPanel"),
				j = a.dmfw.editables("navigation");
				e.empty();
				a.dmfw.setEditorBreadcrumb(null);
				a("#contentTitle.breadcrumb-first").text(a.navigationUtil.isNavigationExpandable() ? dmStr["ui.nee.navigation.1"] : dmStr["ui.nee.navigation.2"]);
				a.navigationUtil.selectNavigationItem(null);
				a.dmfw.changeTabTo(a(".slideBtnSelected").index(),
				function() {
					j.navigationLinksTabReady(d, !1, !0)
				},
				!0)
			},
			changePreviewTextGlobally: function(d, e) {
				var j = a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a");
				e ? j.css("color", "") : j.css("color", d)
			},
			changePreviewBackgroundGlobally: function(d, e) {
				var j = a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a");
				e ? j.css("background-color", "") : j.css("background-color", d);
				j.each(function(d) {
					_bgOldStyles[d] = a(this).attr("style") ? a(this).attr("style") : ""
				})
			},
			ruleValidator: function(a) {
				return - 1 != a.toLowerCase().indexOf("dmudnavigationitem") && -1 == a.toLowerCase().indexOf("div.navicon")
			},
			changeBackgroundGlobally: function(d, e) {
				e = e || "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a";
				a.dmfw.getPreviewElement(e).css("background-color", "");
				NEFW.PREVIEW.get(0).contentWindow.removeCssAttributes("", ["background-color"], a.navigationUtil.ruleValidator);
				NEFW.PREVIEW.get(0).contentWindow.updateCss(e, "background-color: " + d, [{
					key: "background-color",
					value: d
				}]);
				var j = {};
				j.globalClassName = e;
				j.attributesToOverrideFromSpecific = ["background-color"];
				j.attributesToChange = {
					"background-color": d
				};
				var k = "/sites/assignglobalandoverride/" + a.dmx.page.id;
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: k,
						data: j,
						success: function() {
							a.dmNotify("Background color changed")
						}
					})
				})
			},
			changeNavBGImageGlobally: function(d, e) {
				a.dmops.updateGlobalCssAndElement({
					classesToRemove: null,
					attrToRemove: null,
					classesToAdd: null,
					attrToAdd: [{
						attr: "background-image",
						value: "url(" + d + ")"
					}]
				},
				{
					className: e,
					clientOnly: !1
				})
			},
			changeLayoutTextGlobally: function(d, e) {
				a.navigationUtil.changeColorsGlobally("color", d, e)
			},
			changeBackgroundColorGloballyNav: function(d, e) {
				a.navigationUtil.changeColorsGlobally("background-color", d, e)
			},
			changeColorsGlobally: function(d, e, j) {
				a.dmops.updateGlobalCssAndElement({
					classesToRemove: null,
					attrToRemove: null,
					classesToAdd: null,
					attrToAdd: [{
						attr: d,
						value: e
					}]
				},
				{
					className: j,
					clientOnly: !1
				})
			},
			changeNavBackgroundImageGlobally: function(d) {
				a.navigationUtil.changeNavBGImageGlobally(d, "*.navPlaceHolder UL.dmNav")
			},
			changeNavBackgroundPreviewGlobally: function() {
				var d = a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a");
				canceled ? d.css("background-color", "") : d.css("background-color", color)
			},
			changeNavIconsColor: function(d) {
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: "/pages/" + a.dmx.page.id + "/changeNavIconsColor",
						data: {
							value: d
						},
						success: function(d) {
							a.navigationUtil.onIconChangeDataReturn(d, !0)
						}
					})
				})
			},
			changeBGImageGlobally: function(d, e) {
				e = e || "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a";
				var j = "url(" + d + ")";
				NEFW.PREVIEW.get(0).contentWindow.removeCssAttributes("", ["background-image"], a.navigationUtil.ruleValidator);
				NEFW.PREVIEW.get(0).contentWindow.updateCss(e, "background-image: " + j, [{
					key: "background-image",
					value: j
				}]);
				var k = {};
				k.globalClassName = e;
				k.attributesToOverrideFromSpecific = ["background-image"];
				k.attributesToChange = {
					"background-image": j
				};
				var l = "/sites/assignglobalandoverride/" + a.dmx.page.id;
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: l,
						data: k,
						success: function() {
							a.dmNotify("Background image changed")
						}
					})
				})
			},
			changeBackgroundImageGlobally: function(d, e) {
				a.navigationUtil.changeBGImageGlobally(d, e || "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a")
			},
			getBackgroundImageGlobalChanger: function(d) {
				return function(e) {
					a.navigationUtil.changeBGImageGlobally(e, d)
				}
			},
			getBackgroundColorGlobalChanger: function(d) {
				return function(e) {
					a.navigationUtil.changeBackgroundGlobally(e, d)
				}
			},
			getColorGlobalChanger: function(d) {
				return function(e) {
					a.navigationUtil.changeLayoutTextGlobally(e, d)
				}
			},
			getGlobalChanger: function(d, e) {
				return function(j) {
					a.navigationUtil.changeColorsGlobally(d, j, e)
				}
			},
			changeTextGlobally: function(d) {
				a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText").css("color", "");
				NEFW.PREVIEW.get(0).contentWindow.removeCssAttributes("", ["color"], a.navigationUtil.ruleValidator);
				NEFW.PREVIEW.get(0).contentWindow.updateCss("*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText", "color: " + d, [{
					key: "color",
					value: d
				}]);
				var e = {
					globalClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
					attributesToOverrideFromSpecific: ["color"]
				};
				e.attributesToChange = {
					color: d
				};
				var j = "/sites/assignglobalandoverride/" + a.dmx.page.id;
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: j,
						data: e,
						success: function() {}
					})
				})
			},
			getActualCurNavShape: function() {
				a.layoutNav || a.navigationUtil.initLayoutNavObject();
				var d = "default";
				a.layoutNav.isLayout ? a.layoutNav.footerBar ? d = "l_fixheadfixfootslideup": a.layoutNav.topBar ? d = "l_fixheaduppertabs": a.layoutNav.expandable ? d = "l_standardlayout": a.layoutNav.matrix ? d = "l_matrixlayout": a.layoutNav.list && (d = "l_insidelist") : (d = a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav").get(0)), d = d.css("shapename") || d.attr("shape_class") || "default");
				return d
			},
			getCurNavShape: function() {
				return a(a.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav").get(0)).attr("shape_class") || "default"
			},
			getShapeRestrictions: function() {
				return {
					halfNav: ["rounded"],
					matrix: ["rounded", "arrows"],
					bordersNav: ["rounded", "shadow", "icons"],
					twoColumnsIcon: ["arrows"],
					horizontalNav: ["arrows", "rounded", "shadow", "icons"],
					roundedContainer: ["rounded", "shadow", "icons"],
					l_matrixlayout: ["arrows", "rounded", "shadow"],
					l_insidelist: ["rounded", "shadow", "rounded"],
					l_fixheadfixfootslideup: ["arrows", "rounded", "shadow"]
				}
			},
			getShapeColorRestrictions: function() {
				return {
					halfNav: ["arrows"],
					matrix: ["arrows"],
					bordersNav: ["icons"],
					twoColumnsIcon: ["arrows"],
					horizontalNav: ["arrows", "icons"],
					roundedContainer: ["icons"],
					l_matrixlayout: ["arrows"],
					l_standardlayout: ["arrows", "icons"],
					l_fixheadfixfootslideup: ["arrows", "border"],
					l_fixheaduppertabs: ["arrows", "border", "icons"]
				}
			},
			getVariationsColorRestrictions: function() {
				return {
					arrows: 0 < a.dmfw.getPreviewElement(".insideList-var1, .insideList-var2, .insideList-var4,.insideList-var3, .insideList-var5").size(),
					icons: 0 < a.dmfw.getPreviewElement(".insideList-var3, .insideList-var5").size(),
					bgcolor: 0 < a.dmfw.getPreviewElement(".standard-var4, .standard-var3, .dmUpperTabs-var3").size()
				}
			},
			clearNavShape: function(d) {
				if (d) {
					d.each(function() {
						var d = a(this).attr("shape_class");
						d && a(this).removeClass(d)
					});
					for (var e = ["navSquareCorners", "navNoArrows", "navNoIcons", "navNoText"], j = 0; j < e.length; j++) d.removeClass(e[j]);
					d.attr("shape_class", "default");
					d.addClass("default")
				}
			},
			openNavEditorOnDesign: function() {
				a.dmfw.openEditor(a.dmx.current.editable, a.dmx.current.element, {
					openAdvanced: !0
				},
				{
					forceOpen: !0
				})
			},
			openNavEditorOnSpacing: function() {
				a.dmfw.openEditor(a.dmx.current.editable, a.dmx.current.element, {
					openAdvanced: !0,
					initTab: 1
				},
				{
					forceOpen: !0
				})
			},
			postSet: function(d, e, j) {
				var k = "/pages/" + a.dmx.page.id + "/changeNavDisplaySettings";
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: k,
						data: {
							attr: d,
							val: e
						},
						success: function(d) {
							j ? j(d) : a.dmfw.refreshPreview(function() {
								a.navigationUtil.openNavigationEditor("", 1)
							})
						}
					})
				})
			},
			initLayoutNavObject: function() {
				var d = a.dmfw.getPreviewElement("#innerBar");
				if (a.dmx.site.isUsingLayout) {
					var e = 0 < a.dmfw.getPreviewElement("#fixFoot").size(),
					j = 0 < a.dmfw.getPreviewElement("#upperTabs").size();
					a.layoutNav = {
						innerBarVisible: 0 < d.size() && d.is(":visible"),
						footerBar: e,
						topBar: j,
						innerBar: 0 < d.size(),
						expandable: 0 == d.size() && 0 < a.dmfw.getPreviewElement("#slideDownNav").size() && !e && !j,
						isLayout: !0,
						matrix: 0 < a.dmfw.getPreviewElement(".hasDmMatrixNav").size(),
						list: 0 < a.dmfw.getPreviewElement(".hasDmInsideListNav").size()
					};
					a.layoutNav.restrictions = {
						noMoreButton: a.layoutNav.expandable,
						noLessButton: a.layoutNav.footerBar || a.layoutNav.topBar || a.layoutNav.expandable,
						noIconButton: a.layoutNav.topBar || a.layoutNav.expandable,
						noColorButton: a.layoutNav.footerBar || a.layoutNav.topBar || a.layoutNav.expandable,
						noBackToHome: a.layoutNav.isLayout,
						hideEffectsTab: a.layoutNav.topBar || a.layoutNav.expandable,
						hideIconEffectIfNoIcons: a.layoutNav.list || a.layoutNav.matrix,
						noHoverCurrent: a.layoutNav.footerBar || a.layoutNav.topBar || a.layoutNav.expandable,
						specialNavigations: a.layoutNav.footerBar || a.layoutNav.topBar || a.layoutNav.expandable
					}
				} else a.layoutNav = {},
				a.layoutNav.restrictions = {}
			},
			initNavEditor: function(d) {
				a.dmx.current.element = a(a.dmfw.getPreviewElement(d.getElementTagsSelectors()).get(0));
				d.isExpandable = d.isExpandable || a(a.dmfw.getPreviewElement(d.getElementTagsSelectors()).get(0)).is(".expandableNavigationContainer, .expandableParent");
				var e = a.dmfw.getPreviewElement("#innerBar");
				a.navigationUtil.initLayoutNavObject();
				d.isLayoutInside = a.dmx.site.isUsingLayout && 0 < e.size();
				d.isLayoutOutside = a.dmx.site.isUsingLayout && 0 == e.size();
				d.doesntHaveNavigationInside = this.isLayoutInside && e.is(":visible");
				d.forceElement = this.isExpandable
			},
			isNavigationExpandable: function(d) {
				null == d && (d = a.dmx.current.element);
				return a(d).is(".newNavigationSubNavPlaceHolder.expandableParent, #expandableNavigationContainer")
			},
			openNavigationEditor: function(d, e) {
				d || (d = "");
				a.navigationUtil.openNavigationEditorInt(d, e)
			},
			selectCorrectNavigationElementInPreview: function() {
				return a.dmfw.editables("navigation").getCorrectNavigationElementInPreview()
			},
			openNavigationEditorInt: function(d, e) {
				var j = a.navigationUtil.selectCorrectNavigationElementInPreview();
				a.dmfw.selectAndOpenEditor(j, !0, {
					itemId: d,
					initTab: e || 0
				});
				setTimeout("$.dmops.redrawSelection();", 750)
			},
			newNavIdChosen: function(d, e) {
				if (d && d[0]) {
					var j = "/pages/" + a.dmx.page.id + "/setNewNav";
					a.dmBlockUI();
					a.dmsrv.postToServ(function() {
						a.dmPostWithHistory({
							url: j,
							data: d[0],
							success: function() {
								a.dmfw.refreshPreview(e ? null: function() {
									a.navigationUtil.openNavigationEditor();
									a.dmops.updateEditContext.all({
										success: function() {}
									})
								})
							}
						})
					})
				}
			},
			onSelectNavigationInit: function(d) {
				if (d && 0 < d.size()) {
					var e = a.dmfw.getPreviewElement("#hiddenNavPlaceHolder .dmNav:first").attr("dmle_original_nav_id");
					d.attr("src", "/editor/nee/WebpageLoaderServlet?scope\x3dnav\x26site\x3d" + a.dmx.site.id + "\x26nav_id\x3d" + e)
				}
			},
			initNavSelectWindow: function() {
				a.dmx.site.isFromScratch || (a(".navigationUpdateDiv").unbind("click").click(function() {
					var d = window.frames[window.frames.length - 1].jQuery.WebpageDesign.getHeaderIds();
					a(".closeThis").trigger("click");
					a("#selectNavigationWindow").empty();
					a.navigationUtil.newNavIdChosen(d)
				}), a(".navigationCancelDiv").unbind("click").click(function() {
					window.frames[window.frames.length - 1].jQuery.WebpageDesign.removeAllSelected()
				}), a("#selectNavigationWindow").empty(), a.navigationUtil.onSelectNavigationInit(a("#selectNavigationWindow")))
			},
			deleteSubNav: function() {},
			selectNavigationItem: function(d, e) {
				a.dmfw.getPreviewElement(".highlightedNavItem").removeClass("highlightedNavItem");
				"YAHOO" == a.dmx.site.dmProductType ? a.dmfw.getPreviewElement(".yahooHoveredNavItem").removeClass("yahooHoveredNavItem") : a.dmfw.getPreviewElement(".hoveredNavItem").removeClass("hoveredNavItem");
				d && (e || a.dmfw.preview.removeEditableBar({
					skipCloseEditor: !0
				}), a.layoutNav.restrictions.noHoverCurrent || a.dmfw.getPreviewElement("#" + d).find("a:first").addClass("highlightedNavItem"), 0 == a.dmfw.getPreviewElement("#" + d + ":not(.hiddenNavPlaceHolder *)").css("opacity") && (NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.expandNavigation(), a.dmx.current.editable.inlineEditor.draw()))
			},
			changeExpandableMenuForegroundColor: function(d) {
				var e = "/sites/changecolorglobally/" + a.dmx.page.id,
				j = a.dmfw.getPreviewElement("UL.dmExpandableNav DIV.navArrow").css("background-image"),
				k = a.dmfw.getPreviewElement("DIV.expandableInnerContainer A#returnToMenuButtonElement").css("background-image") ? a.dmfw.getPreviewElement("DIV.expandableInnerContainer A#returnToMenuButtonElement").css("background-image") : "/editor/nee/images/arrowBlackLeft.png",
				l = a.dmfw.getPreviewElement("A.dmExpandableBackToHome").css("background-image") ? a.dmfw.getPreviewElement("A.dmExpandableBackToHome").css("background-image") : "/editor/nee/images/backToHome.png",
				m = [{
					icon: !0,
					selector: "UL.dmExpandableNav DIV.navArrow",
					image: j,
					color: d,
					attribute: null
				},
				{
					icon: !0,
					selector: "DIV.expandableInnerContainer A#returnToMenuButtonElement",
					image: k,
					color: d,
					attribute: null
				},
				{
					icon: !0,
					selector: "A.dmExpandableBackToHome",
					image: l,
					color: d,
					attribute: null
				},
				{
					icon: !1,
					selector: "#dm DIV.expandableInnerMostContainer a",
					color: d,
					attribute: "color"
				}];
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: e,
						data: m,
						success: function(e) {
							a.dmfw.getPreviewElement("#dm DIV.expandableInnerMostContainer a").css("color", d);
							a.navigationUtil.onIconChangeDataReturn(e)
						}
					})
				})
			},
			changePreviewExpandableMenuForegroundColor: function(d, e) {
				a.dmfw.getPreviewElement("#dm DIV.expandableInnerMostContainer a").css("color", e ? "": d)
			},
			changeExpandableButtonForegroundColor: function(d) {
				var e = "/sites/changecolorglobally/" + a.dmx.page.id,
				j = a.dmfw.getPreviewElement("SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnIcon").css("background-image"),
				k = a.dmfw.getPreviewElement("DIV.expandableParentMenuOpen SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow").css("background-image") ? a.dmfw.getPreviewElement("DIV.expandableParentMenuOpen SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow").css("background-image") : "/editor/nee/images/OpenMenuBtnArrow.png",
				l = a.dmfw.getPreviewElement("DIV.expandableParentMenuClose SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow").css("background-image") ? a.dmfw.getPreviewElement("DIV.expandableParentMenuClose SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow").css("background-image") : "/editor/nee/images/closeMenuBtnArrow.png",
				m = [{
					icon: !0,
					selector: "SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnIcon",
					image: j,
					color: d,
					attribute: null
				},
				{
					icon: !1,
					selector: "SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnText",
					color: d,
					attribute: "color"
				},
				{
					icon: !0,
					selector: "DIV.expandableParentMenuOpen SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow",
					image: k,
					color: d,
					attribute: null
				},
				{
					icon: !0,
					selector: "DIV.expandableParentMenuClose SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnArrow",
					image: l,
					color: d,
					attribute: null
				}];
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: e,
						data: m,
						success: function(e) {
							a.dmfw.getPreviewElement("SPAN#expandableButtonInPage.newMenuButton SPAN.expandableBtnText").css("color", d);
							a.navigationUtil.onIconChangeDataReturn(e)
						}
					})
				})
			},
			changePreviewExpandableButtonForegroundColor: function(d, e) {
				a.dmfw.getPreviewElement("SPAN#expandableButtonInPage.newMenuButton").css("color", e ? "": d)
			},
			onIconChangeDataReturn: function(d, e) {
				if (e) d && d.value && a.dmops.refreshGlobalCss(d.value, 3E3);
				else if (d && d.length) for (var j = 0; j < d.length; j++) {
					var k = d[j];
					if (k) {
						var l = k.globalClassName,
						k = k.attributesToChange;
						if (l && k && k["background-image"]) {
							var m = [],
							n = "";
							m.push({
								key: "background-image",
								value: k["background-image"]
							});
							n = n + "background-image: " + k["background-image"] + ";";
							NEFW.PREVIEW.get(0).contentWindow.updateCss(l, n, m)
						}
					}
				}
			},
			changeColorInPalette: function(d, e) {
				a.changePage({
					clientChange: function() {},
					serverChange: function() {
						a.dmPostWithHistory({
							url: "/sites/" + a.dmx.site.id + "/updatePalette/",
							data: {
								name: d,
								value: e
							},
							success: function(d) {
								_isColorChangedAndUpdateNav = !0;
								a.dmops.refreshGlobalCss(d.value, 3E3)
							}
						})
					}
				})
			},
			changeLayoutBackground: function(d) {
				a.navigationUtil.changeColorInPalette("footer-color", d)
			},
			changeLayoutActiveBackground: function(d) {
				a.navigationUtil.changeColorInPalette("nav-color", d)
			},
			changeLayoutExpText: function(d) {
				a.navigationUtil.changeColorInPalette("nav-text-color", d)
			},
			changeLayoutExpButtonBackground: function(d) {
				a.navigationUtil.changeColorInPalette("topBtn-color", d)
			},
			changeLayoutExpButtonText: function(d) {
				a.navigationUtil.changeColorsGlobally("background-color", d, "#fixHead #slideDownTrigger .btnStripe")
			},
			changeLayoutExpBackgroundImageGlobally: function(d) {
				a.navigationUtil.changeNavBGImageGlobally(d, "ul.dmNavigation")
			},
			changeNumberOfVisibleNavigationItems: function(d) {
				var g = NEFW.PREVIEW.get(0).contentWindow,
				j,
				k;
				a.dmfw.isDudaone() ? (j = a.onefw.device(), k = a.inArray(j, e), a.dmx.site.siteSettings.visibleNavItemsPerDevice[j] = d) : a.dmx.site.siteSettings.visibleNavigationItems = d;
				g.jQuery.DM.expandNavigation();
				g.setDMAjaxNavSize(d);
				g.jQuery.DM.restoreDefaultNavigationStyles();
				g.jQuery.DM.fullCollapseNavigation();
				a.dmops.redrawSelection();
				a.navigationUtil.postSettingsInt(a.dmx.page.id, "navigationVisibleItems", d, k)
			},
			overrideGlobalCss: function(d) {
				var e = "/sites/assignglobalandoverride/" + a.dmx.page.id;
				a.dmsrv.postToServ(function() {
					a.dmPostWithHistory({
						url: e,
						data: d.cssContext,
						success: function(e) {
							a.dmNotify("");
							d.callback && d.callback(e)
						}
					})
				})
			},
			changeNavDesign: function(d, e, j, k) {
				d = a.isArray(d) ? d: [d];
				var l = e ? {
					classesToAdd: d
				}: {
					classesToRemove: d
				};
				a.dmsrv.postToServ(function() {
					var m;
					a.dmPostWithHistory({
						url: "/pages/" + a.dmx.page.id + "/changeNavDesign",
						data: l,
						success: function() {
							e ? k.addClass(d.join(" ")) : k.removeClass(d.join(" "));
							m = j + " changed";
							a.dmNotify(m)
						}
					})
				})
			}
		}
	})
})(jQuery);_bgOldStyles = [];_textOldStyles = [];_allowCreateNewPageFromNavigation = !0;
var _isColorChangedAndUpdateNav = !1;
function NEENavigation() {
	this.title = function() {
		return this.isExpandable ? dmStr["ui.nee.navigation.1"] : dmStr["ui.nee.navigation.2"]
	};
	this.mindTouchId = "dmMtNavigation";
	this.showMindTouchHelp = !0;
	this.priority = 1;
	this.type = "navigation";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return $.dmx.current.element.hasClass("backToHomePlaceHolder") ? {
			editableDraggedImg: "/editor/nee/images/contentBtns/bthome.png",
			editableDraggedText: dmStr["ui.nee.widgets.25"]
		}: {
			editableDraggedImg: "/editor/nee/images/contentBtns/navigation.png",
			editableDraggedText: dmStr["ui.nee.navigation.2"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.navigation.2"],
		isExpandable: !1,
		isCollapsable: !1,
		isCopy: !1,
		hoverDisplayEditor: !1,
		isHideOnDevice: !1,
		useSelectionOverlay: !1
	};
	this.selectedLinkID = null;
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.defaultMarkup = function(a) {
		if (a) {
			if ("back to home" == a.specification) return "\x3cdiv class\x3d'backToHomePlaceHolder navPlaceHolder' dmle_dont_remove\x3d'true' dmle_nav_view\x3d'backToHome force'\x3e\x3c/div\x3e"
		} else return "\x3cdiv class\x3d'backToHomePlaceHolder navPlaceHolder' dmle_dont_remove\x3d'true' dmle_nav_view\x3d'backToHome force'\x3e\x3c/div\x3e"
	};
	this.addClearWidget = !0;
	this.getAdvancedButtonTabInfo = function() {};
	this.expandableTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
			text: dmStr["ui.nee.navigation.4"],
			imgSrc: "LinkImgIcon",
			onTabReady: function() {
				a.navigationLinksTabReady(a.selectedLinkID)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.setEditorBreadcrumb(null);
				$("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.1"]);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						expandable_menu_color: ["exp_nav_bg", "exp_nav_text"],
						expandable_button_color: ["exp_button_alignment", "exp_button_label", "exp_button_bg", "border"]
					},
					changeGlobally: !0,
					forceClassName: "SPAN#expandableButtonInPage.menuButtonElement"
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				$.dmfw.setEditorBreadcrumb(null);
				$("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.1"]);
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.ptExpandableTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				$.dmfw.setEditorBreadcrumb(null);
				$("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.1"]);
				$(e).neeSecondaryDesignTabs({
					tabs: {
						menu_items: [],
						expandable_menu_color: ["exp_nav_bg", "exp_nav_text"],
						expandable_button_color: ["exp_button_alignment", "exp_button_label", "exp_button_bg", "border"]
					},
					changeGlobally: !0,
					forceClassName: "SPAN#expandableButtonInPage.menuButtonElement",
					menuItemsCallback: function() {
						a.navigationLinksTabReady(a.selectedLinkID)
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationMoreSettings.jsp .editContentWrapper",
			text: dmStr["ui.nee.pages.10"],
			imgSrc: "SettingsIcon",
			onTabReady: function() {
				$("#_p_editor").addClass("navigationSettings");
				$.dmx.current.editable.navigationGeneralSettingsTabReady()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				$.dmfw.setEditorBreadcrumb(null);
				$("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.1"]);
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.layoutInsideTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
			text: dmStr["ui.nee.navigation.4"],
			imgSrc: "LinkImgIcon",
			onTabReady: function() {
				a.navigationLinksTabReady(a.selectedLinkID)
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				var d = {};
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				d = {
					tabs: {
						color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
						navcustomize: [],
						text_style: []
					},
					colorCallbacks: {
						background: $.navigationUtil.changeBackgroundGlobally,
						text: $.navigationUtil.changeLayoutExpText,
						bgimage: $.navigationUtil.changeBackgroundImageGlobally,
						icons: $.navigationUtil.changeNavIconsColor
					},
					colorSelectors: {
						text: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
						nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a",
					forceTextClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
					textSizeSelector: ".navText",
					textSelector: "li \x3e a",
					changeGlobally: !0
				};
				$.navigationUtil.getVariationsColorRestrictions().icons && d.tabs.color.remove(4);
				$.navigationUtil.getVariationsColorRestrictions().arrows && d.tabs.color.remove(2);
				$(e).neeSecondaryDesignTabs(d)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.ptLayoutInsideTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				var d = {};
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				d = {
					tabs: {
						menu_items: [],
						color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
						navcustomize: [],
						text_style: []
					},
					colorCallbacks: {
						background: $.navigationUtil.changeBackgroundGlobally,
						text: $.navigationUtil.changeLayoutExpText,
						bgimage: $.navigationUtil.changeBackgroundImageGlobally,
						icons: $.navigationUtil.changeNavIconsColor
					},
					colorSelectors: {
						text: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
						nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a",
					forceTextClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
					textSizeSelector: ".navText",
					textSelector: "li \x3e a",
					changeGlobally: !0,
					menuItemsCallback: function() {
						a.navigationLinksTabReady(a.selectedLinkID)
					}
				};
				$.navigationUtil.getVariationsColorRestrictions().icons && d.tabs.color.remove(4);
				$.navigationUtil.getVariationsColorRestrictions().arrows && d.tabs.color.remove(2);
				$(e).neeSecondaryDesignTabs(d)
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationMoreSettings.jsp .editContentWrapper",
			text: dmStr["ui.nee.pages.10"],
			imgSrc: "SettingsIcon",
			onTabReady: function() {
				$("#_p_editor").addClass("navigationSettings");
				$.dmx.current.editable.navigationGeneralSettingsTabReady()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.layoutOutsideTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
			text: dmStr["ui.nee.navigation.4"],
			imgSrc: "LinkImgIcon",
			onTabReady: function() {
				a.navigationLinksTabReady(a.selectedLinkID)
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				var d = {};
				if ($.layoutNav.expandable) {
					var d = $.dmfw.getPreviewElement(".dmNavigation"),
					g = $.dmfw.getPreviewElement("#slideDownTrigger, #dmBackBtn"),
					d = {
						tabs: {
							exp_button_color: ["layout_exp_button_bg", "layout_exp_button_text"],
							layout_exp_menu: ["layout_exp_background", "layout_exp_text"],
							text_style: []
						},
						colorCallbacks: {
							background: $.navigationUtil.changeBackgroundGlobally,
							layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_exp_text: $.navigationUtil.changeLayoutExpText,
							layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
							layout_exp_button_bg_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, "#fixHead div#slideDownTrigger")
							},
							layout_exp_button_bg: $.navigationUtil.changeLayoutExpButtonBackground,
							layout_exp_button_text: $.navigationUtil.changeLayoutExpButtonText,
							text: $.navigationUtil.changeTextGlobally,
							bgimage: $.navigationUtil.changeBackgroundImageGlobally,
							icons: $.navigationUtil.changeNavIconsColor
						},
						elementArray: {
							layout_exp_menu: d,
							exp_button_color: g
						},
						selectors: {
							layout_exp_button_bg_img: "#fixHead div#slideDownTrigger"
						},
						textSelector: "li a",
						forceClassName: "#slideDownNav.dmn ul.dmNavigation",
						textSizeSelector: ".navItemText",
						changeGlobally: !0
					};
					$.navigationUtil.getVariationsColorRestrictions()
				}
				if ($.layoutNav.footerBar) {
					var g = $.dmfw.getPreviewElement("#fixFoot"),
					d = $.dmfw.getPreviewElement(".dmNavigation"),
					j = $.dmfw.getPreviewElement(".footerBtn.dmNavItemSelected");
					0 == j.length && (j = d);
					d = {
						tabs: {
							footer_top_item_color: ["layout_background", "text", "nav_icons_color"],
							footer_top_active_item_color: ["layout_active_background", "active_text"],
							layout_exp_menu: ["layout_exp_background", "layout_exp_text"],
							navcustomize: [],
							text_style: []
						},
						colorCallbacks: {
							layout_background: $.navigationUtil.changeLayoutBackground,
							layout_background_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, ".fixedFooterContainer ul#fixFoot")
							},
							layout_active_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_active_background_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected")
							},
							layout_exp_text: $.navigationUtil.changeLayoutExpText,
							layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
							text: function(a) {
								$.navigationUtil.changeLayoutTextGlobally(a, ".fixedFooterContainer ul#fixFoot li:not(.dmNavItemSelected) .navItemText")
							},
							active_text: function(a) {
								$.navigationUtil.changeLayoutTextGlobally(a, ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected .navItemText")
							},
							bgimage: $.navigationUtil.changeBackgroundImageGlobally,
							icons: $.navigationUtil.changeNavIconsColor
						},
						colorSelectors: {
							nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
						},
						elementArray: {
							footer_top_item_color: g,
							footer_top_active_item_color: j,
							layout_exp_menu: d
						},
						selectors: {
							layout_background_img: ".fixedFooterContainer ul#fixFoot",
							layout_active_background_img: ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected"
						},
						textSelector: " li a",
						forceClassName: "#fixFoot.dmn li.navButtonLi a span, #fixFoot.dmn li.navButtonLi span, #slideUpNav ul.dmNavigation li.navListLi a, , .dmNavigation .navItemText ",
						textSizeSelector: ".navItemText",
						changeGlobally: !0
					};
					g.find(".slideDownTrigger, .slideUpTrigger").is(":visible") || delete d.tabs.layout_exp_menu
				}
				$.layoutNav.topBar && (g = $.dmfw.getPreviewElement("#upperTabs"), d = $.dmfw.getPreviewElement(".dmNavigation"), j = $.dmfw.getPreviewElement("#upperTabs li.dmNavItemSelected"), 0 == j.length && (j = d), d = {
					tabs: {
						footer_top_item_color: ["layout_background", "text"],
						footer_top_active_item_color: ["layout_active_background", "active_text"],
						layout_exp_menu: ["layout_exp_background", "layout_exp_text"],
						text_style: []
					},
					colorCallbacks: {
						layout_background: $.navigationUtil.changeLayoutBackground,
						layout_background_img: function(a) {
							$.navigationUtil.changeNavBGImageGlobally(a, ".dmUpperTabs ul#upperTabs")
						},
						layout_active_background: function(a) {
							$.navigationUtil.changeColorsGlobally("background-color", a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected")
						},
						layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
						layout_active_background_img: function(a) {
							$.navigationUtil.changeNavBGImageGlobally(a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected")
						},
						layout_exp_text: $.navigationUtil.changeLayoutExpText,
						layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
						text: function(a) {
							$.navigationUtil.changeLayoutTextGlobally(a, ".dmUpperTabs ul#upperTabs li:not(.dmNavItemSelected) .navItemText")
						},
						active_text: function(a) {
							$.navigationUtil.changeLayoutTextGlobally(a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected .navItemText")
						},
						bgimage: $.navigationUtil.changeBackgroundImageGlobally
					},
					elementArray: {
						footer_top_item_color: g,
						footer_top_active_item_color: j,
						layout_exp_menu: d
					},
					selectors: {
						layout_background_img: ".dmUpperTabs ul#upperTabs",
						layout_active_background_img: ".dmUpperTabs ul#upperTabs li.dmNavItemSelected"
					},
					textSelector: " li a",
					forceClassName: "#upperTabs.dmn li.navButtonLi a,  #upperTabs.dmn li.navButtonLi, .dmNavigation .navItemText",
					textSizeSelector: "span.navItemText",
					changeGlobally: !0
				},
				g.find(".slideDownTrigger, .slideUpTrigger").is(":visible") || delete d.tabs.layout_exp_menu);
				$.layoutNav.restrictions.hideEffectsTab && delete d.tabs.navcustomize;
				$(e).neeSecondaryDesignTabs(d)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.ptLayoutOutsideTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				var d = {};
				if ($.layoutNav.expandable) {
					var d = $.dmfw.getPreviewElement(".dmNavigation"),
					g = $.dmfw.getPreviewElement("#slideDownTrigger, #dmBackBtn"),
					d = {
						tabs: {
							menu_items: [],
							exp_button_color: ["layout_exp_button_bg", "layout_exp_button_text"],
							layout_exp_menu: ["layout_exp_background", "layout_exp_text"],
							text_style: []
						},
						colorCallbacks: {
							background: $.navigationUtil.changeBackgroundGlobally,
							layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_exp_text: $.navigationUtil.changeLayoutExpText,
							layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
							layout_exp_button_bg_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, "#fixHead div#slideDownTrigger")
							},
							layout_exp_button_bg: $.navigationUtil.changeLayoutExpButtonBackground,
							layout_exp_button_text: $.navigationUtil.changeLayoutExpButtonText,
							text: $.navigationUtil.changeTextGlobally,
							bgimage: $.navigationUtil.changeBackgroundImageGlobally,
							icons: $.navigationUtil.changeNavIconsColor
						},
						elementArray: {
							layout_exp_menu: d,
							exp_button_color: g
						},
						selectors: {
							layout_exp_button_bg_img: "#fixHead div#slideDownTrigger"
						},
						textSelector: "li a",
						forceClassName: "#slideDownNav.dmn ul.dmNavigation li a span.navItemText",
						textSizeSelector: ".navItemText",
						changeGlobally: !0,
						menuItemsCallback: function() {
							a.navigationLinksTabReady(a.selectedLinkID)
						}
					};
					$.navigationUtil.getVariationsColorRestrictions().bgcolor && d.tabs.exp_button_color.remove(0)
				}
				if ($.layoutNav.footerBar) {
					var g = $.dmfw.getPreviewElement("#fixFoot"),
					d = $.dmfw.getPreviewElement(".dmNavigation"),
					j = $.dmfw.getPreviewElement(".footerBtn.dmNavItemSelected");
					0 == j.length && (j = d);
					d = {
						tabs: {
							menu_items: [],
							footer_top_item_color: ["layout_background", "text", "nav_icons_color"],
							footer_top_active_item_color: ["layout_active_background", "active_text"],
							navcustomize: [],
							text_style: []
						},
						colorCallbacks: {
							layout_background: $.navigationUtil.changeLayoutBackground,
							layout_background_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, ".fixedFooterContainer ul#fixFoot")
							},
							layout_active_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
							layout_active_background_img: function(a) {
								$.navigationUtil.changeNavBGImageGlobally(a, ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected")
							},
							layout_exp_text: $.navigationUtil.changeLayoutExpText,
							layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
							text: function(a) {
								$.navigationUtil.changeLayoutTextGlobally(a, ".fixedFooterContainer ul#fixFoot li:not(.dmNavItemSelected) .navItemText")
							},
							active_text: function(a) {
								$.navigationUtil.changeLayoutTextGlobally(a, ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected .navItemText")
							},
							bgimage: $.navigationUtil.changeBackgroundImageGlobally,
							icons: $.navigationUtil.changeNavIconsColor
						},
						colorSelectors: {
							nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
						},
						elementArray: {
							footer_top_item_color: g,
							footer_top_active_item_color: j,
							layout_exp_menu: d
						},
						selectors: {
							layout_background_img: ".fixedFooterContainer ul#fixFoot",
							layout_active_background_img: ".fixedFooterContainer ul#fixFoot li.dmNavItemSelected"
						},
						textSelector: " li a",
						forceClassName: "#fixFoot.dmn li.navButtonLi a span, #fixFoot.dmn li.navButtonLi span, #slideUpNav ul.dmNavigation li.navListLi a",
						textSizeSelector: ".navItemText",
						changeGlobally: !0,
						menuItemsCallback: function() {
							a.navigationLinksTabReady(a.selectedLinkID)
						}
					};
					g.find(".slideDownTrigger, .slideUpTrigger").is(":visible") || delete d.tabs.layout_exp_menu
				}
				$.layoutNav.topBar && (g = $.dmfw.getPreviewElement("#upperTabs"), d = $.dmfw.getPreviewElement(".dmNavigation"), j = $.dmfw.getPreviewElement("#upperTabs li.dmNavItemSelected"), 0 == j.length && (j = d), d = {
					tabs: {
						menu_items: [],
						footer_top_item_color: ["layout_background", "text"],
						footer_top_active_item_color: ["layout_active_background", "active_text"],
						layout_exp_menu: ["layout_exp_background", "layout_exp_text"],
						text_style: []
					},
					colorCallbacks: {
						layout_background: $.navigationUtil.changeLayoutBackground,
						layout_background_img: function(a) {
							$.navigationUtil.changeNavBGImageGlobally(a, ".dmUpperTabs ul#upperTabs")
						},
						layout_active_background: function(a) {
							$.navigationUtil.changeColorsGlobally("background-color", a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected")
						},
						layout_exp_background: $.navigationUtil.changeLayoutActiveBackground,
						layout_active_background_img: function(a) {
							$.navigationUtil.changeNavBGImageGlobally(a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected")
						},
						layout_exp_text: $.navigationUtil.changeLayoutExpText,
						layout_exp_bgimage: $.navigationUtil.changeLayoutExpBackgroundImageGlobally,
						text: function(a) {
							$.navigationUtil.changeLayoutTextGlobally(a, ".dmUpperTabs ul#upperTabs li:not(.dmNavItemSelected) .navItemText")
						},
						active_text: function(a) {
							$.navigationUtil.changeLayoutTextGlobally(a, ".dmUpperTabs ul#upperTabs li.dmNavItemSelected .navItemText")
						},
						bgimage: $.navigationUtil.changeBackgroundImageGlobally
					},
					elementArray: {
						footer_top_item_color: g,
						footer_top_active_item_color: j,
						layout_exp_menu: d
					},
					selectors: {
						layout_background_img: ".dmUpperTabs ul#upperTabs",
						layout_active_background_img: ".dmUpperTabs ul#upperTabs li.dmNavItemSelected"
					},
					textSelector: " li a",
					forceClassName: "#upperTabs.dmn li.navButtonLi a,  #upperTabs.dmn li.navButtonLi, .dmNavigation .navItemText",
					textSizeSelector: "span.navItemText",
					changeGlobally: !0,
					menuItemsCallback: function() {
						a.navigationLinksTabReady(a.selectedLinkID)
					}
				},
				g.find(".slideDownTrigger, .slideUpTrigger").is(":visible") || delete d.tabs.layout_exp_menu, $.navigationUtil.getVariationsColorRestrictions().bgcolor && (d.tabs.footer_top_item_color.remove(0), d.tabs.footer_top_active_item_color.remove(0)));
				$.layoutNav.restrictions.hideEffectsTab && delete d.tabs.navcustomize;
				$(e).neeSecondaryDesignTabs(d)
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationMoreSettings.jsp .editContentWrapper",
			text: dmStr["ui.nee.pages.10"],
			imgSrc: "SettingsIcon",
			onTabReady: function() {
				$("#_p_editor").addClass("navigationSettings");
				$.dmx.current.editable.navigationGeneralSettingsTabReady()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp #navEditorInnerPanel",
			text: dmStr["ui.nee.navigation.4"],
			imgSrc: "LinkImgIcon",
			onTabReady: function() {
				a.navigationLinksTabReady(a.selectedLinkID)
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				var d = $.dmx.current.element.is(".backToHomePlaceHolder") ? {
					color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
					navcustomize: [],
					text_style: []
				}: {
					navshape: [],
					color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
					navcustomize: [],
					text_style: []
				};
				$(e).neeSecondaryDesignTabs({
					tabs: d,
					colorCallbacks: {
						background: $.navigationUtil.changeBackgroundGlobally,
						text: $.navigationUtil.changeTextGlobally,
						bgimage: $.navigationUtil.changeBackgroundImageGlobally,
						icons: $.navigationUtil.changeNavIconsColor
					},
					colorPreviewCallbacks: {
						background: $.navigationUtil.changePreviewBackgroundGlobally,
						text: $.navigationUtil.changePreviewTextGlobally
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a",
					forceTextClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
					textSizeSelector: ".navText",
					textSelector: "li \x3e a",
					changeGlobally: !0,
					colorSelectors: {
						nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.background"],
			imgSrc: "ContentBackgroundImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border"],
						navcontshape: [],
						general_design_settings: []
					},
					changeGlobally: !0,
					colorCallbacks: {
						bgimage: $.navigationUtil.changeNavBackgroundImageGlobally
					},
					colorPreviewCallbacks: {
						background: $.navigationUtil.changeNavBackgroundPreviewGlobally
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom"
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	};
	this.ptButtonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationDesign.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				a.setNavigationEmptyBreadCrumb();
				$.navigationUtil.selectNavigationItem(null);
				a.selectedLinkID = null;
				var d = $.dmx.current.element.is(".backToHomePlaceHolder") ? {
					menu_items: [],
					color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
					navcustomize: [],
					text_style: []
				}: {
					menu_items: [],
					navshape: [],
					color: ["background", "text", "nav_arrow", "border", "nav_icons_color"],
					navcustomize: [],
					text_style: []
				};
				$(e).neeSecondaryDesignTabs({
					tabs: d,
					colorCallbacks: {
						background: $.navigationUtil.changeBackgroundGlobally,
						text: $.navigationUtil.changeTextGlobally,
						bgimage: $.navigationUtil.changeBackgroundImageGlobally,
						icons: $.navigationUtil.changeNavIconsColor
					},
					colorPreviewCallbacks: {
						background: $.navigationUtil.changePreviewBackgroundGlobally,
						text: $.navigationUtil.changePreviewTextGlobally
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a",
					forceTextClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navText",
					textSizeSelector: ".navText",
					textSelector: "li \x3e a",
					changeGlobally: !0,
					colorSelectors: {
						nav_icons: "*.navPlaceHolder UL.dmNav.dmNavCustom li \x3e a DIV.navIcon"
					},
					menuItemsCallback: function() {
						a.navigationLinksTabReady(a.selectedLinkID)
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.background"],
			imgSrc: "ContentBackgroundImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border"],
						navcontshape: [],
						general_design_settings: []
					},
					changeGlobally: !0,
					colorCallbacks: {
						bgimage: $.navigationUtil.changeNavBackgroundImageGlobally
					},
					colorPreviewCallbacks: {
						background: $.navigationUtil.changeNavBackgroundPreviewGlobally
					},
					forceClassName: "*.navPlaceHolder UL.dmNav.dmNavCustom"
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationMoreSettings.jsp .editContentWrapper",
			text: dmStr["ui.nee.pages.10"],
			imgSrc: "SettingsIcon",
			onTabReady: function() {
				$("#_p_editor").addClass("navigationSettings");
				$.dmx.current.editable.navigationGeneralSettingsTabReady()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.selectedLinkID = null;
				a.navigationSettingsTabReady(e, a)
			}
		}]
	}
}
NEENavigation.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("DIV.navPlaceHolder *, ul.dmNavigationWithLink *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEENavigation.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEENavigation.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEENavigation.prototype.getCorrectElement = function(a) {
	var e = this.getElementTagsSelectors();
	a = $(a).is(e) ? $(a) : 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0);
	this.isExpandable = a.is(this.getExpandableSelector());
	return a
};NEENavigation.prototype.getExpandableSelector = function() {
	return ".expandableNavigationContainer, .expandableParent"
};NEENavigation.prototype.getElementTagsSelectors = function() {
	return "DIV.navPlaceHolder, ul.dmNavigationWithLink"
};NEENavigation.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorNavigationSelected")
};NEENavigation.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorNavigationSelected"), this.disableEditInline())
};NEENavigation.prototype._isBth = function(a) {
	null == a && (a = $.dmx.current.element);
	return $(a).is(".backToHomePlaceHolder")
};NEENavigation.prototype._isExpandable = function(a) {
	return $.navigationUtil.isNavigationExpandable(a)
};NEENavigation.prototype._isTopBottom = function(a) {
	null == a && (a = $.dmx.current.element);
	return $(a).is(".dmNavigationWithLink *,.dmNavigationWithLink")
};NEENavigation.prototype.editInline = function(a, e) {
	$.navigationUtil.initLayoutNavObject();
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this._isBth() ? (d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.navigation.11"] + "\x3c/div\x3e"), d.isPaste = !1) : this._isExpandable() ? (d.isMovable = !1, d.isDelete = !1, d.isPaste = !1, d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.navigation.1"] + "\x3c/div\x3e")) : this._isTopBottom() && (d.isMovable = !1, d.isDelete = !1, d.isPaste = !1);
	$.dmx.site.isFromScratch && (d.isDelete = !1);
	if ($.layoutNav.expandable || $.layoutNav.footerBar || $.layoutNav.topBar) d.hideSelectionBars = !0;
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEENavigation.prototype.disableEditInline = function() {};NEENavigation.prototype.docReady = function() {};NEENavigation.prototype.editorReady = function(a, e) {
	$.navigationUtil.initNavEditor(this);
	var d = -1;
	try {
		e = e || {},
		e.itemData = e.itemData || {},
		e.previewElement && e.previewElement.is(".backToHomePlaceHolder") && (d = "backToHome"),
		e.itemData.itemId ? d = e.itemData.itemId: e.itemData.linkelement ? d = e.itemData.linkelement.element.parent().attr("id") : e.itemData.event && ((d = $(e.itemData.event.target).closest(".dmNav li").attr("id")) || (d = $(e.itemData.event.target).is(".backToHomePlaceHolder") ? "backToHome": $(e.itemData.event.target).closest(".backToHome").attr("id")))
	} catch(g) {}
	this.selectedLinkID = d;
	var j = e.tabToOpen || 0,
	d = e.itemData.openAdvanced,
	k = this.getEditorMainTabs();
	this.isExpandable && NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.expandableMenuWasClicked(!0);
	var l = $(a).find(".buttonTab");
	d && (this.setNavigationEmptyBreadCrumb(), $.dmfw.setEditorBreadcrumb({
		parts: [{
			click: function() {
				$.dmfw.openEditor($.dmx.current.editable, $.dmx.current.element, {},
				{
					forceOpen: !0
				})
			}
		},
		{
			title: dmStr["ui.nee.navigation.12"]
		}]
	}));
	$.dmx.cache.set("siteNav", null);
	$.dmx.getSiteNav(function(a) {
		0 === a.length || 1 === a.length && "true" === $.dmfw.getPreviewElement(".hiddenNavPlaceHolder ul#dmNav").attr("hwa") ? $.dmLoad($(".rightPanel"), "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp",
		function() {
			$("#navChangeExplanationText").hide();
			$("#navigationIsEmptyNotification").show();
			$("ol.navEditorLinks").css("border-bottom-style", "none");
			$(".navEditorInnerPanel ol.navEditorLinks#navPages").hide();
			$(".emptyNavAddLink").unbind("click").click(function() {
				$.navigationUtil.addToNavigation(dmStr["ui.nee.navigation.newItemTitle"], $.dmx.site.baseUrl, !0)
			});
			$(".emptyNavSelectNav").neePopUpDiv($("#selectNavigationWrapper"), {
				init: function(a) {
					$.navigationUtil.initNavSelectWindow();
					a = a.closest(".popupWinExample").outerHeight();
					$("#selectNavigationWindow").css("height", a - 125 + "px")
				},
				maxScreenSize: !0,
				popupAdditionalClass: "popUpSelectNavClass"
			});
			$("#staticOL [original_id\x3d'dmMore']").hide();
			$("#staticOL [original_id\x3d'dmLess']").hide();
			$.dmx.current.element.is(".backToHomePlaceHolder") || $("#staticOL [original_id\x3d'backToHome']").hide()
		}) : (l.neeEditorTabs({
			tabs: k,
			initTab: j
		}), l.addClass("isNavigationEditor"))
	})
};NEENavigation.prototype.getEditorMainTabs = function() {
	var a = this.isExpandable ? this.isImprovedTabs() ? this.ptExpandableTabInfo: this.expandableTabInfo: this.isImprovedTabs() ? this.ptButtonTabInfo: this.buttonTabInfo,
	a = this.isLayoutInside ? this.isImprovedTabs() ? this.ptLayoutInsideTabInfo: this.layoutInsideTabInfo: a;
	return a = this.isLayoutOutside ? this.isImprovedTabs() ? this.ptLayoutOutsideTabInfo: this.layoutOutsideTabInfo: a
};NEENavigation.prototype.openNavTab = function(a) {
	a = this.tabInfo.type[a];
	var e = a.url,
	d = $("#navEditorInnerPanel");
	d.empty();
	$.dmLoad(d, e, a.onTabReady)
};NEENavigation.prototype.onEditorClose = function() {
	this.isExpandable && NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.expandableMenuWasClicked(!1);
	$.navigationUtil.selectNavigationItem(null);
	_isColorChangedAndUpdateNav && ($.dmx.site.paletteID = -1, _isColorChangedAndUpdateNav = !1);
	if (0 < $(".EditSubMenuWrapper .navEditorLinks").size()) try {
		$.ptPages.initNavigationItems()
	} catch(a) {}
	$.dmx.getSiteNav() && 0 < $.dmx.getSiteNav().length && $(".noNavigationMessage").hide()
};NEENavigation.prototype.navigationLinksTabReady = function(a, e, d, g) {
	this.isExpandable = this.isExpandable || $.dmx.current.element.is(this.getExpandableSelector());
	d || this.setNavigationEmptyBreadCrumb();
	$("#navEditorInnerPanel .navEditorLinks").navigationItems({
		selectedID: a,
		dontFocusTitle: e,
		openItemLinkEditor: g,
		dontShowColorHandlers: !this.areItemsColorsEditable(),
		isExpandable: this.isExpandable,
		inPT: this.isImprovedTabs(),
		pageItemTemplate: this.getPageItemTemplate(),
		componentsClassNames: this.getSinglePageItemSubComponentsClassNames()
	});
	0 == $(".rightPanel").find(".navAddNew").length && !g && (a = $("\x3cdiv class\x3d'navAddNew orangeBtn' id\x3d'navAddNew'\x3e\x3c/div\x3e"), a.text(dmStr["ui.nee.navigation.13"]), a.click(function() {
		$.navigationUtil.addToNavigation(dmStr["ui.nee.navigation.newItemTitle"], $.dmx.site.baseUrl, !0)
	}), this.isImprovedTabs() || $(".rightPanel").append(a))
};NEENavigation.prototype.areItemsColorsEditable = function() {
	return ! this.isLayoutOutside && !this.doesntHaveNavigationInside
};NEENavigation.prototype.navigationDesignTabReady = function(a) {
	$(a).neeSecondaryDesignTabs()
};NEENavigation.prototype.navigationIconsTabReady = function() {};NEENavigation.prototype.navigationSettingsTabReady = function(a, e) {
	var d = this.getMoreTabSecondaryTabs();
	$(a).neeSecondaryDesignTabs({
		tabs: d,
		changeGlobally: !0,
		forceClassName: this.getNavigationWrapperClass(),
		container: e
	})
};NEENavigation.prototype.navigationAdvancedSettingsTabReady = function() {
	$(".navSettings #editDesign").unbind("click").click($.navigationUtil.openNavEditorOnDesign);
	$(".navSettings #editSpacing").unbind("click").click($.navigationUtil.openNavEditorOnSpacing)
};NEENavigation.prototype.navigationGeneralSettingsTabReady = function() {
	var a = $(["\x3cdiv class\x3d'navAddNew notYourNav' id\x3d'notYourNav'\x3e\x3cspan\x3e", dmStr["ui.navigation.3213"], "\x3c/span\x3e\x3cspan class\x3d'selectIt'\x3e", dmStr["ui.navigation.3214"], "\x3c/span\x3e\x3c/div\x3e"].join(""));
	a.find(".selectIt").neePopUpDiv($("#selectNavigationWrapper"), {
		init: function(a) {
			$.navigationUtil.initNavSelectWindow();
			a = a.closest(".popupWinExample").outerHeight();
			$("#selectNavigationWindow").css("height", a - 125 + "px")
		},
		maxScreenSize: !0,
		popupAdditionalClass: "popUpSelectNavClass"
	}); ! $.dmx.site.isFromScratch && 0 === $("#notYourNav").length && $(".rightPanel").append(a);
	this.setNavigationEmptyBreadCrumb();
	$.navigationUtil.selectNavigationItem(null);
	this.selectedLinkID = null;
	a = $(".settingsWrapper");
	a.find(".editContentList").find("[value\x3d'" + $.dmx.site.siteSettings.visibleNavigationItems + "']").attr("selected", "selected");
	a.find(".editContentList").change(function() {
		var a = 1 * $(this).find("option:selected").attr("value");
		$.dmx.site.siteSettings.visibleNavigationItems = a;
		var d = NEFW.PREVIEW.get(0).contentWindow;
		d.jQuery.DM.expandNavigation();
		d.setDMAjaxNavSize(a);
		d.jQuery.DM.restoreDefaultNavigationStyles();
		d.jQuery.DM.fullCollapseNavigation();
		$.dmops.redrawSelection();
		$.navigationUtil.postSettingsInt($.dmx.page.id, "navigationVisibleItems", a)
	});
	a.find("#generateNavigationButton").onOffBtn({
		initState: $.dmx.site.generateNavigation,
		onFn: function() {
			$.dmx.site.siteSettings.generateNavigation = !0;
			$.navigationUtil.postSettings($.dmx.page.id, "generateNavigation", !0)
		},
		offFn: function() {
			$.dmx.site.siteSettings.generateNavigation = !1;
			$.navigationUtil.postSettings($.dmx.page.id, "generateNavigation", !1)
		}
	});
	a.find("#useAjaxButton").onOffBtn({
		initState: $.dmx.site.siteSettings.useAjaxLoading,
		onFn: function() {
			$.dmx.site.siteSettings.useAjaxLoading = !0;
			$.navigationUtil.postSettings($.dmx.page.id, "useAjax", !0)
		},
		offFn: function() {
			$.dmx.site.siteSettings.useAjaxLoading = !1;
			$.navigationUtil.postSettings($.dmx.page.id, "useAjax", !1)
		}
	});
	a.find("#autoSyncNavButton").onOffBtn({
		initState: $.dmx.site.siteSettings.autoSyncNav,
		onFn: function() {
			$.dmx.site.siteSettings.autoSyncNav = !0;
			$.navigationUtil.postSettings($.dmx.page.id, "autoSyncNav", !0,
			function() {
				$.dmfw.refreshPreview(function() {
					$.dmops.updateEditContext.all({
						success: function() {}
					});
					$.navigationUtil.openNavigationEditor()
				})
			})
		},
		offFn: function() {
			$.dmx.site.siteSettings.autoSyncNav = !1;
			$.navigationUtil.postSettings($.dmx.page.id, "autoSyncNav", !1)
		}
	});
	a.find("#syncWithWebsiteNavButton").onOffBtn({
		initState: $.dmx.site.syncWithSiteNavigation,
		onFn: function() {
			$.dmx.site.siteSettings.syncWithSiteNavigation = !0;
			$.navigationUtil.postSettings($.dmx.page.id, "syncWithWebsite", !0)
		},
		offFn: function() {
			$.dmx.site.siteSettings.syncWithSiteNavigation = !1;
			$.navigationUtil.postSettings($.dmx.page.id, "syncWithWebsite", !1)
		}
	});
	var e = $($.dmfw.getPreviewElement(".hiddenNavPlaceHolder .dmNav:first").get(0)),
	d = function(a) {
		return function() {
			_expandCollapse(!0);
			$.dmfw.getPreviewElement("[dmle_is_current_element\x3d'true']").toggleClass("dmHideFromNav", a);
			_expandCollapse(!1);
			$.dmfw.getPreviewElement(".hiddenNavPlaceHolder ul:first").attr("dmle_hide_current_element", a)
		}
	},
	g = 0 < e.find("li").size();
	a.find("#showExpandableButton").onOffBtn({
		initState: "true" == e.attr("dmle_expandable_display"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_expandable_display", "true")
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_expandable_display", "false")
		}
	});
	a.find("#showMainExpandableButton").onOffBtn({
		initState: "true" == e.attr("dmle_show_expandable_on_main"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_show_expandable_on_main", "true")
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_show_expandable_on_main", "false")
		}
	});
	var j = "true" == e.attr("dmle_expandable_display") && g;
	$("#notExpandableNavigationOptions").toggle(!j);
	$("#expandableNavigationOptions").toggle(j);
	$(".irrelevantForExpandable").toggle(!this.isExpandable);
	$(".relevantForExpandable").toggle(this.isExpandable);
	g || ($(".irrelevantForEmpty").hide(), $(".irrelevantForEmptyNav").hide());
	$.layoutNav.isLayout && $(".neverInLayouts").hide(); ($.layoutNav.footerBar || $.layoutNav.topBar || $.layoutNav.expandable) && $("#expandableNavigationOptions, #notExpandableNavigationOptions ,.irrelevantForEmpty").hide();
	a.find("#showMainNavButton").onOffBtn({
		initState: "always" == e.attr("dmle_main_display"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_main_display", "always")
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_main_display", "auto")
		}
	});
	a.initMenuAlignButtons();
	a.find("#showSubButton").onOffBtn({
		initState: "never" != e.attr("dmle_sub_display"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_sub_display", "auto")
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_sub_display", "never")
		}
	});
	a.find("#showBthButton").onOffBtn({
		initState: "never" != e.attr("dmle_bth_display"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_bth_display", "auto")
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_bth_display", "never")
		}
	});
	a.find("#showCurrentButton").onOffBtn({
		initState: "true" != e.attr("dmle_hide_current_element"),
		onFn: function() {
			$.navigationUtil.postSet("dmle_hide_current_element", "false", d(!1))
		},
		offFn: function() {
			$.navigationUtil.postSet("dmle_hide_current_element", "true", d(!0))
		}
	});
	$.navigationUtil.initNavSelectWindow();
	$("#attachNavigationButton").neePopUpDiv($("#selectNavigationWrapper"), {
		init: function(a) {
			$.navigationUtil.initNavSelectWindow();
			a = a.closest(".popupWinExample").outerHeight();
			$("#selectNavigationWindow").css("height", a - 125 + "px")
		},
		maxScreenSize: !0,
		popupAdditionalClass: "popUpSelectNavClass"
	});
	$("#removeNavigationButton").unbind("click").click(function() {
		$.navigationUtil.newNavIdChosen([" "])
	})
};NEENavigation.prototype.afterInsert = function(a) {
	placeHolder = $(a);
	a = NEFW.PREVIEW.get(0).contentWindow;
	a = "\x3ca class\x3d'backToHome dmHome  dmNoMark dmWwr default' href\x3d'" + $.dmfw.finalyzeRuntimeUrl("/site/" + $.dmx.site.alias + "/home") + "' dmle_generated\x3d'true' contenteditable\x3d'false' dmle_insert\x3d'true' dmle_widget_id\x3d'backToHome' id\x3d'backToHome' raw_url\x3d'" + $.dmx.site.baseUrl + "' duda_id\x3d'backToHome'\x3e \x3cspan class\x3d'iconBg' dmle_generated\x3d'true' duda_id\x3d''\x3e \x3cspan class\x3d'icon' dmle_dont_remove\x3d'true' dmle_generated\x3d'true' duda_id\x3d''\x3e \x3c/span\x3e\x3c/span\x3e  \x3cspan class\x3d'text' dmle_dont_remove\x3d'true' dmle_generated\x3d'true' dmle_select_parent\x3d'1' duda_id\x3d''\x3e" + a.getDMAjaxBackToHomeParameter() + "\x3c/span\x3e\x3c/a\x3e";
	placeHolder.append(a)
};NEENavigation.prototype.onDelete = function(a) {
	var e = a.is(".newNavigationSubNavPlaceHolder"),
	d = a.is(".backToHomePlaceHolder"),
	g = !e ? dmStr["ui.nee.navigation.15"] + "\x3cbr\x3e" + dmStr["ui.nee.navigation.16"] + ".": dmStr["ui.nee.navigation.17"];
	d ? "backToHomePlaceHolder" != a.attr("id") ? $.dmops.deleteElement(a,
	function() {
		try {
			$.dmx.current.editable.inlineEditor.editorUtils.removeEditor()
		} catch(a) {}
	}) : $("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv('Are you sure you want to hide the "Back to Home" button?', {
		initCallback: function() {
			$.navigationUtil.postSet("dmle_bth_display", "never",
			function() {
				$($.dmfw.getPreviewElement(".hiddenNavPlaceHolder .dmNav:first").get(0)).attr("dmle_bth_display", "never");
				a.empty();
				$.deselectAllEditableElements()
			})
		},
		onNoCallback: function() {},
		triggerNow: !0,
		noText: dmStr["ui.nee.navigation.no"],
		yesText: dmStr["ui.nee.navigation.yes"],
		bindCloseToNo: !0,
		forceWidth: "420px"
	}) : $("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(g, {
		initCallback: function() {
			if (e) {
				var d = a.find("ul:first").attr("id");
				if (d) {
					var g = "/pages/" + $.dmx.page.id + "/removefromnav?itemId\x3d" + d + "\x26isSub\x3dtrue";
					$.dmBlockUI();
					$.dmsrv.postToServ(function() {
						$.dmPostWithHistory({
							url: g,
							success: function() {
								$.dmfw.refreshPreview(null);
								$.dmops.updateEditContext.all({
									success: function() {}
								})
							}
						})
					})
				}
			} else $.navigationUtil.newNavIdChosen([" "], !0)
		},
		onNoCallback: function() {},
		triggerNow: !0,
		noText: dmStr["ui.no"].toUpperCase(),
		yesText: dmStr["ui.yes"].toUpperCase(),
		bindCloseToNo: !0,
		forceWidth: "420px"
	})
};NEENavigation.prototype.isImprovedTabs = function() {
	return $.dmfw.isPT()
};NEENavigation.prototype.getPageItemTemplate = function() {};NEENavigation.prototype.getSinglePageItemSubComponentsClassNames = function() {
	return {
		itemArrowCollapsedClass: "arrowRight",
		itemArrowExpandedClass: "arrowDown",
		navButtonHoverClass: "navLinkButtonBGHover"
	}
};NEENavigation.prototype.setNavigationEmptyBreadCrumb = function() {
	var a = this.getFirstBreadCrumbText();
	$.dmfw.setEditorBreadcrumb(null);
	$("#contentTitle.breadcrumb-first").text(a)
};NEENavigation.prototype.getFirstBreadCrumbText = function() {
	return this.isExpandable ? dmStr["ui.nee.navigation.1"] : dmStr["ui.nee.navigation.2"]
};NEENavigation.prototype.getMoreTabSecondaryTabs = function() {
	var a = {};
	this.isImprovedTabs() ? (a = this.isExpandable ? {}: {
		navhtml: []
	},
	a = this.isLayoutInside ? {
		navhtml: [],
		general_design_settings: []
	}: a) : a = this.isLayoutInside ? {
		navsettings: [],
		navhtml: [],
		general_design_settings: []
	}: {
		navsettings: [],
		navhtml: []
	};
	return a
};NEENavigation.prototype.getNavigationWrapperClass = function() {
	return "*.navPlaceHolder UL.dmNav.dmNavCustom"
};NEENavigation.prototype.getCorrectNavigationElementInPreview = function() {
	var a = $.dmfw.getPreviewElement(".newNavigationElementPlaceHolder");
	if (0 == a.find("li").size() && (a = $.dmfw.getPreviewElement(".newNavigationSubNavPlaceHolder"), 0 == a.children().size() || "none" == a.css("display"))) a = $.dmfw.getPreviewElement(".backToHomePlaceHolder"),
	0 == a.children().size() && (a = $.dmfw.getPreviewElement(".newNavigationElementPlaceHolder"));
	return a
}; (function(a) {
	a.isLinkHashed = function(e) {
		e = e || "";
		return e.endsWith("#") && (e == a.dmx.site.baseUrl + "#" || e == a.dmx.site.baseUrl + "/#")
	};
	a.fn.navigationItems = function(e) {
		var d, g = !1,
		j = !1,
		k = {},
		l = [],
		m = null,
		n = !1;
		e.dontRefreshLayout || a.navigationUtil.initLayoutNavObject();
		m = null;
		d = this;
		var o = {
			templateSelector: ".navEditorLinkAndSub",
			listSelector: ".navEditorLinks",
			listContainerURL: "/editor/nee/editableObjects/navigation/nee.navigation.HtmlNavigationLinks.jsp",
			inPagesEditor: !1,
			pageItemTemplate: ['\x3cli class\x3d"navEditorLinkAndSub" original_id\x3d"${elementID}"\x3e\n      \x3cdiv class\x3d"navEditorLinkWrapper"\x3e\n        \x3cdiv class\x3d"navEditorLink"\x3e\n          \x3cdiv class\x3d"navEditorLinkInner"\x3e\n            \x3cdiv class\x3d"navLinkMover"\x3e\x3c/div\x3e\n            \x3cdiv class\x3d"navLinkArrow arrowRight hiddenVisibility"\x3e\x3c/div\x3e\n            \x3cdiv class\x3d"navLinkIcon"\x3e\n              \x3cimg class\x3d"navLinkIconImage hiddenVisibility" _src\x3d"${linkDesign.itemIcon}" /\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"navLinkTitle elipsisText"\x3e${itemTitle}\x3c/div\x3e\n            \x3cinput class\x3d"displayNone navLinkTitleInput" type\x3d"text" value\x3d"" /\x3e\n            \x3cdiv class\x3d"navLinkButtonsWrapper displayNone"\x3e', '              \x3cdiv class\x3d"navLinkButtonIcon navLinkButton navLinkButtonBG" title\x3d"' + dmStr["ui.nee.navigation.37"] + '"\x3e', '                \x3cimg class\x3d"navLinkButtonImage" src\x3d"/editor/nee/images/slideEditors/neeNavigationButtonIconNew.png" /\x3e\n                \x3cdiv class\x3d"navLinkBtnIconDiv"\x3e\x3c/div\x3e\n              \x3c/div\x3e', '              \x3cdiv class\x3d"navLinkButtonLink navLinkButton navLinkButtonBG" title\x3d"' + dmStr["ui.nee.navigation.38"] + '"\x3e', '                \x3cimg class\x3d"navLinkButtonImage" src\x3d"/editor/nee/images/slideEditors/linkIcon.png" /\x3e\n                \x3cdiv class\x3d"navLinkBtnLinkDiv"\x3e\x3c/div\x3e\n              \x3c/div\x3e', '              \x3cdiv class\x3d"navLinkButtonColor navLinkButton navLinkButtonBG" title\x3d"' + dmStr["ui.nee.navigation.39"] + '"\x3e', '                \x3cimg class\x3d"navLinkButtonImage" src\x3d"/editor/nee/images/slideEditors/neeNavigationButtonColorsNew.png" /\x3e\n                \x3cdiv class\x3d"navLinkBtnColorsDiv"\x3e\x3c/div\x3e\n              \x3c/div\x3e\n              \x3cdiv class\x3d"navLinkButtonHidden navLinkButton navLinkButtonBG"\x3e\n                \x3cimg class\x3d"navLinkButtonImage" src\x3d"/editor/nee/images/slideEditors/neeNavigationButtonHiddenNew.png" /\x3e\n                \x3cdiv class\x3d"navLinkBtnHiddenDiv"\x3e\x3c/div\x3e\n              \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv style\x3d"clear: both"\x3e\x3c/div\x3e\n          \x3c/div\x3e\n        \x3c/div\x3e\n      \x3c/div\x3e\n      \x3col class\x3d"displayNone"\x3e\x3c/ol\x3e\n    \x3c/li\x3e'].join("\n"),
			componentsClassNames: {}
		},
		k = e = a.extend({},
		o, e || {});
		setTimeout(function() {
			var d = e.inPagesEditor ? a(".editorAndPreviewPanel") : a("#_editor");
			a.dmfw.isPT() || a.dmLoading(d);
			k.forceNavRefresh && a.dmx.cache.set("siteNav", null);
			a.dmx.getSiteNav(r)
		},
		0);
		var r = function(o) {
			k.links = o;
			g = k.inPagesEditor;
			j = k.inPT;
			n = !k.dontFocusTitle;
			d.find("li:not([original_id\x3d'${elementID}'])").remove();
			d.find("#navOtherPages").remove();
			d.find("*").andSelf().filter(k.listSelector + ":first").get(0) || (d.empty(), d.append('\x3col class\x3d"navEditorLinks noListStyle displayNone" id\x3d"navPages"\x3e\x3c/ol\x3e'));
			a.dmUnblockUI();
			o = k.listSelector;
			var r = k.links;
			k.otherLinks = [];
			o = d.find("*").andSelf().filter(o + ":first").get(0);
			a(o).removeClass("displayNone");
			var B = e.pageItemTemplate,
			F = a('\x3cdiv id\x3d"linkTemplate" type\x3d"text/x-jquery-tmpl"\x3e\x3c/div\x3e');
			F.append(B);
			l = a.dmx.getStaticNav();
			var I = a(o);
			k.addHome && (k.homeLinks = s(r,
			function(a) {
				return a == HOME_PAGE_DESIGN_ALIAS
			}), 0 < k.homeLinks.length && (B = a("#navHomePages"), 0 == B.size() && (B = a('      \x3cdiv id\x3d"homePages" class\x3d""\x3e\n      \t\t\x3col class\x3d"navOtherEditorLinks noListStyle" id\x3d"navHomePages"\x3e\x3c/ol\x3e\n      \x3c/div\x3e'), I.before(B), homeCont = a("#navHomePages")), homeCont.empty(), D(homeCont, k.homeLinks, F)));
			var J;
			D(I, r, F);
			I.nestedSortable({
				disabled: !0,
				cursor: 'url("/editor/nee/images/shell/closedhand.cur"), default',
				placeholder: "dmUi-state-highlight",
				forcePlaceholderSize: !0,
				tolerance: "pointer",
				toleranceElement: "\x3e div",
				handle: "div",
				items: "li",
				isTree: !0,
				helper: "clone",
				maxLevels: 3,
				tabSize: 15,
				update: function(d, g) {
					var j = a(g.item),
					l = a(J);
					if (l && (0 == l.children("ol").length || 0 == l.find("ol:first").children().length)) l.find(".navLinkArrow:first").removeClass(e.componentsClassNames.itemArrowExpandedClass),
					l.find(".navLinkArrow:first").addClass("hiddenVisibility");
					if ((j = a(j).parent().closest("li").find(".navLinkArrow:first")) && j.hasClass("hiddenVisibility")) j.addClass(e.componentsClassNames.itemArrowExpandedClass),
					j.removeClass("hiddenVisibility");
					N(g.item, !1);
					var m = a(g.item),
					j = a(J),
					l = m.attr("original_id"),
					n = m.parent().closest("li").attr("original_id"),
					m = m.next().attr("original_id"),
					o = j.attr("original_id");
					a.changePage({
						params: {
							itemID: l,
							parentID: n,
							beforeID: m
						},
						clientChange: function(d) {
							var e = void 0 == d.parentID ? "dmNav": d.parentID,
							g = a(a.dmfw.getPreviewElement(".navPlaceHolder ul").filter("#" + e.replace("_item", "s"))),
							g = g.is("ul") ? g: g.find("ul:first"),
							j = a.dmfw.getPreviewElement("#dmStyle_outerContainer").find("ul #" + d.itemID),
							l = j.closest("ul"),
							m;
							j.each(function(d) {
								d = a(j.get(d));
								if (!d.is(".hiddenNavPlaceHolder li")) return m = d,
								!1
							});
							m = m || a(j.get(0));
							j.remove();
							m.is(".dmHideFromNav") && (g = g.filter(".hiddenNavPlaceHolder *"));
							if (void 0 == d.beforeID) g.append(m);
							else {
								var n = g.find("#" + d.beforeID + ":first");
								if (1 == n.size()) {
									var r = a(n.get(0));
									if (r.is(".hiddenNavPlaceHolder .dmHideFromNav") && (r = r.next(":not(.dmHideFromNav)")) && 0 < r.size())(r = a.dmfw.getPreviewElement("#" + r.attr("id") + ":not(.hiddenNavPlaceHolder *)")) && 0 < r.size() && (n = n.add(r))
								}
								m.insertBefore(n)
							}
							g.each(function() {
								a(this).hasClass("dmExpandableNav") || a(this).addClass("dmNav")
							});
							g.closest(".newNavigationSubNavPlaceHolder").removeClass("dmEmptyNav");
							0 == l.children().length && (l.removeClass("dmNav"), g.closest(".newNavigationSubNavPlaceHolder").addClass("dmEmptyNav"));
							_expandCollapse(!1);
							a.refreshLayoutNavigations();
							for (var g = k.links,
							e = "dmNav" == e ? g: ra(g, e), g = o ? ra(g, o) : g, l = d.beforeID, s, v, z, n = 0; n < g.length; n++) r = g[n],
							r.elementID == d.itemID && (v = r, s = n);
							for (n = 0; n < e.length; n++) r = e[n],
							r.elementID == l && (elementBefore = r, z = n);
							void 0 != s && (void 0 == z ? (g.splice(s, 1), e.push(v)) : e == g && z > s ? (g.splice(s, 1), e.splice(z - 1, 0, v)) : (g.splice(s, 1), e.splice(z, 0, v)))
						},
						serverChange: function(d) {
							var e = "/pages/" + a.dmx.page.id + "/reordernav?itemId\x3d" + d.itemID + "\x26targetParentId\x3d" + (void 0 == d.parentID ? "dmNav": d.parentID);
							void 0 != d.beforeID && (e = e + "\x26targetNextSibId\x3d" + d.beforeID);
							a.dmPostWithHistory({
								url: e,
								data: {},
								success: function() {}
							})
						}
					},
					!0)
				},
				stop: function(d, e) {
					var g = a(e.item);
					"true" == a(g).attr("open_sub") && (C(a(g).find(".navLinkArrow:first")), a(g).attr("open_sub", ""));
					N(e.item, !1);
					I.nestedSortable({
						disabled: !0
					})
				},
				start: function(d, e) {
					J = a(e.item).parent().closest("li");
					N(e.item, !0)
				}
			});
			if (k.addOtherPages && (k.otherLinks = s(r), 0 < k.otherLinks.length)) {
				B = a("#navOtherPagesList");
				if (0 == B.size() && (r = a('      \x3cdiv id\x3d"navOtherPages" class\x3d""\x3e\n      \t\t\x3cspan class\x3d"otherPagesTitleLine"\x3e\n      \t\t\t\x3cspan class\x3d"otherPagesTitle"\x3eOther Pages\x3c/span\x3e\n      \t\t\t\x3cspan class\x3d"navLinkArrow arrowDown"\x3e\x3c/span\x3e\n      \t\t\x3c/span\x3e\n      \t\t\x3col class\x3d"navOtherEditorLinks noListStyle" id\x3d"navOtherPagesList"\x3e\x3c/ol\x3e\n      \x3c/div\x3e'), I.after(r), B = a("#navOtherPagesList"), r && r.size())) {
					var G = r.find(".navLinkArrow"),
					K = r.find("#navOtherPagesList"),
					r = r.find(".otherPagesTitleLine");
					K.toggle(G.hasClass(e.componentsClassNames.itemArrowExpandedClass));
					r.on("click",
					function() {
						G.hasClass(e.componentsClassNames.itemArrowExpandedClass) ? (G.removeClass(e.componentsClassNames.itemArrowExpandedClass).addClass(e.componentsClassNames.itemArrowCollapsedClass), K.hide()) : (G.removeClass(e.componentsClassNames.itemArrowCollapsedClass).addClass(e.componentsClassNames.itemArrowExpandedClass), K.fadeIn())
					})
				}
				B.empty();
				D(B, k.otherLinks, F)
			}
			if (!g) {
				r = a('\x3col id\x3d"staticOL" class\x3d"navEditorLinks noListStyle"\x3e\x3c/ol\x3e');
				for (B = 0; B < l.length; B++) {
					var O = l[B],
					W = F.tmpl(O);
					O.elementID == k.selectedID && (m = W);
					v(W, O);
					u(W);
					W.addClass("staticElement");
					a(W).data("dataItem", O);
					E(W);
					e.dontShowColorHandlers && a(W).find(".navLinkButtonColor").remove();
					r.append(W)
				}
				a(o).next().is("#staticOL") || a(r).insertAfter(a(o));
				a.layoutNav.restrictions.noBackToHome && a("#staticOL [original_id\x3d'backToHome']").hide();
				a.layoutNav.restrictions.noLessButton && a("#staticOL [original_id\x3d'dmLess']").hide();
				a.layoutNav.restrictions.noMoreButton && a("#staticOL [original_id\x3d'dmMore']").hide();
				m ? (F = n, r = m.closest(".navEditorLinkAndSub"), a.navigationUtil.selectNavigationItem(r.attr("original_id"), !0), r.parentsUntil(".navEditorLinks", ".navEditorLinkAndSub").children("ol").removeClass("displayNone"), r.parentsUntil(".navEditorLinks", ".navEditorLinkAndSub").find(".navLinkArrow:first").addClass(e.componentsClassNames.itemArrowExpandedClass), F && r.find(".navLinkTitle:first").trigger("click", [!0]), r.find(".navEditorLink:first").trigger("mouseover"), k.openItemLinkEditor && m.find(".navLinkButtonLink:first").trigger("click")) : a.navigationUtil.selectNavigationItem(null)
			}
			g && a(o).find(".navLinkTitle").each(function() {
				a(this).closest("li").outerWidth(!0);
				var d = Math.max(a(this).parents(".navEditorLinkAndSub").size(), 1);
				g && !j && a(this).css("width", 170 - 20 * (d - 1))
			});
			if (k.onNavReady) k.onNavReady();
			g || z()
		},
		u = function(a) {
			if (a && (a = a.find(".navLinkTitle:first")) && (!a.text() || !jQuery.trim(a.text()))) a.text(g ? dmStr["ui.nee.navigation.18"] : dmStr["ui.nee.navigation.19"]),
			a.addClass("navNoTitle")
		},
		s = function(d, e) {
			e = e ||
			function(a) {
				return a != HOME_PAGE_DESIGN_ALIAS
			};
			var g = [],
			j = a.dmx.editableNavLinks().map(function(a) {
				return a.alias
			}),
			k = a.dmx.editableNavLinks().map(function(a) {
				return a.url
			});
			a.each(a.dmx.sitePages,
			function(a, d) {
				var l = 0;
				try {
					l = d.rulesCount || 0
				} catch(m) {}
				if ("default" != d.alias && ("header" != d.alias && (0 < l || d.isFromScratchLegacy || d.isBFS)) && e(d.alias)) {
					var l = {
						deleted: !0,
						otherPage: !0,
						depth: 0,
						elementID: "",
						inNavigationList: !0,
						itemTitle: d.title,
						itemUrl: d.url,
						linkDesign: {},
						markup: "",
						pageAlias: d.alias,
						pageFromScratch: d.isBFS,
						pageID: d.id,
						subNav: []
					},
					n = j.indexOf(d.alias),
					o = k.indexOf(d.url); ( - 1 == n || !d.isBFS && -1 == o) && g.push(l)
				}
			});
			return g
		},
		B = function(d) {
			try {
				var e = a(d);
				e.attr("src").endsWith("/null") && e.attr("src", "https://dudamobile-themes.s3.amazonaws.com/webs/theme_c/transparent.gif");
				if (28 < e.css("width").replace("px", "")) {
					e.css("width", "28px");
					e.css("height", "auto");
					var g = e.parent().css("height").replace("px", "") - e.css("height").replace("px", ""),
					j = Math.round(g / 2);
					e.css("margin-top", "" + j + "px");
					e.css("margin-bottom", "" + j + "px")
				}
			} catch(k) {}
		},
		z = function() {
			a(".navEditorInnerPanel ol.navEditorLinks#navPages").show();
			a("#navigationIsEmptyNotification").hide();
			a("#staticOL [original_id\x3d'dmMore']").show();
			a("#staticOL [original_id\x3d'dmLess']").show();
			a.layoutNav.restrictions.noLessButton && a("#staticOL [original_id\x3d'dmLess']").hide();
			a.layoutNav.restrictions.noMoreButton && a("#staticOL [original_id\x3d'dmMore']").hide();
			k.isExpandable && (a("#staticOL [original_id\x3d'dmMore']").hide(), a("#staticOL [original_id\x3d'dmLess']").hide());
			var d = "true" == a.dmfw.getPreviewElement(".hiddenNavPlaceHolder ul#dmNav").attr("hwa"),
			e = a(".navEditorInnerPanel #navPages.navEditorLinks").children("li").size();
			if (0 == e || 1 == e && d) a("#navigationIsEmptyNotification").show(),
			a("ol.navEditorLinks").css("border-bottom-style", "none"),
			a(".navEditorInnerPanel ol.navEditorLinks#navPages").hide(),
			a(".emptyNavAddLink").unbind("click").click(function() {
				a.navigationUtil.addToNavigation(dmStr["ui.nee.navigation.newItemTitle"], a.dmx.site.baseUrl, !0)
			}),
			a(".emptyNavSelectNav").neePopUpDiv(a("#selectNavigationWrapper"), {
				init: function(d) {
					a.navigationUtil.initNavSelectWindow();
					d = d.closest(".popupWinExample").outerHeight();
					a("#selectNavigationWindow").css("height", d - 125 + "px")
				},
				maxScreenSize: !0,
				popupAdditionalClass: "popUpSelectNavClass"
			}),
			a("#staticOL [original_id\x3d'dmMore']").hide(),
			a("#staticOL [original_id\x3d'dmLess']").hide(),
			a.dmx.current.element.is(".backToHomePlaceHolder") || a("#staticOL [original_id\x3d'backToHome']").hide()
		},
		v = function(d, e) {
			var j = d.find(".navLinkIconImage:first").attr("_src");
			a.isIconClass(j) && (d.find(".navLinkIconImage:first").attr("src", j), d.find(".navLinkIconImage:first").attr("_src", ""), d.find(".navLinkIconImage:first").unbind("load").load(function() {
				B(this)
			}), d.find(".navLinkIconImage:first").unbind("error").error(function() {
				B(this)
			}));
			var k = e.elementID;
			if (k && "" !== k && (j = a(a.dmfw.getPreviewElement("#hiddenNavPlaceHolder #" + k).get(0)), 0 < j.length)) if ((k = "backToHome" != k ? j.find(".navIcon:first").css("background-image") : j.find(".icon:first").css("background-image")) && "none" != k && !j.find("a:first").attr("icon-name")) {
				if (k.startsWith("url")) var j = k.indexOf("url("),
				l = k.indexOf(")", j),
				k = k.substring(j + 4, l);
				k.startsWith('"') && k.endsWith('"') && (k = k.substring(1, k.length - 1));
				k.endsWith("/null");
				g || a.changeColor(k, "#333").then(function(a) {
					d.find(".navLinkIconImage").attr("src", a);
					d.find(".navLinkIconImage").removeClass("hiddenVisibility")
				});
				e.linkDesign.itemIcon = k
			} else if (k = j.find("a:first").attr("icon-name")) d.find(".navLinkIcon img").replaceWith("\x3cspan class\x3d'navLinkIconImage fontIcon " + k + "'\x3e\x3c/span\x3e"),
			e.linkDesign.itemIcon = k,
			e.linkDesign.navColor = j.find(".navIcon:first").css("color")
		},
		D = function(d, j, n) {
			for (var o = 0; o < j.length; o++) {
				var r = j[o];
				if (r.inNavigationList) {
					r.parentType = j;
					var s = n.tmpl(r),
					E = a(s);
					r.otherPage && s.addClass("dmOtherPage");
					r.elementID == k.selectedID && (m = s);
					v(s, r);
					u(s);
					void 0 != r.subNav && 0 < r.subNav.length && (E.find(".navLinkArrow").removeClass("hiddenVisibility"), D(E.find("ol:first"), r.subNav, n));
					E.data("dataItem", r);
					k.inPagesEditor &&
					function(d) {
						d.data("remove",
						function(e) {
							var j = [d],
							j = j.concat(a.dmnavw.getItemsForDeletion(d, a("#navPages"))),
							l = j[0].data("dataItem");
							a.each(j,
							function(d, j) {
								var l = j.data("dataItem"),
								m = Z(l, k.links);
								m && m.splice(m.indexOf(l), 1);
								R(l, e); (!a.dmfw.isPT() || !g) && j.remove();
								_removalHelper = function(d) {
									a(a.dmfw.getPreviewElement("#" + d)).remove();
									_expandCollapse(!1)
								}
							});
							j = {
								params: {
									itemIDs: a.map(j,
									function(a) {
										return a.attr("original_id")
									})
								},
								clientChange: function(d) {
									a.each(d.itemIDs,
									function(a, d) {
										try {
											_expandCollapse(!0),
											_removalHelper(d)
										} catch(e) {}
									})
								},
								serverChange: function(d) {
									var j = l.pageAlias ? a.dmx.pagesByAlias()[l.pageAlias] : null,
									j = j && j.isTemplate,
									m = e && !j && l.pageAlias && l.pageAlias != HOME_PAGE_DESIGN_ALIAS && l.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS,
									j = "/pages/" + a.dmx.page.id + "/removefromnav?itemId\x3d" + d.itemIDs[0];
									d = d.itemIDs.slice(1);
									m && (j += "\x26pageToDel\x3d" + l.pageID, j += "\x26itemUrl\x3d" + escape(l.itemUrl));
									a.dmPost({
										url: j,
										data: {
											list: d
										},
										success: function() {
											m && k.afterRemoveCallback && k.afterRemoveCallback(e);
											a.dmfw.isPT() && a.dmx.events.trigger("pageDeleted");
											g || (z(), a.dmPreviewSaved())
										}
									})
								}
							};
							a.changePage(j, !0)
						});
						d.data("hide",
						function(a, e) {
							ea(d, a, e)
						});
						d.data("changeTitle",
						function(a) {
							var e = d.find(".navLinkTitle:first");
							W(d, e, a)
						})
					} (E);
					k.listItemCallback && k.listItemCallback(s);
					F(s);
					r.deleted && (s.addClass("hiddenElement"), s.find(".navLinkButtonHidden:first").attr("title", dmStr["ui.nee.navigation.20"]));
					d.append(s)
				}
				r.inNavigationList || l.push(r);
				e.dontShowColorHandlers && E.find(".navLinkButtonColor").remove()
			}
		},
		E = function(d) {
			var l = a(d);
			l.find(".navEditorLink:first").unbind("mouseover").mouseover(function() {
				a(".navEditorLink.navLinkBGHover").each(function() {
					G(this, "navLinkBGHover", ""); (!g || j) && a(this).find(".navLinkButtonsWrapper").addClass("displayNone");
					g || (a(this).find(".navLinkButtonsWrapper").addClass("displayNone"), a(this).find(".navLinkTitle").css("width", "initial"))
				});
				K(this, !0)
			});
			l.find(".navEditorLink:first").unbind("mouseout").mouseout(function() {
				K(this, !1)
			});
			l.find(".navLinkButton").unbind("mouseover").mouseover(function() {
				G(this, "navLinkButtonBG", e.componentsClassNames.navButtonHoverClass)
			});
			l.find(".navLinkButton").unbind("mouseout").mouseout(function() {
				G(this, e.componentsClassNames.navButtonHoverClass, "navLinkButtonBG")
			});
			k.isExpandable ? (a(d).find(".navLinkButtonIcon:first").hide(), a(d).find(".navLinkButtonColor:first").hide()) : (a(d).find(".navLinkButtonIcon:first").click(function() {
				var e = a(d).data("dataItem"),
				g = a(".rightPanel");
				g.empty();
				a.navigationUtil.selectNavigationItem(e.elementID);
				I(e, "Icon");
				g.neeIconsWidget({
					wholeData: e,
					parentElement: a(d)
				})
			}), a.layoutNav.restrictions.noIconButton && a(d).find(".navLinkButtonIcon:first").hide(), a(d).find(".navLinkButtonColor:first").click(function() {
				var e = a(d).data("dataItem"),
				g = a(".rightPanel");
				g.empty();
				a.navigationUtil.selectNavigationItem(e.elementID);
				I(e, "Color");
				g.neeNavLinkColor({
					wholeData: e,
					parentElement: a(d)
				})
			}), a.layoutNav.restrictions.noColorButton && a(d).find(".navLinkButtonColor:first").hide(), g || (l.find(".navLinkIcon:first").click(function() {
				var e = a(d).data("dataItem"),
				g = a(".rightPanel");
				g.empty();
				a.navigationUtil.selectNavigationItem(e.elementID);
				I(e, "Icon");
				g.neeIconsWidget({
					wholeData: e,
					parentElement: a(d)
				})
			}), a.layoutNav.restrictions.noIconButton && l.find(".navLinkIcon:first").hide()));
			g || (l.find(".navLinkTitle:first").click(function(d, e) {
				var g = a(this),
				j = g.next("input");
				g.addClass("displayNone");
				j.removeClass("displayNone");
				var k = l.outerWidth(!0);
				e || a.navigationUtil.selectNavigationItem(l.attr("original_id"));
				j.css("width", k - 290);
				j.focus();
				j.attr("value", Y(g))
			}), l.find(".navLinkTitleInput:first").focusout(function() {
				var d = a(this),
				e = l.find(".navLinkTitle:first");
				a.navigationUtil.selectNavigationItem(null);
				d.addClass("displayNone");
				d = d.attr("value");
				e.removeClass("displayNone");
				W(l, e, d)
			}), l.find(".navLinkTitleInput:first").keypress(function(d) {
				13 == d.which && a(this).blur()
			}))
		},
		F = function(d) {
			var e = a(d);
			e.find(".navLinkMover:first").mousedown(function() {
				O(this, !0)
			});
			e.find(".navLinkMover:first").mouseup(function() {
				O(this, !1)
			});
			if (j && g) {
				var k = e.find(".navEditorLink:first");
				k.mousedown(function(d) {
					a(d.target).is(".navLinkArrow") || O(a(this).find(".navLinkMover:first"), !0)
				});
				k.mouseup(function(d) {
					a(d.target).is(".navLinkArrow") || (clearTimeout(a.draggingTimeout), O(a(this).find(".navLinkMover:first"), !1))
				})
			}
			e.find(".navLinkArrow:first").click(function() {
				C(this)
			});
			var l = e.find(".navLinkButtonHidden:first");
			l.unbind("click").click(function() {
				var d = a(l).closest("li");
				ea(d, !d.is(".hiddenElement"))
			});
			E(d);
			a(d).find(".navLinkButtonLink:first").click(function() {
				var e = a(d).data("dataItem"),
				g = a(".rightPanel");
				g.empty();
				a.navigationUtil.selectNavigationItem(e.elementID);
				I(e, "Link");
				var j = a.dmfw.getPreviewElement().find("#" + e.elementID + ":not(.navButtonLi, .navButtonLi *)");
				g.neeLinksWidget({
					current: {
						element: j.find("a:first"),
						editable: a.dmfw.editables("link"),
						navLink: {
							element: j
						}
					},
					noSurroundButton: !0,
					noRemoveLink: !0,
					selectTextOnInit: e.itemTitle == dmStr["ui.nee.navigation.newItemTitle"],
					onTitleChanged: function(a) {
						ca(e, e.elementID, a);
						I(e, a)
					},
					onNavTargetChange: function(d, g) {
						a.dmnavw.changeLinkTarget(e, e.elementID, d, g)
					},
					success: function() {
						a.refreshLayoutNavigations()
					}
				})
			})
		},
		I = function(d) {
			a(".backButton").unbind("click");
			a.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						a.navigationUtil.restoreNavLinksUI(d.elementID)
					}
				},
				{
					title: d.itemTitle
				}]
			});
			k.isExpandable && (d && d.itemTitle ? a("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.21"]) : a("#contentTitle.breadcrumb-first").text(dmStr["ui.nee.navigation.1"]))
		},
		G = function(d, e, g) {
			a(d).removeClass(e);
			a(d).addClass(g)
		},
		K = function(d, e) {
			if (e) {
				G(d, "", "navLinkBGHover");
				if (!g || j) {
					a(d).find(".navLinkButtonsWrapper").removeClass("displayNone");
					var k = a(d).outerWidth(!0);
					a(d).find(".navLinkTitle").css("width", k - 60)
				}
				if (!g && !a.layoutNav.restrictions.noHoverCurrent && 0 == a.dmfw.getPreviewElement(".highlightedNavItem").size()) {
					var k = a(d).closest(".navEditorLinkAndSub").attr("original_id"),
					l = a.dmfw.getPreviewElement("#" + k + ":not(.hiddenNavPlaceHolder *)"),
					l = l.is("a") ? l: l.find("a:first"),
					l = 0 == l.size() ? a.dmfw.getPreviewElement("." + k + " a:not(.hiddenNavPlaceHolder *)") : l,
					l = 0 == l.size() ? a.dmfw.getPreviewElement("." + k.replace("_item", "a") + ":not(.hiddenNavPlaceHolder *)") : l;
					"YAHOO" == a.dmx.site.dmProductType ? l.addClass("yahooHoveredNavItem") : l.addClass("hoveredNavItem")
				}
				g || (a(d).find(".navLinkButtonsWrapper").removeClass("displayNone"), k = a(d).outerWidth(!0), a(d).find(".navLinkTitle").css("width", k - 300))
			} else {
				G(d, "navLinkBGHover", "");
				if (!g || j) a(d).find(".navLinkButtonsWrapper").addClass("displayNone"),
				a(d).find(".navLinkTitle").css("width", "initial");
				g || (k = a(d).closest(".navEditorLinkAndSub").attr("original_id"), l = a.dmfw.getPreviewElement("#" + k + ":not(.hiddenNavPlaceHolder *)"), l = l.is("a") ? l: l.find("a:first"), l = 0 == l.size() ? a.dmfw.getPreviewElement("." + k + " a:not(.hiddenNavPlaceHolder *)") : l, l = 0 == l.size() ? a.dmfw.getPreviewElement("." + k.replace("_item", "a") + ":not(.hiddenNavPlaceHolder *)") : l, "YAHOO" == a.dmx.site.dmProductType ? l.removeClass("yahooHoveredNavItem") : l.removeClass("hoveredNavItem"), a(d).find(".navLinkButtonsWrapper").addClass("displayNone"), a(d).find(".navLinkTitle").css("width", "initial"))
			}
		},
		J = function(a) {
			a && a.find(".navLinkIconImage").each(function() {
				B(this)
			})
		},
		C = function(d) {
			a(d).toggleClass(e.componentsClassNames.itemArrowExpandedClass);
			var k = a(d).closest(".navEditorLinkAndSub").children("ol");
			"block" == k.css("display") ? k.css("display", "none") : k.css("display", "block");
			setTimeout(J, 600);
			g && a(d).closest(".navEditorLinkAndSub").children("ol").find(".navLinkTitle").each(function() {
				a(this).closest("li").outerWidth(!0);
				var d = Math.max(a(this).parents(".navEditorLinkAndSub").size(), 1);
				j || a(this).css("width", 170 - 20 * (d - 1))
			})
		},
		N = function(d, e) {
			if (e) _expandCollapse(!0),
			a(d).addClass("draggedItem");
			else if (a(d).removeClass("draggedItem"), !g) {
				var j = a(d).outerWidth(!0);
				a(d).find(".navLinkTitle").css("width", j - 300)
			}
		},
		O = function(d, e) {
			var g = a(d).closest(".navEditorLinks");
			if (e) {
				var j = a(d).closest("li");
				"block" == a(j).children("ol").css("display") && (C(a(j).find(".navLinkArrow:first")), a(j).attr("open_sub", "true"));
				g.nestedSortable({
					disabled: !1
				});
				a(d).closest("li").css("cursor", "move")
			} else g.nestedSortable({
				disabled: !0
			}),
			a(d).closest("li").css("cursor", "")
		},
		ra = function(a, d) {
			for (var e = 0; e < a.length; e++) {
				var g = a[e];
				if (g.elementID == d) return g.subNav;
				if (void 0 != g.subNav && 0 < g.subNav.length && (g = ra(g.subNav, d), null != g)) return g
			}
			return null
		},
		R = function(a) {
			for (var d = a.subNav,
			e = 0; e < d.length; e++) R(d[e], void 0);
			a.subNav = {}
		};
		_expandCollapse = function(d) {
			var e = NEFW.PREVIEW.get(0).contentWindow;
			e.jQuery && (d ? e.jQuery.DM.expandNavigation(!1) : (e.jQuery.DM.restoreDefaultNavigationStyles(), e.jQuery.DM.fullCollapseNavigation()));
			if (!g || j) try {
				a.dmx.current.editable.inlineEditor.draw()
			} catch(k) {}
		};
		var ea = function(d, e, j) {
			if (d) {
				var l = d.data("dataItem");
				if (l.otherPage) {
					d = l.itemUrl;
					if (l.isFromScratchLegacy || l.isBFS || l.pageFromScratch) d = "/site/" + a.dmx.site.alias + "/" + l.pageAlias;
					a.dmsrv.addToNav(l.pageID, l.itemTitle, d, l.pageAlias == HOME_PAGE_DESIGN_ALIAS,
					function(a) {
						k.onNavAddFromOtherPages && k.onNavAddFromOtherPages(a)
					})
				} else {
					var m = d.attr("original_id");
					"/modifylink/";
					l.deleted = e;
					d.toggleClass("hiddenElement", e);
					d.find(".navLinkButtonHidden:first").attr("title", e ? dmStr["ui.nee.navigation.22"] : dmStr["ui.nee.navigation.23"]);
					a.changePage({
						params: {
							itemID: m
						},
						clientChange: function(d) {
							k.inPagesEditor || a.dmPreviewSaving();
							d = d.itemID;
							_expandCollapse(!0);
							a(a.dmfw.getPreviewElement(".dmNavCustom #" + d)).css("display", "").toggleClass("dmHideFromNav", e);
							_expandCollapse(!1);
							setTimeout(a.refreshLayoutNavigations, 0)
						},
						serverChange: function(d) {
							a.dmPostWithHistory({
								url: "/pages/" + a.dmx.page.id + "/hidefromnav?hide\x3d" + (e ? "true": "false") + "\x26itemId\x3d" + d.itemID,
								data: {},
								success: function() {
									g || (z(), a.dmPreviewSaved());
									j && j()
								}
							})
						}
					},
					!0)
				}
			}
		},
		Z = function(a, d) {
			if (null != d) for (var e = 0; e < d.length; e++) {
				if (d[e] == a) return d;
				found = Z(a, d[e].subNav);
				if (null != found) return found
			}
			return null
		},
		Y = function(a) {
			if (a) return a = jQuery.trim(a.text()),
			dmStr["ui.nee.navigation.19"] == a ? "": a
		},
		W = function(a, d, e) {
			e && (e = jQuery.trim(e));
			var k = Y(d);
			d.removeClass("navNoTitle"); ! e || "" == e ? (d.text(g ? j ? dmStr["ui.nee.navigation.18"] : "": dmStr["ui.nee.navigation.19"]), d.addClass("navNoTitle")) : d.text(e);
			k != e && ca(a.data("dataItem"), a.attr("original_id"), e)
		},
		ca = function(d, e, g) {
			d.itemTitle != g && (d.itemTitle = g, a.changePage({
				params: {
					itemID: e,
					newTitle: g
				},
				clientChange: function(d) {
					a(a.dmfw.getPreviewElement("[id\x3d" + d.itemID + "]")).each(function(e, g) {
						g = a(g);
						var j = g.find("a:first").find(".navText:first");
						0 == j.size() && (j = g.find("a:first").find("div:first"));
						0 == j.size() && (j = g.find("span.text:first"));
						0 == j.size() && (j = g.find("a:first").find(".navItemText:first"));
						j.text(d.newTitle)
					});
					var e = NEFW.PREVIEW.get(0).contentWindow;
					"dmLess" == d.itemID && e.setDMAjaxLessNavigationParameter(d.newTitle);
					"dmMore" == d.itemID && e.setDMAjaxMoreNavigationParameter(d.newTitle);
					"backToHome" == d.itemID && e.setDMAjaxBackToHomeParameter(d.newTitle);
					a.refreshLayoutNavigations()
				},
				serverChange: function(e) {
					var g = -1;
					if (d.pageFromScratch || d.otherPage && d.pageAlias != HOME_PAGE_DESIGN_ALIAS) g = d.pageID;
					var j = "/pages/" + a.dmx.page.id + "/changeInNav?itemId\x3d" + e.itemID + "\x26itemTitle\x3d" + encodeURIComponent(e.newTitle) + "\x26targetPageId\x3d" + g;
					a.dmPostWithHistory({
						url: j,
						data: {},
						success: function() {
							0 <= g && a.each(a.dmx.sitePages,
							function(a, d) {
								d.id == g && (d.title = e.newTitle)
							})
						}
					})
				}
			},
			!0))
		}
	};
	a.utils = a.utils || {};
	a.ptNavGlobal = a.ptNavGlobal || {};
	a.utils.wait = function(e) {
		return a.Deferred(function(a) {
			setTimeout(a.resolve, e)
		})
	}
})(jQuery);$.extend({
	dmnavw: {
		getItemsForDeletion: function(a, e) {
			var d = [],
			g = a.data("dataItem"),
			j = g.pageAlias,
			k = $.dmx.pagesByAlias();
			j && (k[j] && k[j].isFromScratchLegacy) && (k = $.dmx.getFlattenNavList(), $.each(k,
			function(a, k) {
				k.pageAlias == j && k.elementID != g.elementID && d.push(e.find("li[original_id\x3d" + k.elementID + "]"))
			}));
			return d
		},
		changeLinkTarget: function(a, e, d, g) {
			$.changePage({
				params: {
					itemID: e,
					newTarget: g ? "remove": d,
					remove: g
				},
				clientChange: function(a) {
					$($.dmfw.getPreviewElement("[id\x3d" + a.itemID + "]")).each(function(d, e) {
						e = $(e);
						var g = e.find("a:first");
						a.remove ? g.removeAttr("target") : g.attr("target", a.newTarget)
					});
					$.refreshLayoutNavigations()
				},
				serverChange: function(a) {
					$.dmPostWithHistory({
						url: "/pages/" + $.dmx.page.id + "/changeInNav?itemId\x3d" + a.itemID + "\x26itemTarget\x3d" + a.newTarget,
						data: {},
						success: function() {}
					})
				}
			},
			!0)
		}
	}
});
function NEEClickToMap() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return "yahoo" == commonProps["common.mapsProvider"] ? dmStr["ui.nee.widgets.3.1"] : dmStr["ui.nee.widgets.3"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtMobileMap";
	this.ext = {
		id: "mapextension",
		preId: "clicktomap",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			zip: dmStr["ui.nee.click2Map.2.zipCode"],
			description: dmStr["ui.nee.click2Map.3"],
			street: dmStr["ui.nee.click2Map.4"],
			state: dmStr["ui.nee.click2Map.5"],
			surround: !0,
			needs_premium_validation: !0,
			country: dmStr["ui.nee.click2Map.6"],
			city: dmStr["ui.nee.click2Map.7"],
			provider: commonProps["common.mapsProvider"],
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "clicktomap";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/map.png",
			editableDraggedText: "yahoo" == commonProps["common.mapsProvider"] ? dmStr["ui.nee.widgets.3.1"] : dmStr["ui.nee.widgets.3"]
		}
	};
	this.editorDesc = "Enable customers to find your business location nearest to them.";
	this.inlineEditorProperties = {
		title: "yahoo" == commonProps["common.mapsProvider"] ? dmStr["ui.nee.widgets.3.1"] : dmStr["ui.nee.widgets.3"]
	};
	this.rightPanelElementSelector = "#generalClickToMap";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/clickToMap/one.buttonsHtmlClickToMapAddress.jsp": "/editor/nee/editableObjects/clickToMap/nee.buttonsHtmlClickToMapAddress.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				a.clickToMapOnTabReadyAddress(e)
			},
			onTabClose: function(a, d) {
				$.dmHideAllPagesButtons();
				d && d()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEClickToMap.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEClickToMap.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorClickToMapSelected")
};NEEClickToMap.prototype.clickToMapOnTabReadyAddress = function(a, e) {
	var d = $.dmx.current.editable.element;
	"YJP" == $.dmx.site.dmProductType && "google" == d.attr("provider") && d.attr("zip", "");
	$("#mapDescription").val(d.attr("description"));
	$("#mapDescription").blur(function() {
		_updateDescInfo()
	});
	$("#mapDescription").keypress(function(a) {
		13 == a.keyCode && _updateDescInfo()
	});
	_validateDescChanged = function() {
		var a = !1;
		$("#mapDescription").val() != d.attr("description") && (a = !0);
		return a
	};
	_updateDescInfo = function() {
		if (_validateDescChanged()) {
			var a = {
				provider: commonProps["common.mapsProvider"],
				description: $("#mapDescription").val()
			};
			$.changePage({
				clientChange: function() {
					d.find(".text").html(a.description)
				},
				serverChange: function() {
					$.dmsrv.updateExtension(d, a)
				}
			})
		}
	};
	_restoreMapUI = function() {
		var a = $(".rightPanel");
		a.empty();
		$.dmfw.setEditorBreadcrumb(null);
		$.dmLoad(a, "/editor/nee/editableObjects/clickToMap/nee.buttonsHtmlClickToMapAddress.jsp",
		function() {
			NEEClickToMap.prototype.clickToMapOnTabReadyAddress(a, !0)
		})
	};
	_setMapBreadcrumb = function(a) {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreMapUI()
				}
			},
			{
				title: a
			}]
		})
	};
	_showSelectedMapChosen = function() {
		$("#mapGeneralSelection").hide();
		$(".mapDisplayResults").hide();
		$("#mapGoogleListingSearch").hide();
		$("#mapShowRestaurantTitle").text($.dmx.current.element.attr("business"));
		$("#mapShowMapAddr").text($.dmx.current.element.attr("faddr"));
		$("#mapTestGoogle").click(function(a) {
			a.preventDefault();
			$.dmfw.openPopupFromUrl("/editor/nee/editableObjects/clickToMap/nee.testmap.jsp", {
				forceWidth: "660px",
				forceHeight: "560px",
				init: function() {
					$("#mapAddressPopWrongOne").text(dmStr["ui.nee.clickToMap.125"]);
					$("#mapAddressPopWrongTwo").text(dmStr["ui.nee.clickToMap.126"]);
					$("#mapIframe iframe").attr("src", d.attr("href"));
					$("#mapPopSearchAgain").unbind("click").click(function() {
						$(".closeThis").trigger("click");
						_handleMapGoogle(!1)
					});
					if ("YJP" == $.dmx.site.dmProductType || 3 == dm_account_locale) $("#mapIframe .mapIframeReson").hide(),
					$("#mapIframe .jpText").show()
				}
			})
		});
		$("#menuFoundNotRightBuis").unbind("click").click(function() {
			_handleMapGoogle(!1)
		});
		$("#mapGoogleListingChosen").show();
		$(".mapSearchSPShowResults").show()
	};
	_handleMapResultList = function() {
		$(".menuResultLine").unbind("click").click(function() {
			var a = $(this),
			e = {
				provider: "google",
				street: a.attr("street") ? a.attr("street") : "",
				city: a.attr("city") ? a.attr("city") : "",
				state: a.attr("state") ? a.attr("state") : "",
				zip: a.attr("zip") ? a.attr("zip") : "",
				country: a.attr("country") ? a.attr("country") : "",
				lat: a.attr("lat") ? a.attr("lat") : "",
				lon: a.attr("lon") ? a.attr("lon") : "",
				faddr: a.attr("faddr") ? a.attr("faddr") : "",
				dmMapSource: "google",
				business: a.attr("buisName")
			};
			$.changePage({
				clientChange: function() {
					d.attr("dmMapSource", a.attr("google"));
					d.attr("business", a.attr("buisName"));
					d.attr("city", a.attr("city") ? a.attr("city") : "");
					d.attr("country", a.attr("country") ? a.attr("country") : "");
					d.attr("state", a.attr("state") ? a.attr("state") : "");
					d.attr("street", a.attr("street") ? a.attr("street") : "");
					d.attr("zip", a.attr("zip") ? a.attr("zip") : "");
					d.attr("lat", a.attr("lat") ? a.attr("lat") : "");
					d.attr("lon", a.attr("lon") ? a.attr("lon") : "");
					d.attr("faddr", a.attr("faddr") ? a.attr("faddr") : "");
					d.attr("provider", "google")
				},
				serverChange: function() {
					$.dmsrv.updateExtension(d, e)
				}
			});
			_showSelectedMapChosen(a)
		})
	};
	_handleMapGoogle = function(a) {
		var d = !1;
		a && $.dmx.current.element.attr("business") && "" != $.dmx.current.element.attr("business") && (d = !0);
		d ? _showSelectedMapChosen(null, !0) : ($("#mapGeneralSelection").hide(), $(".mapDisplayResults").hide(), $("#mapDudaMapChosen").hide(), $(".mapSearchSPShowResults").hide(), $("#mapGoogleListingSearch").show(), $("#mapGoogleListingChosen").show(), $("#mapGoogleWebAdress").val("" != $("#mapGoogleWebAdress").val() ? $("#mapGoogleWebAdress").val() : $.dmx.site.baseUrl), $("#mapGoogleCountry").val($.dmx.current.element.attr("country")), _validateMapInput = function() {
			var a = !0,
			d = $("#mapGoogleZip").val(),
			e = $("#mapGoogleCity").val();
			if ("" == jQuery.trim(d) || jQuery.trim(d) == dmStr["ui.nee.clickToMap.107"]) a = !1;
			"" != jQuery.trim(e) && (a = !0);
			a || $.dmfw.showPromptError($("#mapGoogleZip"), dmStr["ui.nee.clickToMap.127"], {
				adjustY: 4,
				maxWidth: "100",
				at: "bottom center",
				my: "top center"
			});
			return a
		},
		$("#mapGoogleDoSearch").unbind("click").click(function() {
			var a = $("#mapGoogleZip").val(),
			d = $("#mapGoogleCountry").val(),
			e = $("#mapGoogleWebAdress").val(),
			g = $("#mapGoogleCity").val();
			_validateMapInput() && ("" == e && (e = $.dmx.site.baseUrl), $.dmLoading($("#_editor")), $.dmGet({
				url: "/sites/" + $.dmx.site.id + "/searchgoogleplacesbypostal/?country\x3d" + d + "\x26zip\x3d" + a + "\x26url\x3d" + encodeURI(e) + "\x26city\x3d" + encodeURI(g) + "\x26limit\x3d20",
				success: function(d) {
					$(".mapDisplayResults").hide();
					$("#mapSearchResults").hide();
					$("#mapNoSearchResults").hide();
					$.dmUnblockUI();
					if (0 != d.length) {
						$(".mapDisplayResults").removeClass("mapNoBorder");
						$("#mapSearchResults").empty();
						$("#mapSearchResults").append($("\x3cdiv id\x3d'mapResultsHeader'\x3e\x3c/div\x3e").html(dmStr["ui.nee.clickToMap.128"] + " " + d.length + " " + (1 == d.length ? dmStr["ui.nee.clickToMap.129"] : dmStr["ui.nee.clickToMap.130"])));
						for (var e = 0; e < d.length; e++) if (d[e]) {
							var g = d[e].businessName,
							j = d[e].address,
							g = $("\x3cdiv class\x3d'menuResultLine'\x3e\x3c/div\x3e").html(g).attr("buisName", g).attr("buisAddr", j).attr("buisID", d[e].id).attr("city", d[e].city).attr("country", d[e].country).attr("state", d[e].state).attr("street", d[e].street).attr("lat", d[e].lat).attr("lon", d[e].lon).attr("zip", a).attr("faddr", d[e].address);
							$("\x3cdiv class\x3d'menuResultLineAddress'\x3e\x3c/div\x3e").html(j).appendTo(g);
							$("#mapSearchResults").append(g);
							_handleMapResultList(g)
						}
						$("#mapSearchResults").show()
					} else $(".mapDisplayResults").addClass("mapNoBorder").find("#mapNoSearchResults").show();
					$(".mapDisplayResults").show()
				}
			}))
		}), $('[id^\x3d"mapGoogle"]').keypress(function(a) {
			13 == a.keyCode && ($(this).blur(), $("#mapGoogleDoSearch").trigger("click"))
		}))
	};
	_handleMapDuda = function() {
		$("#mapGeneralSelection").hide();
		$(".mapDisplayResults").hide();
		$("#mapGoogleListingChosen").hide();
		$("#mapDudaMapChosen").show();
		$("#mapDmCountry").on("change",
		function() {
			"US" != $(this).val() ? ($("#mapDmStateLabel").css("color", "#C1CDCD"), $("#mapDmState").val(""), $("#mapDmState").attr("disabled", "disabled"), $(".mapDmStateWrapper").hide()) : ($("#mapDmStateLabel").css("color", ""), $("#mapDmState").removeAttr("disabled"), $(".mapDmStateWrapper").show())
		});
		$("#mapDmStreetAddress").val(d.attr("street"));
		$("#mapDmCity").val(d.attr("city"));
		$("#mapDmState").val(d.attr("state"));
		$("#mapDmCountry").val(d.attr("country"));
		$("#mapDmZip").val(d.attr("zip"));
		$("#mapDmCountry").trigger("change");
		$('[id^\x3d"mapDm"]').blur(function() {
			_updateAddrInfo()
		});
		$('[id^\x3d"mapDm"]').keypress(function(a) {
			13 == a.keyCode && _updateAddrInfo()
		});
		$("#mapTestMap").click(function(a) {
			a.preventDefault();
			$.dmfw.openPopupFromUrl("/editor/nee/editableObjects/clickToMap/nee.testmap.jsp", {
				forceWidth: "660px",
				forceHeight: "560px",
				init: function() {
					$("#mapAddressPopWrongOne").text(dmStr["ui.nee.clickToMap.125"]);
					$("#mapAddressPopWrongTwo").text(dmStr["ui.nee.clickToMap.126"]);
					$("#mapIframe iframe").attr("src", d.attr("href"));
					$("#mapPopSearchAgain").unbind("click").click(function() {
						$(".closeThis").trigger("click")
					});
					if ("YJP" == $.dmx.site.dmProductType || 3 == dm_account_locale) $("#mapIframe .mapIframeReson").hide(),
					$("#mapIframe .jpText").show()
				}
			})
		});
		_validateAddrChanged = function() {
			var a = !1;
			if ($("#mapDmStreetAddress").val() != d.attr("street") || $("#mapDmCity").val() != d.attr("city") || $("#mapDmCountry").val() != d.attr("country") || $("#mapDmZip").val() != d.attr("zip") || $("#mapDmState").val() != d.attr("state")) a = !0;
			return a
		};
		_updateAddrInfo = function() {
			if (_validateAddrChanged()) {
				if ("yahoo" == commonProps["common.mapsProvider"]) {
					var a = "address\x3d" + $("#mapDmCity").val() + $("#mapDmStreetAddress").val() + $("#mapDmZip").val(),
					a = d.attr("href").replace(d.attr("href").substr(d.attr("href").indexOf("address\x3d")), a);
					d.attr("href", a)
				}
				var e = {
					provider: commonProps["common.mapsProvider"],
					street: $("#mapDmStreetAddress").val(),
					city: $("#mapDmCity").val(),
					state: $("#mapDmState").val(),
					zip: $("#mapDmZip").val(),
					country: $("#mapDmCountry").val(),
					business: "",
					dmMapSource: "dm"
				};
				$.changePage({
					clientChange: function() {},
					serverChange: function() {
						$.dmsrv.updateExtension(d, e)
					}
				})
			}
		}
	};
	$("#mapGoogleListing").unbind("click").click(function() {
		$("#mapChangableLayout").removeClass("mapDefaultChoise");
		_setMapBreadcrumb(dmStr["ui.nee.clickToMap.500"], !0);
		_handleMapGoogle(!0)
	});
	$("#mapDudaMap").unbind("click").click(function() {
		$("#mapChangableLayout").removeClass("mapDefaultChoise");
		_setMapBreadcrumb(dmStr["ui.nee.clickToMap.501"]);
		_handleMapDuda()
	});
	e = e || (d.attr("dmMapSource") && "google" == d.attr("dmMapSource") ? "google": d.attr("dmMapSource") && "dm" == d.attr("dmMapSource") ? "dm": d.attr("dmMapSource") && "yahoo" == d.attr("dmMapSource") ? "yahoo": null);
	"google" == e ? $("#mapGoogleListing").trigger("click") : "dm" == e && $("#mapDudaMap").trigger("click");
	$.dmAddAllPagesButtons(d,
	function() {
		$.dmx.current.element.attr("dmle_added_all_pages") ? $(".tipAddMap").addClass("mapNoShow") : ($(".tipAddMap").removeClass("mapNoShow"), isAdd = !1);
		a.closest(".buttonTab").find(".orangeVariableButton").unbind("click.mapFunc").on("click.mapFunc",
		function() {
			$(".tipAddMap").toggleClass("mapNoShow")
		});
		a.closest(".buttonTab").find(".blueVariableButton").unbind("click.mapFunc").on("click.mapFunc",
		function() {
			$(".tipAddMap").toggleClass("mapNoShow")
		})
	})
};NEEClickToMap.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToMapSelected"), this.disableEditInline())
};NEEClickToMap.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmMap *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEClickToMap.prototype.getElementTagsSelectors = function() {
	return "A.dmMap"
};NEEClickToMap.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEClickToMap.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEClickToMap.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEClickToMap.prototype.disableEditInline = function() {};NEEClickToMap.prototype.docReady = function() {};NEEClickToMap.prototype.getDefaultIconName = function() {
	return "location.png"
};NEEClickToMap.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEClickToMap.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {},
		e = "#mapGeneralSelection \x3e div:first-child",
		d = $.dmx.current.element,
		g = $("#mapDmStreetAddress:visible"),
		j = $("#mapDmCity:visible"),
		k = $("#mapGoogleZip:visible"),
		l = $("#mapGoogleListingChosen:visible"),
		k = 0 < g.length ? "manually": 0 < k.length || 0 < l.length ? "google": "initial",
		m = "initial" === k,
		n = "google" === k,
		o = d.attr("street") === dmStr["ui.nee.click2Map.4"],
		r = "" === d.attr("city"),
		d = "" === d.attr("street"),
		u = "ui.nee.promptMassages.2",
		s = o || r || d;
		if (s || m || n) {
			if (m) a.maxWidth = "160",
			a.adjustX = 4,
			s || (u = "ui.nee.promptMassages.22");
			else if (n) 0 < l.length && $.dmfw._closeEditorAll({
				override: !0
			}),
			u = e = "",
			$("#mapGoogleDoSearch").trigger("click");
			else if ("manually" === k) if (a.at = "bottom center", a.my = "top center", a.adjustY = 4, o || d) {
				if (d || "" === g.val()) u = "ui.nee.promptMassages.17";
				e = "#mapDmStreetAddress:visible"
			} else if (r || "" === j.val()) u = "ui.nee.promptMassages.17",
			e = "#mapDmCity:visible";
			$.dmfw.showPromptError($(e), dmStr[u], a)
		} else $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEClickToEmail() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.click2email.4"]
	};
	this.ext = {
		id: "emailextension",
		preId: "emailextension",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			description: dmStr["ui.nee.click2email.5"],
			email: "",
			wr: !0
		}
	};
	this.mindTouchId = "dmMtClickToEmail";
	this.showMindTouchHelp = !0;
	this.priority = 1;
	this.type = "emailextension";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/email.png",
			editableDraggedText: dmStr["ui.nee.widgets.17"]
		}
	};
	this.editorDesc = "Define your email account to get emails from your site visitors.";
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.click2email.4"]
	};
	this.rightPanelElementSelector = "#generalClickToEmail";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/clickToEmail/one.buttonsHtmlClickToEmailGeneral.jsp": "/editor/nee/editableObjects/clickToEmail/nee.buttonsHtmlClickToEmailGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.clickToEmailOnTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEClickToEmail.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEClickToEmail.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorClickToEmailSelected")
};NEEClickToEmail.prototype.clickToEmailOnTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#email").val(a.attr("email"));
	$("#emailTextDesc").val(a.attr("description"));
	$('[id^\x3d"email"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"email"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			email: $("#email").val(),
			description: $("#emailTextDesc").val(),
			needs_premium_validation: !1
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("email", e.email);
				a.find(".text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEClickToEmail.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToEmailSelected"), this.disableEditInline())
};NEEClickToEmail.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmEmail *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEClickToEmail.prototype.getElementTagsSelectors = function() {
	return "A.dmEmail"
};NEEClickToEmail.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEClickToEmail.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEClickToEmail.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEClickToEmail.prototype.disableEditInline = function() {};NEEClickToEmail.prototype.docReady = function() {};NEEClickToEmail.prototype.getDefaultIconName = function() {
	return "mail.png"
};NEEClickToEmail.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEClickToEmail.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = $.dmx.current.element.attr("email"),
		e = "" === a,
		a = !/.+\@.+\..+/.test(a),
		d;
		d = e ? "ui.nee.promptMassages.9": "ui.nee.promptMassages.10";
		e || a ? $.dmfw.showPromptError($("input#email"), dmStr[d], {
			adjustX: 4,
			maxWidth: "180"
		}) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEFooter() {
	this.title = function() {
		return "Footer"
	};
	this.priority = 2;
	this.type = "footer";
	this.allowTextEditing = !0;
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: "Footer",
		isDelete: !1,
		isCopy: !1,
		isMovable: !1,
		isExpandable: !1,
		isCollapsable: !1
	};
	this.rightPanelElementSelector = "#generalFooter";
	this.allowedOperations = {
		insertBefore: !1,
		insertAfter: !1,
		insertInsideTop: !0,
		insertInsideBottom: !0
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/paragraph/nee.buttonsHtmlParagraphText.jsp",
			text: "Text",
			imgSrc: "GeneralImgIcon",
			onTabReady: function() {
				$.initRichTextEditor($.dmx.current.element, !0)
			},
			onTabClose: function(a, e) {
				_RTE_Element.saveAndLock(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: "Design",
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border", "presets"],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: "More",
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						customize: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEFooter.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorFooterSelected")
};NEEFooter.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorFooterSelected"), this.disableEditInline())
};NEEFooter.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(".dmFooter") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEFooter.prototype.getElementTagsSelectors = function() {
	return ".dmFooter"
};NEEFooter.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEFooter.prototype.getCorrectElement = function(a) {
	return null == a ? NEFW.getPreviwElement(".dmFooter").get(0) : $(a).closest(".dmFooter")
};NEEFooter.prototype.getPasteLocation = function(a) {
	return {
		parent: a
	}
};NEEFooter.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEFooter.prototype.disableEditInline = function() {};NEEFooter.prototype.docReady = function() {};NEEFooter.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEFooter.prototype.onEditorClose = function() {
	null != _RTE_Element && _RTE_Element.isTextEditorVisible() && _RTE_Element.saveChanges(!0)
};
function NEEHeader() {
	this.title = function() {
		return dmStr["ui.nee.mainTabs.1"]
	};
	this.priority = 0.9;
	this.type = "header";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.mainTabs.1"],
		isDelete: !1,
		isCopy: !1,
		isMovable: !1,
		isExpandable: !1,
		isCollapsable: !1,
		isHideOnDevice: !1,
		hasAlign: !1,
		selectionOverlay: {
			overlayTitle: "header",
			background: 1,
			more: !1,
			buttonsOffset: {
				top: 1,
				left: 1
			}
		}
	};
	this.rightPanelElementSelector = "#generalHeader";
	this.allowedOperations = function(a) {
		return $(a).hasClass(".logo-div") || $(a).hasClass(".dm-title") ? {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}: {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !0,
			insertInsideBottom: !0
		}
	}
}
NEEHeader.prototype.onTabReadyGeneralNew = function(a, e) {
	var d = $.dmfw.getPreviewElement("DIV.dmHeader");
	null == d && (d = $(a));
	var g = d.find("#dm-logo-anchor"),
	j = d.find(".dm-title"),
	k = "fixHead" == d.attr("id") || d.is(".fixedPart *"),
	l = $.dmx.site.headerSkinny,
	m = !1,
	n = !1;
	k && (n = d.hasClass("dmOnlySkinny"));
	try {
		m = $.dmx.preview.wnd().jQuery.layoutManager.getLayoutElement().fixFoot ? !0 : !1
	} catch(o) {}
	_toggleHeaderLogoPreview = function(a, d) {
		var e = $.dmfw.isDudaone() ? "inline-block": "block";
		a ? (j.css("display", "none"), g.css("display", e), g.closest(".logo-div").css("display", e)) : (g.css("display", "none"), g.closest(".logo-div").css("display", "none"), j.css("display", e));
		setTimeout(function() {
			$.dmops.redrawSelection()
		},
		0);
		$.dmPostWithHistory({
			url: "/pages/" + $.dmx.header.id + "/switchheadertype?islogo\x3d" + a + "\x26display\x3d" + e,
			success: function(a) {
				$.dmops.refreshPageStyleCss(a.value, !0);
				d();
				setTimeout(function() {
					$.dmops.redrawSelection()
				},
				0)
			}
		})
	};
	_handleDisplayScreen = function(a, d, e) {
		e ? ($(".headerTopChecks").removeClass("selected"), a ? ($("#headerUseLogo").addClass("selected"), $("#header_img-txt-edit").hide(), $("#header_img-logo-edit").show()) : ($("#headerUseTitle").addClass("selected"), $("#header_img-logo-edit").hide(), $("#header_img-txt-edit").show()), d()) : _toggleHeaderLogoPreview(a ? !0 : !1,
		function() {
			$(".headerTopChecks").removeClass("selected");
			a ? ($("#headerUseLogo").addClass("selected"), $("#header_img-txt-edit").hide(), $("#header_img-logo-edit").show()) : ($("#headerUseTitle").addClass("selected"), $("#header_img-logo-edit").hide(), $("#header_img-txt-edit").show());
			d()
		})
	};
	_headerUseLogo = function(j) {
		_handleDisplayScreen(!0,
		function() {
			function j() {
				var a = "url(" + g.find("img").attr("src") + ")";
				$("#header_img-change-crop .imgBgPreviewImg").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", a);
				$(".modeFirst").click();
				$("#header_image-resize").neeSecondaryResizeTab({
					element: d.find("#dm-logo-image"),
					classToAdd: "headerLogoToggleAddDesign"
				});
				$("#header_image-align").neeSecondaryDesignAlignmentSettingsTab({
					element: d.find("#dm-logo-image"),
					forceHeadelem: d
				})
			}
			function o(a, e) {
				$(".closeThis").trigger("click");
				var g = {
					forceHeadelem: d,
					elem: d.find("#dm-logo-image"),
					element: d.find("#dm-logo-image"),
					callback: function() {
						j()
					}
				},
				g = $.extend(!0, g, e);
				$.dmops.updateCurrentImgSrc(a, g)
			}
			function r() {
				var a = $.dmfw.getPreviewElement("DIV.dmHeader");
				if (0 != a.length) $.dmops.scrollPreviewToElement(a),
				setTimeout(function() {
					$.dmfw.selectAndOpenEditor(a)
				},
				300);
				else {
					var d = new NEEHeader;
					$.dmfw.openGlobalEditor({
						editable: d
					})
				}
			}
			var v = $("#headerToOpenChange");
			$("#header_img-logo-edit").addClass("headerUseScrollInner");
			var u = "url(" + g.find("img").attr("src") + ")";
			$("#header_img-change-crop .imgBgPreviewImg").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", u);
			k && (u = $(".rightPanel"), m ? (u.find(".headerToggleFixed").hide(), u.find("#header_img-fixedOpt hr").css("visibility", "hidden")) : (u.find(".headerToggleFixed").show(), u.find("#header_img-fixedOpt hr").css("visibility", "visible")), n ? (u.find(".headerToggleSkinny").hide(), u.find("#header_img-fixedOpt hr").hide()) : (u.find(".headerToggleSkinny").show(), u.find("#header_img-fixedOpt hr").show()), $("#header_img-fixedOpt").show(), a.find("#headerFixedIsFixedOnOff").onOffBtn({
				initState: $.dmx.site.headerFixed,
				onFn: function() {
					$.dmsrv.setHeaderFixed({
						isOn: !0,
						success: function() {
							$.dmfw.refreshPreview(r)
						}
					})
				},
				offFn: function() {
					$.dmsrv.setHeaderFixed({
						isOn: !1,
						success: function() {
							$.dmfw.refreshPreview(r)
						}
					})
				}
			}), a.find("#headerFixedIsSkinnkOnOff").onOffBtn({
				initState: l,
				onFn: function() {
					$.dmsrv.setHeaderSkinny({
						isOn: !0,
						success: function() {
							$.dmfw.refreshPreview(r)
						}
					})
				},
				offFn: function() {
					$.dmsrv.setHeaderSkinny({
						isOn: !1,
						success: function() {
							$.dmfw.refreshPreview(r)
						}
					})
				}
			}));
			$(document.body).on("click", ".toggleModeButtons span",
			function(a) {
				a.stopPropagation();
				$(this).hasClass("toggleModeOn") && $(this).hasClass("modeFirst") ? $("#headerToggleShowOlyPrecent").hide() : $("#headerToggleShowOlyPrecent").show()
			});
			$("#headerLogoChange").neePopUpDiv(v.clone(), {
				init: function(a) {
					a.show();
					a.neeSecondaryIconTabs({
						tabs: {
							upload: [{
								isChange: !1
							}],
							original_images: [],
							url: []
						},
						callback: o,
						uploadBiggerButton: !0,
						isImagePickerPopup: !0
					});
					a.find("#imgCustomDonePt").unbind("click").click(function() {
						a.parent().find(".closeThis").click()
					})
				},
				toChangeFunction: o,
				showIphone: !0,
				popupAdditionalClass: e ? "ptBackgroundCustomize": "",
				showMindTouchHelp: !0,
				mindTouchId: "dmMtHeaderBackgroundImage"
			});
			$("#headerLogoCrop").neePopUpDiv($("#headerToOpenCrop").clone(), {
				init: function(a) {
					a.empty();
					var e = $("\x3cdiv class\x3d'headerLogoCropPop'\x3e\x3cdiv id\x3d'headerLogoCropPopTitle'\x3e" + dmStr["ui.crop"] + "\x3c/div\x3e\x3c/div\x3e");
					jQuery.ajax({
						url: "/editor/nee/editableObjects/common/nee.buttonsHtmlCrop.jsp",
						async: !1,
						success: function(k) {
							e.append($(k));
							k = $("\x3cdiv class\x3d'headerLogoCropPopBottom'\x3e\x3chr/\x3e\x3cdiv class\x3d'cropButton orangeBtn ptOrangeBtn'\x3e" + dmStr["ui.crop"].toUpperCase() + "\x3c/div\x3e\x3c/div\x3e");
							e.append(k);
							a.append(e);
							a.find(".doneBtn").click(function() {
								$(".closeThis").click()
							});
							a.show();
							k = g.find("img");
							a.neeSecondaryCropTab({
								originalSrc: "undefined" != k.attr("dm_orig_src") ? k.attr("dm_orig_src") : null,
								imgSrc: k.attr("src"),
								cropDim: k.attr("dm_crop_dim"),
								element: k,
								currElemDmid: k.dmid(),
								imgElem: k,
								uploadBiggerButton: !0,
								dontShowBtn: !0,
								forceHeadelem: d,
								callback: function() {
									$(".closeThis").trigger("click");
									j()
								}
							})
						}
					})
				},
				initBeforeClick: function(a) {
					a.find(".imgToCrop").empty()
				},
				showIphone: !0
			});
			$("#editImage").unbind("click").bind("click",
			function() {
				return $.dmops.editImageWithAviary(d.find("#dm-logo-image"),
				function(a, d) {
					o(d, {
						downloadImage: !0
					})
				})
			});
			$("#header_image-resize").neeSecondaryResizeTab({
				element: d.find("#dm-logo-image"),
				classToAdd: "headerLogoToggleAddDesign"
			});
			$(".modeFirst").click();
			$("#header_image-align").neeSecondaryDesignAlignmentSettingsTab({
				element: d.find("#dm-logo-image"),
				forceHeadelem: d
			})
		},
		j)
	};
	_headerUseTitle = function(a) {
		_handleDisplayScreen(!1,
		function() {
			$.dmops.checkEmptyTitle();
			e && $.ptHeader.handleHeaderTextControls();
			$("#headerTitleInput").blur(function() {
				_updateHeaderTitleInfo()
			});
			$("#headerTitleInput").keypress(function(a) {
				13 == a.keyCode && _updateHeaderTitleInfo()
			});
			_updateHeaderTitleInfo = function() {
				var a = $("#headerTitleInput").val();
				jQuery.trim(a) != jQuery.trim(j.text()) && $.changePage({
					clientChange: function() {
						j.text(a)
					},
					serverChange: function() {
						$.dmPostWithHistory({
							url: "/pages/" + $.dmx.header.id + "/changeelementtext/" + j.dmid() + "/?text\x3d" + encodeURIComponent(a),
							success: function() {
								$.dmops.checkEmptyTitle();
								$.dmops.redrawSelection()
							}
						})
					}
				})
			};
			j.length && (j.is(":visible") && "" != jQuery.trim(j.html())) && $("#headerTitleInput").val(jQuery.trim(j.text()));
			$.dmLoad($(".headerTitleTestStyleWrapper"), "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
			function() {
				$(this).neeSecondaryTextStyleTab({
					textSelector: j,
					element: j,
					sendElementNotSelector: !0
				})
			});
			setTimeout(function() {
				$.dmops.redrawSelection()
			},
			100)
		},
		a)
	};
	_handleSetHeader = function(a, d) {
		a ? _headerUseLogo(d) : _headerUseTitle(d)
	};
	g.is(":visible") || g.find("img").is(":visible") ? _handleSetHeader(!0, !0) : _handleSetHeader(!1, !0);
	if (e) {
		if ($(".ptHeaderselectBox .ptHeaderselectOption[value\x3d'Image']").data("onReady",
		function() {
			_handleSetHeader(!0)
		}), $(".ptHeaderselectBox .ptHeaderselectOption[value\x3d'Text']").data("onReady",
		function() {
			_handleSetHeader(!1)
		}), g.is(":visible") || g.find("img").is(":visible") ? $(".ptHeaderselectBox .ptHeaderselectOption[value\x3d'Image']").addClass("toSelect") : $(".ptHeaderselectBox .ptHeaderselectOption[value\x3d'Text']").addClass("toSelect"), k) {
			var r = $("#headerSkinnyFixedSection");
			m ? r.find("#headerFixedSelection").hide() : r.find("#headerFixedSelection").show();
			n ? r.find("#headerSkinnySelection").hide() : r.find("#headerSkinnySelection").show();
			$("#headerSkinnyFixedSection").show();
			$.dmx.site.headerFixed ? $("#headerFixedSelection input").prop("checked", !0) : $("#headerFixedSelection input").prop("checked", !1);
			l ? $("#headerSkinnySelection input").prop("checked", !0) : $("#headerSkinnySelection input").prop("checked", !1);
			$("#headerFixedSelection input").unbind("click").click(function() {
				$("#headerFixedSelection input").is(":checked") ? $.dmsrv.setHeaderFixed({
					isOn: !0,
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.ptHeader.refreshAfterReload()
						})
					}
				}) : $.dmsrv.setHeaderFixed({
					isOn: !1,
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.ptHeader.refreshAfterReload()
						})
					}
				});
				$(this).blur()
			});
			$("#headerSkinnySelection input").unbind("click").click(function() {
				$("#headerSkinnySelection input").is(":checked") ? $.dmsrv.setHeaderSkinny({
					isOn: !0,
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.ptHeader.refreshAfterReload()
						})
					}
				}) : $.dmsrv.setHeaderSkinny({
					isOn: !1,
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.ptHeader.refreshAfterReload()
						})
					}
				});
				$(this).blur()
			})
		}
	} else $("#headerUseLogo").unbind("click").click(function() {
		$(this).hasClass("selected") || _handleSetHeader(!0)
	}),
	$("#headerUseTitle").unbind("click").click(function() {
		$(this).hasClass("selected") || _handleSetHeader(!1)
	})
};NEEHeader.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorHeaderSelected")
};NEEHeader.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorHeaderSelected"), this.disableEditInline())
};NEEHeader.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("DIV.dmHeader, #logo-div, #logo-div *, #dm-title") && (e = !0);
	$(a).is(".dmNoScollableBody .dmUpperTabs .dmHeader *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEHeader.prototype.getElementTagsSelectors = function() {
	var a = "div.dmHeader, #logo-div, #logo-div *, #dm-title";
	$.dmfw.isDudaone() && (a = "div.dmHeader, div.dmHeader *:not(.dmNavigationWithLink, .dmNavigationWithLink *)");
	return a
};NEEHeader.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEHeader.prototype.getCorrectElement = function() {
	return $.dmfw.getPreviewElement("DIV.dmHeader").get(0)
};NEEHeader.prototype.getPasteLocation = function(a) {
	return {
		parent: a
	}
};NEEHeader.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	$.dmx.site.headerFixed && (d.isPaste = !1);
	var g = null;
	$.dmfw.isUseLayout() && $.dmx.site.headerFixed && (g = {
		editorTopClass: "layoutInlineEditorTop",
		editorBottomClass: "layoutInlineEditorBottom",
		editorRightClass: "layoutInlineEditorRight",
		editorLeftClass: "layoutInlineEditorLeft"
	});
	null != g && $.extend(d, g);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEHeader.prototype.disableEditInline = function() {};NEEHeader.prototype.docReady = function() {};NEEHeader.prototype.editorReady = function(a, e) {
	var d = e.tabToOpen || 0;
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.getTabs(),
		initTab: d
	})
};NEEHeader.prototype.onEditorClose = function() {};NEEHeader.prototype.getGeneralTabMarkupUrl = function() {
	return "/editor/nee/editableObjects/header/nee.header.jsp"
};NEEHeader.prototype.getTabs = function() {
	return {
		type: [{
			url: this.getGeneralTabMarkupUrl(),
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneralNew
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? ($.dmfw.getPreviewElement("DIV.dmHeader").attr("id"), $(a).neePtSecondaryDesignTabs({
					tabs: {
						tab_colors: ["background", "border", "presets"],
						tab_effects: ["eff_shadow"]
					}
				})) : ($.dmfw.getPreviewElement("DIV.dmHeader").attr("id"), $(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border", "presets"]
					}
				}))
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				"fixHead" == $.dmfw.getPreviewElement("DIV.dmHeader").attr("id") ? $(a).neeSecondaryDesignTabs({
					tabs: {
						customize: [],
						css: []
					}
				}) : $(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						customize: [],
						css: []
					}
				})
			}
		}]
	}
};
function NEEFixedFooter() {
	this.title = function() {
		return "Footer"
	};
	this.priority = 0.9;
	this.type = "fixedfooter";
	this.allowTextEditing = !0;
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: "Footer",
		isDelete: !1,
		isMovable: !1,
		isExpandable: !1,
		isCollapsable: !1
	};
	this.rightPanelElementSelector = "#generalFooter";
	this.allowedOperations = {
		insertBefore: !1,
		insertAfter: !1,
		insertInsideTop: !1,
		insertInsideBottom: !1
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/paragraph/nee.buttonsHtmlParagraphText.jsp",
			text: "Text",
			imgSrc: "GeneralImgIcon",
			onTabReady: function() {
				$.initRichTextEditor($.dmx.current.element, !0)
			},
			onTabClose: function(a, e) {
				_RTE_Element.saveAndLock(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: "Design",
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border", "presets"],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: "More",
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						customize: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEFixedFooter.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorFooterSelected")
};NEEFixedFooter.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorFooterSelected"), this.disableEditInline())
};NEEFixedFooter.prototype.isMember = function(a) {
	$(a).is(".fixedFooter");
	$(a).is(this.getElementTagsSelectors());
	return ! 1
};NEEFixedFooter.prototype.getElementTagsSelectors = function() {
	return ".fixedFooter, .fixedFooter *"
};NEEFixedFooter.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEFixedFooter.prototype.getCorrectElement = function(a) {
	return null == a ? NEFW.getPreviwElement(".fixedFooter").get(0) : $(a).closest(".fixedFooter")
};NEEFixedFooter.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	var g = null;
	$.dmfw.isUseLayout() && (g = {
		editorTopClass: "layoutInlineEditorTop",
		editorBottomClass: "layoutInlineEditorBottom",
		editorRightClass: "layoutInlineEditorRight",
		editorLeftClass: "layoutInlineEditorLeft"
	});
	null != g && $.extend(d, g);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEFixedFooter.prototype.disableEditInline = function() {};NEEFixedFooter.prototype.docReady = function() {};NEEFixedFooter.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEFixedFooter.prototype.onEditorClose = function() {
	null != _RTE_Element && _RTE_Element.isTextEditorVisible() && _RTE_Element.saveChanges(!0)
};
function NEELink() {
	this.priority = 1;
	this.type = "link";
	this.isWidget = !0;
	this.isExtension = !1;
	this.insertBeforeNav = !0;
	this.addClearWidget = !1;
	this.markupUrl = "/editor/nee/editableObjects/common/nee.controls-links.jsp";
	this.widget = {
		id: "dudaButtonLinkId",
		preId: "dudaButtonLinkId",
		defaults: {
			"class": "dmDefaultGradient",
			text: dmStr["ui.nee.button.4"],
			link: $.dmx.site.isFromScratch ? $.dmSiteLinkForSave("home") : $.dmx.site.baseUrl
		}
	};
	this.mindTouchId = "dmMtButton";
	this.showMindTouchHelp = !0;
	this.title = function(a) {
		var d = dmStr["ui.nee.button.3"];
		this._isLinkButton(a) ? d = dmStr["ui.nee.button.2"] : this._isPageLink(a) && (d = "Page Link");
		return d
	};
	this._isLinkButton = function(a) {
		return a.is(".dmButtonLink , .dmButtonLink *")
	};
	this._isPageLink = function(a) {
		return a.is(".dmPageLink , .dmPageLink *")
	};
	this.defaultMarkup = function() {
		return "\x3ca href\x3d'#'\x3e\x3c/a\x3e"
	};
	this.dragImageParams = function() {
		return $.dmx.current.editable._isLinkButton($($.dmx.current.element)) ? {
			editableDraggedImg: "/editor/nee/images/contentBtns/button.png",
			editableDraggedText: dmStr["ui.nee.widgets.10"]
		}: {
			editableDraggedImg: "/editor/nee/images/contentBtns/paragraph.png",
			editableDraggedText: dmStr["ui.nee.widgets.9"]
		}
	};
	this.inlineEditorProperties = {};
	this.editorDesc = "Add an action button to this page.";
	var a = this;
	this.inlineEdit = {
		bar: {
			selectElement: function(e) {
				if (!e.is(".dmOuter a , .dmOuter a * ") || !a._isLinkButton(e) && e.is(".dmOuter .dmWidget, .dmOuter .dmWidget * , .dmLinkList *,#dm-logo-anchor, [href\x3d'#'], [href\x3d'#'] *, [href\x3d'tel:']")) return null;
				var d = $($.dmx.preview.event.target);
				if (e.is("img") || 0 < e.find("img:first").length) return d.is("img") ? d: $(d.find("img:first")[0]);
				var d = "navigation" == $.dmx.current.editable.type,
				g = a._isLinkButton(e);
				return (e = e.closest("a")) && !e.attr("duda_id") ? null: d || g ? !a._isPhoneLink(e) ? e: null: e
			},
			onReady: function(e, d) {
				var g = "paragraph" == $.dmx.current.editable.type,
				j = "navigation" == $.dmx.current.editable.type,
				k = d.is("img") || 0 < d.find("img:first").length,
				l = null,
				m = $($.dmx.preview.event.target);
				k && (l = m.is("img") ? m: $(m.find("img:first")[0]));
				d.closest("a").attr("href").startsWith(["tel:", "sms:"]) || $("\x3ca href\x3d'javascript:void(0)'\x3e" + dmStr["ui.nee.button.5"] + "\x3c/a\x3e").click(function() {
					var a = d.closest("a");
					$.dmfw.previewNavigateTo({
						element: a
					})
				}).appendTo(e); (g || !k) && !j && !a._isLinkButton(d) && $("\x3ca href\x3d'javascript:void(0)'\x3e" + dmStr["ui.nee.button.6"] + "\x3c/a\x3e").click(function(a) {
					a.preventDefault();
					d.is(".dmNav a") ? $.dmfw.addEditor($.dmfw.editables("navigation"), d.closest(".dmNav"), {
						linkelement: {
							element: d
						}
					}) : g && _RTE_Element ? _RTE_Element.openSecondaryEditor(d, k ? "image": "link") : k ? $.dmfw.addEditor($.dmfw.editables("image"), l) : $.dmfw.addEditor($.dmfw.editables("link"), d, {
						parent: {
							element: $.dmx.current.element,
							editable: $.dmx.current.editable
						}
					})
				}).appendTo(e)
			}
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	}
}
NEELink.prototype._isPhoneLink = function(a) {
	return a.attr("href").startsWith(["tel:", "sms:"])
};NEELink.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEELink.prototype.docReady = function() {};NEELink.prototype.editorReady = function(a, e) {
	this.options = e || {};
	this.itemData = e.itemData || {};
	this.parent = this.itemData.parent;
	this.selected = {};
	this.$ed = $(a);
	var d = this,
	g = {
		type: [{
			text: dmStr["ui.nee.button.3"],
			imgSrc: "GeneralImgIcon",
			loadTab: function(a) {
				d.onTabReadyLinks(a)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: d.getIconSecondaryTabs()
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	},
	j = {
		type: [{
			text: dmStr["ui.nee.button.3"],
			imgSrc: "GeneralImgIcon",
			loadTab: function(a) {
				d.onTabReadyLinks(a)
			}
		}]
	};
	this.design = {
		color: ["text", "background", "border", "presets"],
		widgetshape: [],
		customize: []
	};
	this.icon = {
		gallery: [],
		"upload images": [],
		"image url": []
	};
	this._isLinkButton($.dmx.current.element) ? (this.options.noRemoveLink = !0, this.$ed.find("#contentTitle") == dmStr["ui.nee.button.3"] && this.$ed.find("#contentTitle").text(dmStr["ui.nee.button.2"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: g
	})) : this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: j
	})
};NEELink.prototype.onTabReadyLinks = function(a) {
	$(a).neeLinksWidget(this.options)
};NEELink.prototype.isMember = function(a, e) {
	if (this._isLinkButton($(a)) || this._isPageLink($(a))) return ! 0;
	var d = e ? e.forEditableBar || !1 : !1,
	g = $(a).closest("a");
	return d && g && g.attr("href") ? !0 : !1
};NEELink.prototype.getElementTagsSelectors = function() {
	return "a, a *"
};NEELink.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEELink.prototype.getCorrectElement = function(a) {
	return $(a).closest("a")
};NEELink.prototype.disableEditInline = function() {};NEELink.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this._isLinkButton($.dmx.current.element) && (d.dynamicTitle = $("\x3cdiv\x3e\x3c/div\x3e"), d.dynamicTitle.prepend(dmStr["ui.nee.button.2"]));
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEELink.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorLinkSelected")
};NEELink.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorLinkSelected"), this.disableEditInline())
};NEELink.prototype.afterInsert = function(a) {
	a = a || $.dmx.current.element;
	a.html(a.html())
};NEELink.prototype.getMarkupUrl = function() {
	return this.markupUrl
};NEELink.prototype.getDefaultUrlPlaceHolder = function() {
	return $.dmx.site.isFromScratch ? dmStr["ui.gwt.dashboard.74"] : $.dmx.site.baseUrl
};NEELink.prototype.getIconSecondaryTabs = function() {
	return {
		gallery_icon: [],
		upload_icon: [],
		url_icon: []
	}
};
function NEEYoutube() {
	this.isWidget = this.isWidget = !0;
	this.isExtension = !1;
	this.widget = {
		id: "dudaYouTubeId",
		preId: "dudaYouTubeId",
		defaults: {
			videoSource: ""
		}
	};
	this.title = function() {
		return dmStr["ui.nee.youtube.1"]
	};
	this.mindTouchId = "dmMtYouTubeVideo";
	this.showMindTouchHelp = !0;
	this.defaultMarkup = function() {
		return "\x3ca\x3e\x3c/a\x3e"
	};
	this.priority = 1;
	this.type = "youtube";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/youtube.png"
		}
	};
	this.editorDesc = "Add a Youtube video to this page.";
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.youtube.1"],
		isExpandable: !0,
		isCollapsable: !1,
		useCoverElement: !0
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/youtube/one.buttonsHtmlYoutubeGeneral.jsp": "/editor/nee/editableObjects/youtube/nee.buttonsHtmlYoutubeGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.youtubeOnTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						customize: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEYoutube.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEYoutube.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditoryoutubeSelected")
};NEEYoutube.prototype.youtubeOnTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element,
	e = a.attr("src");
	"https://www.youtube.com/embed/placeholder?html5\x3d1\x26wmode\x3dOpaque" != e && (e = e.substring(0, a.attr("src").indexOf("?html5\x3d1\x26wmode\x3dOpaque")), $("#youtubeUrl").val(e));
	$("#youtubeUrl").blur(function() {
		_updateUrl()
	});
	$("#youtubeUrl").keypress(function(a) {
		13 == a.keyCode && _updateUrl()
	});
	_updateUrl = function() {
		var a = $("#youtubeUrl").val();
		if ("" != a.trim()) {
			var g = e;
			if (a != e && a != e + "?html5\x3d1\x26wmode\x3dOpaque") {
				if ( - 1 != a.indexOf("youtube.com/watch")) {
					g = 0;
					if ( - 1 != a.indexOf("?v\x3d")) g = a.indexOf("?v\x3d") + 3;
					else if ( - 1 != a.indexOf("\x26v\x3d")) g = a.indexOf("\x26v\x3d") + 3;
					else {
						$.dmShowMsgOnPreview("Wrong youtube url", "noRemove");
						return
					}
					var j = a.indexOf("\x26", g),
					g = -1 != j ? "https://www.youtube.com/embed/" + a.substring(g, j) : "https://www.youtube.com/embed/" + a.substring(g)
				} else if ( - 1 != a.indexOf("youtu.be/")) g = "https://www.youtube.com/embed/" + a.substring(a.indexOf("youtu.be/") + 8);
				else if ( - 1 != a.indexOf("youtube.com/embed/")) g = "https://www.youtube.com/embed/" + a.substring(a.indexOf("youtube.com/embed/") + 18);
				else {
					$.dmShowMsgOnPreview("Wrong youtube url", "noRemove");
					return
				}
				$.dmops.updateCurrentAttributes({
					attrToAdd: {
						src: g + "?html5\x3d1\x26wmode\x3dOpaque"
					},
					attrToRemove: null
				})
			}
		}
	}
};NEEYoutube.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditoryoutubeSelected"), this.disableEditInline())
};NEEYoutube.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("iframe[src^\x3d'https://www.youtube.com'] *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEYoutube.prototype.getElementTagsSelectors = function() {
	return "iframe[src^\x3d'https://www.youtube.com'], .youtubeExt"
};NEEYoutube.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEYoutube.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEYoutube.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEYoutube.prototype.disableEditInline = function() {};NEEYoutube.prototype.docReady = function() {};NEEYoutube.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEYoutube.prototype.checkClose = function(a) {
	var e = 0,
	d, g;
	if ( - 1 < $.dmx.current.element.attr("src").indexOf("embed/placeholder")) {
		if (a) return $.dmops.deleteElement($.dmx.current.element),
		!0;
		$.dmfw.changeTabTo(1);
		d = setInterval(function() {
			e++;
			50 < e && clearInterval(d);
			g = $("#youtubeUrl");
			0 < g.length && (clearInterval(d), $.dmfw.showPromptError(g, dmStr["ui.nee.promptMassages.12"]))
		},
		10);
		return ! 1
	}
	return ! 0
};NEEYoutube.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center"
		},
		e = $.dmx.current.element,
		d = $("#youtubeUrl"),
		g = 0 < d.length,
		e = -1 < e.attr("src").indexOf("embed/placeholder"),
		j = g && "" === d.val() && e ? "ui.nee.promptMassages.12": "ui.nee.promptMassages.18",
		d = g && -1 === d.val().indexOf("youtube.com/");
		e || d ? $.dmfw.showPromptError($("#youtubeUrl"), dmStr[j], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEVideo() {
	this.isExtension = !1;
	this.isWidget = !0;
	this.widget = {
		id: "dudaVideoPlayerId",
		preId: "dudaVideoPlayerId",
		defaults: {
			controls: !0
		}
	};
	this.title = function() {
		return dmStr["ui.nee.video.1"]
	};
	this.mindTouchId = "dmMtVideo";
	this.showMindTouchHelp = !0;
	this.defaultMarkup = function() {
		return "\x3cvideo\x3e\x3c/video\x3e"
	};
	this.priority = 1;
	this.type = "video";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/video.png",
			editableDraggedText: dmStr["ui.nee.widgets.22"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.video.1"],
		isExpandable: !0,
		isCollapsable: !1
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.inlineEdit = {
		bar: {
			selectElement: function(a) {
				return $(a).is("video") ? $(a) : null
			},
			onReady: function(a, e) {
				$("\x3ca href\x3d'javascript:void(0)'\x3e" + dmStr["ui.nee.video.2"] + "\x3c/a\x3e").click(function(a) {
					$.dmfw.addEditor($.dmfw.editables("video"), e);
					a.stopPropagation()
				}).appendTo(a)
			}
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/video/nee.buttonsHtmlVideoGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEVideo.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEVideo.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorvideoSelected")
};NEEVideo.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.element;
	$("#videoUrl").val(a.attr("src"));
	$("#videoUrl").blur(function() {
		_updateUrl()
	});
	$("#videoUrl").keypress(function(a) {
		13 == a.keyCode && _updateUrl
	});
	_updateUrl = function() {
		if ("" != $("#videoUrl").val().trim() && $("#videoUrl").val().trim() != a.attr("src")) {
			var e = {
				attrToAdd: {
					src: $("#videoUrl").val()
				},
				attrToRemove: ["poster"]
			};
			$.dmops.updateCurrentAttributes(e)
		}
	};
	_makeOnOffButton = function(a, d) {
		var g = function(d) {
			var g = null;
			d ? (d = {},
			d[a] = a, g = {
				attrToAdd: d,
				attrToRemove: null
			}) : g = {
				attrToRemove: [a],
				attrToAdd: null
			};
			$.dmops.updateCurrentAttributes(g)
		},
		j = {
			initState: $.dmx.current.element.attr(a) ? !0 : !1,
			onFn: function() {
				g(!0)
			},
			offFn: function() {
				g(!1)
			}
		};
		$("#" + d).onOffBtn(j)
	};
	_makeOnOffButton("controls", "controlsOnOff");
	_makeOnOffButton("autoplay", "autoplayOnOff");
	_makeOnOffButton("loop", "loopOnOff");
	_makeOnOffButton("muted", "mutedOnOff")
};NEEVideo.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorvideoSelected"), this.disableEditInline())
};NEEVideo.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("video *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEVideo.prototype.getElementTagsSelectors = function() {
	return "video"
};NEEVideo.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEVideo.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEVideo.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEVideo.prototype.disableEditInline = function() {};NEEVideo.prototype.docReady = function() {};NEEVideo.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEShare() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.share.1"]
	};
	this.ext = {
		id: "shareextension",
		preId: "shareextension",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			share_button_text: dmStr["ui.nee.share.1"],
			text: dmStr["ui.nee.share.2"],
			linked_in: "true",
			surround: "true",
			like: "true",
			use_popup: "true",
			google_plus: "true",
			twitter: "true",
			email: "true",
			facebook: "true",
			use_new_design: "true",
			design: "large",
			share_popup_title: dmStr["ui.common.shareBy"],
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "shareextension";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtShare";
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/share.png",
			editableDraggedText: dmStr["ui.nee.widgets.20"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.share.1"]
	};
	this.rightPanelElementSelector = "#generalShare";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.editorDesc = "Enable users to share your site.";
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/share/one.buttonsHtmlShareGeneral.jsp": "/editor/nee/editableObjects/share/nee.buttonsHtmlShareGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.clickToCallOnTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			hideIf: function() {
				return $.buttonHasNoIcon($.dmx.current.editable.element)
			},
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEShare.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEShare.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorShareSelected")
};NEEShare.prototype.clickToCallOnTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#shareTextDesc").val(a.attr("share_button_text"));
	$('[id^\x3d"share"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"share"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			share_button_text: $("#shareTextDesc").val(),
			needs_premium_validation: !1,
			linked_in: a.attr("linked_in"),
			google_plus: a.attr("google_plus"),
			like: a.attr("like"),
			text: a.attr("text"),
			use_popup: a.attr("use_popup"),
			twitter: a.attr("twitter"),
			email: a.attr("email"),
			facebook: a.attr("facebook"),
			use_new_design: a.attr("use_new_design"),
			design: a.attr("design")
		};
		$.changePage({
			clientChange: function() {
				a.attr("share_button_text", e.share_button_text);
				a.find(".text").html(e.share_button_text)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEShare.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorShareSelected"), this.disableEditInline())
};NEEShare.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(".dmShare *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEShare.prototype.getElementTagsSelectors = function() {
	return ".dmShare"
};NEEShare.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEShare.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEShare.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEShare.prototype.disableEditInline = function() {};NEEShare.prototype.docReady = function() {};NEEShare.prototype.getDefaultIconName = function() {
	return "share.png"
};NEEShare.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEShare.prototype.afterInsert = function(a) {
	a = a || $.dmx.current.element;
	a.html(a.html())
};
function NEEHtml(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.nee.html.1"]
	};
	this.priority = 1;
	this.type = "html";
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'dmCustomHtml'\x3e" + dmStr["ui.nee.html.2"] + "\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.mindTouchId = "dmMtHtml";
	this.showMindTouchHelp = !0;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/html.png",
			editableDraggedText: dmStr["ui.nee.widgets.26"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.html.1"]
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/html/nee.buttonsHtmlHtmlWidget.htm",
			text: dmStr["ui.nee.html.1"].toUpperCase(),
			imgSrc: "GeneralImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryHTMLTab({
					noRoot: !0
				})
			},
			onTabClose: function(a, d) {
				$(".applyButton, .updateButton").unbind("click.htmlapply");
				d && d()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					tabs: {
						tab_colors: ["background", "border"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border"]
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: []
					}
				})
			}
		}]
	}
}
NEEHtml.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEHtml.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEHtml.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEHtml.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmCustomHtml")
};NEEHtml.prototype.getElementTagsSelectors = function() {
	return ".dmCustomHtml, .dmCustomHtml *"
};NEEHtml.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorHtmlSelected")
};NEEHtml.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorHtmlSelected"), this.disableEditInline())
};NEEHtml.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	0 < $(a.element).find("iframe").size() && (d.useCoverElement = !0);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEHtml.prototype.disableEditInline = function() {};NEEHtml.prototype.clone = function(a) {
	return new NEEHtml(a)
};NEEHtml.prototype.docReady = function() {};NEEHtml.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: 0
	})
};
function NEEColumn(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.nee.columnh.1"]
	};
	this.priority = 1;
	this.type = dmStr["ui.nee.columnh.2"];
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'dmColumn'\x3e\x3cdiv class\x3d'left dmParagraphPlaceholder'\x3e\x3c/div\x3e\x3cdiv class\x3d'divider'\x3e\x3c/div\x3e\x3cdiv class\x3d'right dmParagraphPlaceholder'\x3e\x3c/div\x3e\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/2columns.png",
			editableDraggedText: dmStr["ui.nee.widgets.11"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.columnh.3"]
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noEditorOnInsert = !0;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border"],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: []
					}
				})
			}
		}]
	}
}
NEEColumn.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEColumn.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEColumn.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEColumn.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmColumn")
};NEEColumn.prototype.getElementTagsSelectors = function() {
	return ".dmColumn, .dmColumn .divider, .dmColumn .divider *"
};NEEColumn.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorColumnsSelected")
};NEEColumn.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorColumnsSelected"), this.disableEditInline())
};NEEColumn.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEColumn.prototype.disableEditInline = function() {};NEEColumn.prototype.clone = function(a) {
	return new NEEColumn(a)
};NEEColumn.prototype.docReady = function() {
	var a = this;
	$.each($.dmfw.getPreviewElement(".dmColumn"),
	function(e, d) {
		a.initColumns(d)
	})
};NEEColumn.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: 0
	})
};NEEColumn.prototype.afterInsert = function(a) {
	this.initColumns(a)
};NEEColumn.prototype.initColumns = function(a) {
	a = $(a);
	NEFW.PREVIEW.get(0).contentWindow.makeDraggable(a.find(".divider"))
};
function NEEDivider(a) {
	this.isExtension = !1;
	this.isWidget = !0;
	this.widget = {
		id: "dudaDividerId",
		preId: "dudaDividerId",
		defaults: {
			minHeight: "2px",
			bgColor: "grey"
		}
	};
	this.options = a || {};
	this.itemData = this.options.itemData || {};
	this.parent = this.itemData.parent;
	this.title = function() {
		return dmStr["ui.nee.divider.1"]
	};
	this.priority = 1;
	this.type = "divider";
	this.defaultMarkup = function() {
		return "\x3chr\x3e\x3c/hr\x3e"
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/divider.png",
			editableDraggedText: dmStr["ui.nee.widgets.23"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.divider.1"],
		padding: "outer-v,outer-h"
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noSelectionInsert = this.noEditorOnInsert = !0;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background"]
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEDivider.prototype.isMember = function(a) {
	return $(a).is(".dmDivider")
};NEEDivider.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEDivider.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEDivider.prototype.getCorrectElement = function(a) {
	return a
};NEEDivider.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorDividerSelected")
};NEEDivider.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorDividerSelected"), this.disableEditInline())
};NEEDivider.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEDivider.prototype.disableEditInline = function() {};NEEDivider.prototype.clone = function(a) {
	return new NEEDivider(a)
};NEEDivider.prototype.docReady = function() {};NEEDivider.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEESpacer(a) {
	this.options = a || {};
	this.itemData = this.options.itemData || {};
	this.parent = this.itemData.parent;
	this.title = function() {
		return dmStr["ui.nee.spacer.1"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtSpacer";
	this.priority = 1;
	this.type = "spacer";
	this.defaultMarkup = function() {
		return "\x3chr class\x3d'dmSpacer'/\x3e"
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/divider.png",
			editableDraggedText: dmStr["ui.nee.widgets.24"]
		}
	};
	this.editorDesc = "Add spacing between different page elements.";
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.spacer.1"]
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/spacer/nee.heightController.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.heightControllerOnTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEESpacer.prototype.isMember = function(a) {
	return $(a).is(".dmSpacer")
};NEESpacer.prototype.getDummyElement = function() {
	return $("\x3chr/\x3e")
};NEESpacer.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEESpacer.prototype.getCorrectElement = function(a) {
	return a
};NEESpacer.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorSpacerSelected")
};NEESpacer.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorSpacerSelected"), this.disableEditInline())
};NEESpacer.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEESpacer.prototype.disableEditInline = function() {};NEESpacer.prototype.docReady = function() {};NEESpacer.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEESpacer.prototype.heightControllerOnTabReadyGeneral = function(a) {
	var e = $.dmx.current.element;
	$("#heightInput").val(e.css("height"));
	a.find("#sliderHeight").slider({
		range: "min",
		value: $.dmx.current.element.height(),
		min: 5,
		max: 300,
		step: 5,
		slide: function(e, j) {
			a.find("#heightInput").val(j.value + "px");
			d(j.value + "px", {
				clientOnly: !0
			})
		},
		stop: function(a, e) {
			d(e.value + "px")
		}
	});
	$("#heightInput").inputFieldLostFocusHandler(function(e) {
		e = parseInt(e);
		d(e + "px");
		a.find("#sliderHeight").slider({
			value: e
		})
	});
	var d = function(a, d) {
		e.css("height", a);
		$.dmops.updateCurrentCss({
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: "height",
				value: a
			}]
		},
		d)
	}
};
function NEESendBizInfo() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.sendBizInfo.1"]
	};
	this.ext = {
		id: "smsbusinessinfo",
		preId: "smsbusinessinfo",
		defaults: {
			icon: !0,
			zip: dmStr["ui.nee.click2Map.2"],
			description: dmStr["ui.nee.sendBizInfo.2"],
			street: dmStr["ui.nee.click2Map.4"],
			state: dmStr["ui.nee.click2Map.5"],
			surround: !0,
			needs_premium_validation: !0,
			country: dmStr["ui.nee.click2Map.6"],
			city: dmStr["ui.nee.click2Map.7"],
			bname: dmStr["ui.nee.sendBizInfo.3"],
			phone: dmStr["ui.nee.click2call.number"],
			email: dmStr["ui.nee.linkEditor.101"],
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "sendbizinfo";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.mindTouchId = "dmMtSendInfo";
	this.showMindTouchHelp = !0;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/smsInfo.png",
			editableDraggedText: dmStr["ui.nee.widgets.12"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.sendBizInfo.1"]
	};
	this.rightPanelElementSelector = "#generalSendInfo";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		numToShow: 2,
		type: [{
			url: "/editor/nee/editableObjects/sendBizInfo/nee.buttonsHtmlSendBizInfo.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReady,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					tagName: "a",
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					tagName: "a",
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEESendBizInfo.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEESendBizInfo.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorSendInfoSelected")
};NEESendBizInfo.prototype.onTabReady = function() {
	var a = $.dmx.current.editable.element;
	$("#sendDescription").val(a.attr("description"));
	$("#sendStreetAddress").val(a.attr("street"));
	$("#sendCity").val(a.attr("city"));
	$("#sendZip").val(a.attr("zip"));
	$("#sendState").val(a.attr("state"));
	$("#sendCountry").val(a.attr("country_full"));
	$("#sendWebsiteUrl").val(a.attr("site"));
	$("#sendEmail").val(a.attr("email"));
	$("#sendPhoneNumber").val(a.attr("phone"));
	$("#sendBname").val(a.attr("bname"));
	$('[id^\x3d"send"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"send"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			street: $("#sendStreetAddress").val(),
			city: $("#sendCity").val(),
			state: $("#sendState").val(),
			zip: $("#sendZip").val(),
			country: $("#sendCountry").val(),
			surround: a.attr("surround"),
			icon: a.attr("icon"),
			description: $("#sendDescription").val(),
			phone: $("#sendPhoneNumber").val(),
			email: $("#sendEmail").val(),
			bname: $("#sendBname").val(),
			needs_premium_validation: !0
		};
		$.changePage({
			clientChange: function() {
				a.attr("street", e.street);
				a.attr("city", e.city);
				a.attr("state", e.state);
				a.attr("zip", e.zip);
				a.attr("country", e.country);
				a.attr("site", e.site);
				a.attr("phone", e.phone);
				a.attr("email", e.email);
				a.attr("bname", e.bname);
				a.find(".text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEESendBizInfo.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToMapSelected"), this.disableEditInline())
};NEESendBizInfo.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmSmsInfo *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEESendBizInfo.prototype.getElementTagsSelectors = function() {
	return "A.dmSmsInfo"
};NEESendBizInfo.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEESendBizInfo.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEESendBizInfo.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEESendBizInfo.prototype.disableEditInline = function() {};NEESendBizInfo.prototype.docReady = function() {};NEESendBizInfo.prototype.getDefaultIconName = function() {
	return "sms.png"
};NEESendBizInfo.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEESendBizInfo.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustY: 4,
			at: "bottom center",
			my: "top center"
		},
		e = $.dmx.current.element,
		d = e.attr("phone") === dmStr["ui.nee.click2call.number"],
		g = e.attr("street") === dmStr["ui.nee.click2Map.4"],
		e = e.attr("email") === dmStr["ui.nee.linkEditor.101"];
		d || g || e ? $.dmfw.showPromptError($(g ? "#sendStreetAddress": d ? "#sendPhoneNumber": "#sendEmail"), dmStr["ui.nee.promptMassages.3"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEETable() {
	this.title = function() {
		return dmStr["ui.nee.table.1"]
	};
	this.priority = 1;
	this.type = "table";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.table.1"]
	};
	this.rightPanelElementSelector = "#generalSendInfo";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.addClearWidget = !1;
	this.buttonTabInfo = {
		numToShow: 2,
		type: [{
			url: "/editor/nee/editableObjects/table/nee.tableDesignEditor.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(a) {
				_initTable(a);
				a = $(a).find("div.tableDesignWrapper");
				var e = a.find(".tableDesignItem");
				$.dmfw.showEditorButton({
					selector: ".resetTableButton",
					click: function() {
						e.removeClass("tableDesignItemOrange");
						e.filter(".ot").addClass("tableDesignItemOrange");
						_applyTableShape("reset")
					}
				});
				"sdt" === $.dmx.current.element.attr("dmle_table_compat") && a.removeClass("two")
			},
			onTabClose: function(a, e) {
				$.dmfw.hideEditorButton({
					selector: ".resetTableButton"
				});
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tagName: "table",
					textSelector: "td, th",
					selector: "td, th",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEETable.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEETable.prototype.selectInline = function() {};_getActualTableShape = function(a) {
	return a && (a = a.attr("dmle_design_option")) ? (a = a.replace("table", ""), -1 != a.indexOf("ot") || -1 != a.indexOf("reset") ? "ot": -1 != a.indexOf("nv") ? "nv": -1 != a.indexOf("sc") ? "sc": -1 != a.indexOf("sdt") ? "sdt": "sc") : ""
};_initTable = function() {
	var a = !1;
	$(".tableDesignWrapper .tableDesignItem").each(function() {
		var e = $(this).attr("shape_name");
		e == _getActualTableShape($.dmx.current.element) && !a && ($(this).addClass("tableDesignItemOrange"), a = !0);
		$(this).unbind("click").click(function() {
			$(".tableDesignWrapper .tableDesignItem").removeClass("tableDesignItemOrange");
			$(this).addClass("tableDesignItemOrange");
			_applyTableShape(e)
		})
	})
};_applyTableShape = function(a) {
	a != _getActualTableShape($.dmx.current.element) && $.dmops.applyPattern($.dmx.current.element, "table", a)
};NEETable.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorClickToMapSelected"), this.disableEditInline())
};NEETable.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("[dmle_design_option^\x3d'table'],[dmle_table\x3d'table']") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	$(a).is("[dmle_design_option^\x3d'table:sdt'] *") && (e = !0);
	return e
};_isUnderTable = function() {
	var a = $.dmx.current.element;
	if (a.attr("dmle_table") || a.is("tr,td,th,tbody,thead, table, [class^\x3d'dmItemDetailsDetailedDesc']")) if (tableParent = a.getContainingTable(), 0 != tableParent.size()) return ! 0;
	return ! 1
};NEETable.prototype.getElementTagsSelectors = function() {
	return "[dmle_design_option^\x3d'table'],[dmle_table\x3d'table']"
};NEETable.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEETable.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEETable.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	_isUnderTable(this) && (d.isUnderTable = !0);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEETable.prototype.disableEditInline = function() {};NEETable.prototype.docReady = function() {};NEETable.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEESmartTable(a) {
	this.options = a || {};
	this.title = function() {
		return "Table"
	};
	this.className = "dmSmartTable";
	this.priority = 0.9;
	this.type = "smarttable";
	this._defaultImageSrcUrl = dmStr["ui.config.widgets.image.placeholder"] ? dmStr["ui.config.widgets.image.placeholder"] : "http://dm-direct.s3.amazonaws.com/defaultImages/clickToEditPicture.png";
	this._defaultLogoSrcUrl = dmStr["ui.config.widgets.logo.placeholder"] ? dmStr["ui.config.widgets.logo.placeholder"] : "http://dudamobile-themes.s3.amazonaws.com/otf_theme/logohere.png";
	this.defaultMarkup = function() {
		return '\x3cdiv class\x3d"' + this.className + '"\x3e\x3c/div\x3e'
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/image.png",
			editableDraggedText: dmStr["ui.nee.widgets.7"]
		}
	};
	this.inlineEditorProperties = {
		title: "Smart Table",
		isEdit: !1,
		isExpandable: !1,
		isCollapsable: !1
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.inlineEdit = {};
	this.buttonTabInfo = {}
}
NEESmartTable.prototype.onTabReadyGeneralNew = function() {};NEESmartTable.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEESmartTable.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEESmartTable.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement($(a))
};NEESmartTable.prototype.getCorrectElement = function(a) {
	return $(a).closest("." + this.className)
};NEESmartTable.prototype.getElementTagsSelectors = function() {
	return "." + this.className + ", ." + this.className + " *"
};NEESmartTable.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorSmartTableSelected")
};NEESmartTable.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorSmartTableSelected"), this.disableEditInline())
};NEESmartTable.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEESmartTable.prototype.disableEditInline = function() {};NEESmartTable.prototype.clone = function(a) {
	return new NEESmartTable(a)
};NEESmartTable.prototype.docReady = function() {};NEESmartTable.prototype.editorReady = function() {};
function NEEMultipleRemoval() {
	this.title = function() {
		return dmStr["ui.nee.multiremove.1"]
	};
	this.buttonTabInfo = {}
}
NEEMultipleRemoval.prototype.editorReady = function(a) {
	$.dmx.selectedElements = $.dmx.selectedElements || [];
	$.dmx.multiSelect = !0;
	$.dmfw.getPreviewElement(".dmHeader").addClass("dmDropAreasMinHeight");
	$.dmfw.getPreviewElement(".dmFooter").addClass("dmDropAreasMinHeight");
	$.dmfw.getPreviewElement(".dmHeader").darkenPreviewElement($('\x3cspan class\x3d"dmDropAreasText"\x3e[' + dmStr["ui.nee.multiremove.2"] + ']\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + dmStr["ui.nee.multiremove.4"] + "\x3c/span\x3e\x3c/span\x3e"), {
		top: 10
	});
	$.dmfw.getPreviewElement(".dmFooter").darkenPreviewElement($('\x3cspan class\x3d"dmDropAreasText"\x3e[' + dmStr["ui.nee.multiremove.3"] + ']\x3c/br\x3e\x3cspan style\x3d"font-weight: normal;font-size: 18px;"\x3e' + dmStr["ui.nee.multiremove.4"] + "\x3c/span\x3e\x3c/span\x3e"), {
		top: 10
	});
	$.dmfw.getPreviewElement(".navPlaceHolder:not(.expandableMenuClose)").each(function() {
		$(this).darkenPreviewElement($("\x3cspan\x3e\x3c/br\x3e\x3cspan\x3e\x3c/span\x3e\x3c/span\x3e"), {
			top: 10
		},
		!0)
	});
	$.dmLoad($(a).find(".rightPanel"), "/editor/nee/editableObjects/multipleRemove/nee.multipleRemovalEditor.jsp",
	function() {
		$(".deleteSelectedButton").unbind("click").click(function() {
			_deleteSelectedElements()
		});
		$(a).find(".rightPanel").addClass("rightPanelLoaded");
		"home" != $.dmx.page.alias && $(".deleteOnAllPagesWrapper").hide();
		$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("-\x3d50"), $(".neeWrapper .leftPanel").width("-\x3d50"))
	})
};_recalcDarkenElementsPositions = function() {
	$.dmfw.getPreviewElement(".dmDrakedElement").each(function(a, e) {
		var d = $(e).data("boundedElement");
		$(e).offset({
			top: d.offset().top,
			left: d.offset().left
		})
	})
};_deleteSelectedElements = function() {
	if (0 != $.dmx.selectedElements.length) {
		for (var a = [], e = $("#allPagesCheck").is(":checked"), d = 0; d < $.dmx.selectedElements.length; d++) a.push($.dmx.selectedElements[d].element),
		$.dmx.selectedElements[d].inlineEditor.remove();
		$.deselectAllEditableElements();
		$.dmx.selectedElements = [];
		$.dmops.deleteElements(a,
		function() {
			$(".elementsSuccessfullyDeletedWrapper").show();
			_recalcDarkenElementsPositions();
			$.dmx.deleteElementsTimeoutId && clearTimeout($.dmx.deleteElementsTimeoutId);
			$.dmx.deleteElementsTimeoutId = setTimeout(function() {
				$(".elementsSuccessfullyDeletedWrapper").fadeOut("slow")
			},
			2E3)
		},
		{
			dontCloseEditor: !0,
			allPages: e
		})
	}
};NEEMultipleRemoval.prototype.onEditorClose = function() {
	$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("+\x3d50"), $(".neeWrapper .leftPanel").width("+\x3d50"));
	$.dmx.selectedElements = $.dmx.selectedElements || [];
	$.dmx.multiSelect = !1;
	$.dmfw.getPreviewElement(".dmDrakedElement, .dmTransedLayoutElement").remove();
	$.dmfw.getPreviewElement(".dmDropAreasMinHeight").removeClass("dmDropAreasMinHeight");
	for (var a = 0; a < $.dmx.selectedElements.length; a++) $.dmx.selectedElements[a].inlineEditor.remove();
	$.dmx.selectedElements = [];
	$.dmfw.getPreviewElement(".dmMultiLocked").removeClass("dmMultiLocked")
};
function NEESubmitButton() {
	this.priority = 10;
	this.type = "submitbutton";
	this.title = function() {
		return ""
	};
	this.inlineEditorProperties = {};
	this.inlineEdit = {
		bar: {
			selectElement: function(a) {
				return a
			},
			onReady: function(a, e) {
				$("\x3ca href\x3d'javascript:void(0)'\x3e" + dmStr["ui.nee.form.31"] + "\x3c/a\x3e").click(function() {
					e.closest("form").submit()
				}).appendTo(a)
			}
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	}
}
NEESubmitButton.prototype.docReady = function() {};NEESubmitButton.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEESubmitButton.prototype.getCorrectElement = function(a) {
	return $(a).closest("input[type\x3d'submit'], input[type\x3d'image']")
};NEESubmitButton.prototype.isMember = function(a) {
	return $(a).is("input[type\x3d'submit'], input[type\x3d'image']") && !$(a).is(".dmform *") && !$(a).is(".dmPayPalButton *") && !$(a).is(".dmGoogleCheckoutButton *")
};NEESubmitButton.prototype.disableEditInline = function() {};
function NEEList(a) {
	function e(a) {
		$(".closeThis").trigger("click");
		a = a.replace(/ /g, "%20");
		var d = $.dmx.current.editable,
		e = $.dmx.current.element.find("#" + d.currentItemId).find("div.listImage"),
		d = $("#sortableListContainer").find("[elemId\x3d'" + d.currentItemId + "'] .smallTempPlaceHlderForImage");
		e.add(d).css("background-image", "url(" + a + ")");
		$(d).addClass("hasImage").parent().find(".imageActionsPanel").removeClass("disabled");
		$.dmops.updateCurrentCss({
			attrToAdd: [{
				attr: "background-image",
				value: "url(" + a + ")"
			}]
		},
		{
			element: e
		})
	}
	function d(a) {
		a.show();
		a.neeSecondaryIconTabs({
			tabs: {
				upload: [{
					isChange: !1
				}],
				original_images: [],
				url: []
			},
			callback: e,
			uploadBiggerButton: !0,
			isImagePickerPopup: !0
		})
	}
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.nee.listWidget.3"]
	};
	this.mindTouchId = "dmMtList";
	this.showMindTouchHelp = !0;
	this.priority = 0.1;
	this.type = "list";
	this.isWidget = !0;
	this.widget = {
		id: "dudaListId",
		preId: "dudaListId",
		defaults: {
			email: $.dmx.site.accountOwner,
			title: dmStr["ui.nee.listWidget.22"]
		}
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.listWidget.3"],
		isEdit: $.dmfw.isPT() || $.dmfw.isDudaone()
	};
	this.editorDesc = "Create a list of services, products or employee profiles.";
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/list.png",
			editableDraggedText: dmStr["ui.nee.listWidget.3"]
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/list/one.listGeneral.jsp": "/editor/nee/editableObjects/list/nee.listGeneral.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function() {
				var a = $.dmx.current.element,
				d = $.dmx.current.editable;
				$.dmx.current.editable.resetUIAndBreadcrumbs();
				a.html(a.html());
				d.getTitle()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.layout"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: function(a) {
				$.dmx.current.editable.resetUIAndBreadcrumbs(1);
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["background_widgets", "border", "presets"],
						list_layout: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmx.current.editable.resetUIAndBreadcrumbs(2);
				$(a).neeSecondaryDesignTabs({
					textSelector: "p.listText",
					selector: "p.listText",
					forceClassName: "p.listText",
					tabs: {
						color: ["background", "text", "border"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$.dmx.current.editable.resetUIAndBreadcrumbs(3);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	};
	this.getTitle = function() {
		var a = $("input#listTitleInput"),
		d = $.dmx.current.element.find("h3.dmwidget-title"),
		e = d.html().trim(),
		g = "true" === d.attr("hide"),
		n = $("#designTitleBtn, #toggleTitleBtn");
		a.attr("elemId", d.attr("id")).val(e);
		g ? (a.addClass("noTitle"), n.addClass("hideTitle")) : (a.removeClass("noTitle"), n.removeClass("hideTitle"))
	};
	this.getItemData = function(a) {
		var d, e = a.find("span.itemName").eq(0),
		g = a.find("div.listImage"),
		n = "",
		o = a.find("span.itemText"),
		r = a.find("span.link span.buttonText"),
		u = g.css("background-image");
		0 < u.indexOf("listImagePlaceholder") || "" === u || 0 < u.indexOf("imgPlaceholder") ? u = "": n = "hasImage";
		d = $.dmx.current.element.attr("layout");
		return {
			titleHideEmpty: function() {
				return "layoutB" === d
			},
			buttonHideEmpty: function() {
				return "layoutB" !== d
			},
			imageHolderClass: n,
			imageSrc: u,
			imageId: g.dmid(),
			description: o.html().trim().replace(/<br[^<]{0,}>{1,}/g, "\n"),
			descriptionId: o.dmid(),
			link: r.html().trim(),
			linkId: r.dmid(),
			itemId: a.dmid(),
			itemName: e.text().trim(),
			itemNameId: e.dmid()
		}
	};
	this.populateItem = function(a) {
		var d = $("div#sortableListContainer").find("ul.ui-sortable"),
		e = $("#listItemTemplate").html();
		a = Handlebars.compile(e)(a);
		d.append(a)
	};
	this.getListItems = function() {
		var a = 0,
		k = $.dmx.current.element.find("li.listItem"),
		l = k.length,
		m = $("#sortableListContainer"),
		n = $("div#listTitleEditContainer"),
		o;
		m.children("ul").sortable({
			axis: "y",
			stop: function(a, d) {
				var e = $.dmx.page.id,
				g = $(d.item).attr("elemid"),
				j = $.dmx.current.element.find("ul.listWidgetContainer").dmid(),
				k = $(d.item).next().attr("elemid");
				$.dmx.current.element.find("#" + g).insertBefore($.dmx.current.element.find("#" + k));
				$.dmPost({
					url: "/pages/" + e + "/moveelement/" + g + "/" + j + "/" + k
				})
			}
		});
		for (a; a < l; a += 1) o = $(k[a]),
		$.dmx.current.editable.populateItem($.dmx.current.editable.getItemData(o)),
		1 === l ? (o = m.find("a.removeItem"), o.addClass("disabled"), o.qtip({
			position: {
				at: "bottom center",
				my: "top center"
			},
			style: {
				classes: "ui-tooltip-light ui-tooltip-shadow dmtooltip",
				tip: "topCenter",
				def: !1
			},
			content: dmStr["ui.nee.fbGallery.8"]
		})) : (o = m.find("a.removeItem.disabled"), o.removeClass("disabled"), o.qtip("destroy"));
		$.dmops.redrawSelection();
		m.parent().on("keyup", "input",
		function() {
			var a = $(this);
			if (a.attr("elemid")) {
				var d = a.val().trim(),
				e = [],
				g = !1;
				e.push(a.attr("elemid"));
				"true" === a.attr("hideEmpty") && (g = !0);
				a.hasClass("listName") && (a = $.dmx.current.element.find("[duda_id\x3d'" + e + "']").parents("li.listItem").eq(0).find(".itemName"), $.each(a,
				function(a, d) {
					var g = $(d).dmid();
					e.push(g)
				}));
				$.dmx.current.editable.updateText(e, d, g)
			}
		});
		m.parent().on("keyup", "textarea",
		function() {
			if ($(this).attr("elemid")) {
				var a = $(this).val(),
				d = $(this).attr("elemid");
				$.dmx.current.editable.updateMultiLineText(d, a)
			}
		});
		m.on("focus", "div.editPanel *, input.listName",
		function() {
			var a = $(this).parents("li.listItem").eq(0);
			a.hasClass("open") || a.find("a.editItem").trigger("click")
		});
		n.on("click", "#toggleTitleBtn", $.dmx.current.editable.toggleTitle);
		n.on("click", "#designTitleBtn", $.dmx.current.editable.editTitle);
		m.parent().find("a.addItem").on("click", $.dmx.current.editable.addItem);
		m.on("click", "a.removeItem", $.dmx.current.editable.removeListItem);
		m.on("click.editItem", "a.editItem",
		function() {
			var a = $(this).parents("li.listItem"),
			d = 0 > a.find("div.smallTempPlaceHlderForImage").css("background-image").indexOf("addImgPlace.png"),
			e = a.find(".imageActionsPanel");
			$.dmx.current.editable.currentItem = a;
			a.hasClass("open") ? a.removeClass("open") : (m.find("li.listItem").removeClass("open"), a.addClass("open"), $.dmx.current.editable.currentItemId = a.attr("elemid"), d ? e.removeClass("disabled") : e.addClass("disabled"))
		});
		m.on("click.editLink", "div.editButton span.link", $.dmx.current.editable.handleLinkChange);
		m.on("click.crop", "div.cropImage",
		function() {
			$(this).parents(".editImage").eq(0).find(".smallTempPlaceHlderForImage");
			if (!$(this).parents(".imageActionsPanel").hasClass("disabled")) {
				g(dmStr["ui.nee.imageSlider.10"]);
				var a = $(".rightPanel");
				a.empty();
				a.append($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e"));
				var d = $.dmx.current.element.find("#" + $.dmx.current.editable.currentItemId),
				e = d.find("div.listImage"),
				j = e.height(),
				j = e.width() / j;
				a.neeSecondaryDesignTabs({
					tabs: {
						crop: []
					},
					sliderCropOptions: {
						aspectRatio: j,
						element: d,
						imgSrc: e.css("background-image").replace(/"/g, "").replace(/'/g, "").replace("url(", "").replace(")", ""),
						currElemDmid: e.dmid(),
						imgElem: d,
						callback: function(a) {
							a = a.croppedImageSource;
							e.attr("style", "background-image: url(" + a + ") !important");
							$.dmops.updateCurrentCss({
								attrToAdd: [{
									attr: "background-image",
									value: "url(" + a + ")"
								}]
							},
							{
								element: e
							})
						}
					}
				})
			}
		});
		a = m.find(".smallTempPlaceHlderForImage");
		"layoutC" !== $.dmx.current.element.attr("layout") ? a.neePopUpDiv($("#headerToOpenChange"), {
			init: d,
			toChangeFunction: e,
			showIphone: !0
		}) : a.addClass("disabled");
		m.on("click.removeImage", "div.removeImage", $.dmx.current.editable.removeListItemImage);
		m.on("click.save", "a.saveChanges",
		function() {
			$(this).parents("li.listItem").find("a.editItem").trigger("click")
		})
	};
	this.removeListItemImage = function() {
		if (!$(this).parents(".imageActionsPanel").hasClass("disabled")) {
			var a = $(this).parents("div.editImage").eq(0).find("div.smallTempPlaceHlderForImage"),
			d = $.dmx.current.element.find("#" + $(this).attr("elemId"));
			a.attr("style", "").removeClass("hasImage");
			a.parent().find(".imageActionsPanel").addClass("disabled");
			$.dmops.updateCurrentCss({
				attrToRemove: ["background-image"]
			},
			{
				element: d
			})
		}
	};
	this.toggleTitle = function(a) {
		function d() {
			r.addClass("hideTitle");
			$(this).parent().addClass("noTitle");
			o.addClass("noTitle")
		}
		function e() {
			r.removeClass("hideTitle");
			$(this).parent().removeClass("noTitle");
			o.removeClass("noTitle")
		}
		var g = $.dmx.current.element.find("h3.dmwidget-title"),
		n = "true" === g.attr("hide"),
		o = $("#listTitleInput"),
		r = $("#designTitleBtn, #toggleTitleBtn"); (n = "boolean" === typeof a ? a: !n) ? d() : e();
		$.dmx.current.element.find("h3.dmwidget-title").attr("hide", n);
		$.dmops.updateCurrentAttributes({
			attrToAdd: {
				hide: n
			}
		},
		{
			element: g
		})
	};
	this.editTitle = function() {
		if (!$(this).hasClass("noTitle")) {
			var a = $("div.rightPanel");
			a.empty();
			$("\x3cdiv class\x3d'slideRightPanelInner /'\x3e").appendTo(a);
			a.neeSecondaryDesignTabs({
				selector: ".dmwidget-title",
				afterTextButtonInit: function(a) {
					a.find("#dirLeft,#dirRight").hide()
				},
				tabs: {
					color: ["background", "text", "border"],
					text_style: []
				},
				forceClassName: ".dmwidget-title",
				useCurElem: !0
			});
			$.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						$.dmx.current.editable.resetUIAndBreadcrumbs()
					}
				},
				{
					title: dmStr["ui.nee.menu.2"].replace("^", "")
				}]
			})
		}
	};
	this.handleLinkChange = function() {
		function a(e) {
			var g = {};
			g.element = $(e);
			d.linkEditor = $(".rightPanel").neeLinksWidget({
				current: g,
				editable: $.dmfw.editables("link"),
				noTextToDisplay: !0,
				noSurroundButton: !0,
				onLinkRemove: function() {
					$.dmPreviewSaving();
					var a = $(".rightPanel");
					a.empty();
					$.dmfw.setEditorBreadcrumb(null);
					$(".removeLinkButton").hide();
					$(".cropButton").hide();
					$.dmLoad(a, "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
					function() {
						$(".leftPanel").find(".slideBtn").eq(0).trigger("click")
					});
					$.dmPreviewSaved()
				}
			})
		}
		var d = $.dmx.current.editable,
		e = $(this).parents("li.listItem").eq(0).attr("elemId"),
		m = $.dmx.current.element.find("#" + e).find("a").eq(0),
		e = $(m).attr("href"); ! e || 0 >= e.length ? ($.dmPreviewSaving(), $.dmops.populateEmptyLink(m,
		function() {
			a(m);
			$.dmPreviewSaved()
		})) : a(m);
		g(dmStr["ui.nee.imageSlider.8"])
	};
	this.removeListItem = function() {
		var a;
		a = $("#sortableListContainer");
		var d = $(this).parents("li.listItem"),
		e = d.attr("elemid");
		2 > a.find("li.listItem").length || (d.remove(), $.dmx.current.element.find("#" + e).remove(), $.dmops.redrawSelection(), 2 > a.find("li.listItem").length && (a = a.find("a.removeItem"), a.addClass("disabled"), a.qtip({
			position: {
				at: "bottom center",
				my: "top center"
			},
			style: {
				classes: "ui-tooltip-light ui-tooltip-shadow dmtooltip",
				tip: "topCenter",
				def: !1
			},
			content: dmStr["ui.nee.fbGallery.8"]
		})), $.dmPost({
			url: "/pages/" + $.dmx.page.id + "/deleteElement/" + e
		}))
	};
	this.addItem = function() {
		var a, g = $.dmx.current.element,
		l = g.find("ul.listWidgetContainer");
		a = $("#sortableListContainer").find("a.removeItem.disabled");
		a.removeClass("disabled");
		a.qtip("destroy");
		$.dmPost({
			url: "/pages/" + $.dmx.page.id + "/insertitemsinwidget",
			data: [{
				containerId: l.dmid(),
				itemBeforeId: null,
				widgetId: g.attr("dmle_widget")
			}],
			success: function(a) {
				a = a[0].itemMarkup;
				var g = $("#sortableListContainer").find("a.removeItem");
				l.append(a);
				g.removeClass("disabled");
				$.dmx.current.editable.populateItem($.dmx.current.editable.getItemData($(a)));
				$.dmops.redrawSelection();
				$("#sortableListContainer").find(".smallTempPlaceHlderForImage").neePopUpDiv($("#headerToOpenChange"), {
					init: d,
					toChangeFunction: e,
					showIphone: !0
				})
			}
		})
	};
	this.updateText = function(a, d, e) {
		var g = $.dmx.current.editable.updateTextTimeOut;
		g && clearTimeout(g);
		$.dmx.current.editable.updateTextTimeOut = setTimeout(function() {
			e && $.dmPost({
				url: "/pages/" + $.dmx.page.id + "/updateelementattributes/" + r.dmid(),
				data: {
					attrToAdd: {
						noButton: o
					}
				}
			});
			$.dmPost({
				url: "/pages/" + $.dmx.page.id + "/changemultipleelementtext",
				data: {
					ids: a,
					text: d
				}
			})
		},
		1E3);
		"" === d ? $.dmx.current.editable.toggleTitle(!0) : $.dmx.current.editable.toggleTitle(!1);
		var g = 0,
		n = a.length,
		o, r, u = [];
		for (g; g < n; g++) u.push($.dmx.current.element.find("[duda_id\x3d" + a[g] + "]"));
		$.each(u,
		function(a, g) {
			e && (o = "" === d, r = $.dmx.current.element.find("#" + $.dmx.current.editable.currentItem.attr("elemid")).find("span.link").parent(), o ? r.attr("noButton", "true") : r.attr("noButton", "false"));
			$(g).html(d.trim().replace(/\n/g, "\x3cbr/\x3e"))
		})
	};
	this.updateMultiLineText = function(a, d) {
		$.dmx.current.editable.updateTextTimeOut && clearTimeout($.dmx.current.editable.updateTextTimeOut);
		$.dmx.current.editable.updateTextTimeOut = setTimeout(function() {
			$.dmPost({
				url: "/pages/" + $.dmx.page.id + "/changeelementmarkup/" + a,
				data: {
					value: e.outerHTML()
				}
			})
		},
		1E3);
		var e = $.dmx.current.element.find("[duda_id\x3d" + a + "]");
		e.html(d.replace(/\n/g, "\x3cbr/\x3e"))
	};
	this.bindLayoutAction = function() {
		var a = $.dmx.current.element.attr("layout");
		$("#listLayoutContainer").on("click", "a.listLayout", $.dmx.current.editable.changeListLayout).find("a.listLayout[layout\x3d'" + a + "']").addClass("active")
	};
	this.changeListLayout = function() {
		function a(d) {
			var e = $.dmx.current.element.find("ul.listWidgetContainer");
			e.attr("disableLink") !== String(d) && (e.attr("disableLink", d), $.dmPost({
				url: "/pages/" + $.dmx.page.id + "/updateelementattributes/" + e.dmid(),
				data: {
					attrToAdd: {
						disableLink: d
					}
				}
			}))
		}
		var d = $(this).attr("layout");
		$.dmx.current.editable.curLayout = d;
		$("#listLayoutContainer").find("a.listLayout").removeClass("active");
		$(this).addClass("active");
		$.dmx.current.element.attr("layout", d);
		$.dmPost({
			url: "/pages/" + $.dmx.page.id + "/updateelementattributes/" + $.dmx.current.element.dmid(),
			data: {
				attrToAdd: {
					layout: d
				}
			},
			success: function() {
				"layoutB" === d ? a(!0) : a(!1);
				$.dmops.redrawSelection()
			}
		})
	};
	var g = function(a) {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					$.dmx.current.editable.resetUIAndBreadcrumbs()
				}
			},
			{
				title: a
			}]
		})
	};
	this.resetUIAndBreadcrumbs = function(a) {
		isNaN(a) && (a = 0);
		var d = $("#_p_editor"),
		e = d.find("div.rightPanel"),
		g = d.find("div.cropButton"),
		d = d.find("div.removeLinkButton"),
		n = this.buttonTabInfo.type[a].url;
		0 < g.length && g.hide();
		0 < d.length && d.hide();
		$.dmfw.setEditorBreadcrumb(null);
		0 === a && $.dmLoad(e, n,
		function() {
			$.dmx.current.editable.getTitle();
			$.dmx.current.editable.getListItems()
		})
	}
}
NEEList.prototype.tabsReady = function() {};NEEList.prototype.tabsReadySettings = function() {};NEEList.prototype.tabsReadyGeneral = function() {};NEEList.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEList.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors())
};NEEList.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEList.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmPrettyList")
};NEEList.prototype.getElementTagsSelectors = function() {
	return ".dmPrettyList,  .dmPrettyList *"
};NEEList.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorListSelected")
};NEEList.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorListSelected"), this.disableEditInline())
};NEEList.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEList.prototype.disableEditInline = function() {};NEEList.prototype.clone = function(a) {
	return new NEEList(a)
};NEEList.prototype.docReady = function() {};NEEList.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: 0
	})
};NEEList.prototype.afterInsert = function(a) {
	a = a || $.dmx.current.element;
	a = a.find("input[type\x3d'submit']");
	a.attr("class", a.attr("class"))
};
function NEEForm(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.nee.form.1001"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtContactForm";
	this.priority = 0.1;
	this.type = "form";
	this.isWidget = !0;
	this.widget = {
		id: "dudaContactUsId",
		preId: "dudaContactUsId",
		defaults: {
			email: $.dmx.site.accountOwner
		}
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.form.1"]
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/form.png",
			editableDraggedText: dmStr["ui.nee.widgets.29"]
		}
	};
	this.editorDesc = "Add a Contact form to your site so customers can get in touch with you.";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.tabsReady
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"));
				$(a).neeSecondaryDesignTabs({
					textSelector: "label",
					tabs: {
						color: ["background", "text", "border"],
						text_style: [],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"));
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEForm.prototype.tabsReady = function(a, e) {
	var d = [{
		id: "formGeneral",
		name: dmStr["ui.general"],
		url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/form/one.form.form.jsp": "/editor/nee/editableObjects/form/nee.form.form.jsp",
		onReady: function() {
			$.dmfw.editables("form").tabsReadyGeneral(a, e)
		}
	},
	{
		id: "formSettings",
		name: dmStr["ui.nee.form.2"],
		url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/form/one.form.settings.jsp": "/editor/nee/editableObjects/form/nee.form.settings.jsp",
		onReady: function() {
			$.dmfw.editables("form").tabsReadySettings(a, e)
		}
	}];
	a.neeSecondaryTabsControl(d)
};NEEForm.prototype.tabsReadySettings = function() {
	var a = $.dmx.current.element;
	$.each($.dmx.editableLinks({
		uniqueNavLinkUrls: !0
	}),
	function(a, d) {
		var g = "/site/" + $.dmx.site.alias + "/" + d.alias;
		d.url && (g += "?url\x3d" + d.url);
		$("#formSuccessPages").append($("\x3coption\x3e\x3c/option\x3e").attr("value", g).text(d.title))
	});
	$("#formEmailAddress").val(a.find("input[name\x3d'dmformsendto']").val());
	$("#formEmailSubject").val(a.find("input[name\x3d'dmformsubject']").val());
	$("#formSuccess").html(a.find(".dmform-success").html());
	$("#formSuccess").attr("contenteditable", "true");
	$("#formUseSuccessPage").attr("checked", null != a.find(".dmform-success").data("success-page") && "" != a.find(".dmform-success").data("success-page"));
	$("#formSuccessPages").val(a.find(".dmform-success").data("success-page"));
	$("#formError").html(a.find(".dmform-error").html());
	$("#formUseSuccessPage").is(":checked") && $("#formSuccessPages").toggleClass("display_None");
	$('[id^\x3d"form"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"form"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	$("#formUseSuccessPage").change(function() {
		$("#formSuccessPages").toggleClass("display_None", "slow");
		$("#formUseSuccessPage").is(":checked") ? a.find(".dmform-success").data("success-page", $("#formSuccessPages").val()) : a.find(".dmform-success").data("success-page", "");
		_updateInfo(!0)
	});
	$("#formSuccessPages").change(function() {
		a.find(".dmform-success").data("success-page", $("#formSuccessPages").val());
		_updateInfo(!0)
	});
	_updateInfo = function(e) {
		if (e || !(a.find("input[name\x3d'dmformsendto']").val() == $("#formEmailAddress").val() && a.find("input[name\x3d'dmformsubject']").val() == $("#formEmailSubject").val() && a.find(".dmform-success").data("success-page") == $("#formSuccessPages").val() && a.find(".dmform-success").html() == $("#formSuccess").html() && a.find(".dmform-error").html() == $("#formError").html())) {
			a.find("input[name\x3d'dmformsendto']").val($("#formEmailAddress").val());
			a.find("input[name\x3d'dmformsubject']").val($("#formEmailSubject").val());
			a.find(".dmform-success").html($("#formSuccess").html());
			a.find(".dmform-error").html($("#formError").html());
			var d = {
				emailId: a.find("input[name\x3d'dmformsendto']").dmid(),
				emailText: a.find("input[name\x3d'dmformsendto']").val(),
				subjectId: a.find("input[name\x3d'dmformsubject']").dmid(),
				subjectText: a.find("input[name\x3d'dmformsubject']").val(),
				successId: a.find(".dmform-success").dmid(),
				successText: a.find(".dmform-success").outerHTML(),
				successPage: a.find(".dmform-success").data("success-page"),
				errorId: a.find(".dmform-error").dmid(),
				errorText: a.find(".dmform-error").outerHTML()
			};
			$.changePage({
				clientChange: function() {},
				serverChange: function() {
					$.dmPostWithHistory({
						url: "/pages/" + $.dmx.currentPage() + "/changeformsettings/",
						data: d
					})
				}
			})
		}
	}
};NEEForm.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEForm.prototype.tabsReadyGeneral = function(a, e) {
	e = e || {};
	a.find(".navEditorLinks").empty();
	this.handleTitle.generalFormTitleFeildLabel = dmStr["nee.form.18"];
	this.handleTitle.widgetRuntimeTitle = $.dmx.current.element.find(".dmform-title").text().trim();
	this.handleTitle.handleTitleinit(a);
	var d = function(a) {
		a = a.find(".inputTypeOptions").val().split(/\n/);
		for (var d = "",
		e = 0; e < a.length; e++)"" != a[e].trim() && (d += "\x3coption\x3e" + a[e] + "\x3c/option\x3e");
		return d
	},
	g = function(a, d, e) {
		a = a.find(".inputTypeOptions").val().split(/\n/);
		for (var g = "",
		j = 0; j < a.length; j++)"" != a[j].trim() && (g += "\x3cdiv duda_id\x3d'" + e + j + "wrap'\x3e\x3cinput type\x3d'radio' value\x3d'" + a[j] + "' name\x3d'" + d + "' duda_id\x3d'" + e + j + "'/\x3e\x3cspan\x3e" + a[j] + "\x3c/span\x3e\x3c/div\x3e ");
		return g
	},
	j = function(a, d, e) {
		a = a.find(".inputTypeOptions").val().split(/\n/);
		for (var g = "",
		j = 0; j < a.length; j++)"" != a[j].trim() && (g += "\x3cdiv duda_id\x3d'" + e + j + "wrap'\x3e\x3cinput type\x3d'checkbox' value\x3d'" + a[j] + "' name\x3d'" + d + "' duda_id\x3d'" + e + j + "'/\x3e\x3cspan\x3e" + a[j] + "\x3c/span\x3e\x3c/div\x3e ");
		return g
	},
	k = function(a, d) {
		for (var e = d.find(".inputTypeOptions"), g = a.find("input"), j = "", k = 0; k < g.length; k++) j += $(g[k]).val() + "\n";
		e.text(j);
		e.show()
	};
	"newsletter" === $.dmx.current.editable.type ? $.dmx.current.editable.addFields(a) : $.dmx.current.element.find(".dmforminput").each(function(d, e) {
		var g = $("#formPlaceholder").clone();
		g.removeAttr("id");
		g.removeClass("displayNone");
		g.find(".navLinkTitleInput").val($(e).find("label").text().trim());
		if ($(e).find("select").length) {
			for (var j = $(e).find("select"), l = g.find(".inputTypeOptions"), j = j.find("option"), m = "", n = 0; n < j.length; n++)"" != $(j[n]).text().trim() && (m += $(j[n]).text() + "\n");
			l.text(m);
			l.show();
			g.find(".inputTypeSelect").val("dropdown")
		} else $(e).find("input[type\x3d'radio']").length ? (k($(e).find(".radiowrapper"), g), g.find(".inputTypeSelect").val("radio")) : $(e).find("input[type\x3d'checkbox']").length ? (k($(e).find(".checkboxwrapper"), g), g.find(".inputTypeSelect").val("checkbox")) : $(e).find("textarea").length ? g.find(".inputTypeSelect").val("longtext") : $(e).find(".dmDatePicker").length ? (g.find(".dateFormatSelect").val($(e).find(".dmDatePicker").attr("date_format")), g.find(".dateEditor").show(), g.find(".langEditor").show(), g.find(".langSelect").val($(e).find(".dmDatePicker").attr("lang")), g.find(".inputTypeSelect").val("date")) : $(e).find(".dmTimePicker").length ? (g.find(".inputTypeSelect").val("time"), g.find(".timeEditor").show(), g.find(".langEditor").show(), g.find(".langSelect").val($(e).find(".dmTimePicker").attr("lang")), "Hii" == $(e).find(".dmTimePicker").attr("time_format") ? g.find(".timeCheckBox").attr("checked", "checked") : g.find(".timeCheckBox").removeAttr("checked")) : g.find(".inputTypeSelect").val($(e).find("input").attr("type"));
		$(e).is(".required") && g.find(".formInputRequired input").attr("checked", "");
		g.appendTo(a.find(".navEditorLinks"))
	});
	var l = $.dmx.current.element.find("input[type\x3d'submit']");
	$(".formSubmitInput").val(l.val());
	var m = function(a) {
		a = a.closest(".navEditorLinkAndSub").index();
		return $($.dmx.current.element.find(".dmforminput").get(a))
	};
	a.find(".navEditorLinks").sortable({
		disabled: !1,
		cursor: 'url("/editor/nee/images/shell/closedhand.cur"), default',
		placeholder: "dmUi-state-highlight",
		forcePlaceholderSize: !0,
		tolerance: "pointer",
		toleranceElement: "\x3e div",
		handle: "div",
		items: "li",
		axis: "y",
		maxLevels: 0,
		tabSize: 1E3,
		update: function() {},
		stop: function() {
			var a = m(draggedElement);
			a.index() != draggedInput.index() && $.changePage({
				clientChange: function() {
					a.index() > draggedInput.index() ? draggedInput.insertAfter(a) : draggedInput.insertBefore(a)
				},
				serverChange: function() {
					var a = {
						inputId: draggedInput.dmid(),
						inputParentId: draggedInput.parent().dmid(),
						inputBeforeId: draggedInput.next().length ? draggedInput.next().dmid() : null
					};
					$.dmPostWithHistory({
						url: "/pages/" + $.dmx.currentPage() + "/moveforminput",
						data: a
					})
				}
			})
		},
		start: function(a, d) {
			draggedElement = $(d.item).closest("li");
			draggedInput = m(draggedElement)
		}
	});
	var n = function(a) {
		var d = m(a);
		d.find("label").text().trim() != a.val().trim() && $.changePage({
			clientChange: function() {
				d.find("label").text(a.val().trim())
			},
			serverChange: function() {
				var a = {
					labelId: d.find("label").dmid(),
					labelText: d.find("label").text(),
					hiddenInputId: d.find("input[type\x3d'hidden']").dmid()
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/changeforminputtext",
					data: a
				})
			}
		})
	};
	$(".navLinkTitleInput").on("blur keypress",
	function(a) {
		"keypress" === a.type && 13 != a.keyCode || n($(this))
	});
	$.dmfw.isDudaone() || ($(".navEditorLinkAndSub, .formSubmitWrapper, .navEditorLinkAndSub, .formTitleWrapper").mouseover(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "visible");
		1 == a.find(".navEditorLinks .navEditorLinkAndSub").length ? $(this).find(".navLinkButtonHidden").hide() : $(this).find(".navLinkButtonHidden").show()
	}), $(".navEditorLinkAndSub, .formSubmitWrapper, .navEditorLinkAndSub, .formTitleWrapper").mouseout(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
	}));
	if ("newsletter" === $.dmx.current.editable.type) {
		var o = {};
		$(".navEditorInnerPanel").find(".navEditorLinkAndSub").not("#formPlaceholder").find(".navLinkTitleInput").each(function(a, d) { - 1 < $(d).val().toLowerCase().indexOf("email") && (o = $(d))
		});
		o && o.parents(".navEditorLinkAndSub").unbind("mouseover mouseout").append("\x3cspan class\x3d'label'\x3e* Required Field\x3c/span\x3e")
	}
	var r = function(a) {
		if ("newsletter" === $.dmx.current.editable.type) {
			var d = $(a).parents("li").eq(0).find(".inputTypeSelect").val();
			$("#formPlaceholder").find("select.inputTypeSelect").prepend("\x3coption value\x3d'" + d + "'\x3e" + d + "\x3c/option\x3e");
			$(".formAddNew").show()
		}
		var e = m(a),
		g = a.closest("li"),
		j = e.dmid();
		$.changePage({
			clientChange: function() {
				e.remove();
				g.remove();
				$.dmops.redrawSelection()
			},
			serverChange: function() {
				var a = {
					inputId: j
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/deleteforminput/",
					data: a
				})
			}
		})
	};
	$(".navLinkButtonHidden").each(function(a, d) {
		$(d).neeConfirmationPopUpDiv(dmStr["ui.nee.form.3"], {
			initCallback: r
		})
	});
	$(".navLinkButtonEdit").click(function() {
		"newsletter" === $.dmx.current.editable.type && $.dmx.current.editable.handleRemainingOptions(this);
		$(".formInputEditor").hide();
		$(".navEditorLink").removeClass("navEditorLinkActive");
		$(this).closest(".navEditorLinkAndSub").find(".formInputEditor").show();
		$(this).closest(".navEditorLink").addClass("navEditorLinkActive")
	});
	$(".formInputEditorCloser").click(function() {
		u($(this).closest(".navEditorLinkAndSub"));
		n($(this).closest(".navEditorLinkAndSub").find(".navLinkTitleInput"));
		$(".formInputEditor").hide();
		$(this).closest(".navEditorLink").removeClass("navEditorLinkActive")
	});
	var u = function(a) {
		var e = a.find(".inputTypeSelect").val(),
		k = m(a),
		l = k.find('[name^\x3d"dmform-"]');
		1 > l.length && (l = k.find("input"));
		var n = l.attr("name"),
		o = l.dmid();
		l.is("input[type\x3d'radio']") ? (l = l.closest(".radiowrapper"), o = l.dmid()) : l.is("input[type\x3d'checkbox']") && (l = l.closest(".checkboxwrapper"), o = l.dmid());
		$.changePage({
			clientChange: function() {
				if ("newsletter" === $.dmx.current.editable.type) $.dmx.current.editable.handleNewsletterInputChange(e, l, o, a);
				else if ("longtext" == e) l.replaceWith($("\x3ctextarea  name\x3d'" + n + "' duda_id\x3d'" + o + "'/\x3e"));
				else if ("dropdown" == e) l.replaceWith($("\x3cselect  name\x3d'" + n + "' duda_id\x3d'" + o + "'\x3e" + d(a) + "\x3c/select\x3e"));
				else if ("radio" == e) l.replaceWith($("\x3cdiv class\x3d'radiowrapper' duda_id\x3d'" + o + "'\x3e" + g(a, n, o) + "\x3c/div\x3e"));
				else if ("checkbox" == e) l.replaceWith($("\x3cdiv class\x3d'checkboxwrapper' duda_id\x3d'" + o + "'\x3e" + j(a, n, o) + "\x3c/div\x3e"));
				else if ("date" == e) {
					var m = a.find(".dateFormatSelect").val(),
					r = a.find(".langSelect").val(),
					r = $("\x3cinput type\x3d'text' class\x3d'dmDatePicker' lang\x3d'" + r + "' date_format\x3d'" + m + "' name\x3d'" + n + "' duda_id\x3d'" + o + "'/\x3e");
					l.replaceWith(r);
					r.attr("class", r.attr("class"))
				} else "time" == e ? (m = a.find(".timeCheckBox").is(":checked") ? "Hii": "hiia", r = a.find(".langSelect").val(), r = $("\x3cinput type\x3d'text' class\x3d'dmTimePicker' lang\x3d'" + r + "' time_format\x3d'" + m + "' name\x3d'" + n + "' duda_id\x3d'" + o + "'/\x3e"), l.replaceWith(r), r.attr("class", r.attr("class"))) : l.replaceWith($("\x3cinput type\x3d'" + e + "' name\x3d'" + n + "' duda_id\x3d'" + o + "'/\x3e"));
				k.find("input[type\x3d'hidden']").val(k.find("label").text());
				$.dmops.redrawSelection()
			},
			serverChange: function() {
				var a = {
					inputId: k.dmid(),
					inputMarkup: k.outerHTML()
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/changeforminputtype",
					data: a
				})
			}
		})
	};
	$(".inputTypeSelect").change(function() {
		var a = $(this).val();
		"dropdown" == a || "radio" == a || "checkbox" == a ? ($(this).closest(".formInputEditor").find(".inputTypeOptions").show(), $(this).closest(".formInputEditor").find(".dateEditor").hide(), $(this).closest(".formInputEditor").find(".langEditor").hide(), $(this).closest(".formInputEditor").find(".timeEditor").hide()) : "date" == a ? ($(this).closest(".formInputEditor").find(".dateEditor").show(), $(this).closest(".formInputEditor").find(".timeEditor").hide(), $(this).closest(".formInputEditor").find(".langEditor").show(), $(this).closest(".formInputEditor").find(".inputTypeOptions").hide()) : "time" == a ? ($(this).closest(".formInputEditor").find(".dateEditor").hide(), $(this).closest(".formInputEditor").find(".timeEditor").show(), $(this).closest(".formInputEditor").find(".langEditor").show(), $(this).closest(".formInputEditor").find(".inputTypeOptions").hide()) : ($(this).closest(".formInputEditor").find(".inputTypeOptions").hide(), $(this).closest(".formInputEditor").find(".timeEditor").hide(), $(this).closest(".formInputEditor").find(".dateEditor").hide(), $(this).closest(".formInputEditor").find(".langEditor").hide());
		u($(this).closest(".navEditorLinkAndSub"))
	});
	$(".inputTypeOptions").change(function() {
		u($(this).closest(".navEditorLinkAndSub"))
	});
	$(".dateFormatSelect").change(function() {
		u($(this).closest(".navEditorLinkAndSub"))
	});
	$(".timeSelect").change(function() {
		u($(this).closest(".navEditorLinkAndSub"))
	});
	$(".formInputRequired input").change(function() {
		m($(this).closest(".navEditorLinkAndSub")).toggleClass("required");
		u($(this).closest(".navEditorLinkAndSub"))
	});
	$(".timeCheckBox").change(function() {
		u($(this).closest(".navEditorLinkAndSub"))
	});
	var s = function() {
		var d = $(".rightPanel");
		d.empty();
		$.dmfw.setEditorBreadcrumb(null);
		$.dmLoad(d, "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
		function() {
			$.dmx.current.editable.tabsReady(a)
		})
	};
	$(".formSubmitEdit").click(function() {
		$(".slideRightPanelInner").show();
		$(".formEditor").hide();
		$(a).neeSecondaryDesignTabs({
			selector: ".dmformsubmit input",
			tabs: {
				color: ["background", "text", "border"],
				text_style: []
			},
			forceClassName: ".dmformsubmit input",
			useCurElem: !0
		});
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					s()
				}
			},
			{
				title: dmStr["ui.nee.form.4"]
			}]
		})
	});
	$(".formTitleEdit").click(function() {
		$(".slideRightPanelInner").show();
		$(".formEditor").hide();
		$(a).neeSecondaryDesignTabs({
			selector: ".dmform-title",
			tabs: {
				color: ["background", "text", "border"],
				text_style: []
			},
			forceClassName: ".dmform-title",
			useCurElem: !0,
			justBackBtn: !0
		});
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					s()
				}
			},
			{
				title: dmStr["ui.nee.form.4"]
			}]
		})
	});
	$(".formAddNew").unbind("click").click(function() {
		$.changePage({
			clientChange: function() {},
			serverChange: function() {
				var d = $.dmx.current.element.find(".dmforminput:last"),
				e = d.index() + 1,
				g = $("\x3cdiv class\x3d'dmforminput'\x3e\x3clabel for\x3d'dmform-" + e + "'\x3e" + dmStr["ui.nee.form.5"] + " :\x3c/label\x3e\x3cinput type\x3d'text' name\x3d'dmform-" + e + "'/\x3e\x3cinput type\x3d'hidden' name\x3d'label-dmform-" + e + "' value\x3d'" + dmStr["ui.nee.form.5"] + "'/\x3e\x3c/div\x3e");
				g.insertAfter(d);
				d = $("#inputPlaceholder").clone();
				d.removeAttr("id");
				d.removeClass("displayNone");
				d.find(".navLinkTitle").text(g.text());
				d.appendTo(a.find(".navEditorLinks"));
				$.dmops.redrawSelection();
				"newsletter" === $.dmx.current.editable.type && (d = $("#formPlaceholder").find("select.inputTypeSelect").val(), g.find("input[type\x3d'text']").attr("name", $.dmx.current.editable.getInputName(d)), g.find("label").html(d + ":"));
				d = {
					inputParentId: g.parent().dmid(),
					inputBeforeId: g.next().dmid(),
					inputMarkup: g.outerHTML()
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/insertforminput",
					data: d,
					success: function(a) {
						g.copyOuterHtml(a.inputMarkup)
					}
				});
				$.dmfw.editables("form").tabsReadyGeneral(a, {
					editLast: !0
				})
			}
		})
	});
	var B = function(a) {
		var d = $.dmx.current.element.find("input[type\x3d'submit']");
		d.val() != a.val() && $.changePage({
			clientChange: function() {
				d.val(a.val())
			},
			serverChange: function() {
				var a = {
					labelId: d.dmid(),
					labelText: d.val()
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/changeformsubmittext",
					data: a
				})
			}
		})
	};
	$(".formSubmitWrapper .formSubmitInput").blur(function() {
		B($(this))
	});
	$(".formSubmitWrapper .formSubmitInput").keypress(function(a) {
		13 == a.keyCode && B($(this))
	});
	e.editLast && (l = $(".navLinkTitleInput:last"), $(".navLinkButtonEdit:last").click(), l.focus(), "newsletter" === $.dmx.current.editable.type && ($(".inputTypeSelect:last").trigger("change"), l.blur().focus()))
};NEEForm.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEForm.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors())
};NEEForm.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEForm.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmform")
};NEEForm.prototype.getElementTagsSelectors = function() {
	return ".dmform,  .dmform *"
};NEEForm.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorFormSelected")
};NEEForm.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorFormSelected"), this.disableEditInline())
};NEEForm.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEForm.prototype.disableEditInline = function() {};NEEForm.prototype.clone = function(a) {
	return new NEEForm(a)
};NEEForm.prototype.docReady = function() {};NEEForm.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: 0
	})
};NEEForm.prototype.afterInsert = function(a) {
	a = a || $.dmx.current.element;
	a = a.find("input[type\x3d'submit']");
	a.attr("class", a.attr("class"))
};
function NEENewsletter() {
	var a = new NEEForm,
	e = a.editorReady,
	d = {},
	g = {};
	a.mindTouchId = "dmMtConstantContact";
	a.ccWindowParams = "top\x3d10,left\x3d10,height\x3d480,width\x3d500,location\x3dno,menubar\x3dno,resizable\x3dno,status\x3dno,titlebar\x3dno,toolbar\x3dno";
	a.selectOptions = "";
	a.remainingOptions = [];
	a.type = "newsletter";
	a.priority = 0.09;
	a.timer = null;
	a.title = function() {
		return dmStr["ui.nee.ccForm.1"]
	};
	a.inlineEditorProperties = {
		isEdit: $.dmfw.isPT() || $.dmfw.isDudaone(),
		title: dmStr["ui.nee.ccForm.1"]
	};
	a.getElementTagsSelectors = function() {
		return ".dmccform,  .dmccform *"
	};
	a.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/ccWhite.png",
			editableDraggedText: dmStr["ui.nee.ccForm.1"]
		}
	};
	a.isMember = function(d) {
		var e = $(d).parents(".dmform");
		return (0 < e.length ? e: $(d)).find(".dmform-wrapper").is(a.getElementTagsSelectors())
	};
	a.widget = {
		id: "dudaConstantContactId",
		preId: "dudaConstantContactId",
		defaults: {
			email: $.dmx.site.accountOwner,
			needs_premium_validation: !0,
			wr: !1
		}
	};
	a.tabsReady = function(a, d) {
		a.neeSecondaryTabsControl([{
			id: "formGeneral",
			name: dmStr["ui.general"],
			url: "/editor/nee/editableObjects/form/nee.form.ccform.jsp",
			onReady: function() {
				$.dmfw.editables("newsletter").tabsReadyGeneral(a, d)
			}
		},
		{
			id: "formSettings",
			name: dmStr["ui.nee.form.2"],
			url: "/editor/nee/editableObjects/form/nee.form.ccsettings.jsp",
			onReady: function() {
				$.dmfw.editables("newsletter").tabsReadySettings(a, d)
			}
		}])
	};
	a.buttonTabInfo.type[0].onTabReady = a.tabsReady;
	a.editorReady = function() {
		a.timer && clearInterval(a.timer);
		g = $.dmx.current.element;
		var d = localStorage.getItem("token"),
		e = g.find("input[name\x3d'listid']").val(),
		l = $(".rightPanel"),
		m = window.location.host; ! d && (g && g.find("input[name\x3d'token']").val()) && (d = g.find("input[name\x3d'token']").val(), localStorage.setItem("token", d));
		window.clickFunc = function() {
			window.windowFrame = window.open("https://oauth2.constantcontact.com/oauth2/oauth/siteowner/authorize?response_type\x3dtoken\x26client_id\x3d" + commonProps["constantcontact.key"] + "\x26" + ("redirect_uri\x3dhttp://" + m + "/cclandingpage.html"), "ccLogin", a.ccWindowParams)
		}; ! d || "undefined" === d || null === d ? (l.load("/editor/nee/editableObjects/form/nee.form.cclogin.jsp"), !$.browser.msie && window.addEventListener ? window.addEventListener("storage", a.editorReady, !1) : a.timer = setInterval(a.editorReady, 500)) : (!$.browser.msie && window.addEventListener ? window.removeEventListener("storage", a.editorReady, !1) : a.timer && clearInterval(a.timer), l.html("\x3cimg style\x3d'position: absolute; top: 50%; left: 50%; margin: -22px 0 0 28px;' src\x3d'/editor/public/tpl/images/bx_loader.gif'\x3e"), "undefined" !== d && a.hasToken(d, e))
	};
	a.hasToken = function(j) {
		var k = g.find("input[name\x3d'token']");
		$.dmops.updateCurrentAttributes({
			attrToAdd: {
				value: j
			}
		},
		{
			element: k
		});
		$.dmGet({
			url: "/sites/" + $.dmx.site.id + "/getconstantcontactlists/" + j,
			success: function(g) {
				d = g;
				e.apply(a, [$($.dmfw._editors().last().id).get(0)])
			},
			error: function(a) {
				return a
			}
		})
	};
	a.afterEditorTabsLoaded = function() {
		var e = d.length,
		k = $(".slideRightPanelInner"),
		l = $("#ccListSelectContainer"),
		m = $("#ccListSelect"),
		n = g.find("input[name\x3d'listid']").val(),
		o = $(".updateButton, .slideBtn"),
		r = "";
		if (1 < e) {
			k.addClass("grayBg");
			for (k = 0; k < e; k++) r += "\x3coption value\x3d'" + d[k].list_id + "'\x3e" + d[k].list_name + "\x3c/option\x3e";
			$(r).appendTo(m);
			m.val(isNaN(n) ? -1 : n);
			var u = {};
			m.on("focus",
			function() {
				if (u = $(this).find("option[value\x3d'-1']")) u.remove(),
				$(this).trigger("change")
			}).on("blur",
			function() {
				u || $(this).prepend('\x3coption value\x3d"-1"\x3eplease select your list\x3c/option\x3e')
			}).on("change",
			function() {
				var d = $(this).val(); - 1 != d ? ($.dmx.editor.valid = !0, o.parent().off("click.checklist", o)) : ($.dmx.editor.valid = !1, o.parent().off("click.checklist").on("click.checklist", o,
				function(a) {
					"footerEditable" !== $(a.target).attr("class") && (a = $(".rightPanelTab").eq(0), a = !a.hasClass("tabSelect") ? a: m, $("#navEditorInnerPanel").scrollTop(0), $.dmfw.showValidationError(a, dmStr["ui.nee.ccForm.2"]), setTimeout(function() {
						$(".qtip.ui-tooltip").qtip("hide")
					},
					2500))
				}));
				a.updateListId(d)
			});
			m.val(n).change();
			l.show()
		} else e = parseInt(d[0].list_id),
		a.updateListId(e),
		k.removeClass("grayBg"),
		l.hide()
	};
	a.updateListId = function(a) {
		var d = {},
		e = g.find("input[name\x3d'listid']");
		d.value = a;
		$.dmops.updateCurrentAttributes({
			attrToAdd: d
		},
		{
			element: e
		})
	};
	a.addFields = function(d) {
		var e = $("#formPlaceholder"),
		l = e.find(".inputTypeSelect");
		l.html("").append(a.selectOptions);
		g.find(".dmforminput").each(function(a, g) {
			var o = $(".formAddNew");
			2 < a ? o.hide() : o.show();
			var o = e.clone(),
			r = $(g).find("input").attr("ccname");
			"undefined" == typeof r && (r = l.find("option").eq(0).val());
			o.removeAttr("id");
			o.removeClass("displayNone");
			var u = $(g).find("label").text().trim();
			o.find(".navLinkTitleInput").val("" == u || "New Field :" == u ? r + ":": u).css("text-transform", "capitalize");
			o.find(".inputTypeSelect").val(r);
			$(g).is(".required") && o.find(".formInputRequired input").attr("checked", "");
			l.find("option[value\x3d'" + r + "']").remove();
			o.appendTo(d.find(".navEditorLinks"))
		})
	};
	a.getInputName = function(a) {
		return "First Name" === a ? "firstname": "Last Name" === a ? "lastname": "Phone Number" === a ? "homephone": "email"
	};
	a.handleNewsletterInputChange = function(d, e, g, m) {
		m = $(m).find(".navLinkTitleInput");
		var n = $(e.siblings("label"));
		m.val(d + " :").css("text-transform", "capitalize");
		n.html(d + " :").css("text-transform", "capitalize");
		e.replaceWith($("\x3cinput type\x3d'" + ("First Name" === d || "Last Name" === d ? "text": "Phone Number" === d ? "tel": "email") + "' ccname\x3d'" + d + "' name\x3d'" + a.getInputName(d) + "' duda_id\x3d'" + g + "'/\x3e"))
	};
	a.handleRemainingOptions = function(d) {
		var e = $(d).parents(".navEditorLinks").eq(0).find(".inputTypeSelect");
		d = $(d).parents(".navEditorLink").eq(0).find(".inputTypeSelect");
		var g = d.val(),
		m = e.length;
		d.html("").append(a.selectOptions);
		for (var n = 0; n < m; n++) {
			var o = $(e).eq(n).attr("value");
			o != g && d.val(g).find("option[value\x3d'" + o + "']").remove()
		}
	};
	return a
}
function NEEOpenTable() {
	this.priority = 0.1;
	this.type = "opentable";
	this.isWidget = !1;
	this.insertBeforeNav = this.isExtension = !0;
	this.currentData = null;
	this.addClearWidget = !1;
	this.title = function() {
		return dmStr["ui.nee.opentable.1"]
	};
	this.mindTouchId = "dmMtOpenTable";
	this.showMindTouchHelp = !0;
	this.ext = {
		id: "opentable",
		preId: "opentable",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !0,
			description: dmStr["ui.nee.opentable.2"],
			wr: !0
		}
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/openTable.png",
			editableDraggedText: dmStr["ui.nee.widgets.16"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.opentable.1"]
	};
	this.editorDesc = "Allow site visitors to make dining reservations online.";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/opentable/nee.openTable.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.tabsReady,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: {
						tab_colors: ["background_widgets", "border"],
						tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEOpenTable.prototype.tabsReady = function(a) {
	function e() {
		var a = [];
		$(".opRestRowsWrap").children().each(function(d) {
			var e = $(this);
			a[d] = {
				location: e.find(".restLocation").val(),
				id: e.find(".restID").val(),
				country: e.find(".opCountry").val()
			}
		});
		return a
	}
	$("#openTableHelp").dmQtip({
		content: dmStr["ui.nee.opentable.3"]
	});
	var d = $.dmx.current.editable.element;
	$("#opDescription").val(d.find(".text").eq(0).text().trim());
	_updateInfo = function() {
		var a = Base64.encode(JSON.stringify(e()));
		$.dmx.current.element.attr("rest_data", a);
		if (! (a == this.currentData && $.dmx.current.element.attr("description") == $("#opDescription").val())) {
			currentData = a;
			var g = {
				rest_data: this.currentData,
				description: $("#opDescription").val(),
				needs_premium_validation: !0
			};
			$.changePage({
				clientChange: function() {
					$.dmx.current.element.attr("description", g.description);
					$.dmx.current.element.attr("rest_data", g.rest_data);
					$.dmx.current.element.find(".text").eq(0).html(g.description)
				},
				serverChange: function() {
					$.dmsrv.updateExtension(d, g)
				}
			})
		}
	};
	$.dmAddAllPagesButtons(d);
	var g = function() {
		$(".restLocation , .restID").unbind("blur").bind("blur",
		function() {
			_updateInfo()
		});
		$(".restLocation , .restID").unbind("keypress").bind("keypress",
		function(a) {
			13 == a.keyCode && _updateInfo()
		});
		$(".opCountry").unbind("change").bind("change",
		function() {
			_updateInfo()
		});
		$(".opRestRowDeleteWrap").unbind("click").bind("click",
		function() {
			$(this).closest(".opRestRow").remove();
			_updateInfo();
			2 >= $(".opRestRow").length && $.dmfw.isDudaone() && $(".restID").attr("placeholder", "Restaurant ID")
		});
		2 < $(".opRestRow").length && $.dmfw.isDudaone() && $(".restID").attr("placeholder", "ID");
		$("#opDescription").unbind("blur").bind("blur",
		function() {
			_updateInfo()
		});
		$("#opDescription").unbind("keypress").bind("keypress",
		function(a) {
			13 == a.keyCode && _updateInfo()
		})
	},
	j;
	j = null != $.dmx.current.element.attr("rest_data") ? JSON.parse(Base64.decode($.dmx.current.element.attr("rest_data"))) : [{
		id: "",
		location: "",
		country: "us"
	}];
	0 == j.length && (j = [{
		id: "",
		location: "",
		country: "us"
	}]);
	for (var k = 0; k < j.length; k++) {
		var l = $.tmpl($(".templateObject"), j[k]).show();
		l.appendTo(".opRestRowsWrap");
		l.find(".opCountry").val(j[k].country)
	}
	2 == j.length && $(".restID").attr("placeholder", "Restaurant ID");
	$(".opAddRestRow").unbind("click.add").bind("click.add",
	function() {
		var a = $(".opRestRow").eq(0).clone();
		a.find(".restLocation").attr("value", "");
		a.find(".restID").attr("value", "");
		a.find(".defOption").attr("selected", !0);
		a.appendTo(".opRestRowsWrap");
		g();
		a.find(".restLocation").focus();
		_updateInfo()
	});
	g();
	a.find(".opRestRowsWrap").sortable({
		disabled: !1,
		cursor: 'url("/editor/nee/images/shell/closedhand.cur"), default',
		placeholder: "dmUi-state-highlight",
		forcePlaceholderSize: !0,
		tolerance: "pointer",
		toleranceElement: "\x3e div",
		handle: "div",
		items: "li",
		axis: "y",
		maxLevels: 0,
		tabSize: 1E3,
		update: function() {},
		stop: function() {
			_updateInfo()
		},
		start: function() {}
	})
};NEEOpenTable.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEOpenTable.prototype.docReady = function() {};NEEOpenTable.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEOpenTable.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEOpenTable.prototype.getElementTagsSelectors = function() {
	return ".dmopentable,  .dmopentable *"
};NEEOpenTable.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEOpenTable.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmopentable")
};NEEOpenTable.prototype.disableEditInline = function() {};NEEOpenTable.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEOpenTable.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorOTSelected")
};NEEOpenTable.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorOTSelected"), this.disableEditInline())
};NEEOpenTable.prototype.checkClose = function() {
	var a = 0 === $("input.restID:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center",
			adjustY: 2,
			maxWidth: "180"
		},
		d = $.parseJSON(Base64.decode($.dmx.current.element.attr("rest_data"))),
		g = !$.validatePhoneNumber($("input.restID:visible").val()),
		j = g ? "ui.nee.promptMassages.19": "ui.nee.promptMassages.5";
		1 > d.length || "" === d[0].id || g ? $.dmfw.showPromptError($("input.restID:visible"), dmStr[j], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	a)
};
function NEETabs(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.nee.tabs.1"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtTabs";
	this.priority = 1;
	this.type = "tabs";
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'dmtabs default'\x3e\x3cdiv class\x3d'dmtabsheader'\x3e\x3cdiv  class\x3d'dmtab active tab1'\x3e\x3cb\x3e\x3cspan class\x3d'icon'\x3e\x3c/span\x3e" + dmStr["ui.nee.tabs.2"] + " 1\x3c/b\x3e\x3cspan\x3e\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'dmtab tab2'\x3e\x3cb\x3e\x3cspan class\x3d'icon'\x3e\x3c/span\x3e" + dmStr["ui.nee.tabs.2"] + " 2\x3c/b\x3e\x3cspan\x3e\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'dmtab tab3'\x3e\x3cb\x3e\x3cspan class\x3d'icon'\x3e\x3c/span\x3e" + dmStr["ui.nee.tabs.2"] + " 3\x3c/b\x3e\x3cspan\x3e\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'dmundertabhead'\x3e\x3c/div\x3e\x3cdiv class\x3d'dmtabscont'\x3e\x3cdiv\x3e\x3c/div\x3e\x3cdiv style\x3d'display:none !important'\x3e\x3c/div\x3e\x3cdiv style\x3d'display:none !important'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"
	};
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.tabs.1"]
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/tabs.png",
			editableDraggedText: dmStr["ui.nee.widgets.19"]
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noEditorOnInsert = !1;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/tabs/nee.tabs.tabs.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.tabsReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.tabs.3"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					selector: ".dmtab:not(.active) b",
					tabs: {
						tabs_shape: [],
						color: ["background", "text", "border"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.tabs.4"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					selector: ".active b, .dmundertabhead",
					tabs: {
						color: ["background", "text", "border"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEETabs.prototype.tabsReadyGeneral = function(a, e) {
	e = e || {};
	a.find(".navEditorLinks").empty();
	$.dmx.current.element.find(".dmtab").each(function(d, e) {
		var g = a.find("#tabPlaceholder").clone();
		g.removeAttr("id");
		g.removeClass("displayNone");
		g.find(".navLinkTitle").text($(e).text().trim());
		g.appendTo(a.find(".navEditorLinks"))
	});
	var d = function(a) {
		a = a.closest(".navEditorLinkAndSub").index();
		return $($.dmx.current.element.find(".dmtab").get(a))
	},
	g = function(a) {
		return a.parent().parent().find(".dmtabscont").children(":eq(" + a.index() + ")")
	};
	a.find(".navEditorLinks").sortable({
		disabled: !1,
		cursor: 'url("/editor/nee/images/shell/closedhand.cur"), default',
		placeholder: "dmUi-state-highlight",
		forcePlaceholderSize: !0,
		tolerance: "pointer",
		toleranceElement: "\x3e div",
		handle: "div",
		items: "li",
		axis: "y",
		maxLevels: 0,
		tabSize: 1E3,
		update: function() {},
		stop: function() {
			var a = d(draggedElement),
			e = g(a);
			a.index() != draggedTab.index() && $.changePage({
				clientChange: function() {
					a.index() > draggedTab.index() ? (draggedTab.insertAfter(a), draggedTabContent.insertAfter(e)) : (draggedTab.insertBefore(a), draggedTabContent.insertBefore(e))
				},
				serverChange: function() {
					var a = {
						headerId: draggedTab.dmid(),
						headerParentId: draggedTab.parent().dmid(),
						headerBeforeId: draggedTab.next().length ? draggedTab.next().dmid() : null,
						contentId: draggedTabContent.dmid(),
						contentParentId: draggedTabContent.parent().dmid(),
						contentBeforeId: draggedTabContent.next().length ? draggedTabContent.next().dmid() : null
					};
					$.dmPostWithHistory({
						url: "/pages/" + $.dmx.currentPage() + "/movetab",
						data: a
					})
				}
			})
		},
		start: function(a, e) {
			draggedElement = $(e.item).closest("li");
			draggedTab = d(draggedElement);
			draggedTabContent = g(draggedTab)
		}
	});
	a.find(".navLinkTitle").click(function() {
		var a = $(this),
		d = a.parent().find(".navLinkTitleInput");
		d.val(a.text().trim());
		d.show();
		d.focus();
		a.hide()
	});
	var j = function(a) {
		var d = a.parent().find(".navLinkTitle");
		if (d.text().trim() != a.val().trim()) {
			var e = a.closest(".navEditorLinkAndSub").index(),
			g = $($.dmx.current.element.find(".dmtab").get(e));
			$.changePage({
				clientChange: function() {
					g.find("b").text(a.val().trim());
					d.text(a.val().trim())
				},
				serverChange: function() {
					$.dmPostWithHistory({
						url: "/pages/" + $.dmx.currentPage() + "/changeelementtext/" + g.find("b").dmid() + "/?text\x3d" + encodeURIComponent(g.find("b").text())
					})
				}
			})
		}
		a.hide();
		d.show()
	};
	a.find(".navLinkTitleInput").blur(function() {
		j($(this))
	});
	a.find(".navLinkTitleInput").keypress(function(a) {
		13 == a.keyCode && j($(this))
	});
	a.find(".navEditorLinkAndSub").mouseover(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "visible");
		1 == a.find(".navEditorLinks .navEditorLinkAndSub").length ? $(this).find(".navLinkButtonHidden").hide() : $(this).find(".navLinkButtonHidden").show()
	});
	a.find(".navEditorLinkAndSub").mouseout(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
	});
	var k = function(a) {
		var e = d(a),
		j = g(e),
		k = a.closest("li"),
		r = e.dmid(),
		u = j.dmid();
		$.changePage({
			clientChange: function() {
				e.remove();
				j.remove();
				k.remove();
				$.dmops.redrawSelection()
			},
			serverChange: function() {
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/deletetab/" + r + "/" + u
				})
			}
		})
	};
	a.find(".navLinkButtonHidden").each(function(a, d) {
		$(d).neeConfirmationPopUpDiv(dmStr["ui.nee.tabs.5"], {
			initCallback: k,
			forceWidth: "300px"
		})
	});
	a.find(".navLinkButtonColor").click(function() {
		a.find(".slideRightPanelInner").show();
		a.find(".tabsEditor").hide();
		for (var e = d($(this)).attr("class").split(" "), g = ".", j = 0; j < e.length; j++) if (0 == e[j].indexOf("tab")) {
			g += e[j] + " b";
			break
		}
		$(a).neeSecondaryDesignTabs({
			selector: g,
			tabs: {
				color: ["background", "text", "border"],
				text_style: []
			}
		});
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					var d = $(".rightPanel");
					d.empty();
					$.dmfw.setEditorBreadcrumb(null);
					$.dmLoad(d, "/editor/nee/editableObjects/tabs/nee.tabs.tabs.jsp",
					function() {
						NEETabs.prototype.tabsReadyGeneral(a)
					})
				}
			},
			{
				title: dmStr["ui.color"]
			}]
		})
	});
	a.find(".navAddNew").unbind("click").click(function() {
		$.changePage({
			clientChange: function() {},
			serverChange: function() {
				var d = $.dmx.current.element.find(".dmtab:last"),
				e = $("\x3cdiv class\x3d'dmtab'\x3e\x3cb\x3e\x3cspan class\x3d'icon'\x3e\x3c/span\x3e\x3c/b\x3e\x3cspan\x3e\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e");
				e.insertAfter(d);
				e.find("b").text(dmStr["ui.nee.tabs.2"] + " " + (e.index() + 1));
				e.addClass("tab" + (e.index() + 1));
				d = g(d);
				$("\x3cdiv style\x3d'display:none !important'\x3e\x3c/div\x3e").insertAfter(d);
				var j = d.next(),
				d = a.find("#tabPlaceholder").clone();
				d.removeAttr("id");
				d.removeClass("displayNone");
				d.find(".navLinkTitle").text(e.text());
				d.appendTo(a.find(".navEditorLinks"));
				d = {
					headerParentId: e.parent().dmid(),
					headerBeforeId: null,
					headerMarkup: e.outerHTML(),
					contentParentId: j.parent().dmid(),
					contentBeforeId: null,
					contentMarkup: j.outerHTML()
				};
				$.dmPostWithHistory({
					url: "/pages/" + $.dmx.currentPage() + "/inserttab",
					data: d,
					success: function(a) {
						e.copyOuterHtml(a.headerMarkup);
						j.copyOuterHtml(a.contentMarkup)
					}
				});
				$.dmfw.editables("tabs").tabsReadyGeneral(a, {
					editLast: !0
				});
				$.dmfw.editables("tabs").afterInsert()
			}
		})
	});
	e.editLast && a.find(".navLinkTitle:last").click()
};NEETabs.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEETabs.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEETabs.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEETabs.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmtabs")
};NEETabs.prototype.getElementTagsSelectors = function() {
	return ".dmtabs,  .dmtabsheader, .dmtabsheader *, .dmundertabhead, .dmtabscont"
};NEETabs.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorTabsSelected")
};NEETabs.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorTabsSelected"), this.disableEditInline())
};NEETabs.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEETabs.prototype.disableEditInline = function() {};NEETabs.prototype.clone = function(a) {
	return new NEETabs(a)
};NEETabs.prototype.docReady = function() {};NEETabs.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: 0
	});
	$.dmx.current.element.unbind("click").click(function(a) {
		$(a.target).is(".dmtabs.dmLocked .dmtabscont \x3e div, .dmtabs.dmLocked .dmtabscont \x3e div *") && $.dmfw.selectAndOpenEditor($(a.target).closest(".dmtabscont \x3e div"))
	})
};NEETabs.prototype.afterInsert = function() {
	$.dmops.checkEmptyContent();
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTabs();
	NEFW.PREVIEW.get(0).contentWindow.handleTabsClick();
	$.dmops.redrawSelection()
};
function NEEBlog() {
	this.title = function() {
		return dmStr["ui.nee.blog.1"]
	};
	this.priority = 0.9;
	this.type = "blog";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: "Blog",
		padding: "outer",
		isExpandable: !1,
		isCollapsable: !1,
		isCopy: !1,
		isPaste: !1
	};
	this.allowedOperations = function(a) {
		var e = {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		};
		this._isPostComment($(a)) && (e.insertBefore = !1, e.insertAfter = !1);
		return e
	}
}
NEEBlog.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(this._getElementTagsSelectors()) && (e = !0);
	return e
};NEEBlog.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEBlog.prototype.getCorrectElement = function(a) {
	return $(a).is(".dmPostCommentWrapperTitle *, .dmPostCommentWrapperTitle") || $(a).is(".dmPostComment *, .dmPostComment") || $(a).is(".commentsWrapper *, .commentsWrapper") ? $(a).closest(".commentsWrapper").get(0) : $(a).is(".dmBlogInnerPostPage *, .dmBlogInnerPostPage") ? $(a).closest(".dmBlogInnerPostPage").get(0) : $(a).is(".dmRssContainer *, .dmRssContainer") ? $(a).closest(".dmRssContainer").get(0) : $(a).getTopBlockElement().get(0)
};NEEBlog.prototype._getElementTagsSelectors = function() {
	return ".dmRssContainer, .dmRssItem, .postPageNav, .postPageInner, .commentsWrapper, .dmBlogInnerPostPage, .dmRssContainer *, .dmRssItem *, .postPageNav *, .postPageInner *, .commentsWrapper *, dmBlogInnerPostPage *"
};NEEBlog.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorBlogSelected")
};NEEBlog.prototype.deselectInline = function() {
	null != this.element && $(this.element).removeClass("inlineEditorBlogSelected")
};NEEBlog.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this._isContainer() ? (d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.blog.2"] + "\x3c/div\x3e"), d.isMovable = !1, d.isDelete = !1, d.isExpandable = !1) : this._isPostComment() ? (d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.blog.3"] + "\x3c/div\x3e"), d.isDelete = !1, d.isMovable = !1) : this._isPostPageInner() && (d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.blog.4"] + "\x3c/div\x3e"), d.isMovable = !1, d.isDelete = !1, d.isExpandable = !1);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEBlog.prototype.docReady = function() {};NEEBlog.prototype.editorReady = function(a) {
	this.$ed = $(a);
	a = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.5"],
			imgSrc: "HeadingStyleImgIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: "*#dm div.dmPostCommentTitle",
				element: ".dmPostCommentTitle",
				addCommentExplanation: !0,
				CommentExplanationData: "divExplanationCommentTitle",
				divToAddExplanationText: dmStr["ui.nee.blog.22"],
				checkExsistence: !0
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.6"],
			imgSrc: "TextStyleIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: "*#dm div.dmPostCommentContent, *#dm div.dmPostCommentDetailsLine *",
				element: ".dmPostCommentContent",
				addCommentExplanation: !0,
				CommentExplanationData: "divExplanationCommentBodyText",
				divToAddExplanationText: dmStr["ui.nee.blog.23"],
				checkExsistence: !0
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.7"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: this._TabReadyCommentPageBackground
		}]
	};
	var e = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.7"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: this._TabReadyMainPageBackground
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.5"],
			imgSrc: "HeadingStyleImgIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: " *#dm div.dmPostTitle",
				element: ".dmPostTitle"
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.6"],
			imgSrc: "TextStyleIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: "*#dm div.dmPostDetails *, *#dm div.dmPostDescriptionDiv",
				element: ".dmPostDescriptionDiv"
			}
		}]
	},
	d = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.7"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: this._TabReadyPostPageBackground
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.5"],
			imgSrc: "HeadingStyleImgIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: " *#dm div.dmPostPageTitle, *#dm div.dmPostCommentWrapperTitle",
				element: ".dmPostPageTitle"
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.6"],
			imgSrc: "TextStyleIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: "*#dm div.postPageInner, #dm div.dmPostPageContents *",
				element: ".postPageInner"
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			text: dmStr["ui.nee.blog.8"],
			imgSrc: "LinksStyleImgIcon",
			onTabReady: this._changeCommentStyle,
			toReturn: {
				classes: "*#dm div.dmPostPageAuthor *, *#dm div.dmLabelsArea *",
				element: ".dmPostPageAuthor"
			}
		}]
	};
	this._isContainer() ? ($("#contentTitle").text(dmStr["ui.nee.blog.19"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: e
	})) : this._isPostPageInner() ? ($("#contentTitle").text(dmStr["ui.nee.blog.20"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: d
	})) : this._isPostComment() && ($("#contentTitle").text(dmStr["ui.nee.blog.21"]), this.$ed.find(".buttonTab").neeEditorTabs({
		tabs: a
	}));
	this.$ed.addClass("isBlogEditor")
};NEEBlog.prototype._TabReadyMainPageBackground = function(a, e) {
	var d = ["*#dm div.dmRssContainer"],
	g = $.dmfw.getPreviewElement(".dmRssContainer"),
	j = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.9"],
		onReady: function() {
			d = ["*#dm div.dmRssItem"];
			g = $.dmfw.getPreviewElement(".dmRssItem");
			_TabReadyDesignPageBackgroundColor(a, e, d, g)
		}
	},
	{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.10"],
		onReady: function() {
			d = ["*#dm div.allWrapper"];
			g = $.dmfw.getPreviewElement(".allWrapper");
			_TabReadyDesignPageBackgroundColor(a, e, d, g)
		}
	}];
	$(a).neeSecondaryTabsControl(j)
};NEEBlog.prototype._TabReadyCommentPageBackground = function(a, e) {
	var d = ["*#dm div.dmPostCommentTitle"],
	g = $.dmfw.getPreviewElement(".dmPostCommentTitle"),
	j = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.11"],
		onReady: function() {
			d = ["*#dm div.dmPostCommentTitle"];
			g = $.dmfw.getPreviewElement(".dmPostCommentTitle");
			_TabReadyDesignPageBackgroundColor(a, e, d, g)
		}
	},
	{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.6"],
		onReady: function() {
			d = ["*#dm div.dmPostComment"];
			g = $.dmfw.getPreviewElement(".dmPostComment");
			_TabReadyDesignPageBackgroundColor(a, e, d, g)
		}
	}];
	$(a).neeSecondaryTabsControl(j)
};NEEBlog.prototype._TabReadyPostPageBackground = function(a, e) {
	var d = ["*#dm div.dmBlogInnerPostPage"],
	g = $.dmfw.getPreviewElement(".dmBlogInnerPostPage"),
	j = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.7"],
		onReady: function() {
			d = ["*#dm div.dmBlogInnerPostPage"];
			g = $.dmfw.getPreviewElement(".dmBlogInnerPostPage");
			_TabReadyDesignPageBackgroundColor(a, e, d, g)
		}
	}];
	$(a).neeSecondaryTabsControl(j)
};
function _TabReadyDesignPageBackgroundColor(a, e, d, g) {
	e = g.css("background-color");
	0 != g.length && $.dmops.scrollPreviewToElement(g);
	a.find(".colorPickerWidget").neeColorPicker(e, dmStr["ui.nee.blog.18"],
	function(a) {
		updateInChangePage(d, "background-color", a)
	},
	function(a) {
		updateInPreviewOnly(d, "background-color", a)
	});
	a.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
		elem: g,
		forceClassName: d[0],
		callback: function(a) {
			updateInChangePage(d, "background-image", "url(" + a + ")", !0)
		},
		changeGlobally: !0
	})
}
function _checkElementExsistenceAndShowBlogComment(a, e) {
	if (0 == e.length) {
		var d = dmStr["ui.nee.blog.12"] + " \x3c/br\x3e " + dmStr["ui.nee.blog.13"],
		g = $("\x3cdiv\x3e\x3c/div\x3e").appendTo(a).addClass("warningHnotExist");
		$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("warningHalert");
		$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).css("margin-left", "50px").html(d)
	}
}
NEEBlog.prototype._changeCommentStyle = function(a, e) {
	function d(d) {
		function e(a) {
			updateInChangePage(g, d, a)
		}
		0 != j.length && $.dmops.scrollPreviewToElement(j);
		var k = j.css(d);
		"font-size" == d ? a.neeChangeTextSize(k, e) : "font-family" == d && a.neeChangeFontFamily(k, e);
		this.checkExsistence && _checkElementExsistenceAndShowBlogComment(a.find(".slideRightPanelInner"), j)
	}
	var g = [e.classes],
	j = $.dmfw.getPreviewElement(e.element),
	k = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.blog.14"],
		onReady: function() {
			var d = j.css("color");
			0 != j.length && $.dmops.scrollPreviewToElement(j);
			a.find(".colorPickerWidget").neeColorPicker(d, dmStr["ui.nee.blog.17"],
			function(a) {
				updateInChangePage(g, "color", a)
			},
			function(a) {
				updateInPreviewOnly(g, "color", a)
			});
			this.addCommentExplanation && (d = $('\x3cdiv class\x3d"blogCommentExplanationDivAbove"\x3e\x3c/div\x3e'), $("\x3cdiv\x3e\x3c/div\x3e").appendTo(d).addClass(this.CommentExplanationData), $('\x3cdiv class\x3d"blogCommentExplanationText"\x3e\x3c/div\x3e').appendTo(d).html(this.divToAddExplanationText), a.find(".slideRightPanelInner").prepend(d));
			this.checkExsistence && _checkElementExsistenceAndShowBlogComment(a.find(".slideRightPanelInner"), j)
		},
		addCommentExplanation: e.addCommentExplanation ? e.addCommentExplanation: !1,
		CommentExplanationData: e.addCommentExplanation ? e.CommentExplanationData: !1,
		divToAddExplanationText: e.addCommentExplanation ? e.divToAddExplanationText: !1,
		checkExsistence: e.checkExsistence ? !0 : !1
	},
	{
		url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
		name: dmStr["ui.nee.blog.15"],
		onReady: function() {
			d("font-size")
		},
		checkExsistence: e.checkExsistence ? !0 : !1
	},
	{
		url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlFontFamily.jsp",
		name: dmStr["ui.nee.blog.16"],
		onReady: function() {
			d("font-family")
		},
		checkExsistence: e.checkExsistence ? !0 : !1
	}];
	$(a).neeSecondaryTabsControl(k)
};NEEBlog.prototype._isContainer = function() {
	return $.dmx.current.element.is(".dmRssContainer")
};NEEBlog.prototype._isPostPageInner = function() {
	return $.dmx.current.element.is(".dmBlogInnerPostPage")
};NEEBlog.prototype._isPostComment = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".commentsWrapper")
};NEEBlog.prototype.getTitle = function() {
	return "blog"
};NEEBlog.prototype.onEditorClose = function() {};
function NEEImageSlider() {
	this.title = function() {
		return dmStr["ui.nee.imageSlider.101"]
	};
	this.isWidget = !0;
	this.widget = {
		id: "dudaSliderId",
		preId: "dudaSliderId",
		defaults: {
			stretch: !0,
			animation: !0,
			randomize: !1,
			directionNav: !0,
			controlNav: !1,
			pausePlay: !0,
			slideshowSpeed: "7000",
			animationDuration: "600",
			isAutoPlay: !1
		}
	};
	this.mindTouchId = "dmMtImageSlider";
	this.showMindTouchHelp = !0;
	this.disableClickImg = this.isActive = !1;
	this.priority = 0.9;
	this.type = "imageSlider";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.imageSlider.1"]
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/imgSlider.png",
			editableDraggedText: dmStr["ui.nee.widgets.8"]
		}
	};
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'flex-container dmImageSlider dmNoMargin' \x3e \x3cdiv class\x3d'flexslider' sliderScriptParams\x3d'{isAutoPlay: false, stretch: true,animation: true,randomize: false, directionNav: true, controlNav: false, slideshowSpeed: 7000, animationDuration: 600,pausePlay: true}'\x3e \x3cul class\x3d'slides'\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function(a, d) {
		return "image" == d && !_DragManager.dragFrameworkProps.isFromFramework ? {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !0,
			insertInsideBottom: !0
		}: {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.imageSliderOnReadyGeneral(e)
			},
			onTabClose: function(a, d) {
				$.dmx.events.unbind("fwKeyDown.imageSlider");
				d && d()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(e).neeSecondaryDesignTabs({
					selector: ".flexslider",
					tabs: {
						slidereffects: [],
						color: ["background"]
					},
					onReadyCallbacks: {
						slidereffects: a.imageSliderOnReadyEffects
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.imageSlider.2"],
			imgSrc: "TextImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					selector: ".flex-caption",
					afterTextButtonInit: function(a) {
						a.find($("#dirRight, #dirLeft")).hide()
					},
					tabs: {
						color: ["background", "text"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					showWidthHeight: !0,
					hidePadding: !0,
					hideWidth: !0,
					hidePrec: !0,
					forceHeightScale: 400,
					afterChangesCallback: function() {
						_updateSliderInIframeSync({
							calcMargin: !0
						})
					},
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEImageSlider.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEImageSlider.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorImageSliderSelected")
};NEEImageSlider.prototype.handleDropDifferent = function(a) {
	return a.editable() && "image" == a.editable().type ? !0 : !1
};NEEImageSlider.prototype.handleDropDifferentImpl = function(a) {
	$.dmx.current.editable.addImage(a)
};NEEImageSlider.prototype.generatePlaceHolder = function(a) {
	a && a.editable() && "image" == a.editable().type ? _DragManager.generatePlaceHolder({
		position: "absolute",
		"z-index": "99999",
		top: "20%",
		left: "25%",
		width: "150px",
		height: "120px",
		"line-height": "120px"
	},
	dmStr["ui.imageSlider.placeholder.addImage"]) : _DragManager.generatePlaceHolder()
};NEEImageSlider.prototype.imageSliderOnReadyGeneral = function(a) {
	0 == a.find(".slideRightPanelInner").length ? a.empty().prepend($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e")) : a.find(".slideRightPanelInner").empty();
	var e = this;
	jQuery.ajax({
		url: "/editor/nee/editableObjects/imageSlider/imageSliderContainer.jsp",
		async: !1,
		success: function(d) {
			function g(d, e) {
				0 < $("body").find(".popupWinExampleMask").length && $("body").find(".popupWinExampleMask").hide();
				var g = NEEMultiPhotoControl.getInstance().makeArrayOfMultiImagesSource(d, e);
				if (g) {
					for (var k = [], l = [], m = [], z = 0; z < g.length; z++) k[z] = j(g[z]),
					l[z] = k[z].find(".imageSliderPreviewImg"),
					m[z] = l[z].dmImgNaturalSize();
					$.changePage({
						clientChange: function() {},
						serverChange: function() {
							for (var d = $.dmx.current.element.find(".slides li"), e = [], j = 0; j < d.length; j++) $(d[j]).hasClass("clone") || e.push($(d[j]));
							for (var d = e[e.length - 1], k = [], l = [], j = 0; j < g.length; j++) {
								var d = e[e.length - 1 + j],
								n = $("\x3cli\x3e\x3cimg dm\x3d'true'\x3e\x3c/img\x3e\x3c/li\x3e");
								d ? n.insertAfter(d) : $.dmx.current.element.find(".slides").append(n);
								n.find("img").attr("src", g[j]).attr("irH", m.height).attr("irW", m.width);
								n.attr("index", NEEMultiPhotoControl.getInstance().getCurrNumToPut(a) - 1 + j);
								k[j] = n.outerHTML();
								l[j] = n;
								NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.addSlideToImageSlider($.dmx.current.element.find(".flexslider").attr("duda_id"), n)
							}
							e = {
								containerId: $.dmx.current.element.find(".slides").dmid(),
								imageItemBeforeId: null,
								multiImagesToAdd: k,
								numberPhotos: g.length
							};
							$.dmPostWithHistory({
								url: "/pages/" + $.dmx.currentPage() + "/insertmanyimageinslider",
								data: e,
								success: function(d) {
									for (var e = 0; e < g.length; e++) $(l[e]).copyOuterHtml($(d.multiImagesToAdd[e]).outerHTML());
									NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
									_updateSliderInIframeSync({
										isFromAdd: !0
									})
								}
							})
						}
					})
				}
				$.dmx.current.editable.placeholderTest()
			}
			function j(d) {
				$(".smallTempPlaceHlderForImage:first").remove();
				var g = $("\x3cli class\x3d'imageSliderContainer'\x3e\x3c/li\x3e").attr("index", NEEMultiPhotoControl.getInstance().getCurrNumToPut(a));
				$("\x3cdiv class\x3d'imageSliderContainerMover'\x3e\x3c/div\x3e").appendTo(g);
				var j = $("\x3cdiv class\x3d'imageSliderPreviewSmallImg'\x3e\x3c/div\x3e").appendTo(g),
				k = $("\x3cimg\x3e\x3c/img\x3e");
				k.attr("src", d).appendTo(j).addClass("imageSliderPreviewImg");
				0 < $(".smallTempPlaceHlderForImage:first").length ? g.insertBefore($(".smallTempPlaceHlderForImage:first")) : g.appendTo(a.find(".imageSliderSortableImagesWrapper"));
				var j = $("\x3cdiv class\x3d'operationsLineInPlaceholder'\x3e\x3c/div\x3e").appendTo(g),
				l = $.dmfw.isDudaone() ? "dm-icon-trash2": "";
				$("\x3cspan class\x3d'imgPlaceholderDeleteOptionSlider " + l + "'\x3e\x3c/span\x3e").attr("title", dmStr["ui.nee.imageSlider.7"]).appendTo(j).unbind("click").click(function() {
					m($(this).closest(".imageSliderContainer"))
				});
				g.on("click",
				function() {});
				k.unbind("click").click(function(a) {
					$.dmx.current.editable.disableClickImg || (a.stopPropagation(), a = $(this).closest("li"), a = NEEMultiPhotoControl.getInstance().getImageLi(a), a = parseInt(a.attr("index")), _updateSliderInIframeSync({
						stayCurrSlide: a
					}))
				});
				k = $.dmfw.isDudaone() ? "dm-icon-link3": "";
				$("\x3cspan class\x3d'imgPlaceholderLinkOptionSlider " + k + "'\x3e\x3c/span\x3e").attr("title", dmStr["ui.nee.imageSlider.8"]).appendTo(j).unbind("click").click(function() {
					function d(g) {
						var j = {};
						j.element = $(g);
						e.linkEditor = $(a).neeLinksWidget({
							current: j,
							editable: $.dmfw.editables("link"),
							noTextToDisplay: !0,
							noSurroundButton: !0,
							onLinkRemove: function() {
								$.dmPreviewSaving();
								_restoreSliderUI();
								$.dmPreviewSaved()
							}
						})
					}
					var g = NEEMultiPhotoControl.getInstance().getImageLi($(this).closest("li")),
					j = g.find("a");
					if (!j || 0 >= j.length) $.dmBlockUI(),
					$.dmops.surroundCurrentWithLink(function(a) {
						for (var e = g.dmid(), e = $.dmx.current.element.find('li[duda_id\x3d"' + e + '"]').not(".clone"), j = 0; 0 < $(e[j]).length;) $(e[j]).find("img").replaceWith(a),
						j++;
						d(a);
						$.dmUnblockUI()
					},
					g.find("img"));
					else {
						var k = $(j).attr("href"); ! k || 0 >= k.length ? ($.dmPreviewSaving(), $.dmops.populateEmptyLink(j,
						function() {
							d(j);
							$.dmPreviewSaved()
						})) : d(j)
					}
					_setSliderBreadcrumb(dmStr["ui.nee.imageSlider.8"])
				});
				_restoreSliderUI = function() {
					var a = $(".rightPanel");
					a.empty();
					$.dmfw.setEditorBreadcrumb(null);
					$(".removeLinkButton").hide();
					$(".cropButton").hide();
					$.dmLoad(a, "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
					function() {
						NEEImageSlider.prototype.imageSliderOnReadyGeneral(a)
					})
				};
				_setSliderBreadcrumb = function(a) {
					$.dmfw.setEditorBreadcrumb({
						parts: [{
							click: function() {
								_restoreSliderUI()
							}
						},
						{
							title: a
						}]
					})
				};
				k = $.dmfw.isDudaone() ? "dm-icon-page-rows": "";
				k = $("\x3cspan class\x3d'imgPlaceholderAddTextSlider " + k + "'\x3e\x3c/span\x3e").attr("title", dmStr["ui.nee.imageSlider.9"]).appendTo(j);
				$("\x3cdiv\x3e\x3cdiv class\x3d'closeTextEreaSlider'\x3e\x3c/div\x3e\x3cinput type\x3d'text' placeholder\x3d'" + dmStr["ui.nee.photoGallery.9"] + "' id\x3d'imageSliderTextToBeAdded' class\x3d'imageSliderTextToBeAdded'\x3e \x3c/input\x3e\x3cdiv class\x3d'textEreaSliderBtns'\x3e\x3cdiv class\x3d'addTextEreaSlider'\x3e" + dmStr["ui.add"] + "\x3c/div\x3e\x3cdiv class\x3d'eraseTextFromSlider'\x3e" + dmStr["ui.delete"] + "\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e").addClass("imgPlaceholderAddTextSliderOpenAddText").appendTo(k);
				k.unbind("click").click(function(a) {
					a.preventDefault();
					$(".imgPlaceholderAddTextSliderOpenAddText").hide();
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText").show().positionWithinParent({
						parent: "div.rightPanel",
						margin: {
							right: 10,
							left: 10
						}
					});
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText input").focus();
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText input").unbind("keypress").keypress(function(a) {
						13 == a.keyCode && $(".addTextEreaSlider").click()
					})
				});
				k.find("#imageSliderTextToBeAdded").val(0 < $($.dmx.current.element.find(".slides li")).find('img[src\x3d"' + d + '"]').closest("li").find("p").length ? $($.dmx.current.element.find(".slides li")).find('img[src\x3d"' + d + '"]').closest("li").find("p").html() : "");
				$(".closeTextEreaSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					$(this).closest(".imgPlaceholderAddTextSliderOpenAddText").hide()
				});
				$(".addTextEreaSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					var d = $(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find("input").val();
					if (d && "add your text" != d) {
						$(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find(".closeTextEreaSlider").trigger("click");
						a = $(this).closest("li");
						a = NEEMultiPhotoControl.getInstance().getImageLi(a);
						var e = a.dmid(),
						g = parseInt(a.attr("index"));
						$.changePage({
							clientChange: function() {},
							serverChange: function() {
								var a = $.dmx.current.element.find('li[duda_id\x3d"' + e + '"]');
								0 < a.find("p").length && a.find("p").remove();
								var j = $("\x3cp class\x3d'flex-caption'\x3e\x3c/p\x3e");
								j.html(d);
								var k = {
									containerId: a.find("img").dmid(),
									imageItemBeforeId: null,
									imageItemMarkup: j.outerHTML()
								};
								$.dmPostWithHistory({
									url: "/pages/" + $.dmx.currentPage() + "/insertimageinslider",
									data: k,
									success: function(d) {
										j.copyOuterHtml(d.imageItemMarkup);
										a.append(j);
										_updateSliderInIframeSync({
											stayCurrSlide: g
										})
									}
								})
							}
						})
					}
				});
				$(".eraseTextFromSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					a = $(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find("input").val().trim();
					var d = NEEMultiPhotoControl.getInstance().getImageLi($(this).closest("li")).find("p");
					a && 0 < d.length && ($(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find("input").val(""), $(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find(".closeTextEreaSlider").trigger("click"), m($(this).closest("li"), !0))
				});
				d = $.dmfw.isDudaone() ? "dm-icon-pencil2": "";
				$("\x3cspan class\x3d'imgPlaceholderAddOptionSlider " + d + "'\x3e\x3c/span\x3e").attr("title", dmStr["ui.nee.imageSlider.10"]).appendTo(j).unbind("click").click(function() {
					var a = $(this).closest(".imageSliderContainer");
					_setSliderBreadcrumb(dmStr["ui.nee.imageSlider.10"]);
					_handleCropImage(a)
				});
				_handleCropImage = function(a) {
					var d = $(".rightPanel");
					d.empty();
					d.append($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e"));
					var e = NEEMultiPhotoControl.getInstance().getImageLi(a),
					g = parseInt(e.attr("index")),
					j = e.find("img");
					d.neeSecondaryDesignTabs({
						tabs: {
							crop: []
						},
						sliderCropOptions: {
							element: e,
							originalSrc: "undefined" != j.attr("dm_orig_src") ? j.attr("dm_orig_src") : null,
							imgSrc: j.attr("src"),
							currElemDmid: j.dmid(),
							cropDim: j.attr("dm_crop_dim"),
							imgElem: e,
							callback: function(d) {
								var e = NEEMultiPhotoControl.getInstance().getImageLi(a).find("img");
								e.attr("src", d.croppedImageSource);
								e.attr("dm_orig_src", d.originalImageSource);
								e.attr("dm_crop_dim", d.cropDimStr);
								_updateSliderInIframeSync({
									stayCurrSlide: g
								})
							}
						}
					})
				};
				g.mouseover(function() {
					$(this).addClass("dragCursor")
				});
				g.mouseout(function() {
					$(this).removeClass("dragCursor draggingCursor dragImageSmallAppr")
				});
				g.mouseup(function() {
					$(this).removeClass("dragCursor draggingCursor dragImageSmallAppr")
				});
				NEEMultiPhotoControl.getInstance().galleryAddHandlers(g);
				return g
			}
			$.dmops.redrawSelection();
			a.append($(d));
			d = a.find(".openImagePickerPopUpWrapper");
			d.find(".slideRightPanelInner").empty();
			a.find("#sliderButtonUploadWrapper").neePopUpDiv(d, {
				init: function(a) {
					a.neeSecondaryIconTabs({
						tabs: {
							upload: [{
								isChange: !1
							}],
							original_images: [],
							url: []
						},
						callback: g,
						uploadBiggerButton: !0,
						isMultipleUpload: !0,
						isImagePickerPopup: !0
					})
				},
				toChangeFunction: g,
				showIphone: !0
			});
			$.dmx.current.editable.placeholderTest();
			var k = $.dmx.current.editable.element.find(".slides").find("li").not(".clone");
			d = [];
			for (var l = 0; l < k.length; l++) d[l] = $(k[l]).find("img").attr("src");
			k = $("\x3cdiv class\x3d'imageSliderImagesWrapper'\x3e\x3c/div\x3e").appendTo(a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv").addClass("slideRightPanelImgSlider"));
			$("\x3cul class\x3d'imageSliderSortableImagesWrapper'\x3e\x3c/ul\x3e").appendTo(k);
			$("\x3cdiv class\x3d'explanationHowToGallery' style\x3d'margin: 0;border-top: none;'\x3e\x3cdiv class\x3d'navLinkButtonHidden navLinkButton navLinkButtonBG deleteAllImagesBtn' style\x3d'margin-left: 10px;position: relative;'\x3e\x3cdiv class\x3d'navLinkBtnRemoveDiv'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e").appendTo(a);
			$(".deleteAllImagesBtn").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.imageMsgs.4"] + "\x3c/b\x3e " + dmStr["ui.nee.imageMsgs.2"] + "", {
				initCallback: function() {
					var d = [],
					d = $.dmx.current.element.find(".slides li").not(".clone");
					$.dmops.deleteElements(d,
					function() {
						_updateSliderInIframeSync({
							isFromAdd: !0
						});
						a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv").find(".imageSliderImagesWrapper li").remove();
						NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
						$.dmx.current.editable.placeholderTest();
						$.dmops.redrawSelection()
					},
					{
						dontCloseEditor: !0
					})
				},
				noText: dmStr["ui.nee.imageMsgs.5"],
				yesText: dmStr["ui.delete"],
				bindCloseToNo: !0,
				forceWidth: "340px",
				forceHeight: 3 == dm_account_locale ? "160px": "150px",
				classes: "deleteAllImagesPopup"
			});
			$(document.body).on("click", ".smallTempPlaceHlderForImage",
			function() {
				$("#sliderButtonUploadWrapper").trigger("click")
			});
			for (k = 0; k < d.length; k++) j(d[k]);
			NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
			$(".imageSliderSortableImagesWrapper").sortable({
				placeholder: "imageSliderPlaceHolderDrop",
				items: "li",
				disable: !0,
				stop: function(d, e) {
					NEEMultiPhotoControl.getInstance().fixElementsIndexes(a);
					draggedElement = $(e.item).closest("li");
					draggedElement.removeAttr("style");
					var g = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement),
					j = parseInt(g.attr("index"));
					g.index() != draggedImage.index() && $.changePage({
						clientChange: function() {
							g.index() > draggedImage.index() ? draggedImage.insertAfter(g) : draggedImage.insertBefore(g)
						},
						serverChange: function() {
							var a = {
								imageItemId: draggedImage.dmid(),
								containerId: draggedImage.parent().dmid(),
								imageItemBeforeId: draggedImage.next().length ? draggedImage.next().dmid() : null
							};
							$.dmPostWithHistory({
								url: "/pages/" + $.dmx.currentPage() + "/moveimageinslider",
								data: a,
								success: function() {
									_updateSliderInIframeSync({
										stayCurrSlide: j
									});
									$.dmx.current.editable.disableClickImg = !1
								}
							})
						}
					})
				},
				start: function(a, d) {
					$.dmx.current.editable.disableClickImg = !0;
					$(d.helper).addClass("draggingCursor dragImageSmallAppr");
					draggedElement = $(d.item).closest("li");
					draggedImage = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement)
				},
				sort: function(a, d) {
					$(d.helper).addClass("draggingCursor dragImageSmallAppr");
					draggedElement = $(d.item).closest("li");
					draggedImage = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement)
				}
			});
			$.dmx.events.unbind("fwKeyDown.imageSlider").bind("fwKeyDown.imageSlider",
			function(a) {
				46 === a.keyCode && 0 < $(".imageSliderContainer.selected").size() && m($(".imageSliderContainer.selected"))
			});
			var m = function(d, e) {
				var g, j = [];
				d.jquery ? d.each(function(a, d) {
					j.push($(d))
				}) : j = d instanceof Array ? d: [d];
				var k = j,
				l = NEEMultiPhotoControl.getInstance().getImagesLi(j),
				m = [];
				for (g = 0; g < l.length; g++) m.push(l[g].dmid());
				if (e) {
					m = [];
					k = [];
					for (g = 0; g < l.length; g++) k.push(l[g].find("p")),
					m.push(l[g].find("p").dmid())
				}
				$.changePage({
					clientChange: function() {
						if (e) for (g = 0; g < m.length; g++) $.dmx.current.element.find('p[duda_id\x3d"' + m[g] + '"]').remove();
						else {
							for (g = 0; g < k.length; g++) k[g].remove();
							0 == a.find(".imageSliderSortableImagesWrapper li").length && NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
							NEEMultiPhotoControl.getInstance().fixElementsIndexes(a);
							for (g = 0; g < m.length; g++) $.dmx.current.element.find('li[duda_id\x3d"' + m[g] + '"]').remove()
						}
						$.dmops.redrawSelection()
					},
					serverChange: function() {
						$.dmPostWithHistory({
							url: "/pages/" + $.dmx.currentPage() + "/deletesliderimage/",
							data: m,
							success: function() {
								NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.removeSlideFromImageSlider($.dmx.current.element.find(".flexslider").attr("duda_id"), l);
								NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a)
							}
						})
					}
				})
			}
		}
	})
};
var _changeEffectInSlider = function(a, e) {
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			var d = $.dmx.current.element.find(".flexslider"),
			g = d.attr("sliderScriptParams"),
			g = eval("(" + g + ")");
			g[a] = e;
			g = JSON.stringify(g);
			d.attr("sliderScriptParams", g);
			g = g.replace(RegExp('"', "g"), "'");
			g = {
				effectsAttrToRemove: ["sliderScriptParams"],
				effectsAttrToAdd: {
					sliderScriptParams: g
				}
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/changeimageslideritem/" + d.dmid(),
				data: g,
				success: function() {
					_updateSliderInIframeSync()
				}
			})
		}
	})
},
_updateSliderInIframeSync = function(a) {
	a = a || {}; ! 1 == $.dmx.current.editable.isActive && ($.dmx.current.editable.isActive = !0, _updateSliderInIframe(a,
	function() {
		$.dmx.current.editable.isActive = !1
	}), setTimeout(function() {
		$.dmx.current.editable.isActive = !1
	},
	400))
},
_updateSliderInIframe = function(a) {
	NEEMultiPhotoControl.getInstance().setCorrectIndexesFrame($.dmx.current.element.find(".flexslider"));
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initImageSlider(!0, $.extend({},
	{
		elemId: $.dmx.current.element.find(".flexslider").attr("duda_id"),
		start: _redrawSliderInFrame
	},
	a), a.calcMargin ? !0 : !1);
	$.dmops.redrawSelection();
	$.dmfw.setPreviewEditPolicy(!0)
};NEEImageSlider.prototype.imageSliderOnReadyEffects = function(a) {
	var e = $.dmx.current.element.find(".flexslider").attr("sliderScriptParams"),
	e = eval("(" + e + ")"),
	d = e.directionNav;
	a.find("#ShadowOnOff").onOffBtn({
		initState: d,
		onFn: function() {
			_changeEffectInSlider("directionNav", !0)
		},
		offFn: function() {
			_changeEffectInSlider("directionNav", !1)
		}
	});
	d = e.stretch;
	a.find("#imageSliderFitSize").onOffBtn({
		initState: d,
		onFn: function() {
			_changeEffectInSlider("stretch", !0)
		},
		offFn: function() {
			_changeEffectInSlider("stretch", !1)
		}
	});
	e = e.isAutoPlay;
	a.find("#imageSliderEffect").onOffBtn({
		initState: e,
		onFn: function() {
			_changeEffectInSlider("isAutoPlay", !0)
		},
		offFn: function() {
			_changeEffectInSlider("isAutoPlay", !1)
		}
	})
};_redrawSliderInFrame = function() {
	$.dmops.redrawSelection()
};NEEImageSlider.prototype.addImage = function(a) {
	console.log("[NEEImageSlider addImage]" + JSON.stringify(a));
	var e = a.src;
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			for (var d = $.dmx.current.element.find(".slides li"), g = [], j = 0; j < d.length; j++) $(d[j]).hasClass("clone") || g.push($(d[j]));
			var d = g[g.length - 1],
			k = $("\x3cli\x3e\x3cimg dm\x3d'true' class\x3d'imageFromDrag'\x3e\x3c/img\x3e\x3c/li\x3e");
			d ? k.insertAfter(d) : $.dmx.current.element.find(".slides").append(k);
			k.find("img").attr("src", e);
			d = k.find("img").dmImgNaturalSize();
			k.find("img").attr("irH", d.height).attr("irW", d.width);
			k.attr("index", $.dmx.current.element.find(".slides").find("li").not(".clone").length - 1);
			NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.addSlideToImageSlider($.dmx.current.element.find(".flexslider").attr("duda_id"), k);
			d = {
				containerId: k.closest(".slides").dmid(),
				imageItemBeforeId: null,
				imageItemMarkup: k.outerHTML()
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/insertimageinslider",
				data: d,
				success: function(d) {
					k.copyOuterHtml(d.imageItemMarkup);
					k.attr("index", g.length);
					null != a.onDone && (a.onDone(), $.dmfw.selectAndOpenEditor($.dmx.current.element))
				}
			})
		}
	})
};NEEImageSlider.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorImageSliderSelected"), this.disableEditInline())
};NEEImageSlider.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEImageSlider.prototype.getElementTagsSelectors = function() {
	return ".dmImageSlider, .flexslider, .flexslider *, .flex-control-nav, flex-control-nav *, .flex-direction-nav, .flex-direction-nav *"
};NEEImageSlider.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEImageSlider.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmImageSlider")
};NEEImageSlider.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEImageSlider.prototype.disableEditInline = function() {};NEEImageSlider.prototype.docReady = function() {};NEEImageSlider.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEImageSlider.prototype.afterInsert = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initImageSlider(!1, {
		start: _redrawSliderInFrame
	});
	$.dmops.redrawSelection()
};NEEImageSlider.prototype.initOnDrop = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initImageSlider(!1, {
		start: _redrawSliderInFrame
	})
};NEEImageSlider.prototype.onEditorClose = function() {
	$.dmx.events.unbind("fwKeyDown.imageSlider")
};NEEImageSlider.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center",
			maxWidth: "180"
		};
		1 > $.dmx.current.element.find("ul.slides li").length ? $.dmfw.showPromptError($("ul.imageSliderSortableImagesWrapper"), dmStr["ui.nee.promptMassages.11"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	!0)
};NEEImageSlider.prototype.placeholderTest = function() {
	$.dmfw.preview.testAndSetPlaceholder("UL.slides", "dmSliderPlaceholder")
};
function NEEAdsense() {
	this.showMindTouchHelp = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.adsense.1"]
	};
	this.mindTouchId = "dmMtAdsense";
	this.ext = {
		id: "adsense",
		preId: "adsense",
		defaults: {
			publisher: "",
			size: "small",
			needs_premium_validation: !0
		}
	};
	this.priority = 1;
	this.type = "adsense";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/adSense.png",
			editableDraggedText: ""
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.adsense.1"]
	};
	this.rightPanelElementSelector = "#generalAdsense";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/googlesense/nee.buttonsHtmlAdsense.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: []
					},
					hidePadding: !0
				})
			}
		}]
	}
}
NEEAdsense.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEAdsense.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorAdsenseSelected")
};NEEAdsense.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#adsensePublisher").val(a.attr("publisher"));
	$(".adSize").removeClass("selected");
	$(".adSize" + a.attr("size")).addClass("selected");
	$("#adsensePublisher").blur(function() {
		_updateInfo()
	});
	$("#adsensePublisher").keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	$(".adSize").click(function() {
		$(".adSize").removeClass("selected");
		$(this).addClass("selected");
		_updateInfo()
	});
	_validatePublisher = function() {
		var a = !0,
		d = $("#adsensePublisher").val();
		if ("" == d.trim() || !d.match(/pub-[0-9]{16}$/)) a = !1;
		a || $.dmfw.promptBeforeClose("#adsensePublisher", dmStr["ui.nee.adsense.2"], !1, {
			adjustX: 4,
			maxWidth: "180"
		});
		return a
	};
	_updateInfo = function() {
		if (_validatePublisher()) {
			var e = {
				publisher: $("#adsensePublisher").val(),
				size: $(".adSize.selected").attr("size")
			};
			$.changePage({
				clientChange: function() {
					a.attr("publisher", e.publisher);
					a.attr("size", e.size)
				},
				serverChange: function() {
					$.dmsrv.updateExtension(a, e)
				}
			})
		}
	};
	$.dmAddAllPagesButtons(a)
};NEEAdsense.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorAdsenseSelected"), this.disableEditInline())
};NEEAdsense.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEAdsense.prototype.getElementTagsSelectors = function() {
	return ".dmAdsense, .dmAdsense *"
};NEEAdsense.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEAdsense.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmAdsense")
};NEEAdsense.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEAdsense.prototype.disableEditInline = function() {};NEEAdsense.prototype.docReady = function() {};NEEAdsense.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEAdsense.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustX: 4,
			maxWidth: "180"
		},
		e = $.dmx.current.element,
		d = "" === $("input#adsensePublisher").val() ? "ui.nee.promptMassages.4": "ui.nee.adsense.2";
		"" === e.attr("publisher") ? $.dmfw.showPromptError($("input#adsensePublisher"), dmStr[d], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};
function NEEPhotoGallery() {
	this.title = function() {
		return dmStr["ui.nee.photoGallery.3"]
	};
	this.isWidget = !0;
	this.widget = {
		id: "dudaPhotoGalleryId",
		preId: "dudaPhotoGalleryId",
		defaults: {
			thumbnailsPerRow: 4,
			rowsToShow: 3
		}
	};
	this.addClearWidget = this.isActive = !1;
	this.priority = 0.9;
	this.type = "photoGallery";
	this.inlineEditor = null;
	this.mindTouchId = "dmMtPhotoGallery";
	this.showMindTouchHelp = !0;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/gallery.png",
			editableDraggedText: dmStr["ui.nee.widgets.28"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.widgets.28"].replace("^", "")
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function(a, d) {
		return "image" == d && !_DragManager.dragFrameworkProps.isFromFramework ? {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !0,
			insertInsideBottom: !0
		}: $(a).is(".dmLinkList, .dmLinkList *") ? {
			insertBefore: $(a).is(".dmLinkList"),
			insertAfter: $(a).is(".dmLinkList"),
			insertInsideTop: !1,
			insertInsideBottom: !1
		}: {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.buttonTabInfo = $.dmfw.isDudaone() ? {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.photoGalleryOnReadyGeneral(e,
				function() {
					$.dmops.redrawSelection()
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.galleryOnReadyDesign(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					showWidthHeight: !1,
					hideWidth: !0,
					hidePrec: !0,
					forceHeightScale: 400,
					afterChangesCallback: _updateGalleryInIframe,
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}: {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.photoGalleryOnReadyGeneral(e,
				function() {
					$.dmops.redrawSelection()
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.galleryOnReadyDesign(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.background"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background", "border"],
						shape: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					showWidthHeight: !1,
					hideWidth: !0,
					hidePrec: !0,
					forceHeightScale: 400,
					afterChangesCallback: _updateGalleryInIframe,
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEPhotoGallery.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEPhotoGallery.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEPhotoGallery.prototype.selectInline = function() {
	null != this.element && ($(this.element).addClass("inlineEditorPhotoGallerySelected"), this.element.find(".photoGalleryViewAll").unbind("click.redrawselection").bind("click.redrawselection",
	function() {
		$.dmops.redrawSelection()
	}))
};NEEPhotoGallery.prototype.handleDropDifferent = function(a) {
	return a.editable() && "image" == a.editable().type ? !0 : !1
};NEEPhotoGallery.prototype.handleDropDifferentImpl = function(a) {
	$.dmx.current.editable.addImage(a)
};NEEPhotoGallery.prototype.generatePlaceHolder = function(a) {
	a && a.editable() && "image" == a.editable().type ? _DragManager.generatePlaceHolder({
		position: "absolute",
		"z-index": "99999",
		top: "25%",
		left: "25%",
		width: "150px",
		height: "50px",
		"line-height": "50px"
	},
	dmStr["ui.imageGallery.placeholder.addImage"]) : _DragManager.generatePlaceHolder()
};NEEPhotoGallery.prototype.photoGalleryOnReadyGeneral = function(a) {
	var e = this;
	0 == a.find(".slideRightPanelInner").length ? a.empty().prepend($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e")) : a.find(".slideRightPanelInner").empty();
	jQuery.ajax({
		url: "/editor/nee/editableObjects/photoGallery/photoGalleryContainer.jsp",
		async: !1,
		success: function(d) {
			function g(d, e) {
				0 < $("body").find(".popupWinExampleMask").length && $("body").find(".popupWinExampleMask").hide();
				var g = NEEMultiPhotoControl.getInstance().makeArrayOfMultiImagesSource(d, e);
				if (g) {
					for (var k = [], l = [], m = [], n = [], o = [], r = 0; r < g.length; r++) k[r] = j(g[r]),
					l[r] = k[r].find(".imageSliderPreviewImg"),
					m[r] = l[r].dmImgNaturalSize();
					$.changePage({
						clientChange: function() {
							var d = $.dmfw.isDudaone(),
							e = $.dmx.current.element.find("ul.galleryColumn"),
							j = [],
							k = 0,
							l,
							r = $.dmx.current.element.find("li:not(.galleryContainer)");
							d ? 1 > $.dmx.current.element.find("li.photoGalleryThumbs").length ? l = null: ($.each(e,
							function(a, d) {
								j.push($(d).children().length)
							}), k = -1 + j.indexOf(Math.min.apply(Math, j)), l = !0) : l = r[r.length - 1];
							for (var s = 0; s < g.length; s++) {
								d && l ? (k += 1, k === e.length && (k = 0), l = e.eq(k).find("li.photoGalleryThumbs").last(), 0 >= l.length && (l = !1)) : d || (l = r[r.length - 1 + s]);
								var v = $("\x3cli\x3e\x3ca \x3e\x3cimg/\x3e\x3c/a\x3e\x3c/li\x3e");
								l && 0 < l.length ? v.insertAfter(l) : d ? ($.dmx.current.element.find("ul.galleryColumn").eq(k).append(v), l = !0) : $.dmx.current.element.find("ul").eq(0).append(v);
								v.find("img").attr("src", g[s]).attr("irH", m[s].height).attr("irW", m[s].width);
								v.attr("index", NEEMultiPhotoControl.getInstance().getCurrNumToPut(a) - 1 + s);
								v.addClass("photoGalleryThumbs").find("a").attr("href", g[s]).attr("dm_dont_rewrite_url", "true");
								n[s] = v.outerHTML();
								o[s] = v
							}
						},
						serverChange: function() {
							var d = {
								containerId: $.dmx.current.element.find(".gallery").dmid(),
								imageItemBeforeId: null,
								multiImagesToAdd: n,
								numberPhotos: g.length
							};
							$.dmPostWithHistory({
								url: "/pages/" + $.dmx.currentPage() + "/insertmultiimageingallery",
								data: d,
								success: function(d) {
									for (var e = 0; e < g.length; e++) $(o[e]).copyOuterHtml($(d.multiImagesToAdd[e]).outerHTML()),
									$(o[e]).removeClass("photoGalleryThumbs"),
									$(o[e]).addClass("photoGalleryThumbs");
									$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder");
									NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a); ! 1 == $.dmx.current.editable.isActive && ($.dmx.current.editable.isActive = !0, B(void 0,
									function() {
										$.dmx.current.editable.isActive = !1
									}), setTimeout(function() {
										$.dmx.current.editable.isActive = !1
									},
									400))
								}
							})
						}
					})
				}
				$.dmx.current.editable.placeholderTest()
			}
			function j(d) {
				$(".galleryExplanation").show();
				$(".smallTempPlaceHlderForImage:first").remove();
				var e = $("\x3cli class\x3d'imageSliderContainer'\x3e\x3c/li\x3e").attr("index", NEEMultiPhotoControl.getInstance().getCurrNumToPut(a));
				$("\x3cdiv class\x3d'imageSliderContainerMover'\x3e\x3c/div\x3e").appendTo(e);
				var g = $("\x3cdiv class\x3d'imageSliderPreviewSmallImg'\x3e\x3c/div\x3e").appendTo(e);
				$("\x3cimg\x3e\x3c/img\x3e").attr("src", d).appendTo(g).addClass("imageSliderPreviewImg");
				0 < $(".smallTempPlaceHlderForImage:first").length ? e.insertBefore($(".smallTempPlaceHlderForImage:first")) : e.appendTo(a.find(".imageSliderSortableImagesWrapper"));
				var g = $("\x3cdiv class\x3d'operationsLineInPlaceholder'\x3e\x3c/div\x3e").appendTo(e),
				j = $.dmfw.isDudaone() ? "dm-icon-trash2": "";
				$("\x3cspan class\x3d'imgPlaceholderDeleteOptionSlider " + j + "' title\x3d'" + dmStr["ui.nee.photoGallery.6"] + "'\x3e\x3c/span\x3e").appendTo(g).unbind("click").click(function() {
					var d = $(this).closest(".imageSliderContainer"),
					e = NEEMultiPhotoControl.getInstance().getImageLi(d, $.dmfw.isDudaone()).dmid(),
					g = $.dmfw.isDudaone(),
					j = $.dmx.preview.wnd(),
					k = $.dmx.current.element,
					l = k.children("ul").attr("data-dudaone-gallery-cols");
					$.changePage({
						clientChange: function() {
							d.remove();
							0 == a.find(".imageSliderSortableImagesWrapper li").length && ($(".galleryExplanation").hide(), NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a));
							NEEMultiPhotoControl.getInstance().fixElementsIndexes(a);
							g && $.dmx.preview.wnd().$.dmrt.components.photogallery["default"].breakColumns(k);
							$.dmx.current.element.find('li[duda_id\x3d"' + e + '"]').remove();
							g && j.$.dmrt.components.photogallery["default"].splitToColumns(k, l);
							$.dmops.redrawSelection()
						},
						serverChange: function() {
							$.dmPostWithHistory({
								url: "/pages/" + $.dmx.currentPage() + "/deletegalleryimage/" + e,
								success: function() {
									$.dmx.current.editable.placeholderTest();
									NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
									B()
								}
							})
						}
					})
				});
				0 < $.dmfw.getPreviewElement(".innerBar").length && $.dmx.current.element.hasClass("dmPageWidget") && $(".galleryExplanation").hide();
				_restoreGalleryUI = function() {
					var a = $(".rightPanel");
					a.empty();
					$.dmfw.setEditorBreadcrumb(null);
					$(".removeLinkButton").hide();
					$(".cropButton").hide();
					$.dmLoad(a, "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
					function() {
						NEEPhotoGallery.prototype.photoGalleryOnReadyGeneral(a)
					})
				};
				_setGalleryBreadcrumb = function(a) {
					$.dmfw.setEditorBreadcrumb({
						parts: [{
							click: function() {
								_restoreGalleryUI()
							}
						},
						{
							title: a
						}]
					})
				};
				j = $.dmfw.isDudaone() ? "dm-icon-page-rows": "";
				j = $("\x3cspan class\x3d'imgPlaceholderAddTextSlider  " + j + "' title\x3d'" + dmStr["ui.nee.photoGallery.8"] + "'\x3e\x3c/span\x3e").appendTo(g);
				$("\x3cdiv\x3e\x3cdiv class\x3d'closeTextEreaSlider'\x3e\x3c/div\x3e\x3cinput type\x3d'text' placeholder\x3d'" + dmStr["ui.nee.photoGallery.9"] + "' id\x3d'imageSliderTextToBeAdded'\x3e \x3c/input\x3e\x3cdiv class\x3d'textEreaSliderBtns'\x3e\x3cdiv class\x3d'addTextEreaSlider'\x3e" + dmStr["ui.add"] + "\x3c/div\x3e\x3cdiv class\x3d'eraseTextFromSlider'\x3e" + dmStr["ui.delete"] + "\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e").addClass("imgPlaceholderAddTextSliderOpenAddText").appendTo(j);
				j.unbind("click").click(function(a) {
					a.preventDefault();
					$(".imgPlaceholderAddTextSliderOpenAddText").hide();
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText").show();
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText input").focus();
					$(this).find(".imgPlaceholderAddTextSliderOpenAddText input").unbind("keypress").keypress(function(a) {
						13 == a.keyCode && $(".addTextEreaSlider").click()
					})
				});
				j.find("#imageSliderTextToBeAdded").val($($.dmx.current.element.find("li")).find('img[src\x3d"' + d + '"]').attr("alt") ? $($.dmx.current.element.find("li")).find('img[src\x3d"' + d + '"]').attr("alt") : "");
				$(".closeTextEreaSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					$(this).closest(".imgPlaceholderAddTextSliderOpenAddText").hide()
				});
				$(".addTextEreaSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					if ((a = $(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find("input").val()) && a != dmStr["ui.nee.photoGallery.9"]) $(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find(".closeTextEreaSlider").trigger("click"),
					z(a, $(this).closest("li"))
				});
				$(".eraseTextFromSlider").unbind("click").click(function(a) {
					a.stopPropagation();
					$(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find("input").val("");
					$(this).closest(".imgPlaceholderAddTextSliderOpenAddText").find(".closeTextEreaSlider").trigger("click");
					z("", $(this).closest("li"))
				});
				d = $.dmfw.isDudaone() ? "dm-icon-pencil2": "";
				$("\x3cspan class\x3d'imgPlaceholderAddOptionSlider " + d + "' title\x3d'" + dmStr["ui.nee.photoGallery.10"] + "'\x3e\x3c/span\x3e").appendTo(g).unbind("click").click(function() {
					var a = $(this).closest(".imageSliderContainer");
					_setGalleryBreadcrumb(dmStr["ui.nee.imageSlider.10"]);
					_handleCropImageGallery(a)
				});
				_handleCropImageGallery = function(a) {
					var d = $(".rightPanel");
					d.empty();
					d.append($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e"));
					var e = NEEMultiPhotoControl.getInstance().getImageLi(a, $.dmfw.isDudaone()),
					g = e.find("img:first");
					d.neeSecondaryDesignTabs({
						tabs: {
							crop: []
						},
						sliderCropOptions: {
							element: e,
							originalSrc: "undefined" != g.attr("dm_orig_src") ? g.attr("dm_orig_src") : null,
							imgSrc: g.attr("src"),
							currElemDmid: g.dmid(),
							cropDim: g.attr("dm_crop_dim"),
							imgElem: g,
							dontUpdate: !0,
							callback: function(d) {
								var e = NEEMultiPhotoControl.getInstance().getImageLi(a, $.dmfw.isDudaone()),
								g = e.find("img");
								$.changePage({
									clientChange: function() {},
									serverChange: function() {
										var a = {
											attrToRemove: ["href"],
											attrToAdd: {
												href: d.croppedImageSource
											}
										};
										$.dmPostWithHistory({
											url: "/pages/" + $.dmx.currentPage() + "/changeimagegalleryitem/" + e.find("a").dmid(),
											data: a,
											success: function() {}
										})
									}
								});
								e.find("a").attr("href", d.croppedImageSource);
								g.attr("src", d.croppedImageSource);
								g.attr("dm_orig_src", d.originalImageSource);
								g.attr("dm_crop_dim", d.cropDimStr);
								B()
							}
						}
					})
				};
				e.mouseover(function() {
					$(this).addClass("dragCursor")
				});
				e.mouseup(function() {
					$(this).removeClass("dragCursor draggingCursor dragImageSmallAppr")
				});
				e.mouseout(function() {
					$(this).removeClass("dragCursor draggingCursor dragImageSmallAppr")
				});
				NEEMultiPhotoControl.getInstance().galleryAddHandlers(e);
				return e
			}
			$.dmops.redrawSelection();
			a.append($(d));
			d = a.find(".openImagePickerPopUpWrapper");
			d.find(".slideRightPanelInner").empty();
			a.find("#sliderButtonUploadWrapper").neePopUpDiv(d, {
				init: function(a) {
					a.neeSecondaryIconTabs({
						tabs: {
							upload: [{
								isChange: !1
							}],
							original_images: [],
							url: []
						},
						callback: g,
						uploadBiggerButton: !0,
						isMultipleUpload: !0,
						isImagePickerPopup: !0
					})
				},
				toChangeFunction: g,
				showIphone: !0
			});
			$.dmx.current.editable.placeholderTest();
			setTimeout(function() {
				$.dmops.redrawSelection()
			},
			400);
			$.dmx.current.element.find(".photoGalleryViewAll").unbind("click").click(function() {
				$.dmops.redrawSelection()
			});
			$.dmops.redrawSelection();
			var k = $.dmx.current.element;
			$.dmfw.isDudaone() && $.dmx.preview.wnd().$.dmrt.components.photogallery["default"].breakColumns(k);
			var l = $.dmx.current.editable.element,
			m = l.find("li:not(.galleryContainer)");
			d = [];
			for (var n = 0; n < m.length; n++) d[n] = $(m[n]).find("img").attr("src");
			$.dmfw.isDudaone() && (m = k.find("ul.dmPhotoGalleryHolder").attr("data-dudaone-gallery-cols"), $.dmx.preview.wnd().$.dmrt.components.photogallery["default"].splitToColumns(k, m), $.dmx.preview.wnd().$.dmrt.components.photogallery["default"].resetImageSizes(k));
			var o = document.createElement("div"),
			r = l.find(".photogalleryheader");
			$.dmLoad(o, "/editor/nee/editableObjects/nee.widgetTitle.jsp",
			function() {
				$(o).prependTo(a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv"));
				e.handleTitle.widgetTitle.alrenativeCssClass = "photogalleryheader";
				e.handleTitle.widgetTitle.cssClassToAdd = "photogalleryheaderPadding";
				e.handleTitle.widgetTitle.needUpdateCurrentCss = !0;
				e.handleTitle.title = l.find(".photogalleryheader");
				e.handleTitle.hasTitle = 0 < e.handleTitle.title.length;
				e.handleTitle.widgetRuntimeTitle = e.handleTitle.hasTitle ? l.find(".photogalleryheader").html().trim() : "";
				NEEPhotoGallery.prototype.handleTitle.handleTitleinit(a);
				var d = "true" === $.dmx.current.element.find(".photogalleryheader").attr("hide");
				e.handleTitle.displayTitle = !d;
				0 < r.length && $("#generalTitleInput").val(r.html().trim())
			});
			k = $("\x3cdiv class\x3d'imageSliderImagesWrapper'\x3e\x3c/div\x3e").appendTo(a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv").addClass("slideRightPanelGallery"));
			$("\x3cul class\x3d'imageSliderSortableImagesWrapper'\x3e\x3c/ul\x3e").appendTo(k);
			k = a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv");
			m = $("\x3cdiv class\x3d'explanationHowToGallery'\x3e\x3cdiv class\x3d'navLinkButtonHidden navLinkButton navLinkButtonBG explanationHowToGalleryLinkable'\x3e\x3cdiv class\x3d'navLinkBtnHiddenDiv'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'navLinkButtonHidden navLinkButton navLinkButtonBG deleteAllImagesBtn' style\x3d'margin-left: 10px;'\x3e\x3cdiv class\x3d'navLinkBtnRemoveDiv'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");
			$.dmfw.isDudaone() && (k = k.parents(".rightPanel"));
			m.appendTo(k);
			$.dmfw.isDudaone() ? $(".explanationHowToGalleryLinkable").hide() : $(".explanationHowToGalleryLinkable").unbind("click").click(function() {
				$.dmfw.openPreviewPopup()
			});
			k = "\x3cb\x3e" + dmStr["ui.nee.imageMsgs.4"] + "\x3c/b\x3e" + dmStr["ui.nee.imageMsgs.2"] + "";
			$.dmfw.isDudaone() && (k = "\x3cb\x3eDelete All\x3c/b\x3e\x3cbr\x3eAre you sure you want to delete all the images?");
			$(".deleteAllImagesBtn").neeConfirmationPopUpDiv(k, {
				initCallback: function() {
					var d = $.dmx.current.element.find(".gallery li:not(.galleryContainer)");
					$.dmops.deleteElements(d,
					function() {
						a.find(".slideRightPanelInner").not(".toOpenUploadPopUpDiv").find(".imageSliderImagesWrapper li:not(.galleryContainer)").remove();
						NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
						$.dmx.current.editable.placeholderTest();
						$.dmops.redrawSelection()
					},
					{
						dontCloseEditor: !0
					});
					$.dmfw.isDudaone() && $.dmx.current.element.children("ul").eq(0).addClass("dmGalleryPlaceholder")
				},
				noText: dmStr["ui.nee.imageMsgs.5"],
				yesText: dmStr["ui.delete"],
				bindCloseToNo: !0,
				forceWidth: "340px",
				forceHeight: "150px",
				classes: "deleteAllImagesPopup"
			});
			$(document.body).on("click", ".smallTempPlaceHlderForImage",
			function() {
				$("#sliderButtonUploadWrapper").trigger("click")
			});
			$(".galleryExplanation").show();
			for (k = 0; k < d.length; k++) j(d[k]); (0 == d.length || 0 < $.dmfw.getPreviewElement(".innerBar").length && $.dmx.current.element.hasClass("dmPageWidget")) && $(".galleryExplanation").hide();
			NEEMultiPhotoControl.getInstance().handleTempPlachHoldersAddImagesNext(a);
			var u, s;
			$(".imageSliderSortableImagesWrapper").sortable({
				placeholder: "imageSliderPlaceHolderDrop",
				items: "li",
				disable: !0,
				zIndex: 100,
				stop: function(d, e) {
					NEEMultiPhotoControl.getInstance().fixElementsIndexes(a);
					draggedElement = $(e.item).closest("li");
					s = draggedElement.index();
					draggedElement.removeAttr("style");
					var g = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement, $.dmfw.isDudaone());
					s !== u && $.changePage({
						clientChange: function() {
							if ($.dmfw.isDudaone()) {
								var a = $.dmx.preview.wnd(),
								d = $.dmx.current.element,
								e = d.find("ul.dmPhotoGalleryHolder").attr("data-dudaone-gallery-cols");
								a.$.dmrt.components.photogallery["default"].breakColumns(d);
								s > u ? draggedImage.insertAfter(g) : draggedImage.insertBefore(g);
								a.$.dmrt.components.photogallery["default"].splitToColumns(d, e)
							} else s > u ? draggedImage.insertAfter(g) : draggedImage.insertBefore(g)
						},
						serverChange: function() {
							var a = {
								imageItemId: draggedImage.dmid(),
								containerId: draggedImage.parents("ul.gallery").dmid(),
								imageItemBeforeId: draggedImage.next().length ? draggedImage.next().dmid() : null
							};
							$.dmPostWithHistory({
								url: "/pages/" + $.dmx.currentPage() + "/moveimageingallery",
								data: a,
								success: function() {
									B()
								}
							})
						}
					})
				},
				start: function(a, d) {
					$(d.helper).addClass("draggingCursor dragImageSmallAppr");
					draggedElement = $(d.item).closest("li");
					draggedImage = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement, $.dmfw.isDudaone());
					u = d.item.index()
				},
				sort: function(a, d) {
					$(d.helper).addClass("draggingCursor dragImageSmallAppr");
					draggedElement = $(d.item).closest("li");
					draggedImage = NEEMultiPhotoControl.getInstance().getImageLi(draggedElement, $.dmfw.isDudaone())
				}
			});
			var B = function() {
				$.dmfw.isDudaone() || NEEMultiPhotoControl.getInstance().setCorrectIndexesFrame($.dmx.current.element);
				NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
				$.dmops.redrawSelection();
				$.dmfw.setPreviewEditPolicy(!0)
			},
			z = function(a, d) {
				var e = NEEMultiPhotoControl.getInstance().getImageLi(d, $.dmfw.isDudaone()).dmid();
				$.changePage({
					clientChange: function() {},
					serverChange: function() {
						var d = $.dmx.current.element.find('li[duda_id\x3d"' + e + '"]');
						d.find("img").attr("alt", a);
						var g = {
							attrToRemove: ["alt"],
							attrToAdd: {
								alt: a
							}
						};
						$.dmPostWithHistory({
							url: "/pages/" + $.dmx.currentPage() + "/changeimagegalleryitem/" + d.find("img").dmid(),
							data: g,
							success: function() {
								B()
							}
						})
					}
				})
			}
		}
	})
};
var _changeEffectInGallery = function(a, e, d) {
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			var g = $.dmx.current.element,
			j = g.attr("galleryOptionsParams"),
			j = eval("(" + j + ")");
			j[a] = e;
			j = JSON.stringify(j);
			g.attr("galleryOptionsParams", j);
			j = j.replace(RegExp('"', "g"), "'");
			j = {
				attrToRemove: ["galleryOptionsParams"],
				attrToAdd: {
					galleryOptionsParams: j
				}
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/changeimagegalleryitem/" + g.dmid(),
				data: j,
				success: function() {
					_updateGalleryInIframe();
					d && d()
				}
			})
		}
	})
},
_updateGalleryInIframeSync = function(a) { ! 1 == $.dmx.current.editable.isActive && ($.dmx.current.editable.isActive = !0, _updateGalleryInIframe(a,
	function() {
		$.dmx.current.editable.isActive = !1
	}), setTimeout(function() {
		$.dmx.current.editable.isActive = !1
	},
	400))
},
_updateGalleryInIframe = function() {
	NEEMultiPhotoControl.getInstance().setCorrectIndexesFrame($.dmx.current.element);
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	$.dmops.redrawSelection();
	$.dmfw.setPreviewEditPolicy(!0)
};NEEPhotoGallery.prototype.galleryOnReadyDesign = function(a) {
	function e(a, d, e) {
		$.dmops.updateCurrentCss({
			classesToRemove: d,
			attrToRemove: null,
			classesToAdd: a,
			attrToAdd: null
		},
		{
			element: o,
			success: function() {
				e && e.callback && e.callback()
			}
		})
	}
	function d(a, d, e) {
		$.dmops.updateCurrentCss({
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: d,
				value: a
			}]
		},
		$.extend({
			success: j,
			notClearStyle: !0
		},
		e))
	}
	function g(a, d, e) {
		a = {
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: d,
				value: a
			},
			{
				attr: e.onlyBottom ? "border-bottom-style": "border-style",
				value: "solid"
			}]
		};
		e.selector = ".photoGalleryThumbs a";
		$.dmops.updateCurrentCss(a, $.extend({
			success: j,
			notClearStyle: !0
		},
		e))
	}
	function j() {
		var a = eval("(" + $.dmx.current.element.attr("galleryOptionsParams") + ")").rowsToShow,
		d = o.is(".gallery2inArow") ? 2 : o.is(".gallery3inArow") ? 3 : 4,
		e = $.dmx.current.element.find("li");
		if (a != dmStr["ui.nee.photoGallery.108"]) {
			a *= d;
			for (d = 0; d < e.length; d++) d < a ? $(e[d]).css("display", "inline-block") : $(e[d]).css("display", "none")
		} else for (d = 0; d < e.length; d++) $(e[d]).css("display", "inline-block")
	}
	function k() {
		var d, g;
		$.dmfw.isDudaone() ? (d = "/editor/nee/editableObjects/photoGallery/one.designGalleryCustomize.jsp", g = $.dmx.current.element.children("ul").attr("data-dudaone-gallery-cols")) : d = "/editor/nee/editableObjects/photoGallery/nee.designGalleryCustomize.jsp";
		a.find("#colorPickerWrapper").hide();
		a.find(".shapeDesignWrapper").remove();
		$(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
		jQuery.ajax({
			url: d,
			async: !1,
			success: function(d) {
				function j() {
					var a = parseInt($(this).val()),
					d = $.dmx.current.element,
					e = d.find("ul.dmPhotoGalleryHolder"),
					g = dmStr["ui.nee.themePanel.11"],
					k = $.dmx.preview.wnd(),
					m = {
						attrToAdd: {
							"data-dudaone-gallery-cols": a
						}
					};
					e.attr({
						"data-dudaone-gallery-cols": a
					});
					k.$.dmrt.components.photogallery["default"].splitToColumns(d, a);
					$.dmsrv.updateElementAttributes(e, m);
					a = $("#galleryNumOfRowsSelect").val();
					a !== g && (a = parseInt(a));
					l(a)
				}
				function k(d) {
					if (!$.dmfw.isDudaone() && 5 == a.find(".layoutCollection .navShapeItem.selected").attr("number")) {
						var e = Math.ceil((0 < m ? m: 1) / 5);
						r = m;
						var g = {};
						g[0] = dmStr["ui.nee.themePanel.11"];
						for (var j = 1; j < e; j++) g[5 * j] = 5 * j
					} else {
						n = $.dmfw.isDudaone() ? $.dmx.current.element.children("ul").attr("data-dudaone-gallery-cols") || 4 : o.is(".gallery2inArow") ? 2 : o.is(".gallery3inArow") ? 3 : 4;
						r = Math.ceil((0 < m ? m: 1) / n);
						g = {};
						g[0] = dmStr["ui.nee.themePanel.11"];
						for (j = 0; j <= r; j++) 0 != j && (g[j] = j)
					}
					e = eval("(" + $.dmx.current.element.attr("galleryOptionsParams") + ")");
					selectedOption = d ? dmStr["ui.nee.themePanel.11"] : e.rowsToShow;
					var e = $("#galleryNumOfRowsSelect"),
					l;
					l = e.prop ? e.prop("options") : e.attr("options");
					$("option", e).remove();
					$.each(g,
					function(a, d) {
						l[l.length] = new Option(d, a)
					});
					e.val(selectedOption);
					$.browser.msie && (selectedOption > r || "all" === selectedOption.toLowerCase()) && e.val(0);
					d && $("#galleryNumOfRowsSelect").trigger("change")
				}
				function l(a) {
					var d = $.dmx.current.element.find("li:not(.galleryContainer)"),
					e = $.dmx.current.element.children("ul").attr("data-dudaone-gallery-cols"),
					g = a === dmStr["ui.nee.themePanel.11"],
					j = e * a;
					if (K && !g) $.each(d,
					function(a, d) {
						$(d).attr("index") < j ? $(d).show() : $(d).hide()
					});
					else if (g) for (e = 0; e < d.length; e++) $(d[e]).css("display", "inline-block");
					else for (e = 0; e < d.length; e++) e < j ? $(d[e]).css("display", "inline-block") : $(d[e]).css("display", "none");
					_changeEffectInGallery("rowsToShow", a != dmStr["ui.nee.themePanel.11"] ? a: 0 == r ? 100 : r)
				}
				var m, n, r, u, K;
				a.find(".slideRightPanelInner:first").append($(d));
				m = $.dmx.current.element.find("li").length;
				d = $.dmx.current.element.attr("galleryOptionsParams");
				d = eval("(" + d + ")");
				n = o.is(".gallery2inArow") ? 2 : o.is(".gallery3inArow") ? 3 : 4;
				K = $.dmfw.isDudaone();
				r = Math.ceil((0 < m ? m: 1) / n);
				u = $(".galleryThumbShape");
				K && (n = $.dmx.current.element.children("ul").attr("data-dudaone-gallery-cols"));
				K ? (d = $.dmx.current.element.children("ul").attr("data-dudaone-gallery-type"), u.removeClass("selected"), u.filter('[data-type\x3d"' + d + '"]').addClass("selected")) : o.is(".gallery2inArow") ? (u.removeClass("selected"), $("#gallery2inArow").addClass("selected")) : o.is(".gallery3inArow") ? (u.removeClass("selected"), $("#gallery3inArow").addClass("selected")) : o.is(".gallery4inArow") ? (u.removeClass("selected"), $("#gallery4inArow").addClass("selected")) : (u.removeClass("selected"), $("#gallery5inArow").addClass("selected"));
				u.off("click.changeLayout").on("click.changeLayout",
				function() {
					var a = $(this);
					u.removeClass("selected");
					a.addClass("selected");
					if (K) {
						var d = $.dmx.current.element;
						$.dmx.preview.wnd().$.dmrt.components.photogallery["default"].resetImageSizes(d, a)
					} else _changeEffectInGallery("thumbnailsPerRow", parseInt(a.attr("number")),
					function() {
						e([a.attr("id")], ["gallery2inArow", "gallery3inArow", "gallery4inArow", "gallery5inArow"], {
							callback: function() {
								k(!0)
							}
						})
					})
				});
				d = o.is(".photogalleryPaddingThumbnails");
				a.find("#effect3dOnOff").onOffBtn({
					initState: d,
					onFn: function() {
						e(["photogalleryPaddingThumbnails"])
					},
					offFn: function() {
						e(null, ["photogalleryPaddingThumbnails"])
					}
				});
				k();
				$("#galleryNumOfRowsSelect").change(function() {
					var a = $(this).find(":selected").text();
					l(a != dmStr["ui.nee.themePanel.11"] ? parseInt(a) : a)
				});
				d = $("#numberOfGalleryColumns");
				d.val(g);
				if (K) d.off("change.numOfColumns").on("change.numOfColumns", j);
				else d.hide()
			}
		})
	}
	function l(d, e, j, k, l, m) {
		a.find("#colorPickerWrapper").show();
		a.find(".shapeDesignWrapper").remove();
		$(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
		a.find("#textEditor").remove();
		a.find(".colorPickerWidget").neeColorPicker(d.css(l), j,
		function(a) {
			g(a, k, m)
		},
		function(a) {
			g(a, k, $.extend({
				clientOnly: !0
			},
			m))
		});
		$(".slideRightPanelInner #additionalWidgetPlaceholder").append($("\x3cdiv id\x3d'borderColorSettings'\x3e\x3chr/\x3e\x3cbr/\x3e" + dmStr["ui.nee.photoGallery.109"] + "\x3cinput id\x3d'borderSize' type\x3dtext' /\x3e\x3cdiv class\x3d'sliderBorderWrapper'\x3e\x3cdiv id\x3d'sliderBorder'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"));
		$("#sliderBorder").slider({
			range: "min",
			value: parseInt(d.css("border-bottom-width")),
			min: 0,
			max: 4,
			step: 1,
			slide: function(a, d) {
				$("#borderSize").val(d.value + "px");
				g($("#borderSize").val(), "border-width", $.extend({
					clientOnly: !0
				},
				m))
			},
			stop: function() {
				g($("#borderSize").val(), "border-width", m)
			}
		});
		$("#borderSize").val(d.css("border-bottom-width"));
		$("#borderSize").blur(function() {
			g($("#borderSize").val(), "border-width", m)
		});
		$("#borderSize").keypress(function(a) {
			13 == a.keyCode && g($("#borderSize").val(), "border-width", m)
		})
	}
	var m = $.dmx.current.element.find(".photogalleryheader"),
	n = $.dmx.current.element.find(".photoGalleryThumbs"),
	o = $.dmx.current.element.find(".gallery"),
	r = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.photoGallery.100"],
		onReady: function() {
			var d = [{
				name: dmStr["ui.nee.photoGallery.105"],
				callback: function() {
					k()
				}
			},
			{
				name: dmStr["ui.nee.photoGallery.106"],
				callback: function() {
					l(n.find("a"), "border", dmStr["ui.nee.photoGallery.111"], "border-color", "border-top-color", {
						selector: ".photoGalleryThumbs"
					})
				}
			},
			{
				name: dmStr["ui.nee.photoGallery.107"],
				callback: function() {
					a.find("#colorPickerWrapper").hide();
					a.find(".shapeDesignWrapper").remove();
					$(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
					jQuery.ajax({
						url: "/editor/nee/editableObjects/common/nee.buttonsHtmlBasicShape.jsp",
						async: !1,
						success: function(d) {
							a.find(".slideRightPanelInner:first").append($(d));
							a.find(".slideRightPanelInner:first").neeSecondaryShapeTab({
								element: o,
								useElement: o,
								isForChildren: !0
							})
						}
					})
				}
			}];
			$.dmfw.isDudaone() && d.pop();
			a.find(".slideRightPanelInner").neeThirdTabControl({
				callback: !0,
				tabs: d
			})
		}
	},
	{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.photoGallery.101"],
		onReady: function() {
			a.find(".slideRightPanelInner").neeThirdTabControl({
				callback: !0,
				tabs: [{
					name: dmStr["ui.nee.photoGallery.102"],
					callback: function() {
						var e = dmStr["ui.nee.photoGallery.112"];
						a.find(".shapeDesignWrapper").remove();
						$(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
						a.find("#colorPickerWrapper").show();
						a.find("#textEditor").remove();
						a.find(".colorPickerWidget").neeColorPicker(m.css("background-color"), e,
						function(a) {
							d(a, "background-color", {
								element: m
							})
						},
						function(a) {
							d(a, "background-color", {
								element: m,
								clientOnly: !0
							})
						})
					}
				},
				{
					name: dmStr["ui.nee.photoGallery.103"],
					callback: function() {
						a.find("#textEditor").remove();
						a.find("#colorPickerWrapper").hide();
						a.find(".shapeDesignWrapper").remove();
						$(".slideRightPanelInner #additionalWidgetPlaceholder").empty();
						jQuery.ajax({
							url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
							async: !1,
							success: function(d) {
								a.find(".slideRightPanelInner:first").append($(d));
								a.find(".slideRightPanelInner:first").neeSecondaryTextStyleTab({
									textSelector: ".photogalleryheader",
									element: m,
									sendElementNotSelector: !0
								})
							}
						})
					}
				},
				{
					name: dmStr["ui.nee.photoGallery.104"],
					callback: function() {
						l(m, "border", dmStr["ui.nee.photoGallery.110"], "border-bottom-color", "border-bottom-color", {
							element: m,
							onlyBottom: !0
						})
					}
				}]
			})
		}
	}];
	$(a).neeSecondaryTabsControl(r)
};_redrawSliderInFrame = function() {
	$.dmops.redrawSelection()
};NEEPhotoGallery.prototype.addImage = function(a) {
	var e = a.src;
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			var d = $.dmx.current.element.find("li"),
			g = d[d.length - 1],
			j = $("\x3cli \x3e \x3ca \x3e\x3cimg /\x3e\x3c/a\x3e \x3c/li\x3e");
			g ? j.insertAfter(g) : $.dmx.current.element.find(".gallery").append(j);
			j.find("img").attr("src", e);
			j.addClass("photoGalleryThumbs").find("a").attr("href", e).attr("dm_dont_rewrite_url", "true");
			g = j.find("img").dmImgNaturalSize();
			j.find("img").attr("irH", g.height).attr("irW", g.width);
			j.attr("index", $.dmx.current.element.find("li").length - 1);
			g = {
				containerId: j.closest(".gallery").dmid(),
				imageItemBeforeId: null,
				imageItemMarkup: j.outerHTML()
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/insertimageingallery",
				data: g,
				success: function(e) {
					j.attr("id", $(e.imageItemMarkup).attr("id")).attr("duda_id", $(e.imageItemMarkup).attr("id"));
					j.find("a").attr("id", $(e.imageItemMarkup).find("a").attr("id")).attr("duda_id", $(e.imageItemMarkup).find("a").attr("id"));
					j.find("img").attr("id", $(e.imageItemMarkup).find("img").attr("id")).attr("duda_id", $(e.imageItemMarkup).find("img").attr("id"));
					j.attr("index", d.length);
					$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder");
					_updateGalleryInIframe();
					null != a.onDone && (a.onDone(), $.dmfw.selectAndOpenEditor($.dmx.current.element))
				}
			})
		}
	})
};NEEPhotoGallery.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorPhotoGallerySelected"), this.disableEditInline(), this.element.find(".photoGalleryViewAll").unbind("click.redrawselection"))
};NEEPhotoGallery.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors())
};NEEPhotoGallery.prototype.getElementTagsSelectors = function() {
	return ".dmPhotoGallery, .dmPhotoGallery *, .photoGalleryThumbs, .photoGalleryThumbs *, .photoGalleryViewAll"
};NEEPhotoGallery.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEPhotoGallery.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmPhotoGallery")
};NEEPhotoGallery.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEPhotoGallery.prototype.disableEditInline = function() {};NEEPhotoGallery.prototype.docReady = function() {};NEEPhotoGallery.prototype.editorReady = function(a) {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEPhotoGallery.prototype.afterInsert = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	$.dmops.redrawSelection()
};NEEPhotoGallery.prototype.initOnDrop = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery()
};NEEPhotoGallery.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center",
			maxWidth: "180"
		};
		1 > $.dmx.current.element.find("ul.dmPhotoGalleryHolder li:not(.galleryContainer)").length ? $.dmfw.showPromptError($("div.smallTempPlaceHlderForImage"), dmStr["ui.nee.promptMassages.11"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	!0)
};NEEPhotoGallery.prototype.placeholderTest = function() {
	$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder")
};
function NEESocialGallery() {
	this.title = function() {
		return dmStr["ui.nee.fbGallery.1"].replace("^", "")
	};
	this.isExtension = !0;
	this.addClearWidget = this.isActive = !1;
	this.priority = 0.8;
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/social_gallery_white.png",
			editableDraggedText: dmStr["ui.nee.fbGallery.1"].replace("^", "")
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.fbGallery.1"].replace("^", ""),
		isEdit: $.dmfw.isPT() ? !0 : !1
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function(a, d) {
		return "image" == d && !_DragManager.dragFrameworkProps.isFromFramework ? {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}: $(a).is(".dmLinkList, .dmLinkList *") ? {
			insertBefore: $(a).is(".dmLinkList"),
			insertAfter: $(a).is(".dmLinkList"),
			insertInsideTop: !1,
			insertInsideBottom: !1
		}: {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/socialGallery/nee.fbAlbums.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				$.dmx.current.editable.onOpen = !0;
				var d = JSON.parse(Base64.decode($.dmx.current.element.attr("data-editor")));
				NEESocialGallery.prototype.handleTitle.widgetRuntimeTitle = $.dmx.current.element.find(".photogalleryheader").text();
				NEESocialGallery.prototype.handleTitle.displayTitle = d.displayTitle;
				NEESocialGallery.prototype.handleTitle.handleTitleinit(e);
				a.getAlbums();
				a.bindSearch()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.fbGallery.5"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				a.galleryOnReadyDesign(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").unbind("click").removeClass("breadcrumb-link"), $(".removeLinkButton").hide(), $(".cropButton").hide());
				$(a).neeSecondaryDesignTabs({
					showWidthHeight: !1,
					hideWidth: !0,
					hidePrec: !0,
					forceHeightScale: 400,
					afterChangesCallback: _updateGalleryInIframe,
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	};
	this.photoGalleryOnReadyGeneral = function() {};
	this.resetRowsToShow = function(a, d, g, j) {
		a = d.is(".gallery2inArow") ? 2 : d.is(".gallery3inArow") ? 3 : 4;
		g = Math.ceil((0 < j ? j: 1) / a);
		d = {};
		d[0] = dmStr["ui.nee.themePanel.11"];
		for (j = 0; j <= g; j++) 0 != j && (d[j] = j);
		selectedOption = eval("(" + $.dmx.current.element.attr("galleryOptionsParams") + ")").rowsToShow;
		j = $("#galleryNumOfRowsSelect");
		j.hasClass("dd-container") && $.dmfw.isDudaone() && (j.ddslick("destroy"), j = $("#galleryNumOfRowsSelect"));
		var k;
		k = j.prop ? j.prop("options") : j.attr("options");
		$("option", j).remove();
		$.each(d,
		function(a, d) {
			k[k.length] = new Option(d, a)
		});
		j.val(selectedOption);
		$.browser.msie && selectedOption > g && j.val(0);
		$.dmfw.isDudaone() && $.dmx.events.trigger("initDDSlickFBAlbumsRowToShow");
		return {
			numOfThumbsPerRow: a,
			maxRowsAval: g
		}
	};
	this.galleryOnReadyDesign = function(a) {
		function d(a, d, e) {
			$.dmops.updateCurrentCss({
				classesToRemove: d,
				attrToRemove: null,
				classesToAdd: a,
				attrToAdd: null
			},
			{
				element: g
			});
			e && e.callback && e.callback()
		}
		a = a || $(".rightPanel");
		$.dmx.current.element.find(".photogalleryheader");
		var g = $.dmx.current.element.find(".gallery");
		a.neeSecondaryDesignTabs({
			textSelector: "label",
			tabs: {
				social_gallery_design: [],
				color: ["background", "text", "border"]
			},
			element: g,
			useElement: g,
			isForChildren: !0,
			onReady: function() {
				function j() {
					var a = $.dmx.current.editable.resetRowsToShow(l, g, m, k);
					l = a.numOfThumbsPerRow;
					m = a.maxRowsAval
				}
				var k = 30,
				l = g.is(".gallery2inArow") ? 2 : g.is(".gallery3inArow") ? 3 : 4,
				m = Math.ceil((0 < k ? k: 1) / l),
				n = $(".galleryThumbShape");
				n.unbind("click").click(function() {
					_selfElem = $(this);
					n.removeClass("selected");
					_selfElem.addClass("selected");
					_changeEffectInGallery("thumbnailsPerRow", parseInt(_selfElem.attr("number")),
					function() {
						d([_selfElem.attr("id")], ["gallery2inArow", "gallery3inArow", "gallery4inArow"], {
							callback: function() {
								j();
								$.dmx.current.editable.updateExtension()
							}
						})
					})
				});
				g.is(".gallery2inArow") ? (n.removeClass("selected"), $("#gallery2inArow").addClass("selected")) : g.is(".gallery3inArow") ? (n.removeClass("selected"), $("#gallery3inArow").addClass("selected")) : (n.removeClass("selected"), $("#gallery4inArow").addClass("selected"));
				var o = g.is(".photogalleryPaddingThumbnails");
				a.find("#effect3dOnOff").onOffBtn({
					initState: o,
					onFn: function() {
						var a = $.dmx.current.editable;
						"fbGallery" === a.type ? (a.ext.defaults.hasmargin = !1, a.updateExtension()) : d(["photogalleryPaddingThumbnails"])
					},
					offFn: function() {
						var a = $.dmx.current.editable;
						"fbGallery" === a.type ? (a.ext.defaults.hasmargin = !0, a.updateExtension()) : d(null, ["photogalleryPaddingThumbnails"])
					}
				});
				$("#galleryNumOfRowsSelect").change(function() {
					var a = $(this).find(":selected").text(),
					a = a != dmStr["ui.nee.themePanel.11"] ? parseInt(a) : a,
					d = $.dmx.current.element.find("li");
					if (a != dmStr["ui.nee.themePanel.11"]) for (var e = l * a,
					g = 0; g < d.length; g++) g < e ? $(d[g]).css("display", "inline-block") : $(d[g]).css("display", "none");
					else for (g = 0; g < d.length; g++) $(d[g]).css("display", "inline-block");
					_changeEffectInGallery("rowsToShow", a != dmStr["ui.nee.themePanel.11"] ? a: m)
				});
				j();
				$(".formTitleEdit").on("click",
				function() {
					$(a).neeSecondaryDesignTabs({
						selector: ".photogalleryheader",
						afterTextButtonInit: function(a) {
							a.find("#dirLeft,#dirRight").hide()
						},
						tabs: {
							color: ["background", "text", "border"],
							text_style: []
						},
						forceClassName: ".photogalleryheader",
						useCurElem: !0
					});
					$.dmfw.setEditorBreadcrumb({
						parts: [{
							click: function() {
								$.dmx.current.editable.galleryOnReadyDesign();
								$.dmfw.setEditorBreadcrumb(null)
							}
						},
						{
							title: dmStr["ui.nee.menu.2"].replace("^", "")
						}]
					})
				})
			}
		})
	}
}
NEESocialGallery.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEESocialGallery.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEESocialGallery.prototype.selectInline = function() {
	null != this.element && ($(this.element).addClass("inlineEditorPhotoGallerySelected"), this.element.find(".photoGalleryViewAll").unbind("click.redrawselection").bind("click.redrawselection",
	function() {
		$.dmops.redrawSelection()
	}))
};NEESocialGallery.prototype.handleDropDifferent = function(a) {
	return a.editable() && "image" == a.editable().type ? !0 : !1
};NEESocialGallery.prototype.handleDropDifferentImpl = function(a) {
	$.dmx.current.editable.addImage(a)
};NEESocialGallery.prototype.generatePlaceHolder = function(a) {
	a && a.editable() && "image" == a.editable().type ? _DragManager.generatePlaceHolder({
		position: "absolute",
		"z-index": "99999",
		top: "25%",
		left: "25%",
		width: "150px",
		height: "50px",
		"line-height": "50px"
	},
	dmStr["ui.imageGallery.placeholder.addImage"]) : _DragManager.generatePlaceHolder()
};_changeEffectInGallery = function(a, e, d) {
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			var g = $.dmx.current.element,
			j = g.attr("galleryOptionsParams"),
			j = eval("(" + j + ")");
			j[a] = e;
			j = JSON.stringify(j);
			g.attr("galleryOptionsParams", j);
			j = j.replace(RegExp('"', "g"), "'");
			j = {
				attrToRemove: ["galleryOptionsParams"],
				attrToAdd: {
					galleryOptionsParams: j
				}
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/changeimagegalleryitem/" + g.dmid(),
				data: j,
				success: function() {
					_updateGalleryInIframe();
					d && d()
				}
			})
		}
	})
};_updateGalleryInIframeSync = function(a) { ! 1 == $.dmx.current.editable.isActive && ($.dmx.current.editable.isActive = !0, _updateGalleryInIframe(a,
	function() {
		$.dmx.current.editable.isActive = !1
	}), setTimeout(function() {
		$.dmx.current.editable.isActive = !1
	},
	400))
};_updateGalleryInIframe = function(a) {
	NEEMultiPhotoControl.getInstance().setCorrectIndexesFrame($.dmx.current.element);
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery(a);
	$.dmops.redrawSelection();
	$.dmfw.setPreviewEditPolicy(!0)
};_redrawSliderInFrame = function() {
	$.dmops.redrawSelection()
};NEESocialGallery.prototype.addImage = function(a) {
	var e = a.src;
	$.changePage({
		clientChange: function() {},
		serverChange: function() {
			var d = $.dmx.current.element.find("li"),
			g = d[d.length - 1],
			j = $("\x3cli \x3e \x3ca \x3e\x3cimg /\x3e\x3c/a\x3e \x3c/li\x3e");
			g ? j.insertAfter(g) : $.dmx.current.element.find(".gallery").append(j);
			j.find("img").attr("src", e);
			j.addClass("photoGalleryThumbs").find("a").attr("href", e).attr("dm_dont_rewrite_url", "true");
			g = j.find("img").dmImgNaturalSize();
			j.find("img").attr("irH", g.height).attr("irW", g.width);
			j.attr("index", $.dmx.current.element.find("li").length - 1);
			g = {
				containerId: j.closest(".gallery").dmid(),
				imageItemBeforeId: null,
				imageItemMarkup: j.outerHTML()
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/insertimageingallery",
				data: g,
				success: function(e) {
					j.attr("id", $(e.imageItemMarkup).attr("id")).attr("duda_id", $(e.imageItemMarkup).attr("id"));
					j.find("a").attr("id", $(e.imageItemMarkup).find("a").attr("id")).attr("duda_id", $(e.imageItemMarkup).find("a").attr("id"));
					j.find("img").attr("id", $(e.imageItemMarkup).find("img").attr("id")).attr("duda_id", $(e.imageItemMarkup).find("img").attr("id"));
					j.attr("index", d.length);
					$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder");
					_updateGalleryInIframe();
					null != a.onDone && (a.onDone(), $.dmfw.selectAndOpenEditor($.dmx.current.element))
				}
			})
		}
	})
};NEESocialGallery.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorPhotoGallerySelected"), this.disableEditInline(), this.element.find(".photoGalleryViewAll").unbind("click.redrawselection"))
};NEESocialGallery.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEESocialGallery.prototype.getElementTagsSelectors = function() {
	return ".dmFacebookGallery, .dmFacebookGallery *"
};NEESocialGallery.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEESocialGallery.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmFacebookGallery")
};NEESocialGallery.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEESocialGallery.prototype.disableEditInline = function() {};NEESocialGallery.prototype.docReady = function() {};NEESocialGallery.prototype.editorReady = function(a) {
	$.dmx.current.editable.placeholderTest();
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEESocialGallery.prototype.afterInsert = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery();
	$.dmops.redrawSelection()
};NEESocialGallery.prototype.initOnDrop = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.dmrt.components.photogallery.initPhotoGallery()
};NEESocialGallery.prototype.updateToggleTitle = function() {
	var a = $.dmx.current,
	e = {
		forceDisplay: !0
	};
	if (!0 == $.dmx.site.isFromScratch) {
		var d = $.dmx.current.element.find(".dmwidget-title");
		e.displayTitle = "none" == d.css("display") || 0 == d.length ? !0 : !1
	} else e.displayTitle = "true" == a.element.attr("displaytitle") ? !1 : !0;
	a.element.attr("forcedisplay", !0);
	a.element.attr("displaytitle", e.displayTitle);
	a.editable.updateExtension(!0, e)
};NEESocialGallery.prototype.genericUpdateTitle = function(a) {
	var e = $.dmx.current,
	d = {};
	$.dmx.current.element.find(".photogalleryheader").text(a);
	e.element.attr("title", a);
	e.element.attr("forcedisplay", !0);
	"" == a ? (d.displayTitle = !1, e.element.attr("displaytitle", !1)) : (d.displayTitle = !0, e.element.attr("displaytitle", !0));
	d.forceDisplay = !0;
	e.editable.updateExtension(!0, d)
};
function NEEFacebookGallery() {
	var a = new NEESocialGallery;
	a.PLATFORM = "fb";
	a.MAXNUMALBUMS = 30;
	a.DEFNUMALBUMS = 4;
	a.id = "";
	a.albumsList = [];
	a.albumsData = {};
	a.allAlbumTitles = [];
	a.showAll = !1;
	a.editorDesc = "Display your Facebook albums on this page.";
	a.type = "fbGallery";
	a.ext = {
		id: "dm_fb_gallery",
		preId: "dm_fb_gallery",
		firstTime: !0,
		defaults: {
			title: dmStr["ui.nee.fbGallery.1"].replace("^", ""),
			showall: !1,
			gallerytype: "gallery2inArow",
			thumbnailsperrow: 2,
			rowstoshow: 2,
			hasmargin: !0
		}
	};
	a.mindTouchId = "dmMtFacebookAlbums";
	a.showMindTouchHelp = !0;
	a.checkDataExists = function() {
		var e = $.parseJSON(Base64.decode($.dmx.current.element.attr("data-editor"))),
		d = $("#socialPageLinkInput"),
		d = 0 < d.length ? d.val() : "";
		a.albumsList = e.albumList;
		return e.account === d && "" !== e.account
	};
	a.GetAllTitles = function(e, d) {
		a.allAlbumTitles = [];
		for (var g = 0; g < d; g++) a.allAlbumTitles.push(e[g].caption)
	};
	a.getDataFromElem = function(e) {
		a.encodedVal = $.dmx.current.element.attr("data-editor");
		a.decodedVal = Base64.decode(a.encodedVal);
		return "albumCount" === e ? $.parseJSON(a.decodedVal).albumCount: $.parseJSON(a.decodedVal).account
	};
	a.getCurAlbumOrder = function() {
		var a = $("#socialAlbumsContainer").find("ul").eq(0).find(".albumsList"),
		d,
		g;
		$.dmfw.isDudaone() && (a = $("#socialAlbumsContainer").find("ul").eq(0).find("input.dd-selected-value"));
		d = a.length;
		g = [];
		for (var j = 0; j < d; j++) g.push($(a[j]).val());
		return g
	};
	a.checkExcessiveText = function(a, d) {
		var g, j = !1;
		g = a.indexOf("?");
		0 < g && (a = a.substr(0, g), j = !0);
		g = a.lastIndexOf("/"); - 1 < g && (a = a.substr(g + 1), j = !0);
		return d ? j: a
	};
	a.bindSearch = function() {
		function e(e) {
			var g = d.val();
			if ("" === g) $.dmfw.showPromptError($("#socialPageLinkInput"), dmStr["ui.nee.promptMassages.17"], {
				adjustY: 4,
				maxWidth: "180",
				at: "bottom center",
				my: "top center"
			});
			else if (a.checkExcessiveText(g, !0) && d.val(a.checkExcessiveText(g)), "click" === e.type || "keyup" === e.type && 13 === e.keyCode) a.showAll = !1,
			a.getAlbums(g)
		}
		var d = $("#socialPageLinkInput"),
		g = $("#socialPageDoSearch");
		$.dmfw.isDudaone() && g.addClass("dm-icon-search2");
		g.off("click").on("click", e);
		d.off("keyup").on("keyup", e)
	};
	a.getAlbums = function(e) {
		var d = 0 < a.getDataFromElem("albumCount"),
		g = $("#showAllAlbums").find("input[type\x3d'checkbox']"),
		j = $("#socialPageLinkInput");
		$.dmSetToolTip(g, dmStr["ui.nee.fbGallery.11"]);
		if (e && a.getDataFromElem() === e && d) $.dmfw.showPromptError($("#socialPageLinkInput"), dmStr["ui.nee.promptMassages.23"], {
			adjustY: 4,
			maxWidth: "180",
			at: "bottom center",
			my: "top center"
		});
		else {
			a.id = e ? e: a.getDataFromElem();
			if ("undefined" === typeof e) {
				if (!d) return;
				j.val(a.id)
			} else if ("my.business.page" === e) {
				$.dmfw.showPromptError($("#socialPageLinkInput"), dmStr["ui.nee.promptMassages.17"], {
					adjustY: 4,
					maxWidth: "180",
					at: "bottom center",
					my: "top center"
				});
				return
			}
			$.dmGet({
				url: "/sites/" + $.dmx.site.id + "/getonlinealbums?id\x3d" + a.checkExcessiveText(a.id) + "\x26limit\x3d" + a.MAXNUMALBUMS + "\x26platform\x3d" + a.PLATFORM,
				success: function(d) {
					if (1 > d.length && "undefined" != typeof e) return $.dmfw.showValidationError(j, dmStr["ui.nee.fbGallery.21"]);
					a.albumsData = d;
					a.populateAlbums(e);
					a.showAll = $.dmx.current.element.attr("showall");
					g.off("click.toggleShowAll").on("click.toggleShowAll", a.toggleShowAll);
					a.showAllAction();
					return "Got albums"
				},
				error: function(d) {
					$.dmfw.showPromptError(j, d.message, {
						adjustY: 4,
						maxWidth: "180",
						at: "bottom center",
						my: "top center"
					});
					a.id = a.getDataFromElem();
					return ! 0
				}
			})
		}
	};
	a.toggleShowAll = function() {
		a.showAll = !("true" === a.showAll || !0 === a.showAll);
		a.showAllAction()
	};
	a.showAllAction = function() {
		var e = $("#socialAlbumsContainer"),
		d = e.find("ul.ui-sortable"),
		g = e.find("div.footerOptions"),
		j = "true" === a.showAll || !0 === a.showAll;
		$(d).add(g).off("click.disabled").removeClass("disabled").addClass(j ? "disabled": "");
		d = $("#showAllAlbumsInput");
		j ? d.attr("checked", "checked") : d.removeAttr("checked");
		e.find(".disabled").off("click.disabled").on("click.disabled",
		function() {
			return "disabled"
		});
		a.updateExtension()
	};
	a.populateAlbums = function(e) {
		var d = a.albumsData.length,
		g = a.DEFNUMALBUMS,
		j = $.parseJSON(Base64.decode($.dmx.current.element.attr("data-editor"))),
		k = {},
		l = $("#socialAlbumsContainer"),
		m = !1,
		n = l.find("ul").eq(0),
		o = ($.dmfw.isDudaone() ? $(".fbGalleryFooterOptions") : $(".footerOptions")).find(".addItem");
		if (! (1 > d)) {
			d < a.DEFNUMALBUMS && (g = d);
			a.checkDataExists() && (k = a.updateDataEditor(a.albumsData, e), e = "undefined" === typeof k.account, m = k.account == j.account || e, e && (k.account = j.account, $("#socialPageLinkInput").val(j.account)), 0 < j.albumList.length && m && (g = j.albumList.length));
			a.GetAllTitles(a.albumsData, d);
			n.html("");
			for (e = 0; e < g; e++) a.addAlbum(e, a.albumsData, d, j.albumList, m),
			e + 1 === d - 1 && $("a.addItem").addClass("disabled"),
			1 === g && a.disableRemoveButton();
			a.makeSortable(n);
			n.off("click change").on("click", "a.removeAlbums", a.removeAlbum).on("change", "select.albumsList",
			function() {
				a.updateExtension()
			});
			o.off("click").on("click",
			function() {
				var e = l.find("select.albumsList").length + 1;
				if (d >= e) {
					a.addAlbum(e, a.albumsData, d, k.albumList);
					var g = l.find("ul.ui-sortable"),
					j = g.children("li").outerHeight() * e;
					g.animate({
						scrollTop: j + "px"
					},
					150);
					a.updateExtension();
					e === d && $(this).addClass("disabled")
				}
			});
			l.css("opacity", 1)
		}
	};
	a.addAlbum = function(e, d, g, j, k) {
		d = '\x3cselect class\x3d"albumsList"\x3e';
		var l = '\x3ca class\x3d"removeAlbums navLinkButtonBG ir"\x3eremove\x3c/a\x3e';
		$.dmfw.isDudaone() && (l = '\x3ca class\x3d"removeAlbums navLinkButtonBG ir dm-icon-trash2"\x3eremove\x3c/a\x3e');
		var m = $("div#socialAlbumsContainer").find("a.removeAlbums.disabled");
		m.removeClass("disabled");
		m.qtip("destroy");
		for (m = 0; m < g; m++) {
			var n = a.albumsData[m].id;
			d += '\x3coption value\x3d"' + n + '"' + (j && 0 < j.length && k ? n == j[e] ? "selected": "": m == e ? "selected": "") + "\x3e" + a.allAlbumTitles[m] + "\x3c/option\x3e"
		}
		e = $('\x3cli class\x3d"clearfix"\x3e' + (d + "\x3c/select\x3e") + l + "\x3c/li\x3e");
		e.appendTo($("#socialAlbumsContainer").find("ul").eq(0));
		$.dmfw.isDudaone() && $(e).find("select").styleSelectBox(a.updateExtension, {
			width: 260,
			isFirstTime: !0
		})
	};
	a.removeAlbum = function(e) {
		$("a.addItem").removeClass("disabled");
		e = $(e.target);
		var d = $(e).parents("ul").eq(0).children("li").length;
		1 < d && (e.removeClass("disabled"), e.parents("li").eq(0).remove(), 2 === d && a.disableRemoveButton(), a.updateExtension())
	};
	a.disableRemoveButton = function() {
		$("div#socialAlbumsContainer").find("a.removeAlbums").addClass("disabled").qtip({
			position: {
				at: "bottom center",
				my: "top center"
			},
			style: {
				classes: "ui-tooltip-light ui-tooltip-shadow dmtooltip",
				tip: "topCenter",
				def: !1
			},
			content: dmStr["ui.nee.fbGallery.8"]
		})
	};
	a.makeSortable = function(e) {
		e.sortable({
			stop: function() {
				a.updateExtension()
			}
		})
	};
	a.updateDataEditor = function(a, d) {
		for (var g = a.length,
		j = [], k = 0; k < g; k++) j.push(a[k].id);
		return {
			account: d,
			albumList: j
		}
	};
	a.updateExtension = function(e, d) {
		var g = $("#_p_editor").find(".slideBtn.slideBtnSelected").index();
		e || 1 < g ? a.checkDataExists() : a.albumsList = a.getCurAlbumOrder();
		var g = {},
		j = {},
		k = $.dmx.current.element,
		l = $.dmx.current.editable.ext.defaults;
		$.parseJSON(Base64.decode(k.attr("data-editor")));
		var m = k.attr("galleryoptionsparams"),
		n = m.indexOf("rowsToShow"),
		m = parseInt(m.slice(n + 10 + 2)[0]);
		g.account = a.id;
		g.albumList = a.albumsList;
		g.displayTitle = k.attr("displaytitle");
		"object" === typeof d && $.extend(g, d);
		j.showall = a.showAll;
		j["data-editor"] = Base64.encode(JSON.stringify(g));
		j.title = k.attr("title");
		j.forcedisplay = !0;
		j.rowstoshow = m;
		j.displaytitle = k.attr("displaytitle");
		j = $.extend({},
		l, j);
		$.changePage({
			clientChange: function() {
				k.attr("data-editor", j["data-editor"])
			},
			serverChange: function() {
				$.dmsrv.updateExtension(k, j, {
					successCallback: function() {
						$.dmops.redrawSelection();
						$.dmx.preview.wnd().jQuery.DM.updateAfterInit();
						a.editorReady();
						"true" == k.attr("displaytitle") ? ($("#generalWidgetTitleController div#toggleTitleBtn").removeClass("hideTitle"), $("#generalTitleInput").removeClass("hideTitle"), $("#designTitleBtn").removeClass("hideTitle")) : ($("#generalWidgetTitleController div#toggleTitleBtn").addClass("hideTitle"), $("#generalTitleInput").addClass("hideTitle"), $("#designTitleBtn").addClass("hideTitle"))
					}
				})
			}
		})
	};
	return a
}
NEESocialGallery.prototype.checkClose = function() {
	var a = JSON.parse(Base64.decode($.dmx.current.element.attr("data-editor"))),
	e = "" === a.account,
	d = "#socialPageLinkInput:visible",
	g = 0 === $(d).length;
	$.dmfw.changeTabTo(1,
	function() {
		var e = {
			adjustY: 4,
			maxWidth: "180",
			at: "bottom center",
			my: "top center"
		},
		g = $(d).val(),
		l = g === a.account,
		g = "" === g,
		m = "";
		g || !l && 0 < $(d).length ? (g ? m = "ui.nee.promptMassages.17": l || ($("#socialPageDoSearch").trigger("click"), d = ""), $.dmfw.showPromptError($(d), dmStr[m], e)) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	g && e, g && !e)
};NEESocialGallery.prototype.placeholderTest = function() {
	$.dmfw.preview.testAndSetPlaceholder("UL.gallery", "dmGalleryPlaceholder")
};
function NEETwitterFeed() {
	this.title = function() {
		return dmStr["ui.nee.twitter.1"]
	};
	this.isWidget = !0;
	this.widget = {
		id: "dudaTwitterId",
		preId: "dudaTwitterId",
		defaults: {
			username: dmStr["nee.youtubefeed.default"],
			numberOfTweets: 3,
			twitterType: "Profile",
			hideHeaderFooter: "false"
		}
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtTwitterFeed";
	this.addClearWidget = this.isActive = !1;
	this.priority = 0.9;
	this.type = "twitterFeed";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.twitter.1"],
		useCoverElement: !0
	};
	this.isValidUsernameProfile = this.isValidUsernameFaves = !0;
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/twitter.png",
			editableDraggedText: dmStr["ui.nee.widgets.30"]
		}
	};
	this.editorDesc = "Display your Twitter feed on this page.";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/twitterFeed/one.twitterFeed.jsp": "/editor/nee/editableObjects/twitterFeed/nee.twitterFeed.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.twitterFeedOnReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					showWidthHeight: !1,
					hideWidth: !0,
					hidePrec: !0,
					forceHeightScale: 400,
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEETwitterFeed.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEETwitterFeed.prototype._TabReadyDesignPT = function(a, e) {
	var d = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
		name: dmStr["ui.nee.mainTabs.14"],
		onReady: function() {
			a.neeSecondaryDesignTabs({
				tabs: {
					color: ["background", "text", "link", "border"]
				},
				specForceClassName: {
					background: 1 == e ? ".twtr-doc": ".twtr-tweet",
					text: 1 == e ? ".twtr-doc h3": ".twtr-tweet p",
					link: 1 == e ? ".twtr-hd a, .twtr-ft a": ".twtr-tweet a",
					border: 1 == e ? null: ".twtr-tweet"
				}
			})
		}
	}];
	$(a).neeSecondaryTabsControl(d)
};NEETwitterFeed.prototype._TabReadyDesign = function(a, e) {
	if ($.dmfw.isPT()) NEETwitterFeed.prototype._TabReadyDesignPT(a, e);
	else {
		var d, g;
		1 == e ? (d = ".twtr-doc", g = $.dmx.current.editable.element.find(".twtr-doc")) : (d = ".twtr-tweet", g = $($.dmx.current.editable.element.find(".twtr-tweet").get(0)));
		var j = function(a, d, e) {
			$.dmops.updateCurrentCss({
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: a,
					value: d
				}]
			},
			e)
		},
		k = function(a, d, e) {
			$.dmops.updateCurrentCss({
				classesToRemove: null,
				attrToRemove: null,
				classesToAdd: null,
				attrToAdd: [{
					attr: d,
					value: a
				},
				{
					attr: "border-style",
					value: "solid"
				}]
			},
			e)
		},
		l = [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			name: dmStr["ui.background"],
			onReady: function() {
				function e(a, g) {
					g ? j("background-image", "none", {
						selector: d
					}) : j("background-image", "url(" + a + ")", {
						selector: d
					})
				}
				var k = g.css("background-color");
				a.find(".colorPickerWidget").neeColorPicker(k, dmStr["ui.background"].toLowerCase(),
				function(a) {
					j("background-color", a, {
						selector: d
					})
				},
				function(a) {
					j("background-color", a, {
						selector: d,
						clientOnly: !0
					})
				});
				a.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: g,
					callbackremove: function() {
						e(null, !0)
					},
					callback: e
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			name: dmStr["ui.text"],
			onReady: function() {
				var d, k;
				1 == e ? (d = $(g.find("h3")), k = ".twtr-doc h3") : (d = $(g.find("p")), k = ".twtr-tweet p");
				d = d.css("color");
				a.find(".colorPickerWidget").neeColorPicker(d, dmStr["ui.text"].toLowerCase(),
				function(a) {
					j("color", a, {
						selector: k
					})
				},
				function(a) {
					j("color", a, {
						selector: k,
						clientOnly: !0
					})
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			name: dmStr["ui.nee.blog.8"],
			onReady: function() {
				var d, k;
				1 == e ? (d = $(g.find("a")), k = ".twtr-hd a, .twtr-ft a") : (d = $(g.find("p")), k = ".twtr-tweet a");
				d = d.css("color");
				a.find(".colorPickerWidget").neeColorPicker(d, dmStr["ui.text"].toLowerCase(),
				function(a) {
					j("color", a, {
						selector: k
					})
				},
				function(a) {
					j("color", a, {
						selector: k,
						clientOnly: !0
					})
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			name: dmStr["ui.border"],
			onReady: function() {
				var j, l;
				1 == e ? (j = $.dmx.current.editable.element, l = null) : (j = g, l = ".twtr-tweet");
				var o = j.css("border-bottom-color");
				a.find(".colorPickerWidget").neeColorPicker(o, dmStr["ui.border"].toLowerCase(),
				function(a) {
					k(a, "border-color", l ? {
						selector: d
					}: null)
				},
				function(a) {
					k(a, "border-color", l ? {
						selector: d,
						clientOnly: !0
					}: {
						clientOnly: !0
					})
				});
				$(".slideRightPanelInner #additionalWidgetPlaceholder").append($("\x3cdiv id\x3d'borderColorSettings'\x3e\x3chr/\x3e\x3cbr/\x3e" + dmStr["ui.nee.twitter.14"] + ": \x3cinput id\x3d'borderSize' type\x3dtext' /\x3e\x3cdiv class\x3d'sliderBorderWrapper'\x3e\x3cdiv id\x3d'sliderBorder'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"));
				$("#sliderBorder").slider({
					range: "min",
					value: parseInt(j.css("border-bottom-width")),
					min: 0,
					max: 6,
					step: 1,
					slide: function(a, e) {
						$("#borderSize").val(e.value + "px");
						k($("#borderSize").val(), "border-width", l ? {
							selector: d,
							clientOnly: !0
						}: {
							clientOnly: !0
						})
					},
					stop: function() {
						k($("#borderSize").val(), "border-width", l ? {
							selector: d
						}: null)
					}
				});
				$("#borderSize").val(j.css("border-bottom-width"));
				$("#borderSize").blur(function() {
					k($("#borderSize").val(), "border-width", l ? {
						selector: d
					}: null)
				});
				$("#borderSize").keypress(function(a) {
					13 == a.keyCode && k($("#borderSize").val(), "border-width", l ? {
						selector: d
					}: null)
				})
			}
		}];
		$(a).neeSecondaryTabsControl(l)
	}
};NEETwitterFeed.prototype.twitterFeedOnReadyGeneral = function(a) {
	var e = $.dmx.current.editable;
	e.isValidUsernameProfile = e.isValidUsernameProfile = !0;
	var d = $.dmx.current.element.find(".dmTwitterFeed"),
	g = d.attr("twitterType");
	a.find("#twitterTypeOptions").change(function() {
		g = $(this).find(":selected").val();
		_changeEffectInTwitter("twitterType", g);
		l(g)
	});
	NEETwitterFeed.prototype.handleTitle.widgetTitle.interenalSelector = "dmWidgetTitleText";
	0 == $.dmx.current.element.find("h3.dmwidget-title").length ? (NEETwitterFeed.prototype.handleTitle.widgetTitle.recreateTitleElement = !0, NEETwitterFeed.prototype.handleTitle.widgetTitle.oldElementPointer = d.find("div.TwitterTitleWrapper"), NEETwitterFeed.prototype.handleTitle.widgetTitle.recreateTitleTemplate = "/editor/nee/editableObjects/twitterFeed/nee.twitterFeedTitle.tmpl.htm", NEETwitterFeed.prototype.handleTitle.widgetRuntimeTitle = d.find("div.TwitterTitleWrapper").text().trim()) : (NEETwitterFeed.prototype.handleTitle.widgetRuntimeTitle = $.dmx.current.element.find(".dmWidgetTitleText").text().trim(), !1 == d.find("h3.dmwidget-title").attr("hide") && (NEETwitterFeed.prototype.handleTitle.displayTitle = !1));
	NEETwitterFeed.prototype.handleTitle.handleTitleinit(a);
	var j = d.attr("hideHeaderFooter");
	a.find("#twitterHideHeaderFooterOnOff").onOffBtn({
		initState: j,
		onFn: function() {
			_changeEffectInTwitter("hideHeaderFooter", !0)
		},
		offFn: function() {
			_changeEffectInTwitter("hideHeaderFooter", !1)
		}
	});
	var k = function(a, g) {
		var j, k = d.find(".dmTwitterFeed").attr("twitterUsername");
		a !== k && ($.dmLoading($("#_editor")), j = $("Profile" === g ? "#opDescription": "#opFavesUsername"), $.ajax({
			url: "/proxy?echoStatus\x3dtrue\x26url\x3d" + encodeURI("http://twitter.com/" + a),
			type: "get",
			contentType: "application/xml",
			success: function() {
				e["isValidUsername" + g] = !0;
				$.dmUnblockUI();
				_changeEffectInTwitter("twitterUsername", a)
			},
			error: function() {
				$.dmUnblockUI();
				$.dmfw.showPromptError(j, dmStr["ui.nee.promptMassages.21"], {
					at: "bottom center",
					my: "top center"
				});
				e["isValidUsername" + g] = !1
			}
		}))
	},
	l = function(a) {
		$.dmops.redrawSelection();
		$("#twitterTypeOptions").val(a);
		if ("Profile" == a) {
			$(".twitterByTYpeOptionsProfile").show();
			$(".twitterByTYpeOptionsSearch").hide();
			$(".twitterByTYpeOptionsFaves").hide();
			a = d.attr("twitterUsername");
			var e = $("#opDescription");
			e.val(a);
			e.blur(function() {
				var a = $("#opDescription").val().trim();
				"" !== a && k(a, "Profile")
			});
			e.keypress(function(a) {
				13 == a.keyCode && k($("#opDescription").val(), "Profile")
			});
			a = {};
			for (e = 1; 10 >= e; e++) 0 != e && (a[e] = e);
			var e = d.attr("numberOfTweets"),
			g = $("#numOfTweets"),
			j;
			j = g.prop ? g.prop("options") : g.attr("options");
			$("option", g).remove();
			$.each(a,
			function(a, d) {
				j[j.length] = new Option(d, a)
			});
			g.val(e);
			$("#numOfTweets").change(function() {
				var a = $(this).find(":selected").text();
				_changeEffectInTwitter("numberOfTweets", parseInt(a))
			})
		} else {
			$(".twitterByTYpeOptionsProfile").hide();
			$(".twitterByTYpeOptionsSearch").hide();
			$(".twitterByTYpeOptionsFaves").show();
			a = d.attr("twitterUsername");
			var l = $("#opFavesUsername");
			l.val(a);
			l.blur(function() {
				k(l.val(), "Faves")
			});
			l.keypress(function(a) {
				13 == a.keyCode && k(l.val(), "Faves")
			});
			a = d.attr("twitterTitle");
			var s = $("#opFavesTitle");
			s.val(a);
			s.blur(function() {
				_changeEffectInTwitter("twitterTitle", s.val())
			});
			s.keypress(function(a) {
				13 == a.keyCode && _changeEffectInTwitter("twitterTitle", s.val())
			});
			a = d.attr("twitterCaption");
			var B = $("#opFavesCaption");
			B.val(a);
			B.blur(function() {
				_changeEffectInTwitter("twitterCaption", B.val())
			});
			B.keypress(function(a) {
				13 == a.keyCode && _changeEffectInTwitter("twitterCaption", B.val())
			})
		}
		setTimeout(function() {
			$.dmops.redrawSelection()
		},
		0)
	};
	l(g, !1)
};
var _changeEffectInTwitter = function(a, e) {
	"" !== e && $.dmx.current.element.find(".dmTwitterFeed").attr(a) != e && $.changePage({
		clientChange: function() {},
		serverChange: function() {
			var d = $.dmx.current.element.find(".dmTwitterFeed");
			d.attr(a, e);
			var g = {};
			g[a] = e;
			g = {
				attrToRemove: [a],
				attrToAdd: g
			};
			$.dmPostWithHistory({
				url: "/pages/" + $.dmx.currentPage() + "/changeimagegalleryitem/" + d.dmid(),
				data: g,
				success: function() {
					NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTwitterFeed({
						callback: function() {
							setTimeout(function() {
								$.dmops.redrawSelection()
							},
							1500)
						}
					})
				}
			})
		}
	})
};NEETwitterFeed.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEETwitterFeed.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorTwitterFeedSelected")
};NEETwitterFeed.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorTwitterFeedSelected"), this.disableEditInline())
};NEETwitterFeed.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEETwitterFeed.prototype.getElementTagsSelectors = function() {
	return ".dmTwitterFeed, .dmTwitterFeed *, .dmTwitterFeedWrapper *, .dmTwitterFeedWrapper"
};NEETwitterFeed.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEETwitterFeed.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmTwitterFeedWrapper")
};NEETwitterFeed.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEETwitterFeed.prototype.disableEditInline = function() {};NEETwitterFeed.prototype.docReady = function() {};NEETwitterFeed.prototype.editorReady = function(a) {
	this.isAfterInsert && NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTwitterFeed({
		callback: function() {
			setTimeout(function() {
				$.dmops.redrawSelection()
			},
			1300)
		}
	});
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	});
	this.isAfterInsert = !1;
	$.dmops.redrawSelection()
};NEETwitterFeed.prototype.afterInsert = function(a) {
	this.isAfterInsert = !0;
	a.html(a.html());
	$.dmops.redrawSelection();
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTwitterFeed({
		callback: function() {
			setTimeout(function() {
				$.dmops.redrawSelection()
			},
			1300)
		}
	})
};NEETwitterFeed.prototype.checkClose = function() {
	var a = 0 === $("#generalTitleInput:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		if ($.dmx.current.element) {
			var a = $.dmx.current.element.find(".dmTwitterFeed").attr("twitterType"),
			d = {
				at: "bottom center",
				my: "top center"
			},
			g = "",
			j = $.dmx.current.element.find("div.dmTwitterFeed").attr("twitterusername"),
			k = "ui.nee.promptMassages.13",
			g = "Faves" === a ? "#opFavesUsername": "#opDescription",
			j = "" === $(g).val() || "dudamobile" === j || "" === j || !$.dmx.current.editable["isValidUsername" + a];
			"" === $(g).val() ? k = "ui.nee.promptMassages.17": $.dmx.current.editable["isValidUsername" + a] || (k = "ui.nee.promptMassages.21");
			j ? $.dmfw.showPromptError($(g), dmStr[k], d) : $.dmfw._closeEditorAll({
				override: !0
			})
		}
	},
	a)
};NEETwitterFeed.prototype.onEditorClose = function() {
	$.dmx.current.editable.isValidUsernameProfile = !0;
	$.dmx.current.editable.isValidUsernameFaves = !0
};NEETwitterFeed.prototype.initOnDrop = function() {
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initTwitterFeed({
		callback: function() {
			$.dmops.redrawSelection()
		}
	})
};
function NEERSSFeed() {
	var a = this;
	this.title = function() {
		var a = dmStr["ui.nee.rssfeed.2"];
		this._isWordPress() && (a = dmStr["ui.nee.wpfeed.5"]);
		return a
	};
	this.isExtension = !0;
	this.ext = {
		id: "rssfeed",
		preId: "rssfeed",
		defaults: {
			showtitle: !0,
			visibleitems: 3,
			showcontent: !0,
			showdividers: !0,
			showarrows: !1,
			showcontentinsteaddesc: !1,
			readmore: dmStr["ui.nee.rssfeed.1"],
			closetext: dmStr["ui.close"],
			src: dmStr["nee.rssfeed.default"]
		}
	};
	this.mindTouchId = "dmMtRssFeed";
	this.showMindTouchHelp = !0;
	this.addClearWidget = this.isActive = !1;
	this.priority = 0.8;
	this.type = "rssFeed";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		isDelete: !1,
		title: dmStr["ui.nee.rssfeed.2"]
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.dragImageParams = function() {
		var e = a._isWordPress() ? "wordpress.png": "rss.png",
		d = a._isWordPress() ? dmStr["ui.nee.wpfeed.5"] : dmStr["ui.nee.widgets.31"];
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/" + e,
			editableDraggedText: d
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/rssFeed/nee.rssFeed.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: a.rssFeedOnReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				var d = {
					hideShadowControl: !1,
					textSelector: "span.dmListItemDescriptionDiv",
					bgSelector: "ul.dmLinkList",
					titleTextSelector: "a.dmTitleDiv span.dmListItemTitle",
					linkTextSelector: "ul.dmLinkList li.dmListItem span.rssListReadMore",
					tabs: {
						color: ["background", "border"],
						shape: [],
						combined_style: []
					}
				},
				g = {
					hideShadowControl: !1,
					textSelector: "div.dmPostDescriptionDiv",
					bgSelector: "",
					titleTextSelector: "div.dmPostTitle",
					textMinSize: 8,
					textMaxSize: 16,
					tabs: {
						color: ["background"],
						combined_style: []
					},
					limitTextRows: 2,
					lineHeight: 1.2
				},
				d = a._isWordPress() ? g: d;
				$(e).neeSecondaryDesignTabs(d)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !1
				})
			}
		}]
	};
	$.dmx.events.bind("dragFinish.rssFeed",
	function() {
		$.dmfw.getPreviewElement(".wpRssContainer img.dmPostImage").each(function(a, d) {
			"undefined" != typeof $.dmx.preview.wnd().cropImage(d) && $.dmx.preview.wnd().cropImage(d)
		})
	},
	!0)
}
var _changeRSSExtension = function(a, e) {
	var d = {
		showtitle: "true" == a.attr("showtitle"),
		visibleitems: a.attr("visibleitems"),
		showarrows: "true" == a.attr("showarrows"),
		showdividers: "true" == a.attr("showdividers"),
		showcontent: "true" == a.attr("showcontent"),
		showcontentinsteaddesc: "true" == a.attr("showcontentinsteaddesc"),
		readmore: a.attr("readmore") || "",
		closetext: a.attr("closetext") || "",
		src: a.attr("src"),
		listtype: a.attr("listtype"),
		showposttitle: a.attr("showposttitle"),
		postsmargin: a.attr("postsmargin"),
		numBoxLines: a.attr("numBoxLines"),
		numListLines: a.attr("numListLines"),
		title: a.attr("title")
	};
	extContext = $.extend({},
	d, e || {});
	e.hasOwnProperty("src") || e.hasOwnProperty("visibleitems") || e.hasOwnProperty("title") ? $.changePage({
		clientChange: function() {
			e.hasOwnProperty("src") && $.dmLoading($(".rightPanelLoaded"))
		},
		serverChange: function() {
			$.dmsrv.updateExtension(a, extContext, {
				successCallback: function() {
					$.dmx.preview.wnd().$.DM.initRSS();
					$.dmUnblockUI()
				}
			})
		}
	}) : (e.hasOwnProperty("listtype") ? a.removeClass("dmRssMatrix dmRssBox dmRssLine").addClass({
		list: "dmRssLine",
		box: "dmRssBox",
		matrix: "dmRssMatrix"
	} [e.listtype]) : (a.toggleClass("listItemNoTitle", !extContext.showtitle), a.toggleClass("listItemNoArrows", !extContext.showarrows), a.toggleClass("listItemNoDivider", !extContext.showdividers), a.toggleClass("listItemNoContent", !extContext.showcontent)), $.dmops.updateCurrentAttributes({
		attrToAdd: e
	}))
},
_validateRSSFeed = function(a, e) {
	var d = function(a) {
		a ? e() : ($.dmfw.showValidationError(".editContentItemInput input", dmStr["ui.nee.rssfeed.3"]), $.dmUnblockUI())
	};
	a && (d = {
		data: a,
		url: "/utils/checkrssfeed",
		success: d
	},
	$.dmLoading($(".rightPanelLoaded")), $.dmPost(d))
};NEERSSFeed.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEERSSFeed.prototype.rssFeedOnReadyGeneral = function() {
	function a(a) {
		n.each(function(d, e) {
			var g = $(e); - 1 < g.attr("showOn").indexOf(a) ? g.show() : g.hide()
		})
	}
	function e(a, d, e, g) {
		var j = "auto";
		"auto" != e && (j = parseInt(l.find(d).eq(0).css("line-height")), isNaN(j) && (j = 1.2 * parseInt(l.find(d).eq(0).css("font-size"))), j = e * j + "px");
		cssContext = {
			classesToRemove: null,
			attrToRemove: [],
			classesToAdd: null,
			attrToAdd: [{
				attr: "height",
				value: j
			}]
		};
		$.dmops.updateCurrentCss(cssContext, {
			selector: "*" + d,
			classes: a
		});
		a = {};
		a[g] = e;
		_changeRSSExtension($.dmx.current.element, a)
	}
	function d(a) {
		$.dmops.updateCurrentCss({
			classesToRemove: null,
			attrToRemove: [],
			classesToAdd: null,
			attrToAdd: [{
				attr: "margin-bottom",
				value: a
			}]
		},
		{
			selector: "*.dmRssItem",
			classes: ".dmRssLine",
			success: k
		})
	}
	function g(a, d, e, g) {
		$.dmops.updateCurrentCss({
			classesToRemove: null,
			attrToRemove: [],
			classesToAdd: null,
			attrToAdd: [{
				attr: "margin-top",
				value: a
			},
			{
				attr: "margin-right",
				value: a
			},
			{
				attr: "margin-left",
				value: a
			},
			{
				attr: "margin-bottom",
				value: d
			},
			{
				attr: "height",
				value: e
			},
			{
				attr: "width",
				value: g
			}]
		},
		{
			selector: "*.dmRssItem",
			classes: ".dmRssMatrix",
			success: k
		})
	}
	function j(a) {
		if ("matrix" == a) {
			var d = s.css("margin-bottom"),
			e = $("div#matrixPostsMargin");
			r.val(d);
			e.slider({
				value: parseInt(d)
			})
		}
		"list" == a && (a = s.css("margin-bottom"), d = $("div#listPostsMargin"), u.val(a), d.slider({
			value: parseInt(a)
		}))
	}
	function k() {
		s.each(function(a, d) {
			$(d).attr("style", "")
		})
	}
	var l = $.dmx.current.element;
	$(".editContentItemInput input").val(l.attr("src"));
	$(".editContentItemInput .blueBtn.slimBlueBtn").unbind("click").click(function() {
		var a = $(".editContentItemInput input").val();
		a && _validateRSSFeed(a,
		function() {
			_changeRSSExtension(l, {
				src: a
			})
		})
	});
	NEERSSFeed.prototype.handleTitle.widgetRuntimeTitle = l.attr("title") ? l.attr("title") : $.dmx.current.element.find(".listItemTitle").text();
	NEERSSFeed.prototype.handleTitle.handleTitleinit(l);
	var m = !1;
	0 < $.dmfw.getPreviewElement(".innerBar").length && $.dmx.current.element.hasClass("dmPageWidget") && ($(".showFeedTitleRow").hide(), m = !0);
	$("#showFeedTitle").onOffBtn({
		initState: !l.hasClass("listItemNoTitle") && !m,
		onFn: function() {
			_changeRSSExtension(l, {
				showtitle: !0
			})
		},
		offFn: function() {
			_changeRSSExtension(l, {
				showtitle: !1
			})
		}
	});
	$("#showPostTitle").onOffBtn({
		initState: "true" == l.attr("showposttitle"),
		onFn: function() {
			_changeRSSExtension(l, {
				showposttitle: !0
			})
		},
		offFn: function() {
			_changeRSSExtension(l, {
				showposttitle: !1
			})
		}
	});
	$("#showItemContent").onOffBtn({
		initState: !l.hasClass("listItemNoContent"),
		onFn: function() {
			_changeRSSExtension(l, {
				showcontent: !0
			})
		},
		offFn: function() {
			_changeRSSExtension(l, {
				showcontent: !1
			})
		}
	});
	$("#showDivider").onOffBtn({
		initState: !l.hasClass("listItemNoDivider"),
		onFn: function() {
			_changeRSSExtension(l, {
				showdividers: !0
			})
		},
		offFn: function() {
			_changeRSSExtension(l, {
				showdividers: !1
			})
		}
	});
	$("#showArrows").onOffBtn({
		initState: !l.hasClass("listItemNoArrows"),
		onFn: function() {
			_changeRSSExtension(l, {
				showarrows: !0
			})
		},
		offFn: function() {
			_changeRSSExtension(l, {
				showarrows: !1
			})
		}
	});
	$(".editContentItem.numberItem select").find("[value\x3d'" + l.attr("visibleitems") + "']").attr("selected", "selected");
	$(".editContentItem.numberItem select").change(function() {
		var a = 1 * $(this).find("option:selected").attr("value");
		_changeRSSExtension(l, {
			visibleitems: a
		})
	});
	var n = $("div.dmRssSettings").find("[showOn]"),
	m = l.attr("listtype"),
	o = $("div#rssLayoutStyles"),
	r = $("input#postsPaddingInput"),
	u = $("input#listmarginInput"),
	s = $.dmx.current.element.find("div.dmRssItem"),
	B = l.find("img.dmPostImage");
	o.find('[type\x3d"' + m + '"]').addClass("selected");
	$(".editContentItem.numberBoxRows select").find("[value\x3d'" + l.attr("numBoxRows") + "']").attr("selected", "selected");
	$(".editContentItem.numberListRows select").find("[value\x3d'" + l.attr("numListRows") + "']").attr("selected", "selected");
	a(m);
	o.on("click", "a.rssLayoutStyle",
	function(d) {
		o.find(".selected").removeClass("selected");
		d = $(d.currentTarget);
		var e = d.attr("type");
		d.addClass("selected");
		a(e);
		applyRssShape(e);
		j(e);
		B.each(function(a, d) {
			"undefined" != typeof $.dmx.preview.wnd().cropImage(d) && $.dmx.preview.wnd().cropImage(d)
		})
	});
	$(".editContentItem.numberBoxRows").add(".editContentItem.numberListRows").find("select").change(function() {
		var a = l.attr("listtype"),
		d = $(this).val();
		"box" == a ? e(".dmRssBox", ".dmPostDescriptionDiv", d, "numBoxRows") : "list" == a && e(".dmRssLine", ".dmPostDescriptionDiv", d, "numListRows")
	});
	$("div#listPostsMargin").slider({
		range: "min",
		min: 10,
		max: 50,
		create: function() {
			j("list")
		},
		slide: function(a, d) {
			u.val(d.value + "px");
			s.css("cssText", "margin-bottom:" + d.value + "px !important;")
		},
		stop: function(a, e) {
			d(e.value + "px")
		}
	});
	u.on("change",
	function() {
		var a = parseInt($(this).val());
		d(a + "px");
		j("list")
	});
	$("div#matrixPostsMargin").slider({
		range: "min",
		min: 0,
		max: 25,
		create: function() {
			j("matrix")
		},
		slide: function(a, d) {
			r.val(d.value + "px");
			s.css("cssText", "margin-top:" + d.value + "px !important;margin-right:" + d.value + "px !important;margin-left:" + d.value + "px !important;margin-bottom:" + (parseInt(d.value) + 5) + "px !important;width:" + (135 - 2 * d.value) + "px !important;height:" + (125 - 2 * d.value) + "px !important;")
		},
		stop: function(a, d) {
			g(d.value + "px", d.value + 5 + "px", 125 - 2 * d.value + "px", 135 - 2 * d.value + "px")
		}
	});
	r.on("change",
	function() {
		var a = parseInt($(this).val());
		g(a + "px", 135 - 2 * a + "px", 125 - 2 * a + "px");
		j("matrix")
	})
};NEERSSFeed.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEERSSFeed.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorTwitterFeedSelected")
};NEERSSFeed.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorTwitterFeedSelected"), this.disableEditInline())
};NEERSSFeed.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors())
};NEERSSFeed.prototype._isWordPress = function(a) {
	a = a || $.dmx.current.element;
	return a.is(".dmRssContainer, .dmRssItem *")
};NEERSSFeed.prototype.getElementTagsSelectors = function() {
	return ".dmRSSFeed, .dmRSSFeed *, .wpRssContainer, .wpRssContainer *"
};NEERSSFeed.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEERSSFeed.prototype.getCorrectElement = function(a) {
	var e = $(a).closest(".dmRSSFeed");
	this._isWordPress($(a)) && (e = $(a).closest(".wpRssContainer"));
	return e
};NEERSSFeed.prototype.editInline = function(a, e) {
	this.inlineEditorProperties.isDelete = !0;
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this._isWordPress() && (d.dynamicTitle = $("\x3cdiv\x3e" + dmStr["ui.nee.wpfeed.5"] + "\x3c/div\x3e"), this.inlineEditorProperties.deleteTitle = dmStr["ui.remove"], this.inlineEditorProperties.tooltips = {
		"delete": dmStr["ui.messages.removeWP"]
	},
	d.isCopy = !1);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEERSSFeed.prototype.disableEditInline = function() {};NEERSSFeed.prototype.docReady = function() {};NEERSSFeed.prototype.editorReady = function(a) {
	var e = $.extend(!0, {},
	this.buttonTabInfo);
	this._isWordPress() && (e.type[0].url = "/editor/nee/editableObjects/rssFeed/nee.wpFeed.jsp");
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: e
	});
	$.dmops.redrawSelection()
};NEERSSFeed.prototype.afterInsert = function(a) {
	this.isAfterInsert = !0;
	a.html(a.html());
	$.dmops.redrawSelection()
};NEERSSFeed.prototype.onDelete = function() {
	var a = dmStr["ui.messages.deleteWP"];
	if (this._isWordPress()) $("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(a, {
		initCallback: function() {
			var a = "/pages/" + $.dmx.page.id + "/restoreWordPressPage";
			$.dmBlockUI();
			$.dmsrv.postToServ(function() {
				$.dmPostWithHistory({
					url: a,
					success: function() {
						$.dmfw.refreshPreview(null);
						$.dmops.updateEditContext.all({
							success: function() {}
						})
					}
				})
			})
		},
		onNoCallback: function() {},
		triggerNow: !0,
		noText: dmStr["ui.no"].toUpperCase(),
		yesText: dmStr["ui.yes"].toUpperCase(),
		bindCloseToNo: !0,
		forceWidth: "420px"
	});
	else return ! 0
};applyRssShape = function(a) {
	a != getActualRssShape($.dmx.current.element) && _changeRSSExtension($.dmx.current.element, {
		listtype: a
	})
};getActualRssShape = function(a) {
	return a && (a = $.dmx.current.element.attr("listtype")) ? -1 != a.indexOf("list") ? "list": -1 != a.indexOf("box") ? "box": -1 != a.indexOf("matrix") ? "matrix": "list": ""
};NEERSSFeed.prototype.initOnDrop = function() {};NEERSSFeed.prototype.updateToggleTitle = function() {
	var a = $.dmx.current.element,
	e = !0,
	e = "false" == a.attr("showtitle") ? !0 : !1; ! 0 == $.dmx.site.isFromScratch && (e = $.dmx.current.element.find(".dmwidget-title"), e = "none" == e.css("display") || 0 == e.length ? !0 : !1);
	_changeRSSExtension(a, {
		showtitle: e
	})
};NEERSSFeed.prototype.genericUpdateTitle = function(a) {
	var e = $.dmx.current.element;
	_changeRSSExtension(e, {
		title: a,
		showtitle: "" == a ? !1 : !0
	})
};NEERSSFeed.prototype.checkClose = function(a) {
	var e = 0,
	d, g;
	if ( - 1 < $.dmx.current.element.attr("src").indexOf("feeds.feedburner.com/dudamobile")) {
		if (a) return $.dmops.deleteElement($.dmx.current.element),
		!0;
		$.dmfw.changeTabTo(1);
		d = setInterval(function() {
			e++;
			50 < e && clearInterval(d);
			g = $("#_p_editor").find(".editContentItemInput input");
			0 < g.length && (clearInterval(d), $.dmfw.showPromptError(g, dmStr["ui.nee.promptMassages.12"]))
		},
		10);
		return ! 1
	}
	return ! 0
};NEERSSFeed.prototype.checkClose = function() {
	var a = 0 === $("#generalTitleInput:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center"
		},
		d = "",
		g = ".editContentItemInput input",
		j = $.dmx.current.element,
		k = !1;
		1 > $(g).length ? (k = !0, d = "ui.nee.promptMassages.16") : "" === $(g).val() ? (k = !0, d = "ui.nee.promptMassages.17") : $(g).val() !== j.attr("src") ? (k = !0, $(".editContentItemInput").find("div.blueBtn.slimBlueBtn").trigger("click"), g = "") : -1 < j.attr("src").indexOf("feeds.feedburner.com/dudamobile") && (k = !0, d = "ui.nee.promptMassages.16");
		k ? $.dmfw.showPromptError($(g), dmStr[d], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	a)
};
function NEEYouTubeFeed() {
	this.title = function() {
		return dmStr["ui.nee.youtubefeed.19"]
	};
	this.isExtension = !0;
	this.ext = {
		id: "youtubefeed",
		preId: "youtubefeed",
		defaults: {
			feedtype: "channel",
			searchterm: dmStr["nee.youtubefeed.default"],
			playlistname: "",
			playlisttitle: "",
			items: 3,
			showheader: !0,
			orderby: "relevance"
		}
	};
	this.addClearWidget = this.isActive = !1;
	this.priority = 0.9;
	this.type = "youtubeFeed";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.youtubefeed.19"]
	};
	this.mindTouchId = "dmMtYouTubeChannel";
	this.showMindTouchHelp = !0;
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/youtube2.png",
			editableDraggedText: dmStr["ui.nee.widgets.36"]
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/youtubeFeed/nee.youtubeFeed.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.youtubeFeedOnReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					hideShadowControl: !1,
					textSelector: "span.dmListItemDescriptionDiv span",
					titleTextSelector: "span.dmTitleDiv span.dmListItemTitle",
					tabs: {
						tab_colors: ["background", "border"],
						tab_effects: ["eff_shadow", "eff_rounded_corners"],
						tab_combined_style: []
					}
				}) : $(a).neeSecondaryDesignTabs({
					hideShadowControl: !1,
					textSelector: "span.dmListItemDescriptionDiv span",
					titleTextSelector: "span.dmTitleDiv span.dmListItemTitle",
					tabs: {
						color: ["background", "border"],
						shape: [],
						combined_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !1
				})
			}
		}]
	}
}
var _changeYouTubeExtension = function(a, e) {
	var d = $(".editContentItem.orderBy select").find("option:selected").attr("value"),
	d = {
		feedtype: a.attr("feedtype"),
		searchterm: a.attr("searchterm"),
		title: a.attr("title"),
		playlistname: a.attr("playlistname"),
		playlisttitle: a.attr("playlisttitle"),
		items: a.attr("items"),
		showheader: "true" == a.attr("showheader"),
		orderby: d || a.attr("orderby")
	};
	extContext = $.extend({},
	d, e || {});
	$.changePage({
		clientChange: function() {
			$.dmLoading($(".rightPanelLoaded"))
		},
		serverChange: function() {
			$.dmsrv.updateExtension(a, extContext, {
				successCallback: function() {
					$.dmUnblockUI()
				}
			})
		}
	})
},
showValidErrorYouTube = function(a, e) {
	$.dmfw.showQTip({
		type: "error",
		selector: a,
		text: e,
		position: {
			at: "bottom center",
			my: "top center"
		},
		dontHide: !1,
		hide: {
			event: "click unfocus",
			fixed: !0,
			effect: function() {
				$(this).fadeOut("slow")
			}
		}
	})
},
_validateYouTubeFeed = function(a, e, d) {
	var g = function(a) {
		a ? d() : ($.dmfw.showPromptError($(".editContentItemInput input"), dmStr["ui.nee.youtubefeed.20"], {
			adjustY: 4,
			at: "bottom center",
			my: "top center",
			maxWidth: "150"
		}), $.dmUnblockUI())
	};
	if (a && e) {
		var j = "";
		"channel" == e && (j = "https://gdata.youtube.com/feeds/api/users/" + encodeURI(a) + "/uploads?v\x3d2");
		"favorites" == e && (j = "http://gdata.youtube.com/feeds/api/users/" + encodeURI(a) + "/favorites?v\x3d2");
		"search" == e && (j = "https://gdata.youtube.com/feeds/api/videos?q\x3d" + encodeURI(a) + "\x26v\x3d2");
		"playlist" == e && (j = "https://gdata.youtube.com/feeds/api/users/" + encodeURI(a) + "/uploads?v\x3d2");
		a = {
			data: j,
			url: "/utils/checkrssfeed",
			success: g
		};
		$.dmLoading($(".rightPanelLoaded"));
		$.dmPost(a)
	}
},
togglePlaylistMode = function(a) {
	$(".ytPlaylist").toggle(a);
	$("option.playlist").toggle(a).toggleClass("dmHidden", !a);
	$("option.notPlaylist").toggle(!a).toggleClass("dmHidden", a);
	if ($(".orderBy select").find("option:selected").is(".dmHidden") || 0 == $(".orderBy select").find("option:selected").size()) $(".orderBy select").find("option:selected").removeAttr("selected"),
	$(".orderBy select").find("option:not(.dmHidden):first").attr("selected", "selected")
},
_ytFeedTypeWasSelected = function(a) {
	var e = "",
	d = "";
	togglePlaylistMode(!1);
	$(".needValid select").removeAttr("disabled");
	"channel" == a ? e = dmStr["ui.nee.youtubefeed.21"] : "favorites" == a ? e = dmStr["ui.nee.youtubefeed.22"] : "search" == a ? e = dmStr["ui.nee.youtubefeed.23"] : "playlist" == a && (e = dmStr["ui.nee.youtubefeed.22"]);
	d = dmStr["ui.nee.youtubefeed.24"] + " " + e.toLowerCase();
	$(".searchTermInput span").text(e);
	"YJP" !== $.dmx.site.dmProductType && $(".searchTermInput input").attr("placeholder", d)
};NEEYouTubeFeed.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEYouTubeFeed.prototype.youtubeFeedOnReadyGeneral = function() {
	var a = $.dmx.current.element,
	e, d = $(".editContentItemInput.searchTermInput input"),
	g = $(".editContentItem.orderBy select"),
	j = a.attr("searchterm");
	$(".ytPlaylist").hide();
	e = a.attr("feedtype");
	$(".editContentItem.feedType select").find("[value\x3d'" + e + "']").attr("selected", "selected");
	$(".editContentItem.feedType select").change(function() {
		var a = $(this).find("option:selected").attr("value");
		_ytFeedTypeWasSelected(a);
		d.focus();
		d.blur()
	});
	_ytFeedTypeWasSelected(e);
	NEEYouTubeFeed.prototype.handleTitle.displayTitle = "false" == a.attr("showheader") ? !1 : !0;
	NEEYouTubeFeed.prototype.handleTitle.widgetRuntimeTitle = a.attr("title");
	NEEYouTubeFeed.prototype.handleTitle.handleTitleinit(a);
	var k = function(d, e) {
		"playlist" == a.attr("feedtype") && $(".ytPlaylist").show();
		var g = $(".ytPlaylist.playlistName select");
		g.removeAttr("disabled").empty().append('\x3coption value\x3d""\x3e' + dmStr["ui.nee.youtubefeed.25"] + "\x3c/option\x3e");
		$(".needValid select").removeAttr("disabled");
		$.dmLoading($(".rightPanelLoaded"));
		var j = function() {
			togglePlaylistMode(!1);
			$(".ytPlaylist").show();
			g.empty().append('\x3coption value\x3d""\x3e' + dmStr["ui.nee.youtubefeed.25"] + "\x3c/option\x3e").attr("disabled", "disabled");
			$(".needValid select").attr("disabled", "disabled");
			$.dmUnblockUI()
		};
		$.ajax({
			url: "/proxy?url\x3d" + encodeURI("https://gdata.youtube.com/feeds/api/users/" + d + "/playlists?v\x3d2\x26alt\x3djson"),
			type: "get",
			contentType: "application/json",
			success: function(a) {
				$(".ytPlaylist.playlistName select").empty();
				if (a && (a.feed && a.feed.entry) && (a = a.feed.entry, 0 < a.length)) {
					for (var d = 0; d < a.length; d++) {
						var k = a[d];
						g.append('\x3coption value\x3d"' + k.yt$playlistId.$t + '"\x3e' + k.title.$t + "\x3c/option\x3e")
					}
					togglePlaylistMode(!0);
					$.dmUnblockUI();
					e && e();
					return
				}
				j()
			},
			error: j
		})
	};
	"playlist" == e && k(j,
	function() {
		$(".editContentItem.playlistName select").find("[value\x3d'" + a.attr("playlistname") + "']").attr("selected", "selected")
	});
	$(".editContentItem.playlistName select").change(function() {
		var d = $(this).find("option:selected").attr("value"),
		e = $(this).find("option:selected").text();
		_changeYouTubeExtension(a, {
			playlistname: d,
			playlisttitle: e
		})
	});
	d.val(j).unbind("keypress").bind("keypress",
	function(a) {
		13 == a.which && $(this).blur()
	}).unbind("blur").bind("blur",
	function() {
		var e = d.val(),
		j = $(".editContentItem.feedType select").find("option:selected").attr("value");
		e && !(e == a.attr("searchterm") && j == a.attr("feedtype") && "playlist" != j) && ("playlist" == j ? k(e,
		function() {
			var d = $(".editContentItem.playlistName select").find("option:selected").attr("value"),
			k = $(".editContentItem.playlistName select").find("option:selected").text();
			_changeYouTubeExtension(a, {
				searchterm: e,
				playlisttitle: k,
				feedtype: j,
				playlistname: d,
				orderby: g.find("option:selected").attr("value")
			})
		}) : _validateYouTubeFeed(e, j,
		function() {
			_changeYouTubeExtension(a, {
				searchterm: e,
				feedtype: j
			})
		}))
	});
	$(".editContentItem.numberItem select").find("[value\x3d'" + a.attr("items") + "']").attr("selected", "selected");
	$(".editContentItem.numberItem select").change(function() {
		var d = 1 * $(this).find("option:selected").attr("value");
		_changeYouTubeExtension(a, {
			items: d
		})
	});
	$(".editContentItem.orderBy select").find("[value\x3d'" + a.attr("orderby") + "']").attr("selected", "selected");
	$(".editContentItem.orderBy select").change(function() {
		var d = $(this).find("option:selected").attr("value");
		_changeYouTubeExtension(a, {
			orderby: d
		})
	});
	$("#showheader").onOffBtn({
		initState: "true" == a.attr("showheader"),
		onFn: function() {
			_changeYouTubeExtension(a, {
				showheader: !0
			})
		},
		offFn: function() {
			_changeYouTubeExtension(a, {
				showheader: !1
			})
		}
	})
};NEEYouTubeFeed.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEYouTubeFeed.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorYoutubeFeedSelected")
};NEEYouTubeFeed.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorYoutubeFeedSelected"), this.disableEditInline())
};NEEYouTubeFeed.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEYouTubeFeed.prototype.getElementTagsSelectors = function() {
	return ".dmYouTubeFeed, .dmYouTubeFeed *"
};NEEYouTubeFeed.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEYouTubeFeed.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmYouTubeFeed")
};NEEYouTubeFeed.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEYouTubeFeed.prototype.disableEditInline = function() {};NEEYouTubeFeed.prototype.docReady = function() {};NEEYouTubeFeed.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	});
	$.dmops.redrawSelection()
};NEEYouTubeFeed.prototype.afterInsert = function(a) {
	this.isAfterInsert = !0;
	a.html(a.html());
	$.dmops.redrawSelection();
	$.dmfw.preview.testAndSetPlaceholder(".dmYouTubeFeed UL.dmLinkList", "",
	function() {
		$.dmops.redrawSelection()
	})
};NEEYouTubeFeed.prototype.updateToggleTitle = function() {
	var a = $.dmx.current.element,
	e = !0,
	e = "false" == a.attr("showheader") ? !0 : !1; ! 0 == $.dmx.site.isFromScratch && (e = $.dmx.current.element.find(".dmwidget-title"), e = "none" == e.css("display") || 0 == e.length ? !0 : !1);
	_changeYouTubeExtension(a, {
		showheader: e,
		forcedisplay: e
	})
};NEEYouTubeFeed.prototype.genericUpdateTitle = function(a) {
	var e = $.dmx.current.element;
	_changeYouTubeExtension(e, {
		title: a,
		forcedisplay: !0,
		showheader: "" == a ? !1 : !0
	})
};NEEYouTubeFeed.prototype.checkClose = function() {
	var a = 0 === $("#generalTitleInput:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			adjustY: 4,
			at: "bottom center",
			my: "top center"
		},
		d = $.dmx.current.element,
		g = $(".editContentItemInput input").val(),
		j = "" === g,
		k = d.attr("searchTerm"),
		d = "dudamobile" === k,
		g = j ? "ui.nee.promptMassages.12": g !== k && !d ? "ui.nee.youtubefeed.20": "ui.nee.promptMassages.3";
		d || "" === $(".editContentItemInput input").val() ? $.dmfw.showPromptError($(".editContentItemInput input"), dmStr[g], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	a)
};
function NEEPayPal() {
	this.isExtension = !0;
	this.ext = {
		id: "paypal",
		preId: "paypal",
		defaults: {
			type: "Buy",
			currency: dmStr["ui.config.currency"],
			buttonsize: "_LG",
			lang: dmStr["ui.config.langStr"],
			needs_premium_validation: !0
		}
	};
	this.title = function() {
		return dmStr["ui.nee.paypal.1"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtPayPal";
	this.priority = 0.1;
	this.type = "paypal";
	this.addClearWidget = this.isWidget = !1;
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/paypal.png",
			editableDraggedText: dmStr["ui.nee.widgets.32"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.paypal.2"]
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/payPal/nee.payPal.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.tabsReady
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEPayPal.prototype.tabsReady = function(a) {
	$("\x3cdiv class\x3d'dontHavePayPalSign'\x3e" + dmStr["ui.nee.paypal.3"] + " \x3ca target\x3d'_blank' href\x3d'" + dmStr["ui.nee.paypal.url"] + "'\x3e" + dmStr["ui.nee.paypal.4"] + "\x3c/a\x3e\x3c/div\x3e").appendTo(a.find(".slideRightPanelInner"));
	var e = $.dmx.current.editable.element;
	_updateCurrencyToMatch = function() {
		$("#nopaypalCurrencyToUpdate").text($("#paypalCurrency option:selected").text())
	};
	_updatePaySceenToType = function() {
		"Buy" == $("#paypalType").val() ? ($(".displayPayPalDonateScreen").hide(), $(".displayPayPalBuyScreen").show()) : ($(".displayPayPalBuyScreen").hide(), $(".displayPayPalDonateScreen").show())
	};
	$("#paypalType").click(function() {
		_updatePaySceenToType()
	});
	$("#paypalCurrency").click(function() {
		_updateCurrencyToMatch()
	});
	$(".numbersOnlyPayPal").keyup(function() {
		this.value = this.value.replace(/[^0-9]/g, "")
	});
	$("#paypalBusiness").val(e.find("input[name\x3dbusiness]").attr("value"));
	$("#paypalType").val("_xclick" == e.find("input[name\x3dcmd]").attr("value") ? "Buy": "Donate");
	$("#paypalItem").val(e.find("input[name\x3ditem_name]").attr("value"));
	$("#paypalCurrency").val(e.find("input[name\x3dcurrency_code]").attr("value"));
	$("#paypalPrice").val(e.find("input[name\x3damount]").attr("value"));
	$("#nopaypalCurrencyToUpdate").text($("#paypalCurrency option:selected").text());
	$("#paypalCurrencyDonate").val(e.find("input[name\x3dcurrency_code]").attr("value"));
	$("#paypalShipping").val(e.find("input[name\x3dshipping]").attr("value"));
	$("#paypalTax").val(e.find("input[name\x3dtax_rate]").attr("value"));
	$("#paypalLang").val(e.find("input[name\x3dlc]").attr("touse"));
	$("#paypalDonateFor").val(e.find("input[name\x3ditem_name]").attr("value"));
	$("#paypalPriceDonate").val(e.find("input[name\x3damount]").attr("value"));
	"YJP" == $.dmx.site.dmProductType && ($("#paypalType").attr("disabled", "disabled"), $("#paypalLang").attr("disabled", "disabled"), $("#paypalCurrency").hide(), $("#nopaypalCurrencyToUpdate2").show(), $("#nopaypalCurrencyToUpdate2").text($("#paypalCurrency option:selected").text()));
	_getCurrentButtonSize = function() {
		var a = e.find("input[name\x3dbn]").attr("value");
		return - 1 != a.indexOf("_SM") ? "_SM": -1 != a.indexOf("CC_LG") ? "CC_LG": "_LG"
	};
	$("#paypalButtonSize").val(_getCurrentButtonSize());
	_updatePaySceenToType();
	$.dmops.redrawSelection();
	$('[id^\x3d"paypal"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"paypal"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	$('[id^\x3d"paypal"]').change(function() {
		_updateInfo()
	});
	_validateUserName = function() {
		var a = !0;
		"" == $("#paypalBusiness").val().trim() && (a = !1);
		a ? $.dmx.editor.setValid(!0) : ($.dmfw.showValidationError("#paypalBusiness", dmStr["ui.nee.paypal.5"]), $.dmx.editor.setValid(!1));
		return a
	};
	$(".numbersOnlyAmountPayPal").keypress(function(a) {
		8 === a.which || (0 === a.which || 37 <= a.which && 40 >= a.which) || (num = $(this).val(), num = isNaN(num) || "" === num || null === num ? 0 : num, (46 != a.which || -1 != $(this).val().indexOf(".")) && (48 > a.which || 57 < a.which) && a.preventDefault(), $(this).val() == parseFloat(num).toFixed(2) && a.preventDefault())
	});
	_validateInfoChanged = function() {
		var a = !1;
		if ($("#paypalType").val() != ("_xclick" == e.find("input[name\x3dcmd]").attr("value") ? "Buy": "Donate") || $("#paypalBusiness").val() != e.find("input[name\x3dbusiness]").attr("value") || $("#paypalShipping").val() != e.find("input[name\x3dshipping]").attr("value") || $("#paypalTax").val() != e.find("input[name\x3dtax_rate]").attr("value") || $("#paypalButtonSize").val() != _getCurrentButtonSize() || $("#paypalItem").val() != e.find("input[name\x3ditem_name]").attr("value") || $("#paypalPrice").val() != e.find("input[name\x3damount]").attr("value") || $("#paypalLang").val() != e.find("input[name\x3dlc]").attr("touse") || $("#paypalCurrency").val() != e.find("input[name\x3dcurrency_code]").attr("value")) a = !0;
		return a
	};
	_updateInfo = function() {
		if (_validateUserName() || _validateInfoChanged()) {
			var a = {
				type: $("#paypalType").val(),
				business: $("#paypalBusiness").val(),
				itemname: "Buy" == $("#paypalType").val() ? $("#paypalItem").val() : $("#paypalDonateFor").val(),
				price: "Buy" == $("#paypalType").val() ? $("#paypalPrice").val() : $("#paypalPriceDonate").val(),
				currency: "Buy" == $("#paypalType").val() ? $("#paypalCurrency").val() : $("#paypalCurrencyDonate").val(),
				shipping: $("#paypalShipping").val(),
				tax: $("#paypalTax").val(),
				buttonsize: $("#paypalButtonSize").val(),
				lang: $("#paypalLang").val(),
				returnUrl: $.dmx.page.url
			};
			$.changePage({
				clientChange: function() {},
				serverChange: function() {
					$.dmsrv.updateExtension(e, a)
				}
			})
		}
	};
	$.dmops.redrawSelection();
	a.find("#paypalBusiness").focus()
};NEEPayPal.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEPayPal.prototype.docReady = function() {};NEEPayPal.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEPayPal.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEPayPal.prototype.getElementTagsSelectors = function() {
	return ".dmPayPalButton,  .dmPayPalButton *"
};NEEPayPal.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEPayPal.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmPayPalButton")
};NEEPayPal.prototype.disableEditInline = function() {};NEEPayPal.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEPayPal.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlinePayPalSelected")
};NEEPayPal.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlinePayPalSelected"), this.disableEditInline())
};
function NEEGoogleCheckout() {
	this.isExtension = !0;
	this.ext = {
		id: "googlecheckout",
		preId: "googlecheckout",
		defaults: {
			currency: dmStr["ui.nee.gcheckout.8"],
			buttonsize: "Large",
			buttonbackground: "trans",
			needs_premium_validation: !0
		}
	};
	this.title = function() {
		return dmStr["ui.nee.gcheckout.1"]
	};
	this.priority = 0.1;
	this.type = "googlecheckout";
	this.addClearWidget = this.isWidget = !1;
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "editor/nee/images/contentBtns/google.png",
			editableDraggedText: dmStr["ui.nee.widgets.33"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.gcheckout.1"]
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/googleCheckout/nee.googleCheckout.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.tabsReady
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEGoogleCheckout.prototype.tabsReady = function(a) {
	$("\x3cdiv class\x3d'dontHavePayPalSign dontHaveGoogleSign'\x3e" + dmStr["ui.nee.paypal.3"] + "\x3ca target\x3d'_blank' href\x3d'https://accounts.google.com/ServiceLogin'\x3e" + dmStr["ui.nee.paypal.4"] + "\x3c/a\x3e\x3c/div\x3e").appendTo(a.find(".slideRightPanelInner"));
	var e = $.dmx.current.editable.element;
	$("#googlecheckoutBusiness").val(e.find("input[name\x3dbusinessName]").attr("value"));
	$("#googlecheckoutItem").val(e.find("input[name\x3ditem_name_1]").attr("value"));
	$("#googlecheckoutDescription").val(e.find('input[name\x3d"item_description_1"]').attr("value"));
	$("#googlecheckoutCurrency").val(e.find("input[name\x3ditem_currency_1]").attr("value"));
	$("#googlecheckoutPrice").val(e.find("input[name\x3ditem_price_1]").attr("value"));
	$("#googlecheckoutButtonSize").val(e.find("input[name\x3dbuttonsize]").attr("value"));
	$("#googlecheckoutButtonBackground").val(e.find("input[name\x3dbuttonbackground]").attr("value"));
	$.dmops.redrawSelection();
	$('[id^\x3d"googlecheckout"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"googlecheckout"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	$('[id^\x3d"googlecheckout"]').change(function() {
		_updateInfo()
	});
	_validateUserName = function() {
		var a = !0;
		"" == $("#googlecheckoutBusiness").val().trim() && (a = !1);
		a ? $.dmx.editor.setValid(!0) : ($.dmfw.showValidationError("#googlecheckoutBusiness", dmStr["ui.nee.paypal.5"]), $.dmx.editor.setValid(!1));
		return a
	};
	$(".numbersOnlyAmountPayPal").keypress(function(a) {
		8 === a.which || (0 === a.which || 37 <= a.which && 40 >= a.which) || (num = $(this).val(), num = isNaN(num) || "" === num || null === num ? 0 : num, (46 != a.which || -1 != $(this).val().indexOf(".")) && (48 > a.which || 57 < a.which) && a.preventDefault(), $(this).val() == parseFloat(num).toFixed(2) && a.preventDefault())
	});
	_validateInfoHasChanged = function() {
		var a = !1;
		if ($("#googlecheckoutBusiness").val() != e.find("input[name\x3dbusinessName]").attr("value") || $("#googlecheckoutItem").val() != e.find("input[name\x3ditem_name_1]").attr("value") || $("#googlecheckoutDescription").val() != e.find('input[name\x3d"item_description_1"]').attr("value") || $("#googlecheckoutCurrency").val() != e.find("input[name\x3ditem_currency_1]").attr("value") || $("#googlecheckoutPrice").val() != e.find("input[name\x3ditem_price_1]").attr("value") || $("#googlecheckoutButtonSize").val() != e.find("input[name\x3dbuttonsize]").attr("value") || $("#googlecheckoutButtonBackground").val() != e.find("input[name\x3dbuttonbackground]").attr("value")) a = !0;
		return a
	};
	_updateInfo = function() {
		if (_validateUserName() || _validateInfoHasChanged()) {
			var a = {
				business: $("#googlecheckoutBusiness").val(),
				itemname: $("#googlecheckoutItem").val(),
				itemdescription: $("#googlecheckoutDescription").val(),
				price: $("#googlecheckoutPrice").val(),
				currency: $("#googlecheckoutCurrency").val(),
				buttonsize: $("#googlecheckoutButtonSize").val(),
				buttonbackground: $("#googlecheckoutButtonBackground").val(),
				returnUrl: $.dmx.page.url
			};
			$.changePage({
				clientChange: function() {},
				serverChange: function() {
					$.dmsrv.updateExtension(e, a)
				}
			})
		}
	};
	$.dmops.redrawSelection();
	a.find("#googlecheckoutBusiness").focus()
};NEEGoogleCheckout.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEGoogleCheckout.prototype.docReady = function() {};NEEGoogleCheckout.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEGoogleCheckout.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEGoogleCheckout.prototype.getElementTagsSelectors = function() {
	return ".dmGoogleCheckoutButton,  .dmGoogleCheckoutButton *"
};NEEGoogleCheckout.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEGoogleCheckout.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmGoogleCheckoutButton")
};NEEGoogleCheckout.prototype.disableEditInline = function() {};NEEGoogleCheckout.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEGoogleCheckout.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineGoogleCheckoutSelected")
};NEEGoogleCheckout.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineGoogleCheckoutSelected"), this.disableEditInline())
};
function NEEHomeScreen() {
	this.title = function() {
		return dmStr["ui.nee.mainTabs.48"]
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlHomeScreenIcon.jsp",
			text: dmStr["ui.nee.mainTabs.49"],
			imgSrc: "HomeScreenImgIcon",
			onTabReady: this._TabReadyDesignHomeScreenIcon
		},
		{
			url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlSplashScreen.jsp",
			text: dmStr["ui.nee.mainTabs.50"],
			imgSrc: "StartUpImgIcon",
			onTabReady: this._TabReadyDesignSplashScreen
		},
		{
			url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlReminder.jsp",
			text: dmStr["ui.nee.mainTabs.51"],
			imgSrc: "ReminderImgIcon",
			onTabReady: this._TabReadyDesignReminder
		}]
	}
}
NEEHomeScreen.prototype._TabReadyDesignHomeScreenIcon = function(a) {
	function e(a) {
		$(".favIconIphoneWrapper .iconPreviewImg").css("background-image", "url(" + a + ")").css("border-style", "none");
		$(".favIconIphoneWrapper .noIcon").css("visibility", "hidden")
	}
	function d(a) {
		$(".favIconDevicesWrapper .iconPreviewImg").css("background-image", "url(" + a + ")").css("border-style", "none");
		$(".favIconDevicesWrapper .noIcon").css("visibility", "hidden")
	}
	a.find(".openExample").neePopUpDiv(a.find(".divToBePoppedIcon"));
	a.find(".setupImgBtnIphone").neePopUpDiv(a.find(".openImagePickerPopUpWrapper"), {
		init: function(a) {
			a.neeSecondaryIconTabs({
				tabs: {
					upload: [{
						isChange: !1
					}],
					original_images: [],
					url: []
				},
				callback: this.toChangeFunction,
				uploadBiggerButton: !0,
				isNotElement: !0
			})
		},
		toChangeFunction: function(a) {
			$("body").find(".popupWinExampleMask").hide();
			a = a ? a: "http://image-res-platform.s3.amazonaws.com/dm/home_icon.png";
			$.dmPostWithHistory({
				url: "/site/" + $.dmx.site.id + "/updatehomescreenicon",
				data: {
					value: a
				}
			});
			$.dmx.site.siteSettings.homescreenIcon = a;
			e(a)
		},
		showIphone: !0
	});
	$.dmx.site.siteSettings.homescreenIcon && e($.dmx.site.siteSettings.homescreenIcon);
	$.dmx.site.siteSettings.favIcon && d($.dmx.site.siteSettings.favIcon);
	_limitAttachICO = function(a, e) {
		extArray = [".ico"];
		allowSubmit = !1;
		if (e) {
			for (; - 1 != e.indexOf("\\");) e = e.slice(e.indexOf("\\") + 1);
			ext = e.slice(e.indexOf(".")).toLowerCase();
			for (var k = 0; k < extArray.length; k++) if (extArray[k] == ext) {
				allowSubmit = !0;
				break
			}
			if (allowSubmit) {
				k = document.createElement("iframe");
				k.setAttribute("id", "upload_iframe");
				k.setAttribute("name", "upload_iframe");
				k.setAttribute("width", "0");
				k.setAttribute("height", "0");
				k.setAttribute("border", "0");
				k.setAttribute("style", "width: 0; height: 0; border: none;");
				a.parentNode.appendChild(k);
				window.frames.upload_iframe.name = "upload_iframe";
				iframeId = document.getElementById("upload_iframe");
				var l = function() {
					var a = "";
					null != iframeId.detachEvent ? iframeId.detachEvent("onload", l) : iframeId.removeEventListener("load", l, !1);
					null != iframeId.contentDocument ? (a = iframeId.contentDocument.body.innerHTML, iframeId.contentDocument.body.innerHTML = "") : null != iframeId.contentWindow ? (a = iframeId.contentWindow.document.body.innerHTML, iframeId.contentWindow.document.body.innerHTML = "") : null != iframeId.document && (a = iframeId.document.body.innerHTML, iframeId.document.body.innerHTML = "");
					$.dmUnblockUI();
					if (a = $.browser.msie ? $(a).selector: $(a).html()) a = a ? a: "http://dudamobile.com/favicon.ico",
					$.dmPostWithHistory({
						url: "/site/" + $.dmx.site.id + "/updatefavicon",
						data: {
							value: a
						}
					}),
					$.dmx.site.siteSettings.favIcon = a,
					d(a);
					setTimeout("iframeId.parentNode.removeChild(iframeId)", 250)
				};
				null != iframeId.addEventListener && iframeId.addEventListener("load", l, !0);
				null != iframeId.attachEvent && iframeId.attachEvent("onload", l);
				a.setAttribute("target", "upload_iframe");
				a.setAttribute("action", "/editor/nee/imageUpload?maxUrlLen\x3d150\x26folder\x3d" + $.dmx.site.alias);
				a.setAttribute("method", "post");
				a.setAttribute("enctype", "multipart/form-data");
				a.setAttribute("encoding", "multipart/form-data");
				$("form #upload-form").encoding = "multipart/form-data";
				a.submit(function() {})
			} else $.dmUnblockUI(),
			$("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.imagePicker.3"] + extArray.join("  ") + "\n " + dmStr["ui.nee.imagePicker.4"] + " " + dmStr["ui.nee.imagePicker.5"], {
				triggerNow: !0,
				yesText: dmStr["ui.ok.u"],
				noStyle: "display:none"
			})
		}
	};
	$("input[type\x3dfile]").unbind("change").change(function(a) {
		a.stopPropagation();
		a.stopImmediatePropagation();
		$('[id\x3d"tempTryIco"]').trigger("click")
	})
};NEEHomeScreen.prototype._TabReadyDesignSplashScreen = function(a) {
	function e(a) {
		$(".startupImgPreview img").attr("src", a);
		$(".startupImgPreviewWrapper .noIcon").css("visibility", "hidden")
	}
	a.find(".openExample").neePopUpDiv(a.find(".divToBePoppedScreen"));
	a.find(".setupImgBtnStartUp").neePopUpDiv(a.find(".openImagePickerPopUpWrapper"), {
		init: function(a) {
			a.neeSecondaryIconTabs({
				tabs: {
					upload: [{
						isChange: !1
					}],
					original_images: [],
					url: []
				},
				callback: this.toChangeFunction,
				uploadBiggerButton: !0,
				isNotElement: !0
			})
		},
		toChangeFunction: function(a) {
			$("body").find(".popupWinExampleMask").hide();
			a = a ? a: "http://image-res-platform.s3.amazonaws.com/dm/splash_screen.png";
			$.dmPostWithHistory({
				url: "/site/" + $.dmx.site.id + "/updatestartupimage",
				data: {
					value: a
				}
			});
			$.dmx.site.siteSettings.startupImage = a;
			e(a)
		},
		showIphone: !0
	});
	$.dmx.site.siteSettings.startupImage && e($.dmx.site.siteSettings.startupImage)
};NEEHomeScreen.prototype._TabReadyDesignReminder = function(a) {
	a.find(".openExample").neePopUpDiv(a.find(".divToBePoppedReminder"));
	var e = function(a) {
		$.dmPostWithHistory({
			url: "/site/" + $.dmx.site.id + "/togglehomescreenreminder/" + a
		});
		$.dmx.site.siteSettings.homescreenReminder = a
	};
	a = {
		initState: $.dmx.site.siteSettings.homescreenReminder,
		onFn: function() {
			e(!0)
		},
		offFn: function() {
			e(!1)
		}
	};
	$("#reminderOnOff").onOffBtn(a)
};NEEHomeScreen.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEHomeScreen.prototype.onEditorClose = function() {};
function NEEGlobalText() {
	this.title = function() {
		return dmStr["ui.nee.mainTabs.9"]
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.background"],
			imgSrc: "PageBackgroundImgIcon",
			onTabReady: this._TabReadyDesignPageBackground
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.common.design.35"],
			imgSrc: "TextStyleIcon",
			onTabReady: this._assignControlText
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.mainTabs.10"],
			imgSrc: "LinksStyleImgIcon",
			onTabReady: this._assignControlLinks
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.mainTabs.11"],
			imgSrc: "HeadingStyleImgIcon",
			onTabReady: this._assignControlHeading
		}]
	}
}
NEEGlobalText.prototype._TabReadyDesignPageBackground = function(a) {
	function e(d) {
		var e;
		1 == d ? (e = ["*#dm DIV.dmInner"], d = $.dmfw.getPreviewElement(".dmInner")) : (e = ["*#dm DIV.dmContent"], d = $.dmfw.getPreviewElement(".dmContent"));
		var k = d.css("background-color");
		0 != d.length && $.dmops.scrollPreviewToElement(d);
		a.find(".colorPickerWidget").neeColorPicker(k, dmStr["ui.background"].toLowerCase() + " ",
		function(a) {
			updateInChangePage(e, "background-color", a)
		},
		function(a) {
			updateInPreviewOnly(e, "background-color", a)
		});
		a.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
			elem: d,
			forceClassName: e[0],
			callback: function(a) {
				updateInChangePage(e, "background-image", "url(" + a + ")", !0)
			},
			changeGlobally: !0
		})
	}
	var d = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.12"],
		onReady: e,
		toReturn: 1
	},
	{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.13"],
		onReady: e,
		toReturn: 2
	}];
	$(a).neeSecondaryTabsControl(d)
};NEEGlobalText.prototype._assignControlText = function(a) {
	var e = ["*#dm div.dmContent *", "*#dm div.dmFooter *", "*#dm div.dm-title"],
	d = $.dmfw.getPreviewElement(".dmContent *"),
	g = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.14"],
		onReady: function() {
			var g = d.css("color");
			0 != d.length && $.dmops.scrollPreviewToElement(d);
			a.find(".colorPickerWidget").neeColorPicker(g, dmStr["ui.text"].toLowerCase() + " ",
			function(a) {
				updateInChangePage(e, "color", a)
			},
			function(a) {
				updateInPreviewOnly(e, "color", a)
			})
		}
	},
	{
		url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
		name: dmStr["ui.nee.mainTabs.15"],
		onReady: function() {
			0 != d.length && $.dmops.scrollPreviewToElement(d);
			var g = d.css("font-size");
			a.neeChangeTextSize(g,
			function(a) {
				updateInChangePage(e, "font-size", a)
			})
		}
	},
	{
		url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlFontFamily.jsp",
		name: dmStr["ui.nee.mainTabs.16"],
		onReady: function() {
			0 != d.length && $.dmops.scrollPreviewToElement(d);
			var g = d.css("font-family");
			a.neeChangeFontFamily(g,
			function(a) {
				updateInChangePage(e, "font-family", a)
			})
		}
	}];
	$(a).neeSecondaryTabsControl(g)
};NEEGlobalText.prototype._assignControlLinks = function(a) {
	function e(a, e) {
		function g(a) {
			e ? updateInChangePage(a, "text-decoration", "underline") : updateInChangePage(a, "text-decoration", "none")
		}
		"visit" == a ? g(cssClassesVisitedLink) : g(d)
	}
	var d = ["*#dm div.dmContent A *", "*#dm div.dmContent A", "*#dm div.dmFooter A"],
	g = $.dmfw.getPreviewElement(".dmContent A"),
	j = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.17"],
		onReady: function() {
			var j = g.css("color");
			0 != g.length && $.dmops.scrollPreviewToElement(g);
			var l = "underline" == g.css("text-decoration") ? !0 : !1;
			a.find(".colorPickerWidget").neeColorPicker(j, dmStr["ui.link"].toLowerCase() + " ",
			function(a) {
				updateInChangePage(d, "color", a)
			},
			function(a) {
				updateInPreviewOnly(d, "color", a)
			});
			a.find(".slideRightPanelInner").addUnderlineFunctionality("noVisit", l, e)
		}
	}];
	$(a).neeSecondaryTabsControl(j);
	$.fn.addUnderlineFunctionality = function(a, d, e) {
		var g = $("\x3cdiv\x3e\x3c/div\x3e").attr("class", "neeNoMark").css("margin-top", "130px");
		$('\x3chr style\x3d"background: #D9D9D9;margin-bottom: 10px;margin-top: 70px;"\x3e').appendTo(g);
		$('\x3clabel id\x3d"NEEShapeOnOffText"  style\x3d"font-size: 17px;"\x3e\x3c/label\x3e').html(dmStr["ui.nee.mainTabs.22"]).appendTo(g);
		var j = $("\x3cdiv\x3e\x3c/div\x3e").attr("class", "neeNoMark").css("float", "right").css("margin-right", "10px").appendTo(g);
		g.appendTo(this);
		j.onOffBtn({
			initState: d,
			onFn: function() {
				e(a, !0)
			},
			offFn: function() {
				e(a, !1)
			}
		})
	}
};NEEGlobalText.prototype._assignControlHeading = function(a) {
	var e = [];
	e["1"] = "*#dm div.dmContent h1 *;*#dm div.dmFooter h1 *;*#dm div.dm-title h1 *;*#dm div.dmContent h1;*#dm div.dmFooter h1;*#dm div.dm-title h1".split(";");
	e["2"] = "*#dm div.dmContent h2 *;*#dm div.dmFooter h2 *;*#dm div.dm-title h2 *;*#dm div.dmContent h2;*#dm div.dmFooter h2;*#dm div.dm-title h2".split(";");
	e["3"] = "*#dm div.dmContent h3 *;*#dm div.dmFooter h3 *;*#dm div.dm-title h3 *;*#dm div.dmContent h3;*#dm div.dmFooter h3;*#dm div.dm-title h3".split(";");
	e["4"] = "*#dm div.dmContent h4 *;*#dm div.dmFooter h4 *;*#dm div.dm-title h4 *;*#dm div.dmContent h4;*#dm div.dmFooter h4;*#dm div.dm-title h4".split(";");
	var d = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.14"],
		onReady: function() {
			var d = -1;
			a.find(".slideRightPanelInner").neeThirdTabControl({
				callback: function(j) {
					d = j;
					j = !0;
					a.find(".warningHnotExist").remove();
					var k = $.dmfw.getPreviewElement(".dmContent H" + d),
					l = k.css("color");
					0 == k.length && (l = getDefaultValue("H" + d, "color"), j = !1);
					var m = e[d];
					0 != k.length && $.dmops.scrollPreviewToElement(k);
					j || _addHwarning(a.find(".slideRightPanelInner"), d);
					a.find(".colorPickerWidget").neeColorPicker(l, dmStr["ui.nee.mainTabs.heading"].toLowerCase() + " ",
					function(a) {
						updateInChangePage(m, "color", a)
					},
					function(a) {
						updateInPreviewOnly(m, "color", a)
					})
				},
				tabs: [{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.1"],
					toReturn: 1
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.2"],
					toReturn: 2
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.3"],
					toReturn: 3
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.4"],
					toReturn: 4
				}]
			})
		}
	},
	{
		url: "/editor/nee/mainTabs/neeDesign/nee.designHtmlTextSize.jsp",
		name: dmStr["ui.nee.mainTabs.15"],
		onReady: function(d) {
			d = -1;
			a.find(".slideRightPanelInner").neeThirdTabControl({
				callback: function(j) {
					d = j;
					j = !0;
					a.find(".warningHnotExist").remove();
					var k = $.dmfw.getPreviewElement(".dmContent H" + d),
					l = k.css("font-size");
					0 == k.length && (l = getDefaultValue("H" + d, "font-size"), j = !1);
					a.neeChangeTextSize(l,
					function(a) {
						updateInChangePage(m, "font-size", a)
					});
					0 != k.length && $.dmops.scrollPreviewToElement(k);
					j || _addHwarning(a.find(".slideRightPanelInner"), d);
					a.find("#innerDesignText").css("margin-left", "52px").css("margin-top", "30px");
					var m = e[d]
				},
				tabs: [{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.1"],
					toReturn: 1
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.2"],
					toReturn: 2
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.3"],
					toReturn: 3
				},
				{
					name: dmStr["ui.nee.mainTabs.heading"] + " " + dmStr["ui.num.4"],
					toReturn: 4
				}]
			})
		}
	}];
	$(a).neeSecondaryTabsControl(d)
};
function _addHwarning(a, e) {
	var d = '"' + dmStr["ui.nee.mainTabs.heading"] + e + '"' + dmStr["ui.nee.mainTabs.19"] + "(\x26lt;H" + e + "\x26gt;) " + dmStr["ui.nee.mainTabs.20"] + " \x3cbr/\x3e" + dmStr["ui.nee.mainTabs.21"],
	g = $("\x3cdiv\x3e\x3c/div\x3e").appendTo(a).addClass("warningHnotExist");
	$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("warningHalert");
	$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).css("margin-left", "50px").html(d)
}
function getDefaultValue(a, e) {
	var d = $("\x3c" + a + "\x3e\x3c/" + a + "\x3e").hide(),
	g = $.dmfw.getPreviewElement(".dmContent *");
	d.appendTo(g);
	d = $(g).find(a).css(e);
	$(g).find(a).remove();
	return d
}
NEEGlobalText.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEGlobalText.prototype.onEditorClose = function() {};
function NEEYelp() {
	this.title = function() {
		return dmStr["ui.nee.yelp.1"]
	};
	this.isExtension = !0;
	this.ext = {
		id: "yelp",
		preId: "yelp",
		defaults: {
			layout: "list",
			reviewphotos: !0,
			requiredrating: 3,
			needs_premium_validation: !0
		}
	};
	this.priority = 0.9;
	this.type = "yelp";
	this.inlineEditor = null;
	this.mindTouchId = "dmMtReviews";
	this.showMindTouchHelp = !0;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/icons_widgets_yelp_white.png",
			editableDraggedText: dmStr["ui.nee.widgets.35"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.yelp.1"]
	};
	this.editorDesc = "Embed reviews and share the appreciation you receive on Yelp.";
	this.defaultMarkup = function() {
		return "\x3cdiv class\x3d'dmYelp'\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.addClearWidget = !1;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/yelp/yelpSearch.jsp",
			text: dmStr["ui.nee.yelp.11"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.yelpOnTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.yelp.12"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["border", "background_widgets"],
						shape: [],
						combined_style_review: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.yelp.13"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEYelp.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEYelp.prototype.yelpOnTabReadyGeneral = function(a) {
	function e(a) {
		$.dmx.current.element.attr("reviewphotos", a);
		a = $.dmx.current.element.attr("yelpid");
		var e = $.dmx.current.element.attr("business"),
		j = $.dmx.current.element.attr("requiredrating"),
		k = $.dmx.current.element.attr("reviewphotos"),
		l = $.extend({},
		$.dmx.current.editable.ext.defaults, {
			yelpid: a,
			business: e,
			requiredrating: j,
			reviewphotos: k
		});
		$.changePage({
			clientChange: function() {},
			serverChange: function() {
				$.dmsrv.updateExtension($.dmx.current.element, l, {
					successCallback: function() {
						$.dmops.redrawSelection()
					}
				})
			}
		})
	}
	NEEYelp.prototype.handleTitle.widgetRuntimeTitle = $.dmx.current.element.attr("title");
	NEEYelp.prototype.handleTitle.handleTitleinit(a);
	NEEYelp.prototype.placeholderTest();
	$("#yelpDoSearch").off("click").on("click",
	function() {
		var a = $("#yelpUrl").val(),
		e = {
			at: "bottom center",
			my: "top center",
			adjustY: 4,
			maxWidth: "500"
		};
		"" != a ? ($.dmLoading($("#_editor")), $.dmGet({
			url: "/sites/" + $.dmx.site.id + "/searchyelpforbusiness/?url\x3d" + encodeURI(a),
			success: function(a) {
				$.dmUnblockUI();
				if (0 != a.length) {
					$(".yelpBusinessName").html(a.businessName);
					$(".yelpSearch").hide();
					$(".yelpError").hide();
					$(".yelpResults").show();
					$("#toggleTitleBtn").removeClass("hideTitle");
					$("#generalTitleInput").removeClass("hideTitle");
					$("#designTitleBtn").removeClass("hideTitle");
					var d = $.dmx.current.element,
					l = $.extend({},
					{
						yelpid: a.id,
						business: a.businessName
					},
					$.dmx.current.editable.ext.defaults);
					$.changePage({
						clientChange: function() {
							$.dmx.current.element.attr("yelpid", a.id);
							$.dmx.current.element.attr("business", a.business)
						},
						serverChange: function() {
							$.dmsrv.updateExtension(d, l, {
								successCallback: function() {
									$.dmops.redrawSelection();
									$.dmx.preview.wnd().jQuery.DM.updateAfterInit();
									$.dmx.current.editable.placeholderTest()
								}
							})
						}
					})
				} else $.dmfw.showPromptError($("#yelpUrl"), dmStr["ui.nee.promptMassages.24"], e)
			}
		})) : $.dmfw.showPromptError($("#yelpUrl"), dmStr["ui.nee.promptMassages.7"], e)
	});
	$("#yelpUrl").keypress(function(a) {
		13 == a.keyCode && $("#yelpDoSearch").trigger("click")
	});
	$(".yelpEnterUrlAgain").unbind("click").click(function() {
		$(".yelpSearch").show();
		$(".yelpError").hide();
		$(".yelpResults").hide()
	});
	$("#showPhotos").onOffBtn({
		initState: null != $.dmx.current.element.attr("reviewphotos") && "true" == $.dmx.current.element.attr("reviewphotos"),
		onFn: function() {
			e(!0)
		},
		offFn: function() {
			e(!1)
		}
	});
	null == $.dmx.current.element.attr("yelpid") || "" == $.dmx.current.element.attr("yelpid") ? ($(".yelpSearch").show(), $(".yelpError").hide(), $(".yelpResults").hide()) : ($(".yelpBusinessName").html($.dmx.current.element.attr("business")), $(".yelpSearch").hide(), $(".yelpError").hide(), $(".yelpResults").show())
};NEEYelp.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEYelp.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorYelpSelected")
};NEEYelp.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorYelpSelected"), this.disableEditInline())
};NEEYelp.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEYelp.prototype.getElementTagsSelectors = function() {
	return ".dmYelp,  .dmYelp *"
};NEEYelp.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEYelp.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmYelp")
};NEEYelp.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEYelp.prototype.disableEditInline = function() {};NEEYelp.prototype.docReady = function() {};NEEYelp.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEYelp.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center"
		},
		e = 0 === $("#generalTitleInput:visible").length ? "#yelpUrl": ".yelpEnterUrlAgain",
		d = $.dmx.current.element,
		d = "undefined" === typeof d.attr("yelpid") || "" === d.attr("yelpid"),
		g = "ui.nee.promptMassages.7",
		j = $("#yelpUrl:visible");
		0 < $(".yelpEnterUrlAgain:visible").length ? g = "ui.nee.promptMassages.8": 0 < j.length && "" !== j.val() ? (d = !0, e = "", $("#yelpDoSearch").trigger("click")) : 0 < j.length && (d = !0);
		d ? $.dmfw.showPromptError($(e), dmStr[g], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	})
};NEEYelp.prototype.updatePreview = function(a, e) {
	var d = $.dmx.current.element,
	g = e;
	"undefined" == typeof g && (g = d.attr("displaytitle"));
	"undefined" == typeof a ? a = d.attr("title") : g = "" == a ? !1 : !0;
	if (!0 == $.dmx.site.isFromScratch && !1 === $.dmfw.isDudaone()) var j = $.dmx.current.element.find(".dmwidget-title"),
	g = "none" == j.css("display") || 0 == j.length ? !0 : !1;
	var j = {
		yelpid: d.attr("yelpid"),
		business: d.attr("business"),
		title: a,
		displaytitle: g,
		forcedisplay: !0
	},
	k = $.extend({},
	j, $.dmx.current.editable.ext.defaults);
	$.changePage({
		clientChange: function() {
			$.dmx.current.element.attr("yelpid", d.attr("yelpid"));
			$.dmx.current.element.attr("business", d.attr("business"));
			$.dmx.current.element.attr("title", a);
			$.dmx.current.element.attr("displaytitle", g);
			$.dmx.current.element.attr("forcedisplay", !0)
		},
		serverChange: function() {
			$.dmsrv.updateExtension(d, k, {
				successCallback: function() {
					$.dmops.redrawSelection();
					$.dmx.preview.wnd().jQuery.DM.updateAfterInit()
				}
			})
		}
	})
};NEEYelp.prototype.genericUpdateTitle = function(a) {
	this.updatePreview(a, void 0, {
		updateText: !0
	})
};NEEYelp.prototype.updateToggleTitle = function() {
	var a = "true" == $.dmx.current.element.attr("displaytitle") ? "false": "true";
	this.updatePreview(void 0, a)
};NEEYelp.prototype.placeholderTest = function() {
	$.dmfw.isDudaone() && $.dmfw.preview.dudaOneTestAndSetPlaceholder($.dmx.current.element, "div.yelpReviewBox")
};
function NEEMenu() {
	this.title = function() {
		return dmStr["ui.nee.menu.1"]
	};
	this.isExtension = !0;
	this.ext = {
		id: "restaurant_menu",
		preId: "restaurant_menu",
		defaults: {
			needs_premium_validation: !0,
			wr: !0,
			platform: "dm",
			menu_data: "",
			businessname: "",
			currency: dmStr["ui.config.defaultCurrency"],
			title: dmStr["ui.nee.resturant.100"]
		}
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtRestMenu";
	this.isCat = this.isInner = !1;
	this.priority = 1;
	this.type = "restaurantmenu";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/menu.png",
			editableDraggedText: dmStr["ui.nee.widgets.34"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.menu.1"]
	};
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.addClearWidget = !1
}
NEEMenu.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEMenu.prototype.MenuOnTabReadyGeneral = function(a, e, d) {
	function g() {
		var a = $.dmx.current.element;
		return "sp" == a.attr("platform") ? "sp": "locu" == a.attr("platform") ? "locu": "dm" == a.attr("platform") && a.attr("menu") && 0 < a.attr("menu").length || a.attr("menu_data") && 0 < a.attr("menu_data").length ? "dm": null
	}
	var j = this;
	NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initMenusArrows({
		isOpenAll: !0,
		elem: $.dmx.current.element
	});
	a.addClass("menuPanel");
	d = d || {};
	var k = $.dmx.current.element.attr("title");
	j.handleTitle.widgetRuntimeTitle = k;
	j.handleTitle.displayTitle = "true" == $.dmx.current.element.attr("displaytitle") ? !0 : !1;
	j.handleTitle.handleTitleinit(a);
	$.dmx.current.editable.isInner && ($.dmx.current.editable.isInner = !1, e = null);
	$.dmx.current.editable.placeholderTest();
	$.dmops.redrawSelection();
	_restoreMenuUI = function() {
		var a = $(".rightPanel");
		a.empty();
		$.dmfw.setEditorBreadcrumb(null);
		$.dmLoad(a, j.getMarkupUrl(),
		function() {
			j.MenuOnTabReadyGeneral(a, !0)
		})
	};
	_handleBackButton = function() {
		$(".backButton").unbind("click").click(function() {
			$.dmx.current.editable.isCat && ($.dmx.current.editable.isCat = !1, $.dmx.current.editable.isInner = !0);
			setTimeout(function() {
				_restoreMenuUI()
			},
			300)
		})
	};
	_setMenuBreadcrumb = function(a, d) {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreMenuUI()
				}
			},
			{
				title: a
			}]
		});
		d && _handleBackButton()
	};
	var l = [{
		title: dmStr["ui.nee.menu.4"],
		type: "section",
		orderNum: 1,
		entries: []
	},
	{
		title: dmStr["ui.nee.menu.5"],
		type: "section",
		orderNum: 2,
		entries: []
	},
	{
		title: dmStr["ui.nee.menu.6"],
		type: "section",
		orderNum: 3,
		entries: []
	},
	{
		title: dmStr["ui.nee.menu.7"],
		type: "section",
		orderNum: 4,
		entries: []
	}];
	_handlemenuBuildYourOwn = function() {
		$(".slideRightPanelInner").hide();
		$(".menuBuild").show();
		a.find(".navEditorLinks").empty();
		$.dmx.current.element.attr("menu_data") ? (l = JSON.parse(Base64.decode($.dmx.current.element.attr("menu_data"))), $.dmx.current.element.attr("menu") && $.dmx.current.element.removeAttr("menu")) : $.dmx.current.element.attr("menu") && (l = JSON.parse($.dmx.current.element.attr("menu")), $.dmx.current.element.removeAttr("menu"));
		for (var d = 0,
		e = 0; e < l.length; e++)"" != l[e].title ? (l[e].orderNum = d + 1, d++) : (l.splice(e, 1), --e);
		for (var g = function() {
			return a.find(".navEditorLinks .navEditorLinkAndSub").length
		},
		d = 0; d < l.length; d++) e = a.find("#tabPlaceholder").clone(),
		e.removeAttr("id"),
		e.removeClass("displayNone"),
		e.find(".navLinkTitle").text(l[d].title),
		e.appendTo(a.find(".navEditorLinks")),
		e.attr("index", g() - 1);
		_updateDMMenuElement(l);
		a.find(".navEditorLinks").sortable({
			disabled: !1,
			cursor: 'url("/editor/nee/images/shell/closedhand.cur"), default',
			placeholder: "dmUi-state-highlight",
			forcePlaceholderSize: !0,
			tolerance: "pointer",
			toleranceElement: "\x3e div",
			handle: "div",
			items: "li",
			axis: "y",
			maxLevels: 0,
			tabSize: 1E3,
			update: function() {},
			stop: function() {
				for (var d = draggedElement.index(), e = parseInt(draggedElement.attr("index")), g = 0, j = 0; j < l.length; j++) if (l[j].orderNum == e + 1) {
					g = l[j].orderNum - 1;
					break
				}
				if (g != d) {
					d = [];
					for (j = 0; j < l.length; j++) d[j] = l[j].orderNum;
					e = a.find(".navEditorLinks li");
					for (g = 0; g <= e.length; g++) for (j = 0; j < l.length; j++) if (d[j] == parseInt($(e[g]).attr("index")) + 1) {
						l[j].orderNum = g + 1;
						break
					}
					_updateDMMenuElement(l);
					j = a.find(".navEditorLinks li");
					for (d = 0; d <= j.length; d++) $(j[d]).attr("index", d)
				}
			},
			start: function(a, d) {
				draggedElement = $(d.item).closest("li");
				$(".navLinkTitleInput").hide();
				$(".navLinkTitle").show()
			}
		});
		var j = function(a) {
			var d = a.parent().find(".navLinkTitleInput");
			d.val(a.text().trim());
			d.show();
			d.focus();
			a.hide()
		};
		a.find(".navLinkTitle").click(function() {
			j($(this))
		});
		var k = function(a) {
			var d = a.parent().find(".navLinkTitle");
			if (d.text().trim() != a.val().trim()) {
				for (var e = a.closest(".navEditorLinkAndSub").index(), g = 0, j = 0; j < l.length; j++) if (l[j].orderNum == e + 1) {
					g = j;
					break
				}
				l[g].title = a.val().trim().replace(/\\/g, "");
				d.text(a.val().trim());
				_updateDMMenuElement(l)
			}
			a.hide();
			d.show()
		};
		a.find(".navLinkTitleInput").blur(function() {
			k($(this))
		});
		a.find(".navLinkTitleInput").keypress(function(a) {
			13 == a.keyCode && k($(this))
		});
		a.find(".navEditorLinkAndSub").mouseover(function() {
			$(this).find(".navLinkButtonsWrapper").css("visibility", "visible");
			1 == g() ? $(this).find(".navLinkButtonHidden").hide() : $(this).find(".navLinkButtonHidden").show()
		});
		a.find(".navEditorLinkAndSub").mouseout(function() {
			$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
		});
		var m = function(a) {
			a = a.closest("li");
			for (var d = parseInt(a.attr("index")), e = 0, g = 0; g < l.length; g++) if (l[g].orderNum == d + 1) {
				e = g;
				break
			}
			l.splice(e, 1);
			_updateDMMenuElement(l);
			a.remove()
		},
		n = function(a) {
			$.dmx.current.editable.isCat = !0;
			$(".menuBuild").hide();
			$(".menuEditCategory").show().addClass("active");
			var d = a.closest("li");
			a = parseInt(d.attr("index"));
			var e = d.find(".navLinkTitle").text();
			$("#menuEditCatPutCatNAme").val(e);
			for (var g = 0,
			e = 0; e < l.length; e++) l[e].orderNum == a + 1 && (g = e);
			var j = function(a) {
				d.find(".navLinkTitle").text().trim() != a.val().trim() && (l[g].title = a.val().trim().replace(/\\/g, ""), _updateDMMenuElement(l))
			};
			$("#menuEditCatPutCatNAme").blur(function() {
				j($(this))
			});
			$("#menuEditCatPutCatNAme").keypress(function(a) {
				13 == a.keyCode && j($(this))
			});
			_getItemNumber = function() {
				return $(".menuEditCatTable").find("tr").length - 3
			};
			for (e = 0; e < l[g].entries.length; e++) a = $("#menuTablePlaceholder").clone(),
			a.removeAttr("id"),
			a.removeClass("displayNone"),
			a.find(".menuEditCategoryName").val(l[g].entries[e].title),
			a.find(".menuEditCategoryDescription").val(l[g].entries[e].desc),
			a.find(".menuEditCategoryPrice").val(l[g].entries[e].prices[0].price),
			a.appendTo(".menuEditCatTable"),
			a.attr("index", _getItemNumber()),
			a.find(".menuEditCategoryName").blur(function() {
				_updateItemInCat(0, $(this), !0)
			}),
			a.find(".menuEditCategoryName").keypress(function(a) {
				13 == a.keyCode && _updateItemInCat(0, $(this), !0)
			}),
			a.find(".menuEditCategoryDescription").blur(function() {
				_updateItemInCat(1, $(this), !0)
			}),
			a.find(".menuEditCategoryDescription").keypress(function(a) {
				13 == a.keyCode && _updateItemInCat(1, $(this), !0)
			}),
			a.find(".menuEditCategoryPrice").blur(function() {
				_updateItemInCat(2, $(this), !0)
			}),
			a.find(".menuEditCategoryPrice").keypress(function(a) {
				13 == a.keyCode && (_updateItemInCat(2, $(this), !0), $(this).blur(), $(".menuAddNewItem").trigger("click"))
			});
			$(".menuAddNewItem").unbind("click").click(function() {
				var a = $("#menuTablePlaceholder").clone();
				a.removeAttr("id");
				a.removeClass("displayNone");
				a.appendTo(".menuEditCatTable");
				a.attr("index", _getItemNumber());
				var d = _getItemNumber();
				l[g].entries[d] = {
					title: "",
					type: "item",
					orderNum: d,
					desc: "",
					prices: [{
						price: ""
					}]
				};
				_updateItemInCat = function(a, d, e) {
					var j = d.closest("tr").attr("index") - 0;
					0 == a ? l[g].entries[j].title = -1 != navigator.appVersion.indexOf("MSIE") ? "New Item" == d.val().trim() ? "": d.val().trim().replace(/\\/g, "") : d.val().trim().replace(/\\/g, "") : 1 == a ? l[g].entries[j].desc = d.val().trim().replace(/\\/g, "") : l[g].entries[j].prices[0].price = d.val().trim().replace(/\\/g, "");
					"" != l[g].entries[j].title && _updateDMMenuElement(l);
					if ("" == l[g].entries[j].title && "" == l[g].entries[j].desc && "" == l[g].entries[j].prices[0].price && e) {
						l[g].entries.remove(j, j);
						_updateDMMenuElement(l);
						$(d).closest("tr").remove();
						var k = 0;
						$(theTable).find("tbody  tr").each(function(a, d) {
							0 < a && ($(d).attr("index", k), k++)
						})
					}
				};
				a.find(".menuEditCategoryName").blur(function() {
					_updateItemInCat(0, $(this))
				});
				a.find(".menuEditCategoryName").keypress(function(a) {
					13 == a.keyCode && _updateItemInCat(0, $(this))
				});
				a.find(".menuEditCategoryDescription").blur(function() {
					_updateItemInCat(1, $(this))
				});
				a.find(".menuEditCategoryDescription").keypress(function(a) {
					13 == a.keyCode && _updateItemInCat(1, $(this))
				});
				a.find(".menuEditCategoryPrice").blur(function() {
					_updateItemInCat(2, $(this))
				});
				a.find(".menuEditCategoryPrice").keypress(function(a) {
					13 == a.keyCode && (_updateItemInCat(2, $(this)), $(this).blur(), $(".menuAddNewItem").trigger("click"))
				});
				a.find(".menuEditCategoryName").focus()
			});
			$(".menuAddNewItem").trigger("click")
		};
		$(".navLinkButtonHidden").click(function() {
			m($(this))
		});
		$(".navLinkButtonColor").click(function() {
			n($(this))
		});
		$(".menuAddNewCat").unbind("click").click(function() {
			var d = $("#tabPlaceholder").clone();
			d.removeAttr("id");
			d.removeClass("displayNone");
			d.find(".navLinkTitle").text("");
			d.appendTo(a.find(".navEditorLinks"));
			d.attr("index", g() - 1);
			d.find(".navLinkButtonColor").click(function() {
				n($(this))
			});
			d.find(".navLinkButtonHidden").click(function() {
				m($(this))
			});
			d.find(".navLinkTitle").click(function() {
				j($(this))
			});
			j(d.find(".navLinkTitle"));
			d.find(".navLinkTitleInput").blur(function() {
				k($(this))
			});
			d.find(".navLinkTitleInput").keypress(function(a) {
				13 == a.keyCode && k($(this))
			});
			$.each($._data(a.find(".navEditorLinkAndSub")[1], "events"),
			function() {
				$.each(this,
				function() {
					d.bind(this.type, this.handler)
				})
			});
			var e = g();
			l[e - 1] = {
				title: "",
				type: "section",
				orderNum: e,
				entries: []
			};
			a.find(".navLinkTitle:last").click()
		})
	};
	_menuFormatPhoneNumber = function() {
		$("#menuPhoneNumber").val(function(a, d) {
			return d = d.replace(/(\d{3})(\d{3})(\d{4})/, "$1-$2-$3")
		});
		return $("#menuPhoneNumber").val()
	};
	_isDynamicMenu = function() {};
	$("#menuPhoneNumber").bind("input propertychange",
	function() {
		this.value = this.value.replace(/[^0-9]/g, "")
	});
	_showSelectedMenuChosen = function() {
		$(".backButton").hide();
		$(".menuSearchSP").hide();
		$(".menuSearch").hide();
		$(".menuShowRestaurantTitle").text($.dmx.current.element.attr("businessname"));
		$("#menuFoundNotRightBuis").unbind("click").click(function() {
			_handlemenufindOnSP(!1)
		});
		$(".menuSearchSPShowResults").show();
		$(".menuSearchSPShowResults").removeClass("rest_locu").removeClass("rest_sp").addClass("rest_" + g())
	};
	_handleMenuResultList = function() {
		var a = $.dmx.current.element;
		$(".menuResultLine").unbind("click").click(function() {
			var d = $(this),
			e = {
				platform: d.attr("provider"),
				platform_id: d.attr("platform_id"),
				businessname: d.attr("businessname"),
				currency: a.attr("currency"),
				title: k
			};
			$.changePage({
				clientChange: function() {
					a.attr("platform", d.attr("provider"));
					a.attr("platform_id", d.attr("platform_id"));
					a.attr("businessname", d.attr("businessname"))
				},
				serverChange: function() {
					$.dmsrv.updateExtension(a, e, {
						successCallback: function() {
							$.dmx.preview.wnd().jQuery.DM.updateAfterInit();
							$.dmx.current.editable.placeholderTest()
						}
					})
				}
			});
			_showSelectedMenuChosen(d)
		})
	};
	_updateSPMenuElement = function() {
		var a = $.dmx.current.element,
		d = a.attr("platform_id"),
		e = a.attr("platform"),
		g = a.attr("businessname"),
		j = {
			platform_id: d,
			platform: e,
			currency: a.attr("currency"),
			title: k,
			businessname: g
		};
		$.changePage({
			clientChange: function() {
				a.attr("platform_id", d);
				a.attr("platform", e);
				a.attr("businessname", g);
				a.attr("currency")
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, j)
			}
		})
	};
	_updateDMMenuElement = function(a, d, e) {
		a.sort(function(a, d) {
			return a.orderNum - d.orderNum
		});
		var g = $.dmx.current.element,
		j = {
			menu_data: Base64.encode(JSON.stringify(a)),
			platform: "dm",
			currency: g.attr("currency"),
			title: k
		};
		$.changePage({
			clientChange: function() {
				g.attr("menu_data", a);
				g.attr("platform", "dm")
			},
			serverChange: function() {
				$.dmsrv.updateExtension(g, j, {
					successCallback: function() {
						$.dmx.current.editable.placeholderTest();
						NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initMenusArrows({
							isOpenAll: !0,
							elem: $.dmx.current.element
						});
						e && e();
						$.dmops.redrawSelection()
					}
				})
			}
		});
		d && d()
	};
	_handleUploadCSV = function() {
		$("#menuFile").on("change",
		function(a) {
			a = a.target.files[0];
			var d = $.Deferred();
			$.convertUtils.formats.csvFileToJson(a, {
				noHeaderRow: !0,
				success: function(a) {
					var e = [],
					g,
					j,
					k,
					l,
					m,
					n,
					o;
					for (g = 0; g < a.jsonObj.length; g++) {
						j = a.jsonObj[g];
						k = 0 < j.length ? j[0] : "";
						l = 1 < j.length ? j[1] : "";
						m = 2 < j.length ? j[2] : "";
						n = 3 < j.length ? j[3] : "";
						o = null;
						for (j = 0; j < e.length; j++) if (e[j].title === k) {
							o = e[j];
							break
						}
						o || (o = {
							title: k,
							entries: [],
							prices: [{
								price: ""
							}],
							orderNum: e.length + 1,
							type: "section"
						},
						e.push(o));
						o.entries.push({
							title: l,
							desc: m,
							prices: [{
								price: n
							}],
							type: "item",
							orderNum: o.entries.length
						})
					}
					d.resolve(e)
				},
				error: function(a) {
					d.reject(a)
				}
			});
			d.promise().done(function(a) {
				_updateDMMenuElement(a, null,
				function() {
					_setMenuBreadcrumb(dmStr["ui.nee.menu.33"], !0);
					_handlemenuBuildYourOwn()
				})
			}).fail(function(a) {
				a && a.nocsv && ($.dmfw.showValidationError($(".uploadCSVFile"), "Please select a CSV file"), setTimeout(function() {
					$(".ui-tooltip-dm-error").fadeOut()
				},
				2500))
			})
		});
		$(".ui-tooltip-dm-error").remove();
		$("#menuFile").trigger("click")
	};
	_handlemenufindOnSP = function(a) {
		var e = !1;
		a && (d && d.force) && (d.force = !1, $.dmx.current.element.attr("platform_id") && (e = !0));
		e ? _showSelectedMenuChosen(null, !0) : ($(".menuDisplayResults").hide(), $(".menuSearchSPShowResults").hide(), $(".menuSearch").hide(), $(".menuSearchSP").show(), null == $.dmx.site.phoneNumbers ? $.dmGet({
			url: "/sites/" + $.dmx.site.id + "/foundphonenumbers",
			success: function(a) {
				a.list && ($.dmx.site.phoneNumbers = a.list, a.list[0] && ($("#menuPhoneNumber").val(a.list[0]), $("#menuPhoneNumber").trigger("keyup"), _menuFormatPhoneNumber()))
			}
		}) : $.dmx.site.phoneNumbers[0] && ($("#menuPhoneNumber").val($.dmx.site.phoneNumbers[0]), $("#menuPhoneNumber").trigger("keyup"), _menuFormatPhoneNumber()), $("#menuDoSearch").unbind("click").click(function() {
			var a = $("#menuPhoneNumber").val(),
			d = $("#menuBusinessName").val();
			if ("" != a || "" != d) a = _menuFormatPhoneNumber(),
			$.dmLoading($("#_editor")),
			$.dmGet({
				url: "/sites/" + $.dmx.site.id + "/searchmenuforbusiness/?phone\x3d" + a + "\x26name\x3d" + d + "\x26limit\x3d20",
				success: function(a) {
					var d;
					$(".menuDisplayResults").hide();
					$("#menuSearchResuults").hide();
					$("#menuNoSearchResaults").hide();
					$.dmUnblockUI();
					if (0 != a.length) {
						$("#menuSearchResuults").empty();
						d = $(".menuResultsHeader");
						0 === d.length && (d = $("\x3cdiv class\x3d'menuResultsHeader'\x3e\x3c/div\x3e"), $("#menuSearchResuults").append(d));
						d.empty();
						d.html(dmStr["ui.nee.menu.1002.a"].replace("%s", a.length));
						for (d = 0; d < a.length; d++) if (a[d]) {
							var e = a[d].businessName,
							g = a[d].address,
							j = "sp" == a[d].source ? "/editor/nee/images/common/Single_logo.png": "/editor/nee/images/common/Locu_logo.png",
							e = "\x3cdiv class\x3d'menuResultLine' businessname\x3d'{{data[i].businessName}}' platform_id\x3d'{{data[i].id}}' provider\x3d'{{data[i].source}}'\x3e\x3cdiv class\x3d'menuResultLineInnerResult'\x3e{{tmpName}}\x3cdiv class\x3d'menuResultLineAddress'\x3e{{tmpAdrs}}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'menuResultLineInnerLogo'\x3e\x3cimg class\x3d'menuResultLineInnerLogoImg' src\x3d'{{logo-src}}'/\x3e\x3c/div\x3e\x3c/div\x3e".replace("{{data[i].businessName}}", a[d].businessName || "").replace("{{data[i].id}}", a[d].id || "").replace("{{data[i].source}}", a[d].source || "").replace("{{tmpName}}", e || "").replace("{{tmpAdrs}}", g || "").replace("{{logo-src}}", j),
							e = $(e);
							$("#menuSearchResuults").append(e);
							_handleMenuResultList(e)
						}
						$("#menuSearchResuults").show();
						$.dmx.current.editable.placeholderTest()
					} else $(".menuDisplayResults").find("#menuNoSearchResaults").show(),
					$("#signUpSinPlat").neePopUpDiv($("#menuSignUpSinPlatPop"), {
						init: function() {
							$("#popUpMailField").focus();
							var a = {
								mailType: "SINGLE_PLATFORM_SIGNUP",
								msg: $("#menuMailMessageSpace"),
								input: $("#popUpMailField"),
								sendBtn: $("#menuSPSendMail")
							};
							$.dmops.sendSiteAddressMail(a)
						}
					}),
					$("#signUpLocu").neePopUpDiv($("#menuSignUpLocuPop"), {
						init: function() {
							$("#popUpMailFieldLocu").focus();
							var a = {
								mailType: "LOCU_SIGNUP",
								msg: $("#menuMailMessageSpaceLocu"),
								input: $("#popUpMailFieldLocu"),
								sendBtn: $("#menuSPSendMailLocu")
							};
							$.dmops.sendSiteAddressMail(a)
						}
					}),
					$("#buildYourOwn").unbind("click").click(function() {
						$(".menuBuildYourOwn").trigger("click")
					});
					$(".menuDisplayResults").show();
					$.dmx.current.editable.placeholderTest()
				}
			})
		}), $("#menuPhoneNumber").keypress(function(a) {
			13 == a.keyCode && ($(this).blur(), $("#menuDoSearch").trigger("click"))
		}), $("#menuBusinessName").keypress(function(a) {
			13 == a.keyCode && ($(this).blur(), $("#menuDoSearch").trigger("click"))
		}))
	};
	var m = $.dmx.current.element.attr("platform"),
	n = $.dmx.current.element.attr("platform_id"),
	o = "dm";
	"sp" == m && (o = "sp");
	"locu" == m && (o = "locu");
	_updateHeader = function() {
		var a = $.dmx.current.element,
		d = $("#generalTitleInput").val().trim(),
		e = a.attr("title") ? a.attr("title") : "",
		g = null,
		g = "" == d ? !1 : !0;
		if (d != e.trim()) {
			k = d;
			var j = {
				title: d,
				forcedisplay: !0,
				platform: o,
				platform_id: n,
				currency: a.attr("currency"),
				displaytitle: g
			};
			$.changePage({
				clientChange: function() {
					a.attr("title", d);
					a.attr("forcedisplay", !0);
					a.attr("displaytitle", g)
				},
				serverChange: function() {
					$.dmsrv.updateExtension(a, j, {
						successCallback: function() {
							NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initMenusArrows({
								isOpenAll: !0,
								elem: $.dmx.current.element
							});
							$.dmops.redrawSelection()
						}
					})
				}
			})
		}
	};
	_toggleTitle = function() {
		var a = $.dmx.current.element,
		d = "true" == a.attr("displaytitle") ? "false": "true",
		e = $("#generalTitleInput").val().trim();
		if (!0 == $.dmx.site.isFromScratch) {
			var g = $.dmx.current.element.find(".dmwidget-title");
			"none" == g.css("display") || 0 == g.length ? currentGLElement().displayTitle = !0 : currentGLElement().displayTitle = !1
		}
		var j = {
			title: e,
			platform: o,
			platform_id: n,
			currency: a.attr("currency"),
			displaytitle: d,
			forcedisplay: !0
		};
		$.changePage({
			clientChange: function() {
				a.attr("displaytitle", d)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, j, {
					successCallback: function() {
						NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initMenusArrows({
							isOpenAll: !0,
							elem: $.dmx.current.element
						});
						$.dmops.redrawSelection()
					}
				})
			}
		})
	};
	$(".menuBuildYourOwn").unbind("click").click(function() {
		_setMenuBreadcrumb(dmStr["ui.nee.menu.33"], !0);
		_handlemenuBuildYourOwn()
	});
	$("#helpContentDiv").hide();
	3 != dm_account_locale && ($(".uploadCSVFile").unbind("mouseover.showhelp").bind("mouseover.showhelp",
	function() {
		$("#helpContentDiv").fadeIn(400)
	}), $(".uploadCSVFile").unbind("mouseleave.showhelp").bind("mouseleave.showhelp",
	function() {
		$("#helpContentDiv").fadeOut(400)
	}));
	$(".uploadCSVFile").unbind("click").click(function() {
		_handleUploadCSV()
	});
	$.dmfw.isPT() || $(".uploadCSVFile").hide();
	$(".menufindOnSP").unbind("click").click(function() {
		_setMenuBreadcrumb(dmStr["ui.nee.menu.34"]);
		_handlemenufindOnSP(!0)
	});
	e = e || g();
	"sp" == e || "locu" == e ? $(".menufindOnSP").trigger("click") : "dm" == e && $(".menuBuildYourOwn").trigger("click");
	var r = $.dmx.current.element;
	$(".currencySymbol , .currencySymbolSp").val(r.attr("currency"));
	e = $(".currencySymbol").off("change").on("change",
	function() {
		r.attr("currency", $(this).val());
		l = JSON.parse(Base64.decode($.dmx.current.element.attr("menu_data")));
		_updateDMMenuElement(l)
	}).add($(".currencySymbolSp").off("change").on("change",
	function() {
		r.attr("currency", $(this).val());
		_updateSPMenuElement()
	}));
	this.enhanceSelectBoxed(e);
	0 < $.dmfw.getPreviewElement(".innerBar").length && $.dmx.current.element.hasClass("dmPageWidget") && $(".menuDescriptionTitle").hide()
};NEEMenu.prototype.enhanceSelectBoxed = function() {};NEEMenu.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEMenu.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorMenuSelected")
};NEEMenu.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorMenuSelected"), this.disableEditInline())
};NEEMenu.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEMenu.prototype.getElementTagsSelectors = function() {
	return ".dmRestaurantMenu,  .dmRestaurantMenu *"
};NEEMenu.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEMenu.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmRestaurantMenu")
};NEEMenu.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEMenu.prototype.disableEditInline = function() {};NEEMenu.prototype.docReady = function() {
	$.dmfw.preview.testAndSetPlaceholder(".dmRestaurantMenu UL", "dmMenuPlaceholder")
};NEEMenu.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.getTabs()
	})
};NEEMenu.prototype.checkClose = function() {
	var a = $("input.menuEditCategoryPrice:visible"),
	e = 0 < a.length,
	d = 0 === $("#generalTitleInput:visible").length && 0 === $("#menuPhoneNumber:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		for (var d = {
			adjustX: 5,
			adjustY: 0,
			maxWidth: "150"
		},
		e = "div.menuHeader", k = $("#menuPhoneNumber:visible"), l = $("#menuBusinessName:visible"), m = "ui.nee.promptMassages.6", n = $.dmx.current.element, n = "undefined" === typeof n.attr("menu_data") && "dm" === n.attr("platform") || 0 !== $("#generalTitleInput:visible").length || 0 !== $("#menuPhoneNumber:visible").length, o = 0; o < a.length; o++) {
			var r = a.eq(o),
			u = parseInt(r.val());
			if (! (/^[1-9][0-9]{0,}\.{0,1}[0-9]{0,}?$/.test(u) || "" === r.val())) {
				e = r;
				n = !0;
				m = "ui.nee.resturant.priceError";
				break
			}
		}
		NEFW.PREVIEW.get(0).contentWindow.jQuery.DM.initMenusArrows();
		if (n) {
			if (0 < k.length || 0 < l.length) d.at = "bottom center",
			d.my = "top center",
			d.adjustX = -25,
			d.adjustY = 5,
			m = "ui.nee.promptMassages.17",
			"" === k.val() && "" === l.val() ? e = ".menuSearchSP": ($("#menuDoSearch").trigger("click"), e = "");
			$.dmfw.showPromptError($(e), dmStr[m], d)
		} else $.dmfw._closeEditorAll({
			override: !0
		})
	},
	d, e)
};NEEMenu.prototype.genericUpdateTitle = function() {
	_updateHeader()
};NEEMenu.prototype.updateToggleTitle = function() {
	_toggleTitle()
};NEEMenu.prototype.getTabs = function() {
	var a = this;
	return {
		type: [{
			url: this.getMarkupUrl(),
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				a.MenuOnTabReadyGeneral(e, null, {
					force: !0
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.menu.2"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(e).neeSecondaryDesignTabs(a.getTitleDesignTabsOptions())
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.menu.3"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(e).neeSecondaryDesignTabs(a.getItemDesignTabsOptions())
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
};NEEMenu.prototype.getMarkupUrl = function() {
	return "/editor/nee/editableObjects/restaurantMenu/nee.restaurantMenuSearch.jsp"
};NEEMenu.prototype.getSelectors = function() {
	return {
		category: "LI.menuCategory",
		categoryTitle: "LI.menuCategory span:not(.menuCatArrow)",
		itemName: "LI.menuItemBox .menuItemName",
		itemDesc: ".menuItemDesc",
		itemPrice: "LI.menuItemBox .menuItemPrice",
		itemBox: "LI.menuItemBox"
	}
};NEEMenu.prototype.getTitleDesignTabsOptions = function() {
	var a = this.getSelectors();
	return {
		textSelector: a.categoryTitle,
		tabs: {
			color: ["text", "background", "menu_divider_style"],
			text_style: []
		},
		specForceClassName: {
			text: a.categoryTitle,
			background: a.category,
			backgroundBg: a.category,
			menu_divider_style: a.category
		}
	}
};NEEMenu.prototype.getItemDesignTabsOptions = function() {
	var a = this.getSelectors();
	return {
		textSelector: [a.itemName, a.itemDesc, a.itemPrice].join(", "),
		tabs: {
			color: ["menu_name", "menu_desc", "background", "menu_divider_style"],
			text_style: []
		},
		specForceClassName: {
			menu_name: [a.itemName, a.itemPrice].join(", "),
			menu_desc: a.itemDesc,
			background: a.itemBox,
			backgroundBg: a.itemBox,
			menu_divider_style: a.box
		}
	}
};NEEMenu.prototype.placeholderTest = function() {
	$.dmfw.preview.testAndSetPlaceholder(".dmRestaurantMenu UL", "dmMenuPlaceholder")
};
function NEEHoursOfOperation() {
	this.title = function() {
		return dmStr["ui.nee.hop.1"]
	};
	this.isExtension = !0;
	this.mindTouchId = "dmMtBusinessHours";
	this.showMindTouchHelp = !0;
	this.DAYMODE = {
		HOURS: 1,
		SPLIT_HOURS: 2,
		CLOSE: 3,
		OPEN_ALL_DAY: 4,
		APPOINTMENT_ONLY: 5
	};
	this.DAY_DEFUALT_HOURS = {
		HOURS: {
			START: "08:00 AM",
			END: "05:00 PM"
		},
		SPLIT_HOURS: {
			START_MORNING: "08:00 AM",
			END_MORNING: "12:00 PM",
			START_NOON: "13:00 PM",
			END_NOON: "17:00 PM"
		}
	};
	this.WEEK_FIRST_DAY = {
		MONDAY: 0,
		SATURDAY: 5,
		SUNDAY: 6
	};
	this.PANELS_ID = {
		mainPanel: "#mainSlider",
		buildYOurOwn: "#openHoursBuild",
		holydays: "#holydaysWarper",
		searchSP: "#searchHoursSP",
		selectedPlatform: "#selectedPlatform"
	};
	this.currentPanel = this.PANELS_ID.mainPanel;
	this.DISPLAY_OPTIONS = {
		BANNER_N_HOURS: 0,
		BANNER_ONLY: 1,
		HOURS_ONLY: 2
	};
	this.ext = {
		id: "open_hours",
		preId: "hoursofoperation",
		defaults: {
			needs_premium_validation: !0,
			wr: !0,
			platform: "dm",
			timezone: "",
			hours_data: null,
			display_option: 2,
			holyday_data: null,
			week_first_day: this.WEEK_FIRST_DAY.MONDAY,
			merge_days_display_runtime: !0,
			close_day_label: dmStr["ui.nee.hop.47"],
			bizname: "",
			banner_open: dmStr["ui.nee.hop.81"],
			banner_closed: dmStr["ui.nee.hop.80"],
			displaytitle: !0
		}
	};
	this.currentValues = {
		timezone: "",
		hours_data: {},
		display_option: 2,
		holyday_data: null,
		platform: "dm",
		platform_id: null,
		week_first_day: this.WEEK_FIRST_DAY.MONDAY,
		merge_days_display_runtime: !0,
		close_day_label: dmStr["ui.nee.hop.47"],
		bizname: "",
		displaytitle: !0
	};
	this.searchResultTemplate = this.holydayTemplate = null;
	this.isCat = this.isInner = this.restoreUIFlag = this.FindSPAlreadyInit = this.HolydayAlreadyInit = this.needToRebuildHours = this.alreadyInit = !1;
	this.priority = 1;
	this.type = "hoursofoperation";
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/openHours.png",
			editableDraggedText: dmStr["ui.nee.hop.1"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.hop.1"]
	};
	this.editorDesc = "Display your opening hours to customers.";
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.addClearWidget = !1;
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/hoursOfOperation/nee.hoursOfOperation.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				a.resetCurrentValues();
				a.NEEHoursOfOperationOnTabReadyGeneral(e, null, {
					force: !0
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$.dmfw.isPT() ? $(a).neePtSecondaryDesignTabs({
					selector: "",
					textColorList: ["text"],
					textSelector: "H3.dmwidget-title, *.open-hours-item dt, *.open-hours-item dd , *.open-hours-item time",
					tabs: {
						tab_colors: ["background", "border"],
						tab_effects: ["eff_shadow", "eff_rounded_corners"],
						tab_text_style: ["text_general", "text_color"]
					}
				}) : $(a).neeSecondaryDesignTabs({
					selector: "",
					textSelector: "H3.dmwidget-title, *.open-hours-item dt, *.open-hours-item dd , *.open-hours-item time",
					tabs: {
						color: ["background", "border", "text"],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEHoursOfOperation.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEHoursOfOperation.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEHoursOfOperation.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorHoursOfOperationSelected")
};NEEHoursOfOperation.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorHoursOfOperationSelected"), this.disableEditInline())
};NEEHoursOfOperation.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEHoursOfOperation.prototype.getElementTagsSelectors = function() {
	return ".dmHoursOfOperation,  .dmHoursOfOperation *"
};NEEHoursOfOperation.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEHoursOfOperation.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmHoursOfOperation")
};NEEHoursOfOperation.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e); ! $.dmfw.isPT() && !$.dmfw.isDudaone() && (d.isEdit = !1);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEHoursOfOperation.prototype.disableEditInline = function() {};NEEHoursOfOperation.prototype.docReady = function() {
	$.dmfw.preview.testAndSetPlaceholder(".dmHoursOfOperation UL", "dmHoursOfOperationPlaceholder")
};NEEHoursOfOperation.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEEHoursOfOperation.prototype.initBuildYourOwnDays = function() {
	var a = $(".HopDayHours .hoursSlide"),
	e = null,
	d;
	for (d in this.currentValues.hours_data) {
		var g = parseInt(d),
		j = $(a[g]).find("input[name^\x3ddays]"),
		k;
		for (k in this.currentValues.hours_data[d]) switch (e = this.currentValues.hours_data[d][k], k) {
		case "dayMode":
			$(a[g]).attr("data-daymode", e);
			switch (e) {
			case this.DAYMODE.HOURS:
				$(a[g]).find(".leftController").css("visibility", "hidden");
				break;
			case this.DAYMODE.APPOINTMENT_ONLY:
				$(a[g]).find(".rightController").css("visibility", "hidden")
			}
			break;
		case "startTime":
			$(j[0]).val(e);
			break;
		case "endTime":
			$(j[1]).val(e);
			break;
		case "splitDay":
			$(j[2]).val(e.START_MORNING),
			$(j[3]).val(e.END_MORNING),
			$(j[4]).val(e.START_NOON),
			$(j[5]).val(e.END_NOON)
		}
	}
};NEEHoursOfOperation.prototype.initHoursSlide = function() {
	var a = this;
	require(["neeUtils/timePicker/jquery.timePicker", "neeUtils/lib/slides/slides.jquery"],
	function() {
		var e = {
			preload: !1,
			generateNextPrev: !1,
			pagination: !1,
			generatePagination: !1,
			start: 0,
			next: "rightController",
			prev: "leftController",
			animationComplete: function(d, e) {
				$(e).attr("data-daymode", d);
				switch (d) {
				case a.DAYMODE.HOURS:
					$(e).find(".leftController").css("visibility", "hidden");
					$(e).find(".rightController").css("visibility", "visible");
					break;
				case a.DAYMODE.OPEN_ALL_DAY:
				case a.DAYMODE.CLOSE:
				case a.DAYMODE.SPLIT_HOURS:
					$(e).find(".rightController").css("visibility", "visible");
					$(e).find(".leftController").css("visibility", "visible");
					break;
				case a.DAYMODE.APPOINTMENT_ONLY:
					$(e).find(".rightController").css("visibility", "hidden"),
					$(e).find(".leftController").css("visibility", "visible")
				} ! 1 == $.dmx.editor.valid && ($.dmx.editor.setValid(!0), a.disableBackBtn(!1), $(".ui-tooltip-dm-error").remove());
				a.updatePreview.updateDays(a, e)
			}
		};
		$(".timePicker").timePicker({
			show24Hours: !1
		});
		$(".hoursSlide").each(function(d, g) {
			e.start = $(g).data("daymode");
			$(g).slides(e);
			switch ($(g).data("daymode")) {
			case a.DAYMODE.HOURS:
				$(g).find(".leftController").css("visibility", "hidden");
				$(g).find(".rightController").css("visibility", "visible");
				break;
			case a.DAYMODE.CLOSE:
			case a.DAYMODE.OPEN_ALL_DAY:
			case a.DAYMODE.SPLIT_HOURS:
				$(g).find(".rightController").css("visibility", "visible");
				$(g).find(".leftController").css("visibility", "visible");
				break;
			case a.DAYMODE.APPOINTMENT_ONLY:
				$(g).find(".rightController").css("visibility", "hidden"),
				$(g).find(".leftController").css("visibility", "visible")
			}
		});
		$("#daysLines .timePicker").on("change.hourofoperation",
		function() {
			a.updatePreview.updateDays(a, $(this).parents("div.hoursSlide"))
		})
	})
};NEEHoursOfOperation.prototype.initBuildYourOwn = function() {
	this.initBuildYourOwnDays();
	if (this.currentValues.week_first_day !== this.ext.defaults.week_first_day) {
		var a = this.currentValues.week_first_day;
		$("#weekStartDay").val(this.currentValues.week_first_day);
		this.sortDayHours(this, a, !1)
	}
	0 !== this.currentValues.display_option && $("#displayOption").val(this.currentValues.display_option);
	"true" !== this.currentValues.merge_days_display_runtime && $("#mergeDaysDisplayRuntime").removeAttr("checked");
	this.initHoursSlide()
};NEEHoursOfOperation.prototype.initWidgetApearance = function() {
	switch (this.currentValues.platform) {
	case "dm":
		var a = $.dmx.current.element;
		"" !== this.currentValues.timezone && "" !== $(a).attr("timezone") && this.setPanelState(this.PANELS_ID.buildYOurOwn, !0);
		break;
	default:
		this.setPanelState(this.PANELS_ID.selectedPlatform, !0)
	}
};NEEHoursOfOperation.prototype.initData = function() {
	function a(a, e) {
		for (var j = $("#DropDownTimezone").children("option"), k = !1, l = 0, m = null, n = null; ! 1 == k && l < j.length - 1;) m = $("#DropDownTimezone").children("option")[l],
		n = $(m).attr("value"),
		hourValue = n.split("_"),
		hourValue[0] == a && ($(m).attr("selected", "selected"), e.currentValues.timezone = n, k = !0),
		l++
	}
	var e = $.dmx.current.element;
	$(e).attr("title") && (this.currentValues.title = $(e).attr("title"), $("#headerTextDesc").val(this.currentValues.title));
	"" !== $(e).attr("timezone") && $(e).attr("timezone") ? -1 == $(e).attr("timezone").indexOf("_") ? a($(e).attr("timezone"), this) : this.currentValues.timezone = $(e).attr("timezone") : a($.getClientTimeZone(), this);
	$("#DropDownTimezone").val(this.currentValues.timezone);
	$(e).attr("platform") && (this.currentValues.platform = $(e).attr("platform"));
	$(e).attr("platform_id") && (this.currentValues.platform_id = $(e).attr("platform_id"));
	$(e).attr("hours_data") && (this.currentValues.hours_data = JSON.parse(Base64.decode($(e).attr("hours_data"))));
	$(e).attr("holyday_data") && (this.currentValues.holyday_data = JSON.parse(Base64.decode($(e).attr("holyday_data"))));
	$(e).attr("week_first_day") && (this.currentValues.week_first_day = $(e).attr("week_first_day"));
	$(e).attr("merge_days_display_runtime") && (this.currentValues.merge_days_display_runtime = $(e).attr("merge_days_display_runtime"));
	$(e).attr("bizname") && (this.currentValues.bizname = $(e).attr("bizname"));
	$(e).attr("displaytitle") && (this.currentValues.displaytitle = "true" === $(e).attr("displaytitle"));
	this.initWidgetApearance()
};NEEHoursOfOperation.prototype.updatePreview = {
	ERRORS_MSG: {
		MISS_VALUE: dmStr["ui.nee.hop.60"],
		END_HOUR_SMALLER: dmStr["ui.nee.hop.61"],
		TIME_MISMATCH: dmStr["ui.nee.hop.62"],
		INVALID_TIME: dmStr["ui.nee.hop.63"],
		TIME_EQUAL: dmStr["ui.nee.hop.64"]
	},
	updateData: function(a) {
		var e = null,
		d = null,
		g = {
			successCallback: function() {
				var d = $.dmx.current.element;
				$(d).attr("hours_data") && (a.currentValues.hours_data = JSON.parse(Base64.decode($(d).attr("hours_data"))));
				$.dmops.redrawSelection()
			}
		},
		e = Base64.encode(JSON.stringify(a.currentValues.hours_data)),
		d = Base64.encode(JSON.stringify(a.currentValues.holyday_data)),
		j = $.dmx.current.element,
		k = {
			title: a.currentValues.title,
			platform: a.currentValues.platform,
			platform_id: a.currentValues.platform_id,
			display_option: 2,
			timezone: a.currentValues.timezone,
			close_day_label: a.currentValues.close_day_label,
			hours_data: e,
			holyday_data: d,
			week_first_day: a.currentValues.week_first_day,
			merge_days_display_runtime: a.currentValues.merge_days_display_runtime,
			bizname: a.currentValues.bizname,
			displaytitle: a.currentValues.displaytitle
		};
		$.changePage({
			clientChange: function() {
				j.attr("title", a.currentValues.title);
				j.attr("platform", a.currentValues.platform);
				j.attr("platform", a.currentValues.platform_id);
				j.attr("display_option", a.currentValues.display_option);
				j.attr("timezone", a.currentValues.timezone);
				j.attr("close_day_label", a.currentValues.close_day_label);
				j.attr("hours_data", e);
				j.attr("holyday_data", d);
				j.attr("week_first_day", a.currentValues.week_first_day);
				j.attr("merge_days_display_runtime", a.currentValues.merge_days_display_runtime);
				j.attr("displaytitle", a.currentValues.displaytitle)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(j, k, g)
			}
		})
	},
	updateHeader: function(a, e) {
		var d = $.dmx.current.element,
		g = null,
		g = "" == e ? !1 : !0;
		e != $(d).find(".dmwidget-title").text().trim() && (a.currentValues.title = e, a.currentValues.forceDisplay = !0, a.currentValues.displaytitle = g, this.updateData(a))
	},
	toggleTitle: function(a) {
		a.currentValues.displaytitle = "true" == a.currentValues.displaytitle || a.currentValues.displaytitle ? !1 : !0;
		if (!0 == $.dmx.site.isFromScratch) {
			var e = $.dmx.current.element.find(".dmwidget-title");
			a.currentValues.displaytitle = "none" == e.css("display") || 0 == e.length ? !0 : !1
		}
		a.currentValues.forceDisplay = !0;
		this.updateData(a)
	},
	updateDisplayOption: function(a) {
		a.currentValues.display_option = $("#displayOption").val();
		a.currentValues.platform = "dm";
		this.updateData(a)
	},
	updateTimeZone: function(a) {
		a.currentValues.timezone = $("#DropDownTimezone").val();
		a.currentValues.platform = "dm";
		this.updateData(a)
	},
	updatecloseDayLabel: function(a, e) {
		a.currentValues.close_day_label = e;
		a.currentValues.platform = "dm";
		this.updateData(a)
	},
	updateDays: function(a, e) {
		var d = this;
		a.currentValues.platform = "dm";
		var g = this,
		j = !0,
		k = null,
		l = null,
		m = null,
		n = null,
		o = null,
		l = $(e).attr("data-day"),
		m = $(e).attr("data-daymode"),
		k = a.currentValues.hours_data[l];
		k.dayMode = m;
		n = $(e).find("div.hoursWarper");
		$(n).each(function(a, d) {
			switch (a) {
			case 0:
				o = $(d).find("input");
				k.startTime = $(o[0]).val();
				k.endTime = $(o[1]).val();
				break;
			case 1:
				o = $(d).find("input"),
				k.splitDay.START_MORNING = $(o[0]).val(),
				k.splitDay.END_MORNING = $(o[1]).val(),
				k.splitDay.START_NOON = $(o[2]).val(),
				k.splitDay.END_NOON = $(o[3]).val()
			}
		});
		require(["neeUtils/lib/moment/moment"],
		function() {
			m == a.DAYMODE.HOURS && (j = function() {
				var g = moment(k.startTime, "hh-mm a"),
				j = moment(k.endTime, "hh-mm a");
				if (!1 == g.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'startTime']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (!1 == j.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (g.unix() == j.unix()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime']")), d.ERRORS_MSG.TIME_EQUAL),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				a.disableBackBtn(!1);
				$.dmx.editor.setValid(!0);
				return ! 0
			} ());
			m == a.DAYMODE.SPLIT_HOURS && (j = function() {
				var g = moment(k.splitDay.START_MORNING, "hh-mm a"),
				j = moment(k.splitDay.END_MORNING, "hh-mm a"),
				l = moment(k.splitDay.START_NOON, "hh-mm a"),
				m = moment(k.splitDay.END_NOON, "hh-mm a");
				if (!1 == g.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'startTime_1']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (!1 == j.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_1']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (!1 == l.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'startTime_2']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (!1 == m.isValid()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_2']")), d.ERRORS_MSG.INVALID_TIME),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (g.unix() > j.unix() && "12:00 AM" !== k.splitDay.END_MORNING.toUpperCase() && "12:00AM" !== k.splitDay.END_MORNING.toUpperCase()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_1']")), d.ERRORS_MSG.END_HOUR_SMALLER),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (l.unix() > m.unix() && "12:00 AM" !== k.splitDay.END_NOON.toUpperCase() && "12:00AM" !== k.splitDay.END_NOON.toUpperCase()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_2']")), d.ERRORS_MSG.END_HOUR_SMALLER),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (j.unix() > l.unix()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'startTime_2']")), d.ERRORS_MSG.TIME_MISMATCH),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (g.unix() == j.unix()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_1']")), d.ERRORS_MSG.TIME_EQUAL),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				if (l.unix() == m.unix()) return $.dmfw.showValidationError($(e.find("input[data-time\x3d'endTime_2']")), d.ERRORS_MSG.TIME_EQUAL),
				$.dmx.editor.setValid(!1),
				a.disableBackBtn(!0),
				!1;
				$.dmx.editor.setValid(!0);
				a.disableBackBtn(!1);
				return ! 0
			} ());
			m == a.DAYMODE.OPEN_ALL_DAY && (k.customText = $(e).find(".openAllDay").find("input").val());
			m == a.DAYMODE.APPOINTMENT_ONLY && (k.customText = $(e).find(".appointmentOnly").find("input").val());
			a.currentValues.hours_data[l] = k; ! 0 == j && g.updateData(a)
		})
	},
	updateHolydays: function(a, e, d) {
		var g = this;
		a.currentValues.platform = "dm";
		var j = this;
		if (! (null == a.currentValues.holyday_data && d)) {
			var k = [],
			l = null,
			l = function() {
				$("#holydaysWarper .holydayLine").each(function(a, d) {
					var e = {};
					e.desc = $(d).find(".holydayDesc").val();
					e.date = $(d).find(".holydayDate").val();
					e.fullDay = "1" == $(d).attr("data-daymode") ? "true": "false";
					e.startTime = $(d).find(".holydayStartTime").val();
					e.endTime = $(d).find(".holydayEndTime").val();
					k.push(e)
				});
				a.currentValues.holyday_data = k;
				j.updateData(a)
			};
			if (!0 !== d) {
				d = $(e).find(".holydayDesc").val();
				var m = $(e).find(".holydayDate").val(),
				n = !0,
				o = $(e).find(".holydayStartTime").val(),
				r = $(e).find(".holydayEndTime").val();
				"2" == $(e).attr("data-daymode") && (n = !1);
				"" == d || "" == m || !1 == n && ("" == o || "" == r) || require(["neeUtils/lib/moment/moment"],
				function() {
					if (!1 == moment(m, ["MM-DD-YYYY"]).isValid()) $.dmfw.showValidationError($(e).find(".holydayDate"), dmStr["ui.nee.hop.48"]),
					$.dmx.editor.setValid(!1),
					a.disableBackBtn(!0);
					else {
						if (!1 == n) {
							var d = $.timeValidate(o),
							j = $.timeValidate(r);
							if (!1 == d.timeValid) {
								$.dmfw.showValidationError($(e).find(".holydayStartTime"), d.msg);
								$.dmx.editor.setValid(!1);
								a.disableBackBtn(!0);
								return
							}
							if (!1 == j.timeValid) {
								$.dmfw.showValidationError($(e).find(".holydayEndTime"), j.msg);
								$.dmx.editor.setValid(!1);
								a.disableBackBtn(!0);
								return
							}
							j = function(a) {
								var d = a.substr(a.length - 2).toLowerCase(),
								e = a.substr(0, a.indexOf(":"));
								a = a.substring(a.indexOf(":") + 1, a.indexOf(" "));
								"pm" == d && 12 != e && (e = 1 * e + 12);
								return e + ":" + a
							};
							d = j(o);
							j = j(r);
							if (d == j) {
								$.dmfw.showValidationError($(e).find(".holydayEndTime"), g.ERRORS_MSG.TIME_EQUAL);
								$.dmx.editor.setValid(!1);
								a.disableBackBtn(!0);
								return
							}
							$.dmx.editor.setValid(!0);
							a.disableBackBtn(!1)
						}
						l()
					}
				})
			} else l()
		}
	},
	updateWeekStartDay: function(a) {
		a.currentValues.week_first_day = $("#weekStartDay").val();
		a.currentValues.platform = "dm";
		this.updateData(a)
	},
	updateCombineDays: function(a) {
		a.currentValues.platform = "dm";
		a.currentValues.merge_days_display_runtime = "checked" == $("#mergeDaysDisplayRuntime").attr("checked") ? "true": "false";
		this.updateData(a)
	},
	externalPlatform: function(a, e) {
		a.currentValues.platform = $(e).attr("provider");
		a.currentValues.platform_id = $(e).attr("platform_id");
		a.currentValues.bizname = $(e).attr("bizname");
		this.updateData(a)
	}
};NEEHoursOfOperation.prototype.setPanelState = function(a, e) {
	this.switchSliders(this.currentPanel, a, e);
	switch (a) {
	case this.PANELS_ID.mainPanel:
		$.dmfw.setEditorBreadcrumb(null);
		break;
	case this.PANELS_ID.buildYOurOwn:
		this.HopNavigation.breadcrumb(this, dmStr["ui.nee.hop.52"]);
		this.BuildYourOwn();
		this.setBackBtn(this.PANELS_ID.mainPanel);
		break;
	case this.PANELS_ID.searchSP:
		this.HopNavigation.breadcrumb(this, dmStr["ui.nee.hop.35"]);
		this.findOnSP();
		this.setBackBtn(this.PANELS_ID.mainPanel);
		break;
	case this.PANELS_ID.holydays:
		this.HopNavigation.breadcrumb(this, dmStr["ui.nee.hop.7"], !1);
		this.holydaysPanel();
		this.setBackBtn(this.PANELS_ID.buildYOurOwn);
		break;
	case this.PANELS_ID.selectedPlatform:
		this.HopNavigation.breadcrumb(this, dmStr["ui.nee.hop.35"]),
		this.platformDataDisplay(),
		this.setBackBtn(this.PANELS_ID.searchSP)
	}
	this.currentPanel = a
};NEEHoursOfOperation.prototype.switchSliders = function(a, e, d, g) {
	var j = arguments,
	k = !1;
	3 <= j.length && (k = j[2]); ! 0 == k ? ($(a).toggle(), $(e).toggle(), 4 == j.length && g()) : $(a).slideToggle("fast",
	function() {
		$(e).slideToggle("fast",
		function() {
			4 == j.length && g()
		})
	})
};NEEHoursOfOperation.prototype.setBackBtn = function(a, e) {
	var d = this;
	$(".backButton").unbind("click").click(function() { ! 1 != $.dmx.editor.valid && d.setPanelState(a, e)
	})
};NEEHoursOfOperation.prototype.BuildYourOwn = function() {
	var a = this; ! 0 == this.needToRebuildHours && ($.get("/editor/nee/editableObjects/hoursOfOperation/nee.hoursOfOperationBuildDaysBlock.jsp",
	function(d) {
		var e = $.dmx.current.element;
		$(e).attr("hours_data") && (a.currentValues.hours_data = JSON.parse(Base64.decode($(e).attr("hours_data"))));
		$("#daysLines").html(d);
		a.initBuildYourOwnDays()
	}), this.needToRebuildHours = !1);
	if (!0 != a.alreadyInit) {
		if (!0 == jQuery.isEmptyObject(this.currentValues.hours_data)) {
			a.currentValues.hours_data = {};
			for (var e = 0; 7 > e; e++) a.currentValues.hours_data[e] = {
				dayMode: a.DAYMODE.HOURS,
				startTime: a.DAY_DEFUALT_HOURS.HOURS.START,
				endTime: a.DAY_DEFUALT_HOURS.HOURS.END,
				splitDay: a.DAY_DEFUALT_HOURS.SPLIT_HOURS
			};
			a.currentValues.hours_data[6].dayMode = a.DAYMODE.CLOSE
		}
		a.initBuildYourOwn();
		a.alreadyInit = !0;
		$("#displayOption").val(a.currentValues.display_option);
		$("#displayOption").on("change.hourofoperation",
		function() {
			a.updatePreview.updateDisplayOption(a)
		});
		$("#daysLines .closedLabel").on("change.hourofoperation",
		function() {
			var d = $(this).val();
			$("#daysLines .closedLabel").each(function(a, e) {
				$(e).val(d)
			});
			a.updatePreview.updatecloseDayLabel(a, d)
		});
		$("#DropDownTimezone").on("change.hoursofoperation",
		function() {
			a.updatePreview.updateTimeZone(a)
		});
		$("#weekStartDay").on("change.hoursofoperation",
		function() {
			var d = $(this).val();
			a.sortDayHours(a, d, !0)
		});
		$("#holydaysBtn").on("click.hoursofoperation",
		function() { ! 1 != $.dmx.editor.valid && a.setPanelState(a.PANELS_ID.holydays)
		});
		$("#openHoursBuild").scroll(function() {
			$(".time-picker").each(function(a, e) {
				$(e).is(":visible") && $(e).hide()
			})
		});
		$("#mergeDaysDisplayRuntime").on("change.hoursofoperation",
		function() {
			a.updatePreview.updateCombineDays(a)
		})
	}
};NEEHoursOfOperation.prototype.holydaysPanel = function() {
	var a = this;
	if (!0 != a.HolydayAlreadyInit) {
		var a = this,
		e = null,
		d = null,
		g = {
			preload: !1,
			generateNextPrev: !1,
			pagination: !1,
			generatePagination: !1,
			start: 0,
			next: "rightController",
			prev: "leftController",
			animationComplete: function(d, e) {
				$(e).parents("div.holydayLine").attr("data-daymode", d);
				$(e).attr("data-daymode", d);
				1 == d ? ($(e).find(".leftController").css("visibility", "hidden"), $(e).find(".rightController").css("visibility", "visible")) : ($(e).find(".rightController").css("visibility", "hidden"), $(e).find(".leftController").css("visibility", "visible"));
				a.updatePreview.updateHolydays(a, e)
			}
		},
		d = function(a) {
			g.start = 2 == $(a).attr("data-daymode") ? 2 : 1;
			$(a).slides(g);
			2 == $(a).attr("data-daymode") ? ($(a).find(".rightController").css("visibility", "hidden"), $(a).find(".leftController").css("visibility", "visible")) : ($(a).find(".leftController").css("visibility", "hidden"), $(a).find(".rightController").css("visibility", "visible"))
		},
		e = function(d) {
			$(d).parents("div.holydayLine").remove();
			a.updatePreview.updateHolydays(a, null, !0)
		},
		j = function(g) {
			var j = function(g, j) {
				$("#holydaysWarper").append(g);
				$theNewLine = $("#holydaysWarper").children("div.hopEditorLine").last();
				$theNewLine.find(".datePicker").datepicker();
				$theNewLine.find(".timePicker").timePicker({
					show24Hours: !1
				});
				$theNewLine.find(".holydayTrashBtn").on("click.hoursofoperation",
				function() {
					e(this)
				});
				$theNewLine.find("input").on("change.hoursofoperation",
				function() {
					a.updatePreview.updateHolydays(a, $(this).parents(".hopEditorLine"))
				});
				"undefined" !== typeof j && ($theNewLine.find(".holydayDesc").val(j.desc), $theNewLine.find(".holydayDate").val(j.date), !1 == j.fullDay && $theNewLine.attr("data-daymode", "2"), $theNewLine.find(".holydayDate").val(j.date), $theNewLine.find(".holydayStartTime").val(j.startTime), $theNewLine.find(".holydayEndTime").val(j.endTime));
				d($theNewLine)
			};
			null == a.holydayTemplate ? $.get("/editor/nee/editableObjects/hoursOfOperation/nee.hoursOfOperationHolyday.jsp",
			function(d) {
				a.holydayTemplate = d;
				j(d, g)
			}) : j(a.holydayTemplate, g)
		};
		$("#addHolydayBtn").on("click.hourofoperation",
		function() {
			j()
		});
		if (!1 == a.HolydayAlreadyInit) if (null !== a.currentValues.holyday_data) {
			for (var k = a.currentValues.holyday_data.length - 1; 0 <= k; k--) j(a.currentValues.holyday_data[k]);
			$("#holydaysWarper .holydayLine").first().remove()
		} else $(".datePicker").datepicker(),
		$(".holydayHours").each(function(a, e) {
			d(e)
		});
		$("#holydaysWarper input").on("change.hoursofoperation",
		function() {
			a.updatePreview.updateHolydays(a, $(this).parents(".hopEditorLine"))
		});
		$("#holydaysWarper input.timePicker").on("change.hoursofoperation",
		function() {
			var a = $.timeValidate($(this).val()); ! 1 == a.timeValid ? ($.dmfw.showValidationError($(this), a.msg), $.dmx.editor.setValid(!1)) : $.dmx.editor.setValid(!0)
		});
		$("#holydaysWarper").scroll(function() {
			$(".time-picker").each(function(a, d) {
				$(d).is(":visible") && $(d).hide()
			})
		});
		$(".holydayTrashBtn").on("click.hoursofoperation",
		function() {
			e(this)
		});
		a.HolydayAlreadyInit = !0
	}
};NEEHoursOfOperation.prototype.sortDayHours = function(a, e, d) {
	var g = 0,
	g = a.currentValues.week_first_day,
	j = $("#daysLines"),
	k = $(".dayLine");
	switch (parseInt(g)) {
	case a.WEEK_FIRST_DAY.MONDAY:
		for (var g = e,
		l = 0; l < g; l++) $(j).append(k[l]);
		break;
	case a.WEEK_FIRST_DAY.SATURDAY:
		if (e == a.WEEK_FIRST_DAY.SUNDAY) $(j).append(k[0]);
		else {
			g = 2;
			for (l = 0; l < g; l++) $(j).append(k[l])
		}
		break;
	case a.WEEK_FIRST_DAY.SUNDAY:
		e == a.WEEK_FIRST_DAY.MONDAY ? $(j).append(k[0]) : $(j).prepend(k[6])
	}
	a.currentValues.week_first_day = parseInt(e);
	d && a.updatePreview.updateWeekStartDay(a)
};NEEHoursOfOperation.prototype.findOnSP = function() {
	var a = this;
	if (!0 != a.FindSPAlreadyInit) {
		a.FindSPAlreadyInit = !0;
		_FormatPhoneNumber = function(a) {
			return a.replace(/(\d{3})(\d{3})(\d{4})/, "$1-$2-$3")
		};
		null == $.dmx.site.phoneNumbers ? $.dmGet({
			url: "/sites/" + $.dmx.site.id + "/foundphonenumbers",
			success: function(a) {
				a.list && ($.dmx.site.phoneNumbers = a.list, a.list[0] && $("#menuPhoneNumber").val(_FormatPhoneNumber(a.list[0])))
			}
		}) : $.dmx.site.phoneNumbers[0] && $("#menuPhoneNumber").val(_FormatPhoneNumber($.dmx.site.phoneNumbers[0]));
		var e = {
			gp: "/editor/nee/images/common/result_google_places.png",
			fb: "/editor/nee/images/common/result_facebook_logo.png",
			locu: "/editor/nee/images/common/result_locu_logo.png",
			sp: "/editor/nee/images/common/Single_logo.png"
		};
		$("#menuPhoneNumber").bind("keypress.hoursofoperation",
		function(a) {
			13 == (a.keyCode ? a.keyCode: a.which) && $("#menuDoSearch").click()
		});
		$("#menuBusinessName").bind("keypress.hoursofoperation",
		function(a) {
			13 == (a.keyCode ? a.keyCode: a.which) && $("#menuDoSearch").click()
		});
		$("#menuDoSearch").on("click.hoursofoperation",
		function() {
			$("#menuSearchResults").empty();
			$("#menuNoSearchResaults").css("display", "none");
			var d = $("#menuPhoneNumber").val(),
			g = $("#menuBusinessName").val();
			if ("" != d || "" != g) d = _FormatPhoneNumber(d),
			$("#menuPhoneNumber").val(d),
			$.dmLoading($("#_editor")),
			$.dmPost({
				data: {
					phone: d,
					companyName: g,
					limit: 20
				},
				url: "/sites/" + $.dmx.site.id + "/searchopenhoursforbusiness/",
				success: function(d) {
					if (0 == d.length) $("#menuNoSearchResaults").css("display", "block"),
					$("#menuNoSearchResaults #hopBuildYourOwn").unbind("click").on("click",
					function() {
						a.setPanelState(a.PANELS_ID.buildYOurOwn)
					});
					else {
						var g = {
							results: d,
							resultCount: dmStr["ui.nee.menu.1002.a"].replace("%s", d.length)
						},
						l = function(d) {
							require(["neeUtils/lib/handlebars/base"],
							function() {
								var j = document.createDocumentFragment();
								Handlebars.registerHelper("platformLogoSrc",
								function(a) {
									return e[a]
								});
								var l = Handlebars.compile(d)(g);
								$(j).append(l);
								$("#menuSearchResults").html(j);
								$("#menuSearchResults").find(".menuResultLine").on("click.hoursofoperation",
								function() {
									a.updatePreview.externalPlatform(a, this); ! 0 == a.alreadyInit && (a.needToRebuildHours = !0);
									a.setPanelState(a.PANELS_ID.selectedPlatform)
								})
							})
						};
						null == a.searchResultTemplate ? $.get("/editor/nee/editableObjects/hoursOfOperation/nee.hoursOfOperationSearchResult.html?v\x3d" + require.config.urlArgs,
						function(d) {
							a.searchResultTemplate = d;
							l(d)
						}) : l(a.searchResultTemplate)
					}
					$.dmUnblockUI()
				}
			})
		})
	}
};NEEHoursOfOperation.prototype.platformDataDisplay = function() {
	var a = this;
	$("#selectedPlatform #selectedDecription").html(dmStr["ui.nee.hop.70"] + " " + dmStr["ui.nee.hop.70." + a.currentValues.platform]);
	$("#selectedPlatform .menuShowRestaurantTitle").html(this.currentValues.bizname);
	$("#menuFoundNotRightBuis").unbind("click").on("click.hoursofoperation",
	function() {
		a.setPanelState(a.PANELS_ID.searchSP)
	})
};NEEHoursOfOperation.prototype.HopNavigation = {
	breadcrumb: function(a, e, d) {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() { ! 1 != $.dmx.editor.valid && a.HopNavigation.restoreUI(a)
				}
			},
			{
				title: e
			}]
		});
		d && a.HopNavigation.backButton(a)
	},
	restoreUI: function(a) {
		$.dmfw.setEditorBreadcrumb(null);
		$("#openHoursBuild").hide();
		$("#holydaysWarper").hide();
		$("#holydaysWarper").hide();
		$("#searchHoursSP").hide();
		$("#selectedPlatform").hide();
		a.currentPanel = a.PANELS_ID.mainPanel;
		$("#mainSlider").show()
	},
	backButton: function(a) {
		$(".backButton").unbind("click.hoursofoperation").click(function() {
			setTimeout(function() {
				a.HopNavigation.restoreUI(a)
			},
			300)
		})
	}
};NEEHoursOfOperation.prototype.NEEHoursOfOperationOnTabReadyGeneral = function(a) {
	var e = this;
	$("#headerTextDesc").blur(function() {
		e.updatePreview.updateHeader(e)
	});
	$("#headerTextDesc").keypress(function(a) {
		13 == a.keyCode && e.updatePreview.updateHeader(e)
	});
	$("#hopBuildYourOwn").on("click.hourofoperation",
	function() {
		e.setPanelState(e.PANELS_ID.buildYOurOwn)
	});
	$("#hopfindOnSP").on("click.hourofoperation",
	function() {
		e.setPanelState(e.PANELS_ID.searchSP)
	});
	this.initData();
	e.handleTitle.widgetRuntimeTitle = e.currentValues.title;
	"false" == e.currentValues.displaytitle && (e.handleTitle.displayTitle = !1);
	e.handleTitle.handleTitleinit(a)
};NEEHoursOfOperation.prototype.disableBackBtn = function(a) {
	a ? ($(".backButton").addClass("dmOpacity050"), $("#holydaysBtn").addClass("dmOpacity050")) : ($(".backButton").removeClass("dmOpacity050"), $("#holydaysBtn").removeClass("dmOpacity050"))
};NEEHoursOfOperation.prototype.resetCurrentValues = function() {
	this.FindSPAlreadyInit = this.HolydayAlreadyInit = this.alreadyInit = !1;
	this.currentPanel = this.PANELS_ID.mainPanel;
	this.currentValues = {
		timezone: "",
		hours_data: {},
		display_option: 0,
		holyday_data: null,
		platform: "dm",
		platform_id: null,
		week_first_day: this.WEEK_FIRST_DAY.MONDAY,
		merge_days_display_runtime: !1,
		close_day_label: dmStr["ui.nee.hop.47"]
	}
};NEEHoursOfOperation.prototype.rebuildBuildYouOwnHours = function() {
	var a = $.dmx.current.element;
	$(a).attr("hours_data") && (this.currentValues.hours_data = JSON.parse(Base64.decode($(a).attr("hours_data"))))
};NEEHoursOfOperation.prototype.onEditorClose = function() {
	this.resetCurrentValues()
};NEEHoursOfOperation.prototype.updateToggleTitle = function() {
	this.updatePreview.toggleTitle(this)
};NEEHoursOfOperation.prototype.genericUpdateTitle = function(a) {
	this.updatePreview.updateHeader(this, a)
};
function NEEFacebookLike(a) {
	this.isExtension = !0;
	this.isWidget = !1;
	this.ext = {
		id: "facebook_like",
		preId: "facebook_like",
		defaults: {
			layout: "standard",
			faces: "false",
			color: "light"
		}
	};
	this.options = a || {};
	this.itemData = this.options.itemData || {};
	this.parent = this.itemData.parent;
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtFacebookLike";
	this.title = function() {
		return dmStr["ui.nee.fblike.1"]
	};
	this.priority = 1;
	this.type = "facebookLike";
	this.defaultMarkup = function() {
		""
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/like.png",
			editableDraggedText: dmStr["ui.nee.widgets.fblike"]
		}
	};
	this.editorDesc = 'Allow customers to "Like" your page.';
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.fblike.1"],
		isExpandable: !0,
		isCollapsable: !1,
		useCoverElement: !0
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noSelectionInsert = this.noEditorOnInsert = !0;
	this.afterInsert = function() {
		$.dmfw.refreshFBWidgets()
	};
	this.buttonTabInfo = {
		type: [{
			url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/facebookLike/one.facebookLike.jsp": "/editor/nee/editableObjects/facebookLike/nee.facebookLike.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.facebookLikeOnTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						color: ["background"]
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEFacebookLike.prototype.facebookLikeOnTabReadyGeneral = function() {
	var a = $.dmx.current.element,
	e = a.find(".fb-like"),
	d = unescape(e.data("href")),
	g = e.data("color-scheme"),
	j = e.data("layout");
	"" == d && $.dmfw.isDudaone() && (d = "http://www.dudamobile.com");
	$("#fbLikeDescription").val(d);
	$("#fbLikeColorScheme").val(g);
	$("#fbLikeLayout").val(j);
	$('[id^\x3d"fbLike"]').blur(function() {
		_updateFBInfo()
	});
	$('[id^\x3d"fbLike"]').keypress(function(a) {
		13 == a.keyCode && _updateFBInfo()
	});
	$('[id^\x3d"fbLike"]').change(function() {
		_updateFBInfo()
	});
	_validateFBInfoChanged = function() {
		var a = !1;
		if ($("#fbLikeDescription").val() != d || $("#fbLikeLayout").val() != j || $("#fbLikeColorScheme").val() != g) a = !0;
		return a
	};
	_updateFBInfo = function() {
		var e = $("#fbLikeDescription").val().trim();
		e.startsWith("http://") || (e = "http://" + e, $("#fbLikeDescription").val(e));
		if (_validateFBInfoChanged()) {
			var l = {
				url: encodeURI(e),
				layout: $("#fbLikeLayout").val().toLowerCase().trim(),
				color: $("#fbLikeColorScheme").val().toLowerCase().trim()
			};
			$.changePage({
				clientChange: function() {
					d = l.url;
					g = l.color;
					j = l.layout
				},
				serverChange: function() {
					$.dmsrv.updateExtension(a, l, {
						successCallback: function() {
							$.dmfw.refreshFBWidgets();
							$.dmops.redrawSelection()
						}
					})
				}
			})
		}
	}
};NEEFacebookLike.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEFacebookLike.prototype.getElementTagsSelectors = function() {
	return ".dmFacebookLike, .dmFacebookLike *"
};NEEFacebookLike.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEFacebookLike.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEFacebookLike.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmFacebookLike")
};NEEFacebookLike.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorFBLikeSelected")
};NEEFacebookLike.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorFBLikeSelected"), this.disableEditInline())
};NEEFacebookLike.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEFacebookLike.prototype.disableEditInline = function() {};NEEFacebookLike.prototype.clone = function(a) {
	return new NEEDivider(a)
};NEEFacebookLike.prototype.docReady = function() {};NEEFacebookLike.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEFacebookComments(a) {
	this.isExtension = !0;
	this.isWidget = !1;
	this.ext = {
		id: "facebook_comments",
		preId: "facebook_comments",
		defaults: {}
	};
	this.options = a || {};
	this.itemData = this.options.itemData || {};
	this.parent = this.itemData.parent;
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtFacebookComments";
	this.title = function() {
		return dmStr["ui.nee.fbcomments.1"].replace("^", "")
	};
	this.priority = 1;
	this.type = "facebookComments";
	this.defaultMarkup = function() {
		""
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/fbcomments.png",
			editableDraggedText: dmStr["ui.nee.fbcomments.1"].replace("^", "")
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.fbcomments.1"].replace("^", ""),
		isExpandable: !0,
		isCollapsable: !1,
		useCoverElement: !0
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noSelectionInsert = this.noEditorOnInsert = !0;
	this.afterInsert = function() {
		try {
			$.dmfw.refreshFBWidgets()
		} catch(a) {}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/facebookComments/nee.facebookComments.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.facebookCommentsOnTabReadyGeneral
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEEFacebookComments.prototype.facebookCommentsOnTabReadyGeneral = function() {
	var a = $.dmx.current.element,
	e = a.find(".fb-comments"),
	d = e.data("href"),
	g = e.data("colorscheme");
	$("#fbLikeColorScheme").val(g);
	$('[id^\x3d"fbLike"]').blur(function() {
		_updateFBInfo()
	});
	$('[id^\x3d"fbLike"]').keypress(function(a) {
		13 == a.keyCode && _updateFBInfo()
	});
	$('[id^\x3d"fbLike"]').change(function() {
		_updateFBInfo()
	});
	_validateFBInfoChanged = function() {
		var a = !1;
		$("#fbLikeColorScheme").val() != g && (a = !0);
		return a
	};
	_updateFBInfo = function() {
		if (_validateFBInfoChanged()) {
			var e = {
				color: $("#fbLikeColorScheme").val().toLowerCase().trim(),
				url: d
			};
			$.changePage({
				clientChange: function() {
					g = e.color
				},
				serverChange: function() {
					$.dmsrv.updateExtension(a, e, {
						successCallback: function() {
							$.dmfw.refreshFBWidgets();
							$.dmops.redrawSelection()
						}
					})
				}
			})
		}
	}
};NEEFacebookComments.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEFacebookComments.prototype.getElementTagsSelectors = function() {
	return ".dmFacebookComments, .dmFacebookComments *"
};NEEFacebookComments.prototype.getDummyElement = function() {
	return $("\x3cdiv\x3e\x3c/div\x3e")
};NEEFacebookComments.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEFacebookComments.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmFacebookComments")
};NEEFacebookComments.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorFBCommentsSelected")
};NEEFacebookComments.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorFBCommentsSelected"), this.disableEditInline())
};NEEFacebookComments.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEFacebookComments.prototype.disableEditInline = function() {};NEEFacebookComments.prototype.clone = function(a) {
	return new NEEDivider(a)
};NEEFacebookComments.prototype.docReady = function() {};NEEFacebookComments.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEVariations() {
	this.title = function() {
		return dmStr["ui.nee.layouts.3"]
	};
	this.buttonTabInfo = {}
}
NEEVariations.prototype.editorReady = function(a) {
	$.dmLoad($(a).find(".rightPanel"), "/editor/nee/editableObjects/variations/nee.variations.jsp",
	function() {
		$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("-\x3d50"), $(".neeWrapper .leftPanel").width("-\x3d50"));
		var a = $.dmfw.getPreviewElement(".dm_wrapper div[dmTemplateId]");
		_setVariationLayout = function(a) {
			$(".secVariationStyles").hide();
			a.show()
		};
		"StandardLayout" == a.attr("dmTemplateId") ? _setVariationLayout($(".secExpendStyle")) : "INSIDELIST" == a.attr("dmTemplateId") ? _setVariationLayout($(".secListStyle")) : "MatrixLayout" == a.attr("dmTemplateId") ? _setVariationLayout($(".secMatrixStyle")) : "fixHeadFixFootSlideUp" == a.attr("dmTemplateId") ? _setVariationLayout($(".secBottomStyle")) : "FIXHEADUPPERTABS" == a.attr("dmTemplateId") && _setVariationLayout($(".secTopStyle"));
		$(".navTypeItemVar").unbind("click").click(function() {
			$(".navTypeItemVar").removeClass("selected");
			$(this).addClass("selected");
			var a = $(this).attr("varnum");
			$.dmfw.changeVariation(a, !0)
		});
		a = $.dmfw.getCurrentVariation() || 1;
		$('.navTypeItemVar[varnum\x3d"' + a + '"]').addClass("selected")
	})
};NEEVariations.prototype.onEditorClose = function() {
	$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("+\x3d50"), $(".neeWrapper .leftPanel").width("+\x3d50"))
};
function NEESiteColors() {
	this.title = function() {
		return dmStr["ui.nee.layouts.4"]
	};
	this.buttonTabInfo = {}
}
var isColorChangedAndUpdate = !1,
neeRecentColorsbyUser = [], neeRecentColorsbyUserIndex = 0;NEESiteColors.prototype.editorReady = function(a, e, d) {
	$.dmLoad(d ? $(a) : $(a).find(".rightPanel"), d ? "/editor/nee/mainTabs/ptMainTabs/nee.pt.tabs.design_color_popup.jsp": "/editor/nee/editableObjects/siteColors/nee.siteColors.jsp",
	function() {
		$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("-\x3d50"), $(".neeWrapper .leftPanel").width("-\x3d50"));
		var e = $.dmfw.getPreviewElement(".dm_wrapper div[dmTemplateId]");
		$.dmLoading($.dmfw.isPT() ? $("#ptEditorArea") : $("#_editor"));
		$.dmops.populateCurrentPalette(function() {
			var j = {
				data: $.dmx.currentPalette
			};
			$.dmUnblockUI();
			if (j) {
				var j = $.dmx.currentPalette,
				k = e.attr("dmTemplateId");
				$(a).find(".colorItem1").css("background-color", j["bg-color"]).attr("id", "site_color_bg-color");
				$(a).find(".colorItem2").css("background-color", j["color-1"]);
				$(a).find(".colorItem3").css("background-color", j["color-2"]).attr("id", "site_color_color-2");
				$(a).find(".colorItem4").css("background-color", j["footer-color"]).attr("id", "site_color_footer-color");
				$(a).find(".colorItem5").css("background-color", j["light-text-color"]).attr("id", "site_color_light-text-color");
				$(a).find(".colorItem6").css("background-color", j["dark-text-color"]).attr("id", "site_color_dark-text-color");
				$("#ColorPalleteColor1 .ColorPalleteBox").css("background-color", j["header-color"]).attr("dmVal", "header-color");
				"FIXHEADUPPERTABS" == k && $("#ColorPalleteColor1 .ColorPalleteBox").css("background-color", j["sec-header-color"]).attr("dmVal", "sec-header-color");
				"StandardLayout" == k && ($("#ColorPalleteColor2 .ColorPalleteBox").css("background-color", j["topBtn-color"]).attr("dmVal", "topBtn-color"), $("#ColorPalleteColor2").show());
				$("#ColorPalleteColor3 .ColorPalleteBox").css("background-color", j["bg-color"]).attr("dmVal", "bg-color");
				$("#ColorPalleteColor4 .ColorPalleteBox").css("background-color", j["light-text-color"]).attr("dmVal", "light-text-color");
				$("#ColorPalleteColor5 .ColorPalleteBox").css("background-color", j["dark-text-color"]).attr("dmVal", "dark-text-color");
				$("#ColorPalleteColor6 .ColorPalleteBox").css("background-color", j["nav-color"]).attr("dmVal", "nav-color");
				"StandardLayout" == k ? $("#ColorPalleteColor6 .ColorPalleteText").html(dmStr["ui.nee.variations.101"]) : ("FIXHEADUPPERTABS" == k || "fixHeadFixFootSlideUp" == k) && $("#ColorPalleteColor6 .ColorPalleteText").html(dmStr["ui.nee.variations.103"]);
				$("#ColorPalleteColor7 .ColorPalleteBox").css("background-color", j["nav-text-color"]).attr("dmVal", "nav-text-color"); ("FIXHEADUPPERTABS" == k || "fixHeadFixFootSlideUp" == k || "StandardLayout" == k) && $("#ColorPalleteColor7 .ColorPalleteText").html(dmStr["ui.nee.variations.102"]);
				$("#ColorPalleteColor8 .ColorPalleteBox").css("background-color", j["link-color"]).attr("dmVal", "link-color");
				$("#ColorPalleteColor9 .ColorPalleteBox").css("background-color", j["widget-color"]).attr("dmVal", "widget-color");
				"fixHeadFixFootSlideUp" == k && ($("#ColorPalleteColor10 .ColorPalleteBox").css("background-color", j["footer-color"]).attr("dmVal", "footer-color"), $("#ColorPalleteColor10 .ColorPalleteText").html(dmStr["ui.nee.variations.104"]), $("#ColorPalleteColor10").show());
				"FIXHEADUPPERTABS" == k && ($("#ColorPalleteColor10 .ColorPalleteBox").show().css("background-color", j["footer-color"]).attr("dmVal", "footer-color"), $("#ColorPalleteColor10 .ColorPalleteText").html(dmStr["ui.nee.variations.200"]), $("#ColorPalleteColor10").show());
				$(".ColorPalleteBox").unbind("click.opencustom").bind("click.opencustom",
				function(a) {
					a.stopPropagation();
					0 >= $(this).find(".divToShowPalette").length && ($(".divToShowPalette").remove(), NEESiteColors.prototype.openColorPaletteChange($(this)))
				});
				d && $("#colorPopupDone .ptOrangeBtn").unbind("click").click(function() {
					$(".closeThis").trigger("click")
				})
			}
		})
	})
};NEESiteColors.prototype.openColorPaletteChange = function(a, e) {
	function d(a, d, g) {
		"rgba(0, 0, 0, 0)" != d && k.find("#transInput").val() && (d = $.hexToRgba(d, k.find("#transInput").val()));
		e && e.callback ? e.callback(d, e.sectionToColor, e.UIPreview) : $.changePage({
			clientChange: function() {
				g.css("background-color", d);
				$.dmfw.isDudaone() ? $.themesPanel.updatePalette(a, d) : (0 < $("#site_color_" + a).length && $("#site_color_" + a).css("background-color", d), $.dmfw.isPT() && ($.ptColor._isColorChangedAndUpdate = !0));
				isColorChangedAndUpdate = !0
			},
			serverChange: function() {
				$.dmops.changePaletteColor(a, d)
			}
		})
	}
	e = e || {};
	var g = $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/siteColors/one.siteColorsPopUp.jsp": "/editor/nee/editableObjects/siteColors/nee.siteColorsPopUp.jsp",
	j = a,
	k = $("\x3cdiv/\x3e");
	k.hide();
	k.appendTo(a).addClass("divToShowPalette");
	$.dmLoad(k, g,
	function() {
		function a(e) {
			10 < neeRecentColorsbyUserIndex && (neeRecentColorsbyUserIndex = 0);
			var g = $(n[neeRecentColorsbyUserIndex]);
			g.css("background", e).removeClass("notFilled");
			g.attr("title", $.rgb2hex(e));
			g.unbind("click").click(function(a) {
				a.stopPropagation();
				a = $(this).css("background-color");
				d(j.attr("dmVal"), a, j)
			});
			neeRecentColorsbyUserIndex++
		}
		$.dmx.site.isBlog && $.dmfw.isPT() && k.find("span.ColorPalleteText:first").text("Colors");
		"setPosition" in e && k.css({
			top: e.setPosition.top || auto,
			left: e.setPosition.left || auto,
			position: e.setPosition.position || "absolute"
		});
		k.show();
		var g = $.dmx.site.colors,
		n = $(".colorCubeRecent"),
		o = 30 < g.length ? 30 : g.length; - 1 == $.dmx.site.colors.indexOf("transparent") && ($.dmx.site.colors.push("transparent"), o++);
		for (var r = $("#holdSiteColors"), u = 0; u < o; u++) if ("undefined" != g[u]) {
			var s = $('\x3cdiv class\x3d"colorCube" unselectable\x3d"on" container\x3d"holdSiteColors"\x3e\x3c/div\x3e').attr("id", "serverColorNum" + u),
			B = g[u];
			s.css("background-color", B);
			s.attr("title", $.rgb2hex(B));
			r.append(s); ("transparent" == g[u] || "rgba(0,0,0,0)" == g[u]) && s.addClass("transparentSiteColor").attr("title", "transparent");
			s.click(function(e) {
				e.stopPropagation();
				e = $(this).css("background-color"); - 1 == jQuery.inArray($.rgb2hex(e), neeRecentColorsbyUser) && (neeRecentColorsbyUser[neeRecentColorsbyUserIndex] = $.rgb2hex(e), a($.rgb2hex(e)));
				d(j.attr("dmVal"), e, j)
			})
		}
		for (u = 0; u < neeRecentColorsbyUser.length; u++) s = $(n[u]),
		B = neeRecentColorsbyUser[u],
		s.css("background", B).removeClass("notFilled"),
		s.attr("title", $.rgb2hex(B)),
		s.click(function(a) {
			a.stopPropagation();
			a = $(this).css("background-color");
			d(j.attr("dmVal"), a, j)
		});
		$(document.body).on("click", ".colorCubeRecent",
		function(a) {
			a.stopPropagation();
			$(this).hasClass("notFilled") || (a = $(this).css("background-color"), d(j.attr("dmVal"), a, j))
		});
		k.find(".colorTransp").dmColorOpacity({
			callback: function() {
				d(j.attr("dmVal"), j.css("background-color"), j)
			},
			setColor: j.css("background-color")
		});
		$(".triggerOpenColorPicker").unbind("click").click(function(e) {
			e.stopPropagation();
			$("#placementForColorPickerColor").neeOpenColorPicker(j.css("background-color"),
			function(e) { - 1 != navigator.appVersion.indexOf("MSIE") ? this.event.cancelBubble = !0 : (this.event && this.event.preventDefault(), this.event && this.event.stopPropagation()); - 1 == jQuery.inArray($.rgb2hex(e), neeRecentColorsbyUser) && (neeRecentColorsbyUser[neeRecentColorsbyUserIndex] = $.rgb2hex(e), a($.rgb2hex(e)));
				k.remove();
				d(j.attr("dmVal"), e, j);
				return ! 1
			})
		});
		k.find(".closeColorPicker").click(function(a) {
			a.stopPropagation();
			k.remove()
		});
		k.unbind("clickoutside").bind("clickoutside",
		function() {
			k.remove()
		})
	})
};NEESiteColors.prototype.onEditorClose = function() {
	$(".neeWrapper").is("#ptEditorAreaWrapper *") || ($(".neeWrapper").width("+\x3d50"), $(".neeWrapper .leftPanel").width("+\x3d50"));
	isColorChangedAndUpdate && ($.dmx.site.paletteID = -1, isColorChangedAndUpdate = !1, _handleColorPalettesScreen())
};
function NEEOrphan(a) {
	this.options = a || {};
	this.title = function() {
		return "orphan"
	};
	this.className = "dmOrphanWidget";
	this.priority = 0.1;
	this.type = "orphan";
	this._defaultImageSrcUrl = dmStr["ui.config.widgets.image.placeholder"] ? dmStr["ui.config.widgets.image.placeholder"] : "http://dm-direct.s3.amazonaws.com/defaultImages/clickToEditPicture.png";
	this._defaultLogoSrcUrl = dmStr["ui.config.widgets.logo.placeholder"] ? dmStr["ui.config.widgets.logo.placeholder"] : "http://dudamobile-themes.s3.amazonaws.com/otf_theme/logohere.png";
	this.defaultMarkup = function() {
		return '\x3cdiv class\x3d"' + this.className + '"\x3e\x3c/div\x3e'
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/image.png",
			editableDraggedText: dmStr["ui.nee.widgets.7"]
		}
	};
	this.inlineEditorProperties = {
		title: "",
		isEdit: !1,
		isExpandable: !1
	};
	this.linkEditor = null;
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.inlineEdit = {};
	this.buttonTabInfo = {}
}
NEEOrphan.prototype.onTabReadyGeneralNew = function() {};NEEOrphan.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEOrphan.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEOrphan.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement($(a))
};NEEOrphan.prototype.getCorrectElement = function(a) {
	return $(a).closest("." + this.className)
};NEEOrphan.prototype.getElementTagsSelectors = function() {
	return "." + this.className + ", ." + this.className + " *"
};NEEOrphan.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorOrphanSelected")
};NEEOrphan.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorOrphanSelected"), this.disableEditInline())
};NEEOrphan.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEOrphan.prototype.disableEditInline = function() {};NEEOrphan.prototype.clone = function(a) {
	return new NEEOrphan(a)
};NEEOrphan.prototype.docReady = function() {};NEEOrphan.prototype.editorReady = function() {};
function NEEBackToTop(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.widgets.backtotop"]
	};
	this.className = "dmBackToTop";
	this.priority = 0.1;
	this.type = "backtotop";
	this.defaultMarkup = function() {
		return '\x3ca class\x3d"' + this.className + '"\x3e\x3c/a\x3e'
	};
	this.inlineEditor = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/image.png",
			editableDraggedText: "Top"
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.widgets.backtotop"],
		isEdit: !1,
		isExpandable: !1,
		isMovable: !1,
		isCopy: !1,
		isPaste: !1,
		hasHide: !0,
		isDelete: !1
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !1,
			insertAfter: !1,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	}
}
NEEBackToTop.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEBackToTop.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEBackToTop.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement($(a))
};NEEBackToTop.prototype.getCorrectElement = function(a) {
	return $(a).closest("." + this.className)
};NEEBackToTop.prototype.getElementTagsSelectors = function() {
	return "." + this.className + ", ." + this.className + " *"
};NEEBackToTop.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorBackToTopSelected")
};NEEBackToTop.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorBackToTopSelected"), this.disableEditInline())
};NEEBackToTop.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEBackToTop.prototype.disableEditInline = function() {};NEEBackToTop.prototype.docReady = function() {};NEEBackToTop.prototype.editorReady = function() {};
function NEESocialHub() {
	this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.socHub.1"]
	};
	this.generalFormTitleFeildLabel = "";
	this.ext = {
		id: "social_hub",
		preId: "socialhub",
		defaults: {
			networks: ""
		}
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtSocialIcons";
	this.itemData = {
		id: "",
		url: "",
		iconClass: "",
		iconCustom: ""
	};
	this.currentData = {
		networks: {},
		title: "",
		displayTitle: !0,
		icons_style: "",
		all_pages: !1,
		layout: ""
	};
	this.disableClickImg = this.isActive = !1;
	this.priority = 1;
	this.type = "socialhub";
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.socHub.1"].replace("^", ""),
		isEdit: $.dmfw.isPT() || $.dmfw.isDudaone() ? !0 : !1
	};
	this.editorDesc = "Add social icons to your website linking to your various social media pages.";
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/social.png",
			editableDraggedText: "Social Buttons"
		}
	};
	this.widgetRuntimeTitle = "";
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/socialHub/nee.socialHub.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				a.NEESocialHubOnTabReadyGeneral(e, null, {
					force: !0
				});
				NEESocialHub.prototype.handleTitle.handleTitleinit(e)
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					textSelector: ".dmwidget-title",
					tabs: {
						socialhub_design: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
NEESocialHub.prototype = new NEEPrototypeExtension;NEESocialHub.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEESocialHub.prototype.NEESocialHubOnTabReadyGeneral = function() {
	var a = this,
	e = $.dmx.current.editable.element;
	$.dmfw.preview.testAndSetPlaceholder(".dmSocialHub ", "dmSocialHubPlaceholder");
	$.dmops.redrawSelection();
	a.initData();
	require(["/editor/nee/editableObjects/socialHub/nee.socialHubList.js"],
	function() {
		var d = socialHubList.drawList(function(d) {
			var e = $(d).attr("data-title"),
			k = $(d).attr("data-desc"),
			l = decodeURIComponent($(d).attr("data-placeholder")),
			m = decodeURIComponent($.dmString($(d).attr("data-alternativeplaceholder"))),
			n = $(d).attr("data-key");
			$("#networkTitle").html(dmStr["ui.nee.socHub.2"].replace("%s", e));
			$("#networkUrl").attr("data-key", n);
			$("#networkDesc").html(dmStr["ui.nee.socHub.3"].replace("%s", k));
			"undefined" !== m ? $("#networkUrl").attr("placeholder", m) : $("#networkUrl").attr("placeholder", $.dmString("ui.nee.socHub.54"));
			$("#iconsSelector div.socailBtnBox").removeClass("active");
			$(d).parent("div").addClass("active");
			"undefined" !== typeof a.currentData.networks[n] ? ($("#networkUrl").val(a.currentData.networks[n].url), $("#removeNetWork").css("display", "inline-block")) : ($("#networkUrl").val(l), $("#removeNetWork").css("display", "none")); ! 1 == $.dmx.editor.valid && ($(".qtip").hide(), $.dmx.editor.setValid(!0))
		},
		a.currentData.networks);
		$("#networkUrl").focus(function() {
			if ("number" == typeof this.selectionStart) this.selectionStart = this.selectionEnd = this.value.length;
			else if ("undefined" != typeof this.createTextRange) {
				this.focus();
				var a = this.createTextRange();
				a.collapse(!1);
				a.select()
			}
		});
		$("#iconsSelector").append(d);
		$("#networkUrl").on("change.socialHub",
		function() {
			a.updatePreview.updateNetorkItem(a, this);
			$("#removeNetWork").css("display", "inline-block")
		});
		$("#iconsSelector button.socailBtn").first().click();
		$("#leftBtn").on("click",
		function() {
			a.IconSlider("left")
		});
		$("#rightBtn").on("click",
		function() {
			a.IconSlider("right")
		});
		$("#headerTextDesc").on("change",
		function() {
			a.updatePreview.updateTitle(a, this)
		});
		$("#removeNetWork").unbind("click").bind("click",
		function() {
			var d = $("#networkUrl").attr("data-key");
			delete a.currentData.networks[d];
			$("#networkUrl").val(socialHubList.theList[d].placeholder);
			a.updatePreview.updateData(a);
			$(this).css("display", "none");
			$(".ui-tooltip-dm-error").remove();
			$.dmx.editor.setValid(!0)
		});
		$("#networkUrl").on("change keydown",
		function() {
			$("#saveNetwork").removeClass("dmOpacity050")
		});
		$.dmAddAllPagesButtons(e)
	})
};NEESocialHub.prototype.IconSlider = function(a) {
	var e = "+\x3d47",
	d = null,
	g = null;
	if ("right" == a) {
		if (e = "-\x3d47", d = $("#iconsSelector").find("button.socailBtn").length, g = parseInt($("#iconsSelectorWarper").css("width")) / 47, Math.abs(parseInt($("#iconsSelector").css("left"))) + 47 > 47 * (d - g)) return
	} else if (0 <= parseInt($("#iconsSelector").css("left"))) {
		$("#iconsSelector").animate({
			left: 0
		},
		250);
		return
	}
	$("#iconsSelector").animate({
		left: e
	},
	250,
	function() {
		"right" == a ? (Math.abs(parseInt($("#iconsSelector").css("left"))) >= 47 * (d - g - 1) && $("#rightBtn").addClass("dmDisable"), $("#leftBtn").removeClass("dmDisable")) : (0 <= parseInt($("#iconsSelector").css("left")) && $("#leftBtn").addClass("dmDisable"), $("#rightBtn").removeClass("dmDisable"))
	})
};NEESocialHub.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorSocailHubSelected")
};NEESocialHub.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorSocailHubSelected"), this.disableEditInline())
};NEESocialHub.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEESocialHub.prototype.getElementTagsSelectors = function() {
	return ".dmSocialHub, .dmSocialHub *"
};NEESocialHub.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEESocialHub.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmSocialHub")
};NEESocialHub.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEESocialHub.prototype.disableEditInline = function() {};NEESocialHub.prototype.docReady = function() {
	$.dmfw.preview.testAndSetPlaceholder(".dmSocialHub ", "dmSocialHubPlaceholder");
	$.dmops.redrawSelection()
};NEESocialHub.prototype.initData = function() {
	var a = JSON.parse(Base64.decode($($.dmx.current.element).attr("data-editor")));
	if ("object" == typeof a && (this.currentData = a, !1 == jQuery.isEmptyObject(a.networks))) {
		for (var e = {},
		d = 0; d < a.networks.length; d++) {
			var g = a.networks[d];
			e[g.id] = g
		}
		this.currentData.networks = e
	}
	"" !== this.currentData.title && ($("#headerTextDesc").val(this.currentData.title), this.handleTitle.widgetRuntimeTitle = this.currentData.title);
	"" == this.currentData.layout && (this.currentData.layout = "vertical");
	this.handleTitle.displayTitle = this.currentData.displayTitle
};NEESocialHub.prototype.designTab = function() {
	var a = this,
	e = $(".socialHubIconsStyle").children(".stylesTab");
	e.toggle();
	$(e[0]).toggle();
	var d = $(".socialHubStyle");
	$(d[parseInt(a.currentData.icons_style) - 1]).addClass("active");
	$("#designIconStyleButtons button").unbind("click").bind("click",
	function() {
		$(e).toggle(!1);
		$(e[$(this).attr("data-tabNumber")]).toggle()
	});
	$(".socialHubStyle").unbind("click").bind("click",
	function() {
		d.removeClass("active");
		$(this).addClass("active");
		a.updatePreview.updateStyle(a, $(this).attr("data-style_number"))
	})
};NEESocialHub.prototype.layoutTab = function() {
	var a = this;
	$(".layout[data-layout\x3d'" + a.currentData.layout + "']").addClass("active");
	$(".layout").on("click",
	function() {
		$(".layout").removeClass("active");
		$(this).addClass("active");
		a.updatePreview.updateLayout(a, $(this).attr("data-layout"))
	})
};NEESocialHub.prototype.updatePreview = {
	updateData: function(a) {
		var e = null,
		d = $.dmx.current.element,
		g = a.currentData.networks,
		j = {
			successCallback: function() {
				a.currentData.networks = g;
				var d = $.dmx.current.editable.element;
				if (jQuery.isEmptyObject(a.currentData.networks) && (0 == a.currentData.title.length || !1 == a.currentData.displayTitle)) d.addClass("dmSocialHubPlaceholder"),
				$.dmops.redrawSelection()
			}
		},
		k = [],
		l;
		for (l in a.currentData.networks) k.push(a.currentData.networks[l]);
		a.currentData.networks = k;
		var e = Base64.encode(JSON.stringify(a.currentData)),
		m = {
			"data-editor": e
		};
		$.changePage({
			clientChange: function() {
				d.attr("data-editor", e)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(d, m, j)
			}
		})
	},
	updateNetorkItem: function(a, e) {
		var d = {};
		d.id = $(e).attr("data-key");
		d.url = $(e).val();
		d.iconClass = "";
		d.iconCustom = "";
		valid = $.fn.inputURL("#networkUrl", {
			protocol: socialHubList.theList[d.id].protocol,
			hostname: socialHubList.theList[d.id].domain,
			changeOnInvalidProtocol: !0,
			mustHavepPath: !0,
			fixDupliateDomain: !0
		}); ! 1 != valid && (d.url = $(e).val(), a.currentData.networks[d.id] = d, this.updateData(a))
	},
	updateStyle: function(a, e) {
		a.currentData.icons_style = e;
		this.updateData(a)
	},
	updateLayout: function(a, e) {
		a.currentData.layout = e;
		this.updateData(a)
	},
	updateTitle: function(a, e) {
		a.currentData.title = $(e).val();
		a.currentData.forceDisplay = !0;
		a.currentData.displayTitle = "" == a.currentData.title ? !1 : !0;
		this.updateData(a)
	},
	toggleTitle: function(a) {
		a.currentData.displayTitle ? a.currentData.displayTitle = !1 : a.currentData.displayTitle = !0;
		if (!0 == $.dmx.site.isFromScratch) {
			var e = $.dmx.current.element.find(".dmwidget-title");
			a.currentData.displayTitle = "none" == e.css("display") || 0 == e.length ? !0 : !1
		}
		a.currentData.forceDisplay = !0;
		this.updateData(a)
	}
};NEESocialHub.prototype.updateToggleTitle = function() {
	this.updatePreview.toggleTitle(this)
};NEESocialHub.prototype.genericUpdateTitle = function(a, e) {
	this.updatePreview.updateTitle(this, e)
};NEESocialHub.prototype.checkClose = function() {
	var a = 0 === $("#generalTitleInput:visible").length;
	$.dmfw.changeTabTo(1,
	function() {
		var a = {
			at: "bottom center",
			my: "top center"
		},
		d = $("#iconDetails"),
		g = $("#iconsSelector").find(".socailBtnBox.active:visible button"),
		d = d.find("input.headerTextDesc"),
		j = 1 > $.parseJSON(Base64.decode($.dmx.current.element.attr("data-editor"))).networks.length,
		g = decodeURIComponent(g.attr("data-placeholder"));
		d.val() === g && (j = !0);
		j ? $.dmfw.showPromptError($("#networkUrl"), dmStr["ui.nee.promptMassages.12"], a) : $.dmfw._closeEditorAll({
			override: !0
		})
	},
	a)
};
function NEEJalanReservation() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.jalanres.title"].replace("^", "")
	};
	this.ext = {
		id: "jalan_res",
		preId: "jalan_res",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "jalan_res";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/jalanRes.png",
			editableDraggedText: dmStr["ui.nee.widgets.39"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.jalanres.title"].replace("^", "")
	};
	this.rightPanelElementSelector = "#generalJalanRes";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/jalan/nee.jalanWidgets.jsp?type\x3dreservation",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEJalanReservation.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEJalanReservation.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorJalanResSelected")
};NEEJalanReservation.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#jalanUrl").val(a.attr("url"));
	$("#jalanTextDesc").val(a.attr("description"));
	$('[id^\x3d"jalan"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"jalan"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			url: $("#jalanUrl").val(),
			description: $("#jalanTextDesc").val(),
			needs_premium_validation: !1
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("url", e.url);
				a.find("text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEJalanReservation.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorJalanSelected"), this.disableEditInline())
};NEEJalanReservation.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmJalanRes *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEJalanReservation.prototype.getElementTagsSelectors = function() {
	return "A.dmJalanRes"
};NEEJalanReservation.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEJalanReservation.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEJalanReservation.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEJalanReservation.prototype.disableEditInline = function() {};NEEJalanReservation.prototype.docReady = function() {};NEEJalanReservation.prototype.getDefaultIconName = function() {
	return "mail.png"
};NEEJalanReservation.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEJalanGallery() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.jalangallery.title"].replace("^", "")
	};
	this.ext = {
		id: "jalan_gallery",
		preId: "jalan_gallery",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "jalan_gallery";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/jalanGallery.png",
			editableDraggedText: dmStr["ui.nee.widgets.38"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.jalangallery.title"].replace("^", "")
	};
	this.rightPanelElementSelector = "#generalJalanGallery";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/jalan/nee.jalanWidgets.jsp?type\x3dgallery",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEJalanGallery.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEJalanGallery.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorJalanGallerySelected")
};NEEJalanGallery.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#jalanUrl").val(a.attr("url"));
	$("#jalanTextDesc").val(a.attr("description"));
	$('[id^\x3d"jalan"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"jalan"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			url: $("#jalanUrl").val(),
			description: $("#jalanTextDesc").val(),
			needs_premium_validation: !1
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("url", e.url);
				a.find("text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEJalanGallery.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorJalanSelected"), this.disableEditInline())
};NEEJalanGallery.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmJalanGallery *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEJalanGallery.prototype.getElementTagsSelectors = function() {
	return "A.dmJalanGallery"
};NEEJalanGallery.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEJalanGallery.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEJalanGallery.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEJalanGallery.prototype.disableEditInline = function() {};NEEJalanGallery.prototype.docReady = function() {};NEEJalanGallery.prototype.getDefaultIconName = function() {
	return "mail.png"
};NEEJalanGallery.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEGeoLocation(a) {
	this.options = a || {};
	this.title = function() {
		return dmStr["ui.widgets.701"]
	};
	this.isExtension = !0;
	this.ext = {
		id: "dm_geo_location",
		preId: "dm_geo_location",
		defaults: {
			needs_premium_validation: !0
		}
	};
	this.priority = 1;
	this.type = "geoLocation";
	this.defaultMarkup = function() {
		return "\x3cdiv\x3e\x3c/div\x3e"
	};
	this.mindTouchId = "dmMtMultiLocation";
	this.showMindTouchHelp = !0;
	this.inlineEditor = null;
	this.inlineEditorProperties = {
		title: dmStr["ui.widgets.701"].replace("^", "")
	};
	this.editorDesc = "Enable customers to find your business location nearest to them.";
	this.forceSelection = null;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/Multi_Icon_w.png",
			editableDraggedText: dmStr["ui.widgets.701"]
		}
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.noEditorOnInsert = !1
}
NEEGeoLocation.prototype.gLocationReadyAll = function(a, e) {
	var d = $.dmx.current.editable.element.attr("data-editor");
	currentGLElement(JSON.parse(Base64.decode(d)));
	d = [{
		id: "gLocationGeneral",
		name: dmStr["ui.general"],
		url: $.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/geolocation/one.geoLocationGeneral.jsp": "/editor/nee/editableObjects/geoLocation/nee.geoLocationGeneral.jsp",
		onReady: function() {
			$.dmfw.editables("geolocation").gLocationReadyGeneral(a, currentGLElement(), e)
		}
	},
	{
		id: "gLocationBtn",
		name: dmStr["ui.pt.geoloc.104"],
		url: "/editor/nee/editableObjects/geoLocation/nee.geoLocationBtn.jsp",
		onReady: function() {
			$.dmfw.editables("geolocation").gLocationReadyBtn(a, currentGLElement(), e)
		}
	}];
	a.neeSecondaryTabsControl(d)
};NEEGeoLocation.updateElement = function() {
	var a = $.dmx.current.element || $.currentGLElem;
	$.currentGLElem = null;
	currentGLElement().doupdate = !0;
	var e = Base64.encode(JSON.stringify(currentGLElement())),
	d = {
		"data-editor": e
	};
	$.changePage({
		clientChange: function() {
			a.attr("data-editor", e)
		},
		serverChange: function() {
			$.dmsrv.updateExtension(a, d, {
				successCallback: function() {
					a.attr("data-editor");
					currentGLElement(JSON.parse(Base64.decode(e)));
					$.dmfw.isDudaone() && $.dmx.preview.wnd().$.dmrt.components.geolocation["default"].initGoogleMaps()
				}
			})
		}
	})
};NEEGeoLocation.updateLocationElement = function(a, e, d, g, j) {
	$.dmPostWithHistory({
		url: "/sites/" + $.dmx.site.id + "/updategeolocation?remove\x3d" + (d ? "true": "false"),
		data: e,
		success: function(a) {
			currentGLElement().locations[j] = a;
			NEEGeoLocation.updateElement(currentGLElement());
			g && g(a)
		}
	})
};NEEGeoLocation.prototype.gLocationReadyBtn = function(a) {
	var e = a.find("#dmglBtnDecr"),
	d = currentGLElement().button;
	e.val(d);
	e.blur(function() {
		_updateGLInfo()
	});
	e.keypress(function(a) {
		13 == a.keyCode && _updateGLInfo()
	});
	_updateGLInfo = function() {
		var a = e.val();
		"" !== a && (currentGLElement().button = a, NEEGeoLocation.updateElement(currentGLElement()))
	};
	d = {
		initState: currentGLElement().buttonhide,
		onFn: function() {
			currentGLElement().buttonhide = !0;
			NEEGeoLocation.updateElement(currentGLElement())
		},
		offFn: function() {
			currentGLElement().buttonhide = !1;
			NEEGeoLocation.updateElement(currentGLElement())
		}
	};
	a.find("#dmglHideBtnButton").onOffBtn(d)
};NEEGeoLocation.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEEGeoLocation.prototype.gLocationReadyGeneral = function(a) {
	var e = this;
	e.handleTitle.widgetRuntimeTitle = currentGLElement().title;
	e.handleTitle.displayTitle = currentGLElement().displayTitle;
	e.handleTitle.handleTitleinit(a);
	var d = dmStr["ui.pt.geoloc.107"];
	$.currentGLLinks = $.currentGLLinks || [];
	var g = function(a) {
		var d;
		$($.dmx.editablePages()).each(function(e, g) {
			g.alias === a && (d = g.title)
		});
		return d
	},
	j = function(d) {
		a.find(".dmglLinkLocText").html(d)
	},
	k = function(d) {
		var e;
		d && d.attr ? e = d.attr("title") || d.attr("raw_url") : d && d.url && (e = $(d.url).attr("raw_url") || void 0);
		e ? (a.find(".navLinkButtonHidden").show(), j(e)) : (a.find(".navLinkButtonHidden").hide(), j(dmStr["ui.pt.geoloc.103"]))
	},
	l = function(a) {
		var j, l, m = "/site/" + $.dmx.site.alias + "/";
		locations = currentGLElement().locations;
		if ($.currentGLLinks[a]) j = $.currentGLLinks[a];
		else {
			if (!locations[a] || !locations[a].url) j = $("\x3ca\x3e\x3c/a\x3e"),
			j.text(d),
			j.attr("raw_url", ""),
			j.attr("href", ""),
			j.dmid(e.element.dmid());
			else if (j = $(locations[a].url), (l = j.attr("raw_url")) && l.startsWith(m)) l = l.replace(m, ""),
			l = g(l),
			j.attr("title", l);
			$.currentGLLinks[a] = j;
			$.currentGLLinks[a].on("attrChange",
			function() {
				var d = $.currentGLLinks[a].attr("href"),
				d = d.replace("nee\x3dtrue\x26", "").replace("showOriginal\x3dtrue\x26", "").replace("dm_checkSync\x3d1\x26", "");
				$.currentGLLinks[a].attr("href", d);
				currentGLElement().locations[a] = currentGLElement().locations[a] || {};
				currentGLElement().locations[a].url = $.currentGLLinks[a].outerHTML();
				NEEGeoLocation.updateLocationElement(currentGLElement(), currentGLElement().locations[a], !1, k, a)
			});
			$.currentGLLinks[a].on("removeLink",
			function() {
				$.currentGLLinks[a].remove();
				$.currentGLLinks[a] = void 0;
				locations[a] && (currentGLElement().locations[a].url = "", NEEGeoLocation.updateLocationElement(currentGLElement(), currentGLElement().locations[a], !1, k, a))
			})
		}
		return j
	};
	$(".footerEditable").find(".saveButton").off("click").on("click",
	function() {
		m()
	});
	_handleRemoveLocation = function(d, e) {
		currentGLElement().locations.splice(d, 1);
		e && e.remove && e.remove();
		$.currentGLLinks.splice(d, 1);
		a.find("#navPages .navEditorLinkAndSub").each(function(a, d) {
			$(d).attr("addedIndex", a)
		})
	};
	var m = function() {
		var d = $(".rightPanel");
		d.empty();
		a.closest("#_p_editor").find(".backButton").unbind("click");
		$(".footerEditable").find(".updateButton").show();
		$(".footerEditable").find(".saveButton").hide();
		$.dmfw.setEditorBreadcrumb(null);
		$("#_p_editor").find(".removeLinkButton").hide();
		$.dmLoad(d, "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
		function() {
			NEEGeoLocation.prototype.gLocationReadyAll(a)
		})
	},
	n = function() {
		a.find("#mapGeneralSelection").hide();
		a.find(".dmglAddNewSearchOnline").show();
		var d = a.find("#dmglOnlineSearchPhone");
		_glFormatPhoneNumber = function() {
			d.val(function(a, d) {
				return d = d.replace(/(\d{3})(\d{3})(\d{4})/, "$1-$2-$3")
			});
			return d.val()
		};
		null == $.dmx.site.phoneNumbers || 0 == $.dmx.site.phoneNumbers.length ? $.dmGet({
			url: "/sites/" + $.dmx.site.id + "/foundphonenumbers",
			success: function(a) {
				a.list && ($.dmx.site.phoneNumbers = a.list, a.list[0] && (d.val(a.list[0]), d.trigger("keyup"), _glFormatPhoneNumber()))
			}
		}) : $.dmx.site.phoneNumbers[0] && (d.val($.dmx.site.phoneNumbers[0]), d.trigger("keyup"), _glFormatPhoneNumber());
		d.bind("input propertychange",
		function() {
			this.value = this.value.replace(/[^0-9]/g, "")
		}); ! 1 === isWLSubUser && !$.dmx.site.isFromScratch && a.find("#dmglOnlineSearchSite").val($.dmx.site.baseUrl);
		a.find("#menuDoSearch").unbind("click").click(function() {
			var g = d.val(),
			j = a.find("#dmglOnlineSearchSite").val();
			if ("" !== g || "" !== j) g = _glFormatPhoneNumber(),
			$.dmLoading($("#_editor")),
			$.dmPost({
				data: {
					phone: g,
					bizUrl: j,
					limit: 20
				},
				url: "/sites/" + $.dmx.site.id + "/searchgeolocationforbusiness/",
				success: function(a) {
					$(".menuDisplayResults").hide();
					$("#menuSearchResuults").hide();
					$("#menuNoSearchResaults").hide();
					$.dmUnblockUI();
					if (0 !== a.length) {
						$("#menuSearchResuults").empty();
						$("#menuSearchResuults").append($("\x3cdiv class\x3d'menuResultsHeader'\x3e\x3c/div\x3e").html(dmStr["ui.nee.menu.1002.a"].replace("%s", a.length)));
						for (var d = 0; d < a.length; d++) if (a[d]) {
							var g = a[d].title,
							j = a[d].phone,
							k = a[d].formattedAddress,
							l = eval(a[d]),
							g = "\x3cdiv class\x3d'menuResultLine' businessname\x3d'{{data[i].title}}' num\x3d'{{num}}'\x3e\x3cdiv class\x3d'chosenIcon'\x3e\x3c/div\x3e\x3cdiv class\x3d'menuResultLineInnerResult'\x3e{{tmpName}}\x3cdiv class\x3d'menuResultLineAddress'\x3e{{tmpFullAdrs}}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'menuResultLineInnerLogo'\x3e{{tmpPhon}}\x3c/div\x3e\x3c/div\x3e".replace("{{data[i].title}}", g || "").replace("{{tmpName}}", g || "").replace("{{tmpFullAdrs}}", k || "").replace("{{tmpPhon}}", j || "").replace("{{num}}", d || ""),
							g = $(g);
							g.data("elemTmp", l);
							$("#menuSearchResuults").append(g);
							e(g)
						}
						$("#menuSearchResuults").show()
					} else $(".menuDisplayResults").find("#menuNoSearchResaults").show(),
					$("#geoManuallyLink").unbind("click").click(function() {
						$(".dmglAddNewSearchOnline").hide();
						$("#dmglAddMenual").trigger("click")
					});
					$(".menuDisplayResults").show();
					$(".footerEditable").find(".saveButton").show()
				}
			})
		});
		d.keypress(function(d) {
			13 == d.keyCode && ($(this).blur(), a.find("#menuDoSearch").trigger("click"))
		});
		a.find("#dmglOnlineSearchSite").keypress(function(d) {
			13 == d.keyCode && ($(this).blur(), a.find("#menuDoSearch").trigger("click"))
		});
		var e = function(a) {
			a.unbind("click").click(function() {
				if ($(this).hasClass("selected")) {
					$(this).removeClass("selected");
					var d = a.attr("uniqueId"),
					e = jQuery.grep(currentGLElement().locations,
					function(a) {
						return a.uniqueId == d
					})[0],
					g = -1,
					j;
					for (j in currentGLElement().locations) if (currentGLElement().locations[j].uniqueId == d) {
						g = j;
						break
					} - 1 < g && _handleRemoveLocation(g, e);
					NEEGeoLocation.updateLocationElement(currentGLElement(), e, !0)
				} else {
					$(this).addClass("selected");
					var e = a.data("elemTmp"),
					k = currentGLElement().locations.length;
					currentGLElement().locations[k] = e;
					NEEGeoLocation.updateLocationElement(currentGLElement(), e, !1,
					function(d) {
						currentGLElement().locations[k] = d;
						a.attr("uniqueId", d.uniqueId)
					},
					k);
					a.attr("addedAt", k)
				}
			})
		}
	},
	o = function(d) {
		$(".footerEditable").find(".saveButton").show();
		e.createStatesSelectBox(a);
		var j = null; - 1 == d && (d = null, a.find(".rightPanelTabsWrapper").hide(), a.find(".glEditor").hide());
		var n = "number" === typeof d ? d: currentGLElement().locations.length;
		currentGLElement().locations[0] && "number" !== typeof currentGLElement().locations[0].uniqueId && (n = 0);
		"number" === typeof d && currentGLElement().locations[d] && (a.find(".rightPanelTabsWrapper").hide(), a.find(".glEditor").hide(), j = currentGLElement().locations[d], a.find("#mapGlTitle").val(j.title), a.find("#mapDmStreetAddress").val(j.street), a.find("#mapDmCity").val(j.city), a.find("#mapDmState").val(j.state), a.find("#mapDmCountry").val(j.country), a.find("#mapDmZip").val(j.zipCode), a.find("#dmglMoreInfoErea").val(j.description), a.find("#dmglPhoneEnterManually").val(j.phone), a.find("#mapDmCountry").trigger("change"), j.showPhone ? a.find("#headerSkinnySelection input").prop("checked", !0) : a.find("#headerSkinnySelection input").prop("checked", !1));
		e.createShowPhoneController(a, n);
		a.find("#mapGeneralSelection").hide();
		a.find(".dmglAddNewMenually").show();
		a.find(".glLocUpdateAddress").change(function() {
			var a = $(this).data("sec"),
			d = currentGLElement().locations[n],
			d = d || {},
			e = $(this).val().trim();
			d[a] != e && (d[a] = e, d.state = $("#mapDmState").val(), NEEGeoLocation.updateLocationElement(currentGLElement(), d, !1, void 0, n))
		});
		l(n);
		var o = function() {
			l(n).trigger("removeLink")
		};
		a.find("#dmglAddLocManuallySec .navLinkBtnRemoveDiv").off("click").click(o);
		a.find(".navLinkButtonLink, #dmglAddLocManuallySec .navLinkBtnEditDiv").unbind("click").click(function() {
			a.find(".rightPanelTabsWrapper").hide();
			a.find(".dmglAddNewMenually").hide();
			var j = n;
			a.closest("#_p_editor").find(".backButton").unbind("click");
			var k = l(n),
			r = a.find(".linkEditorForCurrent");
			r.show();
			r.data("linkEditor", r.neeLinksWidget({
				current: {
					element: k
				},
				editable: $.dmfw.editables("link"),
				noTextToDisplay: !1,
				noRemoveLink: !0,
				noSurroundButton: !0,
				onLinkRemove: o,
				onSaved: function(a) {
					"link-page" === a.id ? (a = g(a.value), a & k.attr("title", a)) : k.removeAttr("title");
					k.removeAttr("data-editor");
					k.trigger("attrChange")
				}
			}));
			e.locationLinkEdit = !0;
			a.closest("#_p_editor").find(".saveButton").hide();
			a.closest("#_p_editor").find(".updateButton").hide();
			$.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						$.dmx.current.editable.forceSelection = currentGLElement().locations[j] || e.locationLinkEdit ? j: "number" === typeof d ? j: -1;
						m()
					}
				},
				{
					title: dmStr["ui.pt.geo.102"]
				}]
			})
		});
		$.dmfw.isDudaone() || (a.find(".dmglAddLinkToLoc").mouseover(function() {
			$(this).find(".navLinkButtonsWrapper").css("visibility", "visible")
		}), a.find(".dmglAddLinkToLoc").mouseout(function() {
			$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
		}));
		k(l(n))
	};
	a.find(".glAddNew").unbind("click").click(function() {
		a.find(".rightPanelTabsWrapper").hide();
		a.find(".glEditor").hide();
		a.find(".dmglSearchAddNew").show();
		a.find("#dmglFindOnline").unbind("click").click(function() {
			$.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						m()
					}
				},
				{
					title: dmStr["ui.pt.geo.104"]
				}]
			});
			n()
		});
		a.find("#dmglAddMenual").unbind("click").click(function() {
			$.dmfw.setEditorBreadcrumb({
				parts: [{
					click: function() {
						m()
					}
				},
				{
					title: dmStr["ui.pt.geo.100"]
				}]
			});
			o()
		});
		a.closest("#_p_editor").find(".backButton").unbind("click"); ! r && 1 >= currentGLElement().locations.length ? ($(".footerEditable").find(".backButton").hide(), $(".footerEditable").find(".updateButton").show()) : ($.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					m()
				}
			},
			{
				title: dmStr["ui.pt.geo.100"]
			}]
		}), $(".footerEditable").find(".updateButton").hide())
	});
	"number" === typeof $.dmx.current.editable.forceSelection && (o($.dmx.current.editable.forceSelection), $.dmx.current.editable.forceSelection = null, a.closest("#_p_editor").find(".backButton").unbind("click"), $.dmfw.setEditorBreadcrumb({
		parts: [{
			click: function() {
				m()
			}
		},
		{
			title: dmStr["ui.pt.geo.101"]
		}]
	}));
	var r = !1,
	u = currentGLElement().locations.length,
	s = currentGLElement().locations;
	a.find(".navEditorLinks").empty();
	for (var B = 0; B < u; B++) {
		var z = a.find("#geoLocPlaceholder").clone();
		z.removeAttr("id");
		z.attr("addedIndex", B);
		z.attr("uniqueId", s[B].uniqueId);
		z.removeClass("displayNone");
		var v = !s[B].title || "" == s[B].title ? s[B].formattedAddress: s[B].title;
		z.find(".navLinkTitle").text(v);
		z.appendTo(a.find(".navEditorLinks"));
		if (!r && ("" != v || e.locationLinkEdit)) r = !0
	}
	a.find(".navLinkTitle").click(function() {
		var a = $(this),
		d = a.parent().find(".navLinkTitleInput");
		d.val(a.text().trim());
		d.show();
		d.focus();
		a.hide()
	});
	var D = function(a) {
		var d = a.parent().find(".navLinkTitle"),
		e = a.val().trim(),
		g = a.closest(".navEditorLinkAndSub").attr("addedIndex");
		e && currentGLElement().locations[g].title != e && (d.text(e), currentGLElement().locations[g].title = e, NEEGeoLocation.updateElement(currentGLElement()));
		a.hide();
		d.show()
	};
	a.find(".navLinkTitleInput").blur(function() {
		D($(this))
	});
	a.find(".navLinkTitleInput").keypress(function(a) {
		13 == a.keyCode && D($(this))
	});
	$.dmfw.isDudaone() || (a.find(".navEditorLinkAndSub").mouseover(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "visible");
		1 == a.find(".navEditorLinks .navEditorLinkAndSub").length ? $(this).find(".navLinkButtonHidden").hide() : $(this).find(".navLinkButtonHidden").show()
	}), a.find(".navEditorLinkAndSub").mouseout(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
	}));
	a.find("#glEditorInnerPanel .navLinkButtonHidden").off("click").click(function() {
		var a = $(this).closest(".navEditorLinkAndSub"),
		d = a.attr("uniqueId"),
		e = jQuery.grep(currentGLElement().locations,
		function(a) {
			return a.uniqueId == d
		})[0];
		_handleRemoveLocation(a.attr("addedIndex"), a);
		NEEGeoLocation.updateLocationElement(currentGLElement(), e, !0)
	});
	a.find("#navPages .navEditorLinkAndSub .navLinkButtonColor").click(function() {
		var d = $(this).is() ? $(this) : $(this).closest(".navEditorLinkAndSub");
		o(Number(d.attr("addedIndex")));
		a.closest("#_p_editor").find(".backButton").unbind("click");
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					m()
				}
			},
			{
				title: dmStr["ui.pt.geo.101"]
			}]
		})
	});
	a.find(".formTitleEdit").off("click").on("click",
	function() {
		$(a).neeSecondaryDesignTabs({
			selector: ".dmGeoLocTitle",
			afterTextButtonInit: function(a) {
				a.find("#dirLeft,#dirRight").hide()
			},
			tabs: {
				color: ["background", "text", "border"],
				text_style: []
			}
		});
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					$.dmx.current.editable.gLocationReadyAll(a);
					$.dmfw.setEditorBreadcrumb(null)
				}
			},
			{
				title: dmStr["ui.nee.menu.2"]
			}]
		})
	});
	a.find(".dmglWrapperDotted").on("mouseover",
	function() {
		$(this).find(".formTitleEdit").show()
	});
	a.find(".dmglWrapperDotted").on("mouseout",
	function() {
		$(this).find(".formTitleEdit").hide()
	});
	r || a.find(".glAddNew").trigger("click");
	B = currentGLElement().locations;
	u = 0;
	for (s = $.currentGLLinks.length; u < s; u++) ! B[u] && $.currentGLLinks[u] && ($.currentGLLinks[u].remove(), $.currentGLLinks[u] = void 0);
	e.locationLinkEdit && (a.find(".glEditor").hide(), a.find(".rightPanelTabsWrapper").hide(), a.find(".dmglSearchAddNew").hide());
	e.locationLinkEdit = !1
};
var currentGLElement = function(a) {
	$.currentGLElementHolder = $.currentGLElementHolder || {};
	a && ($.currentGLElementHolder.currentElement = a);
	return $.currentGLElementHolder.currentElement
};NEEGeoLocation.prototype.getDummyElement = function() {
	return $(this.defaultMarkup())
};NEEGeoLocation.prototype.isMember = function(a) {
	return $(a).is(this.getElementTagsSelectors()) ? !0 : !1
};NEEGeoLocation.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEGeoLocation.prototype.getCorrectElement = function(a) {
	return $(a).closest(".dmGeoLocation")
};NEEGeoLocation.prototype.getElementTagsSelectors = function() {
	return ".dmGeoLocation,  .dmGeoLocation *"
};NEEGeoLocation.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorGeoLocationSelected")
};NEEGeoLocation.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorGeoLocationSelected"), this.disableEditInline())
};NEEGeoLocation.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e); ! $.dmfw.isPT() && !$.dmfw.isDudaone() && (d.isEdit = !1);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEGeoLocation.prototype.disableEditInline = function() {};NEEGeoLocation.prototype.clone = function(a) {
	return new NEEGeoLocation(a)
};NEEGeoLocation.prototype.docReady = function() {};NEEGeoLocation.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.getTabs(),
		initTab: 0
	})
};NEEGeoLocation.prototype.afterInsert = function() {};NEEGeoLocation.prototype.onEditorClose = function() {
	$($.currentGLLinks).each(function(a, e) {
		e && e.remove()
	});
	$.currentGLLinks = void 0;
	$.currentGLElem = $.dmx.current.element;
	$.dmx.current.editable.locationLinkEdit = !1
};NEEGeoLocation.prototype.updateToggleTitle = function() { ! 0 == currentGLElement().displayTitle ? currentGLElement().displayTitle = !1 : currentGLElement().displayTitle = !0;
	if (!0 == $.dmx.site.isFromScratch) {
		var a = $.dmx.current.element.find(".dmwidget-title");
		"none" == a.css("display") || 0 == a.length ? currentGLElement().displayTitle = !0 : currentGLElement().displayTitle = !1
	}
	currentGLElement().forceDisplay = !0;
	NEEGeoLocation.updateElement(currentGLElement())
};NEEGeoLocation.prototype.genericUpdateTitle = function(a) {
	currentGLElement().title = a;
	currentGLElement().forceDisplay = !0;
	"" === a ? currentGLElement().displayTitle = !1 : currentGLElement().displayTitle = !0;
	NEEGeoLocation.updateElement(currentGLElement())
};NEEGeoLocation.prototype.getTabs = function() {
	var a = this;
	return {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.gLocationReadyAll
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $("#_p_editor").find(".removeLinkButton").hide());
				$(e).neePtSecondaryDesignTabs(a.getDesignSecondaryTabs())
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.settings"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && ($.dmfw.setEditorBreadcrumb(null), $("#_p_editor").find(".removeLinkButton").hide());
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
};NEEGeoLocation.prototype.getDesignSecondaryTabs = function() {
	return $.dmfw.isPT() ? {
		textSelector: ".dmGeoMLocItem a,.dmGeoSingleView",
		textColorList: ["text"],
		tabs: {
			tab_colors: ["background", "border"],
			tab_effects: ["eff_shadow", "eff_rounded_corners"],
			tab_text_style: ["text_general", "text_color"]
		}
	}: {
		textSelector: ".dmGeoMLocItem a,.dmGeoSingleView",
		tabs: {
			color: ["background", "text", "border"],
			text_style: []
		}
	}
};NEEGeoLocation.prototype.createStatesSelectBox = function(a) {
	a.find("#mapDmCountry").on("change",
	function() {
		"US" != $(this).val() ? ($("#mapDmStateLabel").css("color", "#C1CDCD"), $("#mapDmState").val(""), $("#mapDmState").attr("disabled", "disabled")) : ($("#mapDmStateLabel").css("color", ""), $("#mapDmState").removeAttr("disabled"))
	})
};NEEGeoLocation.prototype.createShowPhoneController = function(a, e) {
	a.find("#headerSkinnySelection input").prop("checked", !0);
	a.find("#headerSkinnySelection input").unbind("click").click(function() {
		a.find("#headerSkinnySelection input").is(":checked") ? currentGLElement().locations[e].showPhone = !0 : currentGLElement().locations[e].showPhone = !1;
		NEEGeoLocation.updateElement(currentGLElement());
		$(this).blur()
	})
};
function NEECoupon() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.widgets.40"]
	};
	this.ext = {
		id: "coupon",
		preId: "coupon",
		defaults: {
			needs_premium_validation: !0
		}
	};
	this.priority = 1;
	this.type = "coupon";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/couponWidget.png",
			editableDraggedText: dmStr["ui.nee.widgets.40"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.widgets.40"],
		isEdit: $.dmfw.isPT()
	};
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	var a = this;
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/coupon/nee.manageCoupon.jsp",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: function(e) {
				a.clearBreadcrumbAndButtons();
				a.couponOnTabReady(e)
			},
			onTabClose: function(a, d) {
				$.dmHideAllPagesButtons();
				d && d()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(e) {
				a.clearBreadcrumbAndButtons();
				var d = $.dmx.current.editable.element.attr("data-editor"),
				g = {
					coupon_layout: [],
					tab_colors: ["background_widgets", "border"],
					tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners"]
				};
				"image" == JSON.parse(Base64.decode(d)).couponType && (g = {
					tab_colors: ["background_widgets", "border"],
					tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners"]
				});
				$(e).neePtSecondaryDesignTabs({
					textSelector: "span.text",
					textColorList: ["text"],
					tabs: g
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(e) {
				a.clearBreadcrumbAndButtons();
				$(e).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						css: [],
						html: []
					}
				})
			}
		}]
	}
}
var currentCouponElement = function(a) {
	$.currentCouponElementHolder = $.currentCouponElementHolder || {};
	a && ($.currentCouponElementHolder.currentElement = a);
	return $.currentCouponElementHolder.currentElement
};NEECoupon.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEECoupon.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorCouponSelected")
};NEECoupon.prototype.handleTitle = new NEEPrototypeExtensionTitle;NEECoupon.prototype.clearBreadcrumbAndButtons = function() {
	0 < $($.dmfw._editors().last().id).find(".breadcrumb").find(".breadcrumb-first").length && $.dmfw.setEditorBreadcrumb(null);
	0 < $(".cropButton").length && $(".cropButton").hide();
	0 < $(".backButton").length && $(".backButton").hide()
};NEECoupon.prototype.couponOnTabReady = function(a, e) {
	var d = $.dmx.current.editable.element.attr("data-editor");
	currentCouponElement(JSON.parse(Base64.decode(d)));
	_handleTextCoupon = function() {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreCouponUI(!0)
				}
			},
			{
				title: dmStr["ui.nee.widgets.76"]
			}]
		});
		$("#couponTypeSelection").hide();
		$("#uploadCouponImageChosen").hide();
		$("#couponTypeChosen").show();
		$("#newCouponChosen").show()
	};
	_handleUploadCouponImage = function() {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreCouponUI(!0)
				}
			},
			{
				title: dmStr["ui.nee.widgets.77"]
			}]
		});
		$("#couponTypeSelection").hide();
		$("#newCouponChosen").hide();
		$("#couponTypeChosen").show();
		$("#uploadCouponImageChosen").show()
	};
	_updateExpireDate = function() {
		var a = $(this).datepicker("getDate").getTime();
		a != currentCouponElement().expDate && (currentCouponElement().expDate = a, NEECoupon.updateElement(currentCouponElement()))
	};
	_updateExpireTime = function() {
		var a = $(this).val(),
		d = $.timeValidate(a); ! 1 == d.timeValid ? ($.dmfw.showValidationError($(this), d.msg), $.dmx.editor.setValid(!1)) : ($.dmx.editor.setValid(!0), a != currentCouponElement().expTime && (currentCouponElement().expTime = a, NEECoupon.updateElement(currentCouponElement())))
	};
	_toggleElementVisibility = function(a) {
		var d = a.parent().find(".genericEditBtn"),
		e = a.parent().parent().find(".genericInput");
		a.toggleClass("hide");
		d.toggleClass("hide");
		e.toggleClass("hide")
	};
	_setTextOrPlaceholder = function(a, d, e, g) {
		d == e && !g ? a.attr("placeholder", e) : a.val(d)
	};
	_hideOrSetText = function(a, d, e, g, n, o) {
		a ? _setTextOrPlaceholder(e, g, n, o) : _toggleElementVisibility(d)
	};
	this.handleTitle.widgetRuntimeTitle = currentCouponElement().title;
	this.handleTitle.displayTitle = currentCouponElement().displayTitle;
	this.handleTitle.handleTitleinit(a);
	_setTextOrPlaceholder($(".genericInput[property\x3duseBtn]"), currentCouponElement().useBtn, dmStr["ui.nee.widgets.46"], !0);
	_hideOrSetText(currentCouponElement().displaySave, $(".genericToggleBtn[toggleProperty\x3ddisplaySave]"), $(".genericInput[property\x3dsaveBtn]"), currentCouponElement().saveBtn, dmStr["ui.nee.widgets.47"]);
	_hideOrSetText(!0, null, $(".genericInput[property\x3dcouponName]"), currentCouponElement().couponName);
	_hideOrSetText(currentCouponElement().displayShare, $(".genericToggleBtn[toggleProperty\x3ddisplayShare]"), $(".genericInput[property\x3dshareBtn]"), currentCouponElement().shareBtn, dmStr["ui.nee.widgets.48"], !0);
	var g = $(".expDateAndHours");
	g.find(".datePicker").datepicker({
		minDate: new Date((new Date).getTime()),
		onSelect: _updateExpireDate
	});
	currentCouponElement().expDate && g.find(".datePicker").datepicker("setDate", new Date(currentCouponElement().expDate));
	require(["neeUtils/timePicker/jquery.timePicker", "neeUtils/lib/slides/slides.jquery"],
	function() {
		g.find(".timePicker").timePicker({
			show24Hours: !1,
			step: 60
		});
		g.find(".timePicker").val(currentCouponElement().expTime);
		g.find(".timePicker").on("change", _updateExpireTime)
	});
	$.dmfw.isPT() && $.ptToolTips.setToolTip($("#couponExpireDateTip"), dmStr["ui.nee.widgets.62"], void 0, void 0, $.ptToolTips.getOptions(), !1);
	"image" == currentCouponElement().couponType ? (d = $("#uploadCouponImageChosen").find(".smallTempPlaceHlderForImage"), currentCouponElement().imageUrl && (d.css("background-image", "url(" + currentCouponElement().imageUrl + ")"), d.addClass("hasImage")), $("#couponChangeImage").click(function() {
		$(".smallTempPlaceHlderForImage").trigger("click")
	}), $("#couponLogoCrop").click(function() {
		var a = $(this).parents(".editImage").eq(0).find(".smallTempPlaceHlderForImage");
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreCouponUI()
				}
			},
			{
				title: dmStr["ui.crop"]
			}]
		});
		NEECoupon.handleCropImage(a)
	}), NEECoupon.initImageEditor(), d.neePopUpDiv($("#headerToOpenChange"), {
		init: NEECoupon.initImageSelection,
		toChangeFunction: NEECoupon.onImageSelected,
		showIphone: !0
	}), e || _handleUploadCouponImage()) : "text" == currentCouponElement().couponType && (_setTextOrPlaceholder($(".genericInput[property\x3doffer]"), currentCouponElement().offer, dmStr["ui.nee.widgets.67"]), _hideOrSetText(currentCouponElement().displayMainMessage, $(".genericToggleBtn[toggleProperty\x3ddisplayMainMessage]"), $(".genericInput[property\x3dmainMessage]"), currentCouponElement().mainMessage, dmStr["ui.nee.widgets.68"]), _hideOrSetText(currentCouponElement().displayTerms, $(".genericToggleBtn[toggleProperty\x3ddisplayTerms]"), $(".genericInput[property\x3dterms]"), currentCouponElement().terms, dmStr["ui.nee.widgets.69"]), e || _handleTextCoupon());
	_restoreCouponUI = function(a) {
		var d = $(".rightPanel");
		d.empty();
		$.dmfw.setEditorBreadcrumb(null);
		$(".cropButton").hide();
		$.dmLoad(d, "/editor/nee/editableObjects/coupon/nee.manageCoupon.jsp",
		function() {
			NEECoupon.prototype.couponOnTabReady(d, a)
		})
	};
	_setCouponBreadcrumb = function(a) {
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreCouponUI()
				}
			},
			{
				title: a
			}]
		})
	};
	_validateInputFieldTextChange = function(a) {
		if (void 0 == a.attr("mandatory")) return ! 0;
		if ("" == a.val()) return $.dmfw.showValidationError("#dmCouponOfferInput", dmStr["ui.nee.promptMassages.17"]),
		$.dmx.editor.setValid(!1),
		!1;
		$.dmx.editor.setValid(!0);
		return ! 0
	};
	_updateInputFieldText = function(a) {
		var d = a.attr("property");
		_validateInputFieldTextChange(a) && currentCouponElement()[d] != a.val() && (a.attr("placeholder") && a.attr("placeholder", ""), currentCouponElement()[d] = a.val(), NEECoupon.updateElement(currentCouponElement()))
	};
	$("#newCouponOption").unbind("click").click(function() {
		$("#couponChangableLayout").removeClass("couponDefaultChoise");
		currentCouponElement().couponType = "text";
		NEECoupon.updateElement(currentCouponElement());
		_restoreCouponUI()
	});
	$("#uploadCouponImageOption").unbind("click").click(function() {
		$("#mapChangableLayout").removeClass("couponDefaultChoise");
		currentCouponElement().couponType = "image";
		NEECoupon.updateElement(currentCouponElement());
		_restoreCouponUI()
	});
	$(".genericInputWrapper").mouseover(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "visible")
	});
	$(".genericInputWrapper").mouseout(function() {
		$(this).find(".navLinkButtonsWrapper").css("visibility", "hidden")
	});
	$(".genericInputWrapper input").not(".dateTimeInput").blur(function() {
		_updateInputFieldText($(this))
	});
	$(".genericInputWrapper input").not(".dateTimeInput").keypress(function(a) {
		13 == a.keyCode && _updateInputFieldText($(this))
	});
	$(".genericEditBtn").click(function() {
		$(".couponPanelSettings").hide();
		var d = $(this).parent().attr("selector"),
		e = $(this).parent().attr("breadcrumbText");
		$(a).neeSecondaryDesignTabs({
			selector: d,
			tabs: {
				color: ["background-color", "text", "border"],
				text_style: []
			},
			forceClassName: d,
			useCurElem: !0,
			colorCallbacks: {
				background: NEECoupon.backgroundColorUpdated
			}
		});
		$.dmfw.setEditorBreadcrumb({
			parts: [{
				click: function() {
					_restoreCouponUI()
				}
			},
			{
				title: e
			}]
		})
	});
	$(".genericToggleBtn").click(function() {
		var a = $(this);
		_toggleElementVisibility(a);
		a = a.attr("toggleProperty");
		currentCouponElement()[a] = !currentCouponElement()[a];
		NEECoupon.updateElement(currentCouponElement())
	})
};NEECoupon.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorCouponSelected"), this.disableEditInline())
};NEECoupon.prototype.isMember = function(a) {
	var e = !1;
	$(a).is(".dmCoupon *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEECoupon.prototype.getElementTagsSelectors = function() {
	return ".dmCoupon"
};NEECoupon.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEECoupon.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEECoupon.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEECoupon.prototype.disableEditInline = function() {};NEECoupon.prototype.docReady = function() {};NEECoupon.prototype.getDefaultIconName = function() {
	return "couponWidget.png"
};NEECoupon.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};NEECoupon.prototype.checkClose = function() {
	$.dmfw.changeTabTo(1,
	function() {
		$.dmfw._closeEditorAll({
			override: !0
		})
	})
};NEECoupon.updateElement = function(a, e) {
	var d = $.dmx.current.element,
	g = Base64.encode(JSON.stringify(currentCouponElement())),
	j = {
		"data-editor": g
	};
	$.changePage({
		clientChange: function() {
			d.attr("data-editor", g)
		},
		serverChange: function() {
			$.dmsrv.updateExtension(d, j, {
				successCallback: function() {
					currentCouponElement(JSON.parse(Base64.decode(g)));
					e && e()
				}
			})
		}
	})
};NEECoupon.onImageSelected = function(a) {
	$(".closeThis").trigger("click");
	a = a.replace(/ /g, "%20");
	var e = $(".smallTempPlaceHlderForImage");
	e.css("background-image", "url(" + a + ")");
	e.addClass("hasImage");
	currentCouponElement().imageUrl = a;
	NEECoupon.updateElement(currentCouponElement(), NEECoupon.initImageEditor)
};NEECoupon.initImageEditor = function() {
	var a = $.dmx.current.element.is("img") ? $.dmx.current.element: $.dmx.current.element.find("img");
	"" == a.attr("src") || void 0 == a.attr("src") ? $("#couponEditImage").hide() : ($("#couponEditImage").show(), $("#couponEditImage").unbind("click").bind("click",
	function() {
		return $.dmops.editImageWithAviary(a,
		function(a, d) {
			NEECoupon.onImageSelected(d)
		})
	}))
};NEECoupon.initImageSelection = function(a) {
	a.show();
	a.neeSecondaryIconTabs({
		tabs: {
			upload: [{
				isChange: !1
			}],
			original_images: [],
			url: []
		},
		callback: NEECoupon.onImageSelected,
		uploadBiggerButton: !0
	})
};NEECoupon.handleCropImage = function() {
	var a = $(".rightPanel");
	$.dmx.current.element.removeAttr("dm_crop_dim");
	$.dmx.current.element.removeAttr("dm_orig_src");
	a.empty();
	a.append($("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e"));
	var e = $.dmx.current.element.find("img"),
	d = e.height(),
	d = e.width() / d;
	a.neeSecondaryDesignTabs({
		tabs: {
			crop: []
		},
		sliderCropOptions: {
			aspectRatio: d,
			element: e,
			imgSrc: e.attr("src").replace(/"/g, "").replace(/'/g, ""),
			currElemDmid: e.dmid(),
			imgElem: e,
			callback: function(a) {
				a = a.croppedImageSource.replace(/ /g, "%20");
				var d = $(".smallTempPlaceHlderForImage");
				d.css("background-image", "url(" + a + ")");
				d.addClass("hasImage");
				currentCouponElement().imageUrl = a;
				NEECoupon.updateElement(currentCouponElement())
			}
		}
	})
};NEECoupon.prototype.updateToggleTitle = function() { ! 0 == currentCouponElement().displayTitle ? currentCouponElement().displayTitle = !1 : currentCouponElement().displayTitle = !0;
	currentCouponElement().forceDisplay = !0;
	NEECoupon.updateElement(currentCouponElement())
};NEECoupon.prototype.genericUpdateTitle = function(a) {
	currentCouponElement().title = a;
	currentCouponElement().forceDisplay = !0;
	"" === a ? currentCouponElement().displayTitle = !1 : currentCouponElement().displayTitle = !0;
	NEECoupon.updateElement(currentCouponElement())
};NEECoupon.prototype.bindLayoutAction = function() {
	var a = currentCouponElement().layout;
	$("#couponLayoutContainer").on("click", "a.couponLayout", $.dmx.current.editable.changeCouponLayout).find("a.couponLayout[layout\x3d'" + a + "']").addClass("active")
};NEECoupon.prototype.changeCouponLayout = function() {
	var a = $(this).attr("layout");
	$("#couponLayoutContainer").find("a.couponLayout").removeClass("active");
	$(this).addClass("active");
	currentCouponElement().layout = a;
	NEECoupon.updateElement(currentCouponElement(), NEECoupon.forceUpdateOfferBorder)
};NEECoupon.backgroundColorUpdated = function(a) {
	$.dmops.updateCurrentCss({
		classesToRemove: null,
		attrToRemove: null,
		classesToAdd: null,
		attrToAdd: [{
			attr: "background-color",
			value: a
		}]
	},
	{
		selector: this.selector,
		element: $.dmx.current.element,
		notClearStyle: !0,
		success: NEECoupon.updateOfferBorder
	})
};NEECoupon.forceUpdateOfferBorder = function() {
	NEECoupon.updateOfferBorder(!0)
};NEECoupon.prototype.clone = function(a) {
	return new NEECoupon(a)
};NEECoupon.updateOfferBorder = function(a) {
	if (".dmCouponOffer" == this.selector && "text" == currentCouponElement().couponType || a) {
		a = $.dmx.current.element;
		var e = {},
		d = a.find(".dmCouponOffer").css("background-color");
		"layoutA" == currentCouponElement().layout ? e = {
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: "background-image",
				value: "linear-gradient(45deg, " + d + " 3px, transparent 0px), linear-gradient(135deg, " + d + " 3px, transparent 0px)"
			}]
		}: "layoutC" == currentCouponElement().layout ? e = {
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: "background-image",
				value: "linear-gradient(-45deg, " + d + " 3px, transparent 0px), linear-gradient(-135deg, " + d + " 3px, transparent 0px)"
			}]
		}: "layoutB" == currentCouponElement().layout && (e = {
			classesToRemove: null,
			attrToRemove: null,
			classesToAdd: null,
			attrToAdd: [{
				attr: "background-image",
				value: "linear-gradient(135deg, " + d + " 3px, transparent 0px), linear-gradient(225deg, " + d + " 3px, transparent 0px)"
			}]
		});
		$.dmops.updateCurrentCss(e, {
			selector: ".dmCouponOfferBorder",
			element: a,
			notClearStyle: !0
		})
	}
};$.dmui.registerProvider(PRODUCT_PROVIDER, "GOMO", {
	flowInterceptor: {},
	resources: {
		bodyClass: "GOMO",
		shellWrapperClass: "GOMO",
		forceWR: !0
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "YAHOO", {
	flowInterceptor: {
		onReload: function() {
			$(".shellBodyFluidWrapper").addClass("neeTotalStepsNumThree");
			$(".shellClose a").attr("onclick", "javascript:window.location\x3d'http://smallbusiness.yahoo.com/services/'");
			$("#headerLogoLink").attr("href", "javascript:void(0);")
		},
		postUpdateContext: function() {
			"UNDER_CONSTRUCTION" == $.dmx.site.status && $.dmfw.openPopup($("\x3cdiv class\x3d'neeYahooUCStatusPopup'\x3e\x3cdiv class\x3d'topText'\x3eIf you've built and published your Yahoo! Web Hosting desktop web site, check back soon for access to your mobile site tools.\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3eIf you haven't, please complete this step and try again.\x3c/div\x3e\x3cspan class\x3d'blueBtn okBtn'\x3eOK\x3c/span\x3e\x3c/div\x3e"), {
				init: function(a) {
					a.find(".okBtn").unbind("click").click(function() {
						window.location = "http://smallbusiness.yahoo.com/services/"
					})
				},
				beforeClose: function() {
					window.location = "http://smallbusiness.yahoo.com/services/"
				},
				dontCloseAutomatically: !0,
				disableDrag: !0,
				popupAdditionalClass: "neeYahooUCStatusPopupWrapper"
			})
		}
	},
	resources: {
		bodyClass: "YAHOO",
		shellWrapperClass: "YAHOO",
		publishPanel: "/editor/product/yahoo/js/nee.yahooPublishPanel.jsp"
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "YJP", {
	flowInterceptor: {
		onReload: function(a) {
			$("#headerLogoLink").removeAttr("href");
			$(".headerDudaLogo").parent("a").removeAttr("href");
			a.currTab == NAV_TEMPLATES_ID && (a.currTab = NAV_DESIGN_ID)
		},
		postUpdateContext: function() {}
	},
	resources: {
		bodyClass: "YJP",
		shellWrapperClass: "YJP",
		forceWR: !0,
		requiresWhiteLabelUrl: !0,
		showResellerScreenOnPublish: !0,
		customScript: "YJ_redirect",
		redirectFunctionName: "YJ_redirect",
		returnToDashboardLink: "/home/dashboard",
		widgetsToRemove: ["googlecheckout", "adsense", "opentable"],
		dashboardOptions: {
			activeUserMenu: !1,
			activeLanguageSelection: !1,
			hasAccountSetting: !1,
			activeAutoComplete: !1,
			ClearSearchLink: !1,
			maxSitesAllow: 5,
			hideAliasInStats: !0,
			hidePlans: !0,
			hideThumbnails: !0,
			hideLabels: !0,
			itemsPerPage: null,
			hideEmailShare: !0,
			noReset: !0,
			actionsIconText: !0,
			noReset: !0,
			logoLink: !1,
			customeMenus: {
				footerMenu: {
					replaceDuda: !0,
					links: [{
						desc: dmStr["ui.nee.dashboard.15"],
						href: "http://docs.yahoo.co.jp/docs/info/terms/chapter1.html#cf2nd",
						target: null
					},
					{
						desc: dmStr["ui.nee.dashboard.16"],
						href: "http://promotionalads.yahoo.co.jp/legal/SSB.html",
						target: ""
					},
					{
						desc: dmStr["ui.nee.dashboard.17"],
						href: "http://promotionalads.yahoo.co.jp/form/support/",
						target: ""
					}]
				},
				topMenu: {
					supportLink: {
						href: "http://yahoo-jp-ss.custhelp.com/app/answers/list/c/162,163,1175,1176"
					},
					hideBlogLink: !0,
					hideMobileAdsLink: !0,
					hideTopLinkWhenNoSite: !0
				}
			}
		}
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "JALAN", {
	flowInterceptor: {
		onReload: function() {
			$("#headerLogoLink").removeAttr("href")
		},
		postUpdateContext: function() {},
		onDesignTabReady: function() {
			$("#_designBasicWrapper").hide();
			$("#_designAdvancedWrapper").show()
		}
	},
	resources: {
		bodyClass: "JALAN",
		shellWrapperClass: "JALAN",
		forceWR: !0,
		pagingWidgetStartFirstPage: !0,
		widgetsToRemove: [],
		dashboardOptions: {
			noReset: !0
		},
		widgetsToAdd: "clicktomap jalan_res jalan_gallery emailextension image photoGallery imageSlider paragraph Button Columns Tabs Divider spacer Home Title Youtube".split(" "),
		allWidgetsFeatured: !0,
		hideAllWidgets: !0
	},
	activateProduct: function(a) {
		a = a || {};
		a.dm_account_roles = a.dm_account_roles || "";
		a = a.dm_account_roles.split(" ");
		return - 1 == $.inArray(commonProps.adminRoleName.toUpperCase(), a) && -1 == $.inArray(commonProps.adminRoleName.toLowerCase(), a)
	},
	alternateProvider: function() {
		return {
			resources: {
				bodyClass: "JALAN_ADMIN",
				shellWrapperClass: "JALAN_ADMIN",
				pagingWidgetStartFirstPage: !0,
				widgetsToAddForAdmin: ["jalan_res", "jalan_gallery"],
				dashboardOptions: {
					noReset: !0
				}
			}
		}
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "RESELLER", {
	resources: {
		bodyClass: "WLUSER",
		shellWrapperClass: "WLUSER",
		customScript: "redirect",
		redirectFunctionName: "Mobile_redirect",
		requiresWlURL: !0,
		showResellerScreenOnPublish: !0,
		dashboardOptions: {
			activeUserMenu: !0,
			activeLanguageSelection: !1,
			hasAccountSetting: !0,
			activeAutoComplete: !0,
			ClearSearchLink: !1,
			maxSitesAllow: null,
			hidePlans: !0,
			hideLabels: !0,
			itemsPerPage: null,
			hideEmailShare: !1,
			actionsIconText: !1,
			logoLink: null,
			customeMenus: {
				footerMenu: {
					hideBBB: !0,
					replaceDuda: !0,
					links: []
				},
				topMenu: {
					supportLink: null,
					hideAll: !1,
					hideBlogLink: !0,
					hideMobileAdsLink: !0,
					hideTopLinkWhenNoSite: !1,
					hidePartnerPortalLink: !0,
					hideSupportLink: !0
				}
			},
			renewalUrgentDays: 7,
			maxSnapshots: -1,
			hideCreateSideBtn: !0,
			disableDeleteSite: !0
		}
	}
});$.extend({
	dmYahooPub: {
		init: function(a) {
			$("#_publish .panelsTitleWrapper .panelTitleQmark").dmQtip({
				content: dmStr["ui.nee.publishPanel.201"]
			});
			a = a || {};
			$.dmYahooPub._getSiteState(a, $.dmYahooPub._handleState)
		},
		_handleState: function(a) {
			a.justPublished ? ($.dmYahooPub._showConfirmationScreen(a), $.dmx.firstPublished = null) : $.dmYahooPub._initNoPayment(a, $.dmYahooPub._publish);
			$.dmYahooPub._handleDomain(a)
		},
		_handleDomain: function() {
			$.dmx.site.domain || ($(".neeEditOpt").show(), $("#intuitPublishSetMdotCheckbox").unbind("change").change(function() {
				$("#intuitPublishSetMdotCheckbox").is(":checked") ? $(".neeRedirectSetupUrlBox").show("fast") : $(".neeRedirectSetupUrlBox").hide("fast");
				$.dmredi._readProviders();
				var a = $.dmx.site.suggestedDomain;
				null != $.dmx.site.domain && (a = $.dmx.site.domain);
				$("#intuitNewCname").val(a).unbind("keyup").keyup(function() {
					$(".dmRediDomainMsg").text(" ")
				});
				$("#intuitNewCnameApplyBtn").unbind("click").click(function() {
					var a = $("#intuitNewCname").val();
					a && "" != a && $.dmsrv.assignSiteDomain(a,
					function() {
						$(".neeRepublishSiteUrl").text(a);
						$(".neeEditOpt").hide()
					})
				})
			}))
		},
		_initNoPayment: function(a, e) {
			$.dmYahooPub._initNoPaymentLayoutChanges(a);
			$.dmYahooPub._initNoPaymentButtons(a, e);
			$.dmYahooPub._show()
		},
		_initNoPaymentButtons: function(a, e) {
			$(".neeRepublishBtn").show();
			$(".neeRepublishBtn").unbind("click").click(function() {
				$(".neeRepublishBtn").unbind("click");
				e(a)
			});
			a.published && $.dmYahooPub._initRollbackLinks(a)
		},
		_initRollbackLinks: function(a) {
			$("#dmwrRollback").neeConfirmationPopUpDiv(dmStr["ui.nee.publishPanel.209"], {
				liveClick: !0,
				initCallback: function() {
					$.dmYahooPub._rollback(a)
				}
			})
		},
		_initNoPaymentLayout: function(a) {
			$(".neePublishTitle").hide();
			$(".neeConfirmRePublishTitle").show();
			$(".neeRepublishWr").show();
			$.dmYahooPub._afterTitleInit(a)
		},
		_initNoPaymentLayoutChanges: function(a) {
			$(".neePublishTitle").hide();
			$(".neeRepublishTitle").show();
			$(".neeRepublishWr").show();
			$.dmYahooPub._afterTitleInit(a)
		},
		_afterTitleInit: function(a) {
			a.published ? ($(".neeRepublishPart").show(), $(".neeRepublishSiteUrl").text($.dmx.site.domain ? $.dmx.site.domain: $.dmx.site.mobileUrl), $(".neePublishRollbackWrapper").show(), $.dmYahooPub._initShareButtons(a)) : $(".neeRepublishPart").hide()
		},
		_initShareButtons: function() {
			$(".dmwrFBShare").unbind("click").click(function() {
				FB.ui({
					method: "stream.publish",
					message: dmStr["ui.nee.publishPanel.211"],
					caption: $.dmx.site.mobileUrl,
					name: dmStr["ui.nee.publishPanel.212"],
					link: $.dmx.site.mobileUrl,
					display: "popup"
				})
			});
			$(".dmwrGPShare").unbind("click").click(function() {
				window.open("http://plus.google.com/share?url\x3d" + escape($.dmx.site.mobileUrl))
			});
			$(".dmwrTShare").unbind("click").click(function() {
				window.open("http://twitter.com/intent/tweet?url\x3d" + escape($.dmx.site.mobileUrl) + "\x26text\x3d" + dmStr["ui.nee.publishPanel.213"] + "  \x26via\x3ddudamobile")
			});
			$(".neePublishSharePanel g:plusone").attr("href", escape($.dmx.site.mobileUrl));
			$(".dmwrQRShare").dmQrCodePopup({
				url: $.dmx.site.mobileUrl
			});
			$(".dmwrMailShare").shareByEmailPopup({
				mailType: "SHARE_SITE",
				siteAddress: $.dmx.site.mobileUrl,
				addTryModeParam: !1
			})
		},
		_publish: function(a, e) {
			$.dmsrv.publishSite(function(d) {
				wrTrackEvent(WR_SITE_PUBLISHED, {
					plan: "premium"
				});
				e ? e() : $.dmYahooPub._afterPublish(a, d)
			})
		},
		_rollback: function(a) {
			$.dmUIBlockControlled({
				region: "publish.rollback",
				op: "block",
				style: "wheel",
				container: $("#neePublishContent")
			});
			$.dmsrv.rollbackSite(function() {
				$.dmops.updateEditContext.all({
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.dmYahooPub._handleState(a);
							$.dmUIBlockControlled({
								region: "publish.rollback",
								op: "unblock",
								style: "wheel"
							})
						})
					}
				})
			})
		},
		_afterPublish: function(a) {
			a.published || (a.published = !0);
			a.justPublished = !0;
			$.dmYahooPub._handleState(a)
		},
		_showConfirmationScreen: function(a) {
			$.dmYahooPub._initNoPaymentLayout(a);
			$.dmYahooPub._show()
		},
		_showTitle: function(a) {
			$(".neePublishTitle").hide();
			a && $(a).show()
		},
		_show: function() {
			$("#neePublishContent").removeClass("dmVisibilityHidden");
			$.dmUIBlockControlled({
				region: "publish.screeen",
				op: "unblock",
				style: "wheel"
			});
			$.dmUnblockUI()
		},
		_getSiteState: function(a, e) {
			$.dmops.updateEditContext.site({
				withRedirect: !0,
				success: function() {
					var a = {};
					a.published = $.dmx.site.isPublished;
					a.republished = !0;
					a.premium = $.dmx.isPremium();
					a.redirected = $.dmx.site.isRedirected;
					a.justPublished = $.dmx.firstPublished;
					e(a)
				}
			})
		}
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "GDWST", {
	flowInterceptor: {
		onReload: function(a) {
			a && (a.currTab = "design" === $.getCookie("_dm_editor_curr_tab") ? NAV_DESIGN_ID: NAV_TEMPLATES_ID)
		},
		onDesignTabReady: function() {
			$.setCookie("_dm_editor_curr_tab", "design", 120, "/", !1)
		},
		postUpdateContext: function() {
			"UNDER_CONSTRUCTION" == $.dmx.site.status && $.dmfw.openPopup($("\x3cdiv class\x3d'neeGDWSTUCStatusPopup'\x3e\x3cdiv class\x3d'topText'\x3eHang tight...\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3eWe're still building your new mobile website.\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3ePlease, check back soon.\x3c/div\x3e\x3c/div\x3e"), {
				init: function() {},
				dontCloseAutomatically: !0,
				disableDrag: !0,
				popupAdditionalClass: "neeGDWSTUCStatusPopupWrapper"
			})
		}
	},
	resources: {
		bodyClass: "GDWST",
		shellWrapperClass: "GDWST",
		forceWR: !0
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "GDH", {
	flowInterceptor: {
		onReload: function(a) {
			a && (a.currTab = "design" === $.getCookie("_dm_editor_curr_tab") ? NAV_DESIGN_ID: NAV_TEMPLATES_ID);
			$.dmGdhMng.initGeneral()
		},
		onDesignTabReady: function() {
			$.setCookie("_dm_editor_curr_tab", "design", 120, "/", !1);
			$.dmGdhMng.initDesignTab()
		},
		onPublishTabReady: function() {
			$(".neeRepublishBtn").text("SAVE MY CHANGES");
			$(".neePublishSection .neeRepublishTitle.neePublishTitle").text(" Made some changes? Click save to apply them to your site.");
			$.dmGdhMng.initPublishTab()
		},
		onTemplatesTabReady: function() {
			$.dmGdhMng.initTemplatesTab()
		},
		postUpdateContext: function() {
			"UNDER_CONSTRUCTION" == $.dmx.site.status && $.dmfw.openPopup($("\x3cdiv class\x3d'neeGDHUCStatusPopup'\x3e\x3cdiv class\x3d'topText'\x3eHang tight...\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3eWe're still building your new mobile website.\x3c/div\x3e\x3cdiv class\x3d'bottomText'\x3ePlease, check back soon.\x3c/div\x3e\x3c/div\x3e"), {
				init: function() {},
				dontCloseAutomatically: !0,
				disableDrag: !0,
				popupAdditionalClass: "neeGDHUCStatusPopupWrapper"
			})
		},
		onNavigate: function() {}
	},
	resources: {
		bodyClass: "GDH",
		shellWrapperClass: "GDH",
		forceWR: !0
	}
});$.extend({
	dmGdWstDesign: {
		init: function() {
			$.dmfw.setPreviewEditPolicy && $.dmfw.setPreviewEditPolicy(!1);
			var a = !1;
			$.dmGdWstDesign.refreshBasicDesignViewForWidgets();
			$("#designOpenNavigation, #designOpenNavigationBasic").unbind("click").click(function() {
				var a = $.navigationUtil.selectCorrectNavigationElementInPreview();
				0 != a.length && $.dmops.scrollPreviewToElement(a);
				$.dmfw.selectAndOpenEditor(a);
				$.hideAllSelection()
			});
			$("#designOpenBackground").unbind("click").click(function() {
				var a = new NEEGlobalText;
				$.dmfw.openGlobalEditor({
					editable: a
				})
			});
			$(".designOpenHeader").unbind("click").click(function() {
				var a = $.dmfw.getPreviewElement("DIV.dmHeader");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.hideAllSelection()) : (a = new NEEHeader, $.dmfw.openGlobalEditor({
					editable: a
				}))
			});
			$("#designOpenClickToCallBasic").unbind("click").click(function() {
				if (!1 == a) {
					a = !0;
					$(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.101"]);
					var e = $.dmfw.getPreviewElement("A.dmCall");
					0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e), $.hideAllSelection()) : (e = new NEEClickToCall, $.dmops.insertElement(e, null, null, {
						scrollToElement: !0,
						hideAllSelection: !0
					}), $.hideAllSelection(), $("#gdWstRemoveCall").addClass("active"));
					setTimeout(function() {
						a = !1
					},
					400)
				}
			});
			$("#designOpenClickToMapBasic").unbind("click").click(function() {
				if (!1 == a) {
					a = !0;
					$(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.103"]);
					var e = $.dmfw.getPreviewElement("A.dmMap");
					0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e), $.hideAllSelection()) : (e = new NEEClickToMap, $.dmops.insertElement(e, null, null, {
						scrollToElement: !0,
						hideAllSelection: !0
					}), $.hideAllSelection(), $("#gdWstRemoveMaps").addClass("active"));
					setTimeout(function() {
						a = !1
					},
					400)
				}
			});
			$("#designOpenClickToTextBasic").unbind("click").click(function() {
				if (!1 == a) {
					a = !0;
					$(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.301"]);
					var e = $.dmfw.getPreviewElement("A.dmSms");
					0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e), $.hideAllSelection()) : (e = new NEEClickToSms, $.dmops.insertElement(e, null, null, {
						scrollToElement: !0,
						hideAllSelection: !0
					}), $.hideAllSelection(), $("#gdWstRemoveSendText").addClass("active"));
					setTimeout(function() {
						a = !1
					},
					400)
				}
			});
			$("#designOpenClickToInfoBasic").unbind("click").click(function() {
				if (!1 == a) {
					a = !0;
					$(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.303"]);
					var e = $.dmfw.getPreviewElement("A.dmSmsInfo");
					0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e), $.hideAllSelection()) : (e = new NEESendBizInfo, $.dmops.insertElement(e, null, null, {
						scrollToElement: !0,
						hideAllSelection: !0
					}), $.hideAllSelection(), $("#gdWstRemoveSendInfo").addClass("active"));
					setTimeout(function() {
						a = !1
					},
					400)
				}
			});
			$("#gdWstRemoveCall").unbind("click").click(function(a) {
				a.stopPropagation();
				$.dmops.deleteElement($.dmfw.getPreviewElement("A.dmCall"));
				$.dmGdWstDesign.refreshBasicDesignViewForWidgets()
			});
			$("#gdWstRemoveMaps").unbind("click").click(function(a) {
				a.stopPropagation();
				$.dmops.deleteElement($.dmfw.getPreviewElement("A.dmMap"));
				$.dmGdWstDesign.refreshBasicDesignViewForWidgets()
			});
			$("#gdWstRemoveSendText").unbind("click").click(function(a) {
				a.stopPropagation();
				$.dmops.deleteElement($.dmfw.getPreviewElement("A.dmSms"));
				$.dmGdWstDesign.refreshBasicDesignViewForWidgets()
			});
			$("#gdWstRemoveSendInfo").unbind("click").click(function(a) {
				a.stopPropagation();
				$.dmops.deleteElement($.dmfw.getPreviewElement("A.dmSmsInfo"));
				$.dmGdWstDesign.refreshBasicDesignViewForWidgets()
			})
		},
		refreshBasicDesignViewForWidgets: function() {
			0 != $.dmfw.getPreviewElement("A.dmCall").length ? ($("#designOpenClickToCallBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.101"]), $("#gdWstRemoveCall").addClass("active")) : ($("#designOpenClickToCallBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.102"]), $("#gdWstRemoveCall").removeClass("active"));
			0 != $.dmfw.getPreviewElement("A.dmMap").length ? ($("#designOpenClickToMapBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.103"]), $("#gdWstRemoveMaps").addClass("active")) : ($("#designOpenClickToMapBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.104"]), $("#gdWstRemoveMaps").removeClass("active"));
			0 != $.dmfw.getPreviewElement("A.dmSms").length ? ($("#designOpenClickToTextBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.301"]), $("#gdWstRemoveSendText").addClass("active")) : ($("#designOpenClickToTextBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.300"]), $("#gdWstRemoveSendText").removeClass("active"));
			0 != $.dmfw.getPreviewElement("A.dmSmsInfo").length ? ($("#designOpenClickToInfoBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.303"]), $("#gdWstRemoveSendInfo").addClass("active")) : ($("#designOpenClickToInfoBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.302"]), $("#gdWstRemoveSendInfo").removeClass("active"));
			$.dmfw.setPreviewEditPolicy && $.dmfw.setPreviewEditPolicy(!1)
		}
	}
});$.extend(function() {
	function a(a) {
		url = "/editor/product/gdh/html/navAdditionToEditor.jsp";
		wrapper = $("\x3cdiv\x3e\x3c/div\x3e");
		$(a).append(wrapper);
		a.find(".navAddition").remove();
		wrapper.addClass("navAddition");
		wrapper.load(url,
		function() {
			a.find("#settingsButton").unbind("click.open").bind("click.open",
			function() {
				a.find(".gdhSettingsPopup").is(":visible") ? a.find(".gdhSettingsPopup").hide() : a.find(".gdhSettingsPopup").show()
			});
			$(window).unbind("click.close").bind("click.close",
			function(a) {
				$(a.target).is(".gdhSettingsPopup, .gdhSettingsPopup *, #settingsButton") || $(".gdhSettingsPopup").hide()
			});
			$(".HeaderSubMenu #navsettings").click(function() {
				$(".gdhSettingsPopup").hide();
				NEFW.navigateToTabWithHistory("navsettings", $.dmx.site.alias)
			});
			$(".HeaderSubMenu #navglobalcss").click(function() {
				$(".gdhSettingsPopup").hide();
				NEFW.navigateToTabWithHistory("navglobalcss", $.dmx.site.alias)
			});
			$(".HeaderSubMenu #originalSite").click(function() {
				$(".gdhSettingsPopup").hide();
				window.open($.dmx.rt.liveUrl, "_blank")
			});
			$(".HeaderSubMenu #navpages").click(function() {
				$(".gdhSettingsPopup").hide();
				NEFW.navigateToTabWithHistory("navpages", $.dmx.site.alias)
			});
			null != $.dmx.site && $.dmx.site.isBlog && $(".gdhSettingsPopup  li#navpages").remove()
		})
	}
	return {
		dmGdhMng: {
			initDesignTab: function() {
				var e = $("\x3cdiv\x3e\x3c/div\x3e");
				$("#designControlViews").append(e);
				$(".GDH .resetSiteWrap").remove();
				e.addClass("resetSiteWrap");
				e.load("/editor/product/gdh/html/designPanelResetSite.jsp",
				function() {
					$("#resetMySiteButton").neeConfirmationPopUpDiv("Are you sure you want to reset your site?", {
						forceWidth: "420px",
						initCallback: function() {
							NEFW.recreateSite($.dmx.site.alias, !$.dmx.site.isBlog)
						}
					})
				});
				a($("#designControlViews"))
			},
			initPublishTab: function() {
				a($("#neePublishContent"))
			},
			initTemplatesTab: function() {
				a($("#_templates"))
			},
			initGeneral: function() {
				$("#navpublish .neePanelsStepsMenuText").eq(0).hide();
				$("#navpublish .neePanelsStepsMenuText").eq(1).show()
			}
		}
	}
} ());$.dmui.registerProvider(PRODUCT_PROVIDER, "DM_DIRECT",
function() {
	function a() {
		return dm_use_only_mdot_in_redirect ? "/editor/nee/mainTabs/nee.redirectPanelWithMDot.jsp": "/editor/nee/mainTabs/nee.redirectPanel.jsp"
	}
	function e() {
		var a = commonProps["common.publish.ab.perc"],
		e = commonProps["common.publish.ab.use"],
		e = e && !isReseller && !$.dmfw.isIntuit(),
		m = dmStr["ui.config.forceScreen"];
		if (!$.dmfw.isPT()) {
			if (m) try {
				return d[1 * m]
			} catch(n) {}
			return d[1]
		}
		if (e && !isReseller) {
			if (null != a) {
				e = [];
				for (m = 0; m < a.length; m++) for (var o = 100 * a[m], r = 0; r < o; r++) e.push(m);
				m = e.length;
				m = Math.floor(Math.random() * m);
				o = $.getCookie(j);
				if (null != o && (o *= 1, o < a.length && 0 < a[o])) return g[o];
				$.setCookie(j, e[m], 336, "/", !1);
				return g[e[m]]
			}
		} else return g[0]
	}
	var d = ["/editor/nee/mainTabs/nee.publishPanel.jsp", "/editor/nee/mainTabs/nee.publishPanel_B.jsp", "/editor/nee/mainTabs/nee.publishPanel_C.jsp"],
	g = ["/editor/nee/mainTabs/nee.pt.publishPanel.jsp", "/editor/nee/mainTabs/nee.pt.publishPanelMAS.jsp", "/editor/nee/mainTabs/nee.pt.publishPanel_premium_left.jsp"],
	j = "dmPublishABScreen_1";
	return {
		flowInterceptor: {
			onNavigate: function() {}
		},
		resources: {
			publishPanel: e(),
			redirectPanel: a(),
			bodyClass: "DM_DMDIRECT",
			shellWrapperClass: "DM_DMDIRECT"
		},
		dynamicResources: {
			publishPanel: e,
			redirectPanel: a
		}
	}
} ());$.dmui.registerProvider(PRODUCT_PROVIDER, "SPOTZER",
function() {
	function a() {
		return $.dmfw.isPT() ? "/editor/nee/mainTabs/nee.pt.publishPanel.jsp": "/editor/nee/mainTabs/nee.publishPanel.jsp"
	}
	return {
		flowInterceptor: {
			onNavigate: function() {}
		},
		resources: {
			publishPanel: a()
		},
		dynamicResources: {
			publishPanel: a
		}
	}
} ());$.dmui.registerProvider(PRODUCT_PROVIDER, "OPENTABLE",
function() {
	var a;
	a = $.dmfw.isPT() ? "/editor/product/openTable/js/nee.otPublishPanel.jsp": "/editor/nee/mainTabs/nee.publishPanel_B.jsp";
	return {
		flowInterceptor: {},
		resources: {
			publishPanel: a,
			bodyClass: "GOMO OPENTABLE",
			shellWrapperClass: "GOMO OPENTABLE"
		}
	}
} ());$.dmui.registerProvider(PRODUCT_PROVIDER, "HGGIBO", {
	flowInterceptor: {
		onReload: function(a) {
			$(".shellBodyFluidWrapper").addClass("neeTotalStepsNumThree");
			a && (a.currTab = "design" === $.getCookie("_dm_editor_curr_tab") ? NAV_DESIGN_ID: NAV_TEMPLATES_ID)
		},
		onDesignTabReady: function() {
			$.setCookie("_dm_editor_curr_tab", "design", 120, "/", !1)
		}
	},
	resources: {
		bodyClass: "GOMO HGGIBO",
		shellWrapperClass: "GOMO HGGIBO",
		forceWR: !0
	}
});$.dmui.registerProvider(PRODUCT_PROVIDER, "CHASE", {
	flowInterceptor: {},
	resources: {
		bodyClass: "GOMO CHASE",
		shellWrapperClass: "GOMO CHASE",
		forceWR: !0
	}
});
function initDesignPanel() {
	var a = !1;
	_refreshBasicDesignViewForWidgets = function() {
		0 != $.dmfw.getPreviewElement("A.dmCall").length ? $("#designOpenClickToCallBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.101"]) : $("#designOpenClickToCallBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.102"]);
		"YJP" == $.dmx.site.dmProductType ? $("#designOpenClickToMapBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.107"]) : 0 != $.dmfw.getPreviewElement("A.dmMap").length ? $("#designOpenClickToMapBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.103"]) : $("#designOpenClickToMapBasic").find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.104"])
	};
	$("#designControlViews").hide();
	$("#tempForBasic").unbind("click").click(function() {
		$.setCookie("_dm_editor_mode", "basic", 120, "/", !1);
		$(".tempForAdvanced").addClass("neeDesignPanelBtnOff");
		$(this).removeClass("neeDesignPanelBtnOff");
		$("#_designAdvancedWrapper").hide();
		$("#_designBasicWrapper").show();
		$("#designControlViews").show();
		_refreshBasicDesignViewForWidgets()
	});
	$("#tempForAdvanced").unbind("click").click(function() {
		$.setCookie("_dm_editor_mode", "advanced", 120, "/", !1);
		$(".tempForBasic").addClass("neeDesignPanelBtnOff");
		$(this).removeClass("neeDesignPanelBtnOff");
		$("#_designBasicWrapper").hide();
		$("#_designAdvancedWrapper").show();
		$("#designControlViews").show();
		_refreshBasicDesignViewForWidgets();
		sortCategoryForIcons("Category", $(".contentFilterSelected").attr("cat"))
	});
	"advanced" === $.getCookie("_dm_editor_mode") ? $("#tempForAdvanced").trigger("click") : $("#tempForBasic").trigger("click");
	$.dmx.site.isBlog ? ($(".displayNonBlogOn").hide(), $(".displayBlogOff").show(), $(".designOpenBlogPost").unbind("click").click(function() {
		var a = $.dmfw.getPreviewElement(".dmBlogInnerPostPage");
		0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI($(".editorAndPreviewPanel")), $.dmfw.previewNavigateTo({
			url: $.dmx.rt.blogFirststPostHref,
			onLoad: function() {
				$(".designOpenBlogPost").trigger("click")
			}
		}))
	}), $(".designOpenBlogGeneral").unbind("click").click(function() {
		var a = $.dmfw.getPreviewElement(".dmRssContainer");
		0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI($(".editorAndPreviewPanel")), a = $.dmfw.getPreviewElement("a#dm-logo-anchor").attr("href"), $.dmfw.previewNavigateTo({
			url: a,
			onLoad: function() {
				$(".designOpenBlogGeneral").trigger("click")
			}
		}))
	}), $(".designOpenBlogComment").unbind("click").click(function() {
		var a = $.dmfw.getPreviewElement(".commentsWrapper");
		0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI($(".editorAndPreviewPanel")), $.dmfw.previewNavigateTo({
			url: $.dmx.rt.blogFirststPostHref,
			onLoad: function() {
				$(".designOpenBlogComment").trigger("click")
			}
		}))
	})) : ($(".displayNonBlogOn").show(), $(".displayBlogOff").hide(), $("#designOpenNavigation, #designOpenNavigationBasic").unbind("click").click(function() {
		var a = $.navigationUtil.selectCorrectNavigationElementInPreview();
		0 != a.length && $.dmops.scrollPreviewToElement(a);
		$.dmfw.selectAndOpenEditor(a);
		$.hideAllSelection()
	}), $("#designOpenBackground").unbind("click").click(function() {
		var a = new NEEGlobalText;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	}), $("#designOpenText").unbind("click").click(function() {
		var a = new NEEGlobalText;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	}));
	$(".designOpenHomeScreen").unbind("click").click(function() {
		var a = new NEEHomeScreen;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	});
	$("#designOpenRemoveContent.designOpenRemoveContentAdvanced").unbind("click").click(function() {
		var a = new NEEMultipleRemoval;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	});
	$("#designOpenRemoveContent.designOpenRemoveContentBasic").unbind("click").click(function() {
		var a = new NEEMultipleRemoval;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	});
	$(".designOpenHeader").unbind("click").click(function() {
		var a = $.dmfw.getPreviewElement("DIV.dmHeader");
		0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a)) : (a = new NEEHeader, $.dmfw.openGlobalEditor({
			editable: a
		}))
	});
	$(".designOpenFooter").unbind("click").click(function() {
		var a = $.dmfw.getPreviewElement("DIV.dmFooter");
		$.dmfw.selectAndOpenEditor(a)
	});
	$("#designOpenClickToCallBasic").unbind("click").click(function() {
		if (!1 == a) {
			a = !0;
			$(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.101"]);
			var e = $.dmfw.getPreviewElement("A.dmCall");
			0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e)) : (e = new NEEClickToCall, $.dmops.insertElement(e, null, null, {
				scrollToElement: !0
			}));
			setTimeout(function() {
				a = !1
			},
			400)
		}
	});
	$("#designOpenClickToMapBasic").unbind("click").click(function() {
		if (!1 == a) {
			a = !0; ! 1 == $.dmx.site.dmProductType && $(this).find(".designItemTextTitle").html(dmStr["ui.nee.designPanel.103"]);
			var e = $.dmfw.getPreviewElement("A.dmMap");
			0 != e.length ? ($.dmops.scrollPreviewToElement(e), $.dmfw.selectAndOpenEditor(e)) : (e = new NEEClickToMap, $.dmops.insertElement(e, null, null, {
				scrollToElement: !0
			}));
			setTimeout(function() {
				a = !1
			},
			400)
		}
	});
	$("#_design .panelsTitleWrapper .panelTitleQmark").dmQtip({
		content: dmStr["ui.nee.designPanel.105"]
	});
	$(".contentTitleWrapper .panelTitleQmark").dmQtip({
		content: dmStr["ui.nee.designPanel.106"]
	});
	wrTrackEvent(WR_SITE_EDIT_SITE);
	$.dmui.onDesignTabReady({
		product: $.dmx.site.dmProductType
	})
}
function filterItems(a) {
	"function" !== typeof Object.filter && (Object.filter = function(a, d) {
		var e = {},
		g;
		for (g in a) a.hasOwnProperty(g) && d(a[g]) && (e[g] = a[g]);
		return e
	});
	var e = $.dmui.getResource("widgetsToRemove") || [],
	d = $.dmui.getResource("widgetsToAdd") || [],
	g = $.dmui.getResource("widgetsToAddForAdmin") || [];
	for (key in a) if (a.hasOwnProperty(key)) {
		var j = a[key];
		j.hide = j.hide || -1 != $.inArray(key, e) || $.dmui.getResource("hideAllWidgets");
		if (d.contains(key) || g.contains(key)) j.hide = !1;
		$.dmui.getResource("allWidgetsFeatured") && j.category.push("featured")
	}
	return Object.filter(a,
	function(a) {
		return ! a.hide
	})
}
function initContentPanel(a) {
	var e = [],
	d = $.dmfw.isPT() ? $.ptToolTips.getOptions("bigSquareButton") : null;
	$(".contentIconList").empty();
	dm_account_locale = dm_account_locale || 1;
	if ($.dmfw.contentInfo) {
		var g = $.dmfw.contentInfo;
		g.widget = filterItems(g.widget);
		for (var j in g.widget) if (null != a) for (var k in a) g.widget[j].title == a[k] && e.push(g.widget[j]);
		else e.push(g.widget[j]);
		e.sort(function(a, d) {
			a.order || (a.order = 9999);
			d.order || (d.order = 9999);
			return a.order - d.order
		});
		$(".contentIconList").empty();
		a = " " + commonProps["editor.newWidgets"] + " ";
		for (j = 0; j < e.length; j++) {
			g = $('\x3cdiv class\x3d"contentIconBtn" text\x3d"no"\x3e\x3c/div\x3e').attr("currNum", j);
			g.attr("id", "draggable" + j);
			g.attr("key", e[j].addObjName);
			$.dmfw.isPT() && d || $.dmfw.isDudaone() ? (g.data("ptPreviewData", {
				previewUrlPT: e[j].previewIconUrlClass,
				previewIconTitle: e[j].previewIconTitle,
				previewIconText: e[j].previewIconText
			}), $.dmfw.isPT() && (!g.data("qtip") && e[j].explanation) && $.ptToolTips.setToolTip(void 0, e[j].explanation, g, g, d, !1)) : g.attr("title", e[j].explanation);
			k = $('\x3cdiv class\x3d"contentImgDiv"\x3e\x3c/div\x3e');
			var l = $("\x3cdiv\x3e\x3c/div\x3e");
			l.addClass("contentIconsImg").addClass(e[j].icon);
			k.append(l);
			e[j].premium && !1 == isReseller && $('\x3cdiv class\x3d"contentPanelPremiumRibbon"\x3e\x3c/div').appendTo(g); - 1 != a.indexOf(" " + e[j].addObjName + " ") && $('\x3cdiv class\x3d"contentPanelNewRibbon"\x3e\x3c/div').appendTo(g);
			g.append(k);
			e[j].hideTitle || (k = $("\x3cdiv\x3e\x3c/div\x3e"), l = e[j].title, -1 != l.indexOf("^") && (l = "\x3cspan\x3e" + l.replace("^", "\x3c/span\x3e\x3cspan\x3e") + "\x3c/span\x3e"), k.append(l), g.append(k));
			e[j].specialClassName && g.addClass(e[j].specialClassName);
			var m = function(a) {
				var d = function() {
					setTimeout(function() {
						$.dmops.redrawSelection()
					},
					1E3)
				},
				g = $.dmfw.editables(e[a].addObjName);
				$.dmx.site.isBlog ? $.dmops.insertElement(g, null, null, {
					scrollToElement: !0,
					currentWidget: e[a],
					isBlog: !0,
					onInsert: d
				}) : $.dmops.insertElement(g, null, null, {
					scrollToElement: !0,
					currentWidget: e[a],
					onInsert: d
				})
			};
			e[j].featured && fetWrap.find(".contentPanelcornerLines").unbind("click").click(function(a) {
				a = $(a.currentTarget).parent().find(".contentIconBtn");
				a = Number(a.attr("currnum"));
				m(a)
			});
			g.find(".contentPanelcornerLines").unbind("click").click(function(a) {
				a = $(a.currentTarget).closest(".contentIconBtn");
				a = Number(a.attr("currnum"));
				m(a)
			});
			g.mouseover(function() {
				$(this).addClass("contentIconBtnSelected dragCursor")
			});
			g.mouseout(function() {
				$(this).removeClass("contentIconBtnSelected dragCursor draggingCursor")
			});
			var n = function() {
				$(".contentIconBtn").removeClass("contentIconBtnSelected draggingCursor")
			};
			g.draggable({
				helper: "clone",
				zIndex: 120,
				start: function(a, d) {
					$(d.helper).removeClass("contentIconBtnSelected").addClass("contentIconBtnSelectedDrag draggingCursor");
					$.dmfw.setPreviewEditPolicy(!1);
					d.helper.attr("title", "");
					var e = $(a.currentTarget).attr("key");
					_DragManager.requestInsert(d.helper, e, a, n)
				},
				drag: function() {
					$(this).addClass("contentIconBtnSelected draggingCursor")
				},
				stop: function() {
					var a = $(this).closest(".contentIconBtn"),
					a = Number(a.attr("currnum"));
					_DropManager.dropInsertNow({
						currentWidget: e[a]
					});
					$(this).addClass("contentIconBtnSelected draggingCursor");
					_DragManager.stop()
				},
				revert: !1
			});
			g.unbind("dblclick").dblclick(function(a) {
				a = $(a.currentTarget).closest(".contentIconBtn");
				a = Number(a.attr("currnum"));
				m(a)
			});
			e[j].featured ? $(".featureContentIconList").append(fetWrap) : $(".contentIconList").append(g)
		}
		_calculateNumContentShown = function() {
			var a = $(".contentIconList").outerWidth(),
			d = $(".contentIconBtn").outerWidth(),
			a = Math.floor(a / d),
			d = $(".contentIconBtn").size(),
			e = Math.ceil((d - 2 * a) / a);
			2 * a < $(".contentIconBtn").length ? "on" != $(".contentIconViewMore").attr("isShown") && ($(".contentIconViewMore").show(), $(".contentIconViewMore").unbind("click").click(function() {
				$(".contentIconViewMore").attr("isShown", "on");
				$(".contentIconViewMore").hide();
				$(".contentIconList").css("height", parseInt($(".contentIconList").css("height")) + $(".contentIconBtn").outerHeight(!0) * e + "px");
				$(".contentIconList").css("overflow", "visible")
			})) : ($(".contentIconViewMore").hide(), $(".contentIconList").css("overflow", "hidden"))
		};
		_calculateNumContentShown();
		$(window).resize(function(a) {
			a.stopPropagation();
			"on" != $(".contentIconViewMore").attr("isShown") ? _calculateNumContentShown() : $(".contentIconViewMore").hide()
		})
	} else $.ajax({
		url: "/editor/nee/editableObjects/nee.contentWidgetInfo.jsp?dm_lang\x3d" + dm_account_locale,
		type: "get",
		dataType: "script",
		success: function(a) {
			a = eval(a);
			$.dmfw.contentInfo = a;
			sortSuccess(a)
		}
	})
}
function sortCategoryForIcons(a, e) {
	function d(d) {
		d.widget = filterItems(d.widget);
		switch (a) {
		case "Category":
			for (var k in d.widget)"all" == e.toLowerCase() ? g.push(d.widget[k].title) : -1 != d.widget[k].category.indexOf(e.toLowerCase()) && g.push(d.widget[k].title);
			break;
		case "Time":
			var l = new Date;
			l.setFullYear(l.getFullYear(), l.getMonth() + 1, l.getDate());
			switch (e) {
			case "Last 2 days":
				l.setDate(l.getDate() - 2);
				for (k in d.widget) {
					var m = new Date(d.widget[k].date);
					m.setMonth(m.getMonth() + 1);
					m.getTime() > l.getTime() && g.push(d.widget[k].title)
				}
				break;
			case "Last week":
				l.setDate(l.getDate() - 7);
				for (k in d.widget) m = new Date(d.widget[k].date),
				m.setMonth(m.getMonth() + 1),
				m.getTime() > l.getTime() && g.push(d.widget[k].title);
				break;
			case "Last month":
				l.setMonth(l.getMonth() - 1);
				for (k in d.widget) m = new Date(d.widget[k].date),
				m.setMonth(m.getMonth() + 1),
				m.getTime() > l.getTime() && g.push(d.widget[k].title);
				break;
			case "Last year":
				l.setYear(l.getYear() - 1);
				for (k in d.widget) m = new Date(d.widget[k].date),
				m.setMonth(m.getMonth() + 1),
				m.getTime() > l.getTime() && g.push(d.widget[k].title);
				break;
			case "All":
				for (k in d.widget) g.push(d.widget[k].title)
			}
		}
		initContentPanel(g)
	}
	var g = [];
	$.dmfw.contentInfo ? d($.dmfw.contentInfo) : $.ajax({
		url: "/editor/nee/editableObjects/nee.contentWidgetInfo.jsp?v\x3d3\x26dm_lang\x3d" + dm_account_locale,
		type: "get",
		dataType: "script",
		success: function(a) {
			a = eval(a);
			$.dmfw.contentInfo = a;
			d(a)
		}
	})
}
$.extend({
	dmpages: {
		executeSelectCurrent: void 0,
		initPagesListSizing: function() {
			var a = !1;
			$.dmpages.recalculate();
			$(document.body).on("click", "#_pages .collapseOtherPagesIcon",
			function() {
				a = !a;
				$.dmpages.recalculate(a)
			});
			$(window).resize(function() {
				try {
					NEFW.NAV.maintabs("current") == NAV_PAGES_ID && $.dmpages.recalculate(a)
				} catch(e) {}
			})
		},
		recalculate: function(a) {
			a ? ($.dmpages.setNavSize(0), $("#_pages .navOtherPages .navPagesContent").css("max-height", "0px"), $("#_pages .navOtherPages .navPagesContent").removeClass("neeShowOtherPages"), $("#_pages .navPages .navPagesContent").removeClass("close"), $(".collapseOtherPagesIcon").removeClass("collapseOtherPagesIconDown")) : (a = ($(window).height() - $(" #_pages .navPages").offset().top) / 3, $("#_pages .navOtherPages .navPagesContent").css("max-height", a + "px"), $.dmpages.setNavSize($("#_pages .navOtherPages .navPagesContent").height()), $("#_pages .navOtherPages .navPagesContent").addClass("neeShowOtherPages"), $("#_pages .navPages .navPagesContent").addClass("close"), $(".collapseOtherPagesIcon").addClass("collapseOtherPagesIconDown"))
		},
		setNavSize: function(a) {
			var e = $(window).height() - $(" #_pages .navPages .navPagesContent").offset().top;
			$(" #_pages .navPages .navPagesContent").css("max-height", e - a - ($(".navPagesHeader").height() + 65) + "px")
		},
		initPagesPanel: function() {
			$.dmpages.navPageLinksByPage = {};
			$.dmpages.navPageLinksById = {};
			$.dmpages.isCreateNewPageCalled = !1;
			$.dmpages.curPage = null;
			$.dmpages.showCurTab = null;
			$.dmpages.curNavLink = $.dmx.rt.currentNavId;
			$.dmx.pagesUI && "page" == $.dmx.pagesUI.curType && ($.dmpages.curPage = $.dmx.pagesUI.curId);
			$.dmpages.init()
		},
		init: function() {
			$(".pagesRightPanel").attachBubble();
			$.dmpages._initPagesTabs();
			$.dmpages._doInit()
		},
		initQtip: function(a) {
			$("#_pages .panelsTitleWrapper .panelTitleQmark").dmQtip({
				content: a,
				position: {
					my: "left top",
					at: "right center"
				}
			})
		},
		_initPagesTabs: function() {
			function a() {
				$(".panelTitle").removeClass("panelTitleSelected");
				$("#panelTitleManageSite").addClass("panelTitleSelected");
				$("#manageTemplatesPanel").hide();
				$("#manageSitePages").show();
				$("#_editorWrapper").removeClass("hideEmulator");
				$.dmpages.initQtip($.dmpages.pagesQtipMsg);
				$.dmpages._navExpandCollapse()
			}
			$(".neePagesInnerWrapperToggle").hide();
			$("#panelTitleManageSite").unbind("click").click(function() {
				$.dmfw.hideAllQTips();
				$.dmops.updateEditContext.all({
					success: function() {
						$.dmpages.refreshPages(function() {
							a()
						},
						!0)
					}
				})
			});
			$("#panelTitleManageTemplates").unbind("click").click(function() {
				$(".panelTitle").removeClass("panelTitleSelected");
				$(this).addClass("panelTitleSelected");
				$("#manageSitePages").hide();
				$.dmpagetmpl.initPageTmplTab();
				$("#manageTemplatesPanel").show();
				$("#_editorWrapper").addClass("hideEmulator");
				$.dmpages.initQtip($.dmpages.pageTmplQtipMsg)
			});
			a($("#panelTitleManageTemplates"))
		},
		_doInit: function() {
			function a() {
				$.dmpages.refreshPages();
				$.dmpages.initSettings();
				$.dmpages.initNewPageBtn()
			}
			try {
				$.dmops.updateEditContext.all({
					success: function() {
						a()
					}
				})
			} catch(e) {
				a()
			}
		},
		refreshPages: function(a, e) {
			$.dmUIBlockControlled({
				region: "pages.refresh",
				op: "block",
				style: "wheel",
				container: $("#_pages")
			});
			$.dmpages.buildNavPages(function() {
				a && a(); ! $.dmpages.curPage && !$.dmpages.curNavLink ? $.dmpages._openMainPage() : $.dmpages.executeSelectCurrent && $.dmpages.executeSelectCurrent(e);
				$.dmUIBlockControlled({
					region: "pages.refresh",
					op: "unblock",
					style: "wheel"
				})
			})
		},
		_setNavLinkPageType: function(a) {
			a && ("URL" == a.linkType.type ? $.dmpages._setPageType(dmStr["ui.nee.pages.701"] + " ", a.link) : $.dmpages._setPageType(a.linkType.title, " (" + a.link + ")"))
		},
		_setPageType: function(a, e) {
			$("#pageType").text(a);
			$("#pageURL").text(e);
			$("#pageURL").attr("title", e)
		},
		buildNavPages: function(a) {
			$.dmpages.navPageLinksByPage = {};
			$("#navPagesContent").empty();
			$("#navPagesContent").navigationItems({
				inPagesEditor: !0,
				listItemCallback: function(a) {
					function d(d) {
						$.dmpages.curPage = null;
						$.dmpages.curNavLink = g.elementID;
						var n = $.isLinkHashed(g.itemUrl);
						$(".pagesRightPanel").toggleClass("hashedLink", n);
						n && ($.dmpages.showCurTab = null);
						$.dmpages.displayNavPageSettings(g, j, k, l);
						$.dmpages.highlightSelected($(a));
						d || $.dmpages.navToPageLink(g)
					}
					var g = $(a).data("dataItem"),
					j = $(a).data("remove"),
					k = $(a).data("hide"),
					l = $(a).data("changeTitle");
					$(a).click(function(a) { (!a || !$(a.srcElement).is(".navLinkArrow, .navLinkArrow *")) && d();
						a.stopPropagation()
					});
					$.dmpages.curNavLink == g.elementID && ($.dmpages.executeSelectCurrent = function(a) {
						d(a)
					});
					$.dmpages.navPageLinksByPage[g.pageID] = g;
					$.dmpages.navPageLinksById[g.elementID] = g
				},
				afterRemoveCallback: function(a) {
					$.dmops.updateEditContext.all({
						success: function() {
							$.dmfw.previewNavigateTo({
								page: {
									alias: "home"
								}
							});
							$.dmpages.refreshPages(function() { (a || !$.dmpages.curNavLink && !$.dmpages.curPage) && $.dmpages._openMainPage()
							})
						}
					})
				},
				onNavReady: function() {
					$.dmpages.buildOtherPages();
					a && a();
					$.dmpages.initPagesListSizing()
				}
			})
		},
		displayNavPageSettings: function(a, e, d, g) {
			$.dmpages._openPageGenSett();
			$.dmpages.populatePageLinkSettings(a, e, d, g)
		},
		populatePageLinkSettings: function(a, e, d, g) {
			var j = null;
			$(".templateFor").hide();
			a.pageFromScratch ? ($.dmpages._setPageType(dmStr["ui.nee.pages.70"], ""), $("#pagesTemplateSettNav").hide()) : ((j = $.getLinkType(a.itemUrl)) && $.dmpages._setNavLinkPageType(j), $.dmfw.isPT() || $.dmpagetmpl.initPageTemplateTab(a.pageAlias, $.dmpages.createPageLink(a, !1)));
			$("#pageNameInput").attr("value", a.itemTitle);
			$.dmpages._initNavPageButtons(a, e, d, g, j)
		},
		initPageDesignClickable: function(a, e) {
			NEFW.initPageDesignClickable(a, {
				pageAlias: e
			})
		},
		_initNavPageButtons: function(a, e, d, g, j) {
			$.dmpages._hideButtonsForLink(j);
			$.dmpages._initChangeNavTitle(a, g);
			$.dmpages._initNavSyncPageBtn(a);
			$.dmpages._initHideFromNavBtn(a, d);
			$.dmpages._initNavSEOInputs(a);
			$.dmpages._initNavViewEditBtn(a);
			$.dmpages._initNavResetDesign(a);
			$.dmpages._initDeleteNavPageBtn(a, e)
		},
		_hideButtonsForLink: function(a) {
			a && "URL" != a.linkType.type ? ($("#pagesSEOSettNav").hide(), $("#pagesAdvSettNav").hide(), $(".syncPage").hide(), $("#resetPageDesignBtn").hide(), $("#viewEditPageBtn").hide()) : ($("#pagesSEOSettNav").show(), $("#pagesAdvSettNav").show(), $(".syncPage").show(), $("#resetPageDesignBtn").show(), $("#viewEditPageBtn").show())
		},
		_initNavSEOInputs: function(a) {
			a.pageID ? $.dmpages._initSEOInputs({
				page: $.dmx.pagesById()[a.pageID]
			}) : $.dmpages._initSEOInputs({
				pageLink: a
			})
		},
		_initHideFromNavBtn: function(a, e) {
			var d = function(a) {
				e && ($.dmUIBlockControlled({
					region: "pagesHideFromNav",
					op: "block",
					style: "wheel"
				}), e(a, null), $.dmUIBlockControlled({
					region: "pagesHideFromNav",
					op: "unblock",
					style: "wheel"
				}))
			},
			g = {
				disabled: !e,
				initState: !a.deleted,
				onFn: function() {
					d(!1)
				},
				offFn: function() {
					d(!0)
				}
			};
			$("#hidePageOnOffBtn").onOffBtn(g)
		},
		_initDeleteNavPageBtn: function(a, e) {
			$("#deletePageBtn").unbind("click");
			$("#deletePageBtn").show();
			$.dmpages._initDeletePageClick(function() {
				$.dmpages.curNavLink = null;
				if (null == a.PageAlias || "original" == a.pageAlias || a.pageID == $.dmx.page.id) $.dmx.page = $.dmx.homePage();
				e(!0)
			})
		},
		_afterPageDeletionCB: function() {
			$.dmfw.previewNavigateTo({
				page: {
					alias: "home"
				}
			})
		},
		_navExpandCollapse: function() {
			try {
				var a = NEFW.PREVIEW.get(0).contentWindow;
				a.jQuery.DM.expandNavigation(!1);
				a.jQuery.DM.restoreDefaultNavigationStyles();
				a.jQuery.DM.fullCollapseNavigation()
			} catch(e) {}
		},
		_initNavSyncPageBtn: function(a) {
			var e = function(d) {
				a.pageID && "default" != a.pageAlias ? $.dmpages.updateAutoSync($.dmx.pagesById()[a.pageID], d) : $.dmpages._createPage(a,
				function(e) {
					$.dmpages._updatePageInNav(a, e);
					$.dmpages.updateAutoSync(e, d)
				})
			},
			d = !0;
			a.pageID && $.dmx.pagesById()[a.pageID] && (d = !$.dmx.pagesById()[a.pageID].disableAutoSync);
			d = {
				disabled: a.pageFromScratch,
				initState: d,
				onFn: function() {
					e(!0)
				},
				offFn: function() {
					e(!1)
				}
			};
			$("#syncPageOnOffBtn").onOffBtn(d);
			a.pageFromScratch ? $("#syncPageNow").hide() : $.dmpages._initSyncNow(a.pageID)
		},
		_updatePageInNav: function(a, e) {
			a.pageID = e.id;
			a.pageAlias = e.alias;
			$.dmpages.navPageLinksByPage[a.pageID] = a
		},
		_initNavViewEditBtn: function() {
			$("#viewEditPageBtn").unbind("click");
			$("#viewEditPageBtn").click(function() {
				NEFW.navigateToTabWithHistory(NAV_DESIGN_ID)
			})
		},
		_initNavResetDesign: function(a) {
			$.dmpages._initResetPageDesignClick(function() {
				a.pageID && a.pageAlias != DEFAULT_PAGE_DESIGN_ALIAS && $.dmsrv.resetPageDesign(a.pageID,
				function() {
					$.dmfw.refreshPreview()
				})
			},
			a.pageFromScratch)
		},
		_initChangeNavTitle: function(a, e) {
			$("#pageNameInput").inputFieldLostFocusHandler(e)
		},
		buildOtherPages: function() {
			$("#otherPages").empty();
			$("#homePage").empty();
			var a = $.dmx.editableNavLinks().map(function(a) {
				return a.alias
			});
			$.each($.dmx.sitePages,
			function(e, d) {
				var g = 0;
				try {
					g = d.rulesCount || 0
				} catch(j) {}
				if ("default" != d.alias && "header" != d.alias && (0 < g || d.isFromScratchLegacy)) {
					var k = g = !1,
					l = null;
					d.alias != HOME_PAGE_DESIGN_ALIAS ? -1 == a.indexOf(d.alias) && (g = {
						pageName: d.title
					},
					l = $("#otherPagesTmpl").tmpl(g), $(l).data("page", d), $("#otherPages").append(l), g = !0) : (g = {
						pageName: d.title
					},
					l = $("#otherPagesTmpl").tmpl(g), $("#homePage").append(l), $.dmpages.navPageLinksByPage[d.id] && (k = !0), g = !0, $.dmpages.selectHome = function() {
						$.dmpages.displayPageSettings(d, k);
						$.dmpages.highlightSelected($(l))
					});
					g && (l.click(function() {
						$.dmpages.displayPageSettings(d, k);
						$.dmpages.curPage = d.id;
						$.dmpages.curNavLink = null;
						$.dmpages.navToPage(d);
						$.dmpages.highlightSelected($(l))
					}), d.id == $.dmpages.curPage && ($.dmpages.executeSelectCurrent = function() {
						$.dmpages.displayPageSettings(d, k);
						$.dmpages.highlightSelected($(l))
					}))
				}
			})
		},
		displayPageSettings: function(a, e) {
			$.dmpages._openPageGenSett();
			$.dmpages.populatePageSettings(a, e)
		},
		populatePageSettings: function(a, e) {
			$(".templateFor").hide();
			a.isFromScratchLegacy ? ($.dmpages._setPageType(dmStr["ui.nee.pages.70"], ""), $("#pagesTemplateSettNav").hide()) : ($.dmpages._setPageType(dmStr["ui.nee.pages.701"] + " ", a.url), $.dmpagetmpl.initPageTemplateTab(a.alias, $.dmpages.createPageLink(a, !0)));
			var d = a.title;
			"home" == d && (d = "Home");
			$("#pageNameInput").attr("value", d);
			$.dmpages.initPageButtons(a, e)
		},
		initPageButtons: function(a, e) {
			$.dmpages._initSyncPageBtn(a);
			$.dmpages._initShowInNavBtn(a, e);
			$.dmpages._initRenamePage(a);
			$.dmpages._initSEOInputs({
				page: a
			});
			$.dmpages._initPageResetDesign(a);
			$.dmpages._initViewEditBtn(a);
			$.dmpages._initDeletePageBtn(a)
		},
		_initSEOInputs: function(a) {
			function e(d, e) {
				var g = a.page;
				g && $(d).attr("value", g.head[e]);
				var j = function(d) {
					function j(a, d) {
						var g = {};
						g[e] = a;
						$.dmsrv.updatePageHead(d.id, g,
						function() {
							d.head[e] = a
						})
					}
					g ? j(d, g) : $.dmpages._createPage(a.pageLink,
					function(a) {
						j(d, a)
					})
				};
				$(d).inputFieldLostFocusHandler(j);
				return j
			}
			e("#pageTitleInput", "title");
			e("#pageDescriptionInput", "description");
			e("#pageMetaInput", "keywords");
			var d = $.dmfw.isPT() ? "#popupPageSettings #headSectionText": ".pagesRightPanel #headSectionText",
			g = e(d, "headContent"),
			j = $("#_pages .headSectionWrapper");
			j.find(".expandImg").neePopUpDiv(j.find("#headerTextExpnadedWrapper"), {
				init: function(a) {
					a.find("#headerTextExpanded").empty();
					a.find("#headerTextExpnadedWrapper").parent().find(".closeThis").hide();
					var d = j.find("#headSectionText").val().replace("\x3chead\x3e", "").replace("\x3c/head\x3e", ""),
					e = CodeMirror(a.find("#headerTextExpanded").get(0), {
						value: d,
						lineNumbers: !0,
						lineWrapping: !0,
						mode: "htmlmixed"
					});
					a.find("#headerUpdateDiv").unbind("click").click(function() {
						a.parent().find(".closeThis").trigger("click");
						var d = e.getValue().replace("\x3chead\x3e", "").replace("\x3c/head\x3e", "").trim();
						j.find("#headSectionText").val(d);
						a.find("#headerTextExpanded").empty();
						g(d)
					})
				}
			})
		},
		_initShowInNavBtn: function(a, e) {
			var d = {
				initState: e,
				disabled: e,
				onFn: function() {
					if (!e) {
						$.dmUIBlockControlled({
							region: "pages.ShowFromNav",
							op: "block",
							style: "wheel"
						});
						if (a.alias == HOME_PAGE_DESIGN_ALIAS) $("#hidePageOnOffBtn").onOffBtn({
							disabled: !0
						});
						var d = a.url;
						a.isFromScratchLegacy && (d = "/site/" + $.dmx.site.alias + "/" + a.alias);
						$.dmsrv.addToNav(a.id, a.title, d, null,
						function(a) {
							$.dmpages.curNavLink = a.id;
							$.dmops.updateEditContext.all({
								success: function() {
									$.dmfw.refreshPreview(function() {
										$.dmpages.refreshPages(function() {
											$.dmpages.scrollNavDown();
											$.dmUIBlockControlled({
												region: "pages.ShowFromNav",
												op: "unblock",
												style: "wheel"
											})
										})
									})
								}
							})
						})
					}
				},
				offFn: function() {}
			};
			$("#hidePageOnOffBtn").onOffBtn(d)
		},
		_initSyncPageBtn: function(a) {
			var e = {
				disabled: a.isFromScratchLegacy,
				initState: !a.disableAutoSync,
				onFn: function() {
					$.dmpages.updateAutoSync(a, !0)
				},
				offFn: function() {
					$.dmpages.updateAutoSync(a, !1)
				}
			};
			$("#syncPageOnOffBtn").onOffBtn(e);
			a.isFromScratchLegacy ? $("#syncPageNow").hide() : $.dmpages._initSyncNow(a.id)
		},
		updateAutoSync: function(a, e) {
			$.dmUIBlockControlled({
				region: "pages.updateAutoSync",
				op: "block",
				style: "wheel"
			});
			$.dmsrv.autoSyncPage(a.id, e,
			function() {
				a.disableAutoSync = !e;
				$.dmUIBlockControlled({
					region: "pages.updateAutoSync",
					op: "unblock",
					style: "wheel"
				});
				$.dmx.events.trigger("autoSyncModified", {
					page: a,
					autoSync: e
				})
			})
		},
		_initViewEditBtn: function() {
			$("#viewEditPageBtn").unbind("click");
			$("#viewEditPageBtn").click(function() {
				NEFW.navigateToTabWithHistory(NAV_DESIGN_ID)
			})
		},
		_initPageResetDesign: function(a) {
			$.dmpages._initResetPageDesignClick(function() {
				$.dmsrv.resetPageDesign(a.id,
				function() {
					$.dmfw.refreshPreview()
				})
			},
			a.isFromScratchLegacy)
		},
		_initRenamePage: function(a) {
			$("#pageNameInput").inputFieldLostFocusHandler(function() {
				$.dmpages._renamePage(a)
			})
		},
		_initDeletePageBtn: function(a) {
			$("#deletePageBtn").unbind("click");
			a.alias && a.alias == HOME_PAGE_DESIGN_ALIAS ? $("#deletePageBtn").hide() : $("#deletePageBtn").show();
			$.dmpages._initDeletePageClick(function() {
				$.dmPost({
					url: "/pages/" + a.id + "/delete",
					success: function() {
						var e = a.id == $.dmx.page.id;
						e && ($.dmx.page = $.dmx.homePage());
						$.dmops.updateEditContext.all({
							success: function() {
								$.dmpages.curPage = null;
								$.dmpages._afterPageDeletionCB(e);
								$.dmpages.buildOtherPages();
								$.dmpages._openMainPage()
							}
						})
					}
				})
			})
		},
		initNewPageBtn: function() {
			$("#newPageButton , #newPagePlus, .iconMainPages, .iconMainPagesToOpen").unbind("click").click(function() {
				$.dmpages.isCreateNewPageCalled || ($.dmpages.isCreateNewPageCalled = !0, setTimeout(function() {
					$.dmpages.isCreateNewPageCalled = !1
				},
				320), $.dmUIBlockControlled({
					region: "pages.newPage",
					op: "block",
					style: "wheel"
				}), $.dmops.createPageBlank({
					siteId: $.dmx.site.id,
					suggestedAlias: $.dmx.getNextAvailablePageTitle(dmStr["ui.nee.pages.71"]),
					addToNav: !0,
					templateName: $("#pageTemplatesSelect").val(),
					success: function(a) {
						$.dmpages.curPage = null;
						$.dmpages.curNavLink = a.navId;
						$.dmpages.showCurTab = null;
						$.dmfw.refreshPreview(function() {
							$.dmpages.refreshPages(function() {
								$.dmpages.scrollNavDown();
								$("#pageNameInput").focus();
								$.dmUIBlockControlled({
									region: "pages.newPage",
									op: "unblock",
									style: "wheel"
								})
							})
						})
					}
				}))
			})
		},
		_createPage: function(a, e) {
			$.dmops.createPage({
				pageUrl: a.itemUrl,
				suggestedAlias: a.itemTitle,
				success: e,
				skipContextUpdate: !0
			})
		},
		_renamePage: function(a) {
			var e = $("#pageNameInput").attr("value");
			e != a.title && $.dmsrv.renamePage(a.id, e,
			function() {
				a.title = e;
				$.dmpages.refreshPages()
			})
		},
		_initSyncNow: function(a) {
			a ? ($("#syncPageNow").show(), $("#syncPageNow").unbind("click"), $("#syncPageNow").neeConfirmationPopUpDiv(dmStr["ui.nee.pages.72"], {
				initCallback: function() {
					$.dmUIBlockControlled({
						region: "pages.syncNow",
						op: "block",
						style: "wheel"
					});
					$.dmops.updatePageWithLiveContent({
						pageid: a,
						success: function() {
							$.dmfw.refreshPreview(function() {
								$.dmUIBlockControlled({
									region: "pages.syncNow",
									op: "unblock",
									style: "wheel"
								})
							})
						}
					})
				}
			})) : $("#syncPagNow").hide()
		},
		_initDeletePageClick: function(a) {
			$("#deletePageBtn").neeConfirmationPopUpDiv(dmStr["ui.nee.pages.73"], {
				initCallback: a
			})
		},
		_initResetPageDesignClick: function(a, e) {
			e ? $("#resetPageDesignBtn").hide() : ($("#resetPageDesignBtn").show(), $("#resetPageDesignBtn").unbind("click"), $("#resetPageDesignBtn").neeConfirmationPopUpDiv(dmStr["ui.nee.pages.74"], {
				initCallback: a
			}))
		},
		navToPage: function(a) {
			$.dmfw.previewNavigateTo({
				page: {
					alias: a.alias
				}
			})
		},
		navToPageLink: function(a) {
			var e = a.itemUrl || "",
			d = a.pageAlias || "";
			$.isLinkHashed(e) && (e = e.replace("#", ""), d = "home");
			a = a.pageAlias && "original" != a.pageAlias ? {
				page: {
					alias: d,
					query: !a.pageFromScratch ? "url\x3d" + escape(e) : void 0
				}
			}: {
				url: a.itemUrl
			};
			$.dmfw.previewNavigateTo(a)
		},
		openPageTemplatesPopup: function(a) {
			$.dmfw.isPT() ? ($(".slideRightPanelInner").html(""), $(".slideRightPanelInner").load("/editor/nee/mainTabs/pages/nee.pt.pageTempaltesPopup.jsp",
			function() {
				var e = $(".slideRightPanelInner");
				$.dmpagetmpl.initPageTemplatesRulesPanel({
					pageAlias: a,
					container: e
				});
				e.find(".doneNewRule").unbind("click").click(function() {
					e.close()
				})
			})) : $.dmfw.openPopupFromUrl("/editor/nee/mainTabs/pages/nee.pageTempaltesPopup.jsp", {
				init: function(e) {
					$.dmpagetmpl.initPageTemplatesRulesPanel({
						pageAlias: a,
						container: e
					});
					e.find(".doneNewRule").unbind("click").click(function() {
						e.close()
					})
				},
				beforeClose: function() {
					$.dmpages._doInit()
				},
				disableDrag: !0,
				dontCloseAutomatically: !0
			})
		},
		initSettings: function() {
			function a(a, d) {
				$(a).unbind("click").click(function() {
					if ("#pagesGenSettNav" == a) $(".generalSettBtns").show();
					else if ($(".generalSettBtns").hide(), $(".pagesRightPanel").is(".hashedLink")) return ! 1;
					d && ($.dmpages.showCurTab = d, d())
				})
			}
			a("#pagesGenSettNav",
			function() {
				$.dmpages._showGenSettings()
			});
			a("#pagesSEOSettNav",
			function() {
				$.dmpages._showSEOSettings()
			});
			a("#pagesAdvSettNav",
			function() {
				$.dmpages._showAdvSettings()
			});
			a("#pagesTemplateSettNav",
			function() {
				$.dmpages._showTemplateSettings()
			});
			$.dmpages.showCurTabNow()
		},
		showCurTabNow: function() {
			$.dmpages.showCurTab ? $.dmpages.showCurTab() : $.dmpages._showGenSettings()
		},
		_showGenSettings: function() {
			$.dmpages._showTab("#pagesGenSettNav", "#pagesGenSett")
		},
		_showAdvSettings: function() {
			$.dmpages._showTab("#pagesAdvSettNav", "#pagesAdvSett")
		},
		_showSEOSettings: function() {
			$.dmpages._showTab("#pagesSEOSettNav", "#pagesSEOSett")
		},
		_showTemplateSettings: function() {
			$.dmpages._showTab("#pagesTemplateSettNav", "#pagesTemplateSett")
		},
		_showTab: function(a, e) {
			$.dmpages._clearTabs();
			$(e).removeClass("displayNone");
			$(a).addClass("pagesOrange")
		},
		_clearTabs: function() {
			$(".pagesTab").addClass("displayNone");
			$(".pagesNavTab").removeClass("pagesOrange")
		},
		_openPageGenSett: function() {
			$.dmpages.showCurTabNow();
			$("#pagesMain").addClass("displayNone");
			$("#pageSettings").removeClass("displayNone")
		},
		_openMainPage: function() {
			$.dmpages.selectHome()
		},
		highlightSelected: function(a) {
			$(".pageSelected").removeClass("pageSelected");
			a.addClass("pageSelected")
		},
		scrollNavDown: function() {
			var a = $(".navPages .navPagesContent");
			a.animate({
				scrollTop: a[0].scrollHeight
			},
			300)
		},
		createPageLink: function(a, e) {
			return e ? {
				isPage: !0,
				pageID: a.id,
				pageAlias: a.alias,
				itemUrl: a.url,
				itemTitle: a.title
			}: a
		},
		pagesQtipMsg: dmStr["ui.nee.pages.75"] + ". \x3cbr\x3e" + dmStr["ui.nee.pages.76"],
		pageTmplQtipMsg: "\x3cb\x3e\x3cu\x3e" + dmStr["ui.nee.pages.62"] + "\x3c/u\x3e\x3c/b\x3e  \x3cbr\x3e" + dmStr["ui.nee.pages.77"] + " \x3cb\x3e" + dmStr["ui.nee.pages.980"] + "\x3c/b\x3e\x3cbr\x3e\x3cbr\x3e\x3cb\x3e\x3cu\x3e" + dmStr["ui.nee.pages.63"] + "\x3c/u\x3e\x3c/b\x3e \x3cbr\x3e" + dmStr["ui.nee.pages.78"] + " .html, " + dmStr["ui.nee.pages.79"] + " \x3cb\x3e" + dmStr["ui.nee.pages.981"] + "\x3c/b\x3e\x3cbr\x3e\x3cbr\x3e\x3cb\x3e\x3cu\x3e" + dmStr["ui.nee.pages.82"] + "\x3c/u\x3e\x3c/b\x3e \x3cbr\x3e" + dmStr["ui.nee.pages.80"] + " \x3cbr\x3e\x3cb\x3e" + dmStr["ui.nee.pages.982"] + "\x3c/b\x3e\x3cbr\x3e\x3cbr\x3e\x3cb\x3e\x3cu\x3e" + dmStr["ui.nee.pages.64"] + "\x3c/u\x3e\x3c/b\x3e \x3cbr\x3e " + dmStr["ui.nee.pages.81"] + " \x3cb\x3e" + dmStr["ui.nee.pages.983"] + "\x3c/b\x3e"
	}
});$.extend({
	dmpagetmpl: {
		initPageTmplTab: function() {
			function a(a) {
				$(".manageTemplateText").hide();
				$(a).show()
			}
			var e = $(".manageTemplatesLeftPanel"),
			d = $("#pageTemplatesList"),
			g = $(".manageTemplatesRightPanel");
			d.empty();
			$.each($.dmx.pageTemplates(),
			function(j, l) {
				if (l && DEFAULT_PAGE_DESIGN_ALIAS != l.alias) {
					var m = {
						PageTmplName: l.title
					},
					n = $("#pageTemplatesListTmpl").tmpl(m);
					n.data("pTmpl", l);
					d.append(n);
					n.unbind("click").click(function() {
						$.dmfw.hideAllQTips();
						a(".tmplRulesSubTitle");
						g.find(".manageTemplateSubtitleCaption").text(dmStr["ui.nee.pages.58"]);
						e.find(".templateSelected").removeClass("templateSelected");
						var d = g.find(".manageTemplateSubtitleTmplName");
						d.show();
						$.dmpagetmpl.initTmplNameInput(d, l, n);
						$.dmpagetmpl.initPageTemplatesRulesPanel({
							pageAlias: l.alias,
							container: g
						});
						$.dmpagetmpl.initPageTepmlateButtons(l, g, n);
						n.addClass("templateSelected")
					});
					l.alias == HOME_PAGE_DESIGN_ALIAS && ($.dmpagetmpl.homeItem = n)
				}
			});
			var j = e.find(".dontMobilize");
			j.unbind("click").click(function() {
				a(".dontMobilizeSubTitle");
				g.find(".manageTemplateSubtitleCaption").text(dmStr["ui.nee.pages.83"]);
				g.find(".manageTemplateSubtitleTmplName").hide();
				e.find(".templateSelected").removeClass("templateSelected");
				g.find(".manageTemplateFooterBtns").hide();
				$.dmpagetmpl.initPageTemplatesRulesPanel({
					pageAlias: ORIGINAL_PAGE_ALIAS,
					container: g
				});
				j.addClass("templateSelected")
			});
			$.dmpagetmpl.selectHomeTmpl()
		},
		selectHomeTmpl: function() {
			$.dmpagetmpl.homeItem && $($.dmpagetmpl.homeItem).trigger("click")
		},
		initPageTemplatesRulesPanel: function(a) {
			var e = a.pageAlias || "",
			d = a.container || $(""),
			g;
			ORIGINAL_PAGE_ALIAS == e ? (a = $.dmx.site.dontMobilizeRules, g = "Don't Mobilize") : (g = $.dmx.pagesByAlias()[e], a = g.rules, g = g.title);
			d.find(".assignTemplateWrapper").empty();
			d.find(".assignedTemplateName").text(g);
			$.each(a,
			function(a, g) {
				var l = $.dmpagetmpl.getPatternParts(g.urlPattern);
				$.dmpagetmpl._addRuleItem(d, e, l.operator, l.urlPart, g)
			});
			d.find(".addNewRule").unbind("click").click(function() {
				$.dmpagetmpl._addRuleItem(d, e, "STARTS_WITH", $.dmx.site.baseUrl, null)
			})
		},
		constructUrlPattern: function(a, e) {
			return ! a || "EXACTLY" == a ? e: "{" + a + "}\x3e" + e
		},
		getDefaultNewRulePattern: function() {
			return $.dmpagetmpl.constructUrlPattern("STARTS_WITH", $.dmx.site.baseUrl)
		},
		_addRuleItem: function(a, e, d, g, j) {
			var k = {
				URLPart: g
			},
			k = a.find(".assignTemplateWrapperTmpl").tmpl(k),
			l = $(k);
			l.attr("id", $.uniqueid());
			j && (l.data("ruleId", j.id), l.data("rulePattern", j.urlPattern), l.data("rule", j));
			var m = l.find("#selectAssignTemplate");
			m.val(d);
			HOME_PAGE_DESIGN_ALIAS == e && "EXACTLY" == d && $.dmpagetmpl._isBaseURL(g) ? (l.find(".assignTemplateDelete").remove(), l.find(".templateRuleURlPart").disable(), m.disable()) : (m.unbind("change").change(function() {
				l.find(".templateRuleURlPart").focus()
			}), l.inputFieldLostFocusHandler(function() {
				var a = l.find(".templateRuleURlPart").val();
				if (!a || !$.trim(a)) $.dmpagetmpl.ruleValidationError(l, a, dmStr["ui.nee.pages.84"]);
				else {
					var d = $.dmpagetmpl.constructUrlPattern(m.val(), a);
					if (l.data("rulePattern") != d) if ($.dmpagetmpl.pageContainsPattern(e, d)) $.dmpagetmpl.ruleValidationError(l, d, dmStr["ui.nee.pages.85"]);
					else {
						var g = $.dmpagetmpl.getRulesIncludingPattern(d);
						g ? $.dmpagetmpl.ruleValidationError(l, d, dmStr["ui.nee.pages.85"] + " " + g.title + ".") : ($.dmUIBlockControlled({
							region: "pagetmpl.updateRule",
							op: "block",
							style: "wheel"
						}), $.dmsrv.updateUrlRule(l.data("rulePattern"), d, e,
						function(a) {
							l.data("rulePattern", d);
							g && $.dmpagetmpl.removeRuleByPattern(g.rules, d);
							var j = l.data("rule");
							j ? j.urlPattern = d: ($.dmpagetmpl.getUrlRules(e).push(a), l.data("rule", a));
							$.dmfw.refreshPreview();
							$.dmUIBlockControlled({
								region: "pagetmpl.updateRule",
								op: "unblock",
								style: "wheel"
							})
						}))
					}
				}
			}), l.find(".assignTemplateDelete").unbind("click").click(function() {
				var a = l.data("rulePattern");
				a && $.dmsrv.removeUrlRule(a,
				function() {
					var d = $.dmpagetmpl.getUrlRules(e);
					$.dmpagetmpl.removeRuleByPattern(d, a)
				});
				l.remove();
				$.dmfw.refreshPreview()
			}));
			a.find(".assignTemplateWrapper").append(k);
			j || l.find(".templateRuleURlPart").focus()
		},
		initPageTepmlateButtons: function(a, e, d) {
			e.find(".manageTemplateFooterBtns").show();
			var g = e.find(".deleteTemplate");
			a.alias && (a.alias == HOME_PAGE_DESIGN_ALIAS || a.alias == DEFAULT_PAGE_DESIGN_ALIAS) ? g.hide() : g.show();
			g.neeConfirmationPopUpDiv(dmStr["ui.nee.pages.87"], {
				initCallback: function() {
					$.dmpagetmpl.deletePageTemplate(a, d)
				}
			});
			e.find(".resetTemplate").neeConfirmationPopUpDiv(dmStr["ui.nee.pages.88"], {
				initCallback: function() {
					$.dmsrv.resetPageDesign(a.id,
					function() {
						$.dmfw.refreshPreview()
					})
				}
			});
			e.find(".editTemplate").unbind("click").click(function() {
				$.dmpages.navToPage(a);
				NEFW.navigateToTabWithHistory(NAV_DESIGN_ID)
			})
		},
		deletePageTemplate: function(a, e) {
			$.dmUIBlockControlled({
				region: "pagetmpl.deleteTmpl",
				op: "block",
				style: "wheel"
			});
			$.dmPost({
				url: "/pages/" + a.id + "/delete",
				success: function() {
					a.id == $.dmx.page.id && ($.dmx.page = $.dmx.homePage());
					e.remove();
					$.dmpagetmpl.selectHomeTmpl();
					$.dmops.updateEditContext.all({
						success: function() {
							if ($.dmpages.curPage = a.id) $.dmpages.curPage = null;
							$.dmpages._afterPageDeletionCB();
							$.dmUIBlockControlled({
								region: "pagetmpl.deleteTmpl",
								op: "unblock",
								style: "wheel"
							})
						}
					})
				}
			})
		},
		initPageTemplateTab: function(a, e) {
			$("#pagesTemplateSettNav").show();
			var d = $.dmx.pagesByAlias()[a];
			d && (d.isTemplate || a == HOME_PAGE_DESIGN_ALIAS) ? (e.itemUrl == d.url ? ($(".hasTemplate").hide(), $(".isTemplate").show()) : ($(".hasTemplate").show(), $(".isTemplate").hide()), $(".templateSettTemplateName").text(d.title)) : ($(".isTemplate").hide(), $(".hasTemplate").hide());
			$.dmpagetmpl.initTemplateRadioButtons(a, e)
		},
		initTemplatesSelectList: function(a, e) {
			var d = $.dmfw.isPT() ? "span": "option";
			$("#template-select").empty();
			$.dmfw.isPT() && $("#template-select").append($("\x3c" + d + ' class\x3d"ptSelectOption" value\x3d""\x3e' + dmStr["ui.nee.pages.39"] + "\x3c/" + d + "\x3e"));
			$("#template-select").append($("\x3c" + d + ' class\x3d"ptSelectOption" value\x3d"default"\x3edefault\x3c/' + d + "\x3e"));
			$("#template-select").append($("\x3c" + d + ' class\x3d"ptSelectOption" value\x3d"home"\x3ehome\x3c/' + d + "\x3e"));
			$.each($.dmx.sitePages,
			function(e, j) {
				j.alias != a && ("header" != j.alias && j.alias != DEFAULT_PAGE_DESIGN_ALIAS && j.alias != HOME_PAGE_DESIGN_ALIAS && !j.isFromScratchLegacy && j.isTemplate) && $("#template-select").append($("\x3c" + d + ' class\x3d"ptSelectOption" value\x3d"' + j.alias + '"\x3e' + j.title + "\x3c/" + d + "\x3e"))
			});
			$.dmfw.isPT() && ($("#pageTemplatesSelectDifferentSelectBox").find('.ptSelectOption[value!\x3d""]').data("onReady",
			function(a) {
				return function() {
					$.dmpagetmpl.assignTemplateBtnImpl(a)
				}
			} (e)), $("#pageTemplatesSelectDifferentSelectBox").neePtSelectBox())
		},
		initTemplateRadioButtons: function(a, e) {
			function d() {
				j.find(".expanded").addClass("displayNone");
				j.find(".collapsed").removeClass("displayNone");
				j.find(".newTemplateCreated").hide();
				j.find(".manageAlsoAssignText").hide();
				$(".templatePageAlreadyTmpl #manageTemplateBtnTmpl").removeClass("grayBtn").addClass("blueBtn");
				$.dmfw.isPT() && $(".templatePageAlreadyTmpl #manageTemplateBtnTmpl").removeClass("blueBtn");
				$.dmpagetmpl.inAlreadyExist || ($(".templatePageAlreadyTmpl").hide(), j.find(".newTemplate").show(), j.removeClass("templatePageSelectArrow"));
				j.find("#selectTemplateConfirmMsg").hide()
			}
			function g(g) {
				d();
				var m = g.$li;
				m.find(".collapsed").addClass("displayNone");
				m.find(".expanded").removeClass("displayNone");
				g.clicked ? (m.find(".manageTemplateBtn").hide(), m.hasClass("newTemplate") && (m.find(".templateTmplNameInput").val(e.itemTitle), m.find("#newTemplateBtn").unbind("click").click(function() {
					$.dmpagetmpl.setAsNewTemplate(m, e, k.alias)
				})), m.show()) : $.dmpagetmpl.showManageAlreadyExisitingTemplatePart(m, j, a)
			}
			$.dmpagetmpl.inAlreadyExist = !1;
			$.dmpagetmpl.initTemplatesSelectList(a, e);
			var j = $(".templatePageSelectWrapper"),
			k = $.dmx.pagesByAlias()[a];
			j.find(":radio , .collapsed").unbind("click").click(function() {
				g({
					$li: $(this).parents("li"),
					pageAlias: a,
					navItem: e,
					clicked: !0
				})
			});
			d();
			k && (k.isTemplate || k.alias == HOME_PAGE_DESIGN_ALIAS) && e.itemUrl == k.url && g({
				$li: j.find(".newTemplate"),
				clicked: !1
			});
			$.dmpagetmpl.initAssignTemplateBtn(e)
		},
		setAsNewTemplate: function(a, e, d) {
			var g = $.dmx.getPageByField("alias", d),
			j = a.find(".templateTmplNameInput");
			$.dmx.rt.isPageEqualToLiveUrl && d != DEFAULT_PAGE_DESIGN_ALIAS && d != HOME_PAGE_DESIGN_ALIAS ? ($.dmUIBlockControlled({
				region: "pagetmpl.setAsNewTemplate",
				op: "block",
				style: "wheel"
			}), $.dmsrv.setAsTemplate({
				pageId: g.id,
				setAsTemplate: !0,
				pageTitle: j.val(),
				success: function() {
					g.isTemplate = !0;
					g.title = j.val();
					$.dmpagetmpl.afterNewTemplateCreated(e, g, a)
				}
			})) : $.dmx.getPageByField("title", j.val()) ? ($.dmpagetmpl.showError(".templateTmplNameInput", dmStr["ui.nee.pages.89"], !0), j.focus()) : ($.dmUIBlockControlled({
				region: "pagetmpl.setAsNewTemplate",
				op: "block",
				style: "wheel"
			}), $.dmops.createPageWithCheck({
				pageUrl: e.itemUrl,
				setAsTemplate: !0,
				suggestedAlias: j.val(),
				success: function(d) {
					$.dmpagetmpl.afterNewTemplateCreated(e, d, a);
					a.find("#newTemplateBtn").unbind("click").click(function() {
						$.dmpagetmpl.setAsNewTemplate(a, e, d.alias)
					})
				},
				error: function(a) {
					try {
						switch (a.error_code) {
						case "PageNotAvailable":
							var d = dmStr["ui.nee.error.p.urlnotavailable.1"].replace("%s", e.itemUrl);
							$.dmpagetmpl.showError(".pageType", d, !0);
							return ! 0;
						default:
							return null
						}
					} catch(g) {
						return null
					} finally {
						$.dmUIBlockControlled({
							region:
							"neeLinksWidget.modifyLink",
							op: "unblock"
						})
					}
				}
			}))
		},
		afterNewTemplateCreated: function(a, e, d) {
			a.pageAlias = e.alias;
			a.pageID = e.id;
			d.find(".newTemplateCreated").show();
			d.find(".manageAlsoAssignText").show();
			d.find(".newTemplateName").text(e.title);
			d.find("#manageTemplateBtn").unbind("click").click(function() {
				$.dmpages.openPageTemplatesPopup(e.alias)
			});
			d.find("#manageTemplateBtn").show();
			$(".templateSettTemplateName").text(e.title);
			$.dmUIBlockControlled({
				region: "pagetmpl.setAsNewTemplate",
				op: "unblock",
				style: "wheel"
			})
		},
		assignTemplateBtnImpl: function(a) {
			$.dmUIBlockControlled({
				region: "pages.AssignPageToUrl",
				op: "block",
				style: "wheel"
			});
			var e = $.dmfw.isPT() ? $("#pageTemplatesSelectDifferentSelectBox").attr("value") : $("#template-select").val();
			$.dmsrv.assignPageToUrl(e, a.itemUrl,
			function() {
				$("#selectTemplateConfirmMsg").show();
				$.dmops.updateEditContext.all({
					success: function() {
						a.pageAlias = e;
						try {
							a.pageID = $.dmx.sitePages.filter(function(a) {
								return a.alias == e
							})[0].id
						} catch(d) {}
						$.dmpages.navToPageLink(a);
						$(".hasTemplate").show();
						$(".isTemplate").hide();
						$(".templatePageAlreadyTmpl #manageTemplateBtnTmpl").unbind("click").removeClass("blueBtn").addClass("grayBtn");
						$(".templateSettTemplateName").text(e);
						$.dmUIBlockControlled({
							region: "pages.AssignPageToUrl",
							op: "unblock",
							style: "wheel"
						})
					}
				})
			})
		},
		initAssignTemplateBtn: function(a) {
			$("#selectTemplateBtn").unbind("click").click(function() {
				$.dmpagetmpl.assignTemplateBtnImpl(a)
			})
		},
		pageContainsPattern: function(a, e) {
			var d = $.dmpagetmpl.getUrlRules(a),
			g = !1;
			$.each(d,
			function(a, d) {
				d.urlPattern == e && (g = !0)
			});
			return g
		},
		showManageAlreadyExisitingTemplatePart: function(a, e, d) {
			$.dmpagetmpl.inAlreadyExist = !0;
			a.hide();
			e.addClass("templatePageSelectArrow");
			$(".templatePageAlreadyTmpl").show();
			$(".templatePageAlreadyTmpl #manageTemplateBtnTmpl").unbind("click").click(function() {
				$.dmpages.openPageTemplatesPopup(d)
			})
		},
		getUrlRules: function(a) {
			var e = [];
			return e = ORIGINAL_PAGE_ALIAS != a ? $.dmx.pagesByAlias()[a].rules: $.dmx.site.dontMobilizeRules
		},
		showError: function(a, e, d) {
			$.dmfw.showQTip({
				type: "error",
				selector: a,
				text: e,
				position: {
					at: "bottom center",
					my: "top center"
				},
				dontHide: !1,
				hide: {
					event: "click unfocus",
					fixed: !1,
					effect: {}
				},
				events: {
					toggle: d
				}
			})
		},
		_isBaseURL: function(a) { - 1 == a.indexOf("//") && (a = "http://" + a);
			"/" == a.substring(a.length - 1) && (a = a.substring(0, a.length - 1));
			var e = $.dmx.site.baseUrl;
			"/" == e.substring(e.length - 1) && (e = e.substring(0, e.length - 1));
			return a == e
		},
		getRulesIncludingPattern: function(a) {
			for (var e = 0; e < $.dmx.sitePages.length; e++) {
				var d = $.dmx.sitePages[e],
				g = d.rules;
				if (g) for (var j = 0; j < g.length; j++) {
					var k = g[j];
					if (k.urlPattern == a) return {
						rules: g,
						title: d.title + " " + dmStr["ui.nee.pages.15"],
						alias: d.alias
					}
				}
			}
			if (e = $.dmx.site.dontMobilizeRules) for (j = 0; j < e.length; j++) if (k = e[j], k.urlPattern == a) return {
				rules: e,
				title: dmStr["ui.nee.pages.90"],
				alias: ORIGINAL_PAGE_ALIAS
			}
		},
		removeRuleByPattern: function(a, e) {
			var d = -1;
			$.each(a,
			function(a, j) {
				j.urlPattern == e && (d = a)
			}); - 1 < d && a.splice(d, 1)
		},
		ruleValidationError: function(a, e, d) {
			a.data("lastErrPat") != e ? ($.dmpagetmpl.showError("#" + a.attr("id") + " .templateRuleURlPart", d), a.data("lastErrPat", e), a.find(".templateRuleURlPart").focus()) : (e = a.data("rulePattern")) ? (e = $.dmpagetmpl.getPatternParts(e), a.find(".templateRuleURlPart").val(e.urlPart), a.find("#selectAssignTemplate").val(e.operator)) : a.remove()
		},
		getPatternParts: function(a) {
			var e = a.split("\x3e"),
			d = "EXACTLY";
			1 < e.length && (a = e[1], d = e[0].replace("{", "").replace("}", ""));
			return {
				operator: d,
				urlPart: a
			}
		},
		initTmplNameInput: function(a, e, d) {
			a.data("lastErrInput", e.title);
			a.val(e.title);
			e.alias == HOME_PAGE_DESIGN_ALIAS ? a.disable() : (a.enable(), a.inputFieldLostFocusHandler(function(g) {
				g != e.title && (!g || 0 == g.length ? a.data("lastErrInput") != g ? ($.dmpagetmpl.showError(".manageTemplateSubtitleTmplName", dmStr["ui.nee.pages.96"]), a.data("lastErrInput", g), a.focus()) : (a.val(e.title), a.data("lastErrInput", e.title)) : $.dmx.getPageByField("title", g) ? a.data("lastErrInput") != g ? ($.dmpagetmpl.showError(".manageTemplateSubtitleTmplName", dmStr["ui.nee.pages.97"] + " '" + g + "' " + dmStr["ui.nee.pages.98"]), a.data("lastErrInput", g), a.focus()) : (a.val(e.title), a.data("lastErrInput", e.title)) : $.dmsrv.renamePage(e.id, g,
				function() {
					e.title = g;
					d.text(g);
					d.attr("title", g)
				}))
			}))
		}
	}
}); (function(a) {
	var e = {
		wrapperClass: "wrapperWithBubble",
		bubbleContentClass: "bubbleContentText",
		bubbleTitleClass: "bubbleTitleText"
	};
	a.fn.attachBubble = function(d) {
		var g = a.extend({},
		e, d || {});
		a('\x3cdiv class\x3d"triangleBubble"\x3e\x3c/div\x3e');
		d = a('\x3cdiv class\x3d"bubbleWrapper"\x3e\x3c/div\x3e');
		d.append(a('\x3cdiv class\x3d"bubbleCloser"\x3e\x3c/div\x3e'));
		d.append(a('\x3cdiv class\x3d"bubbleTitle"\x3e\x3c/div\x3e'));
		d.append(a('\x3cdiv class\x3d"bubbleContent"\x3e\x3c/div\x3e'));
		a(this).find("." + g.wrapperClass).each(function() {
			var d = a(this).find("." + g.bubbleContentClass).html(),
			e = a(this).find("." + g.bubbleTitleClass).text();
			a(this).dmQtip({
				hide: {
					event: !1
				},
				content: {
					text: d,
					title: {
						text: e
					}
				},
				style: {
					classes: "ui-tooltip-dm ui-tooltip-blue ui-tooltip-shadow ui-tooltip-rounded"
				}
			})
		})
	}
})(jQuery); (function(a) {
	a.siteSettingsUtil = {
		options: {
			autoSave: !1,
			refreshPreviewAfterSave: !0,
			beforeSave: function() {},
			afterSave: function() {}
		},
		siteSettingsShow: function(d, e) {
			a("#siteSettingsInnerPanel \x3e div").addClass("displayNone");
			a("#" + d).removeClass("displayNone");
			a(e).parent().find("span").removeClass("orange");
			a(e).addClass("orange")
		},
		addToSiteSettings: function(d, e) {
			d && 0 < d.size() && (e[a(d).data("key")] = a(d).val(), a.dmx.site.siteSettings[a(d).data("key")] = a(d).val(), a(d).data("changed", !1))
		},
		onSaveClick: function(d, e) {
			var j = {},
			k = [];
			a(".siteSettingsInput").each(function(d, e) {
				a(e).data("changed") && (j[a(e).data("key")] = a(e).data("curValue"), a.dmx.site.siteSettings[a(e).data("key")] = a(e).data("curValue"), a(e).data("changed", !1), a(e).data("changeCB") && k.push(a(e).data("changeCB")));
				a(e).data("invalid") && (a(e).val(a(e).data("initial")), a(e).data("invalid", "false"))
			});
			a.siteSettingsUtil.addToSiteSettings(a("#siteDescription"), j);
			a.siteSettingsUtil.addToSiteSettings(a("#siteMetaKeywords"), j);
			a.siteSettingsUtil.addToSiteSettings(a("#headSectionText"), j);
			var l = "/sites/" + a.dmx.site.id + "/setsitesettings";
			e || a.dmBlockUI();
			a.dmPost({
				url: l,
				data: j,
				success: function() {
					a.each(k,
					function(a, d) {
						d()
					});
					d ? (a.siteSettingsUtil.options.refreshPreviewAfterSave && a.dmfw.refreshPreview(), a.dmUnblockUI(), d()) : e || (a.siteSettingsUtil.toggleSavingButton(!1), a.siteSettingsUtil.initSiteSettings(), a.siteSettingsUtil.options.refreshPreviewAfterSave && a.dmfw.refreshPreview(), a.dmUnblockUI())
				}
			})
		},
		toggleSavingButton: function(d) {
			d ? (a(".siteSettSaveBtn").addClass("orangeBtn ptOrangeBtn").removeClass("grayBtn"), a(".siteSettSaveBtn").unbind("click").click(function() {
				a.siteSettingsUtil.options.beforeSave && a.siteSettingsUtil.options.beforeSave();
				a.siteSettingsUtil.onSaveClick(a.siteSettingsUtil.options.afterSave())
			})) : (a(".siteSettSaveBtn").removeClass("orangeBtn ptOrangeBtn").addClass("grayBtn"), a(".siteSettSaveBtn").unbind("click"))
		},
		loadSiteAndInitScreen: function() {
			a.dmx.site && !a.dmx.site.isRedirected ? (a("#_cssHtml .slideRightPanelInner").hide(), a.dmUIBlockControlled({
				region: "_updateEditContext.all",
				op: "block"
			}), a.dmops.updateEditContext.site({
				withRedirect: !0,
				success: function() {
					a.dmUIBlockControlled({
						region: "_updateEditContext.all",
						op: "unblock"
					});
					a("#_cssHtml .slideRightPanelInner").fadeIn();
					a.siteSettingsUtil.initSiteSettings()
				}
			})) : a.siteSettingsUtil.initSiteSettings()
		},
		updateDisplayedSiteStatus: function(d) {
			a(".publishText").removeClass("siteStatusReublish siteStatusPublished siteStatusNotPublished");
			d.isPublished && d.needsRepublish ? a(".publishText").addClass("siteStatusRepublish") : d.isPublished ? a(".publishText").addClass("siteStatusPublished") : a(".publishText").addClass("siteStatusNotPublished");
			a(".publishText").text(d.isPublished ? d.needsRepublish ? dmStr["ui.nee.siteSettings.14"] : dmStr["ui.nee.siteSettings.13"] : dmStr["ui.nee.siteSettings.12"])
		},
		initSiteSettings: function(d) {
			d && (a.siteSettingsUtil.options = a.extend(a.siteSettingsUtil.options, d));
			a("#_siteSettings input").placeholder();
			a("#_siteSettings .panelsTitleWrapper .panelTitleQmark").dmQtip({
				content: dmStr["ui.nee.siteSettings.17"]
			});
			a(".siteSettingsInnerPanel").attachBubble();
			var e = a.dmx.site,
			j = e.siteSettings,
			k = a("#siteSettingsInnerPanel .accountTypeWrapper .accountType");
			a("");
			var l = a("#siteSettingsInnerPanel select.selectCache"),
			m = a("#siteSettingsInnerPanel select.selectFooter"),
			n = a("#siteSettingsInnerPanel input.analyticsInput"),
			o = a("#siteSettingsInnerPanel input.piwikInput"),
			r = a("#siteSettingsInnerPanel input.brighttagInput"),
			u = a("#siteSettingsInnerPanel #autoSyncButton");
			d = a("#siteSettingsInnerPanel #siteDescription");
			var s = a("#siteSettingsInnerPanel #siteMetaKeywords"),
			B = a("#siteSettingsInnerPanel #iframesWhiteListWrapper"),
			z = a("#siteSettingsInnerPanel #scriptsWhiteListWrapper"),
			v = a("#siteSettingsInnerPanel #headSectionText"),
			D = a("#siteSettingsInnerPanel #specificTag"),
			E = a("#siteSettingsInnerPanel #yjpBodySectionText"),
			F = function(d, e) {
				a(d).toggleClass("okIconImage", e);
				a(d).toggleClass("alertIconImage", !e)
			},
			I = function(d) {
				a(d).hover(function() {
					a(this).addClass("orange")
				},
				function() {
					a(this).removeClass("orange")
				}).css("cursor", "pointer")
			};
			a("#settingsSyncBtnSyncNow").unbind("click").click(function() {
				var d = "/sites/" + a.dmx.site.id + "/updatewithlive";
				a.dmBlockUI();
				a.dmPost({
					url: d,
					success: function() {
						a(".syncDate").hide();
						a.dmUnblockUI();
						a.dmfw.refreshPreview()
					},
					error: function(d) {
						try {
							switch (d.error_code) {
							case "PageNotAvailable":
								return a.showError("PageNotAvailable"),
								a.dmUnblockUI(),
								!0
							}
						} catch(e) {
							return null
						}
					}
				})
			});
			if (e.planId) {
				var G = dmStr["ui.free"];
				a.dmx.isPremium() && (G = dmStr["ui.premium"]);
				k.text(G.toCamel());
				I(".accountTypeWrapper .upgradeBtn");
				a(".accountTypeWrapper .upgradeBtn").unbind("click").click(function() {
					a.dmfw.openUpgradePopup({
						token: "settings"
					})
				});
				k = !0;
				3 == a.dmx.site.planId && (k = !1);
				k || a(".accountTypeWrapper .upgradeBtn").hide()
			}
			if (e) {
				F(".publishAlertIcon", e.isPublished && !e.needsRepublish);
				a.siteSettingsUtil.updateDisplayedSiteStatus(e);
				F(".redirectAlertIcon", e.isRedirected);
				a(".redirectText").text(e.isRedirected ? dmStr["ui.nee.siteSettings.16"] : dmStr["ui.nee.siteSettings.15"]);
				if (a("body").hasClass("JALAN_ADMIN") || a("body").hasClass("JALAN")) F(".commonTagAlertIcon", e.commonTagEnabled),
				a(".commonTagStatusText").text(e.commonTagEnabled ? dmStr["ui.nee.siteSettings.19"] : dmStr["ui.nee.siteSettings.20"]),
				a(".commonTagBtn").text(e.commonTagEnabled ? dmStr["ui.nee.siteSettings.23"] : dmStr["ui.nee.siteSettings.25"]),
				I(".commonTagBtn"),
				a(".commonTagBtn").unbind("click").click(function() {
					var d = e.commonTagEnabled ? dmStr["ui.nee.siteSettings.26"] : dmStr["ui.nee.siteSettings.24"],
					d = d + "? \x3c/br\x3e \x3c/br\x3e";
					a("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(d, {
						initCallback: function() {
							a.dmPost({
								url: "/sites/" + a.dmx.site.id + "/setcommontagstatus",
								success: function() {
									a.dmx.site.commonTagEnabled = !a.dmx.site.commonTagEnabled;
									a.siteSettingsUtil.initSiteSettings()
								}
							})
						},
						onNoCallback: function() {},
						triggerNow: !0,
						noText: dmStr["ui.no"].toUpperCase(),
						yesText: dmStr["ui.yes"].toUpperCase(),
						bindCloseToNo: !0,
						forceWidth: "280px",
						yesClass: "customText blueBtn no",
						noClass: "customText confirmDelete grayBtn",
						yesStyle: "padding-right: 5px !important;"
					})
				});
				e.isRedirected || (I(".redirectText"), I(".redirectBtn"), a(".redirectBtn").removeClass("displayNoneImportant"));
				if (!e.isPublished || e.needsRepublish) I(".publishText"),
				I(".publisBtn"),
				a(".publisBtn").removeClass("displayNoneImportant");
				a(".redirectText , .redirectBtn").unbind("click").click(e.isRedirected ?
				function() {}: function() {
					NEFW.displayRedirect()
				});
				a(".publishText , .publisBtn").unbind("click").click(e.isPublished && !e.needsRepublish ?
				function() {}: function() {
					NEFW.NAV.maintabs("nav", NAV_PUBLISH_ID)
				})
			}
			if (j) {
				a.siteSettingsUtil.initText(l, "cacheStrategy", j.cacheStrategy, !0);
				"No Cache" != j.cacheStrategy && a("#noCache").remove();
				n.data("validationFunction",
				function(a) {
					return ! a || "" == a || !!a.toUpperCase().match(/^UA-\d{4,10}-\d{1,4}$/)
				});
				n.data("validationMessage", dmStr["ui.nee.siteSettings.18"]);
				a.siteSettingsUtil.initText(n, "analyticsAccount", j.analyticsAccount);
				a.siteSettingsUtil.initText(o, "piwikSiteID", j.piwikSiteID);
				a.siteSettingsUtil.initText(r, "brighttagID", j.brighttagID);
				if ("" === j.siteFooter || !j.siteFooter) j.siteFooter = "default";
				a.siteSettingsUtil.initText(m, "siteFooter", j.siteFooter, !0);
				var l = j.disableAutoSync,
				m = !l,
				K = l ? "true": "false",
				J = function(d) {
					a.each(a.dmx.sitePages,
					function(a, e) {
						e.disableAutoSync = d
					})
				};
				a(".syncDate").hide();
				m && (a("#settingsSyncBtnSyncNow").hide(), a(".syncDate").hide());
				a(".syncDateSpan").text(j.lastSyncDate);
				u.addClass("siteSettingsInput");
				u.data("key", "disableAutoSync");
				u.onOffBtn({
					initState: m,
					onFn: function() {
						a("#settingsSyncBtnSyncNow").hide();
						a(".syncDate").hide();
						a.siteSettingsUtil.elementWasChanged(u, !1, K,
						function() {
							J(!1)
						})
					},
					offFn: function() {
						a("#settingsSyncBtnSyncNow").show();
						a.siteSettingsUtil.elementWasChanged(u, !0, K,
						function() {
							J(!0)
						})
					}
				});
				a.dmx.site.isFromScratch && (a(".syncWrapper").hide(), u.parents(".EditorInnerBottomPane").hide());
				B.data("validationFunction",
				function(a) {
					return ! a || "" == a || 255 > a.length
				});
				B.data("validationMessage", dmStr["ui.nee.siteSettings.listTooLong"]);
				B.data("key", "iframesToKeep");
				a.siteSettingsUtil.bindText(B, j.iframesToKeep);
				z.data("validationFunction",
				function(a) {
					return ! a || "" == a || 255 > a.length
				});
				z.data("validationMessage", dmStr["ui.nee.siteSettings.listTooLong"]);
				z.data("key", "scriptsToKeep");
				a.siteSettingsUtil.bindText(z, j.scriptsToKeep);
				a.siteSettingsUtil.initText(d, "seoSiteDescription", j.seoSiteDescription);
				a.siteSettingsUtil.initText(s, "seoSiteMetaKeywords", j.seoSiteMetaKeywords);
				a.siteSettingsUtil.initText(v, "headerContent", j.headerContent);
				a("body").hasClass("JALAN_ADMIN") || a("body").hasClass("JALAN") ? (a.siteSettingsUtil.initText(D, "specificTag", j.specificTag), a(".specificTagWrapper #specificTag").keypress(function() {
					return 2E3 > a(this).val().length
				})) : a("body").hasClass("YJP") && (a.siteSettingsUtil.initText(E, "specificTag", j.specificTag), a(".yjpBodySectionWrapper #yjpBodySectionText").keypress(function() {
					return 2E3 > a(this).val().length
				}));
				a(".expandImg").neePopUpDiv(a("#headerTextExpnadedWrapperToClone").clone().attr("id", "siteSettHeaderTextExpnadedWrapper"), {
					init: function() {
						var d = a("#siteSettHeaderTextExpnadedWrapper");
						d.find("#headerTextExpanded").empty();
						var e = v.val().replace("\x3chead\x3e", "").replace("\x3c/head\x3e", ""),
						g = CodeMirror(d.find("#headerTextExpanded").get(0), {
							value: e,
							lineNumbers: !0,
							lineWrapping: !0,
							mode: "htmlmixed"
						});
						d.find("#headerUpdateDiv").unbind("click").click(function() {
							a(".closeThis").trigger("click");
							v.val(g.getValue().replace("\x3chead\x3e", "").replace("\x3c/head\x3e", "").trim());
							a.siteSettingsUtil.elementWasChanged(v, v.val(), j.headerContent);
							d.find("#headerTextExpanded").empty()
						})
					},
					disableDrag: !0
				})
			}
			a("#settingsSavingButton .siteSettSaveBtn").unbind("click")
		},
		initText: function(d, g, j, k) {
			j = j || "";
			d && (d.data("key", g || ""), d.val(j), d.addClass("siteSettingsInput"), k ? d.unbind("change").change(function() {
				a.siteSettingsUtil.elementWasChanged(d, d.val(), j)
			}) : (d.unbind("keyup").keyup(function() {
				a.siteSettingsUtil.elementWasChanged(d, d.val(), j)
			}), d.data("validationFunction") && d.unbind("blur").blur(function() {
				var a = d.data("validationFunction");
				a && !a(d.val()) && (e(d, d.data("validationMessage")), d.data("changed", !1))
			})))
		},
		elementWasChanged: function(d, e, j, k) {
			var l = e != j,
			m = d.data("validationFunction");
			if (d) {
				d.data("changed", l);
				d.data("curValue", e);
				d.data("invalid", !1);
				d.data("changeCB", k);
				m && !m(e) && (l = !1, d.data("invalid", !0), d.data("initial", j), d.data("changed", l), d.data("curValue", ""));
				var n = l;
				n || a(".siteSettingsInput").each(function(d, e) {
					if (a(e).data("changed")) return n = !0,
					!1
				});
				a.siteSettingsUtil.toggleSavingButton(n);
				if (n && a.siteSettingsUtil.options.autoSave) a.siteSettingsUtil.onSaveClick(null, !0)
			}
		},
		getVal: function(a) {
			var e = a.find("textarea:first");
			if ((a = a.find(".checkBox:first")) && e) return a.is(":checked") ? "*": e.val().replace(/(\r\n|\n|\r)/gm, "$$$")
		},
		bindText: function(d, g) {
			var j = g || "",
			j = j.replace(/\$\$/gm, "\r\n"),
			k = d.find("textarea:first"),
			l = d.find(".checkBox:first");
			k.val("");
			"*" == j ? (l.attr("checked", !0), k.attr("disabled", "disabled"), k.closest(".textAreaDivWrapper").addClass("disabledTextArea")) : (k.val(j), k.removeAttr("disabled"), k.closest(".textAreaDivWrapper").removeClass("disabledTextArea"));
			l.unbind("click").click(function() {
				l.is(":checked") ? (a.siteSettingsUtil.elementWasChanged(d, a.siteSettingsUtil.getVal(d), j), k.attr("disabled", "disabled"), k.closest(".textAreaDivWrapper").addClass("disabledTextArea")) : (a.siteSettingsUtil.elementWasChanged(d, a.siteSettingsUtil.getVal(d), j), k.removeAttr("disabled"), k.closest(".textAreaDivWrapper").removeClass("disabledTextArea"))
			}); (l.is(".holdsSettingCheckbox *") ? l.closest(".holdsSettingCheckbox").parent() : l.parent()).addClass("siteSettingsInput");
			k.unbind("keyup").keyup(function() {
				a.siteSettingsUtil.elementWasChanged(d, a.siteSettingsUtil.getVal(d), j)
			});
			d.data("validationFunction") && k.unbind("blur").blur(function() {
				var g = d.data("validationFunction");
				g && !g(a.siteSettingsUtil.getVal(d)) && (e(d.find(".textAreaDivWrapper:first"), d.data("validationMessage")), d.data("changed", !1))
			})
		}
	};
	var e = function(d, e) {
		a.dmfw.showQTip({
			type: "error",
			selector: d,
			text: e,
			position: {
				at: "bottom center",
				my: "top center"
			},
			dontHide: !1,
			hide: {
				event: "click unfocus",
				fixed: !0,
				effect: function() {
					a(this).fadeOut("slow")
				}
			}
		})
	}
})(jQuery); (function(a) {
	a.fn.neeCssHtmlTabs = function() {
		var e = [{
			id: "global_css",
			name: dmStr["ui.nee.csshtml.1"],
			url: "/editor/nee/mainTabs/nee.codeArea.jsp",
			onReady: function() {
				a.cssHtmlUtil.initGlobalCss()
			}
		},
		{
			id: "page_css",
			name: dmStr["ui.nee.csshtml.2"],
			url: "/editor/nee/mainTabs/nee.codeArea.jsp",
			onReady: function() {
				a.cssHtmlUtil.initPageCss()
			}
		},
		{
			id: "page_html",
			name: dmStr["ui.nee.csshtml.3"],
			url: "/editor/nee/mainTabs/nee.codeArea.jsp",
			onReady: function() {
				a.cssHtmlUtil.initPageHtml()
			}
		}];
		a(this).neeSecondaryTabsControl(e)
	}
})(jQuery); (function(a) {
	var e = {
		targetElement: "#codeArea",
		oldValue: null,
		preventAssignSaveButton: !1,
		saveCss: function(d, e, j, k, l, m) {
			var n = this,
			o = !1,
			r = {};
			l && (r.device = l);
			"undefined" === typeof k && (k = !1);
			a(d.target).is(".doneBtn") && (o = !0);
			var u = null;
			if (!m && (a(n.targetElement).is("textarea") && (u = a(n.targetElement).html()), null == u || "" == u)) u = a(n.targetElement).val();
			u != n.oldValue || m ? (u = u.replace(/SITE_THEME/g, "DUDAMOBILE_THEME").replace(/SITE_KEPT/g, "DUDAMOBILE_KEPT"), r.value = u, a.changePage({
				clientChange: function() {
					e && e(u)
				},
				serverChange: function() {
					a.dmPostWithHistory({
						url: j,
						data: r,
						success: function(d) {
							d && d.value && (d.value = d.value.replace(/DUDAMOBILE_THEME/g, "SITE_THEME").replace(/DUDAMOBILE_KEPT/g, "SITE_KEPT"), a(n.targetElement).val(d.value), n.oldValue = d.value);
							k && k();
							d && d.value && a(n.targetElement).val(d.value);
							o && NEFW.NAV.maintabs("nav", NAV_DESIGN_ID)
						}
					})
				}
			})) : o && NEFW.navigateToTabWithHistory(NAV_DESIGN_ID)
		},
		initAdvancedTab: function(d, e, j, k, l, m, n) {
			var o = this;
			d = {};
			n && (d.device = n);
			a.ptMindTouch && a.ptMindTouch.showHelp(a(".mindTouchHelp"));
			a.dmPostWithHistory({
				url: e,
				data: d,
				success: function(d) {
					d.value = null !== d.value ? d.value.replace(/DUDAMOBILE_THEME/g, "SITE_THEME").replace(/DUDAMOBILE_KEPT/g, "SITE_KEPT") : "";
					a(o.targetElement).val(d.value);
					o.oldValue = d.value;
					m && m()
				}
			});
			o.preventAssignSaveButton || a(".updateBtn, .doneBtn").click(function(a) {
				o.saveCss(a, k, j, l)
			})
		},
		initGlobalCss: function(d, g) {
			a(".mindTouchHelp").attr("id", "dmMtSiteSettingsCssHtmlGlobalCss");
			e.initAdvancedTab("css", "/site/" + a.dmx.site.id + "/getGlobalCss/", "/site/" + a.dmx.site.id + "/setGlobalCss/", a.dmops.refreshGlobalCss, null, d, g)
		},
		initPageCss: function() {
			a(".mindTouchHelp").attr("id", "dmMtSiteSettingsCssHtmlPageCss");
			e.initAdvancedTab("css", "/page/" + a.dmx.currentPage() + "/getPageCss/", "/page/" + a.dmx.currentPage() + "/setPageCss/", a.dmops.refreshPageStyleCss)
		},
		initPageHtml: function() {
			a(".mindTouchHelp").attr("id", "dmMtSiteSettingsCssHtmlPageHtml");
			e.initAdvancedTab("htmlmixed", "/page/" + a.dmx.currentPage() + "/getPageHtml/", "/page/" + a.dmx.currentPage() + "/setPageHtml/", null,
			function() {
				a.dmfw.refreshPreview(!1, !0)
			})
		}
	};
	a.cssHtmlUtil = e
})(jQuery);
function initTemplatesPanel() {
	function a(a) {
		$.dmfw.calcPalettes(function() {
			m = !0;
			$.onPalettesArrivedSuccess && $.onPalettesArrivedSuccess();
			$.onPalettesArrivedSuccess = null;
			a && a()
		})
	}
	var e = NEFW.PREVIEW.get(0).contentWindow,
	d = 0,
	g = null,
	j = !1,
	k = "GOMO" == $.dmx.site.dmProductType ? commonProps["[GOMO].common.updateOldSites"] : commonProps["common.updateOldSites"],
	l = !$.dmx.site.isUsingLayout,
	m = !1;
	_handleColorPalettesScreen = function(a) {
		a && $("#showingPalettesMsg").show();
		var d = [];
		$.dmGet({
			url: "/sites/" + $.dmx.site.id + "/getallpalettes/",
			success: function(a) {
				if (a) {
					$("#showingPalettesMsg").hide();
					if (null != a[ - 1]) {
						var e = $("\x3cdiv\x3e\x3c/div\x3e").addClass("palette selected customPalette"),
						g = $("\x3cdiv\x3e\x3cspan\x3e\x3c/span\x3c/div\x3e").appendTo(e).addClass("paletteColorWrapperCustom");
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[ - 1][0]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[ - 1][1]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[ - 1][2]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[ - 1][3]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[ - 1][4]);
						$("\x3cdiv\x3e\x3c/div\x3e").css("clear", "both").appendTo(g);
						$("\x3cdiv class\x3d'navColorCustom'\x3e\x3c/div\x3e").html(dmStr["ui.nee.layouts.5"]).appendTo(e).addClass("navColorCustom orangeBtn");
						d.push(e)
					}
					for (e = 0; null != a[e];) {
						var j = $("\x3cdiv\x3e\x3c/div\x3e").addClass("palette").attr("dmPaletteID", e),
						g = $("\x3cdiv\x3e\x3cspan\x3e\x3c/span\x3c/div\x3e").appendTo(j).addClass("paletteColorWrapper");
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", 6 < a[e].length ? a[e][6] : a[e][3]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[e][2]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[e][1]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[e][0]);
						$("\x3cdiv\x3e\x3c/div\x3e").appendTo(g).addClass("paletteColor").css("background-color", a[e][5]);
						$("\x3cdiv\x3e\x3c/div\x3e").css("clear", "both").appendTo(g);
						$("\x3cdiv class\x3d'navColorCustom'\x3e\x3c/div\x3e").html(dmStr["ui.nee.layouts.5"]).appendTo(j).addClass("navColorCustom orangeBtn");
						d.push(j);
						e++
					}
					$(".palettesWrapper").show();
					allPalletesElements = d;
					$(d[null == $.dmx.site.paletteID || -1 == $.dmx.site.paletteID ? 0 : $.dmx.site.paletteID]).addClass("selected");
					$(".palettesWrapperPaging").empty().neePagingWidget(d, null == $.dmx.site.paletteID || -1 == $.dmx.site.paletteID ? 0 : $.dmx.site.paletteID, "arrows", 1)
				}
			}
		})
	};
	_addBlogSupport = function(a) {
		$(".blogFilter").show();
		a ? ($("#templateBlogShowRegular").addClass("selected"), $("#templateBlogShowBlog").removeClass("selected"), $(".blogTemplateHelpButton").hide(), $("#templateBlogShowBlog").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
			initCallback: function() {
				NEFW.recreateSite($.dmx.site.alias, "false");
				$.dmx.site.isBlog = !0
			}
		})) : ($("#templateBlogShowBlog").addClass("selected"), $("#templateBlogShowRegular").removeClass("selected"), $(".blogTemplateHelpButton").unbind("click").click(function() {
			$(".blogTemplatePopMessagePanel").toggle()
		}), $("#templateBlogStay").unbind("click").click(function() {
			$(".blogTemplatePopMessagePanel").hide()
		}), $("#templateBlogMakeSwitch").unbind("click").click(function() {
			NEFW.recreateSite($.dmx.site.alias, "true")
		}), $("#templateBlogShowRegular").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
			initCallback: function() {
				NEFW.recreateSite($.dmx.site.alias, "true");
				$.dmx.site.isBlog = !1
			}
		}), $.dmx.site.isBlog && $.dmx._showBlogBubbleFirstTime && ($(".blogTemplatePopMessagePanel").show(), $.dmx._showBlogBubbleFirstTime = !1))
	}; ! k && l ? ($.dmBlockUI($(".editorAndPreviewPanel"), !1), $.dmGet({
		url: "/sites/" + $.dmx.site.id + "/getthemetemplate",
		success: function(a) {
			allTemplates = a;
			$(".templatesImagesPanel").empty().neePagingWidget(_buildThemesHolders(a), d, "numbers", 2);
			$.dmUnblockUI()
		}
	}), $.dmx.site.isBlog && _addBlogSupport(), !$.dmx.site.isBlog && $.dmx.site.isBlogCompatible && _addBlogSupport(!0)) : $.dmx.site.isBlog ? ($(".EditorInnerBottomPane").hide(), $.dmGet({
		url: "/sites/" + $.dmx.site.id + "/getthemetemplate",
		success: function(a) {
			allTemplates = a;
			$(".templatesImagesPanel").empty().neePagingWidget(_buildThemesHolders(a), d, "numbers", 2);
			$.dmUnblockUI();
			_addBlogSupport()
		}
	})) : ($(".templatesImagesPanel").hide(), !$.dmx.site.isBlog && $.dmx.site.isBlogCompatible && _addBlogSupport(!0), l ? a() : _handleColorPalettesScreen());
	$(".navTypeItem").unbind("click").click(function(d) {
		d.stopPropagation(); ! j && l && $("#showingPalettesMsg").show();
		"restore" == $(this).data("laynum") ? ($("#RestoreLayouts").addClass("oldThemeChosen"), $.dmfw.restoreFromLayoutToTheme(), $(".palettesWrapper").hide(), $("#showingPalettesMsg").hide(), j = !1) : (num = $(this).data("laynum"), m ? $.dmfw.changeLayout(num,
		function() {
			$.dmfw.changeVariation(1);
			l && (j || ($.onPalettesArrivedSuccess = function() {
				_handleColorPalettesScreen(!0)
			},
			m && _handleColorPalettesScreen(!0), j = !0), $("#RestoreLayouts").removeClass("oldThemeChosen"))
		}) : a(function() {
			$.dmfw.changeLayout(num,
			function() {
				$.dmfw.changeVariation(1);
				l && (j || ($.onPalettesArrivedSuccess = function() {
					_handleColorPalettesScreen(!0)
				},
				m && _handleColorPalettesScreen(!0), j = !0), $("#RestoreLayouts").removeClass("oldThemeChosen"))
			})
		}));
		$(".navTypeItem").removeClass("selected").addClass("notselected");
		$(this).removeClass("notselected").addClass("selected")
	});
	$("#_templates").unbind("click.changecolor").on("click.changecolor", ".paletteColorWrapper",
	function() {
		function a(e) {
			e && ($(".customPalette").remove(), allPalletesElements.shift());
			$.dmfw.changePalette(d.parent().attr("dmPaletteID"));
			jQuery.each(allPalletesElements,
			function(a, d) {
				$(d).removeClass("selected")
			});
			d.parent().addClass("selected")
		}
		var d = $(this);
		allPalletesElements[0].hasClass("customPalette") ? ($("#placeholderForPopupTheme").neeConfirmationPopUpDiv(dmStr["ui.nee.layouts.27"], {
			initCallback: function() {
				a(!0)
			},
			forceWidth: "310px"
		}), $("#placeholderForPopupTheme").click()) : a(!1)
	});
	$(".navTypeItemCustom").unbind("click").click(function(a) {
		a.stopPropagation();
		a = new NEEVariations;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	});
	$("#_templates").unbind("click.colorselect").on("click.colorselect", ".navColorCustom",
	function(a) {
		a.stopPropagation();
		a = new NEESiteColors;
		$.dmfw.openGlobalEditor({
			editable: a
		})
	});
	_filterTemplatesByColor = function(a) {
		$.dmBlockUI($(".editorAndPreviewPanel"), !1);
		$.dmPost({
			url: "/sites/" + $.dmx.site.id + "/getthemetemplatebycolor",
			data: a,
			success: function(a) {
				allTemplates = a;
				$(".templatesImagesPanel").empty().neePagingWidget(_buildThemesHolders(a), d, "numbers", 2);
				$.dmUnblockUI()
			}
		})
	};
	_buildThemesHolders = function(a) {
		for (var j = [], k = 0; k < a.length; k++) {
			var l = $('\x3cdiv class\x3d"templateImgWrapper"\x3e\x3c/div\x3e').attr("text", "no").attr("themeName", a[k].name).attr("themeIndex", k),
			m = $('\x3cimg class\x3d"templateImg"\x3e\x3c/img\x3e');
			m.attr("src", a[k].thumbnail_image);
			0 == k && l.attr("id", "firstThemeNoPop");
			l.append(m);
			var m = $("\x3cdiv\x3e\x3c/div\x3e").css("display", "none").appendTo(l).attr("class", "imgPlaceholderDisplayTheme"),
			B = $("\x3cdiv\x3e\x3c/div\x3e").attr("text", "no").appendTo(m).attr("class", "divInDisplayTheme"),
			z = $('\x3cimg style\x3d"margin-left: 15px; margin-top: 40px;"\x3e\x3c/img\x3e').css("align", "middle").css("display", "none");
			z.attr("src", a[k].small_image).css("display", "none");
			B.append(z);
			m = $("\x3cspan\x3e" + dmStr["ui.nee.themePanel.104"] + "\x3c/span\x3e").appendTo(m).attr("class", "imgPlaceholderSelectTemplate blueBtn");
			j.push(l);
			$.dmx.site.baseThemeName == a[k].name && (d = k, l.attr("text", "yes"), l.addClass("selectedTemplate"));
			$("#placeholderForPopupTheme").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
				initCallback: function() {
					D()
				}
			});
			m.click(function(a) {
				a.stopPropagation();
				v($(this).parent().parent())
			});
			l.hover(function() {
				if ($.dmx.site.isBlog || "firstThemeNoPop" != $(this).attr("id")) $(this).addClass("hover"),
				hover_intent = setTimeout(function() {
					$(".templateImgWrapper.hover").find(".imgPlaceholderDisplayTheme").fadeIn("fast");
					$(".templateImgWrapper.hover").find("img").last().show()
				},
				600)
			},
			function() {
				try {
					clearTimeout(hover_intent)
				} catch(a) {}
				$(".templateImgWrapper.hover").find(".imgPlaceholderDisplayTheme").hide();
				$(".templateImgWrapper.hover").find("img").last().hide();
				$(this).removeClass("hover")
			});
			var v = function(a) {
				$.dmUIBlockControlled({
					region: "theme.confirmation",
					op: "block",
					style: "wheel"
				});
				g = a;
				$.dmGet({
					url: "/sites/" + $.dmx.site.id + "/issitethememodified",
					success: function(a) {
						$.dmUIBlockControlled({
							region: "theme.confirmation",
							op: "unblock"
						}); ! 0 == a ? $("#placeholderForPopupTheme").trigger("click") : D()
					}
				})
			},
			D = function(a) {
				a || (a = g);
				$.dmx.site.baseThemeName = a.attr("themeName");
				$(".templateImgWrapper").removeClass("selectedTemplate");
				$.each(j,
				function(a, d) {
					$(d).removeClass("selectedTemplate")
				});
				a.addClass("selectedTemplate");
				$.dmUIBlockControlled({
					region: "theme.change",
					op: "block",
					style: "wheel"
				});
				$.dmPost({
					url: "/sites/" + $.dmx.site.id + "/" + $.dmx.page.id + "/assignThemeToSite/" + a.attr("themeName"),
					success: function(a) {
						$.navigationUtil.clearNavShape($($.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav")));
						$.deselectAllEditableElements();
						e.showLoadingDotsNEW && e.showLoadingDotsNEW();
						$.dmfw.refreshPreview();
						e.refreshGlobalCssAndShowLoadingNEW && e.refreshGlobalCssAndShowLoadingNEW(a.value, 3E3);
						$.dmUIBlockControlled({
							region: "theme.change",
							op: "unblock"
						});
						setTimeout("neeHistoryManager.clearAndUpdateHistory();", 3200);
						wrTrackEvent(WR_SITE_CHANGE_THEME, {
							theme: $.dmx.site.baseThemeName
						})
					}
				})
			};
			$(l).unbind("click").click(function() {
				v($(this))
			})
		}
		$(".smallColorCube").unbind("click").click(function(a) {
			a.stopPropagation();
			$(".smallColorCube").removeClass("smallFilterColorCubeSelected");
			$(this).addClass("smallFilterColorCubeSelected");
			$("#filterAnyColor").removeClass("filterAnyColorSelected");
			a = $(this).attr("color_name");
			_filterTemplatesByColor(a)
		});
		$("#filterAnyColor").unbind("click").click(function(a) {
			a.stopPropagation();
			$(".smallColorCube").removeClass("smallFilterColorCubeSelected");
			$(this).addClass("filterAnyColorSelected");
			initTemplatesPanel()
		});
		return j
	};
	$("#_templatesWrapper .panelsTitleWrapper .panelTitleQmark").dmQtip({
		content: dmStr["ui.nee.themePanel.103"]
	});
	wrTrackEvent(WR_SITE_SELECT_THEMES)
}
$.extend({
	dmpub: {
		init: function(a) {
			$.dmpub.screen = a.screen || "A";
			$.dmx.treatAsPublishReseller() && ($.dmpub.screen = "A");
			$.dmpub.statsMap = {
				A: "Baseline",
				B: "A",
				C: "B"
			};
			$("#_publish input").placeholder();
			$.dmpub._initRedirectButton();
			$("#_publish .panelsTitleWrapper .panelTitleQmark").dmQtip({
				content: dmStr["ui.nee.publishPanel.201a"]
			});
			$.dmLoading($.dmfw.isPT() ? $("#Wrapper") : $(".editorAndPreviewPanel"));
			$.dmpub._hide();
			a = a || {};
			$.dmpub._getSiteState(a, $.dmpub._handleState);
			$.dmpub._initSectionSelectors();
			if (commonProps["common.publish.replaceWithAlias"]) {
				var e = "";
				try {
					e = $.dmx.site.suggestedDomain
				} catch(d) {}
				e && "" != e && $(".neePublish_A_listAddressItem").each(function(a, d) {
					$(d).text($(d).text().replace("m.yourcompany.com", e))
				})
			}
			$.dmui.onPublishTabReady({
				product: $.dmx.site.dmProductType
			});
			$.dmx.site.isFromScratch && ($(".ptPublishResellersUrlCompare").hide(), $(".neePublishResellersUrlText").hide(), $("#neePublishResellersUrlCompare").hide())
		},
		_handleState: function(a) {
			$.dmpub._hide();
			$.dmpub._clear();
			$.dmpub._initRedirectButton(a);
			a.justPublished ? ($.dmx.site.isFromScratch ? ($.dmpub._showConfirmationScreenBFS(a), $.dmpub._initConnectRedirectBoxes(a)) : $.dmpub._showConfirmationScreen(a), $.dmx.firstPublished = null) : !a.product || !$.dmpub._isGOMOLikeProduct(a.product) ? !a.premium || a.reseller && a.requiresPayment ? $.dmsrv.getSiteFeatures(function(e) {
				$.dmpub._hasFeatures(e.features) ? ($.dmpub._populateFeatures("#dmwrPremFeatures", e.features), $.dmpub._initWithPayment(a, e.features)) : (a.noFeatures = !0, a.published ? $.dmpub._initNoPayment(a, $.dmpub._publish) : $.dmpub._initWithPayment(a, e.features))
			}) : a.newuser ? $.dmpub._initWithPayment(a) : $.dmpub._initNoPayment(a, $.dmpub._publish) : $.dmpub.gomo._handleGOMOState(a)
		},
		_populateFeatures: function(a, e) {
			var d = $(a);
			$.each(e,
			function(a, j) {
				var k = $("#dmwrPremFeatureTmpl").tmpl({
					featureName: j.description
				});
				d.append(k);
				a < e.length - 1 ? d.append(",\x26nbsp;") : d.append(".")
			})
		},
		_initWithPayment: function(a, e) {
			$.dmpub._initWithPaymentLayout(a, e);
			$.dmpub._initWithPaymentButtons(a, e);
			$.dmpub._show();
			a.reseller && $.dmpub.initCopyButtonResellers()
		},
		_initWithPaymentButtons: function(a, e) {
			if (a.newuser) {
				var d = "";
				"B" == $.dmpub.screen ? d = "#neePublish_A_ButtonPremium, #neePublish_A_ButtonBasic": "C" == $.dmpub.screen && (d = "#neePublish_A_ButtonMonthly, #neePublish_A_ButtonPremium, #neePublish_C_BasicPubLink");
				$(d).unbind("click.clk").bind("click.clk",
				function() {
					wrTrackEvent(WR_SITE_REVIEW_PUBLISH_ACCOUNT_BOX, {
						recipe: $.dmpub.statsMap[$.dmpub.screen]
					});
					$(this).is(".premiumBtn") && trackPremiumSignUp();
					$(".neePublishPlansWrapper").hide();
					$(".neePublishSignupWrapper").show();
					$(".neeSelectedPlanBtn").removeClass("neeSelectedPlanBtn");
					$(this).addClass("neeSelectedPlanBtn")
				});
				$.dmpub._initSignUpPopup(a, e, $.dmpub._withPaymentSuccess,
				function() {
					if ($.dmpub._noneSelected() && !a.premium) return dmStr["ui.nee.publishPanel.202"]
				})
			} else {
				var g = null,
				g = a.reseller ? $(".neeResellersPurchase") : $.dmpub._getSectionSelector($.dmpub.constants.PUB_BTN, a);
				"B" == $.dmpub.screen ? g = "#neePublish_A_ButtonPremium, #neePublish_A_ButtonBasic": "C" == $.dmpub.screen && (g = "#neePublish_A_ButtonPremium, #neePublish_A_ButtonMonthly, #neePublish_C_BasicPubLink");
				$(g).unbind("click.clk").click(function() {
					$(".neeSelectedPlanBtn").removeClass("neeSelectedPlanBtn");
					$(this).addClass("neeSelectedPlanBtn");
					$.dmpub._withPaymentSuccess(a, e) && $(g).unbind("click.clk")
				})
			}
		},
		_initSignUpPopup: function(a, e, d, g) {
			$.dmfw.showSignUpLogin({
				initSignUp: !0,
				display: function(d) {
					$(".neePublishSignupForm input").placeholder();
					var e = $.dmpub._isGOMOLikeProduct(a.product) ? dmStr["ui.nee.publishPanel.203"] : dmStr["ui.nee.publishPanel.29"],
					g = d ? dmStr["ui.nee.publishPanel.204"] : dmStr["ui.nee.publishPanel.205"],
					e = d ? e: dmStr["ui.nee.publishPanel.206"],
					m = d ? dmStr["ui.nee.publishPanel.205"] : dmStr["ui.nee.publishPanel.204"];
					$(".neePublishSignupBoxTitle").text(g);
					$(".neePublishSwitchToLoginText").text(e);
					$(".neePublishSwitchToLogin").text(m);
					$("#forgotPwd").css("display", d ? "none": "inline-block");
					d ? $(".neePublishSignupForm #confirmPassword").show() : $(".neePublishSignupForm #confirmPassword").hide()
				},
				submitSelector: ".neePublishSignupBtn",
				pswdSelector: ".neePublishSignupForm .password",
				confirmPswdSelector: ".neePublishSignupForm #confirmPassword",
				emailSelector: ".neePublishSignupForm .email",
				msgSelector: ".neePublishSignupErrorMsg",
				switchSelector: ".neePublishSwitchToLogin",
				validate: g,
				success: function(g) {
					a.newuser = !1;
					d && d(a, e, g)
				}
			})
		},
		_initWithPaymentLayout: function(a, e) {
			if ($.dmx.treatAsPublishReseller()) $.dmpub._showSection(".neePublishResellers"),
			$.dmpub._showResellerPart(a);
			else {
				$.dmpub._hideResellerPart(a);
				$.dmpub._showSection(".neePublishWr");
				a.isIntuit && $(".neePublishWr").addClass("intuitPaymentStyle");
				var d = $.ptPayments.getContractToUse(),
				g = 0 === d.price % 1 ? d.price.toFixed(0) : d.price.toFixed(2),
				g = g.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","),
				j = 0 === d.yearlyPrice % 1 ? d.yearlyPrice.toFixed(0) : d.yearlyPrice.toFixed(2),
				j = j.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				$.dmfw.isPT() && d ? ($(".ptPublishPlanHeadPrice").html(d.currency + j + "\x3cspan\x3e/" + dmStr["ui.common.month1"] + "\x3c/span\x3e"), $("#ptPublishPlanHeadMonthlyPrice").html(d.currency + g), wrTrackEvent("pt_price_test", {
					price: d.price
				})) : (d = $(".neePublishHeadlinePlan_A_RightSubTitleCost").html() || "", $(".neePublishHeadlinePlan_A_RightSubTitleCost").html(d.replace("{price}", g)));
				$.dmpub._initPublishButtonArea(a, e);
				$.dmpub._showTitle($.dmpub._getSectionSelector($.dmpub.constants.TITLE, a));
				$.dmpub._hasFeatures(e) ? $("#dmwrPublishPremMsg").show() : $("#dmwrPublishPremMsg").hide();
				a.premium && ($(".neePublishPlansWrapper").hide(), $(".neePublishSignupTitle .neePublishTitleNum").hide());
				"A" != $.dmpub.screen && ("B" == $.dmpub.screen || "C" == $.dmpub.screen) && $(".neePublishPlansWrapper").show()
			}
		},
		_showResellerPart: function() {
			$(".neePublishResellers").show();
			var a = $.dmx.site.resellerPreviewUrl + "?dm_try_mode\x3dtrue";
			$("#neePublishResellersUrlSimulation").text(a).attr("href", a + "\x26ref\x3deditor");
			a = $.dmx.site.resellerPreviewUrl.replace("/site/", "/compare/");
			$("#neePublishResellersUrlCompare").text(a).attr("href", a)
		},
		initCopyButtonResellers: function() {
			$("#neePublishResellersUrlCopyUrl").zclip({
				path: "/editor/nee/utils/zclip/ZeroClipboard.swf",
				copy: function() {
					return $("#neePublishResellersUrlSimulation").text()
				},
				afterCopy: function() {
					$("#neePublishResellersUrlCopyUrl").addClass("selected")
				}
			});
			$("#neePublishResellersUrlCopyUrlCompare").zclip({
				path: "/editor/nee/utils/zclip/ZeroClipboard.swf",
				copy: function() {
					return $("#neePublishResellersUrlCompare").text()
				},
				afterCopy: function() {
					$("#neePublishResellersUrlCopyUrlCompare").addClass("selected")
				}
			})
		},
		_hideResellerPart: function() {
			$(".neePublishPremiumPlanRibbon").removeClass("resellersPlanRibbon");
			$(".neePublishResellersHeadline").hide();
			$(".neePublishPlansWrapper .neePublishTitleNum").text(dmStr["ui.num.1"]);
			$(".neePublishLoggedinTitle .neePublishTitleNum").text(dmStr["ui.num.2"])
		},
		_initPublishButtonArea: function(a, e) {
			var d = $.dmpub._getSectionSelector($.dmpub.constants.PUB_BTN_A, a);
			$.dmpub._showPublishButtonArea(d);
			dm_clear_plan_selection ? ($.dmpub._clearPlanSelection(), wrTrackEvent(WR_SITE_REVIEW_PUBLISH_NO_PLAN)) : wrTrackEvent(WR_SITE_REVIEW_PUBLISH_WITH_PLAN, {
				recipe: $.dmpub.statsMap[$.dmpub.screen]
			});
			"A" == $.dmpub.screen && $(".neePublishPlan").unbind("click").click(function() {
				if (!$(this).hasClass("neeSelectedPlan")) {
					var d = $.dmpub._noneSelected();
					$.dmpub._clearPlanSelection();
					$(this).addClass("neeSelectedPlan");
					$(this).find(".neePublishPlanBtn").addClass("neeSelectedPlanBtn");
					$(".neePublishNoPlanWasChosen").hide();
					$(this).find("label").text(dmStr["ui.nee.publishPanel.207"]);
					$(this).hasClass("neePublishPlansBasic") ? ($(".neePublishUpgradeBtn").addClass("neePublishRepublishBtn"), $.dmpub._hasFeatures(e) ? $(".basicPlanComment").css("visibility", "visible") : $(".basicPlanComment").css("visibility", "hidden"), a.published ? ($(".neePublishRollbackWrapper").show(), $.dmpub._initRollbackLinks(a)) : $(".neePublishRollbackWrapper").hide(), $.dmfw.setEmulatorFreeMode()) : ($(".neePublishRollbackWrapper").hide(), $(".neePublishUpgradeBtn").removeClass("neePublishRepublishBtn"), $(".basicPlanComment").css("visibility", "hidden"), d || $.dmfw.setEmulatorPremiumMode())
				}
			});
			dm_clear_plan_selection ? a.published ? ($(".neePublishRollbackWrapper").show(), $.dmpub._initRollbackLinks(a)) : $(".neePublishRollbackWrapper").hide() : $(".neePublishPremiumPlan").trigger("click")
		},
		_withPaymentSuccess: function(a, e, d) {
			if (a.premium) $.dmpub._publish(a);
			else {
				if ($.dmpub._noneSelected()) return "none" == $(".neePublishNoPlanWasChosen").css("display") && $(".neePublishNoPlanWasChosen").attr("style", "").stop().show("bounce", null, 200),
				!1;
				$.dmpub._premiumSelected() ? $.dmpub._publishPremium(a) : $.dmpub._hasFeatures(e) ? $.dmpub._publishFree(a, e, d) : $.dmpub._publish(a, d);
				return ! 0
			}
		},
		_publishFree: function(a, e, d) {
			e = $.map(e,
			function(a) {
				return a.name
			});
			$.dmUIBlockControlled({
				region: "publish.free",
				op: "block",
				style: "wheel",
				container: $("#neePublishContent")
			});
			$.dmsrv.deleteFeatures(e,
			function() {
				$.dmsrv.publishSite(function(e) {
					a.published ? wrTrackEvent(WR_SITE_REPUBLISHED, {
						plan: "free"
					}) : wrTrackEvent(WR_SITE_PUBLISHED, {
						plan: "free"
					});
					$.dmops.updateEditContext.site({
						success: function() {
							$.dmfw.refreshPreview();
							d ? d() : ($.dmpub._afterPublish(a, e), $.dmUIBlockControlled({
								region: "publish.free",
								op: "unblock",
								style: "wheel"
							}))
						}
					})
				})
			})
		},
		_publishPremium: function() {
			var a = {};
			$(".neeSelectedPlanBtn").data("contract") && (a.contract = $(".neeSelectedPlanBtn").data("contract"));
			"C" == $.dmpub.screen && (a.premiumType = $.dmpub._premiumMonthlySelected() ? "monthly": "yearly");
			a.token = "1stpublish";
			a.publish = !0;
			$.dmfw.openPayment(a)
		},
		_premiumMonthlySelected: function() {
			return $(".monthlyBtn").hasClass("neeSelectedPlanBtn")
		},
		_premiumSelected: function() {
			return $.dmx.treatAsPublishReseller() || $(".premiumBtn").hasClass("neeSelectedPlanBtn") || $(".neePublishPremiumPlan").hasClass("neeSelectedPlan")
		},
		_noneSelected: function() {
			return ! $.dmx.treatAsPublishReseller() && !$(".basicBtn").hasClass("neeSelectedPlanBtn") && !$(".premiumBtn").hasClass("neeSelectedPlanBtn") && !$(".neePublishPlan").hasClass("neeSelectedPlan")
		},
		_hasFeatures: function(a) {
			return a && 0 < a.length
		},
		_clearPlanSelection: function() {
			$(".neePublishPlanBtn").removeClass("neeSelectedPlanBtn");
			$(".neePublishPlan").removeClass("neeSelectedPlan");
			$(".neePublishPlanBtn").find("label").text(dmStr["ui.nee.publishPanel.208"])
		},
		_initNoPayment: function(a, e) {
			$.dmpub._initNoPaymentLayout(a);
			$.dmpub._initNoPaymentButtons(a, e);
			$.dmpub._show();
			a.reseller && $.dmpub.initCopyButtonResellers()
		},
		_initNoPaymentButtons: function(a, e) {
			var d = $.dmpub._getSectionSelector($.dmpub.constants.PUB_BTN, a);
			$(d).unbind("click").click(function() {
				$(d).unbind("click");
				e(a)
			});
			a.published && $.dmpub._initRollbackLinks(a)
		},
		_initRollbackLinks: function(a) {
			$("#dmwrRollback").neeConfirmationPopUpDiv(dmStr["ui.nee.publishPanel.209"], {
				liveClick: !0,
				initCallback: function() {
					$.dmpub._rollback(a)
				}
			});
			$("#dmwrUnpublish").neeConfirmationPopUpDiv(dmStr["ui.nee.publishPanel.210"], {
				liveClick: !0,
				forceWidth: "280px",
				initCallback: function() {
					$.dmpub._unpublish(a)
				}
			})
		},
		_initNoPaymentLayout: function(a) {
			$.dmpub._isGOMOLikeProduct(a.product) ? $.dmpub._showSection(".neeRepublishGomo") : a.reseller ? ($(".neePublishResellersPlan").hide(), $(".neeRepublishWr").css("padding", "20px").show(), $(".neePublishTitleResellers").addClass("adjustToResellerInvoiceStyle"), $.dmpub._showResellerPart()) : ($.dmpub._showSection(".neeRepublishWr"), commonProps["common.adroll.active"] && (adroll_segments = "new_site_published", trackExternalLink(adroll_segments)), commonProps["common.googleremarketing.active"] && $(document).append('\x3cdiv style\x3d"display:inline;"\x3e\x3cimg height\x3d"1" width\x3d"1" style\x3d"border-style:none;" alt\x3d"" src\x3d"//googleads.g.doubleclick.net/pagead/viewthroughconversion/1049765051/?value\x3d0\x26amp;label\x3dKOWOCPXdxAMQu8nI9AM\x26amp;guid\x3dON\x26amp;script\x3d0"/\x3e\x3c/div\x3e'));
			var e = $.dmpub.constants;
			$.dmpub._showPublishButton($.dmpub._getSectionSelector(e.PUB_BTN, a));
			$.dmpub._showTitle($.dmpub._getSectionSelector(e.TITLE, a));
			a.published ? ($(".neeRepublishPart").show(), $(".japaneseRepublishTitle").hide(), $(".neeRepublishSiteUrl").text($.dmpub.getPublishedSiteUrl(a)), $.dmpub._showRedirect(a), a.published && !a.justPublished ? $(".neePublishRollbackWrapper").show() : $(".neePublishRollbackWrapper").hide(), $.dmpub._initShareButtons(a)) : ($(".neeRepublishPart").hide(), $(".japaneseRepublishTitle").show())
		},
		_initShareButtons: function(a) {
			$(".dmwrFBShare").unbind("click").click(function() {
				FB.ui({
					method: "stream.publish",
					message: dmStr["ui.nee.publishPanel.211"],
					caption: $.dmpub.getPublishedSiteUrl(a),
					name: dmStr["ui.nee.publishPanel.212"],
					link: $.dmx.site.mobileUrl,
					display: "popup"
				})
			});
			$(".dmwrGPShare").unbind("click").click(function() {
				window.open("http://plus.google.com/share?url\x3d" + escape($.dmpub.getPublishedSiteUrl(a)))
			});
			$(".dmwrTShare").unbind("click").click(function() {
				window.open("http://twitter.com/intent/tweet?url\x3d" + escape($.dmpub.getPublishedSiteUrl(a)) + "\x26text\x3d" + dmStr["ui.nee.publishPanel.213"] + "  \x26via\x3d" + dmStr["config.twitter"])
			});
			$(".neePublishSharePanel g:plusone").attr("href", escape($.dmpub.getPublishedSiteUrl(a)));
			$(".dmwrQRShare").dmQrCodePopup({
				url: $.dmpub.getPublishedSiteUrl(a)
			});
			$(".dmwrMailShare").shareByEmailPopup({
				mailType: "SHARE_SITE",
				siteAddress: $.dmpub.getPublishedSiteUrl(a),
				addTryModeParam: !1
			})
		},
		_showRedirect: function(a) {
			a.isIntuit && a.redirected ? ($.dmx.site.domain ? $(".neeRepublishSiteUrl").text($.dmx.site.domain) : $(".neeRepublishSiteUrl").text($.dmx.site.mobileUrl), $(".neePublishSiteBaseUrl").text($.dmx.site.baseUrl), $(".neeEditOpt").show(), $("#intuitPublishSetMdotCheckbox").unbind("change").change(function() {
				$("#intuitPublishSetMdotCheckbox").is(":checked") ? $(".neeTwoNumberedPans").show() : $(".neeTwoNumberedPans").hide();
				$.dmredi._readProviders();
				var a = $.dmx.site.suggestedDomain;
				if ( - 1 != $.dmx.site.baseUrl.indexOf("homestead") || -1 != $.dmx.site.baseUrl.indexOf("intuitwebsites")) a = "";
				null != $.dmx.site.domain && (a = $.dmx.site.domain);
				$("#intuitNewCname").val(a).unbind("keyup").keyup(function() {
					$(".dmRediDomainMsg").text(" ")
				})
			}), $("#intuitNewCnameApplyBtn").unbind("click").click(function() {
				var e = $("#intuitNewCname").val();
				_showAssignDomainMsgIntuit = function(a, d) {
					$(".dmRediDomainMsgIntuit").text(a);
					d && $(".dmRediDomainMsgIntuit").css("color", "red");
					setTimeout(function() {
						$(".dmRediDomainMsgIntuit").text("");
						$(".dmRediDomainMsgIntuit").css("color", "")
					},
					2E3)
				};
				var d = null;
				e ? e.length > DM_SRV_CONST.DOMAIN_LEN && (d = dmStr["ui.nee.redirectPanel.102"] + " " + DM_SRV_CONST.DOMAIN_LEN + " " + dmStr["ui.nee.redirectPanel.103"]) : d = dmStr["ui.nee.redirectPanel.101"];
				d ? (_showAssignDomainMsgIntuit(d, !0), $("#intuitNewCname").focus()) : $.dmsrv.assignSiteDomain(e,
				function() {
					$(".neeRepublishSiteUrl").text(e);
					$(".neeEditOpt").hide()
				},
				function() {
					$.dmx.site.domain = null;
					a.redirected = !1;
					$.dmpub._showRedirect(a)
				})
			}), $(".neeRepublishRedirectSetupBox").hide(), a.justPublished ? $("#neeRepublishRedirectSetupTextHourWait").show() : $("#neeRepublishRedirectSetupTextHourWait").hide(), $(".neeConfirmRedirectSetupTitleDuplicate").hide(), $(".neeConfirmRedirectSetupTitleDefault").hide(), $(".neeRepublishRedirectSetupBoxIntuit").show()) : a.isIntuit && !a.redirected || a.isIntuit && a.intuitErrorDuplicate ? ($(".neePublishSiteBaseUrl").text($.dmx.site.baseUrl.split("//")[1]), $(".neeRepublishRedirectSetupBox").hide(), a.justPublished ? ($(".neeConfirmRedirectSetupTitleDefault").hide(), a.intuitErrorDuplicate ? ($(".neeConfirmRedirectSetupTitle").hide(), $(".neeConfirmRedirectSetupTitleDuplicate").show()) : ($(".neeConfirmRedirectSetupTitleDuplicate").hide(), $(".neeConfirmRedirectSetupTitle").show())) : $(".neeConfirmRedirectSetupTitleDefault").show(), $(".neeRepublishRedirectSetupBoxIntuitNoRedirection").show()) : a.published && !a.redirected ? ($(".neePublishSiteBaseUrl").text($.dmx.site.baseUrl.split("//")[1]), $.dmx.site.isFromScratch ? ($(".neeRepublishRedirectSetupBox").hide(), $(".neeRepublishRedirectSetupBoxBFS").show(), $.dmpub._initConnectRedirectBoxes(a)) : $(".neeRepublishRedirectSetupBox").show(), $(".neeRedirectSetupBtn").unbind("click").click(function() {
				$.dmfw.isPT() || NEFW.navigateToTabWithHistory("navredirect")
			})) : $(".neeRepublishRedirectSetupBox").hide()
		},
		_publish: function(a, e) {
			$.dmsrv.publishSite(function(d) {
				wrTrackEvent(a.published ? WR_SITE_REPUBLISHED: WR_SITE_PUBLISHED, {
					plan: a.premium ? "premium": "free"
				});
				e ? e() : $.dmpub._afterPublish(a, d)
			},
			function(d) {
				if ("PaymentFailed" === d.error_code && isWLSubUser) return $("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(dmStr["ui.nee.publish.error.1"] + "\x3cbr/\x3e" + dmStr["ui.nee.publish.error.2"], {
					initCallback: function() {},
					onNoCallback: function() {},
					triggerNow: !0,
					forceWidth: "345px",
					yesText: dmStr["ui.ok.u"],
					bindCloseToNo: !0,
					yesStyle: "width:160px",
					noStyle: "display:none"
				}),
				$.dmpub._handleState(a),
				!0
			})
		},
		_rollback: function(a) {
			$.dmUIBlockControlled({
				region: "publish.rollback",
				op: "block",
				style: "wheel",
				container: $("#neePublishContent")
			});
			$.dmsrv.rollbackSite(function() {
				$.dmops.updateEditContext.all({
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.dmpub._handleState(a);
							$.dmUIBlockControlled({
								region: "publish.rollback",
								op: "unblock",
								style: "wheel"
							})
						})
					}
				})
			})
		},
		_unpublish: function(a) {
			a.isIntuit && $.dmpub._handleIntuitRedirect(a, !0);
			$.dmsrv.unpublishSite(function() {
				a.published = !1;
				$.dmfw.resetEmulatorPremiumMode();
				$.dmpub._handleState(a)
			})
		},
		_handleIntuitRedirect: function(a, e, d) {
			$.dmBlockUI($("#neePublishContent"));
			$.dmLoading($("#neePublishContent"));
			e ? ($.dmx.site.customerID = null, a.redirected = !1, $.dmx.site.isRedirected = !1, a.published = !1, $.dmx.site.isPublished = !1) : (d && "OK" == d.status && (a.redirected = !0, $.dmx.site.isRedirected = !0), a.published = !0, $.dmx.site.isPublished = !0, d.messages && -1 != d.messages.indexOf(dmStr["ui.nee.publishPanel.214"]) && (a.intuitErrorDuplicate = !0));
			$.dmUnblockUI()
		},
		_afterPublish: function(a, e) {
			a.isIntuit && $.dmpub._handleIntuitRedirect(a, !1, e);
			a.published || (a.published = !0);
			a.justPublished = !0;
			$.dmpub._handleState(a)
		},
		_showConfirmationScreen: function(a) {
			$.dmpub._initNoPaymentLayout(a);
			$.dmpub._show()
		},
		_showConfirmationScreenBFS: function(a) {
			$.dmpub._showConfirmationScreen(a);
			$.dmredi.parameters.isBfsConnect.nextTimeUseBfsConnectScreen = !1;
			$(".neeRepublishWr .neeConfirmRePublishTitle.neePublishTitle").text("Congratulations, you now have a mobile website.");
			$(".ptConfirmSubTitle").show();
			$(".ptConfirmPublishSubTitle").hide();
			$(".neeRepublishRedirectSetupBox").hide();
			$(".neeRepublishRedirectSetupBoxBFS").show();
			$.dmpub._initConnectRedirectBoxes(a)
		},
		_initConnectRedirectBoxes: function() {
			$(".neeRepublishRedirectSetupBoxBFSboxesRedirectButton").off("click.redirect").on("click.redirect",
			function() {
				$(".neeRedirectSetupBtn").trigger("click")
			});
			$(".neeRepublishRedirectSetupBoxBFSboxesConnectButton").off("click.redirect").on("click.redirect",
			function() {
				$.dmredi.parameters.nextTimeUseBfsConnectScreen = !0;
				$(".neeRedirectSetupBtn").trigger("click")
			})
		},
		_showSection: function(a) {
			$(".neePublishSection").hide();
			a && $(a).show()
		},
		_showPublishButton: function(a) {
			$(".neePublishButtons").hide();
			a && $(a).show()
		},
		_showTitle: function(a) {
			$(".neePublishTitle").hide();
			a && $(a).show()
		},
		_initRedirectButton: function(a) {
			if ($.dmfw.isPT()) {
				var e = {};
				a && a.isIntuit && (e.forceDisabled = !0);
				$.ptAccordContr.setRedirectTabState(e)
			} else a = $("#_publish .publishNextBtn"),
			a.unbind("click"),
			$.dmx.site && $.dmx.site.isPublished ? (a.click(function() {
				NEFW.navigateToTabWithHistory(NAV_REDIRECT_ID)
			}), a.removeClass("grayBtn").removeClass("neeBtnDisabled"), a.addClass("blueBtn")) : a.addClass("grayBtn").addClass("neeBtnDisabled")
		},
		_showPublishButtonArea: function(a) {
			$(".neePublishButtonArea").hide();
			a && $(a).show()
		},
		_clear: function() {
			$.dmpub._showPublishButton(!1);
			$.dmpub._showTitle(!1);
			$.dmpub._showSection(!1)
		},
		_hide: function() {
			$("#neePublishContent").addClass("dmVisibilityHidden");
			$.dmUIBlockControlled({
				region: "publish.screeen",
				op: "block",
				style: "wheel",
				container: $("#neePublishContent")
			})
		},
		_show: function() {
			$("#neePublishContent").removeClass("dmVisibilityHidden");
			$.dmUIBlockControlled({
				region: "publish.screeen",
				op: "unblock",
				style: "wheel"
			});
			$.dmUnblockUI()
		},
		getPublishedSiteUrl: function(a) {
			var e = $.dmx.site.mobileUrl;
			"HGGIBO" == a.product && $.dmx.site.domain && (a = $.dmx.site.domain, 0 != a.indexOf("http://") && 0 != a.indexOf("https://") && (a = "http://" + a), e = a);
			return e
		},
		_isGOMOLikeProduct: function(a) {
			return "GOMO" == a || "OPENTABLE" == a || "HGGIBO" == a || "CHASE" == a
		},
		_getSiteState: function(a, e) {
			$.dmops.updateEditContext.site({
				withRedirect: !0,
				success: function() {
					var a = {};
					a.published = $.dmx.site.isPublished;
					a.republished = $.dmx.site.isRepublished;
					a.premium = $.dmx.isPremium();
					a.newuser = dm_not_saved;
					a.redirected = $.dmx.site.isRedirected;
					a.reseller = $.dmx.treatAsPublishReseller();
					a.justPublished = $.dmx.firstPublished;
					a.product = $.dmpub._getStateProduct();
					a.isIntuit = $.dmfw.isIntuit();
					a.requiresPayment = !1;
					a.premium && "API" == $.dmx.site.opOrigin ? $.dmsrv.isPaymentNeeded().done(function(g) {
						a.requiresPayment = g;
						e(a)
					}) : e(a)
				}
			})
		},
		_getStateProduct: function() {
			var a = $.dmx.site.dmProductType;
			return "SPOTZER" == a || "DM_DIRECT" == a ? $.dmpub.constants.DFLT_PROD: a
		},
		_getSectionSelector: function(a, e) {
			return $.dmpub._getSectionSelectorForFlow(a, e, $.dmpub.constants.DFLT_PROD)
		},
		_getSectionSelectorForFlow: function(a, e, d) {
			var g = $.dmpub.constants,
			j = g.NOTPUB,
			j = e.justPublished ? e.republished ? g.REPUB: g.FIRSTPUB: e.published ? g.PUB: g.NOTPUB;
			return $.dmpub._sectionSelectors[d][e.newuser ? g.NU: g.LI][e.premium || e.noFeatures && e.published ? g.NOPAY: g.PAY][j][a]
		},
		_initSectionSelectors: function() {
			function a(a, e) {
				var k = d;
				$.each(a,
				function(d, m) {
					k[m] || (k[m] = d == a.length - 1 ? e: {});
					k = k[m]
				})
			}
			var e = $.dmpub.constants,
			d = {};
			"A" == $.dmpub.screen ? (a([e.DFLT_PROD, e.NU, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper"), a([e.DFLT_PROD, e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishLoggedinWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.PUB, e.PUB_BTN_A], ".neePublishRepublishWrapper"), a([e.DFLT_PROD, e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN], ".neeGoLiveBtn"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN], ".neePublishLoggedinBtn")) : "B" == $.dmpub.screen ? (a([e.DFLT_PROD, e.NU, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishPlansWrapper"), a([e.DFLT_PROD, e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishPlansWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.PUB, e.PUB_BTN_A], ""), a([e.DFLT_PROD, e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN], ".neePublish_A_ButtonPremium, .neeGoLiveBtn"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN], "#neePublish_A_Button")) : "C" == $.dmpub.screen && (a([e.DFLT_PROD, e.NU, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishPlansWrapper"), a([e.DFLT_PROD, e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishPlansWrapper"), a([e.DFLT_PROD, e.LI, e.PAY, e.PUB, e.PUB_BTN_A], ""), a([e.DFLT_PROD, e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN], ".neePublish_A_ButtonPremium, .neeGoLiveBtn"), a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.PUB_BTN], "#neePublish_A_Button"));
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.PUB, e.PUB_BTN], ".neeRepublishBtn");
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.REPUB, e.PUB_BTN], null);
			a([e.DFLT_PROD, e.LI, e.PAY, e.PUB, e.PUB_BTN], ".neePublishUpgradeBtn");
			a([e.DFLT_PROD, e.LI, e.PAY, e.FIRSTPUB, e.PUB_BTN], null);
			a([e.DFLT_PROD, e.LI, e.PAY, e.REPUB, e.PUB_BTN], null);
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.PUB, e.TITLE], ".neeRepublishTitle");
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.FIRSTPUB, e.TITLE], ".neeConfirmPublishTitle");
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.NOTPUB, e.TITLE], ".neeGoLiveTitle");
			a([e.DFLT_PROD, e.LI, e.PAY, e.FIRSTPUB, e.TITLE], ".neeConfirmPublishTitle");
			a([e.DFLT_PROD, e.LI, e.NOPAY, e.REPUB, e.TITLE], ".neeConfirmRePublishTitle");
			a([e.DFLT_PROD, e.LI, e.PAY, e.REPUB, e.TITLE], ".neeConfirmRePublishTitle");
			a([e.DFLT_PROD, e.LI, e.PAY, e.PUB, e.TITLE], ".neePublishTitleRepublish");
			a([e.DFLT_PROD, e.LI, e.PAY, e.NOTPUB, e.TITLE], ".neePublishTitlePublish");
			a([e.DFLT_PROD, e.NU, e.PAY, e.NOTPUB, e.TITLE], ".neePublishTitlePublish");
			a([e.DFLT_PROD, e.NU, e.NOPAY, e.NOTPUB, e.TITLE], ".neePublishTitlePublish");
			a(["GOMO", e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper");
			a(["GOMO", e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neeGomoPublishLoggedinWrapper");
			a(["GOMO", e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN], ".neeGomoPublishBtn");
			a(["OPENTABLE", e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper");
			a(["OPENTABLE", e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neeGomoPublishLoggedinWrapper");
			a(["OPENTABLE", e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN], ".neeGomoPublishBtn");
			a(["HGGIBO", e.NU, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neePublishSignupWrapper");
			a(["HGGIBO", e.LI, e.NOPAY, e.NOTPUB, e.PUB_BTN_A], ".neeGomoPublishLoggedinWrapper");
			a(["HGGIBO", e.LI, e.NOPAY, e.PUB, e.PUB_BTN], ".hggiboRepublishBtn");
			$.dmpub._sectionSelectors = d
		},
		constants: {
			DFLT_PROD: "DFLT_PROD",
			NU: "NEW_USER",
			LI: "LOGGED_IN",
			PAY: "WITH_PAY",
			NOPAY: "NO_PAY",
			PUB: "PUBLISHED",
			NOTPUB: "NOT_PUBLISHED",
			FIRSTPUB: "FIRST_PUB",
			REPUB: "REPUBLISHED",
			TITLE: "TITLE",
			PUB_BTN: "PUBLISH_BTN",
			PUB_BTN_A: "PUBLISH_BTN_AREA"
		},
		gomo: {
			_handleGOMOState: function(a) {
				a.justPublished ? ($.dmpub._showConfirmationScreen(a), $.dmx.firstPublished = null) : a.published ? $.dmpub._initNoPayment(a, $.dmpub.gomo._publishGOMO) : ($(".neePublishRollbackWrapper").hide(), $.dmpub.gomo._initNotPublished(a))
			},
			_initNotPublished: function(a) {
				$.dmpub._showSection(".neePublishWr");
				$(".gomoPublishPremiumWrapper").show();
				$.dmpub._showPublishButtonArea($.dmpub._getSectionSelectorForFlow($.dmpub.constants.PUB_BTN_A, a, "GOMO"));
				$.dmpub._showTitle($.dmpub._getSectionSelectorForFlow($.dmpub.constants.TITLE, a, "GOMO"));
				if (a.newuser) $.dmpub._initSignUpPopup(a, null, $.dmpub.gomo._publishGOMO);
				else {
					$.dmpub._showPublishButtonArea($.dmpub._getSectionSelectorForFlow($.dmpub.constants.PUB_BTN_A, a, "GOMO"));
					var e = $.dmpub._getSectionSelectorForFlow($.dmpub.constants.PUB_BTN, a, "GOMO");
					$(e).unbind("click").click(function() {
						$.dmpub.gomo._publishGOMO(a)
					})
				}
				$.dmpub._show()
			},
			_publishGOMO: function(a, e, d) {
				$.dmsrv.publishSite(function(e) {
					a.published || wrTrackEvent(WR_SITE_GOMO_PUBLISHED);
					d ? d() : $.dmpub._afterPublish(a, e)
				})
			}
		}
	}
}); (function() {})(jQuery);
var DM_REDIRECT_SCRIPT = '\x3cscript src\x3d"http://static.|%PROD_DOMAIN%|/%%CUSTOM_SCRIPT%%.js" type\x3d"text/javascript"\x3e\x3c/script\x3e\n\x3cscript type\x3d"text/javascript"\x3e%%FUNCTION_NAME%%("|%MOBILE_URL%|");\x3c/script\x3e',
REDI_URL_PH = "|%MOBILE_URL%|",
PROD_DOMAIN = "|%PROD_DOMAIN%|",
CUSTOM_SCRIPT = "%%CUSTOM_SCRIPT%%",
FUNCTION_NAME = "%%FUNCTION_NAME%%";$.extend({
	dmredi: {
		parameters: {
			nextTimeUseBfsConnectScreen: !1,
			isBfsConnect: !1,
			isForceMDOT: !1
		},
		init: function(a) {
			$.dmredi.parameters.isForceMDOT = 0 < $(".mdotOnly").length;
			$("#_redirect input").placeholder();
			$.dmredi._readProviders();
			$.dmredi._getSiteState(a, $.dmredi._handleState);
			a = $.dmx.site.isFromScratch ? dmStr["ui.nee.publish.siteURLFiller"] : $.dmx.site.baseUrl.split("//")[1];
			$(".rediBaseUrl").text(a);
			$.dmredi._initEmailToDev();
			$.dmredi._initSendCodeBtn();
			$.dmredi._initWordpressScreen();
			$.dmredi.parameters.isBfsConnect && 3 == $.dmx.site.planId && $(".neeRedirectSetupUrlBoxBFS .bfsDisabledContent").removeClass("bfsDisabledContent");
			$.dmredi.parameters.nextTimeUseBfsConnectScreen = !1;
			wrTrackEvent(WR_SITE_VIEW_REDIRECT)
		},
		_initWordpressScreen: function() {
			if (commonProps["platform.wordpress.activateWordpressPlugin"] && $.dmx.site.compatible_platforms && -1 != $.dmx.site.compatible_platforms.indexOf("WORDPRESS") && !isReseller && !isWLSubUser) {
				$(".neeRedirectBoxTitleAndExplanationWrapper").hide();
				$(".neeRedirectBoxHostingAndCodeWrapper").hide();
				$(".neeRedirectBoxTitleAndExplanationWrapperWordpress").show();
				var a = $.dmx.site.baseUrl;
				"/" != a.charAt(a.length - 1) && (a += "/");
				"wordpressplugin" == $.dmx.site.dmReferral ? ($(".wordpressNoUtm").hide(), $(".wordpressWithUtm").show(), $("#wordpressRedirectLinkUtmSource").unbind("click").click(function() {
					$(this).attr("href", a + commonProps["platform.wordpress.redirectLinkUtmSource"])
				})) : ($(".wordpressWithUtm").hide(), $(".wordpressNoUtm").show(), $("#wordpressRedirectLink").unbind("click").click(function() {
					$(this).attr("href", a + commonProps["platform.wordpress.redirectLink"])
				}), $("#wordpressRedirectLinkWP").unbind("click").click(function() {
					$(this).attr("href", commonProps["platform.wordpress.redirectLinkWP"])
				}))
			}
		},
		_handleState: function(a) {
			$.dmredi._initDomainBox(a);
			$.dmredi._initScriptArea()
		},
		_initDomainBox: function(a) {
			var e = function() {
				$(".neeRedirectSetupUrlTitle input").is(":checked") ? ($(".neeRedirectSetupUrlBox").show("fast",
				function() {
					$.dmredi.parameters.isForceMDOT || $(".neeRedirectSetupUrlBox").scrollTo()
				}), $.dmredi._initCustomDomain(a)) : ($(".neeRedirectSetupUrlBox").hide("fast"), $.dmredi._assignDomain(""))
			}; ! 0 === $.dmredi.parameters.isBfsConnect ? $.dmredi._initCustomDomain(a) : ($(".neeRedirectSetupUrlTitle input").change(function() {
				e()
			}), $(".neeRedirectSetupUrlTitle input").prop("checked", $.dmredi.parameters.isForceMDOT || a.premium && a.domain), e())
		},
		_initCustomDomain: function(a) {
			$.dmredi.parameters.isForceMDOT || a.premium ? ($("#dmRediDomainButton").text(dmStr["ui.go"]), a = $.dmx.site.domain ? $.dmx.site.domain: $.dmx.site.suggestedDomain, $.dmx.site.isFromScratch && $.dmredi.parameters.isBfsConnect && (a = $.dmx.site.domain ? $.dmx.site.domain: "www.mysite.com"), $(".rediUpgradeNote").removeAttr("readonly").val(a), $("#dmRediDomainButton").unbind("click").click(function() {
				var a = $(".rediUpgradeNote").val(),
				d = null;
				a ? a.length > DM_SRV_CONST.DOMAIN_LEN && (d = dmStr["ui.nee.redirectPanel.102"] + " " + DM_SRV_CONST.DOMAIN_LEN + " " + dmStr["ui.nee.redirectPanel.103"]) : d = dmStr["ui.nee.redirectPanel.101"];
				d ? ($.dmredi._showAssignDomainMsg(d, !0), $(".rediUpgradeNote").focus()) : $.dmredi._assignDomain(a,
				function() {
					var a = dmStr["ui.nee.redirectPanel.104"];
					$.dmredi.parameters.isBfsConnect && (a = dmStr["ui.nee.redirectPanel.200"]);
					$.dmredi._showAssignDomainMsg(a);
					$.dmredi.parameters.isBfsConnect ? $(".bfsDisabledContent").removeClass("bfsDisabledContent") : setTimeout(function() {
						$(".dmRediDomainMsg").text("")
					},
					2E3)
				})
			})) : ($.dmredi._assignDomain(""), $("#dmRediDomainButton").unbind("click").click(function() {
				$.dmredi._assignDomain($.dmx.site.suggestedDomain);
				$.dmfw.openUpgradePopup({
					token: $.dmredi.parameters.isBfsConnect ? "connect": "redirect"
				})
			}))
		},
		_showAssignDomainMsg: function(a, e) {
			$(".dmRediDomainMsg").text(a);
			e && $(".dmRediDomainMsg").css("color", "red");
			$.dmredi.parameters.isBfsConnect || setTimeout(function() {
				$(".dmRediDomainMsg").text("");
				$(".dmRediDomainMsg").css("color", "")
			},
			2E3)
		},
		_initScriptArea: function() {
			var a = $.dmredi._getScriptUrl(),
			e = $.dmui.getResource("customScript") || "DM_redirect",
			d = $.dmui.getResource("redirectFunctionName") || "DM_redirect";
			isWLReseller && (e = $.dmui.getResource("customScript", {
				product: "RESELLER"
			}), d = $.dmui.getResource("redirectFunctionName", {
				product: "RESELLER"
			}));
			a = escape(DM_REDIRECT_SCRIPT.replace(REDI_URL_PH, a).replace(PROD_DOMAIN, $.dmredi._getDomain()).replace(CUSTOM_SCRIPT, e).replace(CUSTOM_SCRIPT, e).replace(FUNCTION_NAME, d).replace(FUNCTION_NAME, d));
			$(".redirectUsersPaneCode").text(unescape(a));
			$.dmredi.initCopyButton()
		},
		_getScriptUrl: function() {
			return $.dmx.site.domain ? "http://" + $.dmx.site.domain: $.dmx.site.mobileUrl
		},
		_getDomain: function() {
			var a = isWLSubUser || $.dmui.getResource("requiresWhiteLabelUrl", {
				product: $.dmx.site.dmProductType
			});
			return isReseller || a ? commonProps["common.jsRedirectDomain"] || "mobilewebsiteserver.com": "dudamobile.com"
		},
		initCopyButton: function() {
			$("#dmRediCopyButton").zclip({
				path: "/editor/nee/utils/zclip/ZeroClipboard.swf",
				copy: function() {
					return $(".redirectUsersPaneCode").val()
				},
				afterCopy: function() {
					$(".redirectUsersPaneCode").select()
				}
			})
		},
		_initSendCodeBtn: function() {
			$(".neeRedirectSendCode").unbind("click").click(function() {
				$.dmsrv.sendMail("", "DEVELOPER", "", null, !1,
				function() {
					$(".neeRedirectCodeBtns .redirectSendEmailBtnMsg").css("visibility", "visible");
					setTimeout("$('.neeRedirectCodeBtns .redirectSendEmailBtnMsg').css('visibility','hidden');", 2E3)
				})
			})
		},
		_getSiteState: function(a, e) {
			var d = {};
			d.domain = $.dmx.site.domain;
			d.premium = $.dmx.isPremium();
			e(d)
		},
		_assignDomain: function(a, e) {
			$.dmUIBlockControlled({
				region: "redirect.assignDomain",
				op: "block",
				style: "wheel"
			});
			$.dmsrv.assignSiteDomain(a,
			function() {
				$.dmredi._initScriptArea();
				e && e();
				$.dmUIBlockControlled({
					region: "redirect.assignDomain",
					op: "unblock",
					style: "wheel"
				})
			},
			function(a) {
				if (a && "InvalidInput" == a.error_code) return $.dmfw.showQTip({
					type: "error",
					selector: ".neeRedirectSetupUrlItem input",
					text: a.message,
					position: {
						at: "bottom center",
						my: "top center"
					},
					dontHide: !1,
					hide: {
						event: "click unfocus",
						fixed: !0,
						effect: function() {
							$(this).fadeOut("slow")
						}
					}
				}),
				!0
			})
		},
		_closeDomainConfig: function() {
			$(".rediOptOpened").hide().animate()
		},
		_openDomainConfig: function() {
			$(".rediOptOpened").show().animate()
		},
		_initEmailToDev: function() {
			var a = $(".neeRedirectSendFriendWrapper"),
			a = {
				mailType: "DEVELOPER",
				siteAddress: null,
				msg: a.find(".redirectEmailSuccessMes"),
				input: a.find(".neeRedirectSendFriendInput input"),
				sendBtn: a.find(".neeRedirectSendEmailBtn")
			};
			$.dmops.sendSiteAddressMail(a)
		},
		_readProviders: function() {
			var a = $.dmx.site.dmProductType,
			e = !a || "DM_DIRECT" == a || "OPENTABLE" == a ? "redirect": a.toLowerCase() + "-redirect";
			$.ajax({
				url: dm_hosting_providers_url,
				type: "get",
				contentType: "application/json",
				success: function(a) {
					$.each(a.hostingProviders,
					function(a, d) {
						$(".rediHostProvSelect").append($('\x3coption value\x3d"' + d.token + '"\x3e' + d.name + "\x3c/option\x3e"))
					});
					$(".rediGo").unbind("click").click(function() {
						var a = dmStr["ui.config.redirect.lang"];
						a && "" != a ? window.open(dm_www_home + a + "/" + e + "/" + $(".rediHostProvSelect").val() + "?address\x3d" + escape($.dmredi._getScriptUrl())) : window.open(dm_www_home + e + "/" + $(".rediHostProvSelect").val() + "?address\x3d" + escape($.dmredi._getScriptUrl()))
					})
				}
			})
		}
	}
});window.CodeMirror = function() {
	function a(d, e) {
		if (! (this instanceof a)) return new a(d, e);
		this.options = e = e || {};
		for (var g in xc) ! e.hasOwnProperty(g) && xc.hasOwnProperty(g) && (e[g] = xc[g]);
		o(e);
		g = "string" == typeof e.value ? 0 : e.value.first;
		var k = {},
		m = k.input = aa("textarea", null, null, "position: absolute; padding: 0; width: 1px; height: 1em; outline: none;");
		eb ? m.style.width = "1000px": m.setAttribute("wrap", "off");
		m.setAttribute("autocorrect", "off");
		m.setAttribute("autocapitalize", "off");
		k.inputDiv = aa("div", [m], null, "overflow: hidden; position: relative; width: 3px; height: 0px;");
		k.scrollbarH = aa("div", [aa("div", null, null, "height: 1px")], "CodeMirror-hscrollbar");
		k.scrollbarV = aa("div", [aa("div", null, null, "width: 1px")], "CodeMirror-vscrollbar");
		k.scrollbarFiller = aa("div", null, "CodeMirror-scrollbar-filler");
		k.lineDiv = aa("div");
		k.selectionDiv = aa("div", null, null, "position: relative; z-index: 1");
		k.cursor = aa("div", "\u00a0", "CodeMirror-cursor");
		k.otherCursor = aa("div", "\u00a0", "CodeMirror-cursor CodeMirror-secondarycursor");
		k.measure = aa("div", null, "CodeMirror-measure");
		k.lineSpace = aa("div", [k.measure, k.selectionDiv, k.lineDiv, k.cursor, k.otherCursor], null, "position: relative; outline: none");
		k.mover = aa("div", [aa("div", [k.lineSpace], "CodeMirror-lines")], null, "position: relative");
		k.sizer = aa("div", [k.mover], "CodeMirror-sizer");
		k.heightForcer = aa("div", "\u00a0", null, "position: absolute; height: " + Nb + "px");
		k.gutters = aa("div", null, "CodeMirror-gutters");
		k.lineGutter = null;
		var n = aa("div", [k.sizer, k.heightForcer, k.gutters], null, "position: relative; min-height: 100%");
		k.scroller = aa("div", [n], "CodeMirror-scroll");
		k.scroller.setAttribute("tabIndex", "-1");
		k.wrapper = aa("div", [k.inputDiv, k.scrollbarH, k.scrollbarV, k.scrollbarFiller, k.scroller], "CodeMirror");
		xb && (k.gutters.style.zIndex = -1, k.scroller.style.paddingRight = 0);
		d.appendChild ? d.appendChild(k.wrapper) : d(k.wrapper);
		bc && (m.style.width = "0px");
		eb || (k.scroller.draggable = !0);
		yc ? (k.inputDiv.style.height = "1px", k.inputDiv.style.position = "absolute") : xb && (k.scrollbarH.style.minWidth = k.scrollbarV.style.minWidth = "18px");
		k.viewOffset = k.lastSizeC = 0;
		k.showingFrom = k.showingTo = g;
		k.lineNumWidth = k.lineNumInnerWidth = k.lineNumChars = null;
		k.prevInput = "";
		k.alignWidgets = !1;
		k.pollingFast = !1;
		k.poll = new zc;
		k.draggingText = !1;
		k.cachedCharWidth = k.cachedTextHeight = null;
		k.measureLineCache = [];
		k.measureLineCachePos = 0;
		k.inaccurateSelection = !1;
		k.maxLine = null;
		k.maxLineLength = 0;
		k.maxLineChanged = !1;
		k.wheelDX = k.wheelDY = k.wheelStartX = k.wheelStartY = null;
		g = this.display = k;
		g.wrapper.CodeMirror = this;
		l(this);
		e.autofocus && !Ac && S(this);
		this.state = {
			keyMaps: [],
			overlays: [],
			modeGen: 0,
			overwrite: !1,
			focused: !1,
			suppressEdits: !1,
			pasteIncoming: !1,
			draggingText: !1,
			highlight: new zc
		};
		j(this);
		e.lineWrapping && (this.display.wrapper.className += " CodeMirror-wrap");
		k = e.value;
		"string" == typeof k && (k = new Wa(e.value, e.mode));
		P(this, Zc)(this, k);
		Qa && setTimeout(Xa(L, this, !0), 20);
		var r = this,
		k = function() {
			r.state.focused && setTimeout(Xa(S, r), 0)
		},
		s = function() {
			u.cachedCharWidth = u.cachedTextHeight = null;
			O(r);
			H(r, Xa(fa, r))
		},
		v = function() {
			for (var a = u.wrapper.parentNode; a && a != document.body; a = a.parentNode);
			a ? setTimeout(v, 5E3) : fb(window, "resize", s)
		},
		m = function(a) { (!r.options.onDragEvent || !r.options.onDragEvent(r, Ob(a))) && cc(a)
		},
		n = function() {
			u.inaccurateSelection && (u.prevInput = "", u.inaccurateSelection = !1, u.input.value = r.getSelection(), $c(u.input))
		},
		u = r.display;
		na(u.scroller, "mousedown", P(r, Ga));
		na(u.scroller, "dblclick", P(r, Ha));
		na(u.lineSpace, "selectstart",
		function(a) {
			ba(u, a) || Ha(a)
		});
		Bc || na(u.scroller, "contextmenu",
		function(a) {
			Ma(r, a)
		});
		na(u.scroller, "scroll",
		function() {
			va(r, u.scroller.scrollTop);
			za(r, u.scroller.scrollLeft, !0);
			Ra(r, "scroll", r)
		});
		na(u.scrollbarV, "scroll",
		function() {
			va(r, u.scrollbarV.scrollTop)
		});
		na(u.scrollbarH, "scroll",
		function() {
			za(r, u.scrollbarH.scrollLeft)
		});
		na(u.scroller, "mousewheel",
		function(a) {
			kb(r, a)
		});
		na(u.scroller, "DOMMouseScroll",
		function(a) {
			kb(r, a)
		});
		na(u.scrollbarH, "mousedown", k);
		na(u.scrollbarV, "mousedown", k);
		na(u.wrapper, "scroll",
		function() {
			u.wrapper.scrollTop = u.wrapper.scrollLeft = 0
		});
		na(window, "resize", s);
		setTimeout(v, 5E3);
		na(u.input, "keyup", P(r,
		function(a) {
			if ((!r.options.onKeyEvent || !r.options.onKeyEvent(r, Ob(a))) && 16 == a.keyCode) r.doc.sel.shift = !1
		}));
		na(u.input, "input", Xa(ia, r));
		na(u.input, "keydown", P(r, pa));
		na(u.input, "keypress", P(r, wa));
		na(u.input, "focus", Xa(sa, r));
		na(u.input, "blur", Xa(qa, r));
		r.options.dragDrop && (na(u.scroller, "dragstart",
		function(a) {
			if (!ba(r.display, a)) {
				var d = r.getSelection();
				a.dataTransfer.setData("Text", d);
				a.dataTransfer.setDragImage && !Cc && (d = aa("img", null, null, "position: fixed; left: 0; top: 0;"), gb && (d.width = d.height = 1, r.display.wrapper.appendChild(d), d._top = d.offsetTop), a.dataTransfer.setDragImage(d, 0, 0), gb && d.parentNode.removeChild(d))
			}
		}), na(u.scroller, "dragenter", m), na(u.scroller, "dragover", m), na(u.scroller, "drop", P(r, T)));
		na(u.scroller, "paste",
		function(a) {
			ba(u, a) || (S(r), ia(r))
		});
		na(u.input, "paste",
		function() {
			r.state.pasteIncoming = !0;
			ia(r)
		});
		na(u.input, "cut", n);
		na(u.input, "copy", n);
		yc && na(u.sizer, "mouseup",
		function() {
			document.activeElement == u.input && u.input.blur();
			S(r)
		});
		var z;
		try {
			z = document.activeElement == g.input
		} catch(B) {}
		z || e.autofocus && !Ac ? setTimeout(Xa(sa, this), 20) : qa(this);
		P(this,
		function() {
			for (var a in yb) if (yb.propertyIsEnumerable(a)) yb[a](this, e[a], ad);
			for (a = 0; a < Dc.length; ++a) Dc[a](this)
		})()
	}
	function e(d) {
		d.doc.mode = a.getMode(d.options, d.doc.modeOption);
		d.doc.iter(function(a) {
			a.stateAfter && (a.stateAfter = null);
			a.styles && (a.styles = null)
		});
		d.doc.frontier = d.doc.first;
		G(d, 100);
		d.state.modeGen++;
		d.curOp && fa(d)
	}
	function d(a) {
		var d = ca(a.display),
		e = a.options.lineWrapping,
		g = e && Math.max(5, a.display.scroller.clientWidth / ha(a.display) - 3);
		return function(j) {
			return qb(a.doc, j) ? 0 : e ? (Math.ceil(j.text.length / g) || 1) * d: d
		}
	}
	function g(a) {
		var e = a.doc,
		g = d(a);
		e.iter(function(a) {
			var d = g(a);
			d != a.height && ab(a, d)
		})
	}
	function j(a) {
		a.display.wrapper.className = a.display.wrapper.className.replace(/\s*cm-s-\S+/g, "") + a.options.theme.replace(/(^|\s)\s*/g, " cm-s-");
		O(a)
	}
	function k(a) {
		l(a);
		fa(a)
	}
	function l(a) {
		var d = a.display.gutters,
		e = a.options.gutters;
		dc(d);
		for (var g = 0; g < e.length; ++g) {
			var j = e[g],
			k = d.appendChild(aa("div", null, "CodeMirror-gutter " + j));
			"CodeMirror-linenumbers" == j && (a.display.lineGutter = k, k.style.width = (a.display.lineNumWidth || 1) + "px")
		}
		d.style.display = g ? "": "none"
	}
	function m(a, d) {
		if (0 == d.height) return 0;
		for (var e = d.text.length,
		g, j = d; g = rb(j, -1);) g = g.find(),
		j = ga(a, g.from.line),
		e += g.from.ch - g.to.ch;
		for (j = d; g = Pb(j);) g = g.find(),
		e -= j.text.length - g.from.ch,
		j = ga(a, g.to.line),
		e += j.text.length - g.to.ch;
		return e
	}
	function n(a) {
		var d = a.display,
		e = a.doc;
		d.maxLine = ga(e, e.first);
		d.maxLineLength = m(e, d.maxLine);
		d.maxLineChanged = !0;
		e.iter(function(a) {
			var g = m(e, a);
			g > d.maxLineLength && (d.maxLineLength = g, d.maxLine = a)
		})
	}
	function o(a) {
		for (var d = !1,
		e = 0; e < a.gutters.length; ++e)"CodeMirror-linenumbers" == a.gutters[e] && (a.lineNumbers ? d = !0 : a.gutters.splice(e--, 1)); ! d && a.lineNumbers && a.gutters.push("CodeMirror-linenumbers")
	}
	function r(a, d) {
		var e = d + 2 * a.lineSpace.offsetTop;
		a.sizer.style.minHeight = a.heightForcer.style.top = e + "px";
		var e = Math.max(e, a.scroller.scrollHeight),
		g = a.scroller.scrollWidth > a.scroller.clientWidth,
		j = e > a.scroller.clientHeight;
		j ? (a.scrollbarV.style.display = "block", a.scrollbarV.style.bottom = g ? ec(a.measure) + "px": "0", a.scrollbarV.firstChild.style.height = e - a.scroller.clientHeight + a.scrollbarV.clientHeight + "px") : a.scrollbarV.style.display = "";
		g ? (a.scrollbarH.style.display = "block", a.scrollbarH.style.right = j ? ec(a.measure) + "px": "0", a.scrollbarH.firstChild.style.width = a.scroller.scrollWidth - a.scroller.clientWidth + a.scrollbarH.clientWidth + "px") : a.scrollbarH.style.display = "";
		g && j ? (a.scrollbarFiller.style.display = "block", a.scrollbarFiller.style.height = a.scrollbarFiller.style.width = ec(a.measure) + "px") : a.scrollbarFiller.style.display = "";
		Td && 0 === ec(a.measure) && (a.scrollbarV.style.minWidth = a.scrollbarH.style.minHeight = Ud ? "18px": "12px")
	}
	function u(a, d, e) {
		var g = a.scroller.scrollTop,
		j = a.wrapper.clientHeight;
		"number" == typeof e ? g = e: e && (g = e.top, j = e.bottom - e.top);
		g = Math.floor(g - a.lineSpace.offsetTop);
		a = Math.ceil(g + j);
		return {
			from: fc(d, g),
			to: fc(d, a)
		}
	}
	function s(a) {
		var d = a.display;
		if (d.alignWidgets || d.gutters.firstChild && a.options.fixedGutter) {
			for (var e = B(d) - d.scroller.scrollLeft + a.doc.scrollLeft, g = d.gutters.offsetWidth, j = e + "px", k = d.lineDiv.firstChild; k; k = k.nextSibling) if (k.alignable) for (var l = 0,
			m = k.alignable; l < m.length; ++l) m[l].style.left = j;
			a.options.fixedGutter && (d.gutters.style.left = e + g + "px")
		}
	}
	function B(a) {
		return Ea(a.scroller).left - Ea(a.sizer).left
	}
	function z(a, d, e) {
		var g = a.display.showingFrom,
		j = a.display.showingTo;
		if (d = v(a, d, e)) bb(a, "update", a),
		(a.display.showingFrom != g || a.display.showingTo != j) && bb(a, "viewportChange", a, a.display.showingFrom, a.display.showingTo);
		F(a);
		r(a.display, a.doc.height);
		return d
	}
	function v(a, d, e) {
		var g = a.display,
		j = a.doc;
		if (g.wrapper.clientWidth) {
			var k = u(g, j, e);
			if (! (0 == d.length && k.from > g.showingFrom && k.to < g.showingTo)) {
				var l;
				if (a.options.lineNumbers) {
					l = a.doc;
					l = String(a.options.lineNumberFormatter(l.first + l.size - 1 + a.options.firstLineNumber));
					var m = a.display;
					if (l.length != m.lineNumChars) {
						var n = m.measure.appendChild(aa("div", [aa("div", l)], "CodeMirror-linenumber CodeMirror-gutter-elt")),
						o = n.firstChild.offsetWidth,
						n = n.offsetWidth - o;
						m.lineGutter.style.width = "";
						m.lineNumInnerWidth = Math.max(o, m.lineGutter.offsetWidth - n);
						m.lineNumWidth = m.lineNumInnerWidth + n;
						m.lineNumChars = m.lineNumInnerWidth ? l.length: -1;
						m.lineGutter.style.width = m.lineNumWidth + "px";
						l = !0
					} else l = !1
				} else l = !1;
				l && (d = [{
					from: j.first,
					to: j.first + j.size
				}]);
				l = g.sizer.style.marginLeft = g.gutters.offsetWidth + "px";
				g.scrollbarH.style.left = a.options.fixedGutter ? l: "0";
				m = Infinity;
				if (a.options.lineNumbers) for (o = 0; o < d.length; ++o) if (d[o].diff) {
					m = d[o].from;
					break
				}
				o = j.first + j.size;
				l = Math.max(k.from - a.options.viewportMargin, j.first);
				k = Math.min(o, k.to + a.options.viewportMargin);
				g.showingFrom < l && 20 > l - g.showingFrom && (l = Math.max(j.first, g.showingFrom));
				g.showingTo > k && 20 > g.showingTo - k && (k = Math.min(o, g.showingTo));
				if (Qb) for (l = Sa(zb(j, ga(j, l))); k < o && qb(j, ga(j, k));)++k;
				n = [{
					from: Math.max(g.showingFrom, j.first),
					to: Math.min(g.showingTo, o)
				}];
				if (n[0].from >= n[0].to) n = [];
				else {
					for (var o = n,
					n = 0,
					r = d.length || 0; n < r; ++n) {
						for (var s = d[n], z = [], F = s.diff || 0, C = 0, I = o.length; C < I; ++C) {
							var Ba = o[C];
							s.to <= Ba.from && s.diff ? z.push({
								from: Ba.from + F,
								to: Ba.to + F
							}) : s.to <= Ba.from || s.from >= Ba.to ? z.push(Ba) : (s.from > Ba.from && z.push({
								from: Ba.from,
								to: s.from
							}), s.to < Ba.to && z.push({
								from: s.to + F,
								to: Ba.to + F
							}))
						}
						o = z
					}
					n = o
				}
				if (Qb) for (o = 0; o < n.length; ++o) for (d = n[o]; r = Pb(ga(j, d.to - 1));) if (r = r.find().from.line, r > d.from) d.to = r;
				else {
					n.splice(o--, 1);
					break
				}
				for (o = r = 0; o < n.length; ++o) d = n[o],
				d.from < l && (d.from = l),
				d.to > k && (d.to = k),
				d.from >= d.to ? n.splice(o--, 1) : r += d.to - d.from;
				if (r == k - l && l == g.showingFrom && k == g.showingTo) D(a);
				else {
					n.sort(function(a, d) {
						return a.from - d.from
					});
					d = document.activeElement;
					r < 0.7 * (k - l) && (g.lineDiv.style.display = "none");
					for (var o = l,
					r = k,
					H = n,
					J = m,
					Aa = function(d) {
						var e = d.nextSibling;
						eb && Ab && a.display.currentWheelTarget == d ? (d.style.display = "none", d.lineObj = null) : d.parentNode.removeChild(d);
						return e
					},
					va, m = a.display, n = {},
					s = {},
					z = m.gutters.firstChild, F = 0; z; z = z.nextSibling, ++F) n[a.options.gutters[F]] = z.offsetLeft,
					s[a.options.gutters[F]] = z.offsetWidth;
					va = {
						fixedPos: B(m),
						gutterTotalWidth: m.gutters.offsetWidth,
						gutterLeft: n,
						gutterWidth: s,
						wrapperWidth: m.wrapper.clientWidth
					};
					var m = a.display,
					L = a.options.lineNumbers; ! H.length && (!eb || !a.display.currentWheelTarget) && dc(m.lineDiv);
					var N = m.lineDiv,
					K = N.firstChild,
					U = H.shift(),
					O = o;
					for (a.doc.iter(o, r,
					function(d) {
						U && U.to == O && (U = H.shift());
						if (qb(a.doc, d)) {
							if (0 != d.height && ab(d, 0), d.widgets && K.previousSibling) for (var e = 0; e < d.widgets.length; ++e) if (d.widgets[e].showIfHidden) {
								var g = K.previousSibling;
								if (/pre/i.test(g.nodeName)) {
									var j = aa("div", null, null, "position: relative");
									g.parentNode.replaceChild(j, g);
									j.appendChild(g);
									g = j
								}
								j = g.appendChild(aa("div", [d.widgets[e].node], "CodeMirror-linewidget"));
								E(d.widgets[e], j, g, va)
							}
						} else if (U && U.from <= O && U.to > O) {
							for (; K.lineObj != d;) K = Aa(K);
							L && (J <= O && K.lineNumber) && bd(K.lineNumber, String(a.options.lineNumberFormatter(O + a.options.firstLineNumber)));
							K = K.nextSibling
						} else {
							if (d.widgets) for (var k = 0,
							l = K; l && 20 > k; ++k, l = l.nextSibling) if (l.lineObj == d && /div/i.test(l.nodeName)) {
								e = l;
								break
							}
							var m = O,
							l = e,
							k = cd(a, d),
							n = d.gutterMarkers,
							ac = a.display;
							if (!a.options.lineNumbers && !n && !d.bgClass && !d.wrapClass && !d.widgets) g = k;
							else {
								if (l) {
									l.alignable = null;
									for (var o = !0,
									r = 0,
									s = l.firstChild,
									Ca; s; s = Ca) if (Ca = s.nextSibling, /\bCodeMirror-linewidget\b/.test(s.className)) {
										for (var v = 0,
										mb = !0; v < d.widgets.length; ++v) {
											var u = d.widgets[v],
											Yc = !1;
											u.above || (Yc = mb, mb = !1);
											if (u.node == s.firstChild) {
												E(u, s, l, va); ++r;
												Yc && l.insertBefore(k, s);
												break
											}
										}
										if (v == d.widgets.length) {
											o = !1;
											break
										}
									} else l.removeChild(s);
									o && r == d.widgets.length && (g = l, l.className = d.wrapClass || "")
								}
								g || (g = aa("div", null, d.wrapClass, "position: relative"), g.appendChild(k));
								d.bgClass && g.insertBefore(aa("div", "\u00a0", d.bgClass + " CodeMirror-linebackground"), g.firstChild);
								if (a.options.lineNumbers || n) {
									j = g.insertBefore(aa("div", null, null, "position: absolute; left: " + (a.options.fixedGutter ? va.fixedPos: -va.gutterTotalWidth) + "px"), g.firstChild);
									a.options.fixedGutter && (g.alignable || (g.alignable = [])).push(j);
									if (a.options.lineNumbers && (!n || !n["CodeMirror-linenumbers"])) g.lineNumber = j.appendChild(aa("div", String(a.options.lineNumberFormatter(m + a.options.firstLineNumber)), "CodeMirror-linenumber CodeMirror-gutter-elt", "left: " + va.gutterLeft["CodeMirror-linenumbers"] + "px; width: " + ac.lineNumInnerWidth + "px"));
									if (n) for (v = 0; v < a.options.gutters.length; ++v) u = a.options.gutters[v],
									(m = n.hasOwnProperty(u) && n[u]) && j.appendChild(aa("div", [m], "CodeMirror-gutter-elt", "left: " + va.gutterLeft[u] + "px; width: " + va.gutterWidth[u] + "px"))
								}
								xb && (g.style.zIndex = 2);
								if (d.widgets && g != l) {
									v = 0;
									for (l = d.widgets; v < l.length; ++v) u = l[v],
									n = aa("div", [u.node], "CodeMirror-linewidget"),
									E(u, n, g, va),
									u.above ? g.insertBefore(n, a.options.lineNumbers && 0 != d.height ? j: k) : g.appendChild(n),
									bb(u, "redraw")
								}
							}
							if (g != e) N.insertBefore(g, K);
							else {
								for (; K != e;) K = Aa(K);
								K = K.nextSibling
							}
							g.lineObj = d
						}++O
					}); K;) K = Aa(K);
					g.lineDiv.style.display = "";
					document.activeElement != d && d.offsetHeight && d.focus();
					if (l != g.showingFrom || k != g.showingTo || g.lastSizeC != g.wrapper.clientHeight) g.lastSizeC = g.wrapper.clientHeight;
					g.showingFrom = l;
					g.showingTo = k;
					G(a, 100);
					l = g.lineDiv.offsetTop;
					for (m = g.lineDiv.firstChild; m; m = m.nextSibling) if (m.lineObj && (xb ? (o = m.offsetTop + m.offsetHeight, d = o - l, l = o) : (d = Ea(m), d = d.bottom - d.top), o = m.lineObj.height - d, 2 > d && (d = ca(g)), 0.0010 < o || -0.0010 > o)) if (ab(m.lineObj, d), d = m.lineObj.widgets) for (o = 0; o < d.length; ++o) d[o].height = d[o].node.offsetHeight;
					D(a);
					u(g, j, e).to > k && v(a, [], e);
					return ! 0
				}
			}
		} else g.showingFrom = g.showingTo = j.first,
		g.viewOffset = 0
	}
	function D(a) {
		var d = a.display.viewOffset = Bb(a, ga(a.doc, a.display.showingFrom));
		a.display.mover.style.top = d + "px"
	}
	function E(a, d, e, g) {
		a.noHScroll && ((e.alignable || (e.alignable = [])).push(d), e = g.wrapperWidth, d.style.left = g.fixedPos + "px", a.coverGutter || (e -= g.gutterTotalWidth, d.style.paddingLeft = g.gutterTotalWidth + "px"), d.style.width = e + "px");
		a.coverGutter && (d.style.zIndex = 5, d.style.position = "relative", a.noHScroll || (d.style.marginLeft = -g.gutterTotalWidth + "px"))
	}
	function F(a) {
		var d = a.display,
		e = xa(a.doc.sel.from, a.doc.sel.to);
		if (e || a.options.showCursorWhenSelecting) {
			var g = a.display,
			j = ea(a, a.doc.sel.head, "div");
			g.cursor.style.left = j.left + "px";
			g.cursor.style.top = j.top + "px";
			g.cursor.style.height = Math.max(0, j.bottom - j.top) * a.options.cursorHeight + "px";
			g.cursor.style.display = "";
			j.other ? (g.otherCursor.style.display = "", g.otherCursor.style.left = j.other.left + "px", g.otherCursor.style.top = j.other.top + "px", g.otherCursor.style.height = 0.85 * (j.other.bottom - j.other.top) + "px") : g.otherCursor.style.display = "none"
		} else d.cursor.style.display = d.otherCursor.style.display = "none";
		if (e) d.selectionDiv.style.display = "none";
		else {
			var k = function(a, d, e, g) {
				0 > d && (d = 0);
				m.appendChild(aa("div", null, "CodeMirror-selected", "position: absolute; left: " + a + "px; top: " + d + "px; width: " + (null == e ? n - a: e) + "px; height: " + (g - d) + "px"))
			},
			g = function(d, e, g, j) {
				var m = ga(l, d),
				ac = m.text.length,
				r = j ? Infinity: -Infinity;
				var s = cb(m),
				Ca = e || 0,
				v = null == g ? ac: g,
				mb = function(l, s, Ca) {
					var v = R(a, U(d, "rtl" == Ca ? s - 1 : l), "div", m);
					Ca = R(a, U(d, "rtl" == Ca ? l: s - 1), "div", m);
					var u = v.left,
					mb = Ca.right;
					3 < Ca.top - v.top && (k(u, v.top, null, v.bottom), u = o, v.bottom < Ca.top && k(u, v.bottom, null, Ca.top));
					null == g && s == ac && (mb = n);
					null == e && 0 == l && (u = o);
					r = j ? Math.min(Ca.top, r) : Math.max(Ca.bottom, r);
					u < o + 1 && (u = o);
					k(u, Ca.top, mb - u, Ca.bottom)
				};
				if (s) for (var u = 0; u < s.length; ++u) {
					var z = s[u];
					if (z.from < v && z.to > Ca || Ca == v && z.to == Ca) mb(Math.max(z.from, Ca), Math.min(z.to, v), 1 == z.level ? "rtl": "ltr")
				} else mb(Ca, v, "ltr");
				return r
			},
			e = a.display,
			l = a.doc,
			j = a.doc.sel,
			m = document.createDocumentFragment(),
			n = e.lineSpace.offsetWidth,
			o = hb(a.display.measure, aa("pre", null, null, "text-align: left")).appendChild(aa("span", "x")).offsetLeft;
			if (j.from.line == j.to.line) g(j.from.line, j.from.ch, j.to.ch);
			else {
				for (var r = ga(l, j.from.line), s = r, v = [j.from.line, j.from.ch], u; s = Pb(s);) {
					s = s.find();
					v.push(s.from.ch, s.to.line, s.to.ch);
					if (s.to.line == j.to.line) {
						v.push(j.to.ch);
						u = !0;
						break
					}
					s = ga(l, s.to.line)
				}
				if (u) for (u = 0; u < v.length; u += 3) g(v[u], v[u + 1], v[u + 2]);
				else v = ga(l, j.to.line),
				u = j.from.ch ? g(j.from.line, j.from.ch, null, !1) : Bb(a, r) - e.viewOffset,
				g = j.to.ch ? g(j.to.line, rb(v, -1) ? null: 0, j.to.ch, !0) : Bb(a, v) - e.viewOffset,
				u < g && k(o, u, null, g)
			}
			hb(e.selectionDiv, m);
			e.selectionDiv.style.display = ""
		}
		e = ea(a, a.doc.sel.head, "div");
		g = Ea(d.wrapper);
		u = Ea(d.lineDiv);
		d.inputDiv.style.top = Math.max(0, Math.min(d.wrapper.clientHeight - 10, e.top + u.top - g.top)) + "px";
		d.inputDiv.style.left = Math.max(0, Math.min(d.wrapper.clientWidth - 10, e.left + u.left - g.left)) + "px"
	}
	function I(a) {
		var d = a.display;
		clearInterval(d.blinker);
		var e = !0;
		d.cursor.style.visibility = d.otherCursor.style.visibility = "";
		d.blinker = setInterval(function() {
			d.cursor.offsetHeight && (d.cursor.style.visibility = d.otherCursor.style.visibility = (e = !e) ? "": "hidden")
		},
		a.options.cursorBlinkRate)
	}
	function G(a, d) {
		a.doc.mode.startState && a.doc.frontier < a.display.showingTo && a.state.highlight.set(d, Xa(K, a))
	}
	function K(a) {
		var d = a.doc;
		d.frontier < d.first && (d.frontier = d.first);
		if (! (d.frontier >= a.display.showingTo)) {
			var e = +new Date + a.options.workTime,
			g = Cb(d.mode, J(a, d.frontier)),
			j = [],
			k;
			d.iter(d.frontier, Math.min(d.first + d.size, a.display.showingTo + 500),
			function(l) {
				if (d.frontier >= a.display.showingFrom) {
					var m = l.styles;
					l.styles = dd(a, l, g);
					for (var n = !m || m.length != l.styles.length,
					o = 0; ! n && o < m.length; ++o) n = m[o] != l.styles[o];
					n && (k && k.end == d.frontier ? k.end++:j.push(k = {
						start: d.frontier,
						end: d.frontier + 1
					}));
					l.stateAfter = Cb(d.mode, g)
				} else ed(a, l, g),
				l.stateAfter = 0 == d.frontier % 5 ? Cb(d.mode, g) : null; ++d.frontier;
				if ( + new Date > e) return G(a, a.options.workDelay),
				!0
			});
			j.length && P(a,
			function() {
				for (var a = 0; a < j.length; ++a) fa(this, j[a].start, j[a].end)
			})()
		}
	}
	function J(a, d) {
		var e = a.doc,
		g = a.display;
		if (!e.mode.startState) return ! 0;
		var j;
		a: {
			for (var k, l, m = a.doc,
			n = d,
			o = d - 100; n > o; --n) {
				if (n <= m.first) {
					j = m.first;
					break a
				}
				var r = ga(m, n - 1);
				if (r.stateAfter) {
					j = n;
					break a
				}
				r = Db(r.text, null, a.options.tabSize);
				if (null == l || k > r) l = n - 1,
				k = r
			}
			j = l
		}
		var s = j > e.first && ga(e, j - 1).stateAfter,
		s = s ? Cb(e.mode, s) : fd(e.mode);
		e.iter(j, d,
		function(k) {
			ed(a, k, s);
			k.stateAfter = j == d - 1 || 0 == j % 5 || j >= g.showingFrom && j < g.showingTo ? Cb(e.mode, s) : null; ++j
		});
		return s
	}
	function C(a, d, e, g) {
		var j = -1;
		g = g || N(a, d);
		for (a = e;; a += j) {
			var k = g[a];
			if (k) break;
			0 > j && 0 == a && (j = 1)
		}
		return {
			left: a < e ? k.right: k.left,
			right: a > e ? k.left: k.right,
			top: k.top,
			bottom: k.bottom
		}
	}
	function N(a, d) {
		for (var e = a.display,
		g = a.display.measureLineCache,
		j = 0; j < g.length; ++j) {
			var k = g[j];
			if (k.text == d.text && k.markedSpans == d.markedSpans && e.scroller.clientWidth == k.width && k.classes == d.textClass + "|" + d.bgClass + "|" + d.wrapClass) return k.measure
		}
		var l = a.display,
		m = gd(d.text.length),
		k = cd(a, d, m);
		if (Qa && !xb && !a.options.lineWrapping && 100 < k.childNodes.length) {
			for (var n = document.createDocumentFragment(), o = k.childNodes.length, j = 0, r = Math.ceil(o / 10); j < r; ++j) {
				for (var s = aa("div", null, null, "display: inline-block"), v = 0; 10 > v && o; ++v) s.appendChild(k.firstChild),
				--o;
				n.appendChild(s)
			}
			k.appendChild(n)
		}
		hb(l.measure, k);
		o = Ea(l.lineDiv);
		r = [];
		n = gd(d.text.length);
		s = k.offsetHeight;
		sb && l.measure.first != k && hb(l.measure, k);
		for (j = 0; j < m.length; ++j) if (l = m[j]) {
			for (var u = Ea(l), z = Math.max(0, u.top - o.top), B = Math.min(u.bottom - o.top, s), v = 0; v < r.length; v += 2) {
				var D = r[v],
				E = r[v + 1];
				if (! (D > B || E < z)) if (D <= z && E >= B || z <= D && B >= E || Math.min(B, E) - Math.max(z, D) >= B - z >> 1) {
					r[v] = Math.min(z, D);
					r[v + 1] = Math.max(B, E);
					break
				}
			}
			v == r.length && r.push(z, B);
			z = u.right;
			l.measureRight && (z = Ea(l.measureRight).left);
			n[j] = {
				left: u.left - o.left,
				right: z - o.left,
				top: v
			}
		}
		for (j = 0; j < n.length; ++j) if (l = n[j]) m = l.top,
		l.top = r[m],
		l.bottom = r[m + 1];
		a.options.lineWrapping || (j = k.lastChild, 3 == j.nodeType && (j = k.appendChild(aa("span", "\u200b"))), n.width = Ea(j).right - o.left);
		k = {
			text: d.text,
			width: e.scroller.clientWidth,
			markedSpans: d.markedSpans,
			measure: n,
			classes: d.textClass + "|" + d.bgClass + "|" + d.wrapClass
		};
		16 == g.length ? g[++e.measureLineCachePos % 16] = k: g.push(k);
		return n
	}
	function O(a) {
		a.display.measureLineCache.length = a.display.measureLineCachePos = 0;
		a.display.cachedCharWidth = a.display.cachedTextHeight = null;
		a.display.maxLineChanged = !0;
		a.display.lineNumChars = null
	}
	function ra(a, d, e, g) {
		if (d.widgets) for (var j = 0; j < d.widgets.length; ++j) if (d.widgets[j].above) {
			var k = gc(d.widgets[j]);
			e.top += k;
			e.bottom += k
		}
		if ("line" == g) return e;
		g || (g = "local");
		d = Bb(a, d);
		"local" != g && (d -= a.display.viewOffset);
		"page" == g && (a = Ea(a.display.lineSpace), d += a.top + (window.pageYOffset || (document.documentElement || document.body).scrollTop), a = a.left + (window.pageXOffset || (document.documentElement || document.body).scrollLeft), e.left += a, e.right += a);
		e.top += d;
		e.bottom += d;
		return e
	}
	function R(a, d, e, g) {
		g || (g = ga(a.doc, d.line));
		return ra(a, g, C(a, g, d.ch), e)
	}
	function ea(a, d, e, g, j) {
		function k(d, l) {
			var m = C(a, g, d, j);
			l ? m.left = m.right: m.right = m.left;
			return ra(a, g, m, e)
		}
		g = g || ga(a.doc, d.line);
		j || (j = N(a, g));
		var l = cb(g);
		d = d.ch;
		if (!l) return k(d);
		for (var m, n, o = l[0].level, r = 0; r < l.length; ++r) {
			var s = l[r],
			v = s.level % 2,
			u;
			if (s.from < d && s.to > d) return k(d, v);
			var z = v ? s.from: s.to;
			if ((v ? s.to: s.from) == d) s = r && s.level < (u = l[r - 1]).level ? k(u.level % 2 ? u.from: u.to - 1, !0) : k(v && s.from != s.to ? d - 1 : d),
			v == o ? m = s: n = s;
			else if (z == d && (u = r < l.length - 1 && l[r + 1], v || !(u && u.from == u.to))) s = u && s.level < u.level ? k(u.level % 2 ? u.to - 1 : u.from) : k(v ? d: d - 1, !0),
			v == o ? m = s: n = s
		}
		o && !d && (n = k(l[0].to - 1));
		if (!m) return n;
		n && (m.other = n);
		return m
	}
	function Z(a, d, e) {
		a = new U(a, d);
		e && (a.outside = !0);
		return a
	}
	function Y(a, d, e) {
		var g = a.doc;
		e += a.display.viewOffset;
		if (0 > e) return Z(g.first, 0, !0);
		var j = fc(g, e),
		k = g.first + g.size - 1;
		if (j > k) return Z(g.first + g.size - 1, ga(g, k).text.length, !0);
		for (0 > d && (d = 0);;) {
			var k = ga(g, j),
			j = W(a, k, j, d, e),
			l = (k = Pb(k)) && k.find();
			if (k && j.ch >= l.from.ch) j = l.to.line;
			else return j
		}
	}
	function W(a, d, e, g, j) {
		function k(g) {
			g = ea(a, U(e, g), "line", d, o);
			m = !0;
			if (l > g.bottom) return Math.max(0, g.left - n);
			if (l < g.top) return g.left + n;
			m = !1;
			return g.left
		}
		var l = j - Bb(a, d),
		m = !1,
		n = a.display.wrapper.clientWidth,
		o = N(a, d),
		r = cb(d),
		s = d.text.length,
		v = hc(d),
		u = ic(d),
		z = k(v);
		j = m;
		var B = k(u),
		D = m;
		if (g > B) return Z(e, u, D);
		for (;;) {
			if (r ? u == v || u == Ec(d, v, 1) : 1 >= u - v) {
				for (v = (g = g - z < B - g) ? v: u; Fc.test(d.text.charAt(v));)++v;
				j = Z(e, v, g ? j: D);
				j.after = g;
				return j
			}
			var E = Math.ceil(s / 2),
			F = v + E;
			if (r) for (var F = v,
			C = 0; C < E; ++C) F = Ec(d, F, 1);
			C = k(F);
			if (C > g) {
				u = F;
				B = C;
				if (D = m) B += 1E3;
				s -= E
			} else v = F,
			z = C,
			j = m,
			s = E
		}
	}
	function ca(a) {
		if (null != a.cachedTextHeight) return a.cachedTextHeight;
		if (null == tb) {
			tb = aa("pre");
			for (var d = 0; 49 > d; ++d) tb.appendChild(document.createTextNode("x")),
			tb.appendChild(aa("br"));
			tb.appendChild(document.createTextNode("x"))
		}
		hb(a.measure, tb);
		d = tb.offsetHeight / 50;
		3 < d && (a.cachedTextHeight = d);
		dc(a.measure);
		return d || 1
	}
	function ha(a) {
		if (null != a.cachedCharWidth) return a.cachedCharWidth;
		var d = aa("span", "x"),
		e = aa("pre", [d]);
		hb(a.measure, e);
		d = d.offsetWidth;
		2 < d && (a.cachedCharWidth = d);
		return d || 10
	}
	function M(a) {
		a.curOp = {
			changes: [],
			updateInput: null,
			userSelChange: null,
			textChanged: null,
			selectionChanged: !1,
			updateMaxLine: !1,
			updateScrollPos: !1,
			id: ++Vd
		};
		jc++||(nb = [])
	}
	function ja(a) {
		var d = a.curOp,
		e = a.doc,
		g = a.display;
		a.curOp = null;
		d.updateMaxLine && n(a);
		if (g.maxLineChanged && !a.options.lineWrapping) {
			var j = N(a, g.maxLine).width;
			g.sizer.style.minWidth = Math.max(0, j + 3 + Nb) + "px";
			g.maxLineChanged = !1;
			j = Math.max(0, g.sizer.offsetLeft + g.sizer.offsetWidth - g.scroller.clientWidth);
			j < e.scrollLeft && !d.updateScrollPos && za(a, Math.min(g.scroller.scrollLeft, j), !0)
		}
		var k, l;
		d.updateScrollPos ? k = d.updateScrollPos: d.selectionChanged && g.scroller.clientHeight && (k = ea(a, e.sel.head), k = ob(a, k.left, k.top, k.left, k.bottom));
		if (d.changes.length || k && null != k.scrollTop) l = z(a, d.changes, k && k.scrollTop); ! l && d.selectionChanged && F(a);
		if (d.updateScrollPos) g.scroller.scrollTop = g.scrollbarV.scrollTop = e.scrollTop = k.scrollTop,
		g.scroller.scrollLeft = g.scrollbarH.scrollLeft = e.scrollLeft = k.scrollLeft,
		s(a);
		else if (k && (e = Eb(a, a.doc.sel.head), a.state.focused)) {
			g = a.display;
			k = Ea(g.sizer);
			l = null;
			if (0 > e.top + k.top) l = !0;
			else if (e.bottom + k.top > (window.innerHeight || document.documentElement.clientHeight)) l = !1;
			if (null != l && !Wd) {
				if (k = "none" == g.cursor.style.display) g.cursor.style.display = "",
				g.cursor.style.left = e.left + "px",
				g.cursor.style.top = e.top - g.viewOffset + "px";
				g.cursor.scrollIntoView(l);
				k && (g.cursor.style.display = "none")
			}
		}
		d.selectionChanged && I(a);
		a.state.focused && d.updateInput && L(a, d.userSelChange);
		e = d.maybeHiddenMarkers;
		g = d.maybeUnhiddenMarkers;
		if (e) for (l = 0; l < e.length; ++l) e[l].lines.length || Ra(e[l], "hide");
		if (g) for (l = 0; l < g.length; ++l) g[l].lines.length && Ra(g[l], "unhide");
		var m; --jc || (m = nb, nb = null);
		d.textChanged && Ra(a, "change", a, d.textChanged);
		d.selectionChanged && Ra(a, "cursorActivity", a);
		if (m) for (l = 0; l < m.length; ++l) m[l]()
	}
	function P(a, d) {
		return function() {
			var e = a || this,
			g = !e.curOp;
			g && M(e);
			try {
				var j = d.apply(e, arguments)
			} finally {
				g && ja(e)
			}
			return j
		}
	}
	function ua(a) {
		return function() {
			var d = this.cm && !this.cm.curOp,
			e;
			d && M(this.cm);
			try {
				e = a.apply(this, arguments)
			} finally {
				d && ja(this.cm)
			}
			return e
		}
	}
	function H(a, d) {
		var e = !a.curOp,
		g;
		e && M(a);
		try {
			g = d()
		} finally {
			e && ja(a)
		}
		return g
	}
	function fa(a, d, e, g) {
		null == d && (d = a.doc.first);
		null == e && (e = a.doc.first + a.doc.size);
		a.curOp.changes.push({
			from: d,
			to: e,
			diff: g
		})
	}
	function oa(a) {
		a.display.pollingFast || a.display.poll.set(a.options.pollInterval,
		function() {
			ka(a);
			a.state.focused && oa(a)
		})
	}
	function ia(a) {
		function d() { ! ka(a) && !e ? (e = !0, a.display.poll.set(60, d)) : (a.display.pollingFast = !1, oa(a))
		}
		var e = !1;
		a.display.pollingFast = !0;
		a.display.poll.set(20, d)
	}
	function ka(a) {
		var d = a.display.input,
		e = a.display.prevInput,
		g = a.doc,
		j = g.sel;
		if (!a.state.focused || Xd(d) || V(a)) return ! 1;
		var k = d.value;
		if (k == e && xa(j.from, j.to)) return ! 1;
		if (Qa && k && 0 === d.selectionStart) return L(a, !0),
		!1;
		var l = !a.curOp;
		l && M(a);
		j.shift = !1;
		for (var m = 0,
		n = Math.min(e.length, k.length); m < n && e[m] == k[m];)++m;
		n = j.from;
		j = j.to;
		m < e.length ? n = U(n.line, n.ch - (e.length - m)) : a.state.overwrite && (xa(n, j) && !a.state.pasteIncoming) && (j = U(j.line, Math.min(ga(g, j.line).text.length, j.ch + (k.length - m))));
		e = a.curOp.updateInput;
		Ua(a.doc, {
			from: n,
			to: j,
			text: Fb(k.slice(m)),
			origin: a.state.pasteIncoming ? "paste": "+input"
		},
		"end");
		a.curOp.updateInput = e;
		1E3 < k.length ? d.value = a.display.prevInput = "": a.display.prevInput = k;
		l && ja(a);
		a.state.pasteIncoming = !1;
		return ! 0
	}
	function L(a, d) {
		var e, g, j = a.doc;
		xa(j.sel.from, j.sel.to) ? d && (a.display.prevInput = a.display.input.value = "") : (a.display.prevInput = "", e = kc && (100 < j.sel.to.line - j.sel.from.line || 1E3 < (g = a.getSelection()).length), a.display.input.value = e ? "-": g || a.getSelection(), a.state.focused && $c(a.display.input));
		a.display.inaccurateSelection = e
	}
	function S(a) {
		"nocursor" != a.options.readOnly && (!Ac || document.activeElement != a.display.input) && a.display.input.focus()
	}
	function V(a) {
		return a.options.readOnly || a.doc.cantEdit
	}
	function ba(a, d) {
		for (var e = d.target || d.srcElement; e != a.wrapper; e = e.parentNode) if (!e || /\bCodeMirror-(?:line)?widget\b/.test(e.className) || e.parentNode == a.sizer && e != a.mover) return ! 0
	}
	function La(a, d, e) {
		var g = a.display;
		if (!e && (e = d.target || d.srcElement, e == g.scrollbarH || e == g.scrollbarH.firstChild || e == g.scrollbarV || e == g.scrollbarV.firstChild || e == g.scrollbarFiller)) return null;
		var j, k, g = Ea(g.lineSpace);
		try {
			j = d.clientX,
			k = d.clientY
		} catch(l) {
			return null
		}
		return Y(a, j - g.left, k - g.top)
	}
	function Ga(a) {
		function d(a) {
			if ("single" == r) Da(j.doc, da(l, n), a);
			else if (B = da(l, B), D = da(l, D), "double" == r) {
				var e = hd(ga(l, a.line).text, a);
				la(a, B) ? Da(j.doc, e.from, D) : Da(j.doc, B, e.to)
			} else "triple" == r && (la(a, B) ? Da(j.doc, D, da(l, U(a.line, 0))) : Da(j.doc, B, da(l, U(a.line + 1, 0))))
		}
		function e(a) {
			var g = ++F,
			m = La(j, a, !0);
			if (m) if (xa(m, v)) {
				var n = a.clientY < E.top ? -20 : a.clientY > E.bottom ? 20 : 0;
				n && setTimeout(P(j,
				function() {
					F == g && (k.scroller.scrollTop += n, e(a))
				}), 50)
			} else {
				j.state.focused || sa(j);
				v = m;
				d(m);
				var Xc = u(k, l); (m.line >= Xc.to || m.line < Xc.from) && setTimeout(P(j,
				function() {
					F == g && e(a)
				}), 150)
			}
		}
		function g(a) {
			F = Infinity;
			var e = La(j, a);
			e && d(e);
			Ha(a);
			S(j);
			fb(document, "mousemove", C);
			fb(document, "mouseup", I)
		}
		var j = this,
		k = j.display,
		l = j.doc,
		m = l.sel;
		m.shift = a.shiftKey;
		if (ba(k, a)) eb || (k.scroller.draggable = !1, setTimeout(function() {
			k.scroller.draggable = !0
		},
		100));
		else if (!db(j, a)) {
			var n = La(j, a);
			switch (id(a)) {
			case 3:
				Bc && Ma.call(j, j, a);
				return;
			case 2:
				n && Da(j.doc, n);
				setTimeout(Xa(S, j), 20);
				Ha(a);
				return
			}
			if (n) {
				j.state.focused || sa(j);
				var o = +new Date,
				r = "single";
				if (lc && lc.time > o - 400 && xa(lc.pos, n)) {
					r = "triple";
					Ha(a);
					setTimeout(Xa(S, j), 20);
					var o = j,
					s = n.line;
					Da(o.doc, U(s, 0), da(o.doc, U(s + 1, 0)))
				} else mc && mc.time > o - 400 && xa(mc.pos, n) ? (r = "double", lc = {
					time: o,
					pos: n
				},
				Ha(a), o = hd(ga(l, n.line).text, n), Da(j.doc, o.from, o.to)) : mc = {
					time: o,
					pos: n
				};
				var v = n;
				if (j.options.dragDrop && Gc && !V(j) && !xa(m.from, m.to) && !la(n, m.from) && !la(m.to, n) && "single" == r) {
					var z = P(j,
					function(d) {
						eb && (k.scroller.draggable = !1);
						j.state.draggingText = !1;
						fb(document, "mouseup", z);
						fb(k.scroller, "drop", z);
						10 > Math.abs(a.clientX - d.clientX) + Math.abs(a.clientY - d.clientY) && (Ha(d), Da(j.doc, n), S(j))
					});
					eb && (k.scroller.draggable = !0);
					j.state.draggingText = z;
					k.scroller.dragDrop && k.scroller.dragDrop();
					na(document, "mouseup", z);
					na(k.scroller, "drop", z)
				} else {
					Ha(a);
					"single" == r && Da(j.doc, da(l, n));
					var B = m.from,
					D = m.to,
					E = Ea(k.wrapper),
					F = 0,
					C = P(j,
					function(a) { ! Qa && !id(a) ? g(a) : e(a)
					}),
					I = P(j, g);
					na(document, "mousemove", C);
					na(document, "mouseup", I)
				}
			} else(a.target || a.srcElement) == k.scroller && Ha(a)
		}
	}
	function T(a) {
		var d = this;
		if (! (ba(d.display, a) || d.options.onDragEvent && d.options.onDragEvent(d, Ob(a)))) {
			Ha(a);
			var e = La(d, a, !0),
			g = a.dataTransfer.files;
			if (e && !V(d)) if (g && g.length && window.FileReader && window.File) {
				var j = g.length,
				k = Array(j),
				l = 0;
				a = function(a, g) {
					var m = new FileReader;
					m.onload = function() {
						k[g] = m.result; ++l == j && (e = da(d.doc, e), Va(d.doc, k.join(""), e, "around", "paste"))
					};
					m.readAsText(a)
				};
				for (var m = 0; m < j; ++m) a(g[m], m)
			} else if (d.state.draggingText && !la(e, d.doc.sel.from) && !la(d.doc.sel.to, e)) d.state.draggingText(a),
			setTimeout(Xa(S, d), 20);
			else try {
				if (k = a.dataTransfer.getData("Text")) {
					var m = d.doc.sel.from,
					n = d.doc.sel.to;
					Ja(d.doc, e, e);
					d.state.draggingText && Va(d.doc, "", m, n, "paste");
					d.replaceSelection(k, null, "paste");
					S(d);
					sa(d)
				}
			} catch(o) {}
		}
	}
	function db(a, d) {
		var e = a.display;
		try {
			var g = d.clientX,
			j = d.clientY
		} catch(k) {
			return ! 1
		}
		if (g >= Math.floor(Ea(e.gutters).right)) return ! 1;
		Ha(d);
		if (!Gb(a, "gutterClick")) return ! 0;
		var l = Ea(e.lineDiv);
		if (j > l.bottom) return ! 0;
		j -= l.top - e.viewOffset;
		for (l = 0; l < a.options.gutters.length; ++l) {
			var m = e.gutters.childNodes[l];
			if (m && Ea(m).right >= g) {
				e = fc(a.doc, j);
				bb(a, "gutterClick", a, e, a.options.gutters[l], d);
				break
			}
		}
		return ! 0
	}
	function va(a, d) {
		2 > Math.abs(a.doc.scrollTop - d) || (a.doc.scrollTop = d, Hb || z(a, [], d), a.display.scroller.scrollTop != d && (a.display.scroller.scrollTop = d), a.display.scrollbarV.scrollTop != d && (a.display.scrollbarV.scrollTop = d), Hb && z(a, []))
	}
	function za(a, d, e) {
		if (! (e ? d == a.doc.scrollLeft: 2 > Math.abs(a.doc.scrollLeft - d))) d = Math.min(d, a.display.scroller.scrollWidth - a.display.scroller.clientWidth),
		a.doc.scrollLeft = d,
		s(a),
		a.display.scroller.scrollLeft != d && (a.display.scroller.scrollLeft = d),
		a.display.scrollbarH.scrollLeft != d && (a.display.scrollbarH.scrollLeft = d)
	}
	function kb(a, d) {
		var e = d.wheelDeltaX,
		g = d.wheelDeltaY;
		null == e && (d.detail && d.axis == d.HORIZONTAL_AXIS) && (e = d.detail);
		null == g && d.detail && d.axis == d.VERTICAL_AXIS ? g = d.detail: null == g && (g = d.wheelDelta);
		if (g && Ab && eb) for (var j = d.target; j != l; j = j.parentNode) if (j.lineObj) {
			a.display.currentWheelTarget = j;
			break
		}
		var k = a.display,
		l = k.scroller;
		if (e && !Hb && !gb && null != Ya) g && va(a, Math.max(0, Math.min(l.scrollTop + g * Ya, l.scrollHeight - l.clientHeight))),
		za(a, Math.max(0, Math.min(l.scrollLeft + e * Ya, l.scrollWidth - l.clientWidth))),
		Ha(d),
		k.wheelStartX = null;
		else {
			if (g && null != Ya) {
				var j = g * Ya,
				m = a.doc.scrollTop,
				n = m + k.wrapper.clientHeight;
				0 > j ? m = Math.max(0, m + j - 50) : n = Math.min(a.doc.height, n + j + 50);
				z(a, [], {
					top: m,
					bottom: n
				})
			}
			20 > nc && (null == k.wheelStartX ? (k.wheelStartX = l.scrollLeft, k.wheelStartY = l.scrollTop, k.wheelDX = e, k.wheelDY = g, setTimeout(function() {
				if (null != k.wheelStartX) {
					var a = l.scrollLeft - k.wheelStartX,
					d = l.scrollTop - k.wheelStartY,
					a = d && k.wheelDY && d / k.wheelDY || a && k.wheelDX && a / k.wheelDX;
					k.wheelStartX = k.wheelStartY = null;
					a && (Ya = (Ya * nc + a) / (nc + 1), ++nc)
				}
			},
			200)) : (k.wheelDX += e, k.wheelDY += g))
		}
	}
	function X(a, d, e) {
		if ("string" == typeof d && (d = Hc[d], !d)) return ! 1;
		a.display.pollingFast && ka(a) && (a.display.pollingFast = !1);
		var g = a.doc,
		j = g.sel.shift,
		k = !1;
		try {
			V(a) && (a.state.suppressEdits = !0),
			e && (g.sel.shift = !1),
			k = d(a) != jd
		} finally {
			g.sel.shift = j,
			a.state.suppressEdits = !1
		}
		return k
	}
	function Q(a) {
		var d = a.state.keyMaps.slice(0);
		d.push(a.options.keyMap);
		a.options.extraKeys && d.unshift(a.options.extraKeys);
		return d
	}
	function ma(a, d) {
		var e = Ic(a.options.keyMap),
		g = e.auto;
		clearTimeout(kd);
		g && !ld(d) && (kd = setTimeout(function() {
			Ic(a.options.keyMap) == e && (a.options.keyMap = g.call ? g.call(null, a) : g)
		},
		50));
		var j = md(d, !0),
		k = !1;
		if (!j) return ! 1;
		k = Q(a);
		k = d.shiftKey ? Rb("Shift-" + j, k,
		function(d) {
			return X(a, d, !0)
		}) || Rb(j, k,
		function(d) {
			if ("string" == typeof d && /^go[A-Z]/.test(d)) return X(a, d)
		}) : Rb(j, k,
		function(d) {
			return X(a, d)
		});
		"stop" == k && (k = !1);
		k && (Ha(d), I(a), sb && (d.oldKeyCode = d.keyCode, d.keyCode = 0));
		return k
	}
	function pa(a) {
		this.state.focused || sa(this);
		Qa && 27 == a.keyCode && (a.returnValue = !1);
		if (!this.options.onKeyEvent || !this.options.onKeyEvent(this, Ob(a))) {
			var d = a.keyCode;
			this.doc.sel.shift = 16 == d || a.shiftKey;
			var e = ma(this, a);
			gb && (Jc = e ? d: null, !e && (88 == d && !kc && (Ab ? a.metaKey: a.ctrlKey)) && this.replaceSelection(""))
		}
	}
	function wa(a) {
		var d = this;
		if (!d.options.onKeyEvent || !d.options.onKeyEvent(d, Ob(a))) {
			var e = a.keyCode,
			g = a.charCode;
			if (gb && e == Jc) Jc = null,
			Ha(a);
			else if (! (gb && (!a.which || 10 > a.which) || yc) || !ma(d, a)) {
				e = String.fromCharCode(null == g ? e: g);
				this.options.electricChars && (this.doc.mode.electricChars && this.options.smartIndent && !V(this) && -1 < this.doc.mode.electricChars.indexOf(e)) && setTimeout(P(d,
				function() {
					Oa(d, d.doc.sel.to.line, "smart")
				}), 75);
				if (e = Rb("'" + e + "'", Q(d),
				function(a) {
					return X(d, a, !0)
				})) Ha(a),
				I(d);
				e || ia(d)
			}
		}
	}
	function sa(a) {
		"nocursor" != a.options.readOnly && (a.state.focused || (Ra(a, "focus", a), a.state.focused = !0, -1 == a.display.wrapper.className.search(/\bCodeMirror-focused\b/) && (a.display.wrapper.className += " CodeMirror-focused"), L(a, !0)), oa(a), I(a))
	}
	function qa(a) {
		a.state.focused && (Ra(a, "blur", a), a.state.focused = !1, a.display.wrapper.className = a.display.wrapper.className.replace(" CodeMirror-focused", ""));
		clearInterval(a.display.blinker);
		setTimeout(function() {
			a.state.focused || (a.doc.sel.shift = !1)
		},
		150)
	}
	function Ma(a, d) {
		function e() {
			g.inputDiv.style.position = "relative";
			g.input.style.cssText = m;
			sb && (g.scrollbarV.scrollTop = g.scroller.scrollTop = l);
			oa(a);
			if (null != g.input.selectionStart && (!Qa || sb)) {
				clearTimeout(Kc);
				var d = g.input.value = " " + (xa(j.from, j.to) ? "": g.input.value),
				k = 0;
				g.prevInput = " ";
				g.input.selectionStart = 1;
				g.input.selectionEnd = d.length;
				var n = function() {
					" " == g.prevInput && 0 == g.input.selectionStart ? P(a, Hc.selectAll)(a) : 10 > k++?Kc = setTimeout(n, 500) : L(a)
				};
				Kc = setTimeout(n, 200)
			}
		}
		var g = a.display,
		j = a.doc.sel;
		if (!ba(g, d)) {
			var k = La(a, d),
			l = g.scroller.scrollTop;
			if (k && !gb) { (xa(j.from, j.to) || la(k, j.from) || !la(k, j.to)) && P(a, Ja)(a.doc, k, k);
				var m = g.input.style.cssText;
				g.inputDiv.style.position = "absolute";
				g.input.style.cssText = "position: fixed; width: 30px; height: 30px; top: " + (d.clientY - 5) + "px; left: " + (d.clientX - 5) + "px; z-index: 1000; background: white; outline: none;border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity\x3d5);";
				S(a);
				L(a, !0);
				xa(j.from, j.to) && (g.input.value = g.prevInput = " ");
				if (Bc) {
					cc(d);
					var n = function() {
						fb(window, "mouseup", n);
						setTimeout(e, 20)
					};
					na(window, "mouseup", n)
				} else setTimeout(e, 50)
			}
		}
	}
	function ya(a) {
		return U(a.from.line + a.text.length - 1, Ka(a.text).length + (1 == a.text.length ? a.from.ch: 0))
	}
	function Pa(a, d, e) {
		if (!la(d.from, e)) return da(a, e);
		var g = d.text.length - 1 - (d.to.line - d.from.line);
		if (e.line > d.to.line + g) return d = e.line - g,
		g = a.first + a.size - 1,
		d > g ? U(g, ga(a, g).text.length) : lb(e, ga(a, d).text.length);
		if (e.line == d.to.line + g) return lb(e, Ka(d.text).length + (1 == d.text.length ? d.from.ch: 0) + ga(a, d.to.line).text.length - d.to.ch);
		a = e.line - d.from.line;
		return lb(e, d.text[a].length + (a ? 0 : d.from.ch))
	}
	function Za(a, d, e) {
		if (e && "object" == typeof e) return {
			anchor: Pa(a, d, e.anchor),
			head: Pa(a, d, e.head)
		};
		if ("start" == e) return {
			anchor: d.from,
			head: d.from
		};
		var g = ya(d);
		if ("around" == e) return {
			anchor: d.from,
			head: g
		};
		if ("end" == e) return {
			anchor: g,
			head: g
		};
		e = function(a) {
			if (la(a, d.from)) return a;
			if (!la(d.to, a)) return g;
			var e = a.line + d.text.length - (d.to.line - d.from.line) - 1,
			j = a.ch;
			a.line == d.to.line && (j += g.ch - d.to.ch);
			return U(e, j)
		};
		return {
			anchor: e(a.sel.anchor),
			head: e(a.sel.head)
		}
	}
	function Ua(a, d, e, g) {
		if (a.cm) {
			if (!a.cm.curOp) return P(a.cm, Ua)(a, d, e, g);
			if (a.cm.state.suppressEdits) return
		}
		if (Gb(a, "beforeChange") || a.cm && Gb(a.cm, "beforeChange")) if (d = {
			canceled: !1,
			from: d.from,
			to: d.to,
			text: d.text,
			origin: d.origin,
			update: function(d, e, g, j) {
				d && (this.from = da(a, d));
				e && (this.to = da(a, e));
				g && (this.text = g);
				void 0 !== j && (this.origin = j)
			},
			cancel: function() {
				this.canceled = !0
			}
		},
		Ra(a, "beforeChange", a, d), a.cm && Ra(a.cm, "beforeChange", a.cm, d), d = d.canceled ? null: {
			from: d.from,
			to: d.to,
			text: d.text,
			origin: d.origin
		},
		!d) return;
		var j;
		if (j = nd) {
			if (g = !g) {
				g = d.from;
				j = d.to;
				var k = null;
				a.iter(g.line, j.line + 1,
				function(a) {
					if (a.markedSpans) for (var d = 0; d < a.markedSpans.length; ++d) {
						var e = a.markedSpans[d].marker;
						if (e.readOnly && (!k || -1 == ib(k, e)))(k || (k = [])).push(e)
					}
				});
				if (k) {
					g = [{
						from: g,
						to: j
					}];
					for (j = 0; j < k.length; ++j) for (var l = k[j], m = l.find(), n = 0; n < g.length; ++n) {
						var o = g[n];
						if (!la(o.to, m.from) && !la(m.to, o.from)) {
							var r = [n, 1]; (la(o.from, m.from) || !l.inclusiveLeft && xa(o.from, m.from)) && r.push({
								from: o.from,
								to: m.from
							}); (la(m.to, o.to) || !l.inclusiveRight && xa(o.to, m.to)) && r.push({
								from: m.to,
								to: o.to
							});
							g.splice.apply(g, r);
							n += r.length - 1
						}
					}
				} else g = null
			}
			j = g
		}
		if (g = j) {
			for (j = g.length - 1; 1 <= j; --j) Aa(a, {
				from: g[j].from,
				to: g[j].to,
				text: [""]
			});
			g.length && Aa(a, {
				from: g[0].from,
				to: g[0].to,
				text: d.text
			},
			e)
		} else Aa(a, d, e)
	}
	function Aa(a, d, e) {
		e = Za(a, d, e);
		var g = a.cm ? a.cm.curOp.id: NaN,
		j = a.history;
		j.undone.length = 0;
		var k = +new Date,
		l = Ka(j.done);
		if (l && (j.lastOp == g || j.lastOrigin == d.origin && d.origin && ("+" == d.origin.charAt(0) && j.lastTime > k - 600 || "*" == d.origin.charAt(0)))) {
			var m = Ka(l.changes);
			xa(d.from, d.to) && xa(d.from, m.to) ? m.to = ya(d) : l.changes.push(Lc(a, d));
			l.anchorAfter = e.anchor;
			l.headAfter = e.head
		} else {
			l = {
				changes: [Lc(a, d)],
				anchorBefore: a.sel.anchor,
				headBefore: a.sel.head,
				anchorAfter: e.anchor,
				headAfter: e.head
			};
			for (j.done.push(l); j.done.length > j.undoDepth;) j.done.shift();
			0 > j.dirtyCounter ? j.dirtyCounter = NaN: j.dirtyCounter++
		}
		j.lastTime = k;
		j.lastOp = g;
		j.lastOrigin = d.origin;
		$a(a, d, e, Mc(a, d));
		var n = [];
		Ib(a,
		function(a, e) { ! e && -1 == ib(n, a.history) && (od(a.history, d), n.push(a.history));
			$a(a, d, null, Mc(a, d))
		})
	}
	function Lb(a, d) {
		var e = a.history,
		g = ("undo" == d ? e.done: e.undone).pop();
		if (g) {
			e.dirtyCounter += "undo" == d ? -1 : 1;
			var j = {
				changes: [],
				anchorBefore: g.anchorAfter,
				headBefore: g.headAfter,
				anchorAfter: g.anchorBefore,
				headAfter: g.headBefore
			}; ("undo" == d ? e.undone: e.done).push(j);
			for (e = g.changes.length - 1; 0 <= e; --e) {
				var k = g.changes[e];
				k.origin = d;
				j.changes.push(Lc(a, k));
				var l = e ? Za(a, k, null) : {
					anchor: g.anchorBefore,
					head: g.headBefore
				};
				$a(a, k, l, pd(a, k));
				var m = [];
				Ib(a,
				function(a, d) { ! d && -1 == ib(m, a.history) && (od(a.history, k), m.push(a.history));
					$a(a, k, null, pd(a, k))
				})
			}
		}
	}
	function Mb(a, d) {
		function e(a) {
			return U(a.line + d, a.ch)
		}
		a.first += d;
		a.cm && fa(a.cm, a.first, a.first, d);
		a.sel.head = e(a.sel.head);
		a.sel.anchor = e(a.sel.anchor);
		a.sel.from = e(a.sel.from);
		a.sel.to = e(a.sel.to)
	}
	function $a(a, e, g, j) {
		if (a.cm && !a.cm.curOp) return P(a.cm, $a)(a, e, g, j);
		if (e.to.line < a.first) Mb(a, e.text.length - 1 - (e.to.line - e.from.line));
		else if (! (e.from.line > a.lastLine())) {
			if (e.from.line < a.first) {
				var k = e.text.length - 1 - (a.first - e.from.line);
				Mb(a, k);
				e = {
					from: U(a.first, 0),
					to: U(e.to.line + k, e.to.ch),
					text: [Ka(e.text)],
					origin: e.origin
				}
			}
			k = a.lastLine();
			e.to.line > k && (e = {
				from: e.from,
				to: U(k, ga(a, k).text.length),
				text: [e.text[0]],
				origin: e.origin
			});
			g || (g = Za(a, e, null));
			if (a.cm) {
				a = a.cm;
				var l = a.doc,
				n = a.display,
				k = e.from,
				o = e.to,
				r = !1,
				s = k.line;
				a.options.lineWrapping || (s = Sa(zb(l, ga(l, k.line))), l.iter(s, o.line + 1,
				function(a) {
					if (a == n.maxLine) return r = !0
				}));
				Nc(l, e, j, g, d(a));
				a.options.lineWrapping || (l.iter(s, k.line + e.text.length,
				function(a) {
					var d = m(l, a);
					d > n.maxLineLength && (n.maxLine = a, n.maxLineLength = d, n.maxLineChanged = !0, r = !1)
				}), r && (a.curOp.updateMaxLine = !0));
				l.frontier = Math.min(l.frontier, k.line);
				G(a, 400);
				fa(a, k.line, o.line + 1, e.text.length - (o.line - k.line) - 1);
				if (Gb(a, "change")) if (j = {
					from: k,
					to: o,
					text: e.text,
					origin: e.origin
				},
				a.curOp.textChanged) {
					for (a = a.curOp.textChanged; a.next; a = a.next);
					a.next = j
				} else a.curOp.textChanged = j
			} else Nc(a, e, j, g)
		}
	}
	function Va(a, d, e, g, j) {
		g || (g = e);
		if (la(g, e)) {
			var k = g;
			g = e;
			e = k
		}
		"string" == typeof d && (d = Fb(d));
		Ua(a, {
			from: e,
			to: g,
			text: d,
			origin: j
		},
		null)
	}
	function U(a, d) {
		if (! (this instanceof U)) return new U(a, d);
		this.line = a;
		this.ch = d
	}
	function xa(a, d) {
		return a.line == d.line && a.ch == d.ch
	}
	function la(a, d) {
		return a.line < d.line || a.line == d.line && a.ch < d.ch
	}
	function Na(a) {
		return U(a.line, a.ch)
	}
	function da(a, d) {
		if (d.line < a.first) return U(a.first, 0);
		var e = a.first + a.size - 1;
		return d.line > e ? U(e, ga(a, e).text.length) : lb(d, ga(a, d.line).text.length)
	}
	function lb(a, d) {
		var e = a.ch;
		return null == e || e > d ? U(a.line, d) : 0 > e ? U(a.line, 0) : a
	}
	function Fa(a, d) {
		return d >= a.first && d < a.first + a.size
	}
	function Da(a, d, e, g) {
		if (a.sel.shift || a.sel.extend) {
			var j = a.sel.anchor;
			if (e) {
				var k = la(d, j);
				k != la(e, j) ? (j = d, d = e) : k != la(d, e) && (d = e)
			}
			Ja(a, j, d, g)
		} else Ja(a, d, e || d, g);
		a.cm && (a.cm.curOp.userSelChange = !0)
	}
	function Ja(a, d, e, g, j) {
		if (!j && Gb(a, "beforeSelectionChange") || a.cm && Gb(a.cm, "beforeSelectionChange")) d = {
			anchor: d,
			head: e
		},
		Ra(a, "beforeSelectionChange", a, d),
		a.cm && Ra(a.cm, "beforeSelectionChange", a.cm, d),
		d.anchor = da(a, d.anchor),
		d.head = da(a, d.head),
		e = d.head,
		d = d.anchor;
		var k = a.sel;
		k.goalColumn = null;
		if (j || !xa(d, k.anchor)) d = pb(a, d, g, "push" != j);
		if (j || !xa(e, k.head)) e = pb(a, e, g, "push" != j);
		if (!xa(k.anchor, d) || !xa(k.head, e)) k.anchor = d,
		k.head = e,
		g = la(e, d),
		k.from = g ? e: d,
		k.to = g ? d: e,
		a.cm && (a.cm.curOp.updateInput = a.cm.curOp.selectionChanged = !0),
		bb(a, "cursorActivity", a)
	}
	function Jb(a) {
		Ja(a.doc, a.doc.sel.from, a.doc.sel.to, null, "push")
	}
	function pb(a, d, e, g) {
		var j = !1,
		k = d,
		l = e || 1;
		a.cantEdit = !1;
		a: for (;;) {
			var m = ga(a, k.line),
			n;
			if (m.markedSpans) {
				for (var o = 0; o < m.markedSpans.length; ++o) {
					var r = m.markedSpans[o],
					s = r.marker;
					if ((null == r.from || (s.inclusiveLeft ? r.from <= k.ch: r.from < k.ch)) && (null == r.to || (s.inclusiveRight ? r.to >= k.ch: r.to > k.ch))) if (g && s.clearOnEnter)(n || (n = [])).push(s);
					else if (s.atomic) {
						o = s.find()[0 > l ? "from": "to"];
						if (xa(o, k) && (o.ch += l, 0 > o.ch ? o = o.line > a.first ? da(a, U(o.line - 1)) : null: o.ch > m.text.length && (o = o.line < a.first + a.size - 1 ? U(o.line + 1, 0) : null), !o)) {
							if (j) {
								if (!g) return pb(a, d, e, !0);
								a.cantEdit = !0;
								return U(a.first, 0)
							}
							j = !0;
							o = d;
							l = -l
						}
						k = o;
						continue a
					}
				}
				if (n) for (o = 0; o < n.length; ++o) n[o].clear()
			}
			return k
		}
	}
	function Eb(a, d) {
		for (;;) {
			var e = !1,
			g = ea(a, d),
			j = ob(a, g.left, g.top, g.left, g.bottom),
			k = a.doc.scrollTop,
			l = a.doc.scrollLeft;
			null != j.scrollTop && (va(a, j.scrollTop), 1 < Math.abs(a.doc.scrollTop - k) && (e = !0));
			null != j.scrollLeft && (za(a, j.scrollLeft), 1 < Math.abs(a.doc.scrollLeft - l) && (e = !0));
			if (!e) return g
		}
	}
	function ub(a, d, e, g, j) {
		d = ob(a, d, e, g, j);
		null != d.scrollTop && va(a, d.scrollTop);
		null != d.scrollLeft && za(a, d.scrollLeft)
	}
	function ob(a, d, e, g, j) {
		var k = a.display,
		l = k.lineSpace.offsetTop;
		e += l;
		j += l;
		var m = k.scroller.clientHeight - Nb,
		n = k.scroller.scrollTop,
		o = {};
		a = a.doc.height + 2 * l;
		var r = e < l + 10,
		l = j + l > a - 10;
		e < n ? o.scrollTop = r ? 0 : Math.max(0, e) : j > n + m && (o.scrollTop = (l ? a: j) - m);
		e = k.scroller.clientWidth - Nb;
		j = k.scroller.scrollLeft;
		d += k.gutters.offsetWidth;
		g += k.gutters.offsetWidth;
		k = k.gutters.offsetWidth;
		m = d < k + 10;
		d < j + k || m ? (m && (d = 0), o.scrollLeft = Math.max(0, d - 10 - k)) : g > e + j - 3 && (o.scrollLeft = g + 10 - e);
		return o
	}
	function Oa(a, d, e, g) {
		var j = a.doc;
		e || (e = "add");
		if ("smart" == e) if (a.doc.mode.indent) var k = J(a, d);
		else e = "prev";
		var l = a.options.tabSize,
		m = ga(j, d),
		n = Db(m.text, null, l),
		o = m.text.match(/^\s*/)[0],
		r;
		if ("smart" == e && (r = a.doc.mode.indent(k, m.text.slice(o.length), m.text), r == jd)) {
			if (!g) return;
			e = "prev"
		}
		"prev" == e ? r = d > j.first ? Db(ga(j, d - 1).text, null, l) : 0 : "add" == e ? r = n + a.options.indentUnit: "subtract" == e && (r = n - a.options.indentUnit);
		r = Math.max(0, r);
		e = "";
		g = 0;
		if (a.options.indentWithTabs) for (j = Math.floor(r / l); j; --j) g += l,
		e += "\t";
		g < r && (e += qd(r - g));
		e != o && Va(a.doc, e, U(d, 0), U(d, o.length), "+input");
		m.stateAfter = null
	}
	function Ta(a, d, e) {
		var g = d,
		j = d,
		k = a.doc;
		"number" == typeof d ? j = ga(k, Math.max(k.first, Math.min(d, k.first + k.size - 1))) : g = Sa(d);
		if (null != g && e(j, g)) fa(a, g, g + 1);
		else return null;
		return j
	}
	function Ba(a, d, e, g, j) {
		function k(d) {
			var g = (j ? Ec: rd)(n, m, e, !0);
			if (null == g) {
				if (d = !d) d = l + e,
				d < a.first || d >= a.first + a.size ? d = o = !1 : (l = d, d = n = ga(a, d));
				if (d) m = j ? (0 > e ? ic: hc)(n) : 0 > e ? n.text.length: 0;
				else return o = !1
			} else m = g;
			return ! 0
		}
		var l = d.line,
		m = d.ch,
		n = ga(a, l),
		o = !0;
		if ("char" == g) k();
		else if ("column" == g) k(!0);
		else if ("word" == g) for (d = !1; ! (0 > e) || k();) {
			if (oc(n.text.charAt(m))) d = !0;
			else if (d) {
				0 > e && (e = 1, k());
				break
			}
			if (0 < e && !k()) break
		}
		d = pb(a, U(l, m), e, !0);
		o || (d.hitSide = !0);
		return d
	}
	function sd(a, d, e, g) {
		var j = a.doc,
		k = d.left,
		l;
		"page" == g ? (g = Math.min(a.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight), l = d.top + e * g) : "line" == g && (l = 0 < e ? d.bottom + 3 : d.top - 3);
		for (;;) {
			var m = Y(a, k, l);
			if (!m.outside) break;
			if (0 > e ? 0 >= l: l >= j.height) {
				m.hitSide = !0;
				break
			}
			l += 5 * e
		}
		return m
	}
	function hd(a, d) {
		var e = d.ch,
		g = d.ch;
		if (a) { ! 1 === d.after || g == a.length ? --e: ++g;
			for (var j = a.charAt(e), j = oc(j) ? oc: /\s/.test(j) ?
			function(a) {
				return /\s/.test(a)
			}: function(a) {
				return ! /\s/.test(a) && !oc(a)
			}; 0 < e && j(a.charAt(e - 1));)--e;
			for (; g < a.length && j(a.charAt(g));)++g
		}
		return {
			from: U(d.line, e),
			to: U(d.line, g)
		}
	}
	function ta(d, e, g, j) {
		a.defaults[d] = e;
		g && (yb[d] = j ?
		function(a, d, e) {
			e != ad && g(a, d, e)
		}: g)
	}
	function Cb(a, d) {
		if (!0 === d) return d;
		if (a.copyState) return a.copyState(d);
		var e = {},
		g;
		for (g in d) {
			var j = d[g];
			j instanceof Array && (j = j.concat([]));
			e[g] = j
		}
		return e
	}
	function fd(a, d, e) {
		return a.startState ? a.startState(d, e) : !0
	}
	function Ic(a) {
		return "string" == typeof a ? jb[a] : a
	}
	function Rb(a, d, e) {
		function g(d) {
			d = Ic(d);
			var j = d[a];
			if (!1 === j) return "stop";
			if (null != j && e(j)) return ! 0;
			if (d.nofallthrough) return "stop";
			d = d.fallthrough;
			if (null == d) return ! 1;
			if ("[object Array]" != Object.prototype.toString.call(d)) return g(d);
			for (var j = 0,
			k = d.length; j < k; ++j) {
				var l = g(d[j]);
				if (l) return l
			}
			return ! 1
		}
		for (var j = 0; j < d.length; ++j) {
			var k = g(d[j]);
			if (k) return k
		}
	}
	function ld(a) {
		a = vb[a.keyCode];
		return "Ctrl" == a || "Alt" == a || "Shift" == a || "Mod" == a
	}
	function md(a, d) {
		var e = vb[a.keyCode];
		if (null == e || a.altGraphKey) return ! 1;
		a.altKey && (e = "Alt-" + e);
		if (td ? a.metaKey: a.ctrlKey) e = "Ctrl-" + e;
		if (td ? a.ctrlKey: a.metaKey) e = "Cmd-" + e; ! d && a.shiftKey && (e = "Shift-" + e);
		return e
	}
	function Sb(a, d) {
		this.pos = this.start = 0;
		this.string = a;
		this.tabSize = d || 8
	}
	function wb(a, d) {
		this.lines = [];
		this.type = d;
		this.doc = a
	}
	function Tb(a, d, e, g, j) {
		if (g && g.shared) {
			var k = g,
			k = pc(k);
			k.shared = !1;
			var l = [Tb(a, d, e, k, j)],
			m = l[0];
			Ib(a,
			function(a) {
				l.push(Tb(a, da(a, d), da(a, e), k, j));
				for (var g = 0; g < a.linked.length; ++g) if (a.linked[g].isParent) return;
				m = Ka(l)
			});
			return new Ub(l, m)
		}
		if (a.cm && !a.cm.curOp) return P(a.cm, Tb)(a, d, e, g, j);
		var n = new wb(a, j);
		if ("range" == j && !la(d, e)) return n;
		g && pc(g, n);
		n.replacedWith && (n.collapsed = !0, n.replacedWith = aa("span", [n.replacedWith], "CodeMirror-widget"));
		n.collapsed && (Qb = !0);
		var o = d.line,
		r = 0,
		s, v, u = a.cm,
		z;
		a.iter(o, e.line + 1,
		function(g) {
			u && (n.collapsed && !u.options.lineWrapping && zb(a, g) == u.display.maxLine) && (z = !0);
			var j = {
				from: null,
				to: null,
				marker: n
			};
			r += g.text.length;
			o == d.line && (j.from = d.ch, r -= d.ch);
			o == e.line && (j.to = e.ch, r -= g.text.length - e.ch);
			n.collapsed && (o == e.line && (v = rb(g, e.ch)), o == d.line ? s = rb(g, d.ch) : ab(g, 0));
			g.markedSpans = g.markedSpans ? g.markedSpans.concat([j]) : [j];
			j.marker.attachLine(g); ++o
		});
		n.collapsed && a.iter(d.line, e.line + 1,
		function(d) {
			qb(a, d) && ab(d, 0)
		});
		n.readOnly && (nd = !0, (a.history.done.length || a.history.undone.length) && a.clearHistory());
		if (n.collapsed) {
			if (s != v) throw Error("Inserting collapsed marker overlapping an existing one");
			n.size = r;
			n.atomic = !0
		}
		u && (z && (u.curOp.updateMaxLine = !0), (n.className || n.startStyle || n.endStyle || n.collapsed) && fa(u, d.line, e.line + 1), n.atomic && Jb(u));
		return n
	}
	function Ub(a, d) {
		this.markers = a;
		this.primary = d;
		for (var e = 0,
		g = this; e < a.length; ++e) a[e].parent = this,
		na(a[e], "clear",
		function() {
			g.clear()
		})
	}
	function Vb(a, d) {
		if (a) for (var e = 0; e < a.length; ++e) {
			var g = a[e];
			if (g.marker == d) return g
		}
	}
	function Mc(a, d) {
		var e = Fa(a, d.from.line) && ga(a, d.from.line).markedSpans,
		g = Fa(a, d.to.line) && ga(a, d.to.line).markedSpans;
		if (!e && !g) return null;
		var j = d.from.ch,
		k = d.to.ch,
		l = xa(d.from, d.to);
		if (e) for (var m = 0,
		n; m < e.length; ++m) {
			var o = e[m],
			r = o.marker;
			if (null == o.from || (r.inclusiveLeft ? o.from <= j: o.from < j) || "bookmark" == r.type && o.from == j && (!l || !o.marker.insertLeft)) {
				var s = null == o.to || (r.inclusiveRight ? o.to >= j: o.to > j); (n || (n = [])).push({
					from: o.from,
					to: s ? null: o.to,
					marker: r
				})
			}
		}
		e = n;
		if (g) for (var m = 0,
		v; m < g.length; ++m) if (n = g[m], o = n.marker, null == n.to || (o.inclusiveRight ? n.to >= k: n.to > k) || "bookmark" == o.type && n.from == k && (!l || n.marker.insertLeft)) r = null == n.from || (o.inclusiveLeft ? n.from <= k: n.from < k),
		(v || (v = [])).push({
			from: r ? null: n.from - k,
			to: null == n.to ? null: n.to - k,
			marker: o
		});
		g = v;
		l = 1 == d.text.length;
		v = Ka(d.text).length + (l ? j: 0);
		if (e) for (k = 0; k < e.length; ++k) m = e[k],
		null == m.to && ((n = Vb(g, m.marker)) ? l && (m.to = null == n.to ? null: n.to + v) : m.to = j);
		if (g) for (k = 0; k < g.length; ++k) m = g[k],
		null != m.to && (m.to += v),
		null == m.from ? (n = Vb(e, m.marker), n || (m.from = v, l && (e || (e = [])).push(m))) : (m.from += v, l && (e || (e = [])).push(m));
		j = [e];
		if (!l) {
			var l = d.text.length - 2,
			u;
			if (0 < l && e) for (k = 0; k < e.length; ++k) null == e[k].to && (u || (u = [])).push({
				from: null,
				to: null,
				marker: e[k].marker
			});
			for (k = 0; k < l; ++k) j.push(u);
			j.push(g)
		}
		return j
	}
	function pd(a, d) {
		var e;
		if (e = d["spans_" + a.id]) {
			for (var g = 0,
			j = []; g < d.text.length; ++g) j.push(Yd(e[g]));
			e = j
		} else e = null;
		g = Mc(a, d);
		if (!e) return g;
		if (!g) return e;
		for (j = 0; j < e.length; ++j) {
			var k = e[j],
			l = g[j];
			if (k && l) {
				var m = 0;
				a: for (; m < l.length; ++m) {
					for (var n = l[m], o = 0; o < k.length; ++o) if (k[o].marker == n.marker) continue a;
					k.push(n)
				}
			} else l && (e[j] = l)
		}
		return e
	}
	function rb(a, d) {
		var e = Qb && a.markedSpans,
		g;
		if (e) for (var j, k = 0; k < e.length; ++k) if (j = e[k], j.marker.collapsed && (null == j.from || j.from < d) && (null == j.to || j.to > d) && (!g || g.width < j.marker.width)) g = j.marker;
		return g
	}
	function Pb(a) {
		return rb(a, a.text.length + 1)
	}
	function zb(a, d) {
		for (var e; e = rb(d, -1);) d = ga(a, e.find().from.line);
		return d
	}
	function qb(a, d) {
		var e = Qb && d.markedSpans;
		if (e) for (var g, j = 0; j < e.length; ++j) if (g = e[j], g.marker.collapsed && (null == g.from || 0 == g.from && g.marker.inclusiveLeft && Oc(a, d, g))) return ! 0
	}
	function Oc(a, d, e) {
		if (null == e.to) return d = e.marker.find().to,
		d = ga(a, d.line),
		Oc(a, d, Vb(d.markedSpans, e.marker));
		if (e.marker.inclusiveRight && e.to == d.text.length) return ! 0;
		for (var g, j = 0; j < d.markedSpans.length; ++j) if (g = d.markedSpans[j], g.marker.collapsed && g.from == e.to && (g.marker.inclusiveLeft || e.marker.inclusiveRight) && Oc(a, d, g)) return ! 0
	}
	function ud(a) {
		var d = a.markedSpans;
		if (d) {
			for (var e = 0; e < d.length; ++e) d[e].marker.detachLine(a);
			a.markedSpans = null
		}
	}
	function vd(a, d) {
		if (d) {
			for (var e = 0; e < d.length; ++e) d[e].marker.attachLine(a);
			a.markedSpans = d
		}
	}
	function wd(a) {
		return function() {
			var d = !this.cm.curOp;
			d && M(this.cm);
			try {
				var e = a.apply(this, arguments)
			} finally {
				d && ja(this.cm)
			}
			return e
		}
	}
	function gc(a) {
		if (null != a.height) return a.height; (!a.node.parentNode || 1 != a.node.parentNode.nodeType) && hb(a.cm.display.measure, aa("div", [a.node], null, "position: relative"));
		return a.height = a.node.offsetHeight
	}
	function Wb(a, d, e) {
		a = {
			text: a
		};
		vd(a, d);
		a.height = e ? e(a) : 1;
		return a
	}
	function Kb(a, d, e, g) {
		a.text = d;
		a.stateAfter && (a.stateAfter = null);
		a.styles && (a.styles = null);
		null != a.order && (a.order = null);
		ud(a);
		vd(a, e);
		d = g ? g(a) : 1;
		d != a.height && ab(a, d);
		bb(a, "change")
	}
	function xd(a, d, e, g, j) {
		var k = a.options.flattenSpans,
		l = "",
		m = null;
		a = new Sb(d, a.options.tabSize);
		for ("" == d && e.blankLine && e.blankLine(g); ! a.eol();) {
			var n = e.token(a, g);
			5E3 < a.pos && (k = !1, a.pos = Math.min(d.length, a.start + 5E4), n = null);
			var o = a.current();
			a.start = a.pos; ! k || m != n ? (l && j(l, m), l = o, m = n) : l += o
		}
		l && j(l, m)
	}
	function dd(a, d, e) {
		var g = [a.state.modeGen];
		xd(a, d.text, a.doc.mode, e,
		function(a, d) {
			g.push(a, d)
		});
		for (e = 0; e < a.state.overlays.length; ++e) {
			var j = a.state.overlays[e],
			k = 1;
			xd(a, d.text, j.mode, !0,
			function(a, d) {
				for (var e = k,
				l = a.length; l;) {
					var m = g[k],
					n = m.length;
					n <= l ? l -= n: (g.splice(k, 1, m.slice(0, l), g[k + 1], m.slice(l)), l = 0);
					k += 2
				}
				if (d) if (j.opaque) g.splice(e, k - e, a, d),
				k = e + 2;
				else for (; e < k; e += 2) m = g[e + 1],
				g[e + 1] = m ? m + " " + d: d
			})
		}
		return g
	}
	function ed(a, d, e) {
		var g = a.doc.mode;
		a = new Sb(d.text, a.options.tabSize);
		for ("" == d.text && g.blankLine && g.blankLine(e); ! a.eol() && 5E3 >= a.pos;) g.token(a, e),
		a.start = a.pos
	}
	function yd(a) {
		return ! a ? null: zd[a] || (zd[a] = "cm-" + a.replace(/ +/g, " cm-"))
	}
	function cd(a, d, e) {
		for (var g, j = d,
		k, l, m = !0; g = rb(j, -1);) m = !1,
		j = ga(a.doc, g.find().from.line),
		k || (k = j);
		g = {
			pre: aa("pre"),
			col: 0,
			pos: 0,
			display: !e,
			measure: null,
			addedOne: !1,
			cm: a
		};
		j.textClass && (g.pre.className = j.textClass);
		do {
			g.measure = j == d && e;
			g.pos = 0;
			g.addToken = g.measure ? Zd: Ad;
			e && (l && j != d && !g.addedOne) && (e[0] = g.pre.appendChild(Pc(a.display.measure)), g.addedOne = !0);
			var n = j;
			l = g;
			var o = j;
			if (!o.styles || o.styles[0] != a.state.modeGen) o.styles = dd(a, o, o.stateAfter = J(a, Sa(o)));
			a: {
				var r = n,
				o = o.styles;
				if (n = r.markedSpans) for (var r = r.text.length,
				s = 0,
				v = 1,
				u = "",
				z = void 0,
				B = 0,
				D = void 0,
				E = void 0,
				F = void 0,
				C = void 0;;) {
					if (B == s) {
						for (var D = E = F = "",
						C = null,
						B = Infinity,
						I = null,
						Ba = 0; Ba < n.length; ++Ba) {
							var H = n[Ba],
							Aa = H.marker;
							if (H.from <= s && (null == H.to || H.to > s)) {
								if (null != H.to && B > H.to && (B = H.to, E = ""), Aa.className && (D += " " + Aa.className), Aa.startStyle && H.from == s && (F += " " + Aa.startStyle), Aa.endStyle && H.to == B && (E += " " + Aa.endStyle), Aa.collapsed && (!C || C.marker.width < Aa.width)) C = H
							} else H.from > s && B > H.from && (B = H.from);
							"bookmark" == Aa.type && (H.from == s && Aa.replacedWith) && (I = Aa.replacedWith)
						}
						if (C && (C.from || 0) == s) if (Bd(l, (null == C.to ? r: C.to) - s, null != C.from && C.marker.replacedWith), null == C.to) {
							o = C.marker.find();
							break a
						}
						I && !C && Bd(l, 0, I)
					}
					if (s >= r) break;
					for (I = Math.min(r, B);;) {
						if (u) {
							Ba = s + u.length;
							C || (H = Ba > I ? u.slice(0, I - s) : u, l.addToken(l, H, z ? z + D: D, F, s + H.length == B ? E: ""));
							if (Ba >= I) {
								u = u.slice(I - s);
								s = I;
								break
							}
							s = Ba;
							F = ""
						}
						u = o[v++];
						z = yd(o[v++])
					}
				} else for (var v = 1; v < o.length; v += 2) l.addToken(l, o[v], yd(o[v + 1]));
				o = void 0
			}
			l = j == k;
			o && (j = ga(a.doc, o.to.line), m = !1)
		} while ( o );
		e && !g.addedOne && (e[0] = g.pre.appendChild(m ? aa("span", "\u00a0") : Pc(a.display.measure))); ! g.pre.firstChild && !qb(a.doc, d) && g.pre.appendChild(document.createTextNode("\u00a0"));
		var G;
		if (e && Qa && (G = cb(j))) if (j = G.length - 1, G[j].from == G[j].to && --j, d = G[j], G = G[j - 1], d.from + 1 == d.to && (G && d.level < G.level) && (e = e[g.pos - 1])) e.parentNode.insertBefore(e.measureRight = Pc(a.display.measure), e.nextSibling);
		return g.pre
	}
	function Ad(a, d, e, g, j) {
		if (d) {
			if (Qc.test(d)) for (var k = document.createDocumentFragment(), l = 0;;) {
				Qc.lastIndex = l;
				var m = Qc.exec(d),
				n = m ? m.index - l: d.length - l;
				n && (k.appendChild(document.createTextNode(d.slice(l, l + n))), a.col += n);
				if (!m) break;
				l += n + 1;
				"\t" == m[0] ? (m = a.cm.options.tabSize, m -= a.col % m, k.appendChild(aa("span", qd(m), "cm-tab")), a.col += m) : (n = aa("span", "\u2022", "cm-invalidchar"), n.title = "\\u" + m[0].charCodeAt(0).toString(16), k.appendChild(n), a.col += 1)
			} else {
				a.col += d.length;
				var k = document.createTextNode(d)
			}
			if (e || g || j || a.measure) return d = e || "",
			g && (d += g),
			j && (d += j),
			a.pre.appendChild(aa("span", [k], d));
			a.pre.appendChild(k)
		}
	}
	function Zd(a, d, e, g, j) {
		for (var k = 0; k < d.length; ++k) {
			var l = d.charAt(k),
			m = 0 == k;
			"\ud800" <= l && "\udbff" > l && k < d.length - 1 ? (l = d.slice(k, k + 2), ++k) : k && (a.cm.options.lineWrapping && qc.test(d.slice(k - 1, k + 1))) && a.pre.appendChild(aa("wbr"));
			a.measure[a.pos] = Ad(a, l, e, m && g, k == d.length - 1 && j);
			a.pos += l.length
		}
		d.length && (a.addedOne = !0)
	}
	function Bd(a, d, e) {
		e && (a.display || (e = e.cloneNode(!0)), a.pre.appendChild(e), a.measure && d && (a.measure[a.pos] = e, a.addedOne = !0));
		a.pos += d
	}
	function Nc(a, d, e, g, j) {
		var k = d.from,
		l = d.to,
		m = d.text,
		n = ga(a, k.line),
		o = ga(a, l.line),
		r = Ka(m),
		s = e ? e[m.length - 1] : null,
		v = l.line - k.line;
		if (0 == k.ch && 0 == l.ch && "" == r) {
			for (var u = 0,
			z = m.length - 1,
			B = []; u < z; ++u) B.push(Wb(m[u], e ? e[u] : null, j));
			Kb(o, o.text, s, j);
			v && a.remove(k.line, v);
			B.length && a.insert(k.line, B)
		} else if (n == o) if (1 == m.length) Kb(n, n.text.slice(0, k.ch) + r + n.text.slice(l.ch), s, j);
		else {
			B = [];
			u = 1;
			for (z = m.length - 1; u < z; ++u) B.push(Wb(m[u], e ? e[u] : null, j));
			B.push(Wb(r + n.text.slice(l.ch), s, j));
			Kb(n, n.text.slice(0, k.ch) + m[0], e ? e[0] : null, j);
			a.insert(k.line + 1, B)
		} else if (1 == m.length) Kb(n, n.text.slice(0, k.ch) + m[0] + o.text.slice(l.ch), e ? e[0] : null, j),
		a.remove(k.line + 1, v);
		else {
			Kb(n, n.text.slice(0, k.ch) + m[0], e ? e[0] : null, j);
			Kb(o, r + o.text.slice(l.ch), s, j);
			u = 1;
			z = m.length - 1;
			for (B = []; u < z; ++u) B.push(Wb(m[u], e ? e[u] : null, j));
			1 < v && a.remove(k.line + 1, v - 1);
			a.insert(k.line + 1, B)
		}
		bb(a, "change", a, d);
		Ja(a, g.anchor, g.head, null, !0)
	}
	function rc(a) {
		this.lines = a;
		this.parent = null;
		for (var d = 0,
		e = a.length,
		g = 0; d < e; ++d) a[d].parent = this,
		g += a[d].height;
		this.height = g
	}
	function Xb(a) {
		this.children = a;
		for (var d = 0,
		e = 0,
		g = 0,
		j = a.length; g < j; ++g) {
			var k = a[g],
			d = d + k.chunkSize(),
			e = e + k.height;
			k.parent = this
		}
		this.size = d;
		this.height = e;
		this.parent = null
	}
	function Ib(a, d, e) {
		function g(a, j, k) {
			if (a.linked) for (var l = 0; l < a.linked.length; ++l) {
				var m = a.linked[l];
				if (m.doc != j) {
					var n = k && m.sharedHist;
					if (!e || n) d(m.doc, n),
					g(m.doc, a, n)
				}
			}
		}
		g(a, null, !0)
	}
	function Zc(a, d) {
		if (d.cm) throw Error("This document is already in use.");
		a.doc = d;
		d.cm = a;
		g(a);
		e(a);
		a.options.lineWrapping || n(a);
		a.options.mode = d.modeOption;
		fa(a)
	}
	function ga(a, d) {
		for (d -= a.first; ! a.lines;) for (var e = 0;; ++e) {
			var g = a.children[e],
			j = g.chunkSize();
			if (d < j) {
				a = g;
				break
			}
			d -= j
		}
		return a.lines[d]
	}
	function Cd(a, d, e) {
		var g = [],
		j = d.line;
		a.iter(d.line, e.line + 1,
		function(a) {
			a = a.text;
			j == e.line && (a = a.slice(0, e.ch));
			j == d.line && (a = a.slice(d.ch));
			g.push(a); ++j
		});
		return g
	}
	function Rc(a, d, e) {
		var g = [];
		a.iter(d, e,
		function(a) {
			g.push(a.text)
		});
		return g
	}
	function ab(a, d) {
		for (var e = d - a.height,
		g = a; g; g = g.parent) g.height += e
	}
	function Sa(a) {
		if (null == a.parent) return null;
		var d = a.parent;
		a = ib(d.lines, a);
		for (var e = d.parent; e; d = e, e = e.parent) for (var g = 0; e.children[g] != d; ++g) a += e.children[g].chunkSize();
		return a + d.first
	}
	function fc(a, d) {
		var e = a.first;
		a: do {
			for (var g = 0,
			j = a.children.length; g < j; ++g) {
				var k = a.children[g],
				l = k.height;
				if (d < l) {
					a = k;
					continue a
				}
				d -= l;
				e += k.chunkSize()
			}
			return e
		} while (! a . lines );
		g = 0;
		for (j = a.lines.length; g < j; ++g) {
			k = a.lines[g].height;
			if (d < k) break;
			d -= k
		}
		return e + g
	}
	function Bb(a, d) {
		d = zb(a.doc, d);
		for (var e = 0,
		g = d.parent,
		j = 0; j < g.lines.length; ++j) {
			var k = g.lines[j];
			if (k == d) break;
			else e += k.height
		}
		for (k = g.parent; k; g = k, k = g.parent) for (j = 0; j < k.children.length; ++j) {
			var l = k.children[j];
			if (l == g) break;
			else e += l.height
		}
		return e
	}
	function cb(a) {
		var d = a.order;
		null == d && (d = a.order = Dd(a.text));
		return d
	}
	function sc() {
		return {
			done: [],
			undone: [],
			undoDepth: Infinity,
			lastTime: 0,
			lastOp: null,
			lastOrigin: null,
			dirtyCounter: 0
		}
	}
	function Ed(a, d, e, g) {
		var j = d["spans_" + a.id],
		k = 0;
		a.iter(Math.max(a.first, e), Math.min(a.first + a.size, g),
		function(e) {
			e.markedSpans && ((j || (j = d["spans_" + a.id] = {}))[k] = e.markedSpans); ++k
		})
	}
	function Lc(a, d) {
		var e = {
			from: d.from,
			to: ya(d),
			text: Cd(a, d.from, d.to)
		};
		Ed(a, e, d.from.line, d.to.line + 1);
		Ib(a,
		function(a) {
			Ed(a, e, d.from.line, d.to.line + 1)
		},
		!0);
		return e
	}
	function Yd(a) {
		if (!a) return null;
		for (var d = 0,
		e; d < a.length; ++d) a[d].marker.explicitlyCleared ? e || (e = a.slice(0, d)) : e && e.push(a[d]);
		return ! e ? a: e.length ? e: null
	}
	function tc(a, d) {
		for (var e = 0,
		g = []; e < a.length; ++e) {
			var j = a[e],
			k = j.changes,
			l = [];
			g.push({
				changes: l,
				anchorBefore: j.anchorBefore,
				headBefore: j.headBefore,
				anchorAfter: j.anchorAfter,
				headAfter: j.headAfter
			});
			for (j = 0; j < k.length; ++j) {
				var m = k[j],
				n;
				l.push({
					from: m.from,
					to: m.to,
					text: m.text
				});
				if (d) for (var o in m) if ((n = o.match(/^spans_(\d+)$/)) && -1 < ib(d, Number(n[1]))) Ka(l)[o] = m[o],
				delete m[o]
			}
		}
		return g
	}
	function uc(a, d, e, g) {
		e < a.line ? a.line += g: d < a.line && (a.line = d, a.ch = 0)
	}
	function Fd(a, d, e, g) {
		for (var j = 0; j < a.length; ++j) {
			for (var k = a[j], l = !0, m = 0; m < k.changes.length; ++m) {
				var n = k.changes[m];
				k.copied || (n.from = Na(n.from), n.to = Na(n.to));
				if (e < n.from.line) n.from.line += g,
				n.to.line += g;
				else if (d <= n.to.line) {
					l = !1;
					break
				}
			}
			k.copied || (k.anchorBefore = Na(k.anchorBefore), k.headBefore = Na(k.headBefore), k.anchorAfter = Na(k.anchorAfter), k.readAfter = Na(k.headAfter), k.copied = !0);
			l ? (uc(k.anchorBefore), uc(k.headBefore), uc(k.anchorAfter), uc(k.headAfter)) : (a.splice(0, j + 1), j = 0)
		}
	}
	function od(a, d) {
		var e = d.from.line,
		g = d.to.line,
		j = d.text.length - (g - e) - 1;
		Fd(a.done, e, g, j);
		Fd(a.undone, e, g, j)
	}
	function $d() {
		cc(this)
	}
	function Ob(a) {
		a.stop || (a.stop = $d);
		return a
	}
	function Ha(a) {
		a.preventDefault ? a.preventDefault() : a.returnValue = !1
	}
	function Gd(a) {
		a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0
	}
	function cc(a) {
		Ha(a);
		Gd(a)
	}
	function id(a) {
		var d = a.which;
		null == d && (a.button & 1 ? d = 1 : a.button & 2 ? d = 3 : a.button & 4 && (d = 2));
		Ab && (a.ctrlKey && 1 == d) && (d = 3);
		return d
	}
	function na(a, d, e) {
		a.addEventListener ? a.addEventListener(d, e, !1) : a.attachEvent ? a.attachEvent("on" + d, e) : (a = a._handlers || (a._handlers = {}), (a[d] || (a[d] = [])).push(e))
	}
	function fb(a, d, e) {
		if (a.removeEventListener) a.removeEventListener(d, e, !1);
		else if (a.detachEvent) a.detachEvent("on" + d, e);
		else if (a = a._handlers && a._handlers[d]) for (d = 0; d < a.length; ++d) if (a[d] == e) {
			a.splice(d, 1);
			break
		}
	}
	function Ra(a, d) {
		var e = a._handlers && a._handlers[d];
		if (e) for (var g = Array.prototype.slice.call(arguments, 2), j = 0; j < e.length; ++j) e[j].apply(null, g)
	}
	function bb(a, d) {
		function e(a) {
			return function() {
				a.apply(null, j)
			}
		}
		var g = a._handlers && a._handlers[d];
		if (g) {
			var j = Array.prototype.slice.call(arguments, 2);
			nb || (++jc, nb = [], setTimeout(ae, 0));
			for (var k = 0; k < g.length; ++k) nb.push(e(g[k]))
		}
	}
	function ae() {--jc;
		var a = nb;
		nb = null;
		for (var d = 0; d < a.length; ++d) a[d]()
	}
	function Gb(a, d) {
		var e = a._handlers && a._handlers[d];
		return e && 0 < e.length
	}
	function zc() {
		this.id = null
	}
	function Db(a, d, e) {
		null == d && (d = a.search(/[^\s\u00a0]/), -1 == d && (d = a.length));
		for (var g = 0,
		j = 0; g < d; ++g)"\t" == a.charAt(g) ? j += e - j % e: ++j;
		return j
	}
	function qd(a) {
		for (; vc.length <= a;) vc.push(Ka(vc) + " ");
		return vc[a]
	}
	function Ka(a) {
		return a[a.length - 1]
	}
	function $c(a) {
		bc ? (a.selectionStart = 0, a.selectionEnd = a.value.length) : a.select()
	}
	function ib(a, d) {
		if (a.indexOf) return a.indexOf(d);
		for (var e = 0,
		g = a.length; e < g; ++e) if (a[e] == d) return e;
		return - 1
	}
	function pc(a, d) {
		d || (d = {});
		for (var e in a) a.hasOwnProperty(e) && (d[e] = a[e]);
		return d
	}
	function gd(a) {
		for (var d = [], e = 0; e < a; ++e) d.push(void 0);
		return d
	}
	function Xa(a) {
		var d = Array.prototype.slice.call(arguments, 1);
		return function() {
			return a.apply(null, d)
		}
	}
	function oc(a) {
		return /\w/.test(a) || "\u0080" < a && (a.toUpperCase() != a.toLowerCase() || be.test(a))
	}
	function Hd(a) {
		for (var d in a) if (a.hasOwnProperty(d) && a[d]) return ! 1;
		return ! 0
	}
	function aa(a, d, e, g) {
		a = document.createElement(a);
		e && (a.className = e);
		g && (a.style.cssText = g);
		if ("string" == typeof d) bd(a, d);
		else if (d) for (e = 0; e < d.length; ++e) a.appendChild(d[e]);
		return a
	}
	function dc(a) {
		if (Qa) for (; a.firstChild;) a.removeChild(a.firstChild);
		else a.innerHTML = "";
		return a
	}
	function hb(a, d) {
		return dc(a).appendChild(d)
	}
	function bd(a, d) {
		sb ? (a.innerHTML = "", a.appendChild(document.createTextNode(d))) : a.textContent = d
	}
	function Ea(a) {
		return a.getBoundingClientRect()
	}
	function ec(a) {
		if (null != wc) return wc;
		var d = aa("div", null, null, "width: 50px; height: 50px; overflow-x: scroll");
		hb(a, d);
		d.offsetWidth && (wc = d.offsetHeight - d.clientHeight);
		return wc || 0
	}
	function Pc(a) {
		if (null == Sc) {
			var d = aa("span", "\u200b");
			hb(a, aa("span", [d, document.createTextNode("x")]));
			0 != a.firstChild.offsetHeight && (Sc = 1 >= d.offsetWidth && 2 < d.offsetHeight && !xb)
		}
		return Sc ? aa("span", "\u200b") : aa("span", "\u00a0", null, "display: inline-block; width: 1px; margin-right: -1px")
	}
	function Tc(a) {
		return a.level % 2 ? a.from: a.to
	}
	function hc(a) {
		return (a = cb(a)) ? a[0].level % 2 ? a[0].to: a[0].from: 0
	}
	function ic(a) {
		var d = cb(a);
		return ! d ? a.text.length: Tc(Ka(d))
	}
	function Id(a, d) {
		var e = ga(a.doc, d),
		g = zb(a.doc, e);
		g != e && (d = Sa(g));
		e = cb(g);
		g = !e ? 0 : e[0].level % 2 ? ic(g) : hc(g);
		return U(d, g)
	}
	function ce(a, d) {
		for (var e, g; e = Pb(g = ga(a.doc, d));) d = e.find().to.line;
		e = cb(g);
		g = !e ? g.text.length: e[0].level % 2 ? hc(g) : ic(g);
		return U(d, g)
	}
	function Ec(a, d, e, g) {
		var j = cb(a);
		if (!j) return rd(a, d, e, g);
		g = g ?
		function(d, e) {
			do d += e;
			while (0 < d && Fc.test(a.text.charAt(d)));
			return d
		}: function(a, d) {
			return a + d
		};
		for (var k = j[0].level, l = 0; l < j.length; ++l) {
			var m = j[l],
			n = m.level % 2 == k;
			if (m.from < d && m.to > d || n && (m.from == d || m.to == d)) break
		}
		for (d = g(d, m.level % 2 ? -e: e); null != d;) if (m.level % 2 == k) if (d < m.from || d > m.to) d = (m = j[l += e]) && (0 < e == m.level % 2 ? g(m.to, -1) : g(m.from, 1));
		else break;
		else if (d == (m.level % 2 ? m.to: m.from)) d = (m = j[--l]) && Tc(m);
		else if (d == Tc(m)) d = (m = j[++l]) && (m.level % 2 ? m.to: m.from);
		else break;
		return 0 > d || d > a.text.length ? null: d
	}
	function rd(a, d, e, g) {
		d += e;
		if (g) for (; 0 < d && Fc.test(a.text.charAt(d));) d += e;
		return 0 > d || d > a.text.length ? null: d
	}
	var Hb = /gecko\/\d/i.test(navigator.userAgent),
	Qa = /MSIE \d/.test(navigator.userAgent),
	xb = Qa && (null == document.documentMode || 8 > document.documentMode),
	sb = Qa && (null == document.documentMode || 9 > document.documentMode),
	eb = /WebKit\//.test(navigator.userAgent),
	de = eb && /Qt\/\d+\.\d+/.test(navigator.userAgent),
	Jd = /Chrome\//.test(navigator.userAgent),
	gb = /Opera\//.test(navigator.userAgent),
	Cc = /Apple Computer/.test(navigator.vendor),
	yc = /KHTML\//.test(navigator.userAgent),
	Td = /Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),
	Ud = /Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),
	Wd = /PhantomJS/.test(navigator.userAgent),
	bc = /AppleWebKit/.test(navigator.userAgent) && /Mobile\/\w+/.test(navigator.userAgent),
	Ac = bc || /Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),
	Ab = bc || /Mac/.test(navigator.platform),
	ee = /windows/i.test(navigator.platform),
	Yb = gb && navigator.userAgent.match(/Version\/(\d*\.\d*)/);
	Yb && (Yb = Number(Yb[1]));
	var td = Ab && (de || gb && (null == Yb || 12.11 > Yb)),
	Bc = Hb || Qa && !sb,
	nd = !1,
	Qb = !1,
	tb,
	Vd = 0,
	mc,
	lc,
	nc = 0,
	Ya = null;
	Qa ? Ya = -0.53 : Hb ? Ya = 15 : Jd ? Ya = -0.7 : Cc && (Ya = -1 / 3);
	var kd, Jc = null,
	Kc;
	a.Pos = U;
	a.prototype = {
		focus: function() {
			window.focus();
			S(this);
			sa(this);
			ia(this)
		},
		setOption: function(a, d) {
			var e = this.options,
			g = e[a];
			e[a] == d && "mode" != a || (e[a] = d, yb.hasOwnProperty(a) && P(this, yb[a])(this, d, g))
		},
		getOption: function(a) {
			return this.options[a]
		},
		getDoc: function() {
			return this.doc
		},
		addKeyMap: function(a) {
			this.state.keyMaps.push(a)
		},
		removeKeyMap: function(a) {
			for (var d = this.state.keyMaps,
			e = 0; e < d.length; ++e) if (("string" == typeof a ? d[e].name: d[e]) == a) return d.splice(e, 1),
			!0
		},
		addOverlay: P(null,
		function(d, e) {
			var g = d.token ? d: a.getMode(this.options, d);
			if (g.startState) throw Error("Overlays may not be stateful.");
			this.state.overlays.push({
				mode: g,
				modeSpec: d,
				opaque: e && e.opaque
			});
			this.state.modeGen++;
			fa(this)
		}),
		removeOverlay: P(null,
		function(a) {
			for (var d = this.state.overlays,
			e = 0; e < d.length; ++e) if (d[e].modeSpec == a) {
				d.splice(e, 1);
				this.state.modeGen++;
				fa(this);
				break
			}
		}),
		indentLine: P(null,
		function(a, d, e) {
			"string" != typeof d && (d = null == d ? this.options.smartIndent ? "smart": "prev": d ? "add": "subtract");
			Fa(this.doc, a) && Oa(this, a, d, e)
		}),
		indentSelection: P(null,
		function(a) {
			var d = this.doc.sel;
			if (xa(d.from, d.to)) return Oa(this, d.from.line, a);
			for (var e = d.to.line - (d.to.ch ? 0 : 1), d = d.from.line; d <= e; ++d) Oa(this, d, a)
		}),
		getTokenAt: function(a) {
			var d = this.doc;
			a = da(d, a);
			for (var e = J(this, a.line), g = this.doc.mode, d = ga(d, a.line), d = new Sb(d.text, this.options.tabSize); d.pos < a.ch && !d.eol();) {
				d.start = d.pos;
				var j = g.token(d, e)
			}
			return {
				start: d.start,
				end: d.pos,
				string: d.current(),
				className: j || null,
				type: j || null,
				state: e
			}
		},
		getStateAfter: function(a) {
			var d = this.doc;
			a = Math.max(d.first, Math.min(null == a ? d.first + d.size - 1 : a, d.first + d.size - 1));
			return J(this, a + 1)
		},
		cursorCoords: function(a, d) {
			var e;
			e = this.doc.sel;
			e = null == a ? e.head: "object" == typeof a ? da(this.doc, a) : a ? e.from: e.to;
			return ea(this, e, d || "page")
		},
		charCoords: function(a, d) {
			return R(this, da(this.doc, a), d || "page")
		},
		coordsChar: function(a) {
			var d = Ea(this.display.lineSpace);
			return Y(this, a.left - d.left - (window.pageXOffset || (document.documentElement || document.body).scrollLeft), a.top - d.top - (window.pageYOffset || (document.documentElement || document.body).scrollTop))
		},
		defaultTextHeight: function() {
			return ca(this.display)
		},
		setGutterMarker: P(null,
		function(a, d, e) {
			return Ta(this, a,
			function(a) {
				var g = a.gutterMarkers || (a.gutterMarkers = {});
				g[d] = e; ! e && Hd(g) && (a.gutterMarkers = null);
				return ! 0
			})
		}),
		clearGutter: P(null,
		function(a) {
			var d = this,
			e = d.doc,
			g = e.first;
			e.iter(function(e) {
				e.gutterMarkers && e.gutterMarkers[a] && (e.gutterMarkers[a] = null, fa(d, g, g + 1), Hd(e.gutterMarkers) && (e.gutterMarkers = null)); ++g
			})
		}),
		addLineClass: P(null,
		function(a, d, e) {
			return Ta(this, a,
			function(a) {
				var g = "text" == d ? "textClass": "background" == d ? "bgClass": "wrapClass";
				if (a[g]) {
					if (RegExp("\\b" + e + "\\b").test(a[g])) return ! 1;
					a[g] += " " + e
				} else a[g] = e;
				return ! 0
			})
		}),
		removeLineClass: P(null,
		function(a, d, e) {
			return Ta(this, a,
			function(a) {
				var g = "text" == d ? "textClass": "background" == d ? "bgClass": "wrapClass",
				j = a[g];
				if (j) if (null == e) a[g] = null;
				else {
					var k = j.replace(RegExp("^" + e + "\\b\\s*|\\s*\\b" + e + "\\b"), "");
					if (k == j) return ! 1;
					a[g] = k || null
				} else return ! 1;
				return ! 0
			})
		}),
		addLineWidget: P(null,
		function(a, d, e) {
			var g = this,
			j = new Uc(g, d, e);
			j.noHScroll && (g.display.alignWidgets = !0);
			Ta(g, a,
			function(a) { (a.widgets || (a.widgets = [])).push(j);
				j.line = a;
				if (!qb(g.doc, a) || j.showIfHidden) {
					var d = Bb(g, a) < g.display.scroller.scrollTop;
					ab(a, a.height + gc(j));
					d && (g.curOp.updateScrollPos = {
						scrollTop: g.doc.scrollTop + j.height,
						scrollLeft: g.doc.scrollLeft
					})
				}
				return ! 0
			});
			return j
		}),
		removeLineWidget: function(a) {
			a.clear()
		},
		lineInfo: function(a) {
			if ("number" == typeof a) {
				if (!Fa(this.doc, a)) return null;
				var d = a;
				a = ga(this.doc, a);
				if (!a) return null
			} else if (d = Sa(a), null == d) return null;
			return {
				line: d,
				handle: a,
				text: a.text,
				gutterMarkers: a.gutterMarkers,
				textClass: a.textClass,
				bgClass: a.bgClass,
				wrapClass: a.wrapClass,
				widgets: a.widgets
			}
		},
		getViewport: function() {
			return {
				from: this.display.showingFrom,
				to: this.display.showingTo
			}
		},
		addWidget: function(a, d, e, g, j) {
			var k = this.display;
			a = ea(this, da(this.doc, a));
			var l = a.bottom,
			m = a.left;
			d.style.position = "absolute";
			k.sizer.appendChild(d);
			if ("over" == g) l = a.top;
			else if ("above" == g || "near" == g) {
				var n = Math.max(k.wrapper.clientHeight, this.doc.height),
				o = Math.max(k.sizer.clientWidth, k.lineSpace.clientWidth); ("above" == g || a.bottom + d.offsetHeight > n) && a.top > d.offsetHeight ? l = a.top - d.offsetHeight: a.bottom + d.offsetHeight <= n && (l = a.bottom);
				m + d.offsetWidth > o && (m = o - d.offsetWidth)
			}
			d.style.top = l + k.lineSpace.offsetTop + "px";
			d.style.left = d.style.right = "";
			"right" == j ? (m = k.sizer.clientWidth - d.offsetWidth, d.style.right = "0px") : ("left" == j ? m = 0 : "middle" == j && (m = (k.sizer.clientWidth - d.offsetWidth) / 2), d.style.left = m + "px");
			e && ub(this, m, l, m + d.offsetWidth, l + d.offsetHeight)
		},
		triggerOnKeyDown: P(null, pa),
		execCommand: function(a) {
			return Hc[a](this)
		},
		findPosH: function(a, d, e, g) {
			var j = 1;
			0 > d && (j = -1, d = -d);
			var k = 0;
			for (a = da(this.doc, a); k < d && !(a = Ba(this.doc, a, j, e, g), a.hitSide); ++k);
			return a
		},
		moveH: P(null,
		function(a, d) {
			var e = this.doc.sel,
			e = e.shift || e.extend || xa(e.from, e.to) ? Ba(this.doc, e.head, a, d, this.options.rtlMoveVisually) : 0 > a ? e.from: e.to;
			Da(this.doc, e, e, a)
		}),
		deleteH: P(null,
		function(a, d) {
			var e = this.doc.sel;
			xa(e.from, e.to) ? Va(this.doc, "", e.from, Ba(this.doc, e.head, a, d, !1), "+delete") : Va(this.doc, "", e.from, e.to, "+delete");
			this.curOp.userSelChange = !0
		}),
		findPosV: function(a, d, e, g) {
			var j = 1;
			0 > d && (j = -1, d = -d);
			var k = 0;
			for (a = da(this.doc, a); k < d && !(a = ea(this, a, "div"), null == g ? g = a.left: a.left = g, a = sd(this, a, j, e), a.hitSide); ++k);
			return a
		},
		moveV: P(null,
		function(a, d) {
			var e = this.doc.sel,
			g = ea(this, e.head, "div");
			null != e.goalColumn && (g.left = e.goalColumn);
			var j = sd(this, g, a, d);
			"page" == d && (this.display.scrollbarV.scrollTop += R(this, j, "div").top - g.top);
			Da(this.doc, j, j, a);
			e.goalColumn = g.left
		}),
		toggleOverwrite: function() {
			this.display.cursor.className = (this.state.overwrite = !this.state.overwrite) ? this.display.cursor.className + " CodeMirror-overwrite": this.display.cursor.className.replace(" CodeMirror-overwrite", "")
		},
		scrollTo: P(null,
		function(a, d) {
			this.curOp.updateScrollPos = {
				scrollLeft: a,
				scrollTop: d
			}
		}),
		getScrollInfo: function() {
			var a = this.display.scroller,
			d = Nb;
			return {
				left: a.scrollLeft,
				top: a.scrollTop,
				height: a.scrollHeight - d,
				width: a.scrollWidth - d,
				clientHeight: a.clientHeight - d,
				clientWidth: a.clientWidth - d
			}
		},
		scrollIntoView: function(a) {
			"number" == typeof a && (a = U(a, 0)); ! a || null != a.line ? (a = a ? da(this.doc, a) : this.doc.sel.head, Eb(this, a)) : ub(this, a.left, a.top, a.right, a.bottom)
		},
		setSize: function(a, d) {
			function e(a) {
				return "number" == typeof a || /^\d+$/.test(String(a)) ? a + "px": a
			}
			null != a && (this.display.wrapper.style.width = e(a));
			null != d && (this.display.wrapper.style.height = e(d));
			this.refresh()
		},
		on: function(a, d) {
			na(this, a, d)
		},
		off: function(a, d) {
			fb(this, a, d)
		},
		operation: function(a) {
			return H(this, a)
		},
		refresh: P(null,
		function() {
			O(this);
			this.curOp.updateScrollPos = {
				scrollTop: this.doc.scrollTop,
				scrollLeft: this.doc.scrollLeft
			};
			fa(this)
		}),
		swapDoc: P(null,
		function(a) {
			var d = this.doc;
			d.cm = null;
			Zc(this, a);
			O(this);
			this.curOp.updateScrollPos = {
				scrollTop: a.scrollTop,
				scrollLeft: a.scrollLeft
			};
			return d
		}),
		getInputField: function() {
			return this.display.input
		},
		getWrapperElement: function() {
			return this.display.wrapper
		},
		getScrollerElement: function() {
			return this.display.scroller
		},
		getGutterElement: function() {
			return this.display.gutters
		}
	};
	var yb = a.optionHandlers = {},
	xc = a.defaults = {},
	ad = a.Init = {
		toString: function() {
			return "CodeMirror.Init"
		}
	};
	ta("value", "",
	function(a, d) {
		a.setValue(d)
	},
	!0);
	ta("mode", null,
	function(a, d) {
		a.doc.modeOption = d;
		e(a)
	},
	!0);
	ta("indentUnit", 2, e, !0);
	ta("indentWithTabs", !1);
	ta("smartIndent", !0);
	ta("tabSize", 4,
	function(a) {
		e(a);
		O(a);
		fa(a)
	},
	!0);
	ta("electricChars", !0);
	ta("rtlMoveVisually", !ee);
	ta("theme", "default",
	function(a) {
		j(a);
		k(a)
	},
	!0);
	ta("keyMap", "default",
	function(a) {
		var d = jb[a.options.keyMap].style;
		a.display.wrapper.className = a.display.wrapper.className.replace(/\s*cm-keymap-\S+/g, "") + (d ? " cm-keymap-" + d: "")
	});
	ta("extraKeys", null);
	ta("onKeyEvent", null);
	ta("onDragEvent", null);
	ta("lineWrapping", !1,
	function(a) {
		a.options.lineWrapping ? (a.display.wrapper.className += " CodeMirror-wrap", a.display.sizer.style.minWidth = "") : (a.display.wrapper.className = a.display.wrapper.className.replace(" CodeMirror-wrap", ""), n(a));
		g(a);
		fa(a);
		O(a);
		setTimeout(function() {
			r(a.display, a.doc.height)
		},
		100)
	},
	!0);
	ta("gutters", [],
	function(a) {
		o(a.options);
		k(a)
	},
	!0);
	ta("fixedGutter", !0,
	function(a, d) {
		a.display.gutters.style.left = d ? B(a.display) + "px": "0";
		a.refresh()
	},
	!0);
	ta("lineNumbers", !1,
	function(a) {
		o(a.options);
		k(a)
	},
	!0);
	ta("firstLineNumber", 1, k, !0);
	ta("lineNumberFormatter",
	function(a) {
		return a
	},
	k, !0);
	ta("showCursorWhenSelecting", !1, F, !0);
	ta("readOnly", !1,
	function(a, d) {
		"nocursor" == d ? (qa(a), a.display.input.blur()) : d || L(a, !0)
	});
	ta("dragDrop", !0);
	ta("cursorBlinkRate", 530);
	ta("cursorHeight", 1);
	ta("workTime", 100);
	ta("workDelay", 100);
	ta("flattenSpans", !0);
	ta("pollInterval", 100);
	ta("undoDepth", 40,
	function(a, d) {
		a.doc.history.undoDepth = d
	});
	ta("viewportMargin", 10,
	function(a) {
		a.refresh()
	},
	!0);
	ta("tabindex", null,
	function(a, d) {
		a.display.input.tabIndex = d || ""
	});
	ta("autofocus", null);
	var Kd = a.modes = {},
	Vc = a.mimeModes = {};
	a.defineMode = function(d, e) { ! a.defaults.mode && "null" != d && (a.defaults.mode = d);
		if (2 < arguments.length) {
			e.dependencies = [];
			for (var g = 2; g < arguments.length; ++g) e.dependencies.push(arguments[g])
		}
		Kd[d] = e
	};
	a.defineMIME = function(a, d) {
		Vc[a] = d
	};
	a.resolveMode = function(d) {
		if ("string" == typeof d && Vc.hasOwnProperty(d)) d = Vc[d];
		else if ("string" == typeof d && /^[\w\-]+\/[\w\-]+\+xml$/.test(d)) return a.resolveMode("application/xml");
		return "string" == typeof d ? {
			name: d
		}: d || {
			name: "null"
		}
	};
	a.getMode = function(d, e) {
		e = a.resolveMode(e);
		var g = Kd[e.name];
		if (!g) return a.getMode(d, "text/plain");
		g = g(d, e);
		if (Zb.hasOwnProperty(e.name)) {
			var j = Zb[e.name],
			k;
			for (k in j) j.hasOwnProperty(k) && (g.hasOwnProperty(k) && (g["_" + k] = g[k]), g[k] = j[k])
		}
		g.name = e.name;
		return g
	};
	a.defineMode("null",
	function() {
		return {
			token: function(a) {
				a.skipToEnd()
			}
		}
	});
	a.defineMIME("text/plain", "null");
	var Zb = a.modeExtensions = {};
	a.extendMode = function(a, d) {
		var e = Zb.hasOwnProperty(a) ? Zb[a] : Zb[a] = {};
		pc(d, e)
	};
	a.defineExtension = function(d, e) {
		a.prototype[d] = e
	};
	a.defineOption = ta;
	var Dc = [];
	a.defineInitHook = function(a) {
		Dc.push(a)
	};
	a.copyState = Cb;
	a.startState = fd;
	a.innerMode = function(a, d) {
		for (; a.innerMode;) {
			var e = a.innerMode(d);
			d = e.state;
			a = e.mode
		}
		return e || {
			mode: a,
			state: d
		}
	};
	var Hc = a.commands = {
		selectAll: function(a) {
			a.setSelection(U(a.firstLine(), 0), U(a.lastLine()))
		},
		killLine: function(a) {
			var d = a.getCursor(!0),
			e = a.getCursor(!1),
			g = !xa(d, e); ! g && a.getLine(d.line).length == d.ch ? a.replaceRange("", d, U(d.line + 1, 0), "+delete") : a.replaceRange("", d, g ? e: U(d.line), "+delete")
		},
		deleteLine: function(a) {
			var d = a.getCursor().line;
			a.replaceRange("", U(d, 0), U(d), "+delete")
		},
		undo: function(a) {
			a.undo()
		},
		redo: function(a) {
			a.redo()
		},
		goDocStart: function(a) {
			a.extendSelection(U(a.firstLine(), 0))
		},
		goDocEnd: function(a) {
			a.extendSelection(U(a.lastLine()))
		},
		goLineStart: function(a) {
			a.extendSelection(Id(a, a.getCursor().line))
		},
		goLineStartSmart: function(a) {
			var d = a.getCursor(),
			e = Id(a, d.line),
			g = a.getLineHandle(e.line),
			j = cb(g); ! j || 0 == j[0].level ? (g = Math.max(0, g.text.search(/\S/)), a.extendSelection(U(e.line, d.line == e.line && d.ch <= g && d.ch ? 0 : g))) : a.extendSelection(e)
		},
		goLineEnd: function(a) {
			a.extendSelection(ce(a, a.getCursor().line))
		},
		goLineUp: function(a) {
			a.moveV( - 1, "line")
		},
		goLineDown: function(a) {
			a.moveV(1, "line")
		},
		goPageUp: function(a) {
			a.moveV( - 1, "page")
		},
		goPageDown: function(a) {
			a.moveV(1, "page")
		},
		goCharLeft: function(a) {
			a.moveH( - 1, "char")
		},
		goCharRight: function(a) {
			a.moveH(1, "char")
		},
		goColumnLeft: function(a) {
			a.moveH( - 1, "column")
		},
		goColumnRight: function(a) {
			a.moveH(1, "column")
		},
		goWordLeft: function(a) {
			a.moveH( - 1, "word")
		},
		goWordRight: function(a) {
			a.moveH(1, "word")
		},
		delCharBefore: function(a) {
			a.deleteH( - 1, "char")
		},
		delCharAfter: function(a) {
			a.deleteH(1, "char")
		},
		delWordBefore: function(a) {
			a.deleteH( - 1, "word")
		},
		delWordAfter: function(a) {
			a.deleteH(1, "word")
		},
		indentAuto: function(a) {
			a.indentSelection("smart")
		},
		indentMore: function(a) {
			a.indentSelection("add")
		},
		indentLess: function(a) {
			a.indentSelection("subtract")
		},
		insertTab: function(a) {
			a.replaceSelection("\t", "end", "+input")
		},
		defaultTab: function(a) {
			a.somethingSelected() ? a.indentSelection("add") : a.replaceSelection("\t", "end", "+input")
		},
		transposeChars: function(a) {
			var d = a.getCursor(),
			e = a.getLine(d.line);
			0 < d.ch && d.ch < e.length - 1 && a.replaceRange(e.charAt(d.ch) + e.charAt(d.ch - 1), U(d.line, d.ch - 1), U(d.line, d.ch + 1))
		},
		newlineAndIndent: function(a) {
			P(a,
			function() {
				a.replaceSelection("\n", "end", "+input");
				a.indentLine(a.getCursor().line, null, !0)
			})()
		},
		toggleOverwrite: function(a) {
			a.toggleOverwrite()
		}
	},
	jb = a.keyMap = {};
	jb.basic = {
		Left: "goCharLeft",
		Right: "goCharRight",
		Up: "goLineUp",
		Down: "goLineDown",
		End: "goLineEnd",
		Home: "goLineStartSmart",
		PageUp: "goPageUp",
		PageDown: "goPageDown",
		Delete: "delCharAfter",
		Backspace: "delCharBefore",
		Tab: "defaultTab",
		"Shift-Tab": "indentAuto",
		Enter: "newlineAndIndent",
		Insert: "toggleOverwrite"
	};
	jb.pcDefault = {
		"Ctrl-A": "selectAll",
		"Ctrl-D": "deleteLine",
		"Ctrl-Z": "undo",
		"Shift-Ctrl-Z": "redo",
		"Ctrl-Y": "redo",
		"Ctrl-Home": "goDocStart",
		"Alt-Up": "goDocStart",
		"Ctrl-End": "goDocEnd",
		"Ctrl-Down": "goDocEnd",
		"Ctrl-Left": "goWordLeft",
		"Ctrl-Right": "goWordRight",
		"Alt-Left": "goLineStart",
		"Alt-Right": "goLineEnd",
		"Ctrl-Backspace": "delWordBefore",
		"Ctrl-Delete": "delWordAfter",
		"Ctrl-S": "save",
		"Ctrl-F": "find",
		"Ctrl-G": "findNext",
		"Shift-Ctrl-G": "findPrev",
		"Shift-Ctrl-F": "replace",
		"Shift-Ctrl-R": "replaceAll",
		"Ctrl-[": "indentLess",
		"Ctrl-]": "indentMore",
		fallthrough: "basic"
	};
	jb.macDefault = {
		"Cmd-A": "selectAll",
		"Cmd-D": "deleteLine",
		"Cmd-Z": "undo",
		"Shift-Cmd-Z": "redo",
		"Cmd-Y": "redo",
		"Cmd-Up": "goDocStart",
		"Cmd-End": "goDocEnd",
		"Cmd-Down": "goDocEnd",
		"Alt-Left": "goWordLeft",
		"Alt-Right": "goWordRight",
		"Cmd-Left": "goLineStart",
		"Cmd-Right": "goLineEnd",
		"Alt-Backspace": "delWordBefore",
		"Ctrl-Alt-Backspace": "delWordAfter",
		"Alt-Delete": "delWordAfter",
		"Cmd-S": "save",
		"Cmd-F": "find",
		"Cmd-G": "findNext",
		"Shift-Cmd-G": "findPrev",
		"Cmd-Alt-F": "replace",
		"Shift-Cmd-Alt-F": "replaceAll",
		"Cmd-[": "indentLess",
		"Cmd-]": "indentMore",
		fallthrough: ["basic", "emacsy"]
	};
	jb["default"] = Ab ? jb.macDefault: jb.pcDefault;
	jb.emacsy = {
		"Ctrl-F": "goCharRight",
		"Ctrl-B": "goCharLeft",
		"Ctrl-P": "goLineUp",
		"Ctrl-N": "goLineDown",
		"Alt-F": "goWordRight",
		"Alt-B": "goWordLeft",
		"Ctrl-A": "goLineStart",
		"Ctrl-E": "goLineEnd",
		"Ctrl-V": "goPageDown",
		"Shift-Ctrl-V": "goPageUp",
		"Ctrl-D": "delCharAfter",
		"Ctrl-H": "delCharBefore",
		"Alt-D": "delWordAfter",
		"Alt-Backspace": "delWordBefore",
		"Ctrl-K": "killLine",
		"Ctrl-T": "transposeChars"
	};
	a.lookupKey = Rb;
	a.isModifierKey = ld;
	a.keyName = md;
	a.fromTextArea = function(d, e) {
		function g() {
			d.value = r.getValue()
		}
		e || (e = {});
		e.value = d.value; ! e.tabindex && d.tabindex && (e.tabindex = d.tabindex);
		if (null == e.autofocus) {
			var j = document.body;
			try {
				j = document.activeElement
			} catch(k) {}
			e.autofocus = j == d || null != d.getAttribute("autofocus") && j == document.body
		}
		if (d.form) {
			na(d.form, "submit", g);
			var l = d.form,
			m = l.submit;
			try {
				var n = l.submit = function() {
					g();
					l.submit = m;
					l.submit();
					l.submit = n
				}
			} catch(o) {}
		}
		d.style.display = "none";
		var r = a(function(a) {
			d.parentNode.insertBefore(a, d.nextSibling)
		},
		e);
		r.save = g;
		r.getTextArea = function() {
			return d
		};
		r.toTextArea = function() {
			g();
			d.parentNode.removeChild(r.getWrapperElement());
			d.style.display = "";
			d.form && (fb(d.form, "submit", g), "function" == typeof d.form.submit && (d.form.submit = m))
		};
		return r
	};
	Sb.prototype = {
		eol: function() {
			return this.pos >= this.string.length
		},
		sol: function() {
			return 0 == this.pos
		},
		peek: function() {
			return this.string.charAt(this.pos) || void 0
		},
		next: function() {
			if (this.pos < this.string.length) return this.string.charAt(this.pos++)
		},
		eat: function(a) {
			var d = this.string.charAt(this.pos);
			if ("string" == typeof a ? d == a: d && (a.test ? a.test(d) : a(d))) return++this.pos,
			d
		},
		eatWhile: function(a) {
			for (var d = this.pos; this.eat(a););
			return this.pos > d
		},
		eatSpace: function() {
			for (var a = this.pos;
			/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;
			return this.pos > a
		},
		skipToEnd: function() {
			this.pos = this.string.length
		},
		skipTo: function(a) {
			a = this.string.indexOf(a, this.pos);
			if ( - 1 < a) return this.pos = a,
			!0
		},
		backUp: function(a) {
			this.pos -= a
		},
		column: function() {
			return Db(this.string, this.start, this.tabSize)
		},
		indentation: function() {
			return Db(this.string, null, this.tabSize)
		},
		match: function(a, d, e) {
			if ("string" == typeof a) {
				if ((e ? this.string.toLowerCase() : this.string).indexOf(e ? a.toLowerCase() : a, this.pos) == this.pos) return ! 1 !== d && (this.pos += a.length),
				!0
			} else {
				if ((a = this.string.slice(this.pos).match(a)) && 0 < a.index) return null;
				a && !1 !== d && (this.pos += a[0].length);
				return a
			}
		},
		current: function() {
			return this.string.slice(this.start, this.pos)
		}
	};
	a.StringStream = Sb;
	a.TextMarker = wb;
	wb.prototype.clear = function() {
		if (!this.explicitlyCleared) {
			var a = this.doc.cm,
			d = a && !a.curOp;
			d && M(a);
			for (var e = null,
			g = null,
			j = 0; j < this.lines.length; ++j) {
				var k = this.lines[j],
				l = Vb(k.markedSpans, this);
				null != l.to && (g = Sa(k));
				for (var n = k,
				o = k.markedSpans,
				r = l,
				s = void 0,
				v = 0; v < o.length; ++v) o[v] != r && (s || (s = [])).push(o[v]);
				n.markedSpans = s;
				null != l.from ? e = Sa(k) : this.collapsed && (!qb(this.doc, k) && a) && ab(k, ca(a.display))
			}
			if (a && this.collapsed && !a.options.lineWrapping) for (j = 0; j < this.lines.length; ++j) k = zb(a.doc, this.lines[j]),
			l = m(a.doc, k),
			l > a.display.maxLineLength && (a.display.maxLine = k, a.display.maxLineLength = l, a.display.maxLineChanged = !0);
			null != e && a && fa(a, e, g + 1);
			this.lines.length = 0;
			this.explicitlyCleared = !0;
			this.collapsed && this.doc.cantEdit && (this.doc.cantEdit = !1, a && Jb(a));
			d && ja(a);
			bb(this, "clear")
		}
	};
	wb.prototype.find = function() {
		for (var a, d, e = 0; e < this.lines.length; ++e) {
			var g = this.lines[e],
			j = Vb(g.markedSpans, this);
			if (null != j.from || null != j.to) g = Sa(g),
			null != j.from && (a = U(g, j.from)),
			null != j.to && (d = U(g, j.to))
		}
		return "bookmark" == this.type ? a: a && {
			from: a,
			to: d
		}
	};
	wb.prototype.getOptions = function(a) {
		var d = this.replacedWith;
		return {
			className: this.className,
			inclusiveLeft: this.inclusiveLeft,
			inclusiveRight: this.inclusiveRight,
			atomic: this.atomic,
			collapsed: this.collapsed,
			clearOnEnter: this.clearOnEnter,
			replacedWith: a ? d && d.cloneNode(!0) : d,
			readOnly: this.readOnly,
			startStyle: this.startStyle,
			endStyle: this.endStyle
		}
	};
	wb.prototype.attachLine = function(a) {
		if (!this.lines.length && this.doc.cm) {
			var d = this.doc.cm.curOp;
			if (!d.maybeHiddenMarkers || -1 == ib(d.maybeHiddenMarkers, this))(d.maybeUnhiddenMarkers || (d.maybeUnhiddenMarkers = [])).push(this)
		}
		this.lines.push(a)
	};
	wb.prototype.detachLine = function(a) {
		this.lines.splice(ib(this.lines, a), 1); ! this.lines.length && this.doc.cm && (a = this.doc.cm.curOp, (a.maybeHiddenMarkers || (a.maybeHiddenMarkers = [])).push(this))
	};
	a.SharedTextMarker = Ub;
	Ub.prototype.clear = function() {
		if (!this.explicitlyCleared) {
			this.explicitlyCleared = !0;
			for (var a = 0; a < this.markers.length; ++a) this.markers[a].clear();
			bb(this, "clear")
		}
	};
	Ub.prototype.find = function() {
		return this.primary.find()
	};
	Ub.prototype.getOptions = function(a) {
		a = this.primary.getOptions(a);
		a.shared = !0;
		return a
	};
	var Uc = a.LineWidget = function(a, d, e) {
		for (var g in e) e.hasOwnProperty(g) && (this[g] = e[g]);
		this.cm = a;
		this.node = d
	};
	Uc.prototype.clear = wd(function() {
		var a = this.line.widgets,
		d = Sa(this.line);
		if (null != d && a) {
			for (var e = 0; e < a.length; ++e) a[e] == this && a.splice(e--, 1);
			a.length || (this.line.widgets = null);
			ab(this.line, Math.max(0, this.line.height - gc(this)));
			fa(this.cm, d, d + 1)
		}
	});
	Uc.prototype.changed = wd(function() {
		var a = this.height;
		this.height = null;
		if (a = gc(this) - a) ab(this.line, this.line.height + a),
		a = Sa(this.line),
		fa(this.cm, a, a + 1)
	});
	var zd = {},
	Qc = /[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;
	rc.prototype = {
		chunkSize: function() {
			return this.lines.length
		},
		removeInner: function(a, d) {
			for (var e = a,
			g = a + d; e < g; ++e) {
				var j = this.lines[e];
				this.height -= j.height;
				var k = j;
				k.parent = null;
				ud(k);
				bb(j, "delete")
			}
			this.lines.splice(a, d)
		},
		collapse: function(a) {
			a.splice.apply(a, [a.length, 0].concat(this.lines))
		},
		insertInner: function(a, d, e) {
			this.height += e;
			this.lines = this.lines.slice(0, a).concat(d).concat(this.lines.slice(a));
			a = 0;
			for (e = d.length; a < e; ++a) d[a].parent = this
		},
		iterN: function(a, d, e) {
			for (d = a + d; a < d; ++a) if (e(this.lines[a])) return ! 0
		}
	};
	Xb.prototype = {
		chunkSize: function() {
			return this.size
		},
		removeInner: function(a, d) {
			this.size -= d;
			for (var e = 0; e < this.children.length; ++e) {
				var g = this.children[e],
				j = g.chunkSize();
				if (a < j) {
					var k = Math.min(d, j - a),
					l = g.height;
					g.removeInner(a, k);
					this.height -= l - g.height;
					j == k && (this.children.splice(e--, 1), g.parent = null);
					if (0 == (d -= k)) break;
					a = 0
				} else a -= j
			}
			25 > this.size - d && (e = [], this.collapse(e), this.children = [new rc(e)], this.children[0].parent = this)
		},
		collapse: function(a) {
			for (var d = 0,
			e = this.children.length; d < e; ++d) this.children[d].collapse(a)
		},
		insertInner: function(a, d, e) {
			this.size += d.length;
			this.height += e;
			for (var g = 0,
			j = this.children.length; g < j; ++g) {
				var k = this.children[g],
				l = k.chunkSize();
				if (a <= l) {
					k.insertInner(a, d, e);
					if (k.lines && 50 < k.lines.length) {
						for (; 50 < k.lines.length;) a = k.lines.splice(k.lines.length - 25, 25),
						a = new rc(a),
						k.height -= a.height,
						this.children.splice(g + 1, 0, a),
						a.parent = this;
						this.maybeSpill()
					}
					break
				}
				a -= l
			}
		},
		maybeSpill: function() {
			if (! (10 >= this.children.length)) {
				var a = this;
				do {
					var d = a.children.splice(a.children.length - 5, 5), d = new Xb(d);
					if (a.parent) {
						a.size -= d.size;
						a.height -= d.height;
						var e = ib(a.parent.children, a);
						a.parent.children.splice(e + 1, 0, d)
					} else e = new Xb(a.children), e.parent = a, a.children = [e, d], a = e;
					d.parent = a.parent
				} while ( 10 < a . children . length );
				a.parent.maybeSpill()
			}
		},
		iterN: function(a, d, e) {
			for (var g = 0,
			j = this.children.length; g < j; ++g) {
				var k = this.children[g],
				l = k.chunkSize();
				if (a < l) {
					l = Math.min(d, l - a);
					if (k.iterN(a, l, e)) return ! 0;
					if (0 == (d -= l)) break;
					a = 0
				} else a -= l
			}
		}
	};
	var fe = 0,
	Wa = a.Doc = function(a, d, e) {
		if (! (this instanceof Wa)) return new Wa(a, d, e);
		null == e && (e = 0);
		Xb.call(this, [new rc([Wb("", null)])]);
		this.first = e;
		this.scrollTop = this.scrollLeft = 0;
		this.cantEdit = !1;
		this.history = sc();
		this.frontier = e;
		e = U(e, 0);
		this.sel = {
			from: e,
			to: e,
			head: e,
			anchor: e,
			shift: !1,
			extend: !1,
			goalColumn: null
		};
		this.id = ++fe;
		this.modeOption = d;
		"string" == typeof a && (a = Fb(a));
		Nc(this, {
			from: e,
			to: e,
			text: a
		},
		null, {
			head: e,
			anchor: e
		})
	},
	ge = Wa,
	Ld = {
		iter: function(a, d, e) {
			e ? this.iterN(a - this.first, d - a, e) : this.iterN(this.first, this.first + this.size, a)
		},
		insert: function(a, d) {
			for (var e = 0,
			g = 0,
			j = d.length; g < j; ++g) e += d[g].height;
			this.insertInner(a - this.first, d, e)
		},
		remove: function(a, d) {
			this.removeInner(a - this.first, d)
		},
		getValue: function(a) {
			var d = Rc(this, this.first, this.first + this.size);
			return ! 1 === a ? d: d.join(a || "\n")
		},
		setValue: function(a) {
			var d = U(this.first, 0),
			e = this.first + this.size - 1;
			Ua(this, {
				from: d,
				to: U(e, ga(this, e).text.length),
				text: Fb(a),
				origin: "setValue"
			},
			{
				head: d,
				anchor: d
			},
			!0)
		},
		replaceRange: function(a, d, e, g) {
			d = da(this, d);
			e = e ? da(this, e) : d;
			Va(this, a, d, e, g)
		},
		getRange: function(a, d, e) {
			a = Cd(this, da(this, a), da(this, d));
			return ! 1 === e ? a: a.join(e || "\n")
		},
		getLine: function(a) {
			return (a = this.getLineHandle(a)) && a.text
		},
		setLine: function(a, d) {
			Fa(this, a) && Va(this, d, U(a, 0), da(this, U(a)))
		},
		removeLine: function(a) {
			Fa(this, a) && Va(this, "", U(a, 0), da(this, U(a + 1, 0)))
		},
		getLineHandle: function(a) {
			if (Fa(this, a)) return ga(this, a)
		},
		getLineNumber: function(a) {
			return Sa(a)
		},
		lineCount: function() {
			return this.size
		},
		firstLine: function() {
			return this.first
		},
		lastLine: function() {
			return this.first + this.size - 1
		},
		clipPos: function(a) {
			return da(this, a)
		},
		getCursor: function(a) {
			var d = this.sel;
			return Na(null == a || "head" == a ? d.head: "anchor" == a ? d.anchor: "end" == a || !1 === a ? d.to: d.from)
		},
		somethingSelected: function() {
			return ! xa(this.sel.head, this.sel.anchor)
		},
		setCursor: ua(function(a, d, e) {
			a = da(this, "number" == typeof a ? U(a, d || 0) : a);
			e ? Da(this, a) : Ja(this, a, a)
		}),
		setSelection: ua(function(a, d) {
			Ja(this, da(this, a), da(this, d || a))
		}),
		extendSelection: ua(function(a, d) {
			Da(this, da(this, a), d && da(this, d))
		}),
		getSelection: function(a) {
			return this.getRange(this.sel.from, this.sel.to, a)
		},
		replaceSelection: function(a, d, e) {
			Ua(this, {
				from: this.sel.from,
				to: this.sel.to,
				text: Fb(a),
				origin: e
			},
			d || "around")
		},
		undo: ua(function() {
			Lb(this, "undo")
		}),
		redo: ua(function() {
			Lb(this, "redo")
		}),
		setExtending: function(a) {
			this.sel.extend = a
		},
		historySize: function() {
			var a = this.history;
			return {
				undo: a.done.length,
				redo: a.undone.length
			}
		},
		clearHistory: function() {
			this.history = sc()
		},
		markClean: function() {
			this.history.dirtyCounter = 0;
			this.history.lastOp = this.history.lastOrigin = null
		},
		isClean: function() {
			return 0 == this.history.dirtyCounter
		},
		getHistory: function() {
			return {
				done: tc(this.history.done),
				undone: tc(this.history.undone)
			}
		},
		setHistory: function(a) {
			var d = this.history = sc();
			d.done = a.done.slice(0);
			d.undone = a.undone.slice(0)
		},
		markText: function(a, d, e) {
			return Tb(this, da(this, a), da(this, d), e, "range")
		},
		setBookmark: function(a, d) {
			var e = {
				replacedWith: d && (null == d.nodeType ? d.widget: d),
				insertLeft: d && d.insertLeft
			};
			a = da(this, a);
			return Tb(this, a, a, e, "bookmark")
		},
		findMarksAt: function(a) {
			a = da(this, a);
			var d = [],
			e = ga(this, a.line).markedSpans;
			if (e) for (var g = 0; g < e.length; ++g) {
				var j = e[g];
				if ((null == j.from || j.from <= a.ch) && (null == j.to || j.to >= a.ch)) d.push(j.marker.parent || j.marker)
			}
			return d
		},
		getAllMarks: function() {
			var a = [];
			this.iter(function(d) {
				if (d = d.markedSpans) for (var e = 0; e < d.length; ++e) null != d[e].from && a.push(d[e].marker)
			});
			return a
		},
		posFromIndex: function(a) {
			var d, e = this.first;
			this.iter(function(g) {
				g = g.text.length + 1;
				if (g > a) return d = a,
				!0;
				a -= g; ++e
			});
			return da(this, U(e, d))
		},
		indexFromPos: function(a) {
			a = da(this, a);
			var d = a.ch;
			if (a.line < this.first || 0 > a.ch) return 0;
			this.iter(this.first, a.line,
			function(a) {
				d += a.text.length + 1
			});
			return d
		},
		copy: function(a) {
			var d = new Wa(Rc(this, this.first, this.first + this.size), this.modeOption, this.first);
			d.scrollTop = this.scrollTop;
			d.scrollLeft = this.scrollLeft;
			d.sel = {
				from: this.sel.from,
				to: this.sel.to,
				head: this.sel.head,
				anchor: this.sel.anchor,
				shift: this.sel.shift,
				extend: !1,
				goalColumn: this.sel.goalColumn
			};
			a && (d.history.undoDepth = this.history.undoDepth, d.setHistory(this.getHistory()));
			return d
		},
		linkedDoc: function(a) {
			a || (a = {});
			var d = this.first,
			e = this.first + this.size;
			null != a.from && a.from > d && (d = a.from);
			null != a.to && a.to < e && (e = a.to);
			d = new Wa(Rc(this, d, e), a.mode || this.modeOption, d);
			a.sharedHist && (d.history = this.history); (this.linked || (this.linked = [])).push({
				doc: d,
				sharedHist: a.sharedHist
			});
			d.linked = [{
				doc: this,
				isParent: !0,
				sharedHist: a.sharedHist
			}];
			return d
		},
		unlinkDoc: function(d) {
			d instanceof a && (d = d.doc);
			if (this.linked) for (var e = 0; e < this.linked.length; ++e) if (this.linked[e].doc == d) {
				this.linked.splice(e, 1);
				d.unlinkDoc(this);
				break
			}
			if (d.history == this.history) {
				var g = [d.id];
				Ib(d,
				function(a) {
					g.push(a.id)
				},
				!0);
				d.history = sc();
				d.history.done = tc(this.history.done, g);
				d.history.undone = tc(this.history.undone, g)
			}
		},
		iterLinkedDocs: function(a) {
			Ib(this, a)
		},
		getMode: function() {
			return this.mode
		},
		getEditor: function() {
			return this.cm
		}
	},
	Md = function() {};
	Md.prototype = Xb.prototype;
	var Nd = new Md;
	Ld && pc(Ld, Nd);
	ge.prototype = Nd;
	Wa.prototype.eachLine = Wa.prototype.iter;
	var he = ["iter", "insert", "remove", "copy", "getEditor"],
	$b;
	for ($b in Wa.prototype) Wa.prototype.hasOwnProperty($b) && 0 > ib(he, $b) && (a.prototype[$b] = function(a) {
		return function() {
			return a.apply(this.doc, arguments)
		}
	} (Wa.prototype[$b]));
	a.e_stop = cc;
	a.e_preventDefault = Ha;
	a.e_stopPropagation = Gd;
	var nb, jc = 0;
	a.on = na;
	a.off = fb;
	a.signal = Ra;
	var Nb = 30,
	jd = a.Pass = {
		toString: function() {
			return "CodeMirror.Pass"
		}
	};
	zc.prototype = {
		set: function(a, d) {
			clearTimeout(this.id);
			this.id = setTimeout(d, a)
		}
	};
	a.countColumn = Db;
	var vc = [""],
	be = /[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,
	Fc = /[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;
	a.replaceGetRect = function(a) {
		Ea = a
	};
	var Gc;
	if (sb) Gc = !1;
	else {
		var Od = aa("div");
		Gc = "draggable" in Od || "dragDrop" in Od
	}
	var qc = /^$/;
	Hb ? qc = /$'/: Cc ? qc = /\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/: Jd && (qc = /\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);
	var wc, Sc, Fb = 3 != "\n\nb".split(/\n/).length ?
	function(a) {
		for (var d = 0,
		e = [], g = a.length; d <= g;) {
			var j = a.indexOf("\n", d); - 1 == j && (j = a.length);
			var k = a.slice(d, "\r" == a.charAt(j - 1) ? j - 1 : j),
			l = k.indexOf("\r"); - 1 != l ? (e.push(k.slice(0, l)), d += l + 1) : (e.push(k), d = j + 1)
		}
		return e
	}: function(a) {
		return a.split(/\r\n?|\n/)
	};
	a.splitLines = Fb;
	var Xd = window.getSelection ?
	function(a) {
		try {
			return a.selectionStart != a.selectionEnd
		} catch(d) {
			return ! 1
		}
	}: function(a) {
		try {
			var d = a.ownerDocument.selection.createRange()
		} catch(e) {}
		return ! d || d.parentElement() != a ? !1 : 0 != d.compareEndPoints("StartToEnd", d)
	},
	kc;
	var Wc = aa("div");
	"oncopy" in Wc ? kc = !0 : (Wc.setAttribute("oncopy", "return;"), kc = "function" == typeof Wc.oncopy);
	var vb = {
		3 : "Enter",
		8 : "Backspace",
		9 : "Tab",
		13 : "Enter",
		16 : "Shift",
		17 : "Ctrl",
		18 : "Alt",
		19 : "Pause",
		20 : "CapsLock",
		27 : "Esc",
		32 : "Space",
		33 : "PageUp",
		34 : "PageDown",
		35 : "End",
		36 : "Home",
		37 : "Left",
		38 : "Up",
		39 : "Right",
		40 : "Down",
		44 : "PrintScrn",
		45 : "Insert",
		46 : "Delete",
		59 : ";",
		91 : "Mod",
		92 : "Mod",
		93 : "Mod",
		109 : "-",
		107 : "\x3d",
		127 : "Delete",
		186 : ";",
		187 : "\x3d",
		188 : ",",
		189 : "-",
		190 : ".",
		191 : "/",
		192 : "`",
		219 : "[",
		220 : "\\",
		221 : "]",
		222 : "'",
		63276 : "PageUp",
		63277 : "PageDown",
		63275 : "End",
		63273 : "Home",
		63234 : "Left",
		63232 : "Up",
		63235 : "Right",
		63233 : "Down",
		63302 : "Insert",
		63272 : "Delete"
	};
	a.keyNames = vb;
	for (var Ia = 0; 10 > Ia; Ia++) vb[Ia + 48] = String(Ia);
	for (Ia = 65; 90 >= Ia; Ia++) vb[Ia] = String.fromCharCode(Ia);
	for (Ia = 1; 12 >= Ia; Ia++) vb[Ia + 111] = vb[Ia + 63235] = "F" + Ia;
	var Dd, ke = function(a) {
		return 255 >= a ? ie.charAt(a) : 1424 <= a && 1524 >= a ? "R": 1536 <= a && 1791 >= a ? je.charAt(a - 1536) : 1792 <= a && 2220 >= a ? "r": "L"
	},
	ie = "bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",
	je = "rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",
	le = /[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,
	Pd = /[stwN]/,
	Qd = /[LRr]/,
	Rd = /[Lb1n]/,
	Sd = /[1n]/;
	Dd = function(a) {
		if (!le.test(a)) return ! 1;
		for (var d = a.length,
		e = [], g = 0, j; g < d; ++g) e.push(ke(a.charCodeAt(g)));
		for (var g = 0,
		k = "L"; g < d; ++g) j = e[g],
		"m" == j ? e[g] = k: k = j;
		g = 0;
		for (k = "L"; g < d; ++g) j = e[g],
		"1" == j && "r" == k ? e[g] = "n": Qd.test(j) && (k = j, "r" == j && (e[g] = "R"));
		g = 1;
		for (k = e[0]; g < d - 1; ++g) {
			j = e[g];
			if ("+" == j && "1" == k && "1" == e[g + 1]) e[g] = "1";
			else if ("," == j && k == e[g + 1] && ("1" == k || "n" == k)) e[g] = k;
			k = j
		}
		for (g = 0; g < d; ++g) if (j = e[g], "," == j) e[g] = "N";
		else if ("%" == j) {
			for (k = g + 1; k < d && "%" == e[k]; ++k);
			var l = g && "!" == e[g - 1] || k < d - 1 && "1" == e[k] ? "1": "N";
			for (j = g; j < k; ++j) e[j] = l;
			g = k - 1
		}
		g = 0;
		for (k = "L"; g < d; ++g) j = e[g],
		"L" == k && "1" == j ? e[g] = "L": Qd.test(j) && (k = j);
		for (g = 0; g < d; ++g) if (Pd.test(e[g])) {
			for (k = g + 1; k < d && Pd.test(e[k]); ++k);
			j = "L" == (k < d - 1 ? e[k] : "L");
			l = "L" == (g ? e[g - 1] : "L") || j ? "L": "R";
			for (j = g; j < k; ++j) e[j] = l;
			g = k - 1
		}
		for (var k = [], m, g = 0; g < d;) if (Rd.test(e[g])) {
			j = g;
			for (++g; g < d && Rd.test(e[g]); ++g);
			k.push({
				from: j,
				to: g,
				level: 0
			})
		} else {
			var n = g,
			l = k.length;
			for (++g; g < d && "L" != e[g]; ++g);
			for (j = n; j < g;) if (Sd.test(e[j])) {
				n < j && k.splice(l, 0, {
					from: n,
					to: j,
					level: 1
				});
				n = j;
				for (++j; j < g && Sd.test(e[j]); ++j);
				k.splice(l, 0, {
					from: n,
					to: j,
					level: 2
				});
				n = j
			} else++j;
			n < g && k.splice(l, 0, {
				from: n,
				to: g,
				level: 1
			})
		}
		if (1 == k[0].level && (m = a.match(/^\s+/))) k[0].from = m[0].length,
		k.unshift({
			from: 0,
			to: m[0].length,
			level: 0
		});
		if (1 == Ka(k).level && (m = a.match(/\s+$/))) Ka(k).to -= m[0].length,
		k.push({
			from: d - m[0].length,
			to: d,
			level: 0
		});
		k[0].level != Ka(k).level && k.push({
			from: d,
			to: d,
			level: k[0].level
		});
		return k
	};
	a.version = "3.1";
	return a
} ();CodeMirror.defineMode("css",
function(a) {
	function e(a) {
		for (var d = {},
		e = 0; e < a.length; ++e) d[a[e]] = !0;
		return d
	}
	function d(a, d) {
		o = d;
		return a
	}
	function g(a, e) {
		var g = a.next();
		if ("@" == g) return a.eatWhile(/[\w\\\-]/),
		d("def", a.current());
		if ("/" == g && a.eat("*")) return e.tokenize = j,
		j(a, e);
		if ("\x3c" == g && a.eat("!")) return e.tokenize = k,
		k(a, e);
		if ("\x3d" == g) d(null, "compare");
		else {
			if (("~" == g || "|" == g) && a.eat("\x3d")) return d(null, "compare");
			if ('"' == g || "'" == g) return e.tokenize = l(g),
			e.tokenize(a, e);
			if ("#" == g) return a.eatWhile(/[\w\\\-]/),
			d("atom", "hash");
			if ("!" == g) return a.match(/^\s*\w*/),
			d("keyword", "important");
			if (/\d/.test(g)) return a.eatWhile(/[\w.%]/),
			d("number", "unit");
			if ("-" === g) {
				if (/\d/.test(a.peek())) return a.eatWhile(/[\w.%]/),
				d("number", "unit");
				if (a.match(/^[^-]+-/)) return d("meta", "meta")
			} else {
				if (/[,+>*\/]/.test(g)) return d(null, "select-op");
				if ("." == g && a.match(/^-?[_a-z][_a-z0-9-]*/i)) return d("qualifier", "qualifier");
				if (":" == g) return d("operator", g);
				if (/[;{}\[\]\(\)]/.test(g)) return d(null, g);
				"u" == g && a.match("rl(") ? (a.backUp(1), e.tokenize = m) : a.eatWhile(/[\w\\\-]/);
				return d("property", "variable")
			}
		}
	}
	function j(a, e) {
		for (var j = !1,
		k; null != (k = a.next());) {
			if (j && "/" == k) {
				e.tokenize = g;
				break
			}
			j = "*" == k
		}
		return d("comment", "comment")
	}
	function k(a, e) {
		for (var j = 0,
		k; null != (k = a.next());) {
			if (2 <= j && "\x3e" == k) {
				e.tokenize = g;
				break
			}
			j = "-" == k ? j + 1 : 0
		}
		return d("comment", "comment")
	}
	function l(a, e) {
		return function(j, k) {
			for (var l = !1,
			m; null != (m = j.next()) && (m != a || l);) l = !l && "\\" == m;
			l || (e && j.backUp(1), k.tokenize = g);
			return d("string", "string")
		}
	}
	function m(a, e) {
		a.next();
		e.tokenize = a.match(/\s*[\"\']/, !1) ? g: l(")", !0);
		return d(null, "(")
	}
	var n = a.indentUnit,
	o, r = e("all aural braille handheld print projection screen tty tv embossed".split(" ")),
	u = e("width min-width max-width height min-height max-height device-width min-device-width max-device-width device-height min-device-height max-device-height aspect-ratio min-aspect-ratio max-aspect-ratio device-aspect-ratio min-device-aspect-ratio max-device-aspect-ratio color min-color max-color color-index min-color-index max-color-index monochrome min-monochrome max-monochrome resolution min-resolution max-resolution scan grid".split(" ")),
	s = e("align-content align-items align-self alignment-adjust alignment-baseline anchor-point animation animation-delay animation-direction animation-duration animation-iteration-count animation-name animation-play-state animation-timing-function appearance azimuth backface-visibility background background-attachment background-clip background-color background-image background-origin background-position background-repeat background-size baseline-shift binding bleed bookmark-label bookmark-level bookmark-state bookmark-target border border-bottom border-bottom-color border-bottom-left-radius border-bottom-right-radius border-bottom-style border-bottom-width border-collapse border-color border-image border-image-outset border-image-repeat border-image-slice border-image-source border-image-width border-left border-left-color border-left-style border-left-width border-radius border-right border-right-color border-right-style border-right-width border-spacing border-style border-top border-top-color border-top-left-radius border-top-right-radius border-top-style border-top-width border-width bottom box-decoration-break box-shadow box-sizing break-after break-before break-inside caption-side clear clip color color-profile column-count column-fill column-gap column-rule column-rule-color column-rule-style column-rule-width column-span column-width columns content counter-increment counter-reset crop cue cue-after cue-before cursor direction display dominant-baseline drop-initial-after-adjust drop-initial-after-align drop-initial-before-adjust drop-initial-before-align drop-initial-size drop-initial-value elevation empty-cells fit fit-position flex flex-basis flex-direction flex-flow flex-grow flex-shrink flex-wrap float float-offset font font-feature-settings font-family font-kerning font-language-override font-size font-size-adjust font-stretch font-style font-synthesis font-variant font-variant-alternates font-variant-caps font-variant-east-asian font-variant-ligatures font-variant-numeric font-variant-position font-weight grid-cell grid-column grid-column-align grid-column-sizing grid-column-span grid-columns grid-flow grid-row grid-row-align grid-row-sizing grid-row-span grid-rows grid-template hanging-punctuation height hyphens icon image-orientation image-rendering image-resolution inline-box-align justify-content left letter-spacing line-break line-height line-stacking line-stacking-ruby line-stacking-shift line-stacking-strategy list-style list-style-image list-style-position list-style-type margin margin-bottom margin-left margin-right margin-top marker-offset marks marquee-direction marquee-loop marquee-play-count marquee-speed marquee-style max-height max-width min-height min-width move-to nav-down nav-index nav-left nav-right nav-up opacity order orphans outline outline-color outline-offset outline-style outline-width overflow overflow-style overflow-wrap overflow-x overflow-y padding padding-bottom padding-left padding-right padding-top page page-break-after page-break-before page-break-inside page-policy pause pause-after pause-before perspective perspective-origin pitch pitch-range play-during position presentation-level punctuation-trim quotes rendering-intent resize rest rest-after rest-before richness right rotation rotation-point ruby-align ruby-overhang ruby-position ruby-span size speak speak-as speak-header speak-numeral speak-punctuation speech-rate stress string-set tab-size table-layout target target-name target-new target-position text-align text-align-last text-decoration text-decoration-color text-decoration-line text-decoration-skip text-decoration-style text-emphasis text-emphasis-color text-emphasis-position text-emphasis-style text-height text-indent text-justify text-outline text-shadow text-space-collapse text-transform text-underline-position text-wrap top transform transform-origin transform-style transition transition-delay transition-duration transition-property transition-timing-function unicode-bidi vertical-align visibility voice-balance voice-duration voice-family voice-pitch voice-range voice-rate voice-stress voice-volume volume white-space widows width word-break word-spacing word-wrap z-index".split(" ")),
	B = e("black silver gray white maroon red purple fuchsia green lime olive yellow navy blue teal aqua".split(" ")),
	z = e("above absolute activeborder activecaption afar after-white-space ahead alias all all-scroll alternate always amharic amharic-abegede antialiased appworkspace arabic-indic armenian asterisks auto avoid background backwards baseline below bidi-override binary bengali blink block block-axis bold bolder border border-box both bottom break-all break-word button button-bevel buttonface buttonhighlight buttonshadow buttontext cambodian capitalize caps-lock-indicator caption captiontext caret cell center checkbox circle cjk-earthly-branch cjk-heavenly-stem cjk-ideographic clear clip close-quote col-resize collapse compact condensed contain content content-box context-menu continuous copy cover crop cross crosshair currentcolor cursive dashed decimal decimal-leading-zero default default-button destination-atop destination-in destination-out destination-over devanagari disc discard document dot-dash dot-dot-dash dotted double down e-resize ease ease-in ease-in-out ease-out element ellipsis embed end ethiopic ethiopic-abegede ethiopic-abegede-am-et ethiopic-abegede-gez ethiopic-abegede-ti-er ethiopic-abegede-ti-et ethiopic-halehame-aa-er ethiopic-halehame-aa-et ethiopic-halehame-am-et ethiopic-halehame-gez ethiopic-halehame-om-et ethiopic-halehame-sid-et ethiopic-halehame-so-et ethiopic-halehame-ti-er ethiopic-halehame-ti-et ethiopic-halehame-tig ew-resize expanded extra-condensed extra-expanded fantasy fast fill fixed flat footnotes forwards from geometricPrecision georgian graytext groove gujarati gurmukhi hand hangul hangul-consonant hebrew help hidden hide higher highlight highlighttext hiragana hiragana-iroha horizontal hsl hsla icon ignore inactiveborder inactivecaption inactivecaptiontext infinite infobackground infotext inherit initial inline inline-axis inline-block inline-table inset inside intrinsic invert italic justify kannada katakana katakana-iroha khmer landscape lao large larger left level lighter line-through linear lines list-item listbox listitem local logical loud lower lower-alpha lower-armenian lower-greek lower-hexadecimal lower-latin lower-norwegian lower-roman lowercase ltr malayalam match media-controls-background media-current-time-display media-fullscreen-button media-mute-button media-play-button media-return-to-realtime-button media-rewind-button media-seek-back-button media-seek-forward-button media-slider media-sliderthumb media-time-remaining-display media-volume-slider media-volume-slider-container media-volume-sliderthumb medium menu menulist menulist-button menulist-text menulist-textfield menutext message-box middle min-intrinsic mix mongolian monospace move multiple myanmar n-resize narrower navy ne-resize nesw-resize no-close-quote no-drop no-open-quote no-repeat none normal not-allowed nowrap ns-resize nw-resize nwse-resize oblique octal open-quote optimizeLegibility optimizeSpeed oriya oromo outset outside overlay overline padding padding-box painted paused persian plus-darker plus-lighter pointer portrait pre pre-line pre-wrap preserve-3d progress push-button radio read-only read-write read-write-plaintext-only relative repeat repeat-x repeat-y reset reverse rgb rgba ridge right round row-resize rtl run-in running s-resize sans-serif scroll scrollbar se-resize searchfield searchfield-cancel-button searchfield-decoration searchfield-results-button searchfield-results-decoration semi-condensed semi-expanded separate serif show sidama single skip-white-space slide slider-horizontal slider-vertical sliderthumb-horizontal sliderthumb-vertical slow small small-caps small-caption smaller solid somali source-atop source-in source-out source-over space square square-button start static status-bar stretch stroke sub subpixel-antialiased super sw-resize table table-caption table-cell table-column table-column-group table-footer-group table-header-group table-row table-row-group telugu text text-bottom text-top textarea textfield thai thick thin threeddarkshadow threedface threedhighlight threedlightshadow threedshadow tibetan tigre tigrinya-er tigrinya-er-abegede tigrinya-et tigrinya-et-abegede to top transparent ultra-condensed ultra-expanded underline up upper-alpha upper-armenian upper-greek upper-hexadecimal upper-latin upper-norwegian upper-roman uppercase urdu url vertical vertical-text visible visibleFill visiblePainted visibleStroke visual w-resize wait wave white wider window windowframe windowtext x-large x-small xor xx-large xx-small yellow".split(" "));
	return {
		startState: function(a) {
			return {
				tokenize: g,
				baseIndent: a || 0,
				stack: []
			}
		},
		token: function(a, d) {
			if (d.tokenize == g && a.eatSpace()) return null;
			var e = d.tokenize(a, d),
			j = d.stack[d.stack.length - 1];
			"property" == e ? "propertyValue" == j ? e = z[a.current()] ? "string-2": B[a.current()] ? "keyword": "variable-2": "rule" == j ? s[a.current()] || (e += " error") : !j || "@media{" == j ? e = "tag": "@media" == j ? e = r[a.current()] ? "attribute": /^(only|not)$/i.test(a.current()) ? "keyword": "and" == a.current().toLowerCase() ? "error": u[a.current()] ? "error": "attribute error": "@mediaType" == j ? r[a.current()] ? e = "attribute": "and" == a.current().toLowerCase() ? e = "operator": (/^(only|not)$/i.test(a.current()) || a.current(), e = "error") : "@mediaType(" == j ? s[a.current()] || (e = r[a.current()] ? "error": "and" == a.current().toLowerCase() ? "operator": /^(only|not)$/i.test(a.current()) ? "error": e + " error") : e = "error": "atom" == e ? !j || "@media{" == j ? e = "builtin": "propertyValue" == j ? /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a.current()) || (e += " error") : e = "error": "@media" == j && "{" == o && (e = "error");
			"{" == o ? "@media" == j || "@mediaType" == j ? (d.stack.pop(), d.stack[d.stack.length - 1] = "@media{") : d.stack.push("rule") : "}" == o ? (d.stack.pop(), "propertyValue" == j && d.stack.pop()) : "@media" == o ? d.stack.push("@media") : "@media" == j && /\b(keyword|attribute)\b/.test(e) ? d.stack.push("@mediaType") : "@mediaType" == j && "," == a.current() ? d.stack.pop() : "@mediaType" == j && "(" == o ? d.stack.push("@mediaType(") : "@mediaType(" == j && ")" == o ? d.stack.pop() : "rule" == j && ":" == o ? d.stack.push("propertyValue") : "propertyValue" == j && ";" == o && d.stack.pop();
			return e
		},
		indent: function(a, d) {
			var e = a.stack.length;
			/^\}/.test(d) && (e -= "propertyValue" == a.stack[a.stack.length - 1] ? 2 : 1);
			return a.baseIndent + e * n
		},
		electricChars: "}"
	}
});CodeMirror.defineMIME("text/css", "css");CodeMirror.defineMode("htmlembedded",
function(a, e) {
	function d(a, d) {
		return a.match(j, !1) ? (d.token = g, l.token(a, d.scriptState)) : m.token(a, d.htmlState)
	}
	function g(a, e) {
		return a.match(k, !1) ? (e.token = d, m.token(a, e.htmlState)) : l.token(a, e.scriptState)
	}
	var j = e.scriptStartRegex || /^<%/i,
	k = e.scriptEndRegex || /^%>/i,
	l, m;
	return {
		startState: function() {
			l = l || CodeMirror.getMode(a, e.scriptingModeSpec);
			m = m || CodeMirror.getMode(a, "htmlmixed");
			return {
				token: e.startOpen ? g: d,
				htmlState: CodeMirror.startState(m),
				scriptState: CodeMirror.startState(l)
			}
		},
		token: function(a, d) {
			return d.token(a, d)
		},
		indent: function(a, e) {
			if (a.token == d) return m.indent(a.htmlState, e);
			if (l.indent) return l.indent(a.scriptState, e)
		},
		copyState: function(a) {
			return {
				token: a.token,
				htmlState: CodeMirror.copyState(m, a.htmlState),
				scriptState: CodeMirror.copyState(l, a.scriptState)
			}
		},
		electricChars: "/{}:",
		innerMode: function(a) {
			return a.token == g ? {
				state: a.scriptState,
				mode: l
			}: {
				state: a.htmlState,
				mode: m
			}
		}
	}
},
"htmlmixed");CodeMirror.defineMIME("application/x-ejs", {
	name: "htmlembedded",
	scriptingModeSpec: "javascript"
});CodeMirror.defineMIME("application/x-aspx", {
	name: "htmlembedded",
	scriptingModeSpec: "text/x-csharp"
});CodeMirror.defineMIME("application/x-jsp", {
	name: "htmlembedded",
	scriptingModeSpec: "text/x-java"
});CodeMirror.defineMIME("application/x-erb", {
	name: "htmlembedded",
	scriptingModeSpec: "ruby"
});CodeMirror.defineMode("htmlmixed",
function(a, e) {
	function d(a, d) {
		var e = d.htmlState.tagName,
		g = l.token(a, d.htmlState);
		if ("script" == e && /\btag\b/.test(g) && "\x3e" == a.current()) { (e = (e = a.string.slice(Math.max(0, a.pos - 100), a.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i)) ? e[1] : "") && /[\"\']/.test(e.charAt(0)) && (e = e.slice(1, e.length - 1));
			for (var o = 0; o < n.length; ++o) {
				var r = n[o];
				if ("string" == typeof r.matches ? e == r.matches: r.matches.test(e)) {
					r.mode && (d.token = j, d.localMode = r.mode, d.localState = r.mode.startState && r.mode.startState(l.indent(d.htmlState, "")));
					break
				}
			}
		} else "style" == e && (/\btag\b/.test(g) && "\x3e" == a.current()) && (d.token = k, d.localMode = m, d.localState = m.startState(l.indent(d.htmlState, "")));
		return g
	}
	function g(a, d, e) {
		var g = a.current(),
		j = g.search(d); - 1 < j ? a.backUp(g.length - j) : g.match(/<\/?$/) && (a.backUp(g.length), a.match(d, !1) || a.match(g[0]));
		return e
	}
	function j(a, e) {
		return a.match(/^<\/\s*script\s*>/i, !1) ? (e.token = d, e.localState = e.localMode = null, d(a, e)) : g(a, /<\/\s*script\s*>/, e.localMode.token(a, e.localState))
	}
	function k(a, e) {
		return a.match(/^<\/\s*style\s*>/i, !1) ? (e.token = d, e.localState = e.localMode = null, d(a, e)) : g(a, /<\/\s*style\s*>/, m.token(a, e.localState))
	}
	var l = CodeMirror.getMode(a, {
		name: "xml",
		htmlMode: !0
	}),
	m = CodeMirror.getMode(a, "css"),
	n = [],
	o = e && e.scriptTypes;
	n.push({
		matches: /^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,
		mode: CodeMirror.getMode(a, "javascript")
	});
	if (o) for (var r = 0; r < o.length; ++r) {
		var u = o[r];
		n.push({
			matches: u.matches,
			mode: u.mode && CodeMirror.getMode(a, u.mode)
		})
	}
	n.push({
		matches: /./,
		mode: CodeMirror.getMode(a, "text/plain")
	});
	return {
		startState: function() {
			var a = l.startState();
			return {
				token: d,
				localMode: null,
				localState: null,
				htmlState: a
			}
		},
		copyState: function(a) {
			if (a.localState) var d = CodeMirror.copyState(a.localMode, a.localState);
			return {
				token: a.token,
				localMode: a.localMode,
				localState: d,
				htmlState: CodeMirror.copyState(l, a.htmlState)
			}
		},
		token: function(a, d) {
			return d.token(a, d)
		},
		indent: function(a, d) {
			return ! a.localMode || /^\s*<\//.test(d) ? l.indent(a.htmlState, d) : a.localMode.indent ? a.localMode.indent(a.localState, d) : CodeMirror.Pass
		},
		electricChars: "/{}:",
		innerMode: function(a) {
			return {
				state: a.localState || a.htmlState,
				mode: a.localMode || l
			}
		}
	}
},
"xml", "javascript", "css");CodeMirror.defineMIME("text/html", "htmlmixed");CodeMirror.defineMode("properties",
function() {
	return {
		token: function(a, e) {
			var d = a.sol() || e.afterSection,
			g = a.eol();
			e.afterSection = !1;
			d && (e.nextMultiline ? (e.inMultiline = !0, e.nextMultiline = !1) : e.position = "def");
			g && !e.nextMultiline && (e.inMultiline = !1, e.position = "def");
			if (d) for (; a.eatSpace(););
			g = a.next();
			if (d && ("#" === g || "!" === g || ";" === g)) return e.position = "comment",
			a.skipToEnd(),
			"comment";
			if (d && "[" === g) return e.afterSection = !0,
			a.skipTo("]"),
			a.eat("]"),
			"header";
			if ("\x3d" === g || ":" === g) return e.position = "quote",
			null;
			"\\" === g && "quote" === e.position && "u" !== a.next() && (e.nextMultiline = !0);
			return e.position
		},
		startState: function() {
			return {
				position: "def",
				nextMultiline: !1,
				inMultiline: !1,
				afterSection: !1
			}
		}
	}
});CodeMirror.defineMIME("text/x-properties", "properties");CodeMirror.defineMIME("text/x-ini", "properties");CodeMirror.defineMode("xml",
function(a, e) {
	function d(a, d) {
		function e(g) {
			d.tokenize = g;
			return g(a, d)
		}
		var l = a.next();
		if ("\x3c" == l) {
			if (a.eat("!")) return a.eat("[") ? a.match("CDATA[") ? e(j("atom", "]]\x3e")) : null: a.match("--") ? e(j("comment", "--\x3e")) : a.match("DOCTYPE", !0, !0) ? (a.eatWhile(/[\w\._\-]/), e(k(1))) : null;
			if (a.eat("?")) return a.eatWhile(/[\w\._\-]/),
			d.tokenize = j("meta", "?\x3e"),
			"meta";
			l = a.eat("/");
			F = "";
			for (var m; m = a.eat(/[^\s\u00a0=<>\"\'\/?]/);) F += m;
			if (!F) return "error";
			I = l ? "closeTag": "openTag";
			d.tokenize = g;
			return "tag"
		}
		if ("\x26" == l) return (a.eat("#") ? a.eat("x") ? a.eatWhile(/[a-fA-F\d]/) && a.eat(";") : a.eatWhile(/[\d]/) && a.eat(";") : a.eatWhile(/[\w\.\-:]/) && a.eat(";")) ? "atom": "error";
		a.eatWhile(/[^&<]/);
		return null
	}
	function g(a, e) {
		var j = a.next();
		if ("\x3e" == j || "/" == j && a.eat("\x3e")) return e.tokenize = d,
		I = "\x3e" == j ? "endTag": "selfcloseTag",
		"tag";
		if ("\x3d" == j) return I = "equals",
		null;
		if (/[\'\"]/.test(j)) return e.tokenize = function(a, d) {
			for (; ! a.eol();) if (a.next() == j) {
				d.tokenize = g;
				break
			}
			return "string"
		},
		e.tokenize(a, e);
		a.eatWhile(/[^\s\u00a0=<>\"\']/);
		return "word"
	}
	function j(a, e) {
		return function(g, j) {
			for (; ! g.eol();) {
				if (g.match(e)) {
					j.tokenize = d;
					break
				}
				g.next()
			}
			return a
		}
	}
	function k(a) {
		return function(e, g) {
			for (var j; null != (j = e.next());) {
				if ("\x3c" == j) return g.tokenize = k(a + 1),
				g.tokenize(e, g);
				if ("\x3e" == j) if (1 == a) {
					g.tokenize = d;
					break
				} else return g.tokenize = k(a - 1),
				g.tokenize(e, g)
			}
			return "meta"
		}
	}
	function l() {
		for (var a = arguments.length - 1; 0 <= a; a--) G.cc.push(arguments[a])
	}
	function m() {
		l.apply(null, arguments);
		return ! 0
	}
	function n() {
		G.context && (G.context = G.context.prev)
	}
	function o(a) {
		if ("openTag" == a) {
			G.tagName = F;
			var d = G.startOfLine;
			return m(u,
			function(a) {
				var e = G.tagName;
				G.tagName = null;
				if ("selfcloseTag" == a || "endTag" == a && D.autoSelfClosers.hasOwnProperty(e.toLowerCase())) return r(e.toLowerCase()),
				m();
				"endTag" == a && (r(e.toLowerCase()), a = D.doNotIndent.hasOwnProperty(e) || G.context && G.context.noIndent, G.context = {
					prev: G.context,
					tagName: e,
					indent: G.indented,
					startOfLine: d,
					noIndent: a
				});
				return m()
			})
		}
		if ("closeTag" == a) {
			a = !1;
			G.context ? G.context.tagName != F && (D.implicitlyClosed.hasOwnProperty(G.context.tagName.toLowerCase()) && n(), a = !G.context || G.context.tagName != F) : a = !0;
			a && (K = "error");
			var e = a;
			return m(function(a) {
				e && (K = "error");
				if ("endTag" == a) return n(),
				m();
				K = "error";
				return m(arguments.callee)
			})
		}
		return m()
	}
	function r(a) {
		for (var d; G.context;) {
			d = G.context.tagName.toLowerCase();
			if (!D.contextGrabbers.hasOwnProperty(d) || !D.contextGrabbers[d].hasOwnProperty(a)) break;
			n()
		}
	}
	function u(a) {
		if ("word" == a) return K = "attribute",
		m(s, u);
		if ("endTag" == a || "selfcloseTag" == a) return l();
		K = "error";
		return m(u)
	}
	function s(a) {
		if ("equals" == a) return m(B, u);
		D.allowMissing ? "word" == a && (K = "attribute") : K = "error";
		return "endTag" == a || "selfcloseTag" == a ? l() : m()
	}
	function B(a) {
		if ("string" == a) return m(z);
		if ("word" == a && D.allowUnquoted) return K = "string",
		m();
		K = "error";
		return "endTag" == a || "selfCloseTag" == a ? l() : m()
	}
	function z(a) {
		return "string" == a ? m(z) : l()
	}
	var v = a.indentUnit,
	D = e.htmlMode ? {
		autoSelfClosers: {
			area: !0,
			base: !0,
			br: !0,
			col: !0,
			command: !0,
			embed: !0,
			frame: !0,
			hr: !0,
			img: !0,
			input: !0,
			keygen: !0,
			link: !0,
			meta: !0,
			param: !0,
			source: !0,
			track: !0,
			wbr: !0
		},
		implicitlyClosed: {
			dd: !0,
			li: !0,
			optgroup: !0,
			option: !0,
			p: !0,
			rp: !0,
			rt: !0,
			tbody: !0,
			td: !0,
			tfoot: !0,
			th: !0,
			tr: !0
		},
		contextGrabbers: {
			dd: {
				dd: !0,
				dt: !0
			},
			dt: {
				dd: !0,
				dt: !0
			},
			li: {
				li: !0
			},
			option: {
				option: !0,
				optgroup: !0
			},
			optgroup: {
				optgroup: !0
			},
			p: {
				address: !0,
				article: !0,
				aside: !0,
				blockquote: !0,
				dir: !0,
				div: !0,
				dl: !0,
				fieldset: !0,
				footer: !0,
				form: !0,
				h1: !0,
				h2: !0,
				h3: !0,
				h4: !0,
				h5: !0,
				h6: !0,
				header: !0,
				hgroup: !0,
				hr: !0,
				menu: !0,
				nav: !0,
				ol: !0,
				p: !0,
				pre: !0,
				section: !0,
				table: !0,
				ul: !0
			},
			rp: {
				rp: !0,
				rt: !0
			},
			rt: {
				rp: !0,
				rt: !0
			},
			tbody: {
				tbody: !0,
				tfoot: !0
			},
			td: {
				td: !0,
				th: !0
			},
			tfoot: {
				tbody: !0
			},
			th: {
				td: !0,
				th: !0
			},
			thead: {
				tbody: !0,
				tfoot: !0
			},
			tr: {
				tr: !0
			}
		},
		doNotIndent: {
			pre: !0
		},
		allowUnquoted: !0,
		allowMissing: !0
	}: {
		autoSelfClosers: {},
		implicitlyClosed: {},
		contextGrabbers: {},
		doNotIndent: {},
		allowUnquoted: !1,
		allowMissing: !1
	},
	E = e.alignCDATA,
	F,
	I,
	G,
	K;
	return {
		startState: function() {
			return {
				tokenize: d,
				cc: [],
				indented: 0,
				startOfLine: !0,
				tagName: null,
				context: null
			}
		},
		token: function(a, d) {
			a.sol() && (d.startOfLine = !0, d.indented = a.indentation());
			if (a.eatSpace()) return null;
			K = I = F = null;
			var e = d.tokenize(a, d);
			d.type = I;
			if ((e || I) && "comment" != e) for (G = d; ! (d.cc.pop() || o)(I || e););
			d.startOfLine = !1;
			return K || e
		},
		indent: function(a, e, j) {
			var k = a.context;
			if (a.tokenize != g && a.tokenize != d || k && k.noIndent) return j ? j.match(/^(\s*)/)[0].length: 0;
			if (E && /<!\[CDATA\[/.test(e)) return 0;
			k && /^<\//.test(e) && (k = k.prev);
			for (; k && !k.startOfLine;) k = k.prev;
			return k ? k.indent + v: 0
		},
		electricChars: "/",
		configuration: e.htmlMode ? "html": "xml"
	}
});CodeMirror.defineMIME("text/xml", "xml");CodeMirror.defineMIME("application/xml", "xml");CodeMirror.mimeModes.hasOwnProperty("text/html") || CodeMirror.defineMIME("text/html", {
	name: "xml",
	htmlMode: !0
});CodeMirror.defineMode("javascript",
function(a, e) {
	function d(a, d) {
		for (var e = !1,
		g; null != (g = a.next());) {
			if (g == d && !e) return ! 1;
			e = !e && "\\" == g
		}
		return e
	}
	function g(a, d, e) {
		ba = a;
		La = e;
		return d
	}
	function j(a, e) {
		var l = a.next();
		if ('"' == l || "'" == l) {
			var m = function(a, e) {
				d(a, l) || (e.tokenize = j);
				return g("string", "string")
			};
			e.tokenize = m;
			return m(a, e)
		}
		if (/[\[\]{}\(\),;\:\.]/.test(l)) return g(l);
		if ("0" == l && a.eat(/x/i)) return a.eatWhile(/[\da-f]/i),
		g("number", "number");
		if (/\d/.test(l) || "-" == l && a.eat(/\d/)) return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),
		g("number", "number");
		if ("/" == l) {
			if (a.eat("*")) return m = k,
			e.tokenize = m,
			m(a, e);
			if (a.eat("/")) return a.skipToEnd(),
			g("comment", "comment");
			if ("operator" == e.lastType || "keyword c" == e.lastType || /^[\[{}\(,;:]$/.test(e.lastType)) return d(a, "/"),
			a.eatWhile(/[gimy]/),
			g("regexp", "string-2");
			a.eatWhile(V);
			return g("operator", null, a.current())
		}
		if ("#" == l) return a.skipToEnd(),
		g("error", "error");
		if (V.test(l)) return a.eatWhile(V),
		g("operator", null, a.current());
		a.eatWhile(/[\w\$_]/);
		var m = a.current(),
		n = ua.propertyIsEnumerable(m) && ua[m];
		return n && "." != e.lastType ? g(n.type, n.style, m) : g("variable", "variable", m)
	}
	function k(a, d) {
		for (var e = !1,
		k; k = a.next();) {
			if ("/" == k && e) {
				d.tokenize = j;
				break
			}
			e = "*" == k
		}
		return g("comment", "comment")
	}
	function l(a, d, e, g, j, k) {
		this.indented = a;
		this.column = d;
		this.type = e;
		this.prev = j;
		this.info = k;
		null != g && (this.align = g)
	}
	function m() {
		for (var a = arguments.length - 1; 0 <= a; a--) T.cc.push(arguments[a])
	}
	function n() {
		m.apply(null, arguments);
		return ! 0
	}
	function o(a) {
		function d(e) {
			for (; e; e = e.next) if (e.name == a) return ! 0;
			return ! 1
		}
		var e = T.state;
		e.context ? (T.marked = "def", d(e.localVars) || (e.localVars = {
			name: a,
			next: e.localVars
		})) : d(e.globalVars) || (e.globalVars = {
			name: a,
			next: e.globalVars
		})
	}
	function r() {
		T.state.context = {
			prev: T.state.context,
			vars: T.state.localVars
		};
		T.state.localVars = db
	}
	function u() {
		T.state.localVars = T.state.context.vars;
		T.state.context = T.state.context.prev
	}
	function s(a, d) {
		var e = function() {
			var e = T.state;
			e.lexical = new l(e.indented, T.stream.column(), a, null, e.lexical, d)
		};
		e.lex = !0;
		return e
	}
	function B() {
		var a = T.state;
		a.lexical.prev && (")" == a.lexical.type && (a.indented = a.lexical.indented), a.lexical = a.lexical.prev)
	}
	function z(a) {
		return function(d) {
			return d == a ? n() : ";" == a ? m() : n(arguments.callee)
		}
	}
	function v(a) {
		return "var" == a ? n(s("vardef"), ra, z(";"), B) : "keyword a" == a ? n(s("form"), D, v, B) : "keyword b" == a ? n(s("form"), v, B) : "{" == a ? n(s("}"), C, B) : ";" == a ? n() : "function" == a ? n(ca) : "for" == a ? n(s("form"), z("("), s(")"), ea, z(")"), B, v, B) : "variable" == a ? n(s("stat"), I) : "switch" == a ? n(s("form"), D, s("}", "switch"), z("{"), C, B, B) : "case" == a ? n(D, z(":")) : "default" == a ? n(z(":")) : "catch" == a ? n(s("form"), r, z("("), ha, z(")"), v, B, u) : m(s("stat"), D, z(";"), B)
	}
	function D(a) {
		return Ga.hasOwnProperty(a) ? n(F) : "function" == a ? n(ca) : "keyword c" == a ? n(E) : "(" == a ? n(s(")"), E, z(")"), B, F) : "operator" == a ? n(D) : "[" == a ? n(s("]"), J(D, "]"), B, F) : "{" == a ? n(s("}"), J(K, "}"), B, F) : n()
	}
	function E(a) {
		return a.match(/[;\}\)\],]/) ? m() : m(D)
	}
	function F(a, d) {
		if ("operator" == a) return /\+\+|--/.test(d) ? n(F) : "?" == d ? n(D, z(":"), D) : n(D);
		if (";" != a) {
			if ("(" == a) return n(s(")"), J(D, ")"), B, F);
			if ("." == a) return n(G, F);
			if ("[" == a) return n(s("]"), D, z("]"), B, F)
		}
	}
	function I(a) {
		return ":" == a ? n(B, v) : m(F, z(";"), B)
	}
	function G(a) {
		if ("variable" == a) return T.marked = "property",
		n()
	}
	function K(a) {
		if ("variable" == a) T.marked = "property";
		else if ("number" == a || "string" == a) T.marked = a + " property";
		if (Ga.hasOwnProperty(a)) return n(z(":"), D)
	}
	function J(a, d) {
		function e(g) {
			return "," == g ? n(a, e) : g == d ? n() : n(z(d))
		}
		return function(g) {
			return g == d ? n() : m(a, e)
		}
	}
	function C(a) {
		return "}" == a ? n() : m(v, C)
	}
	function N(a) {
		return ":" == a ? n(O) : m()
	}
	function O(a) {
		return "variable" == a ? (T.marked = "variable-3", n()) : m()
	}
	function ra(a, d) {
		return "variable" == a ? (o(d), P ? n(N, R) : n(R)) : m()
	}
	function R(a, d) {
		if ("\x3d" == d) return n(D, R);
		if ("," == a) return n(ra)
	}
	function ea(a) {
		return "var" == a ? n(ra, z(";"), Y) : ";" == a ? n(Y) : "variable" == a ? n(Z) : n(Y)
	}
	function Z(a, d) {
		return "in" == d ? n(D) : n(F, Y)
	}
	function Y(a, d) {
		return ";" == a ? n(W) : "in" == d ? n(D) : n(D, z(";"), W)
	}
	function W(a) {
		")" != a && n(D)
	}
	function ca(a, d) {
		if ("variable" == a) return o(d),
		n(ca);
		if ("(" == a) return n(s(")"), r, J(ha, ")"), B, v, u)
	}
	function ha(a, d) {
		if ("variable" == a) return o(d),
		P ? n(N) : n()
	}
	var M = a.indentUnit,
	ja = e.json,
	P = e.typescript,
	ua, H = function(a) {
		return {
			type: a,
			style: "keyword"
		}
	},
	fa = H("keyword a"),
	oa = H("keyword b"),
	ia = H("keyword c"),
	ka = H("operator"),
	L = {
		type: "atom",
		style: "atom"
	},
	fa = {
		"if": fa,
		"while": fa,
		"with": fa,
		"else": oa,
		"do": oa,
		"try": oa,
		"finally": oa,
		"return": ia,
		"break": ia,
		"continue": ia,
		"new": ia,
		"delete": ia,
		"throw": ia,
		"var": H("var"),
		"const": H("var"),
		let: H("var"),
		"function": H("function"),
		"catch": H("catch"),
		"for": H("for"),
		"switch": H("switch"),
		"case": H("case"),
		"default": H("default"),
		"in": ka,
		"typeof": ka,
		"instanceof": ka,
		"true": L,
		"false": L,
		"null": L,
		undefined: L,
		NaN: L,
		Infinity: L
	};
	if (P) {
		var oa = {
			type: "variable",
			style: "variable-3"
		},
		H = {
			"interface": H("interface"),
			"class": H("class"),
			"extends": H("extends"),
			constructor: H("constructor"),
			"public": H("public"),
			"private": H("private"),
			"protected": H("protected"),
			"static": H("static"),
			"super": H("super"),
			string: oa,
			number: oa,
			bool: oa,
			any: oa
		},
		S;
		for (S in H) fa[S] = H[S]
	}
	ua = fa;
	var V = /[+\-*&%=<>!?|]/,
	ba, La, Ga = {
		atom: !0,
		number: !0,
		variable: !0,
		string: !0,
		regexp: !0
	},
	T = {
		state: null,
		column: null,
		marked: null,
		cc: null
	},
	db = {
		name: "this",
		next: {
			name: "arguments"
		}
	};
	B.lex = !0;
	return {
		startState: function(a) {
			return {
				tokenize: j,
				lastType: null,
				cc: [],
				lexical: new l((a || 0) - M, 0, "block", !1),
				localVars: e.localVars,
				globalVars: e.globalVars,
				context: e.localVars && {
					vars: e.localVars
				},
				indented: 0
			}
		},
		token: function(a, d) {
			a.sol() && (d.lexical.hasOwnProperty("align") || (d.lexical.align = !1), d.indented = a.indentation());
			if (a.eatSpace()) return null;
			var e = d.tokenize(a, d);
			if ("comment" == ba) return e;
			d.lastType = ba;
			a: {
				var g = ba,
				j = La,
				k = d.cc;
				T.state = d;
				T.stream = a;
				T.marked = null;
				T.cc = k;
				d.lexical.hasOwnProperty("align") || (d.lexical.align = !0);
				for (;;) if ((k.length ? k.pop() : ja ? D: v)(g, j)) {
					for (; k.length && k[k.length - 1].lex;) k.pop()();
					if (T.marked) {
						e = T.marked;
						break a
					}
					if (g = "variable" == g) b: {
						for (g = d.localVars; g; g = g.next) if (g.name == j) {
							g = !0;
							break b
						}
						g = void 0
					}
					if (g) {
						e = "variable-2";
						break a
					}
					break a
				}
				e = void 0
			}
			return e
		},
		indent: function(a, d) {
			if (a.tokenize == k) return CodeMirror.Pass;
			if (a.tokenize != j) return 0;
			var e = d && d.charAt(0),
			g = a.lexical;
			"stat" == g.type && "}" == e && (g = g.prev);
			var l = g.type,
			m = e == l;
			return "vardef" == l ? g.indented + ("operator" == a.lastType || "," == a.lastType ? 4 : 0) : "form" == l && "{" == e ? g.indented: "form" == l ? g.indented + M: "stat" == l ? g.indented + ("operator" == a.lastType || "," == a.lastType ? M: 0) : "switch" == g.info && !m ? g.indented + (/^(?:case|default)\b/.test(d) ? M: 2 * M) : g.align ? g.column + (m ? 0 : 1) : g.indented + (m ? 0 : M)
		},
		electricChars: ":{}",
		jsonMode: ja
	}
});CodeMirror.defineMIME("text/javascript", "javascript");CodeMirror.defineMIME("text/ecmascript", "javascript");CodeMirror.defineMIME("application/javascript", "javascript");CodeMirror.defineMIME("application/ecmascript", "javascript");CodeMirror.defineMIME("application/json", {
	name: "javascript",
	json: !0
});CodeMirror.defineMIME("text/typescript", {
	name: "javascript",
	typescript: !0
});CodeMirror.defineMIME("application/typescript", {
	name: "javascript",
	typescript: !0
}); (function() {
	function a(a, k) {
		var l = a.getCursor(),
		m = a.getTokenAt(l),
		n = CodeMirror.innerMode(a.getMode(), m.state),
		o = n.state;
		if ("xml" != n.mode.name) return CodeMirror.Pass;
		var r = a.getOption("autoCloseTags"),
		u = "html" == n.mode.configuration,
		n = "object" == typeof r && r.dontCloseTags || u && d,
		u = "object" == typeof r && r.indentTags || u && g;
		if ("\x3e" == k && o.tagName) {
			r = o.tagName;
			m.end > l.ch && (r = r.slice(0, r.length - m.end + l.ch));
			var s = r.toLowerCase();
			if ("tag" == m.type && "closeTag" == o.type || /\/\s*$/.test(m.string) || n && -1 < e(n, s)) return CodeMirror.Pass;
			o = (m = u && -1 < e(u, s)) ? CodeMirror.Pos(l.line + 1, 0) : CodeMirror.Pos(l.line, l.ch + 1);
			a.replaceSelection("\x3e" + (m ? "\n\n": "") + "\x3c/" + r + "\x3e", {
				head: o,
				anchor: o
			});
			m && (a.indentLine(l.line + 1), a.indentLine(l.line + 2))
		} else if ("/" == k && "\x3c" == m.string)(r = o.context && o.context.tagName) && a.replaceSelection("/" + r + "\x3e", "end");
		else return CodeMirror.Pass
	}
	function e(a, d) {
		if (a.indexOf) return a.indexOf(d);
		for (var e = 0,
		g = a.length; e < g; ++e) if (a[e] == d) return e;
		return - 1
	}
	CodeMirror.defineOption("autoCloseTags", !1,
	function(d, e, g) {
		if (e && (g == CodeMirror.Init || !g)) {
			g = {
				name: "autoCloseTags"
			};
			if ("object" != typeof e || e.whenClosing) g["'/'"] = function(d) {
				return a(d, "/")
			};
			if ("object" != typeof e || e.whenOpening) g["'\x3e'"] = function(d) {
				return a(d, "\x3e")
			};
			d.addKeyMap(g)
		} else ! e && (g != CodeMirror.Init && g) && d.removeKeyMap("autoCloseTags")
	});
	var d = "area base br col command embed hr img input keygen link meta param source track wbr".split(" "),
	g = "applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ")
})();CodeMirror.showHint = function(a, e, d) {
	function g() {
		if (!a.somethingSelected()) if (d.async) e(a, j, d);
		else return j(e(a, d))
	}
	function j(e) {
		function j(a) {
			a = Math.max(0, Math.min(a, v.length - 1));
			F != a && (E.childNodes[F].className = "CodeMirror-hint", a = E.childNodes[F = a], a.className = "CodeMirror-hint CodeMirror-hint-active", a.offsetTop < E.scrollTop ? E.scrollTop = a.offsetTop - 3 : a.offsetTop + a.offsetHeight > E.scrollTop + E.clientHeight && (E.scrollTop = a.offsetTop + a.offsetHeight - E.clientHeight + 3))
		}
		function o() {
			Z = setTimeout(s, 100)
		}
		function r() {
			clearTimeout(Z)
		}
		function u() {
			var d = a.getScrollInfo(),
			e = a.getWrapperElement().getBoundingClientRect(),
			g = K + Y.top - d.top,
			j = g;
			J || (j += E.offsetHeight);
			if (j <= e.top || j >= e.bottom) return s();
			E.style.top = g + "px";
			E.style.left = G + Y.left - d.left + "px"
		}
		function s() {
			W || (W = !0, clearTimeout(ca), E.parentNode.removeChild(E), a.removeKeyMap(R), a.off("cursorActivity", z), a.off("blur", o), a.off("focus", r), a.off("scroll", u))
		}
		function B() {
			a.replaceRange(v[F].data, e.from, e.to);
			if (v[0].offset) {
				var d = a.getCursor();
				a.setCursor(d.line, d.ch + v[0].offset)
			}
			s()
		}
		function z() {
			clearTimeout(ca);
			var d = a.getCursor(),
			e = a.getLine(d.line).length;
			d.line != ha.line || e - d.ch != M - ha.ch || d.ch < k || a.somethingSelected() ? s() : ca = setTimeout(function() {
				s();
				l = !0;
				g()
			},
			70)
		}
		if (e && e.list.length) {
			var v = e.list;
			if (!l && !1 !== d.completeSingle && 1 == v.length) {
				a.replaceRange(v[0].data, e.from, e.to);
				if (v[0].offset) {
					var D = a.getCursor();
					a.setCursor(D.line, D.ch + v[0].offset)
				}
				return ! 0
			}
			var E = document.createElement("ul"),
			F = 0;
			E.className = "CodeMirror-hints";
			for (D = 0; D < v.length; ++D) {
				var I = E.appendChild(document.createElement("li"));
				I.className = "CodeMirror-hint" + (D ? "": " CodeMirror-hint-active");
				I.appendChild(document.createTextNode(v[D].text));
				I.hintId = D
			}
			var D = a.cursorCoords(!1 !== d.alignWithWord ? e.from: null),
			G = D.left,
			K = D.bottom,
			J = !0;
			E.style.left = G + "px";
			E.style.top = K + "px";
			document.body.appendChild(E);
			var C = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth),
			I = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight),
			N = E.getBoundingClientRect(),
			O = N.right - C,
			ra = N.bottom - I;
			0 < O && (N.right - N.left > C && (E.style.width = C - 5 + "px", O -= N.right - N.left - C), E.style.left = (G = D.left - O) + "px");
			0 < ra && (C = N.bottom - N.top, 0 < N.top - (D.bottom - D.top) - C ? (ra = C + (D.bottom - D.top), J = !1) : C > I && (E.style.height = I - 5 + "px", ra -= C - I), E.style.top = (K = D.bottom - ra) + "px");
			var R = {
				Up: function() {
					j(F - 1)
				},
				Down: function() {
					j(F + 1)
				},
				PageUp: function() {
					j(F - (Math.floor(E.clientHeight / E.firstChild.offsetHeight) || 1))
				},
				PageDown: function() {
					j(F + (Math.floor(E.clientHeight / E.firstChild.offsetHeight) || 1))
				},
				Home: function() {
					j(0)
				},
				End: function() {
					j(v.length - 1)
				},
				Enter: B,
				Tab: B,
				Esc: s
			};
			if (d.customKeys) for (var ea in d.customKeys) d.customKeys.hasOwnProperty(ea) && (D = d.customKeys[ea], /^(Up|Down|Enter|Esc)$/.test(ea) && (D = R[D]), R[ea] = D);
			a.addKeyMap(R);
			a.on("cursorActivity", z);
			var Z;
			a.on("blur", o);
			a.on("focus", r);
			var Y = a.getScrollInfo();
			a.on("scroll", u);
			CodeMirror.on(E, "dblclick",
			function(d) {
				d = d.target || d.srcElement;
				null != d.hintId && (F = d.hintId, B());
				setTimeout(function() {
					a.focus()
				},
				20)
			});
			CodeMirror.on(E, "click",
			function(d) {
				d = d.target || d.srcElement;
				null != d.hintId && j(d.hintId);
				setTimeout(function() {
					a.focus()
				},
				20)
			});
			var W = !1,
			ca, ha = a.getCursor(),
			M = a.getLine(ha.line).length;
			return ! 0
		}
	}
	d || (d = {});
	var k = a.getCursor().ch,
	l = !1;
	return g()
}; (function() {
	CodeMirror.xmlHints = {};
	CodeMirror.xmlHint = function(a) {
		var e = a.getCursor();
		if (0 < e.ch) {
			for (var d = a.getRange(CodeMirror.Pos(0, 0), e), g = a = null, j = 0, k = -1, l = 0, m = -1, n = d.length - 1; 0 <= n; n--) if ("\x3c" == d.charAt(n)) {
				var o = k; - 1 == o && (o = d.length);
				a = d.substring(n + 1, o);
				j = n;
				break
			} else " " == d.charAt(n) ? (o = m, -1 == o && (o = k), null == g && -1 != o && (g = d.slice(n + 1, o)), k = n) : '"' == d.charAt(n) ? l++:"\x3d" == d.charAt(n) && (m = n);
			k = "";
			for (n = d.length - 1; 0 <= n && !(" " == d[n] || "\x3c" == d[n]); n--) k = d[n] + k;
			if ('"' == k.charAt(k.length - 1) || "'" == k.charAt(k.length - 1)) k = "";
			n = d = d.slice(j, d.length - k.length);
			if (0 <= n.length) {
				j = RegExp("\x3c([^!?][^\\s/\x3e]*).*?\x3e", "g");
				for (d = []; null != (m = j.exec(n));) d.push({
					tag: m[1],
					selfclose: "/\x3e" === m[0].slice(m[0].length - 2)
				});
				j = d.length - 1;
				for (m = 0; 0 <= j; j--) o = d[j],
				"/" == o.tag[0] ? m++:!1 == o.selfclose && 0 < m && m--;
				d = n.lastIndexOf("\x3c");
				n.lastIndexOf("\x3e") < d && (n = n.slice(d), "\x3c" != n && (d = n.indexOf(" "), 0 > d && (d = n.indexOf("\t")), 0 > d && (d = n.indexOf("\n")), 0 > d && (d = n.length), n.slice(0, d)))
			}
			d = CodeMirror.xmlHints.tags;
			null != a && null != g && 0 != l % 2 ? d = CodeMirror.xmlHints.definitions[a][g] : null != a && 1 < a.length && (d = CodeMirror.xmlHints.definitions[a]._OPTIONS_);
			if ("undefined" === typeof d) return null;
			d = d.slice(0);
			for (n = d.length - 1; 0 <= n; n--) 0 < d[n].data.indexOf(k) && d.splice(n, 1);
			return {
				list: d,
				from: CodeMirror.Pos(e.line, e.ch - k.length),
				to: e
			}
		}
	}
})(); (function(a) {
	a.Jcrop = function(e, d) {
		function g(a) {
			return parseInt(a, 10) + "px"
		}
		function j(d) {
			d = a(d).offset();
			return [d.left, d.top]
		}
		function k(a) {
			return [a.pageX - N[0], a.pageY - N[1]]
		}
		function l(d) {
			"object" !== typeof d && (d = {});
			C = a.extend(C, d);
			"function" !== typeof C.onChange && (C.onChange = function() {});
			"function" !== typeof C.onSelect && (C.onSelect = function() {});
			"function" !== typeof C.onRelease && (C.onRelease = function() {})
		}
		function m(a, d) {
			N = j(Z);
			Fa.setCursor("move" === a ? a: a + "-resize");
			if ("move" === a) return Fa.activateHandlers(o(d), z);
			var e = T.getFixed(),
			g = r(a),
			k = T.getCorner(r(g));
			T.setPressed(T.getCorner(g));
			T.setCurrent(k);
			Fa.activateHandlers(n(a, e), z)
		}
		function n(a, d) {
			return function(e) {
				if (C.aspectRatio) switch (a) {
				case "e":
					e[1] = d.y + 1;
					break;
				case "w":
					e[1] = d.y + 1;
					break;
				case "n":
					e[0] = d.x + 1;
					break;
				case "s":
					e[0] = d.x + 1
				} else switch (a) {
				case "e":
					e[1] = d.y2;
					break;
				case "w":
					e[1] = d.y2;
					break;
				case "n":
					e[0] = d.x2;
					break;
				case "s":
					e[0] = d.x2
				}
				T.setCurrent(e);
				qa.update()
			}
		}
		function o(a) {
			var d = a;
			ub.watchKeys();
			return function(a) {
				T.moveOffset([a[0] - d[0], a[1] - d[1]]);
				d = a;
				qa.update()
			}
		}
		function r(a) {
			switch (a) {
			case "n":
				return "sw";
			case "s":
				return "nw";
			case "e":
				return "nw";
			case "w":
				return "ne";
			case "ne":
				return "sw";
			case "nw":
				return "se";
			case "se":
				return "nw";
			case "sw":
				return "ne"
			}
		}
		function u(a) {
			return function(d) {
				if (C.disabled || "move" === a && !C.allowMove) return ! 1;
				ba = !0;
				m(a, k(d));
				d.stopPropagation();
				d.preventDefault();
				return ! 1
			}
		}
		function s(a, d, e) {
			var g = a.width(),
			j = a.height();
			g > d && 0 < d && (g = d, j = d / a.width() * a.height());
			j > e && 0 < e && (j = e, g = e / a.height() * a.width());
			S = a.width() / g;
			V = a.height() / j;
			a.width(g).height(j)
		}
		function B(a) {
			return {
				x: parseInt(a.x * S, 10),
				y: parseInt(a.y * V, 10),
				x2: parseInt(a.x2 * S, 10),
				y2: parseInt(a.y2 * V, 10),
				w: parseInt(a.w * S, 10),
				h: parseInt(a.h * V, 10)
			}
		}
		function z() {
			var a = T.getFixed();
			a.w > C.minSelect[0] && a.h > C.minSelect[1] ? (qa.enableHandles(), qa.done()) : qa.release();
			Fa.setCursor(C.allowSelect ? "crosshair": "default")
		}
		function v(a) {
			if (C.disabled || !C.allowSelect) return ! 1;
			ba = !0;
			N = j(Z);
			qa.disableHandles();
			"crosshair" !== O && (Fa.setCursor("crosshair"), O = "crosshair");
			var d = k(a);
			T.setPressed(d);
			qa.update();
			Fa.activateHandlers(D, z);
			ub.watchKeys();
			a.stopPropagation();
			a.preventDefault();
			return ! 1
		}
		function D(a) {
			T.setCurrent(a);
			qa.update()
		}
		function E() {
			var d = a("\x3cdiv\x3e\x3c/div\x3e").addClass(C.baseClass + "-tracker");
			a.browser.msie && d.css({
				opacity: 0,
				backgroundColor: "white"
			});
			return d
		}
		function F(a) {
			I([parseInt(a[0], 10) / S, parseInt(a[1], 10) / V, parseInt(a[2], 10) / S, parseInt(a[3], 10) / V])
		}
		function I(a) {
			T.setPressed([a[0], a[1]]);
			T.setCurrent([a[2], a[3]]);
			qa.update()
		}
		function G() {
			C.disabled = !0;
			qa.disableHandles();
			qa.setCursor("default");
			Fa.setCursor("default")
		}
		function K() {
			C.disabled = !1;
			J()
		}
		function J(d) {
			C.allowResize ? d ? qa.enableOnly() : qa.enableHandles() : qa.disableHandles();
			Fa.setCursor(C.allowSelect ? "crosshair": "default");
			qa.setCursor(C.allowMove ? "move": "default");
			C.hasOwnProperty("setSelect") && (F(C.setSelect), qa.done(), delete C.setSelect);
			C.hasOwnProperty("trueSize") && (S = C.trueSize[0] / Y, V = C.trueSize[1] / W);
			C.hasOwnProperty("bgColor") && (a.fx.step.hasOwnProperty("backgroundColor") && C.fadeTime ? ca.animate({
				backgroundColor: C.bgColor
			},
			{
				queue: !1,
				duration: C.fadeTime
			}) : ca.css("backgroundColor", C.bgColor), delete C.bgColor);
			C.hasOwnProperty("bgOpacity") && (fa = C.bgOpacity, qa.isAwake() && (C.fadeTime ? Z.fadeTo(C.fadeTime, fa) : ca.css("opacity", C.opacity)), delete C.bgOpacity);
			oa = C.maxSize[0] || 0;
			ia = C.maxSize[1] || 0;
			ka = C.minSize[0] || 0;
			L = C.minSize[1] || 0;
			C.hasOwnProperty("outerImage") && (Z.attr("src", C.outerImage), delete C.outerImage);
			qa.refresh()
		}
		var C = a.extend({},
		a.Jcrop.defaults),
		N,
		O,
		ra = !1;
		a.browser.msie && "6" === a.browser.version.split(".")[0] && (ra = !0);
		"object" !== typeof e && (e = a(e)[0]);
		"object" !== typeof d && (d = {});
		l(d);
		var R = {
			border: "none",
			margin: 0,
			padding: 0,
			position: "absolute"
		},
		ea = a(e),
		Z = ea.clone().removeAttr("id").css(R);
		Z.width(ea.width());
		Z.height(ea.height());
		ea.after(Z).hide();
		s(Z, C.boxWidth, C.boxHeight);
		var Y = Z.width(),
		W = Z.height(),
		ca = a("\x3cdiv /\x3e").width(Y).height(W).addClass(C.baseClass + "-holder").css({
			position: "relative",
			backgroundColor: C.bgColor
		}).insertAfter(ea).append(Z);
		delete C.bgColor;
		C.addClass && ca.addClass(C.addClass);
		var ha = a("\x3cimg /\x3e").attr("src", Z.attr("src")).css(R).width(Y).height(W),
		M = a("\x3cdiv /\x3e").width("100%").height("100%").css({
			zIndex: 310,
			position: "absolute",
			overflow: "hidden"
		}).append(ha),
		ja = a("\x3cdiv /\x3e").width("100%").height("100%").css("zIndex", 320),
		P = a("\x3cdiv /\x3e").css({
			position: "absolute",
			zIndex: 300
		}).insertBefore(Z).append(M, ja);
		ra && P.css({
			overflowY: "hidden"
		});
		var ua = C.boundary,
		H = E().width(Y + 2 * ua).height(W + 2 * ua).css({
			position: "absolute",
			top: g( - ua),
			left: g( - ua),
			zIndex: 290
		}).mousedown(v),
		fa = C.bgOpacity,
		oa,
		ia,
		ka,
		L,
		S,
		V,
		ba,
		La;
		N = j(Z);
		var Ga, R = function() {
			var a = {},
			d = ["touchstart", "touchmove", "touchend"],
			e = document.createElement("div"),
			g;
			try {
				for (g = 0; g < d.length; g++) {
					var j = d[g],
					j = "on" + j,
					k = j in e;
					k || (e.setAttribute(j, "return;"), k = "function" == typeof e[j]);
					a[d[g]] = k
				}
				return a.touchstart && a.touchend && a.touchmove
			} catch(l) {
				return ! 1
			}
		};
		Ga = {
			createDragger: function(a) {
				return function(d) {
					d.pageX = d.originalEvent.changedTouches[0].pageX;
					d.pageY = d.originalEvent.changedTouches[0].pageY;
					if (C.disabled || "move" === a && !C.allowMove) return ! 1;
					ba = !0;
					m(a, k(d));
					d.stopPropagation();
					d.preventDefault();
					return ! 1
				}
			},
			newSelection: function(a) {
				a.pageX = a.originalEvent.changedTouches[0].pageX;
				a.pageY = a.originalEvent.changedTouches[0].pageY;
				return v(a)
			},
			isSupported: R,
			support: !0 === C.touchSupport || !1 === C.touchSupport ? C.touchSupport: R()
		};
		var T, db = function() {
			if (!C.aspectRatio) {
				var a = ma - X,
				d = pa - Q;
				oa && Math.abs(a) > oa && (ma = 0 < a ? X + oa: X - oa);
				ia && Math.abs(d) > ia && (pa = 0 < d ? Q + ia: Q - ia);
				L / V && Math.abs(d) < L / V && (pa = 0 < d ? Q + L / V: Q - L / V);
				ka / S && Math.abs(a) < ka / S && (ma = 0 < a ? X + ka / S: X - ka / S);
				0 > X && (ma -= X, X -= X);
				0 > Q && (pa -= Q, Q -= Q);
				0 > ma && (X -= ma, ma -= ma);
				0 > pa && (Q -= pa, pa -= pa);
				ma > Y && (a = ma - Y, X -= a, ma -= a);
				pa > W && (a = pa - W, Q -= a, pa -= a);
				X > Y && (a = X - W, pa -= a, Q -= a);
				Q > W && (a = Q - W, pa -= a, Q -= a);
				return kb(za(X, Q, ma, pa))
			}
			var a = C.aspectRatio,
			d = C.minSize[0] / S,
			e = C.maxSize[0] / S,
			g = ma - X,
			j = pa - Q,
			k = Math.abs(g),
			l = Math.abs(j);
			0 === e && (e = 10 * Y);
			k / l < a ? (k = pa, w = l * a, l = 0 > g ? X - w: w + X, 0 > l ? (l = 0, h = Math.abs((l - X) / a), k = 0 > j ? Q - h: h + Q) : l > Y && (l = Y, h = Math.abs((l - X) / a), k = 0 > j ? Q - h: h + Q)) : (l = ma, h = k / a, k = 0 > j ? Q - h: Q + h, 0 > k ? (k = 0, w = Math.abs((k - Q) * a), l = 0 > g ? X - w: w + X) : k > W && (k = W, w = Math.abs(k - Q) * a, l = 0 > g ? X - w: w + X));
			l > X ? (l - X < d ? l = X + d: l - X > e && (l = X + e), k = k > Q ? Q + (l - X) / a: Q - (l - X) / a) : l < X && (X - l < d ? l = X - d: X - l > e && (l = X - e), k = k > Q ? Q + (X - l) / a: Q - (X - l) / a);
			0 > l ? (X -= l, l = 0) : l > Y && (X -= l - Y, l = Y);
			0 > k ? (Q -= k, k = 0) : k > W && (Q -= k - W, k = W);
			return kb(za(X, Q, l, k))
		},
		va = function(a) {
			0 > a[0] && (a[0] = 0);
			0 > a[1] && (a[1] = 0);
			a[0] > Y && (a[0] = Y);
			a[1] > W && (a[1] = W);
			return [a[0], a[1]]
		},
		za = function(a, d, e, g) {
			var j = a,
			k = e,
			l = d,
			m = g;
			e < a && (j = e, k = a);
			g < d && (l = g, m = d);
			return [Math.round(j), Math.round(l), Math.round(k), Math.round(m)]
		},
		kb = function(a) {
			return {
				x: a[0],
				y: a[1],
				x2: a[2],
				y2: a[3],
				w: a[2] - a[0],
				h: a[3] - a[1]
			}
		},
		X = 0,
		Q = 0,
		ma = 0,
		pa = 0,
		wa,
		sa;
		T = {
			flipCoords: za,
			setPressed: function(a) {
				a = va(a);
				ma = X = a[0];
				pa = Q = a[1]
			},
			setCurrent: function(a) {
				a = va(a);
				wa = a[0] - ma;
				sa = a[1] - pa;
				ma = a[0];
				pa = a[1]
			},
			getOffset: function() {
				return [wa, sa]
			},
			moveOffset: function(a) {
				var d = a[0];
				a = a[1];
				0 > X + d && (d -= d + X);
				0 > Q + a && (a -= a + Q);
				W < pa + a && (a += W - (pa + a));
				Y < ma + d && (d += Y - (ma + d));
				X += d;
				ma += d;
				Q += a;
				pa += a
			},
			getCorner: function(a) {
				var d = db();
				switch (a) {
				case "ne":
					return [d.x2, d.y];
				case "nw":
					return [d.x, d.y];
				case "se":
					return [d.x2, d.y2];
				case "sw":
					return [d.x, d.y2]
				}
			},
			getFixed: db
		};
		var qa, R = function(d) {
			d = a("\x3cdiv /\x3e").css({
				position: "absolute",
				opacity: C.borderOpacity
			}).addClass(C.baseClass + "-" + d);
			M.append(d);
			return d
		},
		Ma = function(d, e) {
			var g = a("\x3cdiv /\x3e").mousedown(u(d)).css({
				cursor: d + "-resize",
				position: "absolute",
				zIndex: e
			});
			Ga.support && g.bind("touchstart", Ga.createDragger(d));
			ja.append(g);
			return g
		},
		ya = function(a) {
			var d = C.handleSize,
			e = d,
			j = da,
			k = da;
			switch (a) {
			case "n":
			case "s":
				d = "100%";
				break;
			case "e":
			case "w":
				e = "100%"
			}
			return Ma(a, xa++).width(d).height(e).css({
				top: g( - j + 1),
				left: g( - k + 1)
			})
		},
		Pa = function(a) {
			var d;
			for (d = 0; d < a.length; d++) la[a[d]] = Ma(a[d], xa++).css({
				top: g( - da + 1),
				left: g( - da + 1),
				opacity: C.handleOpacity
			}).addClass(C.baseClass + "-handle")
		},
		Za = function(a) {
			var d = Math.round(a.h / 2 - da),
			e = Math.round(a.w / 2 - da),
			j = a.w - da;
			a = a.h - da;
			la.e && (la.e.css({
				top: g(d),
				left: g(j)
			}), la.w.css({
				top: g(d)
			}), la.s.css({
				top: g(a),
				left: g(e)
			}), la.n.css({
				left: g(e)
			}));
			la.ne && (la.ne.css({
				left: g(j)
			}), la.se.css({
				top: g(a),
				left: g(j)
			}), la.sw.css({
				top: g(a)
			}));
			la.b && (la.b.css({
				top: g(a)
			}), la.r.css({
				left: g(j)
			}))
		},
		Ua = function() {
			var a = T.getFixed();
			T.setPressed([a.x, a.y]);
			T.setCurrent([a.x2, a.y2]);
			Aa()
		},
		Aa = function() {
			if (U) return Lb()
		},
		Lb = function() {
			var a = T.getFixed(),
			d = a.h;
			P.width(a.w).height(d);
			var d = a.x,
			e = a.y;
			ha.css({
				top: g( - e),
				left: g( - d)
			});
			P.css({
				top: g(e),
				left: g(d)
			});
			Na && Za(a);
			U || (P.show(), C.bgFade ? Z.fadeTo(C.fadeTime, fa) : Z.css("opacity", fa), U = !0);
			C.onChange.call(Ta, B(a))
		},
		Mb = function() {
			Na = !0;
			if (C.allowResize) return Za(T.getFixed()),
			ja.show(),
			!0
		},
		$a = function() {
			Na = !1;
			ja.hide()
		},
		Va = function(a) {
			void 0 === a ? $a() : Mb()
		},
		U,
		xa = 370,
		la = {},
		Na = !1,
		da = C.handleOffset;
		C.drawBorders && (R("hline"), R("hline bottom"), R("vline"), R("vline right"));
		C.dragEdges && (la.t = ya("n"), la.b = ya("s"), la.r = ya("e"), la.l = ya("w"));
		C.sideHandles && Pa(["n", "s", "e", "w"]);
		C.cornerHandles && Pa(["sw", "nw", "ne", "se"]);
		var lb = E().mousedown(u("move")).css({
			cursor: "move",
			position: "absolute",
			zIndex: 360
		});
		Ga.support && lb.bind("touchstart.jcrop", Ga.createDragger("move"));
		M.append(lb);
		$a();
		qa = {
			updateVisible: Aa,
			update: Lb,
			release: function() {
				$a();
				P.hide();
				C.bgFade ? Z.fadeTo(C.fadeTime, 1) : Z.css("opacity", 1);
				U = !1;
				C.onRelease.call(Ta)
			},
			refresh: Ua,
			isAwake: function() {
				return U
			},
			setCursor: function(a) {
				lb.css("cursor", a)
			},
			enableHandles: Mb,
			enableOnly: function() {
				Na = !0
			},
			showHandles: function() {
				Na && (Za(T.getFixed()), ja.show())
			},
			disableHandles: $a,
			animMode: Va,
			done: function() {
				Va(!1);
				Ua()
			}
		};
		var Fa, Da = function(a) {
			Jb(k(a));
			return ! 1
		},
		Ja = function(d) {
			d.preventDefault();
			d.stopPropagation();
			ba && (ba = !1, pb(k(d)), qa.isAwake() && C.onSelect.call(Ta, B(T.getFixed())), H.css({
				zIndex: 290
			}), Eb && a(document).unbind("mousemove", Da).unbind("mouseup", Ja), Jb = function() {},
			pb = function() {});
			return ! 1
		},
		R = function(a) {
			a.pageX = a.originalEvent.changedTouches[0].pageX;
			a.pageY = a.originalEvent.changedTouches[0].pageY;
			return Da(a)
		},
		ya = function(a) {
			a.pageX = a.originalEvent.changedTouches[0].pageX;
			a.pageY = a.originalEvent.changedTouches[0].pageY;
			return Ja(a)
		},
		Jb = function() {},
		pb = function() {},
		Eb = C.trackDocument;
		Ga.support && a(document).bind("touchmove", R).bind("touchend", ya);
		Eb || H.mousemove(Da).mouseup(Ja).mouseout(Ja);
		Z.before(H);
		Fa = {
			activateHandlers: function(d, e) {
				ba = !0;
				Jb = d;
				pb = e;
				H.css({
					zIndex: 450
				});
				Eb && a(document).bind("mousemove", Da).bind("mouseup", Ja);
				return ! 1
			},
			setCursor: function(a) {
				H.css("cursor", a)
			}
		};
		var ub, R = function() {
			Oa.hide()
		},
		ob = function(a, d, e) {
			C.allowMove && (T.moveOffset([d, e]), qa.updateVisible());
			a.preventDefault();
			a.stopPropagation()
		},
		ya = function(a) {
			if (a.ctrlKey) return ! 0;
			var d = (La = a.shiftKey ? !0 : !1) ? 10 : 1;
			switch (a.keyCode) {
			case 37:
				ob(a, -d, 0);
				break;
			case 39:
				ob(a, d, 0);
				break;
			case 38:
				ob(a, 0, -d);
				break;
			case 40:
				ob(a, 0, d);
				break;
			case 27:
				qa.release();
				break;
			case 9:
				return ! 0
			}
			return ! 1
		},
		Oa = a('\x3cinput type\x3d"radio" /\x3e').css({
			position: "fixed",
			left: "-120px",
			width: "12px"
		}),
		Pa = a("\x3cdiv /\x3e").css({
			position: "absolute",
			overflow: "hidden"
		}).append(Oa);
		C.keySupport && (Oa.keydown(ya).blur(R), ra || !C.fixedSupport ? (Oa.css({
			position: "absolute",
			left: "-20px"
		}), Pa.append(Oa).insertBefore(Z)) : Oa.insertBefore(Z));
		ub = {
			watchKeys: function() {
				C.keySupport && (Oa.show(), Oa.focus())
			}
		};
		Ga.support && H.bind("touchstart", Ga.newSelection);
		ja.hide();
		J(!0);
		var Ta = {
			setImage: function(a, d) {
				qa.release();
				G();
				var e = new Image;
				e.onload = function() {
					var g = e.height,
					j = C.boxWidth,
					k = C.boxHeight;
					Z.width(e.width).height(g);
					Z.attr("src", a);
					ha.attr("src", a);
					s(Z, j, k);
					Y = Z.width();
					W = Z.height();
					ha.width(Y).height(W);
					H.width(Y + 2 * ua).height(W + 2 * ua);
					ca.width(Y).height(W);
					K();
					"function" === typeof d && d.call(Ta)
				};
				e.src = a
			},
			animateTo: function(a, d) {
				var e = parseInt(a[0], 10) / S,
				g = parseInt(a[1], 10) / V,
				j = parseInt(a[2], 10) / S,
				k = parseInt(a[3], 10) / V,
				e = T.flipCoords(e, g, j, k),
				g = T.getFixed(),
				l = [g.x, g.y, g.x2, g.y2],
				m = C.animationDelay,
				n = e[0] - l[0],
				o = e[1] - l[1],
				r = e[2] - l[2],
				s = e[3] - l[3],
				v = 0,
				u = C.swingSpeed;
				x = l[0];
				y = l[1];
				j = l[2];
				k = l[3];
				qa.animMode(!0);
				var z = function() {
					v += (100 - v) / u;
					l[0] = x + v / 100 * n;
					l[1] = y + v / 100 * o;
					l[2] = j + v / 100 * r;
					l[3] = k + v / 100 * s;
					99.8 <= v && (v = 100);
					100 > v ? (I(l), window.setTimeout(z, m)) : (qa.done(), "function" === typeof d && d.call(Ta))
				};
				window.setTimeout(z, m)
			},
			setSelect: F,
			setOptions: function(a) {
				l(a);
				J()
			},
			tellSelect: function() {
				return B(T.getFixed())
			},
			tellScaled: function() {
				return T.getFixed()
			},
			setClass: function(a) {
				ca.removeClass().addClass(C.baseClass + "-holder").addClass(a)
			},
			disable: G,
			enable: K,
			cancel: function() {
				qa.done();
				Fa.activateHandlers(null, null)
			},
			release: qa.release,
			destroy: function() {
				ca.remove();
				ea.show();
				a(e).removeData("Jcrop")
			},
			focus: ub.watchKeys,
			getBounds: function() {
				return [Y * S, W * V]
			},
			getWidgetSize: function() {
				return [Y, W]
			},
			getScaleFactor: function() {
				return [S, V]
			},
			ui: {
				holder: ca,
				selection: P
			}
		};
		a.browser.msie && ca.bind("selectstart",
		function() {
			return ! 1
		});
		ea.data("Jcrop", Ta);
		return Ta
	};
	a.fn.Jcrop = function(e, d) {
		this.each(function() {
			if (a(this).data("Jcrop")) {
				if ("api" === e) return a(this).data("Jcrop");
				a(this).data("Jcrop").setOptions(e)
			} else {
				var g = this,
				j = "object" === typeof e ? e: {},
				k = j.useImg || g.src,
				l = new Image;
				l.onload = function() {
					function e() {
						if (!l.width || !l.height) window.setTimeout(e, 50);
						else {
							var k = a.Jcrop(g, j);
							"function" === typeof d && d.call(k)
						}
					}
					window.setTimeout(e, 50)
				};
				l.src = k
			}
		});
		return this
	};
	a.Jcrop.defaults = {
		allowSelect: !0,
		allowMove: !0,
		allowResize: !0,
		trackDocument: !0,
		baseClass: "jcrop",
		addClass: null,
		bgColor: "black",
		bgOpacity: 0.6,
		bgFade: !1,
		borderOpacity: 0.4,
		handleOpacity: 0.5,
		handleSize: 9,
		handleOffset: 5,
		aspectRatio: 0,
		keySupport: !0,
		cornerHandles: !0,
		sideHandles: !0,
		drawBorders: !0,
		dragEdges: !0,
		fixedSupport: !0,
		touchSupport: null,
		boxWidth: 0,
		boxHeight: 0,
		boundary: 2,
		fadeTime: 400,
		animationDelay: 20,
		swingSpeed: 3,
		minSelect: [0, 0],
		maxSize: [0, 0],
		minSize: [0, 0],
		onChange: function() {},
		onSelect: function() {},
		onRelease: function() {}
	}
})(jQuery); (function(a) {
	function e(e) {
		var j;
		return e && e.constructor == Array && 3 == e.length ? e: (j = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e)) ? [parseInt(j[1]), parseInt(j[2]), parseInt(j[3])] : (j = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e)) ? [2.55 * parseFloat(j[1]), 2.55 * parseFloat(j[2]), 2.55 * parseFloat(j[3])] : (j = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e)) ? [parseInt(j[1], 16), parseInt(j[2], 16), parseInt(j[3], 16)] : (j = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e)) ? [parseInt(j[1] + j[1], 16), parseInt(j[2] + j[2], 16), parseInt(j[3] + j[3], 16)] : d[a.trim(e).toLowerCase()]
	}
	a.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),
	function(d, j) {
		a.fx.step[j] = function(d) {
			if (0 == d.state) {
				var g;
				g = d.elem;
				var m = j,
				n;
				do {
					n = a.curCSS(g, m);
					if ("" != n && "transparent" != n || a.nodeName(g, "body")) break;
					m = "backgroundColor"
				} while ( g = g . parentNode );
				g = e(n);
				d.start = g;
				d.end = e(d.end)
			}
			d.elem.style[j] = "rgb(" + [Math.max(Math.min(parseInt(d.pos * (d.end[0] - d.start[0]) + d.start[0]), 255), 0), Math.max(Math.min(parseInt(d.pos * (d.end[1] - d.start[1]) + d.start[1]), 255), 0), Math.max(Math.min(parseInt(d.pos * (d.end[2] - d.start[2]) + d.start[2]), 255), 0)].join() + ")"
		}
	});
	var d = {
		aqua: [0, 255, 255],
		azure: [240, 255, 255],
		beige: [245, 245, 220],
		black: [0, 0, 0],
		blue: [0, 0, 255],
		brown: [165, 42, 42],
		cyan: [0, 255, 255],
		darkblue: [0, 0, 139],
		darkcyan: [0, 139, 139],
		darkgrey: [169, 169, 169],
		darkgreen: [0, 100, 0],
		darkkhaki: [189, 183, 107],
		darkmagenta: [139, 0, 139],
		darkolivegreen: [85, 107, 47],
		darkorange: [255, 140, 0],
		darkorchid: [153, 50, 204],
		darkred: [139, 0, 0],
		darksalmon: [233, 150, 122],
		darkviolet: [148, 0, 211],
		fuchsia: [255, 0, 255],
		gold: [255, 215, 0],
		green: [0, 128, 0],
		indigo: [75, 0, 130],
		khaki: [240, 230, 140],
		lightblue: [173, 216, 230],
		lightcyan: [224, 255, 255],
		lightgreen: [144, 238, 144],
		lightgrey: [211, 211, 211],
		lightpink: [255, 182, 193],
		lightyellow: [255, 255, 224],
		lime: [0, 255, 0],
		magenta: [255, 0, 255],
		maroon: [128, 0, 0],
		navy: [0, 0, 128],
		olive: [128, 128, 0],
		orange: [255, 165, 0],
		pink: [255, 192, 203],
		purple: [128, 0, 128],
		violet: [128, 0, 128],
		red: [255, 0, 0],
		silver: [192, 192, 192],
		white: [255, 255, 255],
		yellow: [255, 255, 0]
	}
})(jQuery); (function(a) {
	a.flexslider = function(e, d) {
		var g = a(e);
		g.vars = a.extend({},
		a.flexslider.defaults, d);
		var j = g.vars.namespace,
		k = window.navigator && window.navigator.msPointerEnabled && window.MSGesture,
		l = ("ontouchstart" in window || k || window.DocumentTouch && document instanceof DocumentTouch) && g.vars.touch,
		m = "",
		n,
		o = "vertical" === g.vars.direction,
		r = g.vars.reverse,
		u = 0 < g.vars.itemWidth,
		s = "fade" === g.vars.animation,
		B = "" !== g.vars.asNavFor,
		z = {};
		a.data(e, "flexslider", g);
		z = {
			init: function() {
				g.animating = !1;
				g.currentSlide = parseInt(g.vars.startAt ? g.vars.startAt: 0);
				isNaN(g.currentSlide) && (g.currentSlide = 0);
				g.animatingTo = g.currentSlide;
				g.atEnd = 0 === g.currentSlide || g.currentSlide === g.last;
				g.containerSelector = g.vars.selector.substr(0, g.vars.selector.search(" "));
				g.slides = a(g.vars.selector, g);
				g.container = a(g.containerSelector, g);
				g.count = g.slides.length;
				g.syncExists = 0 < a(g.vars.sync).length;
				"slide" === g.vars.animation && (g.vars.animation = "swing");
				g.prop = o ? "top": "marginLeft";
				g.args = {};
				g.manualPause = !1;
				g.stopped = !1;
				g.started = !1;
				g.startTimeout = null;
				var d;
				if (d = !g.vars.video) if (d = !s) if (d = g.vars.useCSS) a: {
					d = document.createElement("div");
					var e = ["perspectiveProperty", "WebkitPerspective", "MozPerspective", "OPerspective", "msPerspective"],
					j;
					for (j in e) if (void 0 !== d.style[e[j]]) {
						g.pfx = e[j].replace("Perspective", "").toLowerCase();
						g.prop = "-" + g.pfx + "-transform";
						d = !0;
						break a
					}
					d = !1
				}
				g.transitions = d;
				"" !== g.vars.controlsContainer && (g.controlsContainer = 0 < a(g.vars.controlsContainer).length && a(g.vars.controlsContainer));
				"" !== g.vars.manualControls && (g.manualControls = 0 < a(g.vars.manualControls).length && a(g.vars.manualControls));
				g.vars.randomize && (g.slides.sort(function() {
					return Math.round(Math.random()) - 0.5
				}), g.container.empty().append(g.slides));
				g.doMath();
				g.setup("init");
				g.vars.controlNav && z.controlNav.setup();
				g.vars.directionNav && z.directionNav.setup();
				g.vars.keyboard && (1 === a(g.containerSelector).length || g.vars.multipleKeyboard) && a(document).bind("keyup",
				function(a) {
					a = a.keyCode;
					if (!g.animating && (39 === a || 37 === a)) a = 39 === a ? g.getTarget("next") : 37 === a ? g.getTarget("prev") : !1,
					g.flexAnimate(a, g.vars.pauseOnAction)
				});
				g.vars.mousewheel && g.bind("mousewheel",
				function(a, d) {
					a.preventDefault();
					var e = 0 > d ? g.getTarget("next") : g.getTarget("prev");
					g.flexAnimate(e, g.vars.pauseOnAction)
				});
				g.vars.pausePlay && z.pausePlay.setup();
				g.vars.slideshow && g.vars.pauseInvisible && z.pauseInvisible.init();
				if (g.vars.slideshow && (g.vars.pauseOnHover && g.hover(function() { ! g.manualPlay && !g.manualPause && g.pause()
				},
				function() { ! g.manualPause && (!g.manualPlay && !g.stopped) && g.play()
				}), !g.vars.pauseInvisible || !z.pauseInvisible.isHidden())) 0 < g.vars.initDelay ? g.startTimeout = setTimeout(g.play, g.vars.initDelay) : g.play();
				B && z.asNav.setup();
				l && g.vars.touch && z.touch(); (!s || s && g.vars.smoothHeight) && a(window).bind("resize orientationchange focus", z.resize);
				g.find("img").attr("draggable", "false");
				setTimeout(function() {
					g.vars.start(g)
				},
				200)
			},
			asNav: {
				setup: function() {
					g.asNav = !0;
					g.animatingTo = Math.floor(g.currentSlide / g.move);
					g.currentItem = g.currentSlide;
					g.slides.removeClass(j + "active-slide").eq(g.currentItem).addClass(j + "active-slide");
					k ? (e._slider = g, g.slides.each(function() {
						this._gesture = new MSGesture;
						this._gesture.target = this;
						this.addEventListener("MSPointerDown",
						function(a) {
							a.preventDefault();
							a.currentTarget._gesture && a.currentTarget._gesture.addPointer(a.pointerId)
						},
						!1);
						this.addEventListener("MSGestureTap",
						function(d) {
							d.preventDefault();
							d = a(this);
							var e = d.index(); ! a(g.vars.asNavFor).data("flexslider").animating && !d.hasClass("active") && (g.direction = g.currentItem < e ? "next": "prev", g.flexAnimate(e, g.vars.pauseOnAction, !1, !0, !0))
						})
					})) : g.slides.click(function(d) {
						d.preventDefault();
						d = a(this);
						var e = d.index();
						0 >= d.offset().left - a(g).scrollLeft() && d.hasClass(j + "active-slide") ? g.flexAnimate(g.getTarget("prev"), !0) : !a(g.vars.asNavFor).data("flexslider").animating && !d.hasClass(j + "active-slide") && (g.direction = g.currentItem < e ? "next": "prev", g.flexAnimate(e, g.vars.pauseOnAction, !1, !0, !0))
					})
				}
			},
			controlNav: {
				setup: function() {
					g.manualControls ? z.controlNav.setupManual() : z.controlNav.setupPaging()
				},
				setupPaging: function() {
					var d = 1,
					e, k;
					g.controlNavScaffold = a('\x3col class\x3d"' + j + "control-nav " + j + ("thumbnails" === g.vars.controlNav ? "control-thumbs": "control-paging") + '"\x3e\x3c/ol\x3e');
					if (1 < g.pagingCount) for (var l = 0; l < g.pagingCount; l++) k = g.slides.eq(l),
					e = "thumbnails" === g.vars.controlNav ? '\x3cimg src\x3d"' + k.attr("data-thumb") + '"/\x3e': "\x3ca\x3e" + d + "\x3c/a\x3e",
					"thumbnails" === g.vars.controlNav && !0 === g.vars.thumbCaptions && (k = k.attr("data-thumbcaption"), "" != k && void 0 != k && (e += '\x3cspan class\x3d"' + j + 'caption"\x3e' + k + "\x3c/span\x3e")),
					g.controlNavScaffold.append("\x3cli\x3e" + e + "\x3c/li\x3e"),
					d++;
					g.controlsContainer ? a(g.controlsContainer).append(g.controlNavScaffold) : g.append(g.controlNavScaffold);
					z.controlNav.set();
					z.controlNav.active();
					g.controlNavScaffold.delegate("a, img", "click touchend MSPointerUp",
					function(d) {
						d.preventDefault();
						if ("" === m || m === d.type) {
							var e = a(this),
							k = g.controlNav.index(e);
							e.hasClass(j + "active") || (g.direction = k > g.currentSlide ? "next": "prev", g.flexAnimate(k, g.vars.pauseOnAction))
						}
						"" === m && (m = d.type);
						z.setToClearWatchedEvent()
					})
				},
				setupManual: function() {
					g.controlNav = g.manualControls;
					z.controlNav.active();
					g.controlNav.bind("click touchend MSPointerUp",
					function(d) {
						d.preventDefault();
						if ("" === m || m === d.type) {
							var e = a(this),
							k = g.controlNav.index(e);
							e.hasClass(j + "active") || (k > g.currentSlide ? g.direction = "next": g.direction = "prev", g.flexAnimate(k, g.vars.pauseOnAction))
						}
						"" === m && (m = d.type);
						z.setToClearWatchedEvent()
					})
				},
				set: function() {
					g.controlNav = a("." + j + "control-nav li " + ("thumbnails" === g.vars.controlNav ? "img": "a"), g.controlsContainer ? g.controlsContainer: g)
				},
				active: function() {
					g.controlNav.removeClass(j + "active").eq(g.animatingTo).addClass(j + "active")
				},
				update: function(d, e) {
					1 < g.pagingCount && "add" === d ? g.controlNavScaffold.append(a("\x3cli\x3e\x3ca\x3e" + g.count + "\x3c/a\x3e\x3c/li\x3e")) : 1 === g.pagingCount ? g.controlNavScaffold.find("li").remove() : g.controlNav.eq(e).closest("li").remove();
					z.controlNav.set();
					1 < g.pagingCount && g.pagingCount !== g.controlNav.length ? g.update(e, d) : z.controlNav.active()
				}
			},
			directionNav: {
				setup: function() {
					var d = a('\x3cul class\x3d"' + j + 'direction-nav"\x3e\x3cli\x3e\x3ca class\x3d"' + j + 'prev" href\x3d"#"\x3e' + g.vars.prevText + '\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca class\x3d"' + j + 'next" href\x3d"#"\x3e' + g.vars.nextText + "\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e");
					g.controlsContainer ? (a(g.controlsContainer).append(d), g.directionNav = a("." + j + "direction-nav li a", g.controlsContainer)) : (g.append(d), g.directionNav = a("." + j + "direction-nav li a", g));
					z.directionNav.update();
					g.directionNav.bind("click touchend MSPointerUp",
					function(d) {
						d.preventDefault();
						var e;
						if ("" === m || m === d.type) e = a(this).hasClass(j + "next") ? g.getTarget("next") : g.getTarget("prev"),
						g.flexAnimate(e, g.vars.pauseOnAction);
						"" === m && (m = d.type);
						z.setToClearWatchedEvent()
					})
				},
				update: function() { (void 0 === g.directionNav || null == g.directionNav) && z.directionNav.setup();
					var a = j + "disabled";
					1 === g.pagingCount ? g.directionNav.addClass(a).attr("tabindex", "-1") : g.vars.animationLoop ? g.directionNav.removeClass(a).removeAttr("tabindex") : 0 === g.animatingTo ? g.directionNav.removeClass(a).filter("." + j + "prev").addClass(a).attr("tabindex", "-1") : g.animatingTo === g.last ? g.directionNav.removeClass(a).filter("." + j + "next").addClass(a).attr("tabindex", "-1") : g.directionNav.removeClass(a).removeAttr("tabindex")
				}
			},
			pausePlay: {
				setup: function() {
					var d = a('\x3cdiv class\x3d"' + j + 'pauseplay"\x3e\x3ca\x3e\x3c/a\x3e\x3c/div\x3e');
					g.controlsContainer ? (g.controlsContainer.append(d), g.pausePlay = a("." + j + "pauseplay a", g.controlsContainer)) : (g.append(d), g.pausePlay = a("." + j + "pauseplay a", g));
					z.pausePlay.update(g.vars.slideshow ? j + "pause": j + "play");
					g.pausePlay.bind("click touchend MSPointerUp",
					function(d) {
						d.preventDefault();
						if ("" === m || m === d.type) a(this).hasClass(j + "pause") ? (g.manualPause = !0, g.manualPlay = !1, g.pause()) : (g.manualPause = !1, g.manualPlay = !0, g.play());
						"" === m && (m = d.type);
						z.setToClearWatchedEvent()
					})
				},
				update: function(a) {
					"play" === a ? g.pausePlay.removeClass(j + "pause").addClass(j + "play").html(g.vars.playText) : g.pausePlay.removeClass(j + "play").addClass(j + "pause").html(g.vars.pauseText)
				}
			},
			touch: function() {
				var a, d, j, l, m, n, z = !1,
				B = 0,
				C = 0,
				N = 0;
				if (k) {
					e.style.msTouchAction = "none";
					e._gesture = new MSGesture;
					e._gesture.target = e;
					e.addEventListener("MSPointerDown", O, !1);
					e._slider = g;
					e.addEventListener("MSGestureChange", ra, !1);
					e.addEventListener("MSGestureEnd", R, !1);
					var O = function(a) {
						a.stopPropagation();
						g.animating ? a.preventDefault() : (g.pause(), e._gesture.addPointer(a.pointerId), N = 0, l = o ? g.h: g.w, n = Number(new Date), j = u && r && g.animatingTo === g.last ? 0 : u && r ? g.limit - (g.itemW + g.vars.itemMargin) * g.move * g.animatingTo: u && g.currentSlide === g.last ? g.limit: u ? (g.itemW + g.vars.itemMargin) * g.move * g.currentSlide: r ? (g.last - g.currentSlide + g.cloneOffset) * l: (g.currentSlide + g.cloneOffset) * l)
					},
					ra = function(a) {
						a.stopPropagation();
						var d = a.target._slider;
						if (d) {
							var g = -a.translationX,
							k = -a.translationY;
							m = N += o ? k: g;
							z = o ? Math.abs(N) < Math.abs( - g) : Math.abs(N) < Math.abs( - k);
							if (a.detail === a.MSGESTURE_FLAG_INERTIA) setImmediate(function() {
								e._gesture.stop()
							});
							else if (!z || 500 < Number(new Date) - n) a.preventDefault(),
							!s && d.transitions && (d.vars.animationLoop || (m = N / (0 === d.currentSlide && 0 > N || d.currentSlide === d.last && 0 < N ? Math.abs(N) / l + 2 : 1)), d.setProps(j + m, "setTouch"))
						}
					},
					R = function(e) {
						e.stopPropagation();
						if (e = e.target._slider) {
							if (e.animatingTo === e.currentSlide && !z && null !== m) {
								var g = r ? -m: m,
								k = 0 < g ? e.getTarget("next") : e.getTarget("prev");
								e.canAdvance(k) && (550 > Number(new Date) - n && 50 < Math.abs(g) || Math.abs(g) > l / 2) ? e.flexAnimate(k, e.vars.pauseOnAction) : s || e.flexAnimate(e.currentSlide, e.vars.pauseOnAction, !0)
							}
							j = m = d = a = null;
							N = 0
						}
					}
				} else {
					e.addEventListener("touchstart", ea, !1);
					var ea = function(k) {
						if (g.animating) k.preventDefault();
						else if (window.navigator.msPointerEnabled || 1 === k.touches.length) g.pause(),
						l = o ? g.h: g.w,
						n = Number(new Date),
						B = k.touches[0].pageX,
						C = k.touches[0].pageY,
						j = u && r && g.animatingTo === g.last ? 0 : u && r ? g.limit - (g.itemW + g.vars.itemMargin) * g.move * g.animatingTo: u && g.currentSlide === g.last ? g.limit: u ? (g.itemW + g.vars.itemMargin) * g.move * g.currentSlide: r ? (g.last - g.currentSlide + g.cloneOffset) * l: (g.currentSlide + g.cloneOffset) * l,
						a = o ? C: B,
						d = o ? B: C,
						e.addEventListener("touchmove", Z, !1),
						e.addEventListener("touchend", Y, !1)
					},
					Z = function(e) {
						B = e.touches[0].pageX;
						C = e.touches[0].pageY;
						m = o ? a - C: a - B;
						z = o ? Math.abs(m) < Math.abs(B - d) : Math.abs(m) < Math.abs(C - d);
						if (!z || 500 < Number(new Date) - n) e.preventDefault(),
						!s && g.transitions && (g.vars.animationLoop || (m /= 0 === g.currentSlide && 0 > m || g.currentSlide === g.last && 0 < m ? Math.abs(m) / l + 2 : 1), g.setProps(j + m, "setTouch"))
					},
					Y = function() {
						e.removeEventListener("touchmove", Z, !1);
						if (g.animatingTo === g.currentSlide && !z && null !== m) {
							var k = r ? -m: m,
							o = 0 < k ? g.getTarget("next") : g.getTarget("prev");
							g.canAdvance(o) && (550 > Number(new Date) - n && 50 < Math.abs(k) || Math.abs(k) > l / 2) ? g.flexAnimate(o, g.vars.pauseOnAction) : s || g.flexAnimate(g.currentSlide, g.vars.pauseOnAction, !0)
						}
						e.removeEventListener("touchend", Y, !1);
						j = m = d = a = null
					}
				}
			},
			resize: function() { ! g.animating && g.is(":visible") && (u || g.doMath(), s ? z.smoothHeight() : u ? (g.slides.width(g.computedW), g.update(g.pagingCount), g.setProps()) : o ? (g.viewport.height(g.h), g.setProps(g.h, "setTotal")) : (g.vars.smoothHeight && z.smoothHeight(), g.newSlides.width(g.computedW), g.setProps(g.computedW, "setTotal")))
			},
			smoothHeight: function(a) {
				if (!o || s) {
					var d = s ? g: g.viewport;
					a ? d.animate({
						height: g.slides.eq(g.animatingTo).height()
					},
					a) : d.height(g.slides.eq(g.animatingTo).height())
				}
			},
			sync: function(d) {
				var e = a(g.vars.sync).data("flexslider"),
				j = g.animatingTo;
				switch (d) {
				case "animate":
					e.flexAnimate(j, g.vars.pauseOnAction, !1, !0);
					break;
				case "play":
					!e.playing && !e.asNav && e.play();
					break;
				case "pause":
					e.pause()
				}
			},
			pauseInvisible: {
				visProp: null,
				init: function() {
					var a = ["webkit", "moz", "ms", "o"];
					if ("hidden" in document) return "hidden";
					for (var d = 0; d < a.length; d++) a[d] + "Hidden" in document && (z.pauseInvisible.visProp = a[d] + "Hidden");
					z.pauseInvisible.visProp && (a = z.pauseInvisible.visProp.replace(/[H|h]idden/, "") + "visibilitychange", document.addEventListener(a,
					function() {
						z.pauseInvisible.isHidden() ? g.startTimeout ? clearTimeout(g.startTimeout) : g.pause() : g.started ? g.play() : 0 < g.vars.initDelay ? setTimeout(g.play, g.vars.initDelay) : g.play()
					}))
				},
				isHidden: function() {
					return document[z.pauseInvisible.visProp] || !1
				}
			},
			setToClearWatchedEvent: function() {
				clearTimeout(n);
				n = setTimeout(function() {
					m = ""
				},
				3E3)
			}
		};
		g.flexAnimate = function(d, e, k, m, n) { ! g.vars.animationLoop && d !== g.currentSlide && (g.direction = d > g.currentSlide ? "next": "prev");
			B && 1 === g.pagingCount && (g.direction = g.currentItem < d ? "next": "prev");
			if (!g.animating && (g.canAdvance(d, n) || k) && g.is(":visible")) {
				if (B && m) if (k = a(g.vars.asNavFor).data("flexslider"), g.atEnd = 0 === d || d === g.count - 1, k.flexAnimate(d, !0, !1, !0, n), g.direction = g.currentItem < d ? "next": "prev", k.direction = g.direction, Math.ceil((d + 1) / g.visible) - 1 !== g.currentSlide && 0 !== d) g.currentItem = d,
				g.slides.removeClass(j + "active-slide").eq(d).addClass(j + "active-slide"),
				d = Math.floor(d / g.visible);
				else return g.currentItem = d,
				g.slides.removeClass(j + "active-slide").eq(d).addClass(j + "active-slide"),
				!1;
				g.animating = !0;
				g.animatingTo = d;
				e && g.pause();
				g.vars.before(g);
				g.syncExists && !n && z.sync("animate");
				g.vars.controlNav && z.controlNav.active();
				u || g.slides.removeClass(j + "active-slide").eq(d).addClass(j + "active-slide");
				g.atEnd = 0 === d || d === g.last;
				g.vars.directionNav && z.directionNav.update();
				d === g.last && (g.vars.end(g), g.vars.animationLoop || g.pause());
				if (s) l ? (g.slides.eq(g.currentSlide).css({
					opacity: 0,
					zIndex: 1
				}), g.slides.eq(d).css({
					opacity: 1,
					zIndex: 2
				}), g.wrapup(G)) : (g.slides.eq(g.currentSlide).css({
					zIndex: 1
				}).animate({
					opacity: 0
				},
				g.vars.animationSpeed, g.vars.easing), g.slides.eq(d).css({
					zIndex: 2
				}).animate({
					opacity: 1
				},
				g.vars.animationSpeed, g.vars.easing, g.wrapup));
				else {
					var G = o ? g.slides.filter(":first").height() : g.computedW;
					u ? (d = g.vars.itemMargin, d = (g.itemW + d) * g.move * g.animatingTo, d = d > g.limit && 1 !== g.visible ? g.limit: d) : d = 0 === g.currentSlide && d === g.count - 1 && g.vars.animationLoop && "next" !== g.direction ? r ? (g.count + g.cloneOffset) * G: 0 : g.currentSlide === g.last && 0 === d && g.vars.animationLoop && "prev" !== g.direction ? r ? 0 : (g.count + 1) * G: r ? (g.count - 1 - d + g.cloneOffset) * G: (d + g.cloneOffset) * G;
					g.setProps(d, "", g.vars.animationSpeed);
					if (g.transitions) {
						if (!g.vars.animationLoop || !g.atEnd) g.animating = !1,
						g.currentSlide = g.animatingTo;
						g.container.unbind("webkitTransitionEnd transitionend");
						g.container.bind("webkitTransitionEnd transitionend",
						function() {
							g.wrapup(G)
						})
					} else g.container.animate(g.args, g.vars.animationSpeed, g.vars.easing,
					function() {
						g.wrapup(G)
					})
				}
				g.vars.smoothHeight && z.smoothHeight(g.vars.animationSpeed)
			}
		};
		g.wrapup = function(a) { ! s && !u && (0 === g.currentSlide && g.animatingTo === g.last && g.vars.animationLoop ? g.setProps(a, "jumpEnd") : g.currentSlide === g.last && (0 === g.animatingTo && g.vars.animationLoop) && g.setProps(a, "jumpStart"));
			g.animating = !1;
			g.currentSlide = g.animatingTo;
			g.vars.after(g)
		};
		g.animateSlides = function() {
			g.animating || g.flexAnimate(g.getTarget("next"))
		};
		g.pause = function() {
			clearInterval(g.animatedSlides);
			g.animatedSlides = null;
			g.playing = !1;
			g.vars.pausePlay && z.pausePlay.update("play");
			g.syncExists && z.sync("pause")
		};
		g.play = function() {
			g.playing && clearInterval(g.animatedSlides);
			g.animatedSlides = g.animatedSlides || setInterval(g.animateSlides, g.vars.slideshowSpeed);
			g.started = g.playing = !0;
			g.vars.pausePlay && z.pausePlay.update("pause");
			g.syncExists && z.sync("play")
		};
		g.stop = function() {
			g.pause();
			g.stopped = !0
		};
		g.canAdvance = function(a, d) {
			var e = B ? g.pagingCount - 1 : g.last;
			return d ? !0 : B && g.currentItem === g.count - 1 && 0 === a && "prev" === g.direction ? !0 : B && 0 === g.currentItem && a === g.pagingCount - 1 && "next" !== g.direction ? !1 : a === g.currentSlide && !B ? !1 : g.vars.animationLoop ? !0 : g.atEnd && 0 === g.currentSlide && a === e && "next" !== g.direction ? !1 : g.atEnd && g.currentSlide === e && 0 === a && "next" === g.direction ? !1 : !0
		};
		g.getTarget = function(a) {
			g.direction = a;
			return "next" === a ? g.currentSlide === g.last ? 0 : g.currentSlide + 1 : 0 === g.currentSlide ? g.last: g.currentSlide - 1
		};
		g.setProps = function(a, d, e) {
			var j, k = a ? a: (g.itemW + g.vars.itemMargin) * g.move * g.animatingTo;
			j = -1 *
			function() {
				if (u) return "setTouch" === d ? a: r && g.animatingTo === g.last ? 0 : r ? g.limit - (g.itemW + g.vars.itemMargin) * g.move * g.animatingTo: g.animatingTo === g.last ? g.limit: k;
				switch (d) {
				case "setTotal":
					return r ? (g.count - 1 - g.currentSlide + g.cloneOffset) * a: (g.currentSlide + g.cloneOffset) * a;
				case "setTouch":
					return a;
				case "jumpEnd":
					return r ? a: g.count * a;
				case "jumpStart":
					return r ? g.count * a: a;
				default:
					return a
				}
			} () + "px";
			g.transitions && (j = o ? "translate3d(0," + j + ",0)": "translate3d(" + j + ",0,0)", e = void 0 !== e ? e / 1E3 + "s": "0s", g.container.css("-" + g.pfx + "-transition-duration", e));
			g.args[g.prop] = j; (g.transitions || void 0 === e) && g.container.css(g.args)
		};
		g.setup = function(d) {
			if (s) g.slides.css({
				width: "100%",
				"float": "left",
				marginRight: "-100%",
				position: "relative"
			}),
			"init" === d && (l ? g.slides.css({
				opacity: 0,
				display: "block",
				webkitTransition: "opacity " + g.vars.animationSpeed / 1E3 + "s ease",
				zIndex: 1
			}).eq(g.currentSlide).css({
				opacity: 1,
				zIndex: 2
			}) : g.slides.css({
				opacity: 0,
				display: "block",
				zIndex: 1
			}).eq(g.currentSlide).css({
				zIndex: 2
			}).animate({
				opacity: 1
			},
			g.vars.animationSpeed, g.vars.easing)),
			g.vars.smoothHeight && z.smoothHeight();
			else {
				var e, k;
				"init" === d && (g.viewport = a('\x3cdiv class\x3d"' + j + 'viewport"\x3e\x3c/div\x3e').css({
					overflow: "hidden",
					position: "relative"
				}).appendTo(g).append(g.container), g.cloneCount = 0, g.cloneOffset = 0, r && (k = a.makeArray(g.slides).reverse(), g.slides = a(k), g.container.empty().append(g.slides)));
				g.vars.animationLoop && !u && (g.cloneCount = 2, g.cloneOffset = 1, "init" !== d && g.container.find(".clone").remove(), g.container.append(g.slides.first().clone().addClass("clone").attr("aria-hidden", "true")).prepend(g.slides.last().clone().addClass("clone").attr("aria-hidden", "true")));
				g.newSlides = a(g.vars.selector, g);
				g.count = g.newSlides.filter(":not(.clone)").length;
				g.currentSlide = Math.min(g.count, g.currentSlide);
				e = r ? g.count - 1 - g.currentSlide + g.cloneOffset: g.currentSlide + g.cloneOffset;
				o && !u ? (g.container.height(200 * (g.count + g.cloneCount) + "%").css("position", "absolute").width("100%"), setTimeout(function() {
					g.newSlides.css({
						display: "block"
					});
					g.doMath();
					g.viewport.height(g.h);
					g.setProps(e * g.h, "init")
				},
				"init" === d ? 100 : 0)) : (g.container.width(200 * (g.count + g.cloneCount) + "%"), g.setProps(e * g.computedW, "init"), setTimeout(function() {
					g.doMath();
					g.newSlides.css({
						width: g.computedW,
						"float": "left",
						display: "block"
					});
					g.vars.smoothHeight && z.smoothHeight()
				},
				"init" === d ? 100 : 0))
			}
			u || g.slides.removeClass(j + "active-slide").eq(g.currentSlide).addClass(j + "active-slide")
		};
		g.doMath = function() {
			var a = g.slides.first(),
			d = g.vars.itemMargin,
			e = g.vars.minItems,
			j = g.vars.maxItems;
			g.w = void 0 === g.viewport ? g.width() : g.viewport.width();
			g.h = a.height();
			g.boxPadding = a.outerWidth() - a.width();
			u ? (g.itemT = g.vars.itemWidth + d, g.minW = e ? e * g.itemT: g.w, g.maxW = j ? j * g.itemT - d: g.w, g.itemW = g.minW > g.w ? (g.w - d * (e - 1)) / e: g.maxW < g.w ? (g.w - d * (j - 1)) / j: g.vars.itemWidth > g.w ? g.w: g.vars.itemWidth, g.visible = Math.floor(g.w / g.itemW), g.move = 0 < g.vars.move && g.vars.move < g.visible ? g.vars.move: g.visible, g.pagingCount = Math.ceil((g.count - g.visible) / g.move + 1), g.last = g.pagingCount - 1, g.limit = 1 === g.pagingCount ? 0 : g.vars.itemWidth > g.w ? g.itemW * (g.count - 1) + d * (g.count - 1) : (g.itemW + d) * g.count - g.w - d) : (g.itemW = g.w, g.pagingCount = g.count, g.last = g.count - 1);
			g.computedW = g.itemW - g.boxPadding
		};
		g.update = function(a, d) {
			g.doMath();
			u || (a < g.currentSlide ? g.currentSlide += 1 : a <= g.currentSlide && 0 !== a && (g.currentSlide -= 1), g.animatingTo = g.currentSlide);
			if (g.vars.controlNav && !g.manualControls) if ("add" === d && !u || g.pagingCount > g.controlNav.length) z.controlNav.update("add");
			else if ("remove" === d && !u || g.pagingCount < g.controlNav.length) u && g.currentSlide > g.last && (g.currentSlide -= 1, g.animatingTo -= 1),
			z.controlNav.update("remove", g.last);
			g.vars.directionNav && z.directionNav.update()
		};
		g.addSlide = function(d, e) {
			var j = a(d);
			g.count += 1;
			g.last = g.count - 1;
			o && r ? void 0 !== e ? g.slides.eq(g.count - e).after(j) : g.container.prepend(j) : void 0 !== e ? g.slides.eq(e).before(j) : g.container.append(j);
			g.update(e, "add");
			g.slides = a(g.vars.selector + ":not(.clone)", g);
			g.setup();
			g.vars.added(g)
		};
		g.removeSlide = function(d) {
			var e = isNaN(d) ? g.slides.index(a(d)) : d;
			g.count -= 1;
			g.last = g.count - 1;
			isNaN(d) ? a(d, g.slides).remove() : o && r ? g.slides.eq(g.last).remove() : g.slides.eq(d).remove();
			g.doMath();
			g.update(e, "remove");
			g.slides = a(g.vars.selector + ":not(.clone)", g);
			g.setup();
			g.vars.removed(g)
		};
		z.init()
	};
	a(window).blur(function() {
		focused = !1
	}).focus(function() {
		focused = !0
	});
	a.flexslider.defaults = {
		namespace: "flex-",
		selector: ".slides \x3e li",
		animation: "fade",
		easing: "swing",
		direction: "horizontal",
		reverse: !1,
		animationLoop: !0,
		smoothHeight: !1,
		startAt: 0,
		slideshow: !0,
		slideshowSpeed: 7E3,
		animationSpeed: 600,
		initDelay: 0,
		randomize: !1,
		thumbCaptions: !1,
		pauseOnAction: !0,
		pauseOnHover: !1,
		pauseInvisible: !0,
		useCSS: !0,
		touch: !0,
		video: !1,
		controlNav: !0,
		directionNav: !0,
		prevText: "Previous",
		nextText: "Next",
		keyboard: !0,
		multipleKeyboard: !1,
		mousewheel: !1,
		pausePlay: !1,
		pauseText: "Pause",
		playText: "Play",
		controlsContainer: "",
		manualControls: "",
		sync: "",
		asNavFor: "",
		itemWidth: 0,
		itemMargin: 0,
		minItems: 1,
		maxItems: 0,
		move: 0,
		allowOneSlide: !0,
		start: function() {},
		before: function() {},
		after: function() {},
		end: function() {},
		added: function() {},
		removed: function() {}
	};
	a.fn.flexslider = function(e) {
		void 0 === e && (e = {});
		if ("object" === typeof e) return this.each(function() {
			var d = a(this),
			j = d.find(e.selector ? e.selector: ".slides \x3e li");
			1 === j.length && !0 === e.allowOneSlide || 0 === j.length ? (j.fadeIn(400), e.start && e.start(d)) : void 0 === d.data("flexslider") && new a.flexslider(this, e)
		});
		var d = a(this).data("flexslider");
		switch (e) {
		case "play":
			d.play();
			break;
		case "pause":
			d.pause();
			break;
		case "stop":
			d.stop();
			break;
		case "next":
			d.flexAnimate(d.getTarget("next"), !0);
			break;
		case "prev":
		case "previous":
			d.flexAnimate(d.getTarget("prev"), !0);
			break;
		default:
			"number" === typeof e && d.flexAnimate(e, !0)
		}
	}
})(jQuery); (function(a) {
	a.fn.placeholder = function(e) {
		var d = jQuery.extend({
			onFocus: "focused",
			onChange: !1,
			onBlur: !1,
			placeholderSupport: "placeholder" in document.createElement("input")
		},
		e),
		g = function() {
			return ! ("" == a.trim(a(this).val()) || a(this).val() == a(this).attr("placeholder"))
		};
		this.each(function() {
			d.onBlur && a(this).addClass(d.onBlur); ! d.placeholderSupport && !g.call(this) && a(this).val(a(this).attr("placeholder"));
			d.onChange && g.call(this) && a(this).addClass(d.onChange);
			a(this).bind("focus",
			function() { ! d.placeholderSupport && a(this).val() == a(this).attr("placeholder") && a(this).val("");
				d.onFocus && a(this).addClass(d.onFocus);
				d.onBlur && a(this).removeClass(d.onBlur)
			}).bind("blur",
			function() { ! d.placeholderSupport && !g.call(this) && a(this).val(a(this).attr("placeholder"));
				d.onFocus && a(this).removeClass(d.onFocus);
				d.onBlur && a(this).addClass(d.onBlur);
				d.onChange && g.call(this) ? a(this).addClass(d.onChange) : a(this).removeClass(d.onChange)
			})
		});
		return this
	}
})(jQuery); !
function(a, e) {
	function d(a, d) {
		function j() {}
		j[n] = this[n];
		var k = this,
		l = new j,
		m = typeof a === e,
		o = m ? a: this,
		E = m ? {}: a,
		F = function() {
			this.initialize ? this.initialize.apply(this, arguments) : (d || m && k.apply(this, arguments), o.apply(this, arguments))
		};
		F.methods = function(a) {
			g(l, a, k);
			F[n] = l;
			return this
		};
		F.methods.call(F, E).prototype.constructor = F;
		F.extend = arguments.callee;
		F[n].implement = F.statics = function(a, d) {
			var e;
			"string" == typeof a ? (e = {},
			e[a] = d) : e = a;
			g(this, e, k);
			return this
		};
		return F
	}
	function g(a, d, g) {
		for (var k in d) d.hasOwnProperty(k) && (a[k] = typeof d[k] === e && typeof g[n][k] === e && l.test(d[k]) ? j(k, d[k], g) : d[k])
	}
	function j(a, d, e) {
		return function() {
			var g = this.supr;
			this.supr = e[n][a];
			var j = d.apply(this, arguments);
			this.supr = g;
			return j
		}
	}
	function k(a) {
		return d.call(typeof a === e ? a: m, a, 1)
	}
	var l = /xyz/.test(function() {
		xyz
	}) ? /\bsupr\b/: /.*/,
	m = function() {},
	n = "prototype";
	if ("undefined" != typeof module && module.exports) module.exports = k;
	else {
		var o = a.klass;
		k.noConflict = function() {
			a.klass = o;
			return this
		};
		a.klass = k
	}
} (this, "function"); (function(a) {
	Function.prototype.bind || (Function.prototype.bind = function(a) {
		var d = [].slice,
		g = d.call(arguments, 1),
		j = this,
		k = function() {},
		l = function() {
			return j.apply(this instanceof k ? this: a || {},
			g.concat(d.call(arguments)))
		};
		k.prototype = j.prototype;
		l.prototype = new k;
		return l
	});
	"undefined" === typeof a.Code && (a.Code = {});
	a.Code.Util = {
		registerNamespace: function() {
			var e = arguments,
			d = null,
			g, j, k, l, m;
			g = 0;
			for (l = e.length; g < l; g++) {
				k = e[g];
				k = k.split(".");
				d = k[0];
				"undefined" === typeof a[d] && (a[d] = {});
				d = a[d];
				j = 1;
				for (m = k.length; j < m; ++j) d[k[j]] = d[k[j]] || {},
				d = d[k[j]]
			}
		},
		coalesce: function() {
			var a, d;
			a = 0;
			for (d = arguments.length; a < d; a++) if (!this.isNothing(arguments[a])) return arguments[a];
			return null
		},
		extend: function(a, d, g) {
			var j;
			this.isNothing(g) && (g = !0);
			if (a && d && this.isObject(d)) for (j in d) this.objectHasProperty(d, j) && (g ? a[j] = d[j] : "undefined" === typeof a[j] && (a[j] = d[j]))
		},
		clone: function(a) {
			var d = {};
			this.extend(d, a);
			return d
		},
		isObject: function(a) {
			return a instanceof Object
		},
		isFunction: function(a) {
			return "[object Function]" === {}.toString.call(a)
		},
		isArray: function(a) {
			return a instanceof Array
		},
		isLikeArray: function(a) {
			return "number" === typeof a.length
		},
		isNumber: function(a) {
			return "number" === typeof a
		},
		isString: function(a) {
			return "string" === typeof a
		},
		isNothing: function(a) {
			return "undefined" === typeof a || null === a ? !0 : !1
		},
		swapArrayElements: function(a, d, g) {
			var j = a[d];
			a[d] = a[g];
			a[g] = j
		},
		trim: function(a) {
			return a.replace(/^\s\s*/, "").replace(/\s\s*$/, "")
		},
		toCamelCase: function(a) {
			return a.replace(/(\-[a-z])/g,
			function(a) {
				return a.toUpperCase().replace("-", "")
			})
		},
		toDashedCase: function(a) {
			return a.replace(/([A-Z])/g,
			function(a) {
				return "-" + a.toLowerCase()
			})
		},
		arrayIndexOf: function(a, d, g) {
			var j, k, l, m;
			l = -1;
			j = 0;
			for (k = d.length; j < k; j++) if (m = d[j], this.isNothing(g)) {
				if (m === a) {
					l = j;
					break
				}
			} else if (this.objectHasProperty(m, g) && m[g] === a) {
				l = j;
				break
			}
			return l
		},
		objectHasProperty: function(a, d) {
			return a.hasOwnProperty ? a.hasOwnProperty(d) : "undefined" !== typeof a[d]
		}
	}
})(window); (function(a, e) {
	e.Browser = {
		ua: null,
		version: null,
		safari: null,
		webkit: null,
		opera: null,
		msie: null,
		chrome: null,
		mozilla: null,
		android: null,
		blackberry: null,
		iPad: null,
		iPhone: null,
		iPod: null,
		iOS: null,
		is3dSupported: null,
		isCSSTransformSupported: null,
		isTouchSupported: null,
		isGestureSupported: null,
		_detect: function() {
			this.ua = a.navigator.userAgent;
			this.version = this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/) || [];
			this.safari = /Safari/gi.test(a.navigator.appVersion);
			this.webkit = /webkit/i.test(this.ua);
			this.opera = /opera/i.test(this.ua);
			this.msie = /msie/i.test(this.ua) && !this.opera;
			this.chrome = /Chrome/i.test(this.ua);
			this.firefox = /Firefox/i.test(this.ua);
			this.fennec = /Fennec/i.test(this.ua);
			this.mozilla = /mozilla/i.test(this.ua) && !/(compatible|webkit)/.test(this.ua);
			this.android = /android/i.test(this.ua);
			this.blackberry = /blackberry/i.test(this.ua);
			this.iOS = /iphone|ipod|ipad/gi.test(a.navigator.platform);
			this.iPad = /ipad/gi.test(a.navigator.platform);
			this.iPhone = /iphone/gi.test(a.navigator.platform);
			this.iPod = /ipod/gi.test(a.navigator.platform);
			var d = document.createElement("div");
			this.is3dSupported = !e.isNothing(d.style.WebkitPerspective);
			this.isCSSTransformSupported = !e.isNothing(d.style.WebkitTransform) || !e.isNothing(d.style.MozTransform) || !e.isNothing(d.style.transformProperty);
			this.isTouchSupported = this.isEventSupported("touchstart");
			this.isGestureSupported = this.isEventSupported("gesturestart")
		},
		_eventTagNames: {
			select: "input",
			change: "input",
			submit: "form",
			reset: "form",
			error: "img",
			load: "img",
			abort: "img"
		},
		isEventSupported: function(a) {
			var g = document.createElement(this._eventTagNames[a] || "div"),
			j;
			a = "on" + a; (j = e.objectHasProperty(g, a)) || (g.setAttribute(a, "return;"), j = "function" === typeof g[a]);
			return j
		},
		isLandscape: function() {
			return e.DOM.windowWidth() > e.DOM.windowHeight()
		}
	};
	e.Browser._detect()
})(window, window.Code.Util); (function(a, e) {
	e.extend(e, {
		Events: {
			add: function(a, e, j) {
				this._checkHandlersProperty(a);
				"mousewheel" === e && (e = this._normaliseMouseWheelType());
				"undefined" === typeof a.__eventHandlers[e] && (a.__eventHandlers[e] = []);
				a.__eventHandlers[e].push(j);
				this._isBrowserObject(a) && a.addEventListener(e, j, !1)
			},
			remove: function(a, g, j) {
				this._checkHandlersProperty(a);
				"mousewheel" === g && (g = this._normaliseMouseWheelType());
				if (a.__eventHandlers[g] instanceof Array) {
					var k, l, m = a.__eventHandlers[g];
					if (e.isNothing(j)) {
						if (this._isBrowserObject(a)) {
							k = 0;
							for (l = m.length; k < l; k++) a.removeEventListener(g, m[k], !1)
						}
						a.__eventHandlers[g] = []
					} else {
						k = 0;
						for (l = m.length; k < l; k++) if (m[k] === j) {
							m.splice(k, 1);
							break
						}
						this._isBrowserObject(a) && a.removeEventListener(g, j, !1)
					}
				}
			},
			fire: function(d, g) {
				var j, k, l, m, n = Array.prototype.slice.call(arguments).splice(2);
				"mousewheel" === g && (g = this._normaliseMouseWheelType());
				if (this._isBrowserObject(d)) {
					if ("string" !== typeof g) throw "type must be a string for DOM elements";
					l = this._NATIVE_EVENTS[g];
					j = document.createEvent(l ? "HTMLEvents": "UIEvents");
					j[l ? "initEvent": "initUIEvent"](g, !0, !0, a, 1);
					if (1 > n.length) {
						d.dispatchEvent(j);
						return
					}
				}
				this._checkHandlersProperty(d);
				j = "string" === typeof g ? {
					type: g
				}: g;
				j.target || (j.target = d);
				if (!j.type) throw Error("Event object missing 'type' property.");
				if (d.__eventHandlers[j.type] instanceof Array) {
					l = d.__eventHandlers[j.type];
					n.unshift(j);
					j = 0;
					for (k = l.length; j < k; j++) m = l[j],
					e.isNothing(m) || m.apply(d, n)
				}
			},
			getMousePosition: function(a) {
				var e = {
					x: 0,
					y: 0
				};
				a.pageX ? e.x = a.pageX: a.clientX && (e.x = a.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft));
				a.pageY ? e.y = a.pageY: a.clientY && (e.y = a.clientY + (document.documentElement.scrollTop || document.body.scrollTop));
				return e
			},
			getTouchEvent: function(a) {
				return a
			},
			getWheelDelta: function(a) {
				var g = 0;
				e.isNothing(a.wheelDelta) ? e.isNothing(a.detail) || (g = -a.detail / 3) : g = a.wheelDelta / 120;
				return g
			},
			domReady: function(a) {
				document.addEventListener("DOMContentLoaded", a, !1)
			},
			_checkHandlersProperty: function(a) {
				e.isNothing(a.__eventHandlers) && e.extend(a, {
					__eventHandlers: {}
				})
			},
			_isBrowserObject: function(d) {
				return d === a || d === a.document ? !0 : this._isElement(d) || this._isNode(d)
			},
			_isElement: function(d) {
				return "object" === typeof a.HTMLElement ? d instanceof a.HTMLElement: "object" === typeof d && 1 === d.nodeType && "string" === typeof d.nodeName
			},
			_isNode: function(d) {
				return "object" === typeof a.Node ? d instanceof a.Node: "object" === typeof d && "number" === typeof d.nodeType && "string" === typeof d.nodeName
			},
			_normaliseMouseWheelType: function() {
				return e.Browser.isEventSupported("mousewheel") ? "mousewheel": "DOMMouseScroll"
			},
			_NATIVE_EVENTS: {
				click: 1,
				dblclick: 1,
				mouseup: 1,
				mousedown: 1,
				contextmenu: 1,
				mousewheel: 1,
				DOMMouseScroll: 1,
				mouseover: 1,
				mouseout: 1,
				mousemove: 1,
				selectstart: 1,
				selectend: 1,
				keydown: 1,
				keypress: 1,
				keyup: 1,
				orientationchange: 1,
				touchstart: 1,
				touchmove: 1,
				touchend: 1,
				touchcancel: 1,
				gesturestart: 1,
				gesturechange: 1,
				gestureend: 1,
				focus: 1,
				blur: 1,
				change: 1,
				reset: 1,
				select: 1,
				submit: 1,
				load: 1,
				unload: 1,
				beforeunload: 1,
				resize: 1,
				move: 1,
				DOMContentLoaded: 1,
				readystatechange: 1,
				error: 1,
				abort: 1,
				scroll: 1
			}
		}
	})
})(window, window.Code.Util); (function(a, e) {
	e.extend(e, {
		DOM: {
			setData: function(a, g, j) {
				if (e.isLikeArray(a)) {
					var k, l;
					k = 0;
					for (l = a.length; k < l; k++) e.DOM._setData(a[k], g, j)
				} else e.DOM._setData(a, g, j)
			},
			_setData: function(a, g, j) {
				e.DOM.setAttribute(a, "data-" + g, j)
			},
			getData: function(a, g, j) {
				return e.DOM.getAttribute(a, "data-" + g, j)
			},
			removeData: function(a, g) {
				if (e.isLikeArray(a)) {
					var j, k;
					j = 0;
					for (k = a.length; j < k; j++) e.DOM._removeData(a[j], g)
				} else e.DOM._removeData(a, g)
			},
			_removeData: function(a, g) {
				e.DOM.removeAttribute(a, "data-" + g)
			},
			isChildOf: function(a, e) {
				if (e === a) return ! 1;
				for (; a && a !== e;) a = a.parentNode;
				return a === e
			},
			find: function(d, g) {
				e.isNothing(g) && (g = a.document);
				var j = g.querySelectorAll(d),
				k = [],
				l,
				m;
				l = 0;
				for (m = j.length; l < m; l++) k.push(j[l]);
				return k
			},
			createElement: function(a, g, j) {
				var k;
				a = document.createElement(a);
				for (k in g) e.objectHasProperty(g, k) && a.setAttribute(k, g[k]);
				a.innerHTML = j || "";
				return a
			},
			appendChild: function(a, e) {
				e.appendChild(a)
			},
			insertBefore: function(a, e, j) {
				j.insertBefore(a, e)
			},
			appendText: function(a, g) {
				e.DOM.appendChild(document.createTextNode(a), g)
			},
			appendToBody: function(a) {
				this.appendChild(a, document.body)
			},
			removeChild: function(a, e) {
				e.removeChild(a)
			},
			removeChildren: function(a) {
				if (a.hasChildNodes()) for (; 1 <= a.childNodes.length;) a.removeChild(a.childNodes[a.childNodes.length - 1])
			},
			hasAttribute: function(a, g) {
				return ! e.isNothing(a.getAttribute(g))
			},
			getAttribute: function(a, g, j) {
				a = a.getAttribute(g);
				e.isNothing(a) && !e.isNothing(j) && (a = j);
				return a
			},
			setAttribute: function(a, g, j) {
				if (e.isLikeArray(a)) {
					var k, l;
					k = 0;
					for (l = a.length; k < l; k++) e.DOM._setAttribute(a[k], g, j)
				} else e.DOM._setAttribute(a, g, j)
			},
			_setAttribute: function(a, e, j) {
				a.setAttribute(e, j)
			},
			removeAttribute: function(a, g) {
				if (e.isLikeArray(a)) {
					var j, k;
					j = 0;
					for (k = a.length; j < k; j++) e.DOM._removeAttribute(a[j], g)
				} else e.DOM._removeAttribute(a, g)
			},
			_removeAttribute: function(a, e) {
				this.hasAttribute(a, e) && a.removeAttribute(e)
			},
			addClass: function(a, g) {
				if (e.isLikeArray(a)) {
					var j, k;
					j = 0;
					for (k = a.length; j < k; j++) e.DOM._addClass(a[j], g)
				} else e.DOM._addClass(a, g)
			},
			_addClass: function(a, g) {
				var j = e.DOM.getAttribute(a, "class", "");
				RegExp("(?:^|\\s+)" + g + "(?:\\s+|$)").test(j) || ("" !== j && (j += " "), j += g, e.DOM.setAttribute(a, "class", j))
			},
			removeClass: function(a, g) {
				if (e.isLikeArray(a)) {
					var j, k;
					j = 0;
					for (k = a.length; j < k; j++) e.DOM._removeClass(a[j], g)
				} else e.DOM._removeClass(a, g)
			},
			_removeClass: function(a, g) {
				var j = e.DOM.getAttribute(a, "class", ""),
				j = e.trim(j).split(" "),
				k = "",
				l,
				m;
				l = 0;
				for (m = j.length; l < m; l++) j[l] !== g && ("" !== k && (k += " "), k += j[l]);
				"" === k ? e.DOM.removeAttribute(a, "class") : e.DOM.setAttribute(a, "class", k)
			},
			hasClass: function(a, g) {
				return RegExp("(?:^|\\s+)" + g + "(?:\\s+|$)").test(e.DOM.getAttribute(a, "class", ""))
			},
			setStyle: function(a, g, j) {
				if (e.isLikeArray(a)) {
					var k, l;
					k = 0;
					for (l = a.length; k < l; k++) e.DOM._setStyle(a[k], g, j)
				} else e.DOM._setStyle(a, g, j)
			},
			_setStyle: function(a, g, j) {
				var k;
				if (e.isObject(g)) for (k in g) e.objectHasProperty(g, k) && ("width" === k ? e.DOM.width(a, g[k]) : "height" === k ? e.DOM.height(a, g[k]) : a.style[k] = g[k]);
				else a.style[g] = j
			},
			getStyle: function(d, e) {
				var j = a.getComputedStyle(d, "").getPropertyValue(e);
				"" === j && (j = d.style[e]);
				return j
			},
			hide: function(a) {
				if (e.isLikeArray(a)) {
					var g, j;
					g = 0;
					for (j = a.length; g < j; g++) e.DOM._hide(a[g])
				} else e.DOM._hide(a)
			},
			_hide: function(a) {
				e.DOM.setData(a, "ccl-disp", e.DOM.getStyle(a, "display"));
				e.DOM.setStyle(a, "display", "none")
			},
			show: function(a) {
				if (e.isLikeArray(a)) {
					var g, j;
					g = 0;
					for (j = a.length; g < j; g++) e.DOM._show(a[g])
				} else e.DOM._show(a)
			},
			_show: function(a) {
				if ("none" === e.DOM.getStyle(a, "display")) {
					var g = e.DOM.getData(a, "ccl-disp", "block");
					if ("none" === g || "" === g) g = "block";
					e.DOM.setStyle(a, "display", g)
				}
			},
			width: function(a, g) {
				e.isNothing(g) || (e.isNumber(g) && (g += "px"), a.style.width = g);
				return this._getDimension(a, "width")
			},
			outerWidth: function(a) {
				var g = e.DOM.width(a),
				g = g + (parseInt(e.DOM.getStyle(a, "padding-left"), 10) + parseInt(e.DOM.getStyle(a, "padding-right"), 10)),
				g = g + (parseInt(e.DOM.getStyle(a, "margin-left"), 10) + parseInt(e.DOM.getStyle(a, "margin-right"), 10));
				return g += parseInt(e.DOM.getStyle(a, "border-left-width"), 10) + parseInt(e.DOM.getStyle(a, "border-right-width"), 10)
			},
			height: function(a, g) {
				e.isNothing(g) || (e.isNumber(g) && (g += "px"), a.style.height = g);
				return this._getDimension(a, "height")
			},
			_getDimension: function(d, e) {
				var j, k, l = a.parseInt(a.getComputedStyle(d, "").getPropertyValue(e));
				isNaN(l) && (j = d.style.display, k = d.style.left, d.style.display = "block", d.style.left = "-1000000px", l = a.parseInt(a.getComputedStyle(d, "").getPropertyValue(e)), d.style.display = j, d.style.left = k);
				return l
			},
			outerHeight: function(a) {
				var g = e.DOM.height(a),
				g = g + (parseInt(e.DOM.getStyle(a, "padding-top"), 10) + parseInt(e.DOM.getStyle(a, "padding-bottom"), 10)),
				g = g + (parseInt(e.DOM.getStyle(a, "margin-top"), 10) + parseInt(e.DOM.getStyle(a, "margin-bottom"), 10));
				return g += parseInt(e.DOM.getStyle(a, "border-top-width"), 10) + parseInt(e.DOM.getStyle(a, "border-bottom-width"), 10)
			},
			documentWidth: function() {
				return e.DOM.width(document.documentElement)
			},
			documentHeight: function() {
				return e.DOM.height(document.documentElement)
			},
			documentOuterWidth: function() {
				return e.DOM.width(document.documentElement)
			},
			documentOuterHeight: function() {
				return e.DOM.outerHeight(document.documentElement)
			},
			bodyWidth: function() {
				return e.DOM.width(document.body)
			},
			bodyHeight: function() {
				return e.DOM.height(document.body)
			},
			bodyOuterWidth: function() {
				return e.DOM.outerWidth(document.body)
			},
			bodyOuterHeight: function() {
				return e.DOM.outerHeight(document.body)
			},
			windowWidth: function() {
				return a.innerWidth
			},
			windowHeight: function() {
				return a.innerHeight
			},
			windowScrollLeft: function() {
				return a.pageXOffset
			},
			windowScrollTop: function() {
				return a.pageYOffset
			}
		}
	})
})(window, window.Code.Util); (function(a, e) {
	e.extend(e, {
		Animation: {
			_applyTransitionDelay: 50,
			_transitionEndLabel: void 0 !== a.document.documentElement.style.webkitTransition ? "webkitTransitionEnd": "transitionend",
			_transitionEndHandler: null,
			_transitionPrefix: void 0 !== a.document.documentElement.style.webkitTransition ? "webkitTransition": void 0 !== a.document.documentElement.style.MozTransition ? "MozTransition": "transition",
			_transformLabel: void 0 !== a.document.documentElement.style.webkitTransform ? "webkitTransform": void 0 !== a.document.documentElement.style.MozTransition ? "MozTransform": "transform",
			_getTransitionEndHandler: function() {
				e.isNothing(this._transitionEndHandler) && (this._transitionEndHandler = this._onTransitionEnd.bind(this));
				return this._transitionEndHandler
			},
			stop: function(d) {
				if (e.Browser.isCSSTransformSupported) {
					var g = {};
					e.Events.remove(d, this._transitionEndLabel, this._getTransitionEndHandler());
					e.isNothing(d.callbackLabel) && delete d.callbackLabel;
					g[this._transitionPrefix + "Property"] = "";
					g[this._transitionPrefix + "Duration"] = "";
					g[this._transitionPrefix + "TimingFunction"] = "";
					g[this._transitionPrefix + "Delay"] = "";
					g[this._transformLabel] = "";
					e.DOM.setStyle(d, g)
				} else e.isNothing(a.jQuery) || a.jQuery(d).stop(!0, !0)
			},
			fadeIn: function(d, g, j, k, l) {
				l = e.coalesce(l, 1);
				0 >= l && (l = 1);
				0 >= g && (e.DOM.setStyle(d, "opacity", l), !e.isNothing(j)) ? j(d) : (1 <= e.DOM.getStyle(d, "opacity") && e.DOM.setStyle(d, "opacity", 0), e.Browser.isCSSTransformSupported ? this._applyTransition(d, "opacity", l, g, j, k) : e.isNothing(a.jQuery) || a.jQuery(d).fadeTo(g, l, j))
			},
			fadeTo: function(a, e, j, k, l) {
				this.fadeIn(a, j, k, l, e)
			},
			fadeOut: function(d, g, j, k) {
				0 >= g && (e.DOM.setStyle(d, "opacity", 0), !e.isNothing(j)) ? j(d) : e.Browser.isCSSTransformSupported ? this._applyTransition(d, "opacity", 0, g, j, k) : a.jQuery(d).fadeTo(g, 0, j)
			},
			slideBy: function(d, g, j, k, l, m) {
				var n = {};
				g = e.coalesce(g, 0);
				j = e.coalesce(j, 0);
				m = e.coalesce(m, "ease-out");
				n[this._transitionPrefix + "Property"] = "all";
				n[this._transitionPrefix + "Delay"] = "0";
				0 === k ? (n[this._transitionPrefix + "Duration"] = "", n[this._transitionPrefix + "TimingFunction"] = "") : (n[this._transitionPrefix + "Duration"] = k + "ms", n[this._transitionPrefix + "TimingFunction"] = e.coalesce(m, "ease-out"), e.Events.add(d, this._transitionEndLabel, this._getTransitionEndHandler()));
				n[this._transformLabel] = e.Browser.is3dSupported ? "translate3d(" + g + "px, " + j + "px, 0px)": "translate(" + g + "px, " + j + "px)";
				e.isNothing(l) || (d.cclallcallback = l);
				e.DOM.setStyle(d, n);
				0 === k && a.setTimeout(function() {
					this._leaveTransforms(d)
				}.bind(this), this._applyTransitionDelay)
			},
			resetTranslate: function(a) {
				var g = {};
				g[this._transformLabel] = g[this._transformLabel] = e.Browser.is3dSupported ? "translate3d(0px, 0px, 0px)": "translate(0px, 0px)";
				e.DOM.setStyle(a, g)
			},
			_applyTransition: function(d, g, j, k, l, m) {
				var n = {};
				m = e.coalesce(m, "ease-in");
				n[this._transitionPrefix + "Property"] = g;
				n[this._transitionPrefix + "Duration"] = k + "ms";
				n[this._transitionPrefix + "TimingFunction"] = m;
				n[this._transitionPrefix + "Delay"] = "0";
				e.Events.add(d, this._transitionEndLabel, this._getTransitionEndHandler());
				e.DOM.setStyle(d, n);
				e.isNothing(l) || (d["ccl" + g + "callback"] = l);
				a.setTimeout(function() {
					e.DOM.setStyle(d, g, j)
				},
				this._applyTransitionDelay)
			},
			_onTransitionEnd: function(a) {
				e.Events.remove(a.currentTarget, this._transitionEndLabel, this._getTransitionEndHandler());
				this._leaveTransforms(a.currentTarget)
			},
			_leaveTransforms: function(d) {
				var g = d.style[this._transitionPrefix + "Property"],
				j = "" !== g ? "ccl" + g + "callback": "cclallcallback",
				k,
				g = e.coalesce(d.style.webkitTransform, d.style.MozTransform, d.style.transform),
				l,
				m = a.parseInt(e.DOM.getStyle(d, "left"), 0),
				n = a.parseInt(e.DOM.getStyle(d, "top"), 0),
				o,
				r,
				u = {};
				"" !== g && (g = e.Browser.is3dSupported ? g.match(/translate3d\((.*?)\)/) : g.match(/translate\((.*?)\)/), e.isNothing(g) || (l = g[1].split(", "), o = a.parseInt(l[0], 0), r = a.parseInt(l[1], 0)));
				u[this._transitionPrefix + "Property"] = "";
				u[this._transitionPrefix + "Duration"] = "";
				u[this._transitionPrefix + "TimingFunction"] = "";
				u[this._transitionPrefix + "Delay"] = "";
				e.DOM.setStyle(d, u);
				a.setTimeout(function() {
					e.isNothing(l) || (u = {},
					u[this._transformLabel] = "", u.left = m + o + "px", u.top = n + r + "px", e.DOM.setStyle(d, u));
					e.isNothing(d[j]) || (k = d[j], delete d[j], k(d))
				}.bind(this), this._applyTransitionDelay)
			}
		}
	})
})(window, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.Util.TouchElement");
	d.TouchElement.EventTypes = {
		onTouch: "CodeUtilTouchElementOnTouch"
	};
	d.TouchElement.ActionTypes = {
		touchStart: "touchStart",
		touchMove: "touchMove",
		touchEnd: "touchEnd",
		touchMoveEnd: "touchMoveEnd",
		tap: "tap",
		doubleTap: "doubleTap",
		swipeLeft: "swipeLeft",
		swipeRight: "swipeRight",
		swipeUp: "swipeUp",
		swipeDown: "swipeDown",
		gestureStart: "gestureStart",
		gestureChange: "gestureChange",
		gestureEnd: "gestureEnd"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.Util.TouchElement");
	d.TouchElement.TouchElementClass = e({
		el: null,
		captureSettings: null,
		touchStartPoint: null,
		touchEndPoint: null,
		touchStartTime: null,
		doubleTapTimeout: null,
		touchStartHandler: null,
		touchMoveHandler: null,
		touchEndHandler: null,
		mouseDownHandler: null,
		mouseMoveHandler: null,
		mouseUpHandler: null,
		mouseOutHandler: null,
		gestureStartHandler: null,
		gestureChangeHandler: null,
		gestureEndHandler: null,
		swipeThreshold: null,
		swipeTimeThreshold: null,
		doubleTapSpeed: null,
		dispose: function() {
			var a;
			this.removeEventHandlers();
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(a, e) {
			this.el = a;
			this.captureSettings = {
				swipe: !1,
				move: !1,
				gesture: !1,
				doubleTap: !1,
				preventDefaultTouchEvents: !0
			};
			d.extend(this.captureSettings, e);
			this.swipeThreshold = 50;
			this.doubleTapSpeed = this.swipeTimeThreshold = 250;
			this.touchStartPoint = {
				x: 0,
				y: 0
			};
			this.touchEndPoint = {
				x: 0,
				y: 0
			}
		},
		addEventHandlers: function() {
			d.isNothing(this.touchStartHandler) && (this.touchStartHandler = this.onTouchStart.bind(this), this.touchMoveHandler = this.onTouchMove.bind(this), this.touchEndHandler = this.onTouchEnd.bind(this), this.mouseDownHandler = this.onMouseDown.bind(this), this.mouseMoveHandler = this.onMouseMove.bind(this), this.mouseUpHandler = this.onMouseUp.bind(this), this.mouseOutHandler = this.onMouseOut.bind(this), this.gestureStartHandler = this.onGestureStart.bind(this), this.gestureChangeHandler = this.onGestureChange.bind(this), this.gestureEndHandler = this.onGestureEnd.bind(this));
			d.Events.add(this.el, "touchstart", this.touchStartHandler);
			this.captureSettings.move && d.Events.add(this.el, "touchmove", this.touchMoveHandler);
			d.Events.add(this.el, "touchend", this.touchEndHandler);
			d.Events.add(this.el, "mousedown", this.mouseDownHandler);
			d.Browser.isGestureSupported && this.captureSettings.gesture && (d.Events.add(this.el, "gesturestart", this.gestureStartHandler), d.Events.add(this.el, "gesturechange", this.gestureChangeHandler), d.Events.add(this.el, "gestureend", this.gestureEndHandler))
		},
		removeEventHandlers: function() {
			d.Events.remove(this.el, "touchstart", this.touchStartHandler);
			this.captureSettings.move && d.Events.remove(this.el, "touchmove", this.touchMoveHandler);
			d.Events.remove(this.el, "touchend", this.touchEndHandler);
			d.Events.remove(this.el, "mousedown", this.mouseDownHandler);
			d.Browser.isGestureSupported && this.captureSettings.gesture && (d.Events.remove(this.el, "gesturestart", this.gestureStartHandler), d.Events.remove(this.el, "gesturechange", this.gestureChangeHandler), d.Events.remove(this.el, "gestureend", this.gestureEndHandler))
		},
		getTouchPoint: function(a) {
			return {
				x: a[0].pageX,
				y: a[0].pageY
			}
		},
		fireTouchEvent: function(e) {
			var j = 0,
			k = 0,
			l = 0,
			m, j = this.touchEndPoint.x - this.touchStartPoint.x,
			k = this.touchEndPoint.y - this.touchStartPoint.y,
			l = Math.sqrt(j * j + k * k);
			if (this.captureSettings.swipe && (m = new Date, m -= this.touchStartTime, m <= this.swipeTimeThreshold)) {
				if (a.Math.abs(j) >= this.swipeThreshold) {
					d.Events.fire(this, {
						type: d.TouchElement.EventTypes.onTouch,
						target: this,
						point: this.touchEndPoint,
						action: 0 > j ? d.TouchElement.ActionTypes.swipeLeft: d.TouchElement.ActionTypes.swipeRight,
						targetEl: e.target,
						currentTargetEl: e.currentTarget
					});
					return
				}
				if (a.Math.abs(k) >= this.swipeThreshold) {
					d.Events.fire(this, {
						type: d.TouchElement.EventTypes.onTouch,
						target: this,
						point: this.touchEndPoint,
						action: 0 > k ? d.TouchElement.ActionTypes.swipeUp: d.TouchElement.ActionTypes.swipeDown,
						targetEl: e.target,
						currentTargetEl: e.currentTarget
					});
					return
				}
			}
			1 < l ? d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchMoveEnd,
				point: this.touchEndPoint,
				targetEl: e.target,
				currentTargetEl: e.currentTarget
			}) : this.captureSettings.doubleTap ? d.isNothing(this.doubleTapTimeout) ? this.doubleTapTimeout = a.setTimeout(function() {
				this.doubleTapTimeout = null;
				d.Events.fire(this, {
					type: d.TouchElement.EventTypes.onTouch,
					target: this,
					point: this.touchEndPoint,
					action: d.TouchElement.ActionTypes.tap,
					targetEl: e.target,
					currentTargetEl: e.currentTarget
				})
			}.bind(this), this.doubleTapSpeed) : (a.clearTimeout(this.doubleTapTimeout), this.doubleTapTimeout = null, d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				point: this.touchEndPoint,
				action: d.TouchElement.ActionTypes.doubleTap,
				targetEl: e.target,
				currentTargetEl: e.currentTarget
			})) : d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				point: this.touchEndPoint,
				action: d.TouchElement.ActionTypes.tap,
				targetEl: e.target,
				currentTargetEl: e.currentTarget
			})
		},
		onTouchStart: function(a) {
			this.captureSettings.preventDefaultTouchEvents && a.preventDefault();
			d.Events.remove(this.el, "mousedown", this.mouseDownHandler);
			var e = d.Events.getTouchEvent(a).touches;
			1 < e.length && this.captureSettings.gesture ? this.isGesture = !0 : (this.touchStartTime = new Date, this.isGesture = !1, this.touchStartPoint = this.getTouchPoint(e), d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchStart,
				point: this.touchStartPoint,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			}))
		},
		onTouchMove: function(a) {
			this.captureSettings.preventDefaultTouchEvents && a.preventDefault();
			if (!this.isGesture || !this.captureSettings.gesture) {
				var e = d.Events.getTouchEvent(a).touches;
				d.Events.fire(this, {
					type: d.TouchElement.EventTypes.onTouch,
					target: this,
					action: d.TouchElement.ActionTypes.touchMove,
					point: this.getTouchPoint(e),
					targetEl: a.target,
					currentTargetEl: a.currentTarget
				})
			}
		},
		onTouchEnd: function(a) {
			if (!this.isGesture || !this.captureSettings.gesture) {
				this.captureSettings.preventDefaultTouchEvents && a.preventDefault();
				var e = d.Events.getTouchEvent(a);
				this.touchEndPoint = this.getTouchPoint(!d.isNothing(e.changedTouches) ? e.changedTouches: e.touches);
				d.Events.fire(this, {
					type: d.TouchElement.EventTypes.onTouch,
					target: this,
					action: d.TouchElement.ActionTypes.touchEnd,
					point: this.touchEndPoint,
					targetEl: a.target,
					currentTargetEl: a.currentTarget
				});
				this.fireTouchEvent(a)
			}
		},
		onMouseDown: function(a) {
			a.preventDefault();
			d.Events.remove(this.el, "touchstart", this.mouseDownHandler);
			d.Events.remove(this.el, "touchmove", this.touchMoveHandler);
			d.Events.remove(this.el, "touchend", this.touchEndHandler);
			this.captureSettings.move && d.Events.add(this.el, "mousemove", this.mouseMoveHandler);
			d.Events.add(this.el, "mouseup", this.mouseUpHandler);
			d.Events.add(this.el, "mouseout", this.mouseOutHandler);
			this.touchStartTime = new Date;
			this.isGesture = !1;
			this.touchStartPoint = d.Events.getMousePosition(a);
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchStart,
				point: this.touchStartPoint,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			})
		},
		onMouseMove: function(a) {
			a.preventDefault();
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchMove,
				point: d.Events.getMousePosition(a),
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			})
		},
		onMouseUp: function(a) {
			a.preventDefault();
			this.captureSettings.move && d.Events.remove(this.el, "mousemove", this.mouseMoveHandler);
			d.Events.remove(this.el, "mouseup", this.mouseUpHandler);
			d.Events.remove(this.el, "mouseout", this.mouseOutHandler);
			this.touchEndPoint = d.Events.getMousePosition(a);
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchEnd,
				point: this.touchEndPoint,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			});
			this.fireTouchEvent(a)
		},
		onMouseOut: function(a) {
			var e = a.relatedTarget;
			this.el === e || d.DOM.isChildOf(e, this.el) || (a.preventDefault(), this.captureSettings.move && d.Events.remove(this.el, "mousemove", this.mouseMoveHandler), d.Events.remove(this.el, "mouseup", this.mouseUpHandler), d.Events.remove(this.el, "mouseout", this.mouseOutHandler), this.touchEndPoint = d.Events.getMousePosition(a), d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.touchEnd,
				point: this.touchEndPoint,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			}), this.fireTouchEvent(a))
		},
		onGestureStart: function(a) {
			a.preventDefault();
			var e = d.Events.getTouchEvent(a);
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.gestureStart,
				scale: e.scale,
				rotation: e.rotation,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			})
		},
		onGestureChange: function(a) {
			a.preventDefault();
			var e = d.Events.getTouchEvent(a);
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.gestureChange,
				scale: e.scale,
				rotation: e.rotation,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			})
		},
		onGestureEnd: function(a) {
			a.preventDefault();
			var e = d.Events.getTouchEvent(a);
			d.Events.fire(this, {
				type: d.TouchElement.EventTypes.onTouch,
				target: this,
				action: d.TouchElement.ActionTypes.gestureEnd,
				scale: e.scale,
				rotation: e.rotation,
				targetEl: a.target,
				currentTargetEl: a.currentTarget
			})
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Image");
	a.Code.PhotoSwipe.Image.EventTypes = {
		onLoad: "onLoad",
		onError: "onError"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Image");
	var g = a.Code.PhotoSwipe;
	g.Image.ImageClass = e({
		refObj: null,
		imageEl: null,
		src: null,
		caption: null,
		metaData: null,
		imageLoadHandler: null,
		imageErrorHandler: null,
		dispose: function() {
			var a;
			this.shrinkImage();
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(d, e, g, m) {
			this.refObj = d;
			this.src = this.originalSrc = e;
			this.caption = g;
			this.metaData = m;
			this.imageEl = new a.Image;
			this.imageLoadHandler = this.onImageLoad.bind(this);
			this.imageErrorHandler = this.onImageError.bind(this)
		},
		load: function() {
			this.imageEl.originalSrc = d.coalesce(this.imageEl.originalSrc, "");
			this.imageEl.originalSrc === this.src ? this.imageEl.isError ? d.Events.fire(this, {
				type: g.Image.EventTypes.onError,
				target: this
			}) : d.Events.fire(this, {
				type: g.Image.EventTypes.onLoad,
				target: this
			}) : (this.imageEl.isError = !1, this.imageEl.isLoading = !0, this.imageEl.naturalWidth = null, this.imageEl.naturalHeight = null, this.imageEl.isLandscape = !1, this.imageEl.onload = this.imageLoadHandler, this.imageEl.onerror = this.imageErrorHandler, this.imageEl.onabort = this.imageErrorHandler, this.imageEl.originalSrc = this.src, this.imageEl.src = this.src)
		},
		shrinkImage: function() { ! d.isNothing(this.imageEl) && -1 < this.imageEl.src.indexOf(this.src) && (this.imageEl.src = "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs\x3d", d.isNothing(this.imageEl.parentNode) || d.DOM.removeChild(this.imageEl, this.imageEl.parentNode))
		},
		onImageLoad: function() {
			this.imageEl.onload = null;
			this.imageEl.naturalWidth = d.coalesce(this.imageEl.naturalWidth, this.imageEl.width);
			this.imageEl.naturalHeight = d.coalesce(this.imageEl.naturalHeight, this.imageEl.height);
			this.imageEl.isLandscape = this.imageEl.naturalWidth > this.imageEl.naturalHeight;
			this.imageEl.isLoading = !1;
			d.Events.fire(this, {
				type: g.Image.EventTypes.onLoad,
				target: this
			})
		},
		onImageError: function() {
			this.imageEl.onload = null;
			this.imageEl.onerror = null;
			this.imageEl.onabort = null;
			this.imageEl.isLoading = !1;
			this.imageEl.isError = !0;
			d.Events.fire(this, {
				type: g.Image.EventTypes.onError,
				target: this
			})
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Cache");
	a = a.Code.PhotoSwipe;
	a.Cache.Mode = {
		normal: "normal",
		aggressive: "aggressive"
	};
	a.Cache.Functions = {
		getImageSource: function(a) {
			return a.href
		},
		getImageCaption: function(a) {
			if ("IMG" === a.nodeName) return d.DOM.getAttribute(a, "alt");
			var e, k, l;
			e = 0;
			for (k = a.childNodes.length; e < k; e++) if (l = a.childNodes[e], "IMG" === a.childNodes[e].nodeName) return d.DOM.getAttribute(l, "alt")
		},
		getImageMetaData: function() {
			return {}
		}
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Cache");
	var g = a.Code.PhotoSwipe;
	g.Cache.CacheClass = e({
		images: null,
		settings: null,
		dispose: function() {
			var a, e, g;
			if (!d.isNothing(this.images)) {
				e = 0;
				for (g = this.images.length; e < g; e++) this.images[e].dispose();
				this.images.length = 0
			}
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(a, d) {
			var e, m, n, o, r, u;
			this.settings = d;
			this.images = [];
			e = 0;
			for (m = a.length; e < m; e++) n = a[e],
			o = this.settings.getImageSource(n),
			r = this.settings.getImageCaption(n),
			u = this.settings.getImageMetaData(n),
			this.images.push(new g.Image.ImageClass(n, o, r, u))
		},
		getImages: function(a) {
			var e, l, m = [],
			n;
			e = 0;
			for (l = a.length; e < l; e++) n = this.images[a[e]],
			this.settings.cacheMode === g.Cache.Mode.aggressive && (n.cacheDoNotShrink = !0),
			m.push(n);
			if (this.settings.cacheMode === g.Cache.Mode.aggressive) {
				e = 0;
				for (l = this.images.length; e < l; e++) n = this.images[e],
				d.objectHasProperty(n, "cacheDoNotShrink") ? delete n.cacheDoNotShrink: n.shrinkImage()
			}
			return m
		}
	})
})(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.Image); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.DocumentOverlay");
	a.Code.PhotoSwipe.DocumentOverlay.CssClasses = {
		documentOverlay: "ps-document-overlay"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.DocumentOverlay");
	var g = a.Code.PhotoSwipe;
	g.DocumentOverlay.DocumentOverlayClass = e({
		el: null,
		settings: null,
		initialBodyHeight: null,
		dispose: function() {
			var a;
			d.Animation.stop(this.el);
			d.DOM.removeChild(this.el, this.el.parentNode);
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e) {
			this.settings = e;
			this.el = d.DOM.createElement("div", {
				"class": g.DocumentOverlay.CssClasses.documentOverlay
			},
			"");
			d.DOM.setStyle(this.el, {
				display: "block",
				position: "absolute",
				left: 0,
				top: 0,
				zIndex: this.settings.zIndex
			});
			d.DOM.hide(this.el);
			this.settings.target === a ? d.DOM.appendToBody(this.el) : d.DOM.appendChild(this.el, this.settings.target);
			d.Animation.resetTranslate(this.el);
			this.initialBodyHeight = d.DOM.bodyOuterHeight()
		},
		resetPosition: function() {
			var e, g, l;
			this.settings.target === a ? (e = d.DOM.windowWidth(), g = 2 * d.DOM.bodyOuterHeight(), l = this.settings.jQueryMobile ? d.DOM.windowScrollTop() + "px": "0px", 1 > g && (g = this.initialBodyHeight), d.DOM.windowHeight() > g && (g = d.DOM.windowHeight())) : (e = d.DOM.width(this.settings.target), g = d.DOM.height(this.settings.target), l = "0px");
			d.DOM.setStyle(this.el, {
				width: e,
				height: g,
				top: l
			})
		},
		fadeIn: function(a, e) {
			this.resetPosition();
			d.DOM.setStyle(this.el, "opacity", 0);
			d.DOM.show(this.el);
			d.Animation.fadeIn(this.el, a, e)
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Carousel");
	a = a.Code.PhotoSwipe;
	a.Carousel.EventTypes = {
		onSlideByEnd: "PhotoSwipeCarouselOnSlideByEnd",
		onSlideshowStart: "PhotoSwipeCarouselOnSlideshowStart",
		onSlideshowStop: "PhotoSwipeCarouselOnSlideshowStop"
	};
	a.Carousel.CssClasses = {
		carousel: "ps-carousel",
		content: "ps-carousel-content",
		item: "ps-carousel-item",
		itemLoading: "ps-carousel-item-loading",
		itemError: "ps-carousel-item-error"
	};
	a.Carousel.SlideByAction = {
		previous: "previous",
		current: "current",
		next: "next"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Carousel");
	var g = a.Code.PhotoSwipe;
	g.Carousel.CarouselClass = e({
		el: null,
		contentEl: null,
		settings: null,
		cache: null,
		slideByEndHandler: null,
		currentCacheIndex: null,
		isSliding: null,
		isSlideshowActive: null,
		lastSlideByAction: null,
		touchStartPoint: null,
		touchStartPosition: null,
		imageLoadHandler: null,
		imageErrorHandler: null,
		slideshowTimeout: null,
		dispose: function() {
			var a, e, l;
			e = 0;
			for (l = this.cache.images.length; e < l; e++) d.Events.remove(this.cache.images[e], g.Image.EventTypes.onLoad, this.imageLoadHandler),
			d.Events.remove(this.cache.images[e], g.Image.EventTypes.onError, this.imageErrorHandler);
			this.stopSlideshow();
			d.Animation.stop(this.el);
			d.DOM.removeChild(this.el, this.el.parentNode);
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e, k) {
			var l, m, n;
			this.cache = e;
			this.settings = k;
			this.slideByEndHandler = this.onSlideByEnd.bind(this);
			this.imageLoadHandler = this.onImageLoad.bind(this);
			this.imageErrorHandler = this.onImageError.bind(this);
			this.currentCacheIndex = 0;
			this.isSlideshowActive = this.isSliding = !1;
			3 > this.cache.images.length && (this.settings.loop = !1);
			this.el = d.DOM.createElement("div", {
				"class": g.Carousel.CssClasses.carousel
			},
			"");
			d.DOM.setStyle(this.el, {
				display: "block",
				position: "absolute",
				left: 0,
				top: 0,
				overflow: "hidden",
				zIndex: this.settings.zIndex
			});
			d.DOM.hide(this.el);
			this.contentEl = d.DOM.createElement("div", {
				"class": g.Carousel.CssClasses.content
			},
			"");
			d.DOM.setStyle(this.contentEl, {
				display: "block",
				position: "absolute",
				left: 0,
				top: 0
			});
			d.DOM.appendChild(this.contentEl, this.el);
			m = 3 > e.images.length ? e.images.length: 3;
			for (l = 0; l < m; l++) n = d.DOM.createElement("div", {
				"class": g.Carousel.CssClasses.item + " " + g.Carousel.CssClasses.item + "-" + l
			},
			""),
			d.DOM.setAttribute(n, "style", "float: left;"),
			d.DOM.setStyle(n, {
				display: "block",
				position: "relative",
				left: 0,
				top: 0,
				overflow: "hidden"
			}),
			0 < this.settings.margin && d.DOM.setStyle(n, {
				marginRight: this.settings.margin + "px"
			}),
			d.DOM.appendChild(n, this.contentEl);
			this.settings.target === a ? d.DOM.appendToBody(this.el) : d.DOM.appendChild(this.el, this.settings.target)
		},
		resetPosition: function() {
			var e, k, l, m, n, o;
			this.settings.target === a ? (e = d.DOM.windowWidth(), k = d.DOM.windowHeight(), l = d.DOM.windowScrollTop() + "px") : (e = d.DOM.width(this.settings.target), k = d.DOM.height(this.settings.target), l = "0px");
			m = 0 < this.settings.margin ? e + this.settings.margin: e;
			n = d.DOM.find("." + g.Carousel.CssClasses.item, this.contentEl);
			m *= n.length;
			d.DOM.setStyle(this.el, {
				top: l,
				width: e,
				height: k
			});
			d.DOM.setStyle(this.contentEl, {
				width: m,
				height: k
			});
			l = 0;
			for (m = n.length; l < m; l++) o = n[l],
			d.DOM.setStyle(o, {
				width: e,
				height: k
			}),
			o = d.DOM.find("img", o)[0],
			d.isNothing(o) || this.resetImagePosition(o);
			this.setContentLeftPosition()
		},
		resetImagePosition: function(a) {
			if (!d.isNothing(a)) {
				d.DOM.getAttribute(a, "src");
				var e, g, m, n = d.DOM.width(this.el),
				o = d.DOM.height(this.el);
				"fitNoUpscale" === this.settings.imageScaleMethod ? (g = a.naturalWidth, m = a.naturalHeight, g > n && (e = n / g, g = Math.round(g * e), m = Math.round(m * e)), m > o && (e = o / m, m = Math.round(m * e), g = Math.round(g * e))) : (e = a.isLandscape ? n / a.naturalWidth: o / a.naturalHeight, g = Math.round(a.naturalWidth * e), m = Math.round(a.naturalHeight * e), "zoom" === this.settings.imageScaleMethod ? (e = 1, m < o ? e = o / m: g < n && (e = n / g), 1 !== e && (g = Math.round(g * e), m = Math.round(m * e))) : "fit" === this.settings.imageScaleMethod && (e = 1, g > n ? e = n / g: m > o && (e = o / m), 1 !== e && (g = Math.round(g * e), m = Math.round(m * e))));
				d.DOM.setStyle(a, {
					position: "absolute",
					width: g,
					height: m,
					top: Math.round((o - m) / 2) + "px",
					left: Math.round((n - g) / 2) + "px",
					display: "block"
				})
			}
		},
		setContentLeftPosition: function() {
			var e, g, l;
			e = this.settings.target === a ? d.DOM.windowWidth() : d.DOM.width(this.settings.target);
			g = this.getItemEls();
			l = 0;
			this.settings.loop ? l = -1 * (e + this.settings.margin) : this.currentCacheIndex === this.cache.images.length - 1 ? l = -1 * (g.length - 1) * (e + this.settings.margin) : 0 < this.currentCacheIndex && (l = -1 * (e + this.settings.margin));
			d.DOM.setStyle(this.contentEl, {
				left: l + "px"
			})
		},
		show: function(a) {
			this.currentCacheIndex = a;
			this.resetPosition();
			this.setImages(!1);
			d.DOM.show(this.el);
			d.Animation.resetTranslate(this.contentEl);
			a = this.getItemEls();
			var e, l;
			e = 0;
			for (l = a.length; e < l; e++) d.Animation.resetTranslate(a[e]);
			d.Events.fire(this, {
				type: g.Carousel.EventTypes.onSlideByEnd,
				target: this,
				action: g.Carousel.SlideByAction.current,
				cacheIndex: this.currentCacheIndex
			})
		},
		setImages: function(a) {
			var d, e = this.getItemEls();
			d = this.currentCacheIndex + 1;
			var g = this.currentCacheIndex - 1;
			this.settings.loop ? (d > this.cache.images.length - 1 && (d = 0), 0 > g && (g = this.cache.images.length - 1), d = this.cache.getImages([g, this.currentCacheIndex, d]), a || this.addCacheImageToItemEl(d[1], e[1]), this.addCacheImageToItemEl(d[2], e[2]), this.addCacheImageToItemEl(d[0], e[0])) : 1 === e.length ? a || (d = this.cache.getImages([this.currentCacheIndex]), this.addCacheImageToItemEl(d[0], e[0])) : 2 === e.length ? 0 === this.currentCacheIndex ? (d = this.cache.getImages([this.currentCacheIndex, this.currentCacheIndex + 1]), a || this.addCacheImageToItemEl(d[0], e[0]), this.addCacheImageToItemEl(d[1], e[1])) : (d = this.cache.getImages([this.currentCacheIndex - 1, this.currentCacheIndex]), a || this.addCacheImageToItemEl(d[1], e[1]), this.addCacheImageToItemEl(d[0], e[0])) : 0 === this.currentCacheIndex ? (d = this.cache.getImages([this.currentCacheIndex, this.currentCacheIndex + 1, this.currentCacheIndex + 2]), a || this.addCacheImageToItemEl(d[0], e[0]), this.addCacheImageToItemEl(d[1], e[1]), this.addCacheImageToItemEl(d[2], e[2])) : (this.currentCacheIndex === this.cache.images.length - 1 ? (d = this.cache.getImages([this.currentCacheIndex - 2, this.currentCacheIndex - 1, this.currentCacheIndex]), a || this.addCacheImageToItemEl(d[2], e[2]), this.addCacheImageToItemEl(d[1], e[1])) : (d = this.cache.getImages([this.currentCacheIndex - 1, this.currentCacheIndex, this.currentCacheIndex + 1]), a || this.addCacheImageToItemEl(d[1], e[1]), this.addCacheImageToItemEl(d[2], e[2])), this.addCacheImageToItemEl(d[0], e[0]))
		},
		addCacheImageToItemEl: function(a, e) {
			d.DOM.removeClass(e, g.Carousel.CssClasses.itemError);
			d.DOM.addClass(e, g.Carousel.CssClasses.itemLoading);
			d.DOM.removeChildren(e);
			d.DOM.setStyle(a.imageEl, {
				display: "none"
			});
			d.DOM.appendChild(a.imageEl, e);
			d.Animation.resetTranslate(a.imageEl);
			d.Events.add(a, g.Image.EventTypes.onLoad, this.imageLoadHandler);
			d.Events.add(a, g.Image.EventTypes.onError, this.imageErrorHandler);
			a.load()
		},
		slideCarousel: function(e, k, l) {
			if (!this.isSliding) {
				var m, n;
				m = this.settings.target === a ? d.DOM.windowWidth() + this.settings.margin: d.DOM.width(this.settings.target) + this.settings.margin;
				l = d.coalesce(l, this.settings.slideSpeed);
				if (! (1 > a.Math.abs(n))) {
					switch (k) {
					case d.TouchElement.ActionTypes.swipeLeft:
						e = -1 * m;
						break;
					case d.TouchElement.ActionTypes.swipeRight:
						e = m;
						break;
					default:
						n = e.x - this.touchStartPoint.x,
						e = a.Math.abs(n) > m / 2 ? 0 < n ? m: -1 * m: 0
					}
					this.lastSlideByAction = 0 > e ? g.Carousel.SlideByAction.next: 0 < e ? g.Carousel.SlideByAction.previous: g.Carousel.SlideByAction.current;
					if (!this.settings.loop && (this.lastSlideByAction === g.Carousel.SlideByAction.previous && 0 === this.currentCacheIndex || this.lastSlideByAction === g.Carousel.SlideByAction.next && this.currentCacheIndex === this.cache.images.length - 1)) e = 0,
					this.lastSlideByAction = g.Carousel.SlideByAction.current;
					this.isSliding = !0;
					this.doSlideCarousel(e, l)
				}
			}
		},
		moveCarousel: function(a) {
			this.isSliding || this.settings.enableDrag && this.doMoveCarousel(a.x - this.touchStartPoint.x)
		},
		getItemEls: function() {
			return d.DOM.find("." + g.Carousel.CssClasses.item, this.contentEl)
		},
		previous: function() {
			this.stopSlideshow();
			this.slideCarousel({
				x: 0,
				y: 0
			},
			d.TouchElement.ActionTypes.swipeRight, this.settings.nextPreviousSlideSpeed)
		},
		next: function() {
			this.stopSlideshow();
			this.slideCarousel({
				x: 0,
				y: 0
			},
			d.TouchElement.ActionTypes.swipeLeft, this.settings.nextPreviousSlideSpeed)
		},
		slideshowNext: function() {
			this.slideCarousel({
				x: 0,
				y: 0
			},
			d.TouchElement.ActionTypes.swipeLeft)
		},
		startSlideshow: function() {
			this.stopSlideshow();
			this.isSlideshowActive = !0;
			this.slideshowTimeout = a.setTimeout(this.slideshowNext.bind(this), this.settings.slideshowDelay);
			d.Events.fire(this, {
				type: g.Carousel.EventTypes.onSlideshowStart,
				target: this
			})
		},
		stopSlideshow: function() {
			d.isNothing(this.slideshowTimeout) || (a.clearTimeout(this.slideshowTimeout), this.slideshowTimeout = null, this.isSlideshowActive = !1, d.Events.fire(this, {
				type: g.Carousel.EventTypes.onSlideshowStop,
				target: this
			}))
		},
		onSlideByEnd: function() {
			if (!d.isNothing(this.isSliding)) {
				var a = this.getItemEls();
				this.isSliding = !1;
				this.lastSlideByAction === g.Carousel.SlideByAction.next ? this.currentCacheIndex += 1 : this.lastSlideByAction === g.Carousel.SlideByAction.previous && (this.currentCacheIndex -= 1);
				this.settings.loop ? (this.lastSlideByAction === g.Carousel.SlideByAction.next ? d.DOM.appendChild(a[0], this.contentEl) : this.lastSlideByAction === g.Carousel.SlideByAction.previous && d.DOM.insertBefore(a[a.length - 1], a[0], this.contentEl), 0 > this.currentCacheIndex) ? this.currentCacheIndex = this.cache.images.length - 1 : this.currentCacheIndex === this.cache.images.length && (this.currentCacheIndex = 0) : 3 < this.cache.images.length && (1 < this.currentCacheIndex && this.currentCacheIndex < this.cache.images.length - 2 ? this.lastSlideByAction === g.Carousel.SlideByAction.next ? d.DOM.appendChild(a[0], this.contentEl) : this.lastSlideByAction === g.Carousel.SlideByAction.previous && d.DOM.insertBefore(a[a.length - 1], a[0], this.contentEl) : 1 === this.currentCacheIndex ? this.lastSlideByAction === g.Carousel.SlideByAction.previous && d.DOM.insertBefore(a[a.length - 1], a[0], this.contentEl) : this.currentCacheIndex === this.cache.images.length - 2 && this.lastSlideByAction === g.Carousel.SlideByAction.next && d.DOM.appendChild(a[0], this.contentEl));
				this.lastSlideByAction !== g.Carousel.SlideByAction.current && (this.setContentLeftPosition(), this.setImages(!0));
				d.Events.fire(this, {
					type: g.Carousel.EventTypes.onSlideByEnd,
					target: this,
					action: this.lastSlideByAction,
					cacheIndex: this.currentCacheIndex
				});
				this.isSlideshowActive && (this.lastSlideByAction !== g.Carousel.SlideByAction.current ? this.startSlideshow() : this.stopSlideshow())
			}
		},
		onTouch: function(e, g) {
			this.stopSlideshow();
			switch (e) {
			case d.TouchElement.ActionTypes.touchStart:
				this.touchStartPoint = g;
				this.touchStartPosition = {
					x: a.parseInt(d.DOM.getStyle(this.contentEl, "left"), 0),
					y: a.parseInt(d.DOM.getStyle(this.contentEl, "top"), 0)
				};
				break;
			case d.TouchElement.ActionTypes.touchMove:
				this.moveCarousel(g);
				break;
			case d.TouchElement.ActionTypes.touchMoveEnd:
			case d.TouchElement.ActionTypes.swipeLeft:
			case d.TouchElement.ActionTypes.swipeRight:
				this.slideCarousel(g, e)
			}
		},
		onImageLoad: function(a) {
			a = a.target;
			d.isNothing(a.imageEl.parentNode) || (d.DOM.removeClass(a.imageEl.parentNode, g.Carousel.CssClasses.itemLoading), this.resetImagePosition(a.imageEl));
			d.Events.remove(a, g.Image.EventTypes.onLoad, this.imageLoadHandler);
			d.Events.remove(a, g.Image.EventTypes.onError, this.imageErrorHandler)
		},
		onImageError: function(a) {
			a = a.target;
			d.isNothing(a.imageEl.parentNode) || (d.DOM.removeClass(a.imageEl.parentNode, g.Carousel.CssClasses.itemLoading), d.DOM.addClass(a.imageEl.parentNode, g.Carousel.CssClasses.itemError));
			d.Events.remove(a, g.Image.EventTypes.onLoad, this.imageLoadHandler);
			d.Events.remove(a, g.Image.EventTypes.onError, this.imageErrorHandler)
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Carousel");
	e = a.Code.PhotoSwipe;
	e.Carousel.CarouselClass = e.Carousel.CarouselClass.extend({
		getStartingPos: function() {
			var e = this.touchStartPosition;
			d.isNothing(e) && (e = {
				x: a.parseInt(d.DOM.getStyle(this.contentEl, "left"), 0),
				y: a.parseInt(d.DOM.getStyle(this.contentEl, "top"), 0)
			});
			return e
		},
		doMoveCarousel: function(e) {
			var j;
			d.Browser.isCSSTransformSupported ? (j = {},
			j[d.Animation._transitionPrefix + "Property"] = "all", j[d.Animation._transitionPrefix + "Duration"] = "", j[d.Animation._transitionPrefix + "TimingFunction"] = "", j[d.Animation._transitionPrefix + "Delay"] = "0", j[d.Animation._transformLabel] = d.Browser.is3dSupported ? "translate3d(" + e + "px, 0px, 0px)": "translate(" + e + "px, 0px)", d.DOM.setStyle(this.contentEl, j)) : d.isNothing(a.jQuery) || a.jQuery(this.contentEl).stop().css("left", this.getStartingPos().x + e + "px")
		},
		doSlideCarousel: function(e, j) {
			var k;
			0 >= j ? this.slideByEndHandler() : d.Browser.isCSSTransformSupported ? (k = d.coalesce(this.contentEl.style.webkitTransform, this.contentEl.style.MozTransform, this.contentEl.style.transform, ""), 0 === k.indexOf("translate3d(" + e) ? this.slideByEndHandler() : 0 === k.indexOf("translate(" + e) ? this.slideByEndHandler() : d.Animation.slideBy(this.contentEl, e, 0, j, this.slideByEndHandler, this.settings.slideTimingFunction)) : d.isNothing(a.jQuery) || (k = {
				left: this.getStartingPos().x + e + "px"
			},
			"ease-out" === this.settings.animationTimingFunction && (this.settings.animationTimingFunction = "easeOutQuad"), d.isNothing(a.jQuery.easing[this.settings.animationTimingFunction]) && (this.settings.animationTimingFunction = "linear"), a.jQuery(this.contentEl).animate(k, this.settings.slideSpeed, this.settings.animationTimingFunction, this.slideByEndHandler))
		}
	})
})(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.TouchElement); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Toolbar");
	var g = a.Code.PhotoSwipe;
	g.Toolbar.CssClasses = {
		toolbar: "ps-toolbar",
		toolbarContent: "ps-toolbar-content",
		toolbarTop: "ps-toolbar-top",
		caption: "ps-caption",
		captionBottom: "ps-caption-bottom",
		captionContent: "ps-caption-content",
		close: "ps-toolbar-close",
		play: "ps-toolbar-play",
		previous: "ps-toolbar-previous",
		previousDisabled: "ps-toolbar-previous-disabled",
		next: "ps-toolbar-next",
		nextDisabled: "ps-toolbar-next-disabled"
	};
	g.Toolbar.ToolbarAction = {
		close: "close",
		play: "play",
		next: "next",
		previous: "previous",
		none: "none"
	};
	g.Toolbar.EventTypes = {
		onTap: "PhotoSwipeToolbarOnClick",
		onBeforeShow: "PhotoSwipeToolbarOnBeforeShow",
		onShow: "PhotoSwipeToolbarOnShow",
		onBeforeHide: "PhotoSwipeToolbarOnBeforeHide",
		onHide: "PhotoSwipeToolbarOnHide"
	};
	g.Toolbar.getToolbar = function() {
		return '\x3cdiv class\x3d"' + g.Toolbar.CssClasses.close + '"\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.toolbarContent + '"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.play + '"\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.toolbarContent + '"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.previous + '"\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.toolbarContent + '"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.next + '"\x3e\x3cdiv class\x3d"' + g.Toolbar.CssClasses.toolbarContent + '"\x3e\x3c/div\x3e\x3c/div\x3e'
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.Toolbar");
	var g = a.Code.PhotoSwipe;
	g.Toolbar.ToolbarClass = e({
		toolbarEl: null,
		closeEl: null,
		playEl: null,
		previousEl: null,
		nextEl: null,
		captionEl: null,
		captionContentEl: null,
		currentCaption: null,
		settings: null,
		cache: null,
		timeout: null,
		isVisible: null,
		fadeOutHandler: null,
		touchStartHandler: null,
		touchMoveHandler: null,
		clickHandler: null,
		dispose: function() {
			var a;
			this.clearTimeout();
			this.removeEventHandlers();
			d.Animation.stop(this.toolbarEl);
			d.Animation.stop(this.captionEl);
			d.DOM.removeChild(this.toolbarEl, this.toolbarEl.parentNode);
			d.DOM.removeChild(this.captionEl, this.captionEl.parentNode);
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e, k) {
			var l;
			this.settings = k;
			this.cache = e;
			this.isVisible = !1;
			this.fadeOutHandler = this.onFadeOut.bind(this);
			this.touchStartHandler = this.onTouchStart.bind(this);
			this.touchMoveHandler = this.onTouchMove.bind(this);
			this.clickHandler = this.onClick.bind(this);
			l = g.Toolbar.CssClasses.toolbar;
			this.settings.captionAndToolbarFlipPosition && (l = l + " " + g.Toolbar.CssClasses.toolbarTop);
			this.toolbarEl = d.DOM.createElement("div", {
				"class": l
			},
			this.settings.getToolbar());
			d.DOM.setStyle(this.toolbarEl, {
				left: 0,
				position: "absolute",
				overflow: "hidden",
				zIndex: this.settings.zIndex
			});
			this.settings.target === a ? d.DOM.appendToBody(this.toolbarEl) : d.DOM.appendChild(this.toolbarEl, this.settings.target);
			d.DOM.hide(this.toolbarEl);
			this.closeEl = d.DOM.find("." + g.Toolbar.CssClasses.close, this.toolbarEl)[0];
			this.settings.preventHide && !d.isNothing(this.closeEl) && d.DOM.hide(this.closeEl);
			this.playEl = d.DOM.find("." + g.Toolbar.CssClasses.play, this.toolbarEl)[0];
			this.settings.preventSlideshow && !d.isNothing(this.playEl) && d.DOM.hide(this.playEl);
			this.nextEl = d.DOM.find("." + g.Toolbar.CssClasses.next, this.toolbarEl)[0];
			this.previousEl = d.DOM.find("." + g.Toolbar.CssClasses.previous, this.toolbarEl)[0];
			l = g.Toolbar.CssClasses.caption;
			this.settings.captionAndToolbarFlipPosition && (l = l + " " + g.Toolbar.CssClasses.captionBottom);
			this.captionEl = d.DOM.createElement("div", {
				"class": l
			},
			"");
			d.DOM.setStyle(this.captionEl, {
				left: 0,
				position: "absolute",
				overflow: "hidden",
				zIndex: this.settings.zIndex
			});
			this.settings.target === a ? d.DOM.appendToBody(this.captionEl) : d.DOM.appendChild(this.captionEl, this.settings.target);
			d.DOM.hide(this.captionEl);
			this.captionContentEl = d.DOM.createElement("div", {
				"class": g.Toolbar.CssClasses.captionContent
			},
			"");
			d.DOM.appendChild(this.captionContentEl, this.captionEl);
			this.addEventHandlers()
		},
		resetPosition: function() {
			var e, g, l;
			this.settings.target === a ? (this.settings.captionAndToolbarFlipPosition ? (g = d.DOM.windowScrollTop(), l = d.DOM.windowScrollTop() + d.DOM.windowHeight() - d.DOM.height(this.captionEl)) : (g = d.DOM.windowScrollTop() + d.DOM.windowHeight() - d.DOM.height(this.toolbarEl), l = d.DOM.windowScrollTop()), e = d.DOM.windowWidth()) : (this.settings.captionAndToolbarFlipPosition ? (g = "0", l = d.DOM.height(this.settings.target) - d.DOM.height(this.captionEl)) : (g = d.DOM.height(this.settings.target) - d.DOM.height(this.toolbarEl), l = 0), e = d.DOM.width(this.settings.target));
			d.DOM.setStyle(this.toolbarEl, {
				top: g + "px",
				width: e
			});
			d.DOM.setStyle(this.captionEl, {
				top: l + "px",
				width: e
			})
		},
		toggleVisibility: function(a) {
			this.isVisible ? this.fadeOut() : this.show(a)
		},
		show: function(a) {
			d.Animation.stop(this.toolbarEl);
			d.Animation.stop(this.captionEl);
			this.resetPosition();
			this.setToolbarStatus(a);
			d.Events.fire(this, {
				type: g.Toolbar.EventTypes.onBeforeShow,
				target: this
			});
			this.showToolbar();
			this.setCaption(a);
			this.showCaption();
			this.isVisible = !0;
			this.setTimeout();
			d.Events.fire(this, {
				type: g.Toolbar.EventTypes.onShow,
				target: this
			})
		},
		setTimeout: function() {
			0 < this.settings.captionAndToolbarAutoHideDelay && (this.clearTimeout(), this.timeout = a.setTimeout(this.fadeOut.bind(this), this.settings.captionAndToolbarAutoHideDelay))
		},
		clearTimeout: function() {
			d.isNothing(this.timeout) || (a.clearTimeout(this.timeout), this.timeout = null)
		},
		fadeOut: function() {
			this.clearTimeout();
			d.Events.fire(this, {
				type: g.Toolbar.EventTypes.onBeforeHide,
				target: this
			});
			d.Animation.fadeOut(this.toolbarEl, this.settings.fadeOutSpeed);
			d.Animation.fadeOut(this.captionEl, this.settings.fadeOutSpeed, this.fadeOutHandler);
			this.isVisible = !1
		},
		addEventHandlers: function() {
			d.Browser.isTouchSupported && (d.Browser.blackberry || d.Events.add(this.toolbarEl, "touchstart", this.touchStartHandler), d.Events.add(this.toolbarEl, "touchmove", this.touchMoveHandler), d.Events.add(this.captionEl, "touchmove", this.touchMoveHandler));
			d.Events.add(this.toolbarEl, "click", this.clickHandler)
		},
		removeEventHandlers: function() {
			d.Browser.isTouchSupported && (d.Browser.blackberry || d.Events.remove(this.toolbarEl, "touchstart", this.touchStartHandler), d.Events.remove(this.toolbarEl, "touchmove", this.touchMoveHandler), d.Events.remove(this.captionEl, "touchmove", this.touchMoveHandler));
			d.Events.remove(this.toolbarEl, "click", this.clickHandler)
		},
		handleTap: function(a) {
			this.clearTimeout();
			var e;
			if (a.target === this.nextEl || d.DOM.isChildOf(a.target, this.nextEl)) e = g.Toolbar.ToolbarAction.next;
			else if (a.target === this.previousEl || d.DOM.isChildOf(a.target, this.previousEl)) e = g.Toolbar.ToolbarAction.previous;
			else if (a.target === this.closeEl || d.DOM.isChildOf(a.target, this.closeEl)) e = g.Toolbar.ToolbarAction.close;
			else if (a.target === this.playEl || d.DOM.isChildOf(a.target, this.playEl)) e = g.Toolbar.ToolbarAction.play;
			this.setTimeout();
			d.isNothing(e) && (e = g.Toolbar.ToolbarAction.none);
			d.Events.fire(this, {
				type: g.Toolbar.EventTypes.onTap,
				target: this,
				action: e,
				tapTarget: a.target
			})
		},
		setCaption: function(a) {
			d.DOM.removeChildren(this.captionContentEl);
			this.currentCaption = d.coalesce(this.cache.images[a].caption, "\u00a0");
			d.isObject(this.currentCaption) ? d.DOM.appendChild(this.currentCaption, this.captionContentEl) : ("" === this.currentCaption && (this.currentCaption = "\u00a0"), d.DOM.appendText(this.currentCaption, this.captionContentEl));
			this.currentCaption = "\u00a0" === this.currentCaption ? "": this.currentCaption;
			this.resetPosition()
		},
		showToolbar: function() {
			d.DOM.setStyle(this.toolbarEl, {
				opacity: this.settings.captionAndToolbarOpacity
			});
			d.DOM.show(this.toolbarEl)
		},
		showCaption: function() { ("" === this.currentCaption || 1 > this.captionContentEl.childNodes.length) && !this.settings.captionAndToolbarShowEmptyCaptions ? d.DOM.hide(this.captionEl) : (d.DOM.setStyle(this.captionEl, {
				opacity: this.settings.captionAndToolbarOpacity
			}), d.DOM.show(this.captionEl))
		},
		setToolbarStatus: function(a) {
			this.settings.loop || (d.DOM.removeClass(this.previousEl, g.Toolbar.CssClasses.previousDisabled), d.DOM.removeClass(this.nextEl, g.Toolbar.CssClasses.nextDisabled), 0 < a && a < this.cache.images.length - 1 || (0 === a && (d.isNothing(this.previousEl) || d.DOM.addClass(this.previousEl, g.Toolbar.CssClasses.previousDisabled)), a === this.cache.images.length - 1 && (d.isNothing(this.nextEl) || d.DOM.addClass(this.nextEl, g.Toolbar.CssClasses.nextDisabled))))
		},
		onFadeOut: function() {
			d.DOM.hide(this.toolbarEl);
			d.DOM.hide(this.captionEl);
			d.Events.fire(this, {
				type: g.Toolbar.EventTypes.onHide,
				target: this
			})
		},
		onTouchStart: function(a) {
			a.preventDefault();
			d.Events.remove(this.toolbarEl, "click", this.clickHandler);
			this.handleTap(a)
		},
		onTouchMove: function(a) {
			a.preventDefault()
		},
		onClick: function(a) {
			a.preventDefault();
			this.handleTap(a)
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.UILayer");
	a.Code.PhotoSwipe.UILayer.CssClasses = {
		uiLayer: "ps-uilayer"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.UILayer");
	var g = a.Code.PhotoSwipe;
	g.UILayer.UILayerClass = d.TouchElement.TouchElementClass.extend({
		el: null,
		settings: null,
		dispose: function() {
			var a;
			this.removeEventHandlers();
			d.DOM.removeChild(this.el, this.el.parentNode);
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e) {
			this.settings = e;
			this.el = d.DOM.createElement("div", {
				"class": g.UILayer.CssClasses.uiLayer
			},
			"");
			d.DOM.setStyle(this.el, {
				display: "block",
				position: "absolute",
				left: 0,
				top: 0,
				overflow: "hidden",
				zIndex: this.settings.zIndex,
				opacity: 0
			});
			d.DOM.hide(this.el);
			this.settings.target === a ? d.DOM.appendToBody(this.el) : d.DOM.appendChild(this.el, this.settings.target);
			this.supr(this.el, {
				swipe: !0,
				move: !0,
				gesture: d.Browser.iOS,
				doubleTap: !0,
				preventDefaultTouchEvents: this.settings.preventDefaultTouchEvents
			})
		},
		resetPosition: function() {
			this.settings.target === a ? d.DOM.setStyle(this.el, {
				top: d.DOM.windowScrollTop() + "px",
				width: d.DOM.windowWidth(),
				height: d.DOM.windowHeight()
			}) : d.DOM.setStyle(this.el, {
				top: "0px",
				width: d.DOM.width(this.settings.target),
				height: d.DOM.height(this.settings.target)
			})
		},
		show: function() {
			this.resetPosition();
			d.DOM.show(this.el);
			this.addEventHandlers()
		},
		addEventHandlers: function() {
			this.supr()
		},
		removeEventHandlers: function() {
			this.supr()
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");
	a = a.Code.PhotoSwipe;
	a.ZoomPanRotate.CssClasses = {
		zoomPanRotate: "ps-zoom-pan-rotate"
	};
	a.ZoomPanRotate.EventTypes = {
		onTransform: "PhotoSwipeZoomPanRotateOnTransform"
	}
})(window, window.klass, window.Code.Util); (function(a, e, d) {
	d.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");
	var g = a.Code.PhotoSwipe;
	g.ZoomPanRotate.ZoomPanRotateClass = e({
		el: null,
		settings: null,
		containerEl: null,
		imageEl: null,
		transformSettings: null,
		panStartingPoint: null,
		transformEl: null,
		dispose: function() {
			var a;
			d.DOM.removeChild(this.el, this.el.parentNode);
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e, k, l) {
			var m, n, o;
			this.settings = e;
			this.settings.target === a ? (e = document.body, m = d.DOM.windowWidth(), n = d.DOM.windowHeight(), o = d.DOM.windowScrollTop() + "px") : (e = this.settings.target, m = d.DOM.width(e), n = d.DOM.height(e), o = "0px");
			this.imageEl = k.imageEl.cloneNode(!1);
			d.DOM.setStyle(this.imageEl, {
				zIndex: 1
			});
			this.transformSettings = {
				startingScale: 1,
				scale: 1,
				startingRotation: 0,
				rotation: 0,
				startingTranslateX: 0,
				startingTranslateY: 0,
				translateX: 0,
				translateY: 0
			};
			this.el = d.DOM.createElement("div", {
				"class": g.ZoomPanRotate.CssClasses.zoomPanRotate
			},
			"");
			d.DOM.setStyle(this.el, {
				left: 0,
				top: o,
				position: "absolute",
				width: m,
				height: n,
				zIndex: this.settings.zIndex,
				display: "block"
			});
			d.DOM.insertBefore(this.el, l.el, e);
			d.Browser.iOS ? (this.containerEl = d.DOM.createElement("div", "", ""), d.DOM.setStyle(this.containerEl, {
				left: 0,
				top: 0,
				width: m,
				height: n,
				position: "absolute",
				zIndex: 1
			}), d.DOM.appendChild(this.imageEl, this.containerEl), d.DOM.appendChild(this.containerEl, this.el), d.Animation.resetTranslate(this.containerEl), d.Animation.resetTranslate(this.imageEl), this.transformEl = this.containerEl) : (d.DOM.appendChild(this.imageEl, this.el), this.transformEl = this.imageEl)
		},
		setStartingTranslateFromCurrentTransform: function() {
			var e = d.coalesce(this.transformEl.style.webkitTransform, this.transformEl.style.MozTransform, this.transformEl.style.transform);
			if (!d.isNothing(e) && (e = e.match(/translate\((.*?)\)/), !d.isNothing(e))) e = e[1].split(", "),
			this.transformSettings.startingTranslateX = a.parseInt(e[0], 10),
			this.transformSettings.startingTranslateY = a.parseInt(e[1], 10)
		},
		getScale: function(a) {
			a *= this.transformSettings.startingScale;
			0 !== this.settings.minUserZoom && a < this.settings.minUserZoom ? a = this.settings.minUserZoom: 0 !== this.settings.maxUserZoom && a > this.settings.maxUserZoom && (a = this.settings.maxUserZoom);
			return a
		},
		setStartingScaleAndRotation: function(a, d) {
			this.transformSettings.startingScale = this.getScale(a);
			this.transformSettings.startingRotation = (this.transformSettings.startingRotation + d) % 360
		},
		zoomRotate: function(a, d) {
			this.transformSettings.scale = this.getScale(a);
			this.transformSettings.rotation = this.transformSettings.startingRotation + d;
			this.applyTransform()
		},
		panStart: function(a) {
			this.setStartingTranslateFromCurrentTransform();
			this.panStartingPoint = {
				x: a.x,
				y: a.y
			}
		},
		pan: function(a) {
			var d = (a.y - this.panStartingPoint.y) / this.transformSettings.scale;
			this.transformSettings.translateX = this.transformSettings.startingTranslateX + (a.x - this.panStartingPoint.x) / this.transformSettings.scale;
			this.transformSettings.translateY = this.transformSettings.startingTranslateY + d;
			this.applyTransform()
		},
		zoomAndPanToPoint: function(e, g) {
			if (this.settings.target === a) {
				this.panStart({
					x: d.DOM.windowWidth() / 2,
					y: d.DOM.windowHeight() / 2
				});
				var l = (g.y - this.panStartingPoint.y) / this.transformSettings.scale;
				this.transformSettings.translateX = -1 * (this.transformSettings.startingTranslateX + (g.x - this.panStartingPoint.x) / this.transformSettings.scale);
				this.transformSettings.translateY = -1 * (this.transformSettings.startingTranslateY + l)
			}
			this.setStartingScaleAndRotation(e, 0);
			this.transformSettings.scale = this.transformSettings.startingScale;
			this.transformSettings.rotation = 0;
			this.applyTransform()
		},
		applyTransform: function() {
			var e = this.transformSettings.rotation % 360,
			k = a.parseInt(this.transformSettings.translateX, 10),
			l = a.parseInt(this.transformSettings.translateY, 10),
			m = "scale(" + this.transformSettings.scale + ") rotate(" + e + "deg) translate(" + k + "px, " + l + "px)";
			d.DOM.setStyle(this.transformEl, {
				webkitTransform: m,
				MozTransform: m,
				msTransform: m,
				transform: m
			});
			d.Events.fire(this, {
				target: this,
				type: g.ZoomPanRotate.EventTypes.onTransform,
				scale: this.transformSettings.scale,
				rotation: this.transformSettings.rotation,
				rotationDegs: e,
				translateX: k,
				translateY: l
			})
		}
	})
})(window, window.klass, window.Code.Util); (function(a, e) {
	e.registerNamespace("Code.PhotoSwipe");
	var d = a.Code.PhotoSwipe;
	d.CssClasses = {
		buildingBody: "ps-building",
		activeBody: "ps-active"
	};
	d.EventTypes = {
		onBeforeShow: "PhotoSwipeOnBeforeShow",
		onShow: "PhotoSwipeOnShow",
		onBeforeHide: "PhotoSwipeOnBeforeHide",
		onHide: "PhotoSwipeOnHide",
		onDisplayImage: "PhotoSwipeOnDisplayImage",
		onResetPosition: "PhotoSwipeOnResetPosition",
		onSlideshowStart: "PhotoSwipeOnSlideshowStart",
		onSlideshowStop: "PhotoSwipeOnSlideshowStop",
		onTouch: "PhotoSwipeOnTouch",
		onBeforeCaptionAndToolbarShow: "PhotoSwipeOnBeforeCaptionAndToolbarShow",
		onCaptionAndToolbarShow: "PhotoSwipeOnCaptionAndToolbarShow",
		onBeforeCaptionAndToolbarHide: "PhotoSwipeOnBeforeCaptionAndToolbarHide",
		onCaptionAndToolbarHide: "PhotoSwipeOnCaptionAndToolbarHide",
		onToolbarTap: "PhotoSwipeOnToolbarTap",
		onBeforeZoomPanRotateShow: "PhotoSwipeOnBeforeZoomPanRotateShow",
		onZoomPanRotateShow: "PhotoSwipeOnZoomPanRotateShow",
		onBeforeZoomPanRotateHide: "PhotoSwipeOnBeforeZoomPanRotateHide",
		onZoomPanRotateHide: "PhotoSwipeOnZoomPanRotateHide",
		onZoomPanRotateTransform: "PhotoSwipeOnZoomPanRotateTransform"
	};
	d.instances = [];
	d.activeInstances = [];
	d.setActivateInstance = function(a) {
		if ( - 1 < e.arrayIndexOf(a.settings.target, d.activeInstances, "target")) throw "Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";
		d.activeInstances.push({
			target: a.settings.target,
			instance: a
		})
	};
	d.unsetActivateInstance = function(a) {
		a = e.arrayIndexOf(a, d.activeInstances, "instance");
		d.activeInstances.splice(a, 1)
	};
	d.attach = function(a, j, k) {
		var l, m;
		l = d.createInstance(a, j, k);
		j = 0;
		for (k = a.length; j < k; j++) if (m = a[j], !e.isNothing(m.nodeType) && 1 === m.nodeType) m.__photoSwipeClickHandler = d.onTriggerElementClick.bind(l),
		e.Events.remove(m, "click", m.__photoSwipeClickHandler),
		e.Events.add(m, "click", m.__photoSwipeClickHandler);
		return l
	};
	a.jQuery && (a.jQuery.fn.photoSwipe = function(a, e) {
		return d.attach(this, a, e)
	});
	d.detatch = function(a) {
		var j, k, l;
		j = 0;
		for (k = a.originalImages.length; j < k; j++) l = a.originalImages[j],
		!e.isNothing(l.nodeType) && 1 === l.nodeType && (e.Events.remove(l, "click", l.__photoSwipeClickHandler), delete l.__photoSwipeClickHandler);
		d.disposeInstance(a)
	};
	d.createInstance = function(a, j, k) {
		var l;
		if (e.isNothing(a)) throw "Code.PhotoSwipe.attach: No images passed.";
		if (!e.isLikeArray(a)) throw "Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";
		if (1 > a.length) throw "Code.PhotoSwipe.createInstance: No images to passed.";
		j = e.coalesce(j, {});
		l = d.getInstance(k);
		if (e.isNothing(l)) l = new d.PhotoSwipeClass(a, j, k),
		d.instances.push(l);
		else throw 'Code.PhotoSwipe.createInstance: Instance with id "' + k + ' already exists."';
		return l
	};
	d.disposeInstance = function(a) {
		var e = d.getInstanceIndex(a);
		if (0 > e) throw "Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";
		a.dispose();
		d.instances.splice(e, 1)
	};
	d.onTriggerElementClick = function(a) {
		a.preventDefault();
		this.show(a.currentTarget)
	};
	d.getInstance = function(a) {
		var e, k, l;
		e = 0;
		for (k = d.instances.length; e < k; e++) if (l = d.instances[e], l.id === a) return l;
		return null
	};
	d.getInstanceIndex = function(a) {
		var e, k, l = -1;
		e = 0;
		for (k = d.instances.length; e < k; e++) if (d.instances[e] === a) {
			l = e;
			break
		}
		return l
	}
})(window, window.Code.Util); (function(a, e, d, g, j, k, l, m, n) {
	d.registerNamespace("Code.PhotoSwipe");
	var o = a.Code.PhotoSwipe;
	o.PhotoSwipeClass = e({
		id: null,
		settings: null,
		isBackEventSupported: null,
		backButtonClicked: null,
		currentIndex: null,
		originalImages: null,
		mouseWheelStartTime: null,
		windowDimensions: null,
		cache: null,
		documentOverlay: null,
		carousel: null,
		uiLayer: null,
		toolbar: null,
		zoomPanRotate: null,
		windowOrientationChangeHandler: null,
		windowScrollHandler: null,
		windowHashChangeHandler: null,
		keyDownHandler: null,
		windowOrientationEventName: null,
		uiLayerTouchHandler: null,
		carouselSlideByEndHandler: null,
		carouselSlideshowStartHandler: null,
		carouselSlideshowStopHandler: null,
		toolbarTapHandler: null,
		toolbarBeforeShowHandler: null,
		toolbarShowHandler: null,
		toolbarBeforeHideHandler: null,
		toolbarHideHandler: null,
		mouseWheelHandler: null,
		zoomPanRotateTransformHandler: null,
		_isResettingPosition: null,
		_uiWebViewResetPositionTimeout: null,
		dispose: function() {
			var a;
			d.Events.remove(this, o.EventTypes.onBeforeShow);
			d.Events.remove(this, o.EventTypes.onShow);
			d.Events.remove(this, o.EventTypes.onBeforeHide);
			d.Events.remove(this, o.EventTypes.onHide);
			d.Events.remove(this, o.EventTypes.onDisplayImage);
			d.Events.remove(this, o.EventTypes.onResetPosition);
			d.Events.remove(this, o.EventTypes.onSlideshowStart);
			d.Events.remove(this, o.EventTypes.onSlideshowStop);
			d.Events.remove(this, o.EventTypes.onTouch);
			d.Events.remove(this, o.EventTypes.onBeforeCaptionAndToolbarShow);
			d.Events.remove(this, o.EventTypes.onCaptionAndToolbarShow);
			d.Events.remove(this, o.EventTypes.onBeforeCaptionAndToolbarHide);
			d.Events.remove(this, o.EventTypes.onCaptionAndToolbarHide);
			d.Events.remove(this, o.EventTypes.onZoomPanRotateTransform);
			this.removeEventHandlers();
			d.isNothing(this.documentOverlay) || this.documentOverlay.dispose();
			d.isNothing(this.carousel) || this.carousel.dispose();
			d.isNothing(this.uiLayer) || this.uiLayer.dispose();
			d.isNothing(this.toolbar) || this.toolbar.dispose();
			this.destroyZoomPanRotate();
			d.isNothing(this.cache) || this.cache.dispose();
			for (a in this) d.objectHasProperty(this, a) && (this[a] = null)
		},
		initialize: function(e, j, k) {
			this.id = d.isNothing(k) ? "PhotoSwipe" + (new Date).getTime().toString() : k;
			this.originalImages = e;
			d.Browser.android && (!d.Browser.firefox && 2.1 <= a.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/, "")) && (this.isBackEventSupported = !0);
			this.isBackEventSupported || (this.isBackEventSupported = d.objectHasProperty(a, "onhashchange"));
			this.settings = {
				fadeInSpeed: 250,
				fadeOutSpeed: 250,
				preventHide: !1,
				preventSlideshow: !1,
				zIndex: 1E3,
				backButtonHideEnabled: !0,
				enableKeyboard: !0,
				enableMouseWheel: !0,
				mouseWheelSpeed: 350,
				autoStartSlideshow: !1,
				jQueryMobile: !d.isNothing(a.jQuery) && !d.isNothing(a.jQuery.mobile),
				jQueryMobileDialogHash: "\x26ui-state\x3ddialog",
				enableUIWebViewRepositionTimeout: !1,
				uiWebViewResetPositionDelay: 500,
				target: a,
				preventDefaultTouchEvents: !0,
				loop: !0,
				slideSpeed: 250,
				nextPreviousSlideSpeed: 0,
				enableDrag: !0,
				swipeThreshold: 50,
				swipeTimeThreshold: 250,
				slideTimingFunction: "ease-out",
				slideshowDelay: 3E3,
				doubleTapSpeed: 250,
				margin: 20,
				imageScaleMethod: "fit",
				captionAndToolbarHide: !1,
				captionAndToolbarFlipPosition: !1,
				captionAndToolbarAutoHideDelay: 5E3,
				captionAndToolbarOpacity: 0.8,
				captionAndToolbarShowEmptyCaptions: !0,
				getToolbar: o.Toolbar.getToolbar,
				allowUserZoom: !0,
				allowRotationOnUserZoom: !1,
				maxUserZoom: 5,
				minUserZoom: 0.5,
				doubleTapZoomLevel: 2.5,
				getImageSource: o.Cache.Functions.getImageSource,
				getImageCaption: o.Cache.Functions.getImageCaption,
				getImageMetaData: o.Cache.Functions.getImageMetaData,
				cacheMode: o.Cache.Mode.normal
			};
			d.extend(this.settings, j);
			this.settings.target !== a && (j = d.DOM.getStyle(this.settings.target, "position"), ("relative" !== j || "absolute" !== j) && d.DOM.setStyle(this.settings.target, "position", "relative"));
			this.settings.target !== a ? (this.isBackEventSupported = !1, this.settings.backButtonHideEnabled = !1) : this.settings.preventHide && (this.settings.backButtonHideEnabled = !1);
			this.cache = new g.CacheClass(e, this.settings)
		},
		show: function(e) {
			var g, j;
			this.backButtonClicked = this._isResettingPosition = !1;
			if (d.isNumber(e)) this.currentIndex = e;
			else {
				this.currentIndex = -1;
				g = 0;
				for (j = this.originalImages.length; g < j; g++) if (this.originalImages[g] === e) {
					this.currentIndex = g;
					break
				}
			}
			if (0 > this.currentIndex || this.currentIndex > this.originalImages.length - 1) throw "Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";
			this.isAlreadyGettingPage = this.getWindowDimensions();
			o.setActivateInstance(this);
			this.windowDimensions = this.getWindowDimensions();
			this.settings.target === a ? d.DOM.addClass(a.document.body, o.CssClasses.buildingBody) : d.DOM.addClass(this.settings.target, o.CssClasses.buildingBody);
			this.createComponents();
			d.Events.fire(this, {
				type: o.EventTypes.onBeforeShow,
				target: this
			});
			this.documentOverlay.fadeIn(this.settings.fadeInSpeed, this.onDocumentOverlayFadeIn.bind(this))
		},
		getWindowDimensions: function() {
			return {
				width: d.DOM.windowWidth(),
				height: d.DOM.windowHeight()
			}
		},
		createComponents: function() {
			this.documentOverlay = new j.DocumentOverlayClass(this.settings);
			this.carousel = new k.CarouselClass(this.cache, this.settings);
			this.uiLayer = new m.UILayerClass(this.settings);
			this.settings.captionAndToolbarHide || (this.toolbar = new l.ToolbarClass(this.cache, this.settings))
		},
		resetPosition: function() {
			if (!this._isResettingPosition) {
				var a = this.getWindowDimensions();
				if (d.isNothing(this.windowDimensions) || !(a.width === this.windowDimensions.width && a.height === this.windowDimensions.height)) this._isResettingPosition = !0,
				this.windowDimensions = a,
				this.destroyZoomPanRotate(),
				this.documentOverlay.resetPosition(),
				this.carousel.resetPosition(),
				d.isNothing(this.toolbar) || this.toolbar.resetPosition(),
				this.uiLayer.resetPosition(),
				this._isResettingPosition = !1,
				d.Events.fire(this, {
					type: o.EventTypes.onResetPosition,
					target: this
				})
			}
		},
		addEventHandler: function(a, e) {
			d.Events.add(this, a, e)
		},
		addEventHandlers: function() {
			d.isNothing(this.windowOrientationChangeHandler) && (this.windowOrientationChangeHandler = this.onWindowOrientationChange.bind(this), this.windowScrollHandler = this.onWindowScroll.bind(this), this.keyDownHandler = this.onKeyDown.bind(this), this.windowHashChangeHandler = this.onWindowHashChange.bind(this), this.uiLayerTouchHandler = this.onUILayerTouch.bind(this), this.carouselSlideByEndHandler = this.onCarouselSlideByEnd.bind(this), this.carouselSlideshowStartHandler = this.onCarouselSlideshowStart.bind(this), this.carouselSlideshowStopHandler = this.onCarouselSlideshowStop.bind(this), this.toolbarTapHandler = this.onToolbarTap.bind(this), this.toolbarBeforeShowHandler = this.onToolbarBeforeShow.bind(this), this.toolbarShowHandler = this.onToolbarShow.bind(this), this.toolbarBeforeHideHandler = this.onToolbarBeforeHide.bind(this), this.toolbarHideHandler = this.onToolbarHide.bind(this), this.mouseWheelHandler = this.onMouseWheel.bind(this), this.zoomPanRotateTransformHandler = this.onZoomPanRotateTransform.bind(this));
			d.Browser.android ? this.orientationEventName = "resize": d.Browser.iOS && !d.Browser.safari ? d.Events.add(a.document.body, "orientationchange", this.windowOrientationChangeHandler) : this.orientationEventName = !d.isNothing(a.onorientationchange) ? "orientationchange": "resize";
			d.isNothing(this.orientationEventName) || d.Events.add(a, this.orientationEventName, this.windowOrientationChangeHandler);
			this.settings.target === a && d.Events.add(a, "scroll", this.windowScrollHandler);
			this.settings.enableKeyboard && d.Events.add(a.document, "keydown", this.keyDownHandler);
			this.isBackEventSupported && this.settings.backButtonHideEnabled && (this.windowHashChangeHandler = this.onWindowHashChange.bind(this), this.settings.jQueryMobile ? a.location.hash = this.settings.jQueryMobileDialogHash: (this.currentHistoryHashValue = "PhotoSwipe" + (new Date).getTime().toString(), a.location.hash = this.currentHistoryHashValue), d.Events.add(a, "hashchange", this.windowHashChangeHandler));
			this.settings.enableMouseWheel && d.Events.add(a, "mousewheel", this.mouseWheelHandler);
			d.Events.add(this.uiLayer, d.TouchElement.EventTypes.onTouch, this.uiLayerTouchHandler);
			d.Events.add(this.carousel, k.EventTypes.onSlideByEnd, this.carouselSlideByEndHandler);
			d.Events.add(this.carousel, k.EventTypes.onSlideshowStart, this.carouselSlideshowStartHandler);
			d.Events.add(this.carousel, k.EventTypes.onSlideshowStop, this.carouselSlideshowStopHandler);
			d.isNothing(this.toolbar) || (d.Events.add(this.toolbar, l.EventTypes.onTap, this.toolbarTapHandler), d.Events.add(this.toolbar, l.EventTypes.onBeforeShow, this.toolbarBeforeShowHandler), d.Events.add(this.toolbar, l.EventTypes.onShow, this.toolbarShowHandler), d.Events.add(this.toolbar, l.EventTypes.onBeforeHide, this.toolbarBeforeHideHandler), d.Events.add(this.toolbar, l.EventTypes.onHide, this.toolbarHideHandler))
		},
		removeEventHandlers: function() {
			d.Browser.iOS && !d.Browser.safari && d.Events.remove(a.document.body, "orientationchange", this.windowOrientationChangeHandler);
			d.isNothing(this.orientationEventName) || d.Events.remove(a, this.orientationEventName, this.windowOrientationChangeHandler);
			d.Events.remove(a, "scroll", this.windowScrollHandler);
			this.settings.enableKeyboard && d.Events.remove(a.document, "keydown", this.keyDownHandler);
			this.isBackEventSupported && this.settings.backButtonHideEnabled && d.Events.remove(a, "hashchange", this.windowHashChangeHandler);
			this.settings.enableMouseWheel && d.Events.remove(a, "mousewheel", this.mouseWheelHandler);
			d.isNothing(this.uiLayer) || d.Events.remove(this.uiLayer, d.TouchElement.EventTypes.onTouch, this.uiLayerTouchHandler);
			d.isNothing(this.toolbar) || (d.Events.remove(this.carousel, k.EventTypes.onSlideByEnd, this.carouselSlideByEndHandler), d.Events.remove(this.carousel, k.EventTypes.onSlideshowStart, this.carouselSlideshowStartHandler), d.Events.remove(this.carousel, k.EventTypes.onSlideshowStop, this.carouselSlideshowStopHandler));
			d.isNothing(this.toolbar) || (d.Events.remove(this.toolbar, l.EventTypes.onTap, this.toolbarTapHandler), d.Events.remove(this.toolbar, l.EventTypes.onBeforeShow, this.toolbarBeforeShowHandler), d.Events.remove(this.toolbar, l.EventTypes.onShow, this.toolbarShowHandler), d.Events.remove(this.toolbar, l.EventTypes.onBeforeHide, this.toolbarBeforeHideHandler), d.Events.remove(this.toolbar, l.EventTypes.onHide, this.toolbarHideHandler))
		},
		hide: function() {
			if (!this.settings.preventHide) {
				if (d.isNothing(this.documentOverlay)) throw "Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";
				d.isNothing(this.hiding) && (this.clearUIWebViewResetPositionTimeout(), this.destroyZoomPanRotate(), this.removeEventHandlers(), d.Events.fire(this, {
					type: o.EventTypes.onBeforeHide,
					target: this
				}), this.uiLayer.dispose(), this.uiLayer = null, d.isNothing(this.toolbar) || (this.toolbar.dispose(), this.toolbar = null), this.carousel.dispose(), this.carousel = null, d.DOM.removeClass(a.document.body, o.CssClasses.activeBody), this.documentOverlay.dispose(), this.documentOverlay = null, this._isResettingPosition = !1, o.unsetActivateInstance(this), d.Events.fire(this, {
					type: o.EventTypes.onHide,
					target: this
				}), this.goBackInHistory())
			}
		},
		goBackInHistory: function() {
			this.isBackEventSupported && this.settings.backButtonHideEnabled && (this.backButtonClicked || a.history.back())
		},
		play: function() { ! this.isZoomActive() && !this.settings.preventSlideshow && !d.isNothing(this.carousel) && (!d.isNothing(this.toolbar) && this.toolbar.isVisible && this.toolbar.fadeOut(), this.carousel.startSlideshow())
		},
		stop: function() {
			this.isZoomActive() || d.isNothing(this.carousel) || this.carousel.stopSlideshow()
		},
		previous: function() {
			this.isZoomActive() || d.isNothing(this.carousel) || this.carousel.previous()
		},
		next: function() {
			this.isZoomActive() || d.isNothing(this.carousel) || this.carousel.next()
		},
		toggleToolbar: function() {
			this.isZoomActive() || d.isNothing(this.toolbar) || this.toolbar.toggleVisibility(this.currentIndex)
		},
		fadeOutToolbarIfVisible: function() { ! d.isNothing(this.toolbar) && this.toolbar.isVisible && 0 < this.settings.captionAndToolbarAutoHideDelay && this.toolbar.fadeOut()
		},
		createZoomPanRotate: function() {
			this.stop();
			this.canUserZoom() && !this.isZoomActive() && (d.Events.fire(this, o.EventTypes.onBeforeZoomPanRotateShow), this.zoomPanRotate = new n.ZoomPanRotateClass(this.settings, this.cache.images[this.currentIndex], this.uiLayer), this.uiLayer.captureSettings.preventDefaultTouchEvents = !0, d.Events.add(this.zoomPanRotate, o.ZoomPanRotate.EventTypes.onTransform, this.zoomPanRotateTransformHandler), d.Events.fire(this, o.EventTypes.onZoomPanRotateShow), !d.isNothing(this.toolbar) && this.toolbar.isVisible && this.toolbar.fadeOut())
		},
		destroyZoomPanRotate: function() {
			d.isNothing(this.zoomPanRotate) || (d.Events.fire(this, o.EventTypes.onBeforeZoomPanRotateHide), d.Events.remove(this.zoomPanRotate, o.ZoomPanRotate.EventTypes.onTransform, this.zoomPanRotateTransformHandler), this.zoomPanRotate.dispose(), this.zoomPanRotate = null, this.uiLayer.captureSettings.preventDefaultTouchEvents = this.settings.preventDefaultTouchEvents, d.Events.fire(this, o.EventTypes.onZoomPanRotateHide))
		},
		canUserZoom: function() {
			var a;
			if (d.Browser.msie) {
				if (a = document.createElement("div"), d.isNothing(a.style.msTransform)) return ! 1
			} else if (!d.Browser.isCSSTransformSupported) return ! 1;
			if (!this.settings.allowUserZoom || this.carousel.isSliding) return ! 1;
			a = this.cache.images[this.currentIndex];
			return d.isNothing(a) || a.isLoading ? !1 : !0
		},
		isZoomActive: function() {
			return ! d.isNothing(this.zoomPanRotate)
		},
		getCurrentImage: function() {
			return this.cache.images[this.currentIndex]
		},
		onDocumentOverlayFadeIn: function() {
			a.setTimeout(function() {
				var e = this.settings.target === a ? a.document.body: this.settings.target;
				d.DOM.removeClass(e, o.CssClasses.buildingBody);
				d.DOM.addClass(e, o.CssClasses.activeBody);
				this.addEventHandlers();
				this.carousel.show(this.currentIndex);
				this.uiLayer.show();
				this.settings.autoStartSlideshow ? this.play() : d.isNothing(this.toolbar) || this.toolbar.show(this.currentIndex);
				d.Events.fire(this, {
					type: o.EventTypes.onShow,
					target: this
				});
				this.setUIWebViewResetPositionTimeout()
			}.bind(this), 250)
		},
		setUIWebViewResetPositionTimeout: function() {
			this.settings.enableUIWebViewRepositionTimeout && (d.Browser.iOS && !d.Browser.safari) && (d.isNothing(this._uiWebViewResetPositionTimeout) || a.clearTimeout(this._uiWebViewResetPositionTimeout), this._uiWebViewResetPositionTimeout = a.setTimeout(function() {
				this.resetPosition();
				this.setUIWebViewResetPositionTimeout()
			}.bind(this), this.settings.uiWebViewResetPositionDelay))
		},
		clearUIWebViewResetPositionTimeout: function() {
			d.isNothing(this._uiWebViewResetPositionTimeout) || a.clearTimeout(this._uiWebViewResetPositionTimeout)
		},
		onWindowScroll: function() {
			this.resetPosition()
		},
		onWindowOrientationChange: function() {
			this.resetPosition()
		},
		onWindowHashChange: function() {
			if (a.location.hash !== "#" + (this.settings.jQueryMobile ? this.settings.jQueryMobileDialogHash: this.currentHistoryHashValue)) this.backButtonClicked = !0,
			this.hide()
		},
		onKeyDown: function(a) {
			37 === a.keyCode ? (a.preventDefault(), this.previous()) : 39 === a.keyCode ? (a.preventDefault(), this.next()) : 38 === a.keyCode || 40 === a.keyCode ? a.preventDefault() : 27 === a.keyCode ? (a.preventDefault(), this.hide()) : 32 === a.keyCode ? (this.settings.hideToolbar ? this.hide() : this.toggleToolbar(), a.preventDefault()) : 13 === a.keyCode && (a.preventDefault(), this.play())
		},
		onUILayerTouch: function(e) {
			if (this.isZoomActive()) switch (e.action) {
			case d.TouchElement.ActionTypes.gestureChange:
				this.zoomPanRotate.zoomRotate(e.scale, this.settings.allowRotationOnUserZoom ? e.rotation: 0);
				break;
			case d.TouchElement.ActionTypes.gestureEnd:
				this.zoomPanRotate.setStartingScaleAndRotation(e.scale, this.settings.allowRotationOnUserZoom ? e.rotation: 0);
				break;
			case d.TouchElement.ActionTypes.touchStart:
				this.zoomPanRotate.panStart(e.point);
				break;
			case d.TouchElement.ActionTypes.touchMove:
				this.zoomPanRotate.pan(e.point);
				break;
			case d.TouchElement.ActionTypes.doubleTap:
				this.destroyZoomPanRotate();
				this.toggleToolbar();
				break;
			case d.TouchElement.ActionTypes.swipeLeft:
				this.destroyZoomPanRotate();
				this.next();
				this.toggleToolbar();
				break;
			case d.TouchElement.ActionTypes.swipeRight:
				this.destroyZoomPanRotate(),
				this.previous(),
				this.toggleToolbar()
			} else switch (e.action) {
			case d.TouchElement.ActionTypes.touchMove:
			case d.TouchElement.ActionTypes.swipeLeft:
			case d.TouchElement.ActionTypes.swipeRight:
				this.fadeOutToolbarIfVisible();
				this.carousel.onTouch(e.action, e.point);
				break;
			case d.TouchElement.ActionTypes.touchStart:
			case d.TouchElement.ActionTypes.touchMoveEnd:
				this.carousel.onTouch(e.action, e.point);
				break;
			case d.TouchElement.ActionTypes.tap:
				this.toggleToolbar();
				break;
			case d.TouchElement.ActionTypes.doubleTap:
				this.settings.target === a && (e.point.x -= d.DOM.windowScrollLeft(), e.point.y -= d.DOM.windowScrollTop());
				var g = this.cache.images[this.currentIndex].imageEl,
				j = a.parseInt(d.DOM.getStyle(g, "top"), 10),
				k = a.parseInt(d.DOM.getStyle(g, "left"), 10),
				l = k + d.DOM.width(g),
				g = j + d.DOM.height(g);
				e.point.x < k ? e.point.x = k: e.point.x > l && (e.point.x = l);
				e.point.y < j ? e.point.y = j: e.point.y > g && (e.point.y = g);
				this.createZoomPanRotate();
				this.isZoomActive() && this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel, e.point);
				break;
			case d.TouchElement.ActionTypes.gestureStart:
				this.createZoomPanRotate()
			}
			d.Events.fire(this, {
				type: o.EventTypes.onTouch,
				target: this,
				point: e.point,
				action: e.action
			})
		},
		onCarouselSlideByEnd: function(a) {
			this.currentIndex = a.cacheIndex;
			d.isNothing(this.toolbar) || (this.toolbar.setCaption(this.currentIndex), this.toolbar.setToolbarStatus(this.currentIndex));
			d.Events.fire(this, {
				type: o.EventTypes.onDisplayImage,
				target: this,
				action: a.action,
				index: a.cacheIndex
			})
		},
		onToolbarTap: function(a) {
			switch (a.action) {
			case l.ToolbarAction.next:
				this.next();
				break;
			case l.ToolbarAction.previous:
				this.previous();
				break;
			case l.ToolbarAction.close:
				this.hide();
				break;
			case l.ToolbarAction.play:
				this.play()
			}
			d.Events.fire(this, {
				type: o.EventTypes.onToolbarTap,
				target: this,
				toolbarAction: a.action,
				tapTarget: a.tapTarget
			})
		},
		onMouseWheel: function(a) {
			var e = d.Events.getWheelDelta(a);
			a.timeStamp - (this.mouseWheelStartTime || 0) < this.settings.mouseWheelSpeed || (this.mouseWheelStartTime = a.timeStamp, this.settings.invertMouseWheel && (e *= -1), 0 > e ? this.next() : 0 < e && this.previous())
		},
		onCarouselSlideshowStart: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onSlideshowStart,
				target: this
			})
		},
		onCarouselSlideshowStop: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onSlideshowStop,
				target: this
			})
		},
		onToolbarBeforeShow: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onBeforeCaptionAndToolbarShow,
				target: this
			})
		},
		onToolbarShow: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onCaptionAndToolbarShow,
				target: this
			})
		},
		onToolbarBeforeHide: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onBeforeCaptionAndToolbarHide,
				target: this
			})
		},
		onToolbarHide: function() {
			d.Events.fire(this, {
				type: o.EventTypes.onCaptionAndToolbarHide,
				target: this
			})
		},
		onZoomPanRotateTransform: function(a) {
			d.Events.fire(this, {
				target: this,
				type: o.EventTypes.onZoomPanRotateTransform,
				scale: a.scale,
				rotation: a.rotation,
				rotationDegs: a.rotationDegs,
				translateX: a.translateX,
				translateY: a.translateY
			})
		}
	})
})(window, window.klass, window.Code.Util, window.Code.PhotoSwipe.Cache, window.Code.PhotoSwipe.DocumentOverlay, window.Code.PhotoSwipe.Carousel, window.Code.PhotoSwipe.Toolbar, window.Code.PhotoSwipe.UILayer, window.Code.PhotoSwipe.ZoomPanRotate);
function NEEGlobalTextPT() {
	this.title = function() {
		return dmStr["ui.nee.common.design.35"]
	};
	this.showMindTouchHelp = !0;
	this.mindTouchId = "dmMtDesignStyleTextStyleEditor";
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.text.style.popup.1"],
			imgSrc: "TextStyleIcon",
			onTabReady: this._assignControlText
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.text.style.popup.2"],
			imgSrc: "HeadingStyleImgIcon",
			onTabReady: this._assignControlHeading
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.nee.mainTabs.52"],
			imgSrc: "buttonsStyleImgIcon",
			onTabReady: this._assignControlButns
		}]
	}
}
NEEGlobalTextPT.prototype._assignControlText = function(a) {
	var e = ["*#dm div.dmContent A *", "*#dm div.dmContent A", "*#dm div.dmFooter A"],
	d = $.dmfw.getPreviewElement(".dmContent A"),
	g = ["*#dm div.dmContent *", "*#dm div.dmFooter *", "*#dm div.dm-title"],
	j = $.dmfw.getPreviewElement(".dmContent *"),
	k = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.14"],
		onReady: function() {
			0 != j.length && $.dmops.scrollPreviewToElement(j);
			a.neeSecondaryDesignTabs({
				tabs: {
					color: ["text", "link_gb", "underline_links_pt", "font_type_pt", "font_size_pt"]
				},
				colorCallbacks: {
					text: function(a) {
						updateInChangePage(g, "color", a)
					},
					link: function(a) {
						updateInChangePage(e, "color", a)
					}
				},
				colorDefaults: {
					link_gb: function() {
						return getDefaultValue("a", "color")
					}
				},
				colorPreviewCallbacks: {
					text: function(a, d) {
						d ? j.css("color", "") : j.css("color", a)
					},
					link: function(a, e) {
						e ? d.css("color", "") : d.css("color", a)
					}
				},
				onReadyCallbacks: {
					underline_links_pt: function(a) {
						var e = "underline" == d.css("text-decoration") ? !0 : !1;
						a.find(".ptColorListItem:last").addUnderlineFunctionality(e)
					},
					font_type_pt: function(a) {
						a = a.find(".ptColorListItem:last");
						a.append($('\x3clabel class\x3d"ptColorsGlobalLabel" \x3e' + dmStr["ui.nee.text.style.popup.4"] + '\x3c/label\x3e\x3cdiv class\x3d"styledSelect globalTextDrop" style\x3d"width: 150px; float:right;"\x3e\x3cspan id\x3d"fontGlobalText"\x3e\x3c/span\x3e\x3c/div\x3e'));
						var d = j.css("font-family"); - 1 != d.indexOf("'") && (d = d.substr(1, d.length - 2)); - 1 != d.indexOf(",") && (d = d.replace(/,/g, ""));
						a.find(".styledSelect").fontSelector({
							callback: function(a) {
								updateInChangePage(g, "font-family", "'" + a + "'")
							},
							elemToDisplay: a.find("#fontGlobalText")
						});
						a.find("#fontGlobalText").text(d)
					},
					font_size_pt: function(a) {
						$('\x3clabel class\x3d"ptColorsGlobalLabel" \x3e' + dmStr["ui.nee.text.style.popup.5"] + "\x3c/label\x3e").prependTo(a.find(".ptColorListItem:last"));
						var d = j.css("font-size");
						a.find(".headerTextSizeChange").neeChangeTextSize(d,
						function(a) {
							updateInChangePage(g, "font-size", a)
						})
					}
				},
				currentPreviewElement: j,
				changeGlobally: !0
			});
			$.fn.addUnderlineFunctionality = function(a) {
				var d = $("\x3cdiv\x3e\x3c/div\x3e").attr("class", "neeNoMark");
				$('\x3clabel class\x3d"ptColorsGlobalLabel" \x3e' + dmStr["ui.nee.text.style.popup.3"] + "\x3c/label\x3e").appendTo(d);
				var g = $("\x3cdiv style\x3d'margin-top: 6px;float: right;margin-right: 10px;'\x3e\x3c/div\x3e").attr("class", "neeNoMark").appendTo(d);
				d.appendTo(this);
				g.onOffBtn({
					initState: a,
					onFn: function() {
						updateInChangePage(e, "text-decoration", "underline")
					},
					offFn: function() {
						updateInChangePage(e, "text-decoration", "none")
					}
				})
			}
		}
	}];
	$(a).neeSecondaryTabsControl(k)
};NEEGlobalTextPT.prototype._assignControlHeading = function(a) {
	var e = $.dmfw.getPreviewElement(".dmContent H1"),
	d = [];
	d["1"] = "*#dm div.dmContent h1 *;*#dm div.dmFooter h1 *;*#dm div.dm-title h1 *;*#dm div.dmContent h1;*#dm div.dmFooter h1;*#dm div.dm-title h1".split(";");
	d["2"] = "*#dm div.dmContent h2 *;*#dm div.dmFooter h2 *;*#dm div.dm-title h2 *;*#dm div.dmContent h2;*#dm div.dmFooter h2;*#dm div.dm-title h2".split(";");
	d["3"] = "*#dm div.dmContent h3 *;*#dm div.dmFooter h3 *;*#dm div.dm-title h3 *;*#dm div.dmContent h3;*#dm div.dmFooter h3;*#dm div.dm-title h3".split(";");
	d["4"] = "*#dm div.dmContent h4 *;*#dm div.dmFooter h4 *;*#dm div.dm-title h4 *;*#dm div.dmContent h4;*#dm div.dmFooter h4;*#dm div.dm-title h4".split(";");
	var g = [{
		url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
		name: dmStr["ui.nee.mainTabs.14"],
		onReady: function() {
			function g(a, e) {
				var j = !0,
				k = $.dmfw.getPreviewElement(".dmContent H" + e),
				l = k.css("font-size");
				0 == k.length && (l = getDefaultValue("H" + e, "font-size"), j = !1);
				var s = d[e];
				j || a.find(".warningHalert").show().dmQtip({
					content: '"H' + e + '" elements do not exist in the current page'
				});
				a.find(".headerTextSizeChange").neeChangeTextSize(l,
				function(a) {
					updateInChangePage(s, "font-size", a)
				})
			}
			function k(a, e) {
				var g = $.dmfw.getPreviewElement(".dmContent H" + a),
				j = d[a];
				0 != g.length && $.dmops.scrollPreviewToElement(g);
				updateInChangePage(j, "color", e)
			}
			function l(a, d, e) {
				e = $.dmfw.getPreviewElement(".dmContent H" + e);
				d ? e.css("color", "") : e.css("color", a)
			}
			0 != e.length && $.dmops.scrollPreviewToElement(e);
			a.neeSecondaryDesignTabs({
				tabs: {
					color: ["heading_num1_pt", "heading_num2_pt", "heading_num3_pt", "heading_num4_pt"]
				},
				colorDefaults: {
					heading_num1_pt: function() {
						return getDefaultValue("H1", "color")
					},
					heading_num2_pt: function() {
						return getDefaultValue("H2", "color")
					},
					heading_num3_pt: function() {
						return getDefaultValue("H3", "color")
					},
					heading_num4_pt: function() {
						return getDefaultValue("H4", "color")
					}
				},
				colorCallbacks: {
					heading_num1_pt: function(a) {
						k(1, a)
					},
					heading_num2_pt: function(a) {
						k(2, a)
					},
					heading_num3_pt: function(a) {
						k(3, a)
					},
					heading_num4_pt: function(a) {
						k(4, a)
					}
				},
				colorPreviewCallbacks: {
					heading_num1_pt: function(a, d) {
						l(a, d, 1)
					},
					heading_num2_pt: function(a, d) {
						l(a, d, 2)
					},
					heading_num3_pt: function(a, d) {
						l(a, d, 3)
					},
					heading_num4_pt: function(a, d) {
						l(a, d, 4)
					}
				},
				onReadyCallbacks: {
					heading_num1_pt: function(a) {
						g(a.find(".ptColorListItem:last"), 1)
					},
					heading_num2_pt: function(a) {
						g(a.find(".ptColorListItem:last"), 2)
					},
					heading_num3_pt: function(a) {
						g(a.find(".ptColorListItem:last"), 3)
					},
					heading_num4_pt: function(a) {
						g(a.find(".ptColorListItem:last"), 4)
					}
				},
				currentPreviewElement: e,
				changeGlobally: !0
			})
		}
	}];
	$(a).neeSecondaryTabsControl(g)
};NEEGlobalTextPT.prototype._assignControlButns = function(a) {
	var e = $.dmfw.getPreviewElement(".dmWwr.dmWidget"),
	d = ["*#dm div.dmInner .dmWwr.dmWidget"],
	g = ["*#dm div.dmInner .dmWwr.dmWidget span.text"];
	_changeBtnsBackgroundGlobally = function(a) {
		$.changePage({
			clientChange: function() {},
			serverChange: function() {
				$.dmPostWithHistory({
					url: "/sites/" + $.dmx.site.id + "/updatePalette/",
					data: {
						name: "widget-color",
						value: a
					},
					success: function(a) {
						$.dmops.refreshGlobalCss(a.value, 1E3)
					}
				})
			}
		})
	};
	$(a).neePtSecondaryDesignTabs({
		textSelector: "span.text",
		textColorList: ["text"],
		changeGlobally: !0,
		currentPreviewElement: e,
		previewElementToWorkOn: e,
		forceClassName: d,
		useElement: e,
		element: e,
		elem: e,
		specForceClassName: {
			background_widgets: d,
			border: d,
			text: g
		},
		updateInChangePage: !0,
		forceClassNameChangePage: g,
		forceClassNameIcon: ["*#dm div.dmInner .dmWwr.dmWidget span.iconBg"],
		colorCallbacks: {
			background_widgets: _changeBtnsBackgroundGlobally
		},
		tabs: {
			tab_colors: ["background_widgets", "border"],
			tab_effects: ["eff_shadow", "eff_gradient", "eff_rounded_corners", "eff_show_icon"],
			tab_text_style: ["text_general", "text_color"]
		}
	})
};
function getDefaultValue(a, e) {
	var d = $("\x3c" + a + "\x3e\x3c/" + a + "\x3e").hide(),
	g = $.dmfw.getPreviewElement(".dmContent *");
	d.appendTo(g);
	d = $(g).find(a).css(e);
	$(g).find(a).remove();
	return d
}
NEEGlobalTextPT.prototype.editorReady = function(a, e) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo,
		initTab: e.tabToOpen
	})
};NEEGlobalTextPT.prototype.onEditorClose = function() {};
var requirejs, require, define; (function(a) {
	function e(a) {
		return "[object Function]" === R.call(a)
	}
	function d(a) {
		return "[object Array]" === R.call(a)
	}
	function g(a, d) {
		if (a) {
			var e;
			for (e = 0; e < a.length && (!a[e] || !d(a[e], e, a)); e += 1);
		}
	}
	function j(a, d) {
		if (a) {
			var e;
			for (e = a.length - 1; - 1 < e && (!a[e] || !d(a[e], e, a)); e -= 1);
		}
	}
	function k(a, d) {
		return ea.call(a, d)
	}
	function l(a, d) {
		return k(a, d) && a[d]
	}
	function m(a, d) {
		for (var e in a) if (k(a, e) && d(a[e], e)) break
	}
	function n(a, d, e, g) {
		d && m(d,
		function(d, j) {
			if (e || !k(a, j)) g && "string" !== typeof d ? (a[j] || (a[j] = {}), n(a[j], d, e, g)) : a[j] = d
		});
		return a
	}
	function o(a, d) {
		return function() {
			return d.apply(a, arguments)
		}
	}
	function r(d) {
		if (!d) return d;
		var e = a;
		g(d.split("."),
		function(a) {
			e = e[a]
		});
		return e
	}
	function u(a, d, e, g) {
		d = Error(d + "\nhttp://requirejs.org/docs/errors.html#" + a);
		d.requireType = a;
		d.requireModules = g;
		e && (d.originalError = e);
		return d
	}
	function s(j) {
		function s(a, d, e) {
			var g, j, k, m, n, o, r, u = d && d.split("/"),
			v = wa.map,
			z = v && v["*"];
			if (a && "." === a.charAt(0)) if (d) {
				g = l(wa.pkgs, d) ? u = [d] : u.slice(0, u.length - 1);
				d = a = g.concat(a.split("/"));
				for (g = 0; d[g]; g += 1) if (j = d[g], "." === j) d.splice(g, 1),
				g -= 1;
				else if (".." === j) if (1 === g && (".." === d[2] || ".." === d[0])) break;
				else 0 < g && (d.splice(g - 1, 2), g -= 2);
				g = l(wa.pkgs, d = a[0]);
				a = a.join("/");
				g && a === d + "/" + g.main && (a = d)
			} else 0 === a.indexOf("./") && (a = a.substring(2));
			if (e && (u || z) && v) {
				d = a.split("/");
				for (g = d.length; 0 < g; g -= 1) {
					k = d.slice(0, g).join("/");
					if (u) for (j = u.length; 0 < j; j -= 1) if (e = l(v, u.slice(0, j).join("/"))) if (e = l(e, k)) {
						m = e;
						n = g;
						break
					}
					if (m) break; ! o && z && l(z, k) && (o = l(z, k), r = g)
				} ! m && o && (m = o, n = r);
				m && (d.splice(0, n, m), a = d.join("/"))
			}
			return a
		}
		function v(a) {
			Y && g(document.getElementsByTagName("script"),
			function(d) {
				if (d.getAttribute("data-requiremodule") === a && d.getAttribute("data-requirecontext") === Q.contextName) return d.parentNode.removeChild(d),
				!0
			})
		}
		function z(a) {
			var e = l(wa.paths, a);
			if (e && d(e) && 1 < e.length) return v(a),
			e.shift(),
			Q.require.undef(a),
			Q.require([a]),
			!0
		}
		function D(a) {
			var d, e = a ? a.indexOf("!") : -1; - 1 < e && (d = a.substring(0, e), a = a.substring(e + 1, a.length));
			return [d, a]
		}
		function C(a, d, e, g) {
			var j, k, m = null,
			n = d ? d.name: null,
			o = a,
			r = !0,
			u = "";
			a || (r = !1, a = "_@r" + (Za += 1));
			a = D(a);
			m = a[0];
			a = a[1];
			m && (m = s(m, n, g), k = l(ya, m));
			a && (m ? u = k && k.normalize ? k.normalize(a,
			function(a) {
				return s(a, n, g)
			}) : s(a, n, g) : (u = s(a, n, g), a = D(u), m = a[0], u = a[1], e = !0, j = Q.nameToUrl(u)));
			e = m && !k && !e ? "_unnormalized" + (Ua += 1) : "";
			return {
				prefix: m,
				name: u,
				parentMap: d,
				unnormalized: !!e,
				url: j,
				originalName: o,
				isDefine: r,
				id: (m ? m + "!" + u: u) + e
			}
		}
		function E(a) {
			var d = a.id,
			e = l(sa, d);
			e || (e = sa[d] = new Q.Module(a));
			return e
		}
		function F(a, d, e) {
			var g = a.id,
			j = l(sa, g);
			if (k(ya, g) && (!j || j.defineEmitComplete))"defined" === d && e(ya[g]);
			else E(a).on(d, e)
		}
		function G(a, d) {
			var e = a.requireModules,
			j = !1;
			if (d) d(a);
			else if (g(e,
			function(d) {
				if (d = l(sa, d)) d.error = a,
				d.events.error && (j = !0, d.emit("error", a))
			}), !j) B.onError(a)
		}
		function J() {
			P.length && (Z.apply(Ma, [Ma.length - 1, 0].concat(P)), P = [])
		}
		function K(a, d, e) {
			var j = a.map.id;
			a.error ? a.emit("error", a.error) : (d[j] = !0, g(a.depMaps,
			function(g, j) {
				var k = g.id,
				m = l(sa, k);
				m && !a.depMatched[j] && !e[k] && (l(d, k) ? (a.defineDep(j, ya[k]), a.check()) : K(m, d, e))
			}), e[j] = !0)
		}
		function M() {
			var a, d, e, j, k = (e = 1E3 * wa.waitSeconds) && Q.startTime + e < (new Date).getTime(),
			l = [],
			n = [],
			o = !1,
			r = !0;
			if (!ja) {
				ja = !0;
				m(sa,
				function(e) {
					a = e.map;
					d = a.id;
					if (e.enabled && (a.isDefine || n.push(e), !e.error)) if (!e.inited && k) z(d) ? o = j = !0 : (l.push(d), v(d));
					else if (!e.inited && e.fetched && a.isDefine && (o = !0, !a.prefix)) return r = !1
				});
				if (k && l.length) return e = u("timeout", "Load timeout for modules: " + l, null, l),
				e.contextName = Q.contextName,
				G(e);
				r && g(n,
				function(a) {
					K(a, {},
					{})
				});
				if ((!k || j) && o) if ((Y || W) && !pa) pa = setTimeout(function() {
					pa = 0;
					M()
				},
				50);
				ja = !1
			}
		}
		function N(a) {
			k(ya, a[0]) || E(C(a[0], null, !0)).init(a[1], a[2])
		}
		function R(a) {
			a = a.currentTarget || a.srcElement;
			var d = Q.onScriptLoad;
			a.detachEvent && !ha ? a.detachEvent("onreadystatechange", d) : a.removeEventListener("load", d, !1);
			d = Q.onScriptError; (!a.detachEvent || ha) && a.removeEventListener("error", d, !1);
			return {
				node: a,
				id: a && a.getAttribute("data-requiremodule")
			}
		}
		function ea() {
			var a;
			for (J(); Ma.length;) {
				a = Ma.shift();
				if (null === a[0]) return G(u("mismatch", "Mismatched anonymous define() module: " + a[a.length - 1]));
				N(a)
			}
		}
		var ja, X, Q, ma, pa, wa = {
			waitSeconds: 7,
			baseUrl: "./",
			paths: {},
			pkgs: {},
			shim: {},
			map: {},
			config: {}
		},
		sa = {},
		qa = {},
		Ma = [],
		ya = {},
		Pa = {},
		Za = 1,
		Ua = 1;
		ma = {
			require: function(a) {
				return a.require ? a.require: a.require = Q.makeRequire(a.map)
			},
			exports: function(a) {
				a.usingExports = !0;
				if (a.map.isDefine) return a.exports ? a.exports: a.exports = ya[a.map.id] = {}
			},
			module: function(a) {
				return a.module ? a.module: a.module = {
					id: a.map.id,
					uri: a.map.url,
					config: function() {
						return wa.config && l(wa.config, a.map.id) || {}
					},
					exports: ya[a.map.id]
				}
			}
		};
		X = function(a) {
			this.events = l(qa, a.id) || {};
			this.map = a;
			this.shim = l(wa.shim, a.id);
			this.depExports = [];
			this.depMaps = [];
			this.depMatched = [];
			this.pluginMaps = {};
			this.depCount = 0
		};
		X.prototype = {
			init: function(a, d, e, g) {
				g = g || {};
				if (!this.inited) {
					this.factory = d;
					if (e) this.on("error", e);
					else this.events.error && (e = o(this,
					function(a) {
						this.emit("error", a)
					}));
					this.depMaps = a && a.slice(0);
					this.errback = e;
					this.inited = !0;
					this.ignore = g.ignore;
					g.enabled || this.enabled ? this.enable() : this.check()
				}
			},
			defineDep: function(a, d) {
				this.depMatched[a] || (this.depMatched[a] = !0, this.depCount -= 1, this.depExports[a] = d)
			},
			fetch: function() {
				if (!this.fetched) {
					this.fetched = !0;
					Q.startTime = (new Date).getTime();
					var a = this.map;
					if (this.shim) Q.makeRequire(this.map, {
						enableBuildCallback: !0
					})(this.shim.deps || [], o(this,
					function() {
						return a.prefix ? this.callPlugin() : this.load()
					}));
					else return a.prefix ? this.callPlugin() : this.load()
				}
			},
			load: function() {
				var a = this.map.url;
				Pa[a] || (Pa[a] = !0, Q.load(this.map.id, a))
			},
			check: function() {
				if (this.enabled && !this.enabling) {
					var a, d, g = this.map.id;
					d = this.depExports;
					var j = this.exports,
					k = this.factory;
					if (this.inited) if (this.error) this.emit("error", this.error);
					else {
						if (!this.defining) {
							this.defining = !0;
							if (1 > this.depCount && !this.defined) {
								if (e(k)) {
									if (this.events.error) try {
										j = Q.execCb(g, k, d, j)
									} catch(l) {
										a = l
									} else j = Q.execCb(g, k, d, j);
									this.map.isDefine && ((d = this.module) && void 0 !== d.exports && d.exports !== this.exports ? j = d.exports: void 0 === j && this.usingExports && (j = this.exports));
									if (a) return a.requireMap = this.map,
									a.requireModules = [this.map.id],
									a.requireType = "define",
									G(this.error = a)
								} else j = k;
								this.exports = j;
								if (this.map.isDefine && !this.ignore && (ya[g] = j, B.onResourceLoad)) B.onResourceLoad(Q, this.map, this.depMaps);
								delete sa[g];
								this.defined = !0
							}
							this.defining = !1;
							this.defined && !this.defineEmitted && (this.defineEmitted = !0, this.emit("defined", this.exports), this.defineEmitComplete = !0)
						}
					} else this.fetch()
				}
			},
			callPlugin: function() {
				var a = this.map,
				d = a.id,
				e = C(a.prefix);
				this.depMaps.push(e);
				F(e, "defined", o(this,
				function(e) {
					var g, j;
					j = this.map.name;
					var n = this.map.parentMap ? this.map.parentMap.name: null,
					r = Q.makeRequire(a.parentMap, {
						enableBuildCallback: !0
					});
					if (this.map.unnormalized) {
						if (e.normalize && (j = e.normalize(j,
						function(a) {
							return s(a, n, !0)
						}) || ""), e = C(a.prefix + "!" + j, this.map.parentMap), F(e, "defined", o(this,
						function(a) {
							this.init([],
							function() {
								return a
							},
							null, {
								enabled: !0,
								ignore: !0
							})
						})), j = l(sa, e.id)) {
							this.depMaps.push(e);
							if (this.events.error) j.on("error", o(this,
							function(a) {
								this.emit("error", a)
							}));
							j.enable()
						}
					} else g = o(this,
					function(a) {
						this.init([],
						function() {
							return a
						},
						null, {
							enabled: !0
						})
					}),
					g.error = o(this,
					function(a) {
						this.inited = !0;
						this.error = a;
						a.requireModules = [d];
						m(sa,
						function(a) {
							0 === a.map.id.indexOf(d + "_unnormalized") && delete sa[a.map.id]
						});
						G(a)
					}),
					g.fromText = o(this,
					function(e, j) {
						var l = a.name,
						m = C(l),
						n = ua;
						j && (e = j);
						n && (ua = !1);
						E(m);
						k(wa.config, d) && (wa.config[l] = wa.config[d]);
						try {
							B.exec(e)
						} catch(o) {
							return G(u("fromtexteval", "fromText eval for " + d + " failed: " + o, o, [d]))
						}
						n && (ua = !0);
						this.depMaps.push(m);
						Q.completeLoad(l);
						r([l], g)
					}),
					e.load(a.name, r, g, wa)
				}));
				Q.enable(e, this);
				this.pluginMaps[e.id] = e
			},
			enable: function() {
				this.enabling = this.enabled = !0;
				g(this.depMaps, o(this,
				function(a, d) {
					var e, g;
					if ("string" === typeof a) {
						a = C(a, this.map.isDefine ? this.map: this.map.parentMap, !1, !this.skipMap);
						this.depMaps[d] = a;
						if (e = l(ma, a.id)) {
							this.depExports[d] = e(this);
							return
						}
						this.depCount += 1;
						F(a, "defined", o(this,
						function(a) {
							this.defineDep(d, a);
							this.check()
						}));
						this.errback && F(a, "error", this.errback)
					}
					e = a.id;
					g = sa[e]; ! k(ma, e) && g && !g.enabled && Q.enable(a, this)
				}));
				m(this.pluginMaps, o(this,
				function(a) {
					var d = l(sa, a.id);
					d && !d.enabled && Q.enable(a, this)
				}));
				this.enabling = !1;
				this.check()
			},
			on: function(a, d) {
				var e = this.events[a];
				e || (e = this.events[a] = []);
				e.push(d)
			},
			emit: function(a, d) {
				g(this.events[a],
				function(a) {
					a(d)
				});
				"error" === a && delete this.events[a]
			}
		};
		Q = {
			config: wa,
			contextName: j,
			registry: sa,
			defined: ya,
			urlFetched: Pa,
			defQueue: Ma,
			Module: X,
			makeModuleMap: C,
			nextTick: B.nextTick,
			configure: function(a) {
				a.baseUrl && "/" !== a.baseUrl.charAt(a.baseUrl.length - 1) && (a.baseUrl += "/");
				var e = wa.pkgs,
				j = wa.shim,
				k = {
					paths: !0,
					config: !0,
					map: !0
				};
				m(a,
				function(a, d) {
					k[d] ? "map" === d ? n(wa[d], a, !0, !0) : n(wa[d], a, !0) : wa[d] = a
				});
				a.shim && (m(a.shim,
				function(a, e) {
					d(a) && (a = {
						deps: a
					});
					if ((a.exports || a.init) && !a.exportsFn) a.exportsFn = Q.makeShimExports(a);
					j[e] = a
				}), wa.shim = j);
				a.packages && (g(a.packages,
				function(a) {
					a = "string" === typeof a ? {
						name: a
					}: a;
					e[a.name] = {
						name: a.name,
						location: a.location || a.name,
						main: (a.main || "main").replace(ra, "").replace(O, "")
					}
				}), wa.pkgs = e);
				m(sa,
				function(a, d) { ! a.inited && !a.map.unnormalized && (a.map = C(d))
				});
				if (a.deps || a.callback) Q.require(a.deps || [], a.callback)
			},
			makeShimExports: function(d) {
				return function() {
					var e;
					d.init && (e = d.init.apply(a, arguments));
					return e || d.exports && r(d.exports)
				}
			},
			makeRequire: function(a, d) {
				function g(l, m, n) {
					var o, r;
					d.enableBuildCallback && m && e(m) && (m.__requireJsBuild = !0);
					if ("string" === typeof l) {
						if (e(m)) return G(u("requireargs", "Invalid require call"), n);
						if (a && k(ma, l)) return ma[l](sa[a.id]);
						if (B.get) return B.get(Q, l, a);
						o = C(l, a, !1, !0);
						o = o.id;
						return ! k(ya, o) ? G(u("notloaded", 'Module name "' + o + '" has not been loaded yet for context: ' + j + (a ? "": ". Use require([])"))) : ya[o]
					}
					ea();
					Q.nextTick(function() {
						ea();
						r = E(C(null, a));
						r.skipMap = d.skipMap;
						r.init(l, m, n, {
							enabled: !0
						});
						M()
					});
					return g
				}
				d = d || {};
				n(g, {
					isBrowser: Y,
					toUrl: function(d) {
						var e, g = d.lastIndexOf("."),
						j = d.split("/")[0];
						if ( - 1 !== g && (!("." === j || ".." === j) || 1 < g)) e = d.substring(g, d.length),
						d = d.substring(0, g);
						d = Q.nameToUrl(s(d, a && a.id, !0), e || ".fake");
						return e ? d: d.substring(0, d.length - 5)
					},
					defined: function(d) {
						return k(ya, C(d, a, !1, !0).id)
					},
					specified: function(d) {
						d = C(d, a, !1, !0).id;
						return k(ya, d) || k(sa, d)
					}
				});
				a || (g.undef = function(d) {
					J();
					var e = C(d, a, !0),
					g = l(sa, d);
					delete ya[d];
					delete Pa[e.url];
					delete qa[d];
					g && (g.events.defined && (qa[d] = g.events), delete sa[d])
				});
				return g
			},
			enable: function(a) {
				l(sa, a.id) && E(a).enable()
			},
			completeLoad: function(a) {
				var d, e, g = l(wa.shim, a) || {},
				j = g.exports;
				for (J(); Ma.length;) {
					e = Ma.shift();
					if (null === e[0]) {
						e[0] = a;
						if (d) break;
						d = !0
					} else e[0] === a && (d = !0);
					N(e)
				}
				e = l(sa, a);
				if (!d && !k(ya, a) && e && !e.inited) {
					if (wa.enforceDefine && (!j || !r(j))) return z(a) ? void 0 : G(u("nodefine", "No define call for " + a, null, [a]));
					N([a, g.deps || [], g.exportsFn])
				}
				M()
			},
			nameToUrl: function(a, e) {
				var g, j, k, m, n, o;
				if (B.jsExtRegExp.test(a)) m = a + (e || "");
				else {
					g = wa.paths;
					j = wa.pkgs;
					m = a.split("/");
					for (n = m.length; 0 < n; n -= 1) if (o = m.slice(0, n).join("/"), k = l(j, o), o = l(g, o)) {
						d(o) && (o = o[0]);
						m.splice(0, n, o);
						break
					} else if (k) {
						g = a === k.name ? k.location + "/" + k.main: k.location;
						m.splice(0, n, g);
						break
					}
					m = m.join("/");
					m += e || (/\?/.test(m) ? "": ".js");
					m = ("/" === m.charAt(0) || m.match(/^[\w\+\.\-]+:/) ? "": wa.baseUrl) + m
				}
				return wa.urlArgs ? m + (( - 1 === m.indexOf("?") ? "?": "\x26") + wa.urlArgs) : m
			},
			load: function(a, d) {
				B.load(Q, a, d)
			},
			execCb: function(a, d, e, g) {
				return d.apply(g, e)
			},
			onScriptLoad: function(a) {
				if ("load" === a.type || ca.test((a.currentTarget || a.srcElement).readyState)) I = null,
				a = R(a),
				Q.completeLoad(a.id)
			},
			onScriptError: function(a) {
				var d = R(a);
				if (!z(d.id)) return G(u("scripterror", "Script error", a, [d.id]))
			}
		};
		Q.require = Q.makeRequire();
		return Q
	}
	var B, z, v, D, E, F, I, G, K, J, C = /(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,
	N = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,
	O = /\.js$/,
	ra = /^\.\//;
	z = Object.prototype;
	var R = z.toString,
	ea = z.hasOwnProperty,
	Z = Array.prototype.splice,
	Y = !!("undefined" !== typeof window && navigator && document),
	W = !Y && "undefined" !== typeof importScripts,
	ca = Y && "PLAYSTATION 3" === navigator.platform ? /^complete$/: /^(complete|loaded)$/,
	ha = "undefined" !== typeof opera && "[object Opera]" === opera.toString(),
	M = {},
	ja = {},
	P = [],
	ua = !1;
	if ("undefined" === typeof define) {
		if ("undefined" !== typeof requirejs) {
			if (e(requirejs)) return;
			ja = requirejs;
			requirejs = void 0
		}
		"undefined" !== typeof require && !e(require) && (ja = require, require = void 0);
		B = requirejs = function(a, e, g, j) {
			var k, m = "_"; ! d(a) && "string" !== typeof a && (k = a, d(e) ? (a = e, e = g, g = j) : a = []);
			k && k.context && (m = k.context); (j = l(M, m)) || (j = M[m] = B.s.newContext(m));
			k && j.configure(k);
			return j.require(a, e, g)
		};
		B.config = function(a) {
			return B(a)
		};
		B.nextTick = "undefined" !== typeof setTimeout ?
		function(a) {
			setTimeout(a, 4)
		}: function(a) {
			a()
		};
		require || (require = B);
		B.version = "2.1.4";
		B.jsExtRegExp = /^\/|:|\?|\.js$/;
		B.isBrowser = Y;
		z = B.s = {
			contexts: M,
			newContext: s
		};
		B({});
		g(["toUrl", "undef", "defined", "specified"],
		function(a) {
			B[a] = function() {
				var d = M._;
				return d.require[a].apply(d, arguments)
			}
		});
		if (Y && (v = z.head = document.getElementsByTagName("head")[0], D = document.getElementsByTagName("base")[0])) v = z.head = D.parentNode;
		B.onError = function(a) {
			throw a;
		};
		B.load = function(a, d, e) {
			var g = a && a.config || {},
			j;
			if (Y) return j = g.xhtml ? document.createElementNS("http://www.w3.org/1999/xhtml", "html:script") : document.createElement("script"),
			j.type = g.scriptType || "text/javascript",
			j.charset = "utf-8",
			j.async = !0,
			j.setAttribute("data-requirecontext", a.contextName),
			j.setAttribute("data-requiremodule", d),
			j.attachEvent && !(j.attachEvent.toString && 0 > j.attachEvent.toString().indexOf("[native code")) && !ha ? (ua = !0, j.attachEvent("onreadystatechange", a.onScriptLoad)) : (j.addEventListener("load", a.onScriptLoad, !1), j.addEventListener("error", a.onScriptError, !1)),
			j.src = e,
			G = j,
			D ? v.insertBefore(j, D) : v.appendChild(j),
			G = null,
			j;
			W && (importScripts(e), a.completeLoad(d))
		};
		Y && j(document.getElementsByTagName("script"),
		function(a) {
			v || (v = a.parentNode);
			if (E = a.getAttribute("data-main")) return ja.baseUrl || (F = E.split("/"), K = F.pop(), J = F.length ? F.join("/") + "/": "./", ja.baseUrl = J, E = K),
			E = E.replace(O, ""),
			ja.deps = ja.deps ? ja.deps.concat(E) : [E],
			!0
		});
		define = function(a, g, k) {
			var l, m;
			"string" !== typeof a && (k = g, g = a, a = null);
			d(g) || (k = g, g = []); ! g.length && e(k) && k.length && (k.toString().replace(C, "").replace(N,
			function(a, d) {
				g.push(d)
			}), g = (1 === k.length ? ["require"] : ["require", "exports", "module"]).concat(g));
			if (ua) {
				if (! (l = G)) I && "interactive" === I.readyState || j(document.getElementsByTagName("script"),
				function(a) {
					if ("interactive" === a.readyState) return I = a
				}),
				l = I;
				l && (a || (a = l.getAttribute("data-requiremodule")), m = M[l.getAttribute("data-requirecontext")])
			} (m ? m.defQueue: P).push([a, g, k])
		};
		define.amd = {
			jQuery: !0
		};
		B.exec = function(a) {
			return eval(a)
		};
		B(ja)
	}
})(this);require.config(function() {
	var a = "r\x3d" + (new Date).getTime();
	$.ptConfigs.isDev || (a = $.ptConfigs.buildVersion.replace("?", ""));
	return {
		urlArgs: a,
		paths: {
			neeUtils: "/editor/nee/utils/"
		}
	}
} ()); (function(a) {
	function e(d, e, g) {
		d.value = a(e).text();
		a(d).change();
		a.browser.msie || d.focus();
		g.hide()
	}
	function d(a, d) {
		var e = a.getHours(),
		g = d.show24Hours ? e: (e + 11) % 12 + 1,
		j = a.getMinutes();
		return (10 > g ? "0": "") + g + d.separator + ((10 > j ? "0": "") + j) + (d.show24Hours ? "": 12 > e ? " AM": " PM")
	}
	function g(a, d) {
		return "object" == typeof a ? k(a) : j(a, d)
	}
	function j(a, d) {
		if (a) {
			var e = a.split(d.separator),
			g = parseFloat(e[0]),
			e = parseFloat(e[1]);
			d.show24Hours || (12 === g && -1 !== a.indexOf("AM") ? g = 0 : 12 !== g && -1 !== a.indexOf("PM") && (g += 12));
			return k(new Date(0, 0, 0, g, e, 0))
		}
		return null
	}
	function k(a) {
		a.setFullYear(2001);
		a.setMonth(0);
		a.setDate(0);
		return a
	}
	a.fn.timePicker = function(d) {
		var e = a.extend({},
		a.fn.timePicker.defaults, d);
		return this.each(function() {
			a.timePicker(this, e)
		})
	};
	a.timePicker = function(d, e) {
		var g = a(d)[0];
		return g.timePicker || (g.timePicker = new jQuery._timePicker(g, e))
	};
	a.timePicker.version = "0.3";
	a._timePicker = function(l, m) {
		var n = !1,
		o = !1,
		r = g(m.startTime, m),
		u = g(m.endTime, m);
		a(l).attr("autocomplete", "OFF");
		for (var s = [], B = new Date(r); B <= u;) s[s.length] = d(B, m),
		B = new Date(B.setMinutes(B.getMinutes() + m.step));
		for (var z = a('\x3cdiv class\x3d"time-picker' + (m.show24Hours ? "": " time-picker-12hours") + '"\x3e\x3c/div\x3e'), v = a("\x3cul\x3e\x3c/ul\x3e"), B = 0; B < s.length; B++) v.append("\x3cli\x3e" + s[B] + "\x3c/li\x3e");
		z.append(v);
		z.appendTo("body").hide();
		z.mouseover(function() {
			n = !0
		}).mouseout(function() {
			n = !1
		});
		a("li", v).mouseover(function() {
			o || (a("li.selected", z).removeClass("selected"), a(this).addClass("selected"))
		}).mousedown(function() {
			n = !0
		}).click(function() {
			e(l, this, z, m);
			n = !1
		});
		var D = function() {
			if (z.is(":visible")) return ! 1;
			a("li", z).removeClass("selected");
			var e = a(l).offset();
			z.css({
				top: e.top + l.offsetHeight,
				left: e.left
			});
			z.show();
			var g = l.value ? j(l.value, m) : r,
			e = 60 * r.getHours() + r.getMinutes(),
			g = 60 * g.getHours() + g.getMinutes() - e,
			g = Math.round(g / m.step),
			e = k(new Date(0, 0, 0, 0, g * m.step + e, 0)),
			e = r < e && e <= u ? e: r,
			e = a("li:contains(" + d(e, m) + ")", z);
			e.length && (e.addClass("selected"), z[0].scrollTop = e[0].offsetTop);
			return ! 0
		};
		a(l).focus(D).click(D);
		a(l).blur(function() {
			n || z.hide()
		});
		s = a.browser.opera || a.browser.mozilla ? "keypress": "keydown";
		a(l)[s](function(d) {
			o = !0;
			var g = z[0].scrollTop;
			switch (d.keyCode) {
			case 38:
				if (D()) return ! 1;
				d = a("li.selected", v);
				var j = d.prev().addClass("selected")[0];
				j ? (d.removeClass("selected"), j.offsetTop < g && (z[0].scrollTop = g - j.offsetHeight)) : (d.removeClass("selected"), j = a("li:last", v).addClass("selected")[0], z[0].scrollTop = j.offsetTop - j.offsetHeight);
				return ! 1;
			case 40:
				if (D()) return ! 1;
				d = a("li.selected", v); (j = d.next().addClass("selected")[0]) ? (d.removeClass("selected"), j.offsetTop + j.offsetHeight > g + z[0].offsetHeight && (z[0].scrollTop = g + j.offsetHeight)) : (d.removeClass("selected"), a("li:first", v).addClass("selected"), z[0].scrollTop = 0);
				return ! 1;
			case 13:
				return z.is(":visible") && (g = a("li.selected", v)[0], e(l, g, z, m)),
				!1;
			case 27:
				return z.hide(),
				!1
			}
			return ! 0
		});
		a(l).keyup(function() {
			o = !1
		});
		this.getTime = function() {
			return j(l.value, m)
		};
		this.setTime = function(e) {
			l.value = d(g(e, m), m);
			a(l).change()
		}
	};
	a.fn.timePicker.defaults = {
		step: 30,
		startTime: new Date(0, 0, 0, 0, 0, 0),
		endTime: new Date(0, 0, 0, 23, 30, 0),
		separator: ":",
		show24Hours: !0
	}
})(jQuery);$.extend({
	dmmsg: {
		getMsg: function(a, e, d) {
			a = isReseller ? a + "_reseller.html": dm_anonymus_user ? a + "_newuser.html": a + "_user.html";
			$.get(a,
			function(a) {
				var j = $(a).find(".msg");
				0 < j.length && (a = Math.floor(Math.random() * j.length), e(j.get(a)), setInterval(function() {
					var a = Math.floor(Math.random() * j.length);
					d(j.get(a))
				},
				3E4))
			})
		}
	}
});
var NEFW = NEFW || {},
DEFAULT_PAGE_DESIGN_ALIAS = "default",
HOME_PAGE_DESIGN_ALIAS = "home",
ORIGINAL_PAGE_ALIAS = "original";NEFW.PREVIEW = $("#_preview");$.extend({
	ptfw: {
		previewArea: {},
		previewWrapper: {},
		editorArea: {},
		init: function(a) {
			dm_anonymus_user && wrTrackEvent(PT_NEW_USER_SITE_CREATED);
			isReseller && $("body").addClass("reseller");
			a = a || {};
			var e = $.ptShellContr.getHistoryToken();
			e && (a = $.extend({
				forceTab: e
			},
			a));
			$(window).bind("beforeunload",
			function() {
				if (dm_anonymus_user) return wrTrackEvent("pt_newuser_goingtoleave"),
				$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/signupPopup/createAccountPopupOld.jsp", {
					init: function() {
						$.dmfw.openPopUpCreateAccount({
							afterConfirm: function() {
								$.ptShellContr._afterCreatingAccount();
								wrTrackEvent("pt_newuser_created_account")
							}
						});
						setTimeout("wrTrackEvent('pt_newuser_didntleave');", 1E3)
					}
				}),
				"If you leave now, all the hard work you've done on your mobile site will be lost. Save your progress."
			});
			$.ptfw.previewWrapper = $("#PreviewPaneInnerWrapper");
			$.ptfw.previewArea = $("#_preview");
			$.ptfw.editorArea = $("#ptEditorAreaChange");
			$.dmfw._init();
			$._dmInlineInit($.dmfw.editables());
			$.history.init(function(a) {
				$.dmfw.handleHistoryToken(a)
			},
			{
				unescape: !0
			});
			$.dmfw.adjustScreenHeight();
			$.ptShellContr.initShell(a);
			$.ptAccordContr.initTabs(a);
			NEFW.PREVIEW = $("#_preview");
			NEFW.onPreviewReady = function(a) {
				$.ptfw.onPreviewReady(a)
			};
			NEFW.onPreviewLoad = function() {
				$.ptfw.onPreviewLoad()
			};
			NEFW.runPreviewStyleImages = function() {
				$.ptfw.runPreviewStyleImages()
			};
			NEFW.NAV = {};
			NEFW.NAV.maintabs = function() {};
			NEFW.dmfw = function() {
				return $.dmfw
			};
			$(window).unbind("load.general").bind("load.general",
			function(a) {
				$.ptfw.onWindowLoad(a)
			});
			isShowTipsDesign && "read" != $.getCookie("_dm_pt_tips_design") && require(["neeUtils/nee.pt.tips"],
			function() {
				var a = {
					toList: "design",
					title: dmStr["ui.help.message.5"],
					body: dmStr["ui.help.message.6"],
					relativeElement: $("#PreviewPaneWrapper"),
					relativeDirection: "left"
				},
				a = new $.ptTips(a),
				a = {
					toList: "design",
					title: dmStr["ui.help.message.3"],
					body: dmStr["ui.help.message.4"],
					relativeElement: $("#ptSideMenuEdit"),
					relativeDirection: "right",
					nextTip: a
				},
				a = new $.ptTips(a),
				a = {
					toList: "design",
					title: dmStr["ui.help.message.1"],
					body: dmStr["ui.help.message.2"],
					relativeElement: $("#ptSideMenuDesignColors"),
					relativeDirection: "right",
					nextTip: a
				},
				a = new $.ptTips(a);
				$.setCookie("_dm_pt_tips_design", "read", 8064, "/", !1);
				a.init()
			})
		},
		reload: function(a) {
			a.firstTime && $.dmx.site.isBlog && ($.dmx._showBlogBubbleFirstTime = !0);
			$.dmfw.previewNavigateTo({
				page: {
					siteAlias: a.siteAlias,
					alias: a.pageAlias ? a.pageAlias: "home",
					checkPremium: a.firstTime ? !0 : !1
				},
				onContextUpdated: function() {
					a.success && a.success()
				}
			})
		},
		onWindowLoad: function() {
			NEFW.PREVIEW.unbind("clickoutside").bind("clickoutside",
			function() {
				$.dmfw.isUseNewSelectionContext() && ($.dmfw.isEditorOpen() || $.deselectAllEditableElements())
			})
		},
		runPreviewStyleImages: function() {
			try {
				if ($.dmx.preview.wnd()) return $.dmx.preview.wnd().styleImages()
			} catch(a) {
				$.log(a)
			}
		},
		onPreviewReady: function(a) {
			try {
				var e = NEFW.PREVIEW.contents();
				$.dmBlockUI();
				var d = $.dmops.updateEditContext.clientOnly({
					siteAlias: a.SiteAlias,
					pageAlias: a.InitialPageAlias,
					pageUrl: a.CurrentPageUrl,
					isPageEqualToLiveUrl: a.isPageEqualToLiveUrl,
					isPageOutOfSync: a.isPageOutOfSync,
					useCache: !0,
					success: function() {
						$.dmfw.resetEmulatorPremiumMode();
						$.dmfw.checkSitePublished();
						try {
							$.dmx.site.showAds && ("GOMO" != $.dmx.site.dmProductType && 3 != $.dmx.site.planId) && $.dmfw.initAdCloser();
							$.dmx.site.showPoweredBy && ("GOMO" != $.dmx.site.dmProductType && "GDWST" != $.dmx.site.dmProductType) && $.dmfw.initPoweredByCloser();
							$.dmfw._processPageSyncStatus();
							$.each($.dmfw.editables(),
							function(a, d) {
								d.docReady(e)
							});
							$.dmx.rt.currentNavTitle = $.dmx.preview.wnd()._findCurrentNavText().trim();
							$.dmx.rt.currentNavId = $.dmx.preview.wnd()._findCurrentNavId();
							if ($.dmx.site.isBlog && "home" == $.dmx.page.alias) {
								var a = $.dmfw.getPreviewElement("a.dmBlogItem1");
								0 < a.length && ($.dmx.rt.blogFirststPostHref = a.attr("href"))
							}
							$.dmfw.previewWrapper.find(".neePreviewPagesPanelPhoneNav").neeNavtoWidget().setCurrent($.dmx.rt.currentNavTitle);
							if ($.dmx.onPreviewReady) {
								var d = $.dmx.onPreviewReady;
								$.dmx.onPreviewReady = null;
								d()
							}
							$.dmUnblockUI();
							$.dmx.skipUndoReset ? neeHistoryManager.addFirstHistoryIfNeeed() : neeHistoryManager.clearAndUpdateHistory();
							$.dmx.events.trigger("onPreviewReady")
						} catch(g) {
							$.dmNotifyEx(g)
						}
						$.dmUnblockUI()
					}
				});
				$.dmx.skipUndoReset = !1;
				$.dmx.preview.wnd().jQuery.DM.hangEventsOnMoreLess(function() {
					setTimeout("$.dmops.redrawSelection();", 0)
				});
				$.dmops.checkEmptyContent();
				$.dmfw._preloadDefaultImages();
				d || $.dmUnblockUI()
			} catch(g) {
				$.dmNotifyEx(g),
				$.dmUnblockUI()
			}
		},
		onPreviewLoad: function() {
			if ($.dmx.onPreviewLoad) {
				var a = $.dmx.onPreviewLoad;
				$.dmx.onPreviewLoad = null;
				a()
			}
			if ($.dmx.page && $.dmx.page.alias && "home" == $.dmx.page.alias) {
				var e = $.dmx.getSiteNav();
				$.dmops.updateEditContext.all({
					success: function() {
						var a = $.dmx.getSiteNav(),
						g = !1;
						if (e.length != a.length) g = !0;
						else for (var j = 0; j < e.length; j++) if (e[j].itemTitle != a[j].itemTitle) {
							g = !0;
							break
						}
						g && $.ptPages.init()
					}
				})
			}
		},
		recreateSite: function(a, e) {
			showCreationLoading($.dmx.site.baseUrl);
			$.dmPost({
				url: "/sites/recreatesimple/",
				data: {
					forceDefaultPlatform: e,
					isRecreate: !0,
					originalAlias: a
				},
				success: function() {
					$("#siteCreationLoading").hide();
					window.open("/home/site/" + a, "_self")
				},
				error: function(a) {
					if (a.responseText) try {
						msg = JSON.parse(a.responseText).message,
						alert(msg)
					} catch(e) {
						$.log("Failed to parse server exception " + a.responseText)
					}
				}
			})
		},
		openEditor: function() {},
		closeAllEditors: function() {},
		onTabReadyOuter: function() {},
		onTabReadyInner: function() {},
		showEditor: function() {},
		showLoading: function() {},
		hideLoading: function() {},
		onSwitchTab: function() {},
		loadToHistory: function() {},
		isUseNewSelection: function() {
			return ! 0
		}
	}
}); (function() {
	$.extend({
		ptPayments: {
			payments: {},
			init: function() {
				var a = dm_site_alias;
				dm_anonymus_user || (a = $.dmx.site.alias);
				a && $.dmGet({
					url: "/sites/payment/" + a,
					success: function(a) {
						$.ptPayments.payments = a
					}
				})
			},
			getContractToUse: function() {
				var a = $.ptPayments.payments.contracts;
				if (a) for (var e = 0; e < a.length; e++) if ("monthly" == a[e].recurrenceType) return a[e];
				return null
			}
		}
	})
})();$.extend({
	ptColor: {
		init: function() {
			function a(a) {
				NEESiteColors.prototype.editorReady(a, null, !0)
			}
			_handleColorPalettesScreen = function(a) {
				var d = [];
				$.dmGet({
					url: "/sites/" + $.dmx.site.id + "/getallpalettes/",
					success: function(g) {
						if (g) {
							$("#showingPalettesMsg").hide();
							if (null != g[ - 1] && !a) {
								var j = $("\x3cdiv class\x3d'ColorSchemeItem selected customPalette' id\x3d'dmCustomColorPalette'\x3e\x3c/div\x3e"),
								k = $("\x3cdiv class\x3d'customPaletteIcon' id\x3d'dmCustomPaletteIcon'\x3e\x3c/div\x3e"),
								l = $("\x3cdiv class\x3d'paletteColorWrapperCustom' id\x3d'paletteColorWrapperCustom'\x3e\x3c/div\x3e").append(k).appendTo(j);
								$.dmSetToolTip("#dmCustomColorPalette", dmStr["ui.pt.design.color.8"], l, k);
								$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem1").css("background-color", g[ - 1][0]);
								$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem2").css("background-color", g[ - 1][1]);
								$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem3").css("background-color", g[ - 1][2]);
								$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem4").css("background-color", g[ - 1][3]);
								$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem5").css("background-color", g[ - 1][4]);
								$("\x3cdiv\x3e\x3c/div\x3e").css("clear", "both").appendTo(l);
								$("\x3cdiv class\x3d'navColorCustom triggerOpenCustomizeColor'\x3e\x3c/div\x3e").html(dmStr["ui.nee.layouts.5"]).appendTo(j).addClass("navColorCustom blueBtn");
								d.push(j)
							}
							for (j = 0; null != g[j];) k = $("\x3cdiv\x3e\x3c/div\x3e").addClass("ColorSchemeItem"),
							l = $("\x3cdiv\x3e\x3c/div\x3e").appendTo(k).addClass("paletteColorWrapper").attr("dmPaletteID", j),
							$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem1").css("background-color", 6 < g[j].length ? g[j][6] : g[j][3]),
							$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem2").css("background-color", g[j][2]),
							$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem3").css("background-color", g[j][1]),
							$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem4").css("background-color", g[j][0]),
							$("\x3cspan\x3e\x3c/span\x3e").appendTo(l).addClass("colorItem5").css("background-color", g[j][5]),
							$("\x3cdiv\x3e\x3c/div\x3e").css("clear", "both").appendTo(l),
							$("\x3cdiv class\x3d'navColorCustom triggerOpenCustomizeColor'\x3e\x3c/div\x3e").html(dmStr["ui.nee.layouts.5"]).appendTo(k).addClass("navColorCustom blueBtn"),
							d.push(k),
							j++;
							$(".palettesWrapper").show();
							allPalletesElements = d;
							$(d[null == $.dmx.site.paletteID || -1 == $.dmx.site.paletteID ? 0 : $.dmx.site.paletteID]).addClass("selected");
							$(".palettesWrapperPaging").empty().neePagingWidget(d, null == $.dmx.site.paletteID || -1 == $.dmx.site.paletteID ? 0 : $.dmx.site.paletteID, "arrows", 1)
						}
					}
				})
			};
			$.dmx.site.isUsingLayout ? _handleColorPalettesScreen() : ($("#showImageIfNoColor").addClass("colorsLinkToLayouts"), $("#LinkToNewLayoutChangeLayout").unbind("click").click(function() {
				$("#ptSideMenuDesignLayout").click()
			}));
			$("#ptEditorArea").unbind("click.changeColorCustomize").on("click.changeColorCustomize", ".triggerOpenCustomizeColor",
			function() {
				$.dmfw.openPopup($('\x3cdiv class\x3d"CustomizeColorOuterWrapper"\x3e\x3c/div\x3e'), {
					init: a,
					showIphone: !0,
					beforeClose: function() {
						$.ptColor._isColorChangedAndUpdate && ($.dmx.site.paletteID = -1, $.ptColor._isColorChangedAndUpdate = !1, _handleColorPalettesScreen())
					}
				})
			});
			$("#ptEditorArea").unbind("click.changecolor").on("click.changecolor", ".paletteColorWrapper",
			function() {
				function a(e) {
					e && _handleColorPalettesScreen(!0);
					$.dmfw.showLoadingInEmulator();
					$.dmx.site.paletteID = parseInt(d.attr("dmPaletteID"));
					$.dmfw.changePalette(d.attr("dmPaletteID"),
					function() {
						$.dmfw.hideLoadingInEmulator()
					});
					jQuery.each(allPalletesElements,
					function(a, d) {
						$(d).removeClass("selected")
					});
					d.parent().addClass("selected")
				}
				var d = $(this);
				allPalletesElements[0].hasClass("customPalette") ? ($("#placeholderForPopupTheme").neeConfirmationPopUpDiv(dmStr["ui.nee.layouts.27"], {
					initCallback: function() {
						a(!0)
					},
					forceWidth: "310px"
				}), $("#placeholderForPopupTheme").click()) : a(!1)
			});
			$.ptColor._handleBackgroundImageChange();
			$("#ptOpenButtonStyle").unbind("click").click(function() {
				var a = new NEEGlobalTextPT;
				$.dmfw.openGlobalEditor({
					editable: a,
					tabToOpen: 2
				})
			});
			$("#ptOpenColorHeader").unbind("click").click(function() {
				var a = new NEEGlobalTextPT;
				$.dmfw.openGlobalEditor({
					editable: a,
					tabToOpen: 1
				})
			});
			$("#ptOpenColorText").unbind("click").click(function() {
				var a = new NEEGlobalTextPT;
				$.dmfw.openGlobalEditor({
					editable: a
				})
			})
		},
		_handleBackgroundImageChange: function() {
			function a(a, e) {
				var j = "url(" + encodeURI(a) + ")";
				updateInChangePage(e ? ["*#dm .dm-bfs.dm-layout-sec DIV.dmInner"] : ["*#dm DIV.dmInner"], "background-image", j, !0, !0, !0);
				if ($.dmx.site.isFromScratch && e) {
					var k, l = $.dmfw.getPreviewElement("#dm .dm-bfs.dm-layout-home");
					l.removeClass("dm-layout-home").addClass("dm-layout-sec");
					k = l.find("DIV.dmInner").css("background-image");
					l.removeClass("dm-layout-sec").addClass("dm-layout-home");
					j == k && ($("#ptEditorArea").find(".backgroundImageSelectBoxWrapper").addClass("imageDetected"), $("#ptEditorArea").find(".ptInnerBackColor .backgroundImageSelectBoxWrapper .DisplayBGselected").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", j), $("#ptEditorArea").find(".ptInnerBackColor .backgroundImageSelectBoxWrapper .BGimgSelectionWrapper .openPageBackgroundTextChange").text(dmStr["ui.change"]))
				}
			}
			function e(a, e) {
				updateInChangePage(e ? ["*#dm .dm-bfs.dm-layout-sec DIV.dmInner"] : ["*#dm DIV.dmInner"], "background-image", a, !0, !1, !0)
			}
			$(".ptGeneralBackColor").ptAddBackgroundImagePlaceholder({
				elem: $.dmx.site.isFromScratch ? $.dmfw.getPreviewElement("#dm .dm-bfs.dm-layout-home DIV.dmInner") : $.dmfw.getPreviewElement(".dmInner"),
				forceClassName: "*#dm DIV.dmInner",
				getPreviewImage: function() {
					var a, e = $.dmfw.getPreviewElement("#dm .dm-bfs.dm-layout-sec");
					e.removeClass("dm-layout-sec").addClass("dm-layout-home");
					a = e.find("DIV.dmInner").css("background-image");
					e.removeClass("dm-layout-home").addClass("dm-layout-sec");
					return a
				},
				callback: a,
				changeGlobally: !0,
				popupAdditionalClass: "ptBackgroundCustomize",
				isWithBackgroundPatterns: !0,
				callbackPatterns: e,
				isForceImage: !0,
				showMindTouchHelp: !0,
				mindTouchId: "dmMtCustomizeBackground"
			});
			$.dmx.site.isFromScratch && ($(".ptInnerBackColor").show(), $(".ptInnerBackColor").ptAddBackgroundImagePlaceholder({
				isInnerPages: !0,
				getPreviewImage: function() {
					var a, e = $.dmfw.getPreviewElement("#dm .dm-bfs.dm-layout-home");
					e.removeClass("dm-layout-home").addClass("dm-layout-sec");
					a = e.find("DIV.dmInner").css("background-image");
					e.removeClass("dm-layout-sec").addClass("dm-layout-home");
					return a
				},
				elem: $.dmfw.getPreviewElement("#dm .dm-bfs.dm-layout-sec DIV.dmInner"),
				forceClassName: "*#dm .dm-bfs.dm-layout-sec DIV.dmInner",
				callback: function(d) {
					a(d, !0)
				},
				changeGlobally: !0,
				popupAdditionalClass: "ptBackgroundCustomize",
				isWithBackgroundPatterns: !0,
				callbackPatterns: function(a) {
					e(a, !0)
				},
				isForceImage: !0
			}))
		},
		_isColorChangedAndUpdate: !1,
		siteTexturesToShow: [],
		siteImagesGalleryBfs: [],
		siteImagesFacebook: []
	}
});$.extend({
	ptHeader: {
		init: function() {
			var a = $.dmfw.getPreviewElement("DIV.dmHeader");
			0 < a.length && $.dmops.scrollPreviewToElement(a);
			NEEHeader.prototype.onTabReadyGeneralNew($(".EditorInnerBG"), !0);
			$(".EditorInnerTopPane").neePtSelectBox();
			$.ptHeader.handleHeaderColorChange()
		},
		getHeaderElem: function() {
			return $($.dmfw.getPreviewElement("DIV.dmHeader").get(0))
		},
		refreshAfterReload: function() {
			var a = $.dmfw.getPreviewElement("DIV.dmHeader");
			0 !== a.length ? ($.dmops.scrollPreviewToElement(a), setTimeout(function() {
				NEEHeader.prototype.onTabReadyGeneralNew($(".EditorInnerBG"), !0)
			},
			300)) : setTimeout(function() {
				$.ptHeader.refreshAfterReload()
			},
			300)
		},
		handleHeaderColorChange: function() {
			var a = $.ptHeader.getHeaderElem();
			$(".ptShowCurrentColorHeader").css("background-color", a.css("background-color"));
			$(".ptHeaderColorEditor .ptShowCurrentColorHeader").unbind("click.opencustom").bind("click.opencustom",
			function(e) {
				e.stopPropagation();
				0 >= $(this).find(".divToShowPalette").length && ($(".divToShowPalette").remove(), e = {},
				$.dmx.site.isBlog && (e.callback = function(d) {
					$(".DesignHeader .contWrapBackgrColor .ptShowCurrentColorHeader").css("background-color", d);
					$.dmops.updateCurrentCss({
						classesToRemove: null,
						attrToRemove: null,
						attrToAdd: [{
							attr: "background-color",
							value: d
						}],
						classesToAdd: null
					},
					{
						element: a
					})
				}), NEESiteColors.prototype.openColorPaletteChange($(this), e))
			});
			$(".ptHeaderColorEditor").ptAddBackgroundImagePlaceholder({
				elem: a,
				element: a,
				elementToChange: a,
				callback: $(this).neeChangeImage,
				popupAdditionalClass: "ptBackgroundCustomize",
				showMindTouchHelp: !0,
				mindTouchId: "dmMtHeaderBackgroundImage"
			})
		},
		handleHeaderTextControls: function() {
			function a(a, d) {
				$.dmops.updateCurrentCss({
					classesToRemove: null,
					attrToRemove: null,
					attrToAdd: [{
						attr: a,
						value: d
					}],
					classesToAdd: null
				},
				{
					selector: "#dm-title",
					element: e
				})
			}
			var e = $.ptHeader.getHeaderElem();
			$(".ptHeaderTextButtonsEditWrapper").neeSecondaryTextStyleTab({
				selector: "#dm-title",
				elem: e,
				sendElementNotSelector: !0,
				element: e.find(".dm-title")
			});
			$("#ptHedearColor").unbind("click").click(function(d) {
				d.stopPropagation();
				0 >= $(this).find(".divToShowPalette").length && ($(".divToShowPalette").remove(), NEESiteColors.prototype.openColorPaletteChange($(this), {
					callback: function(d) {
						a("color", d)
					}
				}))
			});
			$("#ptFontSize").val(e.find("#dm-title").css("font-size"));
			$("#ptFontSize").change(function() {
				_size = $(this).find(":selected").val();
				a("font-size", _size)
			});
			var d = e.find("#dm-title").css("font-family");
			d && (d = d.split(" ")[0], -1 != d.indexOf("'") && (d = d.substr(1, d.length - 2)), -1 != d.indexOf(",") && (d = d.replace(/,/g, "")));
			$("#ptHeaderFontFamily").fontSelector({
				callback: function(d) {
					a("font-family", "'" + d + "'")
				},
				elemToDisplay: $("#ptHeaderFontFamily").find("#fontToShow")
			});
			$("#ptHeaderFontFamily #fontToShow").text(d)
		}
	}
});$.extend({
	ptLayout: {
		init: function() {
			function a(a, d) {
				switch (a) {
				case 1:
					_setVariationLayout($(".secExpendStyle"), d);
					break;
				case 2:
					_setVariationLayout($(".secTopStyle"), d);
					break;
				case 3:
					_setVariationLayout($(".secBottomStyle"), d);
					break;
				case 4:
					_setVariationLayout($(".secMatrixStyle"), d);
					break;
				case 5:
					_setVariationLayout($(".secListStyle"), d);
					break;
				default:
					_setVariationLayout($(".secExpendStyle"), d)
				}
			}
			var e = !$.dmx.site.isUsingLayout;
			$(".navTypeItem").unbind("click").click(function(d) {
				function j(d) {
					$("#RestoreLayouts").removeClass("oldThemeChosen");
					$.dmx.site.isUsingLayout = !0;
					num = d.data("laynum");
					$.dmfw.showLoadingInEmulator();
					$.dmfw.changeLayout(num,
					function() {
						$.dmfw.changeVariation(1);
						$.dmfw.hideLoadingInEmulator()
					});
					e && ($("#showExcractingPalttesMsg").hide(), $(".EditorInnerBottomPane").css("visibility", "visible"));
					a(num, !0)
				}
				d.stopPropagation();
				var k = $(this);
				"restore" == $(this).data("laynum") ? ($("#RestoreLayouts").addClass("oldThemeChosen"), $.dmx.site.isUsingLayout = !1, $.dmfw.restoreFromLayoutToTheme(), $(".EditorInnerBottomPane").css("visibility", "hidden"), $("#showExcractingPalttesMsg").hide()) : $.dmx.site.isUsingLayout ? j(k) : ($("#showExcractingPalttesMsg").show(), $.dmfw.calcPalettes(function() {
					j(k)
				}));
				$(".navTypeItem").removeClass("active").addClass("notselected");
				$(this).removeClass("notselected").addClass("active")
			});
			$(".navTypeItemCustom").unbind("click").click(function(a) {
				a.stopPropagation();
				a = new NEEVariations;
				$.dmfw.openGlobalEditor({
					editable: a
				})
			});
			$(".buildNavBtn").click(function() {
				var a = $.navigationUtil.selectCorrectNavigationElementInPreview();
				0 != a.length && $.dmops.scrollPreviewToElement(a);
				$.dmfw.selectAndOpenEditor(a)
			});
			var d = $.dmx.site.layoutID;
			_setVariationLayout = function(a, d) {
				$(".secVariationStyles").hide();
				a.fadeIn("fast");
				d && ($(".navTypeItemVar").removeClass("varselected"), $('.navTypeItemVar[varnum\x3d"1"]').addClass("varselected"))
			};
			a(d, !1);
			$(".navTypeItemVar").unbind("click").click(function(a) {
				$(a.target).is(".navVarTypeItemCustom") || ($(".navTypeItemVar").removeClass("varselected"), $(this).addClass("varselected"), a = $(this).attr("varnum"), $.dmfw.changeVariation(a, !0))
			});
			e || $('.navTypeItemVar[varnum\x3d"' + ($.dmx.site.styleID || 1) + '"]').addClass("varselected");
			$("#ptEditorArea").unbind("click.changenav").on("click.changenav", ".navVarTypeItemCustom",
			function() {
				var a = $.navigationUtil.selectCorrectNavigationElementInPreview();
				0 != a.length && $.dmops.scrollPreviewToElement(a);
				$.dmfw.selectAndOpenEditor(a)
			}); ! $.dmx.site.isBlog && $.dmx.site.isBlogCompatible && ($(".blogTemplatesMsg").show(), $("#templateBlogShowBlog").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
				initCallback: function() {
					$.ptfw.recreateSite($.dmx.site.alias, "false");
					$.dmx.site.isBlog = !0
				}
			}));
			$(".blogTemplateHelpButton").unbind("hover").hover(function() {
				$(".blogTemplatePopMessagePanelPT").toggle()
			})
		}
	}
});$.extend({
	ptBlogLayout: {
		init: function() {
			$("#ptOpenBlogPost").unbind("click").click(function() {
				var a = $.dmfw.getPreviewElement(".dmBlogInnerPostPage");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI(null, !0), $.dmfw.previewNavigateTo({
					url: $.dmx.rt.blogFirststPostHref,
					onLoad: function() {
						$("#ptOpenBlogPost").trigger("click")
					}
				}))
			});
			$("#ptOpenBlogHome").unbind("click").click(function() {
				var a = $.dmfw.getPreviewElement(".dmRssContainer");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI(null, !0), a = $.dmfw.getPreviewElement("a#dm-logo-anchor").attr("href"), $.dmfw.previewNavigateTo({
					url: a,
					onLoad: function() {
						$("#ptOpenBlogHome").trigger("click")
					}
				}))
			});
			$("#ptOpenBlogComments").unbind("click").click(function() {
				var a = $.dmfw.getPreviewElement(".commentsWrapper");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmfw.selectAndOpenEditor(a), $.dmUnblockUI()) : ($.dmBlockUI(null, !0), $.dmfw.previewNavigateTo({
					url: $.dmx.rt.blogFirststPostHref,
					onLoad: function() {
						$("#ptOpenBlogComments").trigger("click")
					}
				}))
			});
			$("#templateBlogShowRegular").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
				initCallback: function() {
					$.ptfw.recreateSite($.dmx.site.alias, "true");
					$.dmx.site.isBlog = !1
				}
			});
			$.dmx._showBlogBubbleFirstTime && ($(".blogTemplatePopMessagePanelPT").fadeIn(), setTimeout(function() {
				$(".blogTemplatePopMessagePanelPT").fadeOut(5E3)
			}), $.dmx._showBlogBubbleFirstTime = !1);
			$(".blogTemplateHelpButton").unbind("hover").hover(function() {
				$(".blogTemplatePopMessagePanelPT").toggle()
			});
			$.dmGet({
				url: "/sites/" + $.dmx.site.id + "/getthemetemplate",
				success: function(a) {
					$(".templatesImagesPanel").empty().neePagingWidget($.ptBlogLayout._buildThemesHolders(a), themeIndex, "numbers", 2);
					$.dmUnblockUI()
				}
			})
		},
		_buildThemesHolders: function(a) {
			for (var e = [], d = 0; d < a.length; d++) {
				var g = $('\x3cdiv class\x3d"templateImgWrapper"\x3e\x3c/div\x3e').attr("text", "no").attr("themeName", a[d].name).attr("themeIndex", d),
				j = $('\x3cimg class\x3d"templateImg"\x3e\x3c/img\x3e');
				j.attr("src", a[d].thumbnail_image);
				0 == d && g.attr("id", "firstThemeNoPop");
				g.append(j);
				var j = $("\x3cdiv\x3e\x3c/div\x3e").css("display", "none").appendTo(g).attr("class", "imgPlaceholderDisplayTheme"),
				k = $("\x3cdiv\x3e\x3c/div\x3e").attr("text", "no").appendTo(j).attr("class", "divInDisplayTheme"),
				l = $('\x3cimg style\x3d"margin-left: 15px; margin-top: 40px;"\x3e\x3c/img\x3e').css("align", "middle").css("display", "none");
				l.attr("src", a[d].small_image).css("display", "none");
				k.append(l);
				j = $("\x3cspan\x3e" + dmStr["ui.nee.themePanel.104"] + "\x3c/span\x3e").appendTo(j).attr("class", "imgPlaceholderSelectTemplate blueBtn");
				e.push(g);
				$.dmx.site.baseThemeName == a[d].name && (themeIndex = d, g.attr("text", "yes"), g.addClass("selectedTemplate"));
				$("#placeholderForPopupTheme").neeConfirmationPopUpDiv("\x3cb\x3e" + dmStr["ui.nee.themePanel.101"] + ".\x3c/b\x3e \t" + dmStr["ui.nee.themePanel.102"], {
					initCallback: function() {
						n()
					}
				});
				j.click(function(a) {
					a.stopPropagation();
					m($(this).parent().parent())
				});
				var m = function(a) {
					$.dmUIBlockControlled({
						region: "theme.confirmation",
						op: "block",
						style: "wheel"
					});
					toChangeTheme = a;
					$.dmGet({
						url: "/sites/" + $.dmx.site.id + "/issitethememodified",
						success: function(a) {
							$.dmUIBlockControlled({
								region: "theme.confirmation",
								op: "unblock"
							}); ! 0 == a ? $("#placeholderForPopupTheme").trigger("click") : n()
						}
					})
				},
				n = function(a) {
					a || (a = toChangeTheme);
					$.dmx.site.baseThemeName = a.attr("themeName");
					$(".templateImgWrapper").removeClass("selectedTemplate");
					$.each(e,
					function(a, d) {
						$(d).removeClass("selectedTemplate")
					});
					a.addClass("selectedTemplate");
					$.dmBlockUI(null, !0);
					$.dmPost({
						url: "/sites/" + $.dmx.site.id + "/" + $.dmx.page.id + "/assignThemeToSite/" + a.attr("themeName"),
						success: function(a) {
							$.navigationUtil.clearNavShape($($.dmfw.getPreviewElement("*.navPlaceHolder UL.dmNav")));
							$.deselectAllEditableElements();
							window.showLoadingDotsNEW && window.showLoadingDotsNEW();
							$.dmfw.refreshPreview();
							window.refreshGlobalCssAndShowLoadingNEW && window.refreshGlobalCssAndShowLoadingNEW(a.value, 3E3);
							$.dmBlockUI(null, !0);
							setTimeout("neeHistoryManager.clearAndUpdateHistory();", 3200);
							wrTrackEvent(WR_SITE_CHANGE_THEME, {
								theme: $.dmx.site.baseThemeName
							})
						}
					})
				};
				$(g).unbind("click").click(function() {
					m($(this))
				})
			}
			$(".smallColorCube").unbind("click").click(function(a) {
				a.stopPropagation();
				$(".smallColorCube").removeClass("smallFilterColorCubeSelected");
				$(this).addClass("smallFilterColorCubeSelected");
				$("#filterAnyColor").removeClass("filterAnyColorSelected");
				a = $(this).attr("color_name");
				_filterTemplatesByColor(a)
			});
			$("#filterAnyColor").unbind("click").click(function(a) {
				a.stopPropagation();
				$(".smallColorCube").removeClass("smallFilterColorCubeSelected");
				$(this).addClass("filterAnyColorSelected");
				initTemplatesPanel()
			});
			return e
		}
	}
}); (function(a) {
	a.fn.ptAddBackgroundImagePlaceholder = function(e) {
		function d(d) {
			if (d) {
				var o = m.find(".popupGeneralWrapper").clone();
				0 == o.length && (o = m.closest("#ptEditorInnerArea").find(".popupGeneralWrapper").clone());
				o.find(".PopupInnerWrapper").empty();
				e.isInnerPages ? m.find(".openPageBackgroundIdInner").neePopUpDiv(o, a.extend({
					init: k,
					toChangeFunction: l,
					showIphone: !0
				},
				e)) : m.find(".openPageBackgroundId").neePopUpDiv(o, a.extend({
					init: k,
					toChangeFunction: l,
					showIphone: !0
				},
				e))
			}
			o = n.css("background-image"); ! o && e.getPreviewImage && (o = e.getPreviewImage());
			if (o && (0 < n.length || e.isForceImage) && "" !== o && "url(http://localhost:8080/non)" != o && "none" != o && -1 != o.indexOf("url(") && -1 == o.indexOf("svg+")) if (o = n.css("background-image"), !o && e.getPreviewImage && (o = e.getPreviewImage()), o.startsWith("url")) {
				var r = o.indexOf("url(") + 4,
				u = o.indexOf(")"),
				o = o.substring(r, u);
				o.startsWith('"') && (o = o.substring(1, o.length - 1));
				g(o)
			} else g(o, !0);
			else j();
			d && (m.find(".BGimgRemoveBtn").unbind("click").click(function() {
				j();
				var d = {
					classesToRemove: null,
					attrToRemove: null,
					attrToAdd: [{
						attr: "background-image",
						value: "none"
					}],
					classesToAdd: null
				},
				g = e;
				if (g.changeGlobally) {
					var k = g.forceClassName;
					k && (g.isWithBackgroundPatterns && (d.outsideTheme = !0), g.updateInChangePage ? updateInChangePage(k, d.attrToAdd[0].attr, d.attrToAdd[0].value, !0) : a.dmops.updateGlobalCssAndElement(d, {
						className: k,
						clientOnly: !1
					}))
				} else a.dmops.updateCurrentCss(d, g);
				e.callbackremove && e.callbackremove()
			}), 0 < m.find(".BGimgRestoreBtn").length && m.find(".BGimgRestoreBtn").unbind("click").click(function() {
				m.find(".DisplayBGselected").css("background-image", a(".ptGeneralBackColor .DisplayBGselected").css("background-image"));
				var d = {
					url: "/sites/removecssrulecontaining/" + a.dmx.currentPage(),
					data: {
						value: "*#dm *.dm-bfs.dm-layout-sec DIV.dmInner"
					},
					success: function() {}
				};
				a.dmPostWithHistory(d)
			}))
		}
		function g(d, e) {
			var g = function(a) { ! 1 == a ? j() : (bg = e ? d: "url(" + d + ")", m.find(".backgroundImageSelectBoxWrapper").addClass("imageDetected"), m.find(".backgroundImageSelectBoxWrapper .DisplayBGselected").removeClass("noImageInBackground").addClass("imageDetected").css("background-image", bg), m.find(".backgroundImageSelectBoxWrapper .BGimgSelectionWrapper .openPageBackgroundTextChange").text(dmStr["ui.change"]), m.find(".BGimgRemoveBtn").show())
			};
			a("\x3cimg\x3e", {
				src: d,
				load: function() {
					g(!0)
				},
				error: function() {
					g(!1)
				}
			})
		}
		function j() {
			m.find(".BGimgRemoveBtn").hide();
			m.find(".backgroundImageSelectBoxWrapper").removeClass("imageDetected");
			m.find(".backgroundImageSelectBoxWrapper .DisplayBGselected").removeClass("imageDetected").addClass("noImageInBackground");
			m.find(".backgroundImageSelectBoxWrapper .BGimgSelectionWrapper .openPageBackgroundTextChange").text(dmStr["ui.choose"])
		}
		function k(e, g) {
			e.neeSecondaryIconTabs(a.extend({
				tabs: {
					bgimage: [{
						uploadBiggerButton: !0
					}],
					upload: [{
						isChange: !1
					}],
					original_images: [],
					url: []
				},
				callback: l,
				forceClassName: g.forceClassName,
				changeGlobally: g.changeGlobally,
				selector: g.selector,
				element: g.elem ? g.elem: g.element,
				elementToChange: g.elem,
				uploadBiggerButton: !0,
				isImagePickerPopup: !0,
				isBgCustomize: g.isBgCustomize,
				updateInChangePage: g.updateInChangePage || null,
				uponRemoveImage: function() {
					d(!1)
				}
			},
			g.isWithBackgroundPatterns ? {
				tabs: {
					bg_labs: [],
					bgimage: [{
						uploadBiggerButton: !0
					}],
					upload: [{
						isChange: !1
					}],
					original_images: [],
					url: []
				}
			}: {}));
			e.find("#imgCustomDonePt").unbind("click").click(function() {
				e.parent().find(".closeThis").click()
			})
		}
		function l(d) {
			g(d);
			if (e.callback) {
				var j = a.extend({},
				e);
				j.callback = null;
				e.callback(d, !1, j, j)
			}
			e.isWithBackgroundPatterns ? "": a(".popupWinExample").find('.rightPanelTab[identifier*\x3d"bgimageCustome"]').click()
		}
		var m = this,
		n = e.elem;
		e = e || {};
		if (0 == m.find(".backgroundImageSelectBoxWrapper").length) {
			m.empty();
			var o = a("\x3cdiv\x3e\x3c/div\x3e").appendTo(m),
			r = a("\x3cdiv\x3e\x3c/div\x3e");
			r.appendTo(o).addClass("backgroundImageSelectBoxWrapper");
			var u = a("\x3cdiv\x3e\x3c/div\x3e");
			u.appendTo(r).addClass("BGimgSelectionWrapper");
			a("\x3cdiv\x3e\x3c/div\x3e").addClass("DisplayBGselected noImageInBackground openPageBackgroundId").appendTo(u);
			r = a("\x3cdiv\x3e\x3c/div\x3e");
			r.appendTo(u).addClass("BGimgDescrWrapper");
			a("\x3ch3\x3e\x3c/h3\x3e").html(dmStr["ui.nee.common.design.4"]).appendTo(r);
			a("\x3cspan\x3e\x3c/span\x3e").html(dmStr["ui.pt.design.header.35"]).attr("id", "noImageInBackgroundText").appendTo(r);
			a("\x3cdiv class\x3d'GreyBtn BGimgRemoveBtn'\x3e\x3cspan\x3e" + dmStr["ui.remove"] + "\x3c/span\x3e\x3c/div\x3e").appendTo(u);
			a("\x3cdiv class\x3d'GreyBtn BGimgSelectBtn'\x3e \x3cspan class\x3d'openPageBackgroundId openPageBackgroundTextChange'\x3e" + dmStr["ui.choose"] + "\x3c/span\x3e\x3c/div\x3e").appendTo(u);
			u = a("\x3cdiv\x3e\x3ch2\x3e" + dmStr["ui.pt.design.header.1"] + "\x3c/h2\x3e\x3cdiv id\x3d'imgCustomDonePt' class\x3d'updateButton blueBtn ptOrangeBtn'\x3e" + dmStr["ui.done"] + "\x3c/div\x3e\x3c/div\x3e");
			u.appendTo(o).addClass("ptBackgroundCustomize popupGeneralWrapper displayNone").attr("id", "popupCustomizeImg");
			a("\x3cdiv\x3e\x3c/div\x3e").addClass("PopupInnerWrapper slideRightPanelInner").appendTo(u)
		}
		d(!0)
	};
	a.fn.neeSecondaryEffectsTabPT = function(e) {
		var d = this.find(".slideRightPanelInner");
		d.empty();
		for (var g = 0; g < e.length; g++) {
			var j = e[g],
			k = a("\x3cdiv class\x3d'ptColorListItem ptColorListWrapper ptSmallMarginList'\x3e\x3c/div\x3e").appendTo(d);
			a("\x3cdiv class\x3d'ptColorListItemPrev'\x3e\x3c/div\x3e").appendTo(k);
			j.isOnOff && a("\x3cdiv id\x3d'roundCustWrapper' class\x3d'wrapper'\x3e\x3cdiv id\x3d'NEEonOffBtn'\x3e\x3clabel id\x3d'imageSliderEffectIsSlide'\x3e" + j.name + "\x3c/label\x3e \x3cspan class\x3d'neeOnButton'\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e").appendTo(k);
			j.onReady(k)
		}
	};
	a.fn.neeSecondaryColorTabPT = function(e, d) {
		var g;
		this.hasClass("slideRightPanelInner") ? g = this: g = this.find(".slideRightPanelInner").filter(function(d, e) {
			return ! a(e).parent().is(".openImagePickerPopUpWrapper")
		});
		var j = d || {},
		k = j.previewElementToWorkOn || a.dmx.current.element,
		l = g,
		m = !0;
		g.empty();
		for (var n = 0; n < e.length; n++) if (e[n].id.startsWith("group_start")) l = a("\x3cdiv class\x3d'colorListGroup'\x3e\x3c/div\x3e").appendTo(g),
		l.append("\x3cdiv class\x3d'colorGroupTitle'\x3e" + e[n].name + "\x3c/div\x3e"),
		m ? l.addClass("odd") : l.addClass("even"),
		m = !m;
		else if ("group_end" === e[n].id) l = g;
		else {
			var o = a("\x3cdiv class\x3d'ptColorListItem ptColorListWrapper'\x3e\x3c/div\x3e").appendTo(l),
			r = a("\x3cdiv class\x3d'ptColorListItemPrev'\x3e\x3c/div\x3e").appendTo(o);
			if (!e[n].showOnlyAdditional) {
				var u = a("\x3cdiv class\x3d'DisplayBGselected'\x3e\x3c/div\x3e").attr("currNum", n).appendTo(r);
				a("\x3ch3\x3e\x3c/h3\x3e").text(e[n].name).appendTo(r)
			}
			"background" == e[n].id || "background_widgets" == e[n].id || "layout_background" == e[n].id || "layout_active_background" == e[n].id || "layout_exp_button_bg" == e[n].id || "layout_exp_background" == e[n].id || "exp_button_bg" == e[n].id || "background" === e[n].extensionOf ? a("\x3cdiv class\x3d'additionalPlaceColor'\x3e\x3cdiv id\x3d'popupCustomizeImg' class\x3d'popupGeneralWrapper displayNone'\x3e\x3cdiv class\x3d'PopupInnerWrapper slideRightPanelInner'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e").attr("id", "additionalWidgetPlaceholder").append(a("\x3cdiv style\x3d'clear:both;'\x3e\x3c/div\x3e")).appendTo(o) : a("\x3cdiv class\x3d'additionalPlaceColor'\x3e\x3c/div\x3e").attr("id", "additPlaceHold" + n).append(a("\x3cdiv style\x3d'clear:both;'\x3e\x3c/div\x3e")).appendTo(o);
			r = k;
			d.specForceClassName && d.specForceClassName[e[n].id] && (r = a.dmfw.getPreviewElement(d.specForceClassName[e[n].id]), d.specColorSamplerFilter && d.specColorSamplerFilter[e[n].id] && (r = r.filter(d.specColorSamplerFilter[e[n].id])), 1 < r.length && (r = a(r[0])));
			if (e[n].paletteKey) currColorToSend = a.dmx.currentPalette[e[n].paletteKey];
			else {
				currColorToSend = r.css(e[n].attr);
				if (e[n].selector) currColorToSend = r.find(e[n].selector).css(e[n].attr);
				else if (e[n].attrSpecificToGetColor && (currColorToSend = r.css(e[n].attrSpecificToGetColor)), e[n].colorSelector || e[n].forceClassName)(r = e[n].colorSelector || e[n].forceClassName) && -1 != r.constructor.toString().indexOf("Array") && (r = r[0]),
				currColorToSend = a(a.dmfw.getPreviewElement(r).get(0)).css(e[n].attr);
				currColorToSend = currColorToSend || e[n].colorDefaults || "#FFFFFF"
			}
			e[n].showOnlyAdditional || u.css("background-color", currColorToSend);
			e[n].additionalWidget && (a(".slideRightPanelInner #additPlaceHold" + n).append(e[n].additionalWidget), e[n].additionalWidgetInit && e[n].additionalWidgetInit(!0, o));
			var s = function(d, g, k) {
				isNumber(k) && (e[k].callback ? e[k].changePreview && e[k].changePreview(d, g) : (d = {
					classesToRemove: null,
					attrToRemove: [e[k].attrToRemove],
					classesToAdd: null,
					attrToAdd: [{
						attr: e[k].attr,
						value: d
					}]
				},
				e[k].necessaryAttr && d.attrToAdd.unshift(e[k].necessaryAttr), j.changeGlobally ? a.dmops.updateGlobalCssAndElement(d, {
					className: e[k].forceClassName,
					clientOnly: !0
				}) : e[k].selector ? a.dmops.updateCurrentCss(d, {
					selector: e[k].selector,
					tagName: e[k].tagName,
					clientOnly: !0
				}) : a.dmops.updateCurrentCss(d, {
					clientOnly: !0
				})))
			},
			B = function(d, g) {
				if (e[g].paletteKey) a.dmops.changePaletteColor(e[g].paletteKey, d);
				else if (e[g].callback) e[g].callback(d);
				else {
					var l = {
						classesToRemove: ["dmDefaultGradient"],
						attrToRemove: e[g].attrToRemove ? [e[g].attrToRemove] : null,
						classesToAdd: null,
						attrToAdd: [{
							attr: e[g].attr,
							value: d
						}]
					};
					e[g].necessaryAttr && l.attrToAdd.unshift(e[g].necessaryAttr);
					if (j.changeGlobally) {
						var m = e[g].forceClassName;
						m && (j.updateInChangePage ? updateInChangePage(m, e[g].attr, d) : a.dmops.updateGlobalCssAndElement(l, {
							className: m,
							clientOnly: !1
						}))
					} else e[g].selector ? a.dmops.updateCurrentCss(l, {
						selector: e[g].selector,
						tagName: e[g].tagName
					}) : a.dmops.updateCurrentCss(l, a.extend({},
					j, {
						element: k,
						selector: e[g].forceClassName
					}));
					e[g].additionalWidgetInit && e[g].additionalWidgetInit(!1)
				}
			};
			this.find(".DisplayBGselected:not('.openPageBackgroundId')").unbind("click.opencustom").bind("click.opencustom",
			function(d) {
				d.stopPropagation();
				if (0 >= a(this).find(".divToShowPalette").length) {
					a(".divToShowPalette").remove();
					d = {};
					var g = !1;
					try {
						g = e[a(this).attr("currnum")].hideOpacity
					} catch(j) {}
					d.hideOpacity = g;
					a(this)._openColorPaletteChange(B, s, d)
				}
			})
		}
	};
	a.fn._openColorPaletteChange = function(e, d, g) {
		g = g || {};
		var j = this,
		k = a("\x3cdiv id\x3d'divToShowPalette'\x3e\x3c/div\x3e");
		g = g || {};
		k.hide();
		k.appendTo(j).addClass("divToShowPalette");
		var l = a.dmfw.isDudaone() ? "/editor/dudaone/editableObjects/siteColors/one.siteColorsPopUp.jsp": "/editor/nee/editableObjects/siteColors/nee.siteColorsPopUp.jsp";
		a.dmLoad(k, l,
		function() {
			function l(d, j, m) {
				d = g.elemToColor || m;
				currNum = m = Number(d.attr("currnum"));
				var n = j;
				"rgba(0, 0, 0, 0)" != n && k.find("#transInput").val() && (n = a.hexToRgba(n, k.find("#transInput").val()));
				d.css("background-color", n).attr("title", a.rgb2hex(j));
				e(n, m)
			}
			function n(d) {
				var e = a(u[neeRecentColorsbyUserIndex]);
				e.css("background", d).removeClass("notFilled");
				e.attr("title", a.rgb2hex(d));
				e.unbind("click").click(function(d) {
					d.stopPropagation();
					d = a(this).css("background-color");
					l(j.attr("dmVal"), d, j)
				});
				neeRecentColorsbyUserIndex++
			}
			function o() {
				var d = j.css("background-color");
				"rgba(0, 0, 0, 0)" != d && k.find("#transInput").val() && (d = a.hexToRgba(d, k.find("#transInput").val()));
				l(j.attr("dmVal"), d, j)
			}
			a.dmx.site.isBlog && k.find("span.ColorPalleteText:first").text("Colors");
			k.show();
			var r = a.dmx.site.colors,
			u = j.find(".colorCubeRecent"),
			s = a.dmfw.isDudaone() ? 8 : 11,
			B = 30 < r.length ? 30 : r.length; - 1 == a.dmx.site.colors.indexOf("transparent") && (a.dmx.site.colors.push("transparent"), B++);
			for (var z = j.find("#holdSiteColors"), v = 0; v < B; v++) if ("undefined" != r[v]) {
				var D = a('\x3cdiv class\x3d"colorCube" unselectable\x3d"on" container\x3d"holdSiteColors"\x3e\x3c/div\x3e').attr("id", "serverColorNum" + v),
				E = r[v];
				D.css("background-color", E);
				D.attr("title", a.rgb2hex(E));
				z.append(D); ("transparent" == r[v] || "rgba(0,0,0,0)" == r[v]) && D.addClass("transparentSiteColor").attr("title", "transparent");
				D.click(function(d) {
					d.stopPropagation();
					d = a(this).css("background-color"); - 1 == jQuery.inArray(a.rgb2hex(d), neeRecentColorsbyUser) && (neeRecentColorsbyUserIndex >= s && (neeRecentColorsbyUserIndex = 0), neeRecentColorsbyUser[neeRecentColorsbyUserIndex] = a.rgb2hex(d), n(a.rgb2hex(d)));
					l(j.attr("dmVal"), d, j)
				})
			}
			length = neeRecentColorsbyUser.length;
			for (v = 0; v < length; v++) r = a(u[v]),
			E = neeRecentColorsbyUser[v],
			r.css("background", E).removeClass("notFilled"),
			r.attr("title", a.rgb2hex(E)),
			r.click(function(d) {
				d.stopPropagation();
				d = a(this).css("background-color");
				l(j.attr("dmVal"), d, j)
			});
			j.find(document.body).on("click", ".colorCubeRecent",
			function(d) {
				d.stopPropagation();
				a(this).hasClass("notFilled") || (d = a(this).css("background-color"), l(j.attr("dmVal"), d, j))
			});
			g.hideOpacity ? k.find(".colorTransp").hide() : (k.find(".colorTransp").show(), k.find(".colorTransp").dmColorOpacity({
				callback: o,
				setColor: j.css("background-color")
			}));
			var F = 0;
			j.find(".triggerOpenColorPicker").unbind("click").click(function(g) {
				g.stopPropagation();
				var l = a(g.currentTarget).closest(".DisplayBGselected");
				0 === l.length && (l = j);
				g = Number(l.attr("currnum"));
				F = isNumber(g) ? g: 0;
				a("#placementForColorPickerColor").neeOpenColorPicker(j.css("background-color"),
				function(d) { - 1 != navigator.appVersion.indexOf("MSIE") ? this.event.cancelBubble = !0 : (this.event && this.event.preventDefault(), this.event && this.event.stopPropagation()); - 1 == jQuery.inArray(a.rgb2hex(d), neeRecentColorsbyUser) && (neeRecentColorsbyUserIndex >= s && (neeRecentColorsbyUserIndex = 0), neeRecentColorsbyUser[neeRecentColorsbyUserIndex] = a.rgb2hex(d), n(a.rgb2hex(d)));
					var g = d;
					"rgba(0, 0, 0, 0)" != g && k.find("#transInput").val() && (g = a.hexToRgba(g, k.find("#transInput").val()));
					l.css("background-color", g).attr("title", a.rgb2hex(d));
					k.remove();
					e(g, F);
					return ! 1
				},
				d ?
				function(a, e) {
					d(a, e, F)
				}: null)
			});
			k.find(".closeColorPicker").click(function(a) {
				a.stopPropagation();
				k.remove()
			});
			k.unbind("clickoutside").bind("clickoutside",
			function() {
				k.remove()
			});
			a.dmfw.isDudaone() && (k.appendTo(j.closest("#_p_editor")), v = k.find(".changeColorPopup"), r = j, B = a("#_p_editor"), 0 < B.length && (E = r.offset().top - B.offset().top + 34, r = r.offset().left - B.offset().left, v.css({
				top: E + "px",
				left: r + "px"
			})))
		})
	};
	a.fn.neePtSelectBox = function() { (a(this).is(".ptSelectBox") ? a(this) : a(this).find(".ptSelectBox")).each(function() {
			var e = a(this).children(".ptSelectOptions"),
			d = a(this);
			d.children(".ptSelected").html(0 < e.children(".ptSelectOption.toSelect").length ? e.children(".ptSelectOption.toSelect").html() : e.children(".ptSelectOption:first").html());
			d.attr("value", e.children(".ptSelectOption:first").attr("value"));
			d.children(".ptSelected,.ptSelectArrow").unbind("click").click(function() {
				a(this).parent().children(".ptSelectOptions").slideToggle(200,
				function() {
					d.unbind("clickoutside").bind("clickoutside",
					function() {
						d.find(".ptSelectOptions").slideUp(200);
						d.unbind("clickoutside")
					})
				})
			});
			d.find(".ptSelectOption").unbind("click").click(function() {
				a(this).parent().css("display", "none");
				a(this).closest(".ptSelectBox").attr("value", a(this).attr("value"));
				a(this).parent().siblings(".ptSelected").html(a(this).html());
				a(this).data("onReady") && a(this).data("onReady")()
			})
		})
	};
	a.fn.neePtNewColorInnerScreen = function(e, d, g, j) {
		var k = this;
		this.hasClass("colorPickerWidget") ? k = k.find(".colorPalette") : k = this;
		k.empty();
		var k = a("\x3cdiv class\x3d'ptColorListItem ptColorListWrapper'\x3e\x3c/div\x3e").appendTo(k),
		k = a("\x3cdiv class\x3d'ptColorListItemPrev'\x3e\x3c/div\x3e").appendTo(k),
		l = a("\x3cdiv class\x3d'DisplayBGselected'\x3e\x3c/div\x3e").attr("currNum", 0).appendTo(k);
		a("\x3ch3\x3e\x3c/h3\x3e").text(d).appendTo(k);
		l.css("background-color", e);
		l.unbind("click.opencustom").bind("click.opencustom",
		function(d) {
			d.stopPropagation();
			0 >= a(this).find(".divToShowPalette").length && (a(".divToShowPalette").remove(), a(this)._openColorPaletteChange(g, j))
		})
	};
	a.fn.fontSelector = function(e) {
		e = e || {};
		var d = "Abril Fatface;Arial;Arial Black;Arial Narrow;Arvo;Book Antiqua;Comic Sans MS;Courier New;Droid Sans;Georgia;Helvetica;Impact;Josefin Slab;Lato;Lobster;Old Standard TT;Open Sans;Palatino Linotype;PT Sans;PT Serif;Sans-Serif;Tahoma;Times New Roman;Trebuchet MS;Verdana;Vollkorn;Ubuntu;Sansita One;Sanchez;Playfair Display;Source Sans Pro;Oxygen;Roboto".split(";");
		return this.each(function() {
			var g = a(this),
			j = [],
			k = a('\x3cul class\x3d"fontselector"\x3e\x3c/ul\x3e');
			g.append(k);
			a(k).hide();
			a.each(d,
			function(a, d) {
				j.push('\x3cli  class\x3d"font_' + a + '" style\x3d"font-family: ' + d + '"\x3e' + d + "\x3c/li\x3e")
			});
			a(k).append(j.join(""));
			a(g).click(function(d) {
				d.preventDefault();
				"block" == a(k).css("display") ? a(k).hide() : a(k).show();
				a(this).blur();
				return ! 1
			});
			a(k).find("li").click(function() {
				var g = d[a(this).attr("class").split("_")[1]];
				e.elemToDisplay.text(g);
				a(k).hide();
				e.callback(g);
				return ! 1
			});
			a(k).unbind("clickoutside").bind("clickoutside",
			function() {
				a(k).hide()
			})
		})
	}
})(jQuery);$.extend({
	ptContent: {
		timer: null,
		init: function() {
			sortCategoryForIcons("Category", "featured");
			$(".filterItemNew").click(function(a) {
				a = $(a.currentTarget).attr("cat");
				sortCategoryForIcons("Category", a);
				$(".filterItemNew").removeClass("contentFilterSelected toggleModeOn");
				$(this).addClass("contentFilterSelected toggleModeOn")
			})
		}
	}
});$.extend({
	ptPages: {
		ptPagesOnNavReady: function(a, e) {
			e = e || {};
			$.ptPages.handlePageSettings();
			$("#EditPageIcon .GreySelect").unbind("click.changeIcon").bind("click.changeIcon",
			function(a) {
				a.stopPropagation();
				a = $(".EditIconWrapper");
				a.toggle();
				a.toggleClass("active");
				a.is(".active") && (!a.is(".initialized") && a.data("pageLink")) && a.initPagesIcons(a.data("pageLink"))
			}); ! e.dontExecuteCurrent && $.dmpages.executeSelectCurrent && $.dmpages.executeSelectCurrent(!0);
			$.dmx.events.bind("onPreviewReady.refreshPtPages",
			function() {
				$.ptPages.PreviewIsReady = !0;
				"" == $.dmx.rt.currentNavId && ($.ptPages.PreviewIsReady = !1, $("#deletePageBtn").data("shown") && $("#deletePageBtn").show());
				$.ptPages.arrivedFromClick && ($.ptPages.PreviewIsReady = !1, $("#deletePageBtn").data("shown") && $("#deletePageBtn").show());
				$.ptPages.arrivedFromClick || $.ptPages.selectNavLinkById($.dmx.rt.currentNavId, !0);
				$.ptPages.arrivedFromClick = !1
			},
			!0);
			$.dmx.site.isFromScratch && $(".ptMainTabInner [original_id\x3d'dm_navGroup00_item'] .navLinkButtonHidden:first").attr("title", "Hide In Inner Pages");
			a && a()
		},
		initPagesTabTips: function() {
			isShowTipsPages && "read" != $.getCookie("_dm_pt_tips_pages") && require(["neeUtils/nee.pt.tips"],
			function() {
				var a = {
					toList: "pages",
					title: dmStr["ui.help.message.12"],
					body: dmStr["ui.help.message.13"],
					relativeElement: $("#ptSideMenuGolive"),
					relativeDirection: "right"
				},
				a = new $.ptTips(a),
				a = {
					toList: "pages",
					title: dmStr["ui.help.message.10"],
					body: dmStr["ui.help.message.11"],
					relativeElement: $("#pagesEditSubMenuWrapper"),
					relativeDirection: "right",
					nextTip: a
				},
				a = new $.ptTips(a),
				a = {
					toList: "pages",
					title: dmStr["ui.help.message.8"],
					body: dmStr["ui.help.message.9"],
					relativeElement: $(".contentIconList"),
					relativeDirection: "top",
					nextTip: a
				},
				a = new $.ptTips(a);
				$.setCookie("_dm_pt_tips_pages", "read", 8064, "/", !1);
				a.init();
				$.ptTipsList.destroyList("design")
			})
		},
		init: function(a, e) {
			e = e || {};
			$.ptPages.handleAddNewPage();
			$.dmx.events.unbind("pageAdded").bind("pageAdded",
			function() {
				$.ptPages.refreshPagesPT({
					dontRefreshLayout: !0,
					forceNavRefresh: !0,
					skipNavTo: !0
				})
			});
			$.dmx.events.unbind("pageDeleted").bind("pageDeleted",
			function() {
				$.dmx.rt.currentNavId = null;
				$.ptPages.refreshPagesPT({
					dontRefreshLayout: !0,
					forceNavRefresh: !0,
					skipNavTo: !1
				})
			});
			$.dmpages.isCreateNewPageCalled = !1;
			$.dmpages.navPageLinksByPage = {};
			$.dmpages.navPageLinksById = {};
			$.ptPages.initNavigationItems(a, e);
			$(".editDiv").unbind("click.allowEdit").bind("click.allowEdit",
			function(a) {
				a.stopPropagation();
				$(".EditSubMenuWrapper").hasClass("showMover") ? ($(".EditSubMenuWrapper").find(".navLinkMover").animate({
					width: 0
				}), $(".EditSubMenuWrapper").removeClass("showMover"), $(this).removeClass("toggleModeOn")) : ($(".EditSubMenuWrapper").find(".navLinkMover").animate({
					width: 16
				}), $(".EditSubMenuWrapper").addClass("showMover"), $(this).addClass("toggleModeOn"))
			})
		},
		initNavigationItems: function(a, e) {
			e = e || {};
			$.dmpages.selectByPageID = !1;
			$("#pagesEditSubMenuWrapper").length || $.ptPages.ptPagesOnNavReady(a, e);
			$("#pagesEditSubMenuWrapper").navigationItems({
				inPagesEditor: !0,
				inPT: !0,
				addOtherPages: !0,
				addHome: !0,
				dontRefreshLayout: e.dontRefreshLayout,
				forceNavRefresh: e.forceNavRefresh,
				componentsClassNames: $.dmfw.editables("navigation").getSinglePageItemSubComponentsClassNames(),
				onNavReady: function() {
					$.ptPages.ptPagesOnNavReady(a, e)
				},
				listItemCallback: function(a) {
					var e = a.find(".navLinkBtnHiddenDiv"),
					j = $(a).data("dataItem"),
					k = $(a).data("remove"),
					l = $(a).data("hide"),
					m = $(a).data("changeTitle"),
					n = {
						pageLink: j,
						removeFn: k,
						hideFn: l,
						changeTitleFn: m,
						li: a
					};
					$(a.find(".navLinkTitle:first")).click(function(a) {
						a.preventDefault();
						$("#previewBackButtonWarper") && $("#previewBackButtonWarper").remove();
						if (!a || !$(a.srcElement).is(".navLinkArrow, .navLinkArrow *")) $.ptPages.arrivedFromClick = !0,
						$.ptPages.selectNavLink(!1, !1, n);
						a.stopPropagation()
					}); ! $.dmpages.curNavLink && !$.dmpages.selectByPageID && ($.dmx.rt.currentNavId ? $.dmpages.curNavLink = $.dmx.rt.currentNavId: ($.dmpages.selectByPageID = !0, $.dmpages.curNavLink = "bypageid"));
					$.dmpages.curNavLink == j.elementID ? $.dmpages.executeSelectCurrent = function(a, d) {
						$.ptPages.selectNavLink(a, d, n)
					}: $.dmpages.selectByPageID && $.dmx.page.id === j.pageID && ($.dmpages.executeSelectCurrent = function(a, d) {
						$.ptPages.selectNavLink(a, d, n)
					});
					$.dmpages.navPageLinksByPage[j.pageID] = j;
					$.dmpages.navPageLinksById[j.elementID] = j;
					a = j.elementID && "" != j.elementID ? $.dmfw.getPreviewElement("#" + j.elementID).find("a") : null;
					j.openInNewWindow = a ? "_blank" != a.attr("target") ? !1 : !0 : !1;
					$.dmfw.isPT() && $.ptToolTips.setToolTip(void 0, dmStr["ui.nee.tooltip.17"], e, e, void 0)
				},
				onNavAddFromOtherPages: function(a) {
					e = e || {};
					$.dmpages.curPage = null;
					$.dmpages.curNavLink = a.navId;
					$.dmpages.showCurTab = null;
					$.dmx.addPage(a);
					a.navItem && a.navItem.markup && (a = $("\x3cul\x3e\x3c/ul\x3e").append(a.navItem.markup), $($.dmfw.getPreviewElement("#hiddenNavPlaceHolder #dmNav:first")).append(a.html()));
					e.noNavigate ? (addPageElem.closest("#popupWinExampleMask").find(".closeThis").click(), wrTrackEvent(PT_NEW_PAGE, {
						pageType: templateName
					})) : ($.ptPages.arrivedFromClick = !0, $.ptPages.refreshPagesPT({
						onNavBuilt: function() {},
						skipNavTo: !1,
						forceNavRefresh: !0,
						onPreviewRefreshSuccess: function() {}
					}))
				}
			})
		},
		_navToPageLink: function(a, e) {
			var d = function() {
				setTimeout(function() {
					$.dmfw.setPreviewEditPolicy && $.dmfw.setPreviewEditPolicy(!0)
				},
				2E3)
			},
			g = a.itemUrl || "",
			j = a.pageAlias || "";
			$.isLinkHashed(g) && (g = g.replace("#", ""), j = "home");
			g = a.pageAlias && "original" != a.pageAlias ? {
				page: {
					alias: j,
					query: !a.pageFromScratch ? "url\x3d" + escape(g) : void 0
				}
			}: {
				url: g
			};
			j = d;
			e && (j = function() {
				d();
				e()
			});
			$.extend(g, {
				onContextUpdated: d,
				onLoad: j
			});
			$.dmfw.previewNavigateTo(g)
		},
		handlePageSettingsSelected: function(a, e, d, g) {
			$(".EditPageIconWrapper").toggleClass("displayNone", _navHasNoIcons() || $.navigationUtil.getVariationsColorRestrictions().icons);
			a.otherPage && $(".EditPageIconWrapper").addClass("displayNone");
			var j = $("#EditPageIcon .GreySelect .GreySelectText");
			$.dmops.removeFontIcon(j);
			$.isIconClass(a.linkDesign.itemIcon) ? j.css("background-image", "none").addClass(a.linkDesign.itemIcon) : $.changeColor(a.linkDesign.itemIcon, "#333").then(function(a) {
				j.css("background-image", "url('" + a + "')")
			});
			var k = $.isLinkHashed(a.itemUrl);
			$("#openPageSettingsPopUp").toggleClass("btnDisabled", k).unbind("mouseenter");
			k && $.dmSetToolTip("#openPageSettingsPopUp", "Page settings are disabled for hashed links");
			k = a.pageAlias && "original" !== a.pageAlias;
			$("#openPageSettingsPopUp").toggleClass("displayNone", !k);
			k ? $("#EditorInnerBGWidgets").fadeIn() : $("#EditorInnerBGWidgets").fadeOut();
			k = $(".EditIconWrapper");
			0 < k.size() && (k.data("pageLink", a), k.removeClass("initialized"), k.is(":visible") && (k.initPagesIcons(a), k.addClass("initialized")));
			k = $("#EditPageLinkWrapper");
			0 < k.size() && (k.initPageLinkEditor(a, g), k.toggle(!a.otherPage));
			$(".EditPageTitleWrapper .GeneralInput").attr("value", a.itemTitle);
			$(".EditPageTitleWrapper .GeneralInput").inputFieldLostFocusHandler(function() {
				var d = $(".EditPageTitleWrapper .GeneralInput").attr("value");
				"" == d.trim() ? $(".EditPageTitleWrapper .GeneralInput").attr("value", a.title) : (d != a.title && $.dmsrv.renamePage(a.pageID, d,
				function() {
					a.title = d;
					$.dmpages.refreshPages()
				}), $("#updateTitleLink").addClass("hiddenImportant"))
			});
			$("#deletePageBtn").data("shown", !0);
			"home" != a.pageAlias ? $.dmpages._initDeleteNavPageBtn(a, e) : $("#deletePageBtn").hide().data("shown", !1);
			$.ptPages.PreviewIsReady ? ($.ptPages.PreviewIsReady = !1, $("#deletePageBtn").data("shown") && $("#deletePageBtn").show()) : $.ptPages.arrivedFromClick || $("#deletePageBtn").hide();
			a.pageFromScratch ? ($("#duplicatePageBtn").show(), $("#duplicatePageBtn").unbind("click").bind("click",
			function() {
				$("#duplicatePageError").hide();
				$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.duplicate.jsp", {
					forceWidth: "480px",
					forceHeight: "185px",
					init: function() {
						$("#duplicatePageAlias").val(dmStr["ui.copyof"] + "_" + $.dmx.currentPageObj().title).focus().keypress(function(a) {
							13 == a.keyCode && $("#duplicatePageAction").click()
						});
						$("#duplicatePageAction").unbind("click").bind("click",
						function() {
							var a = $(this);
							"" == $("#duplicatePageAlias").val().trim() ? $.dmfw.showValidationError($("#duplicatePageAlias"), dmStr["ui.create.3"]) : a.hasClass("loading") || (a.addClass("loading"), $.dmPost({
								url: "/pages/" + $.dmx.currentPage() + "/duplicate/" + $("#duplicatePageAlias").val(),
								error: function(d) {
									a.removeClass("loading");
									try {
										switch (d.error_code) {
										case "ResourceAlreadyExist":
											return $.dmfw.showValidationError($("#duplicatePageAlias"), d.message),
											!0
										}
									} catch(e) {
										return null
									}
								},
								success: function(d) {
									a.removeClass("loading");
									$.dmpages.curPage = null;
									$.dmpages.curNavLink = d.navId;
									$.dmpages.showCurTab = null;
									$.dmx.addPage(d);
									d.navItem && d.navItem.markup && (d = $("\x3cul\x3e\x3c/ul\x3e").append(d.navItem.markup), $($.dmfw.getPreviewElement("#hiddenNavPlaceHolder #dmNav:first")).append(d.html()));
									$.ptPages.arrivedFromClick = !0;
									$.ptPages.refreshPagesPT({
										onNavBuilt: function() {
											$("#popupWinExampleMask").find(".closeThis").click()
										},
										skipNavTo: !1,
										forceNavRefresh: !0
									})
								}
							}))
						})
					}
				})
			})) : $("#duplicatePageBtn").hide();
			$.dmpages.selectedPageParams = {
				pageLink: a,
				removeFn: e,
				hideFn: d,
				changeTitleFn: g
			};
			$(".EditPageTitleWrapper .GeneralInput").inputFieldLostFocusHandler(function() {
				var a = $(".EditPageTitleWrapper .GeneralInput").attr("value");
				g(a);
				$.dmx.events.trigger("navTitleChanged", a);
				$("#updateTitleLink").fadeOut(200)
			});
			$(".EditPageTitleWrapper .GeneralInput").on("input",
			function() {
				$("#updateTitleLink").fadeIn(200)
			});
			$(".EditPageTitleWrapper .hideFromMenu").unbind("click").click(function() {
				$(this).hasClass("hiddennav") ? (d(!1), $(this).html("Hide From Menu")) : (d(!0), $(this).html("Show In Menu"));
				$(this).toggleClass("hiddennav")
			})
		},
		selectNavLinkById: function(a, e, d) {
			var g = null;
			$("#navPages li").each(function() {
				var d = $(this);
				if (d.data("dataItem").elementID == a) return g = d,
				!1
			});
			if (g) {
				var j = g;
				$.ptPages.selectNavLink(e, d, {
					pageLink: $(j).data("dataItem"),
					removeFn: $(j).data("remove"),
					hideFn: $(j).data("hide"),
					changeTitleFn: $(j).data("changeTitle"),
					li: j
				})
			}
		},
		selectNavLink: function(a, e, d) {
			d = d || {};
			var g = d.pageLink || pageLink,
			j = d.removeFn || removeFn,
			k = d.hideFn || hideFn,
			l = d.changeTitleFn || changeTitleFn;
			d = d.li;
			$.dmpages.curPage = null;
			$.dmpages.curNavLink = g.elementID;
			$.ptPages.handlePageSettingsSelected(g, j, k, l);
			$(".navEditorLinkAndSub").removeClass("active");
			$(d).addClass("active");
			a || $.ptPages._navToPageLink(g, e)
		},
		navigateToPageLink: function(a) {
			a = a.toLocaleLowerCase();
			var e = null;
			$("#navPages li").each(function() {
				var d = $(this);
				d.data("dataItem").itemTitle.toLocaleLowerCase() == a && (e = d)
			});
			e && e.find(".navLinkTitle:first").trigger("click")
		},
		initPtNavPageSettings: function(a, e, d, g) {
			$.dmpages.populatePageLinkSettings(a, e, d, g)
		},
		handlePageSettings: function() {
			$("#openPageSettingsPopUp").unbind("click.pagesettings").bind("click.pagesettings",
			function() {
				if ($(this).is(".btnDisabled")) return ! 1;
				$.dmfw.setPreviewEditPolicy(!1);
				var a = "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.popups.jsp";
				$.dmfw.isDudaone() && (a = "/editor/nee/mainTabs/ptMainTabs/Pages/one.pages.popups.jsp");
				var e = {
					id: "GeneralSettingsWrapper",
					name: dmStr["ui.general"],
					url: $.dmfw.isDudaone() ? "/editor/nee/mainTabs/ptMainTabs/Pages/one.pages.general.jsp": "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.general.jsp",
					onReady: function() {
						var a = function(a) {
							$.dmpages.selectedPageParams.pageLink.pageID && "default" != $.dmpages.selectedPageParams.pageLink.pageAlias ? $.dmpages.updateAutoSync($.dmx.pagesById()[$.dmpages.selectedPageParams.pageLink.pageID], a) : $.dmpages._createPage($.dmpages.selectedPageParams.pageLink,
							function(d) {
								$.dmpages._updatePageInNav($.dmpages.selectedPageParams.pageLink, d);
								$.dmpages.updateAutoSync(d, a)
							})
						},
						d = !0;
						$.dmpages.selectedPageParams.pageLink.pageID && $.dmx.pagesById()[$.dmpages.selectedPageParams.pageLink.pageID] && (d = !$.dmx.pagesById()[$.dmpages.selectedPageParams.pageLink.pageID].disableAutoSync);
						var e = $("#syncPageOnOffCheckbox input");
						d && e.attr("checked", "checked");
						e.unbind("click").click(function() {
							e.attr("disabled", !0);
							$.dmx.events.bind("autoSyncModified.autoSyncCheckBox",
							function() {
								e.removeAttr("disabled")
							},
							!0);
							e.is(":checked") ? a(!0) : a(!1);
							$(this).blur()
						});
						var g = function(a) {
							$.dmsrv.dontMobilizeUrl($.dmpages.selectedPageParams.pageLink.itemUrl, a,
							function(a) {
								$.dmfw.previewNavigateTo({
									url: a.value
								});
								$.ptPages.arrivedFromClick = !0;
								$.ptPages.refreshPagesPT({
									forceNavRefresh: !0
								})
							})
						}; (d = "original" == $.dmpages.selectedPageParams.pageLink.pageAlias) && $("#dontMobilizePageOnOffCheckbox input").attr("checked", "checked");
						$("#dontMobilizePageOnOffCheckbox input").unbind("click").click(function() {
							$("#dontMobilizePageOnOffCheckbox input").is(":checked") ? (g(!0), $.dmpages.selectedPageParams.pageLink.otherPage && $("#ptPageSettingsDoneButton").trigger("click")) : (g(!1), $.previewExternalLink.removeBackBtn());
							$(this).blur()
						});
						d = !0;
						0 < $($.dmfw.getPreviewElement("[id\x3d" + $.dmpages.selectedPageParams.pageLink.elementID + "]")).length ? "_blank" != $($.dmfw.getPreviewElement("[id\x3d" + $.dmpages.selectedPageParams.pageLink.elementID + "]")).find("a").attr("target") && (d = !1) : d = null != $.dmpages.selectedPageParams.pageLink.openInNewWindow ? $.dmpages.selectedPageParams.pageLink.openInNewWindow: !1;
						d && $("#openPageInNewPageOnOffCheckbox input").attr("checked", "checked");
						$("#openPageInNewPageOnOffCheckbox input").unbind("click").click(function() {
							var a = $("#openPageInNewPageOnOffCheckbox input").is(":checked");
							$.dmnavw.changeLinkTarget($.dmpages.selectedPageParams.pageLink, $.dmpages.selectedPageParams.pageLink.elementID, a ? "_blank": "", !a)
						});
						$.ptPages.initPtNavPageSettings($.dmpages.selectedPageParams.pageLink, $.dmpages.selectedPageParams.removeFn, $.dmpages.selectedPageParams.hideFn, $.dmpages.selectedPageParams.changeTitleFn);
						"home" == $.dmpages.selectedPageParams.pageLink.pageAlias && ($("#deletePageBtn").hide(), $("#dontMobilizePageOnOffCheckbox").parent().hide(), $("#openPageInNewPageOnOffCheckbox").parent().hide());
						$.dmpages.selectedPageParams.pageLink.pageFromScratch && $("#resetPageDesignBtn").hide();
						"default" == $.dmpages.selectedPageParams.pageLink.pageAlias && $("#resetPageDesignBtn").hide();
						$.dmpages.selectedPageParams.pageLink.pageFromScratch && ($("#dontMobilizePageOnOffCheckbox").parent().hide(), $("#dontMobilizePageOnOffCheckbox").parent().hide(), $("#syncPageOnOffCheckbox").parent().hide())
					}
				},
				d = {
					id: "SEOWrapper",
					name: dmStr["ui.nee.pages.11"],
					url: "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.seo.jsp",
					onReady: function() {
						$.ptPages.initPtNavPageSettings($.dmpages.selectedPageParams.pageLink, $.dmpages.selectedPageParams.removeFn, $.dmpages.selectedPageParams.hideFn, $.dmpages.selectedPageParams.changeTitleFn)
					}
				},
				g = {
					id: "TamplateWrapper",
					name: dmStr["ui.pt.pagesPanel.122"],
					url: "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.templates.jsp",
					onReady: function() {
						$.dmpagetmpl.initPageTemplateTab($.dmpages.selectedPageParams.pageLink.pageAlias, $.dmpages.createPageLink($.dmpages.selectedPageParams.pageLink, !1))
					}
				},
				j = {
					id: "HeadSectionWrapper",
					name: dmStr["ui.pt.pagesPanel.121"],
					url: "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.head_section.jsp",
					onReady: function() {
						$("#helpContentDiv").hide();
						$("#helpButton").unbind("mouseover.showhelp").bind("mouseover.showhelp",
						function() {
							$("#helpContentDiv").fadeIn(400)
						});
						$("#helpButton").unbind("mouseleave.showhelp").bind("mouseleave.showhelp",
						function() {
							$("#helpContentDiv").fadeOut(400)
						});
						$.ptPages.initPtNavPageSettings($.dmpages.selectedPageParams.pageLink, $.dmpages.selectedPageParams.removeFn, $.dmpages.selectedPageParams.hideFn, $.dmpages.selectedPageParams.changeTitleFn)
					}
				},
				k = function(a, m) {
					function n() {
						$("#nextPageButton").unbind("click.nextpage").bind("click.nextpage",
						function() {
							var a = null,
							d = parseInt($(".pagesNavWrap").data("current"));
							d < $("#navPages li").size() && ($(".pagesNavWrap").data("current", d + 1), a = $("#navPages li").eq(d + 1));
							a && ($("#prevPageButton").removeClass("ptNoLink"), a.find("ol").is(":visible") || a.find(".navLinkArrow").trigger("click"), d = $(".rightPanelTabsWrapper .rightPanelTab.tabSelect").index(), $.ptPages.navigateToPageLink(a.data("dataItem").itemTitle), k($.dmpages.selectedPageParams.pageLink, d), $.dmpages.selectedPageParams = {
								pageLink: a.data("dataItem"),
								removeFn: a.data("remove"),
								hideFn: a.data("hideFn"),
								changeTitleFn: a.data("changeTitleFn")
							},
							$("#pageSettingsPageTitle").html(a.data("dataItem").itemTitle + " \x3e"));
							parseInt($(".pagesNavWrap").data("current")) == $("#navPages li").size() - 1 ? $(this).addClass("ptNoLink") : $(this).removeClass("ptNoLink")
						})
					}
					m = m || 0;
					var o = [e, d, g, j];
					a.pageFromScratch && (o = [e, d, j]);
					$.dmx.site.isFromScratch && (o = "home" == a.pageAlias ? [d, j] : [e, d, j]);
					$("#pageSettingsPageTitle").html(a.itemTitle + " \x3e");
					$("#pageSettingsContentContainer").neeSecondaryTabsControl(o, m);
					$(".popupWinExample .closeThis").unbind("click.closeme").bind("click.closeme",
					function() {
						$.dmfw.setPreviewEditPolicy(!0)
					});
					$("#popupPageSettings #ptPageSettingsDoneButton").unbind("click.done").bind("click.done",
					function() {
						$(".popupWinExample .closeThis").trigger("click");
						$.dmops.updateEditContext.all({
							success: function() {
								$.ptPages.initNavigationItems()
							}
						})
					});
					o = $("#navPages li").index($("#navPages li.active"));
					$(".pagesNavWrap").data("current", o);
					0 == o && $("#prevPageButton").addClass("ptNoLink");
					o == $("#navPages li").size() - 1 && $("#nextPageButton").addClass("ptNoLink");
					n(a);
					$("#prevPageButton").unbind("click.prevpage").bind("click.prevpage",
					function() {
						var a = null,
						d = parseInt($(".pagesNavWrap").data("current"));
						0 < d && ($(".pagesNavWrap").data("current", d - 1), a = $("#navPages li").eq(d - 1));
						a && ($("#nextPageButton").removeClass("ptNoLink"), a.find("ol").is(":visible") || a.find(".navLinkArrow").trigger("click"), d = $(".rightPanelTabsWrapper .rightPanelTab.tabSelect").index(), $.ptPages.navigateToPageLink(a.data("dataItem").itemTitle), n(a.data("dataItem")), k($.dmpages.selectedPageParams.pageLink, d), $.dmpages.selectedPageParams = {
							pageLink: a.data("dataItem"),
							removeFn: a.data("remove"),
							hideFn: a.data("hideFn"),
							changeTitleFn: a.data("changeTitleFn")
						},
						$("#pageSettingsPageTitle").html(a.data("dataItem").itemTitle + " \x3e"));
						0 == parseInt($(".pagesNavWrap").data("current")) ? $(this).addClass("ptNoLink") : $(this).removeClass("ptNoLink")
					})
				};
				$.dmfw.openPopupFromUrl(a, {
					showIphone: !0,
					disableDrag: !0,
					init: function() {
						k($.dmpages.selectedPageParams.pageLink)
					}
				})
			})
		},
		refreshPagesPT: function(a) {
			var e = a || {},
			d = e.onNavBuilt,
			g = e.skipNavTo,
			j = e.onPreviewRefreshSuccess;
			$.ptPages.init(function() {
				d && d(); ! $.dmpages.curPage && !$.dmpages.curNavLink ? $.dmpages._openMainPage() : $.dmpages.executeSelectCurrent && $.dmpages.executeSelectCurrent(g, j)
			},
			{
				dontRefreshLayout: a.dontRefreshLayout,
				dontExecuteCurrent: !0,
				forceNavRefresh: a.forceNavRefresh
			})
		},
		handleAddNewPage: function() {
			$("#pagesAddPageNew").unbind("click").click(function() {
				$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.addNewPage.jsp?alias\x3d" + $.dmx.site.alias, {
					init: function() {
						$.ptPages.initAddNewPageTemplates()
					},
					showMindTouchHelp: !0,
					mindTouchId: "dmMtAddPageEditor"
				})
			})
		},
		initAddNewPageTemplates: function(a) {
			a = a || {};
			var e = $("#popupPageType");
			e.find(".contentIconBtn").unbind("click").click(function() {
				e.find(".contentIconBtn").removeClass("btnSelected");
				$(this).addClass("btnSelected")
			});
			e.find(".contentIconBtn").unbind("mouseover.selectNewPage").bind("mouseover.selectNewPage",
			function() {
				var a = $(this).parent();
				$("#popupPageType .ElementPreview .ElementPreviewImage").attr("class", "ElementPreviewImage");
				$("#popupPageType .ElementPreview .ElementPreviewImage").addClass(a.attr("id"));
				$("#popupPageType .ElementPreview #ElementPreviewTitle").html(a.data("title"));
				$("#popupPageType .ElementPreview #ElementPreviewExp").html(a.data("desc"))
			});
			e.find(".contentIconBtn").unbind("click.selectNewPage").bind("click.selectNewPage",
			function() {
				var a = $(this).parent();
				$("#popupPageType .ElementPreview .ElementPreviewImage").attr("class", "ElementPreviewImage");
				$("#popupPageType .ElementPreview .ElementPreviewImage").addClass(a.attr("id"));
				$("#popupPageType .ElementPreview #ElementPreviewTitle").html(a.data("title"));
				$("#popupPageType .ElementPreview #ElementPreviewExp").html(a.data("desc"));
				$(".createPageSettings").attr("type", a.attr("id"));
				$(".pageTypePlaceholder").hide();
				$(".createPageSettings").show();
				$("#pageTitle").val($(this).parent().data("page-title")).trigger("focus");
				$("#backToPages").unbind("click").click(function() {
					$(".pageTypePlaceholder").show();
					$(".createPageSettings").hide();
					$(".contentIconBtn").removeClass("btnSelected")
				})
			});
			$("#addNewPagePt").unbind("click").click(function() {
				$("#linkPageUrlError").hide();
				$("#pageTitleError").hide();
				var d = e.find(".contentIconBtn.btnSelected");
				0 == d.length && (d = e.find("#SimpleTemplate .contentIconBtn"));
				if (!$.dmpages.isCreateNewPageCalled) {
					$.dmpages.isCreateNewPageCalled = !0;
					setTimeout(function() {
						$.dmpages.isCreateNewPageCalled = !1
					},
					320);
					var g = d.parent().attr("id"),
					j = d.parent().data("selector");
					$("#addNewPagePt").text(dmStr["ui.nee.pages.99"]);
					var k = $("#linkPageUrl").val() ? $("#linkPageUrl").val().trim() : "",
					l = $("#pageTitle").val().trim(),
					m = !1;
					"" == k && $("#linkPageUrl").is(":visible") && ($("#linkPageUrlError").text(dmStr["ui.nee.pages.102"]).show(), m = !0);
					var n = k;
					n && !n.match(/^[a-zA-Z]+:\/\//) && (n = "http://" + n);
					if ((n = $.dmx.getPageByField("url", n)) && $("#linkPageUrl").is(":visible")) $("#linkPageUrlError").text(dmStr["ui.nee.pages.101"] + ' "' + n.title + '"').show(),
					m = !0;
					"" == l && $("#pageTitle").is(":visible") && ($("#pageTitleError").show(), m = !0);
					if (m) return $("#addNewPagePt").text(dmStr["ui.nee.pages.99"]),
					!0;
					$.dmops.createPageBlank({
						siteId: $.dmx.site.id,
						suggestedAlias: l,
						addToNav: !1 !== a.addToNav,
						templateName: g,
						skipContextRefresh: !0,
						loadingStyle: "nowheel",
						pageUrl: k || $.dmx.site.baseUrl,
						dontMobilize: $("#linkPageDontMobilize").is(":checked"),
						pageTitle: l,
						error: function(a) {
							try {
								switch (a.error_code) {
								case "ResourceNotExist":
									return $("#linkPageUrlError").text(dmStr["ui.nee.pages.100"]).show(),
									$("#addNewPagePt").text(dmStr["ui.nee.pages.99"]),
									!0;
								case "InvalidInput":
									return $("#linkPageUrlError").text(a.message).show(),
									$("#addNewPagePt").text(dmStr["ui.nee.pages.99"]),
									!0;
								case "ResourceAlreadyExist":
									return $("#linkPageUrlError").text(dmStr["ui.nee.pages.101"] + ' "' + a.message + '"').show(),
									$("#addNewPagePt").text(dmStr["ui.nee.pages.99"]),
									!0
								}
							} catch(d) {
								return null
							}
						},
						success: function(e) {
							$.dmpages.curPage = null;
							$.dmpages.curNavLink = e.navId;
							$.dmpages.showCurTab = null;
							$.dmx.addPage(e);
							if (e.navItem && e.navItem.markup) {
								var k = $("\x3cul\x3e\x3c/ul\x3e").append(e.navItem.markup);
								$($.dmfw.getPreviewElement("#hiddenNavPlaceHolder #dmNav:first")).append(k.html())
							}
							a.noNavigate ? (d.closest("#popupWinExampleMask").find(".closeThis").click(), wrTrackEvent(PT_NEW_PAGE, {
								pageType: g
							})) : ($.ptPages.arrivedFromClick = !0, $.ptPages.refreshPagesPT({
								onNavBuilt: function() {
									d.closest("#popupWinExampleMask").find(".closeThis").click();
									wrTrackEvent(PT_NEW_PAGE, {
										pageType: g
									})
								},
								skipNavTo: !1,
								forceNavRefresh: !0,
								onPreviewRefreshSuccess: function() {
									j && "" == !j && setTimeout(function() {
										var a = $.dmfw.getPreviewElement(j);
										a.length && $.dmfw.selectAndOpenEditor(a)
									},
									300)
								}
							}));
							a.success && a.success(e)
						}
					})
				}
			});
			$("#pageTitle").keypress(function(a) {
				13 == a.keyCode && e.find("#addNewPagePt").click()
			});
			e.find(".contentIconBtn").unbind("dblclick").bind("dblclick",
			function() {
				e.find("#addNewPagePt").click()
			})
		},
		initBlogPagesPanel: function() {
			var a = $("#pagesEditSubMenuWrapper"),
			e = a.find("#navPages");
			0 == e.length && (e = $("\x3col id\x3d'navPages'\x3e\x3c/ol\x3e").appendTo(a), $("\x3cli id\x3d'blogHomeBtnLi' class\x3d'blogPTinnerPages'\x3e\x3cspan\x3eHome Page\x3c/span\x3e\x3c/li\x3e").appendTo(e), $("\x3cli id\x3d'blogPostBtnLi' class\x3d'blogPTinnerPages'\x3e\x3cspan\x3ePost Pages\x3c/span\x3e\x3c/li\x3e").appendTo(e));
			a.find(".blogPTinnerPages").removeClass("active");
			0 != $.dmfw.getPreviewElement(".dmRssContainer").length ? $("#blogHomeBtnLi").addClass("active") : $("#blogPostBtnLi").addClass("active");
			a.find("#blogPostBtnLi").unbind("click").click(function() {
				e.find(".blogPTinnerPages").removeClass("active");
				$(this).addClass("active");
				var a = $.dmfw.getPreviewElement(".dmBlogInnerPostPage");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmUnblockUI()) : ($.dmBlockUI(null, !0), $.dmfw.previewNavigateTo({
					url: $.dmx.rt.blogFirststPostHref,
					onReady: function() {
						$.dmUnblockUI()
					}
				}))
			});
			a.find("#blogHomeBtnLi").unbind("click").click(function() {
				e.find(".blogPTinnerPages").removeClass("active");
				$(this).addClass("active");
				var a = $.dmfw.getPreviewElement(".dmRssContainer");
				0 != a.length ? ($.dmops.scrollPreviewToElement(a), $.dmUnblockUI()) : ($.dmBlockUI(null, !0), a = $.dmfw.getPreviewElement("a#dm-logo-anchor").attr("href"), $.dmfw.previewNavigateTo({
					url: a,
					onReady: function() {
						$.dmUnblockUI()
					}
				}))
			})
		}
	}
}); (function(a) {
	a.fn.initPagesIcons = function(e) {
		var d = function(d, g, j, n) {
			a.dmops.handleNavIcon(d, g, j, e, n);
			var o = a("#EditPageIcon .GreySelect .GreySelectText");
			a.dmops.removeFontIcon(o);
			a.isIconClass(e.linkDesign.itemIcon) ? o.css("background-image", "none").addClass(e.linkDesign.itemIcon) : a.changeColor(e.linkDesign.itemIcon, "#333").then(function(a) {
				o.css("background-image", "url('" + a + "')")
			})
		},
		g = a(this),
		j = a.isIconClass(e.linkDesign.itemIcon) ? e.linkDesign.navColor: null;
		a.getImageColor(e.linkDesign.itemIcon,
		function(a) {
			g.neeSecondaryGalleryTab({
				refreshPages: !0,
				selectedIcon: e.linkDesign.itemIcon,
				icon: !0,
				useFontIcon: !0,
				color: j || "#" + a,
				iconColorArr: "defaultPTIconsColors",
				colorCubeClass: "colorCube",
				callback: d,
				lineSelector: ".selectColors"
			})
		});
		g.unbind("clickoutside").bind("clickoutside",
		function(d) {
			a(d.target).is("#colorPickerBtns *, #closeBtnCP, #closeBtnCP *,.ui-corner-all") || g.hide()
		})
	}
})(jQuery); (function(a) {
	a.fn.initPageLinkEditor = function(e, d) {
		a(this).neePopUpDiv(a("#NavToOpenLink").clone(!0), {
			init: function(g) {
				g.empty();
				var j = a("\x3cdiv class\x3d'headerLogoCropPop'\x3e\x3cdiv id\x3d'headerLogoCropPopTitle' style\x3d'margin-top: -10px;'\x3e" + dmStr["ui.pt.tabs.pages.1"] + "\x3c/div\x3e\x3c/div\x3e");
				jQuery.ajax({
					url: a.dmfw.editables("link").getMarkupUrl(),
					async: !1,
					success: function(k) {
						j.append(a(k));
						k = a("\x3cdiv class\x3d'headerLogoCropPopBottom'\x3e\x3chr/\x3e\x3cdiv class\x3d'doneBtn blueBtn'\x3e" + dmStr["ui.done"].toUpperCase() + "\x3c/div\x3e\x3c/div\x3e");
						j.append(k);
						j.find("#linkPanelEditorWrapper").css("display", "none");
						g.append(j);
						g.find(".doneBtn").click(function() {
							a.ptPages.refreshPagesPT({
								forceNavRefresh: !0,
								skipNavTo: !1
							});
							a(".closeThis").click()
						});
						a(".closeThis").unbind("click.refreshPages").bind("click.refreshPages",
						function() {});
						k = a(g.find("#linkPanelEditorWrapper"));
						var l = null,
						l = a.dmfw.getPreviewElement();
						if (void 0 !== a(l).prop("tagName")) l = a(l).find("#" + e.elementID + ":not(.navButtonLi, .navButtonLi *)");
						else var l = e.itemUrl,
						m = e.pageAlias,
						m = "original" === m ? l: "/site/" + a.dmx.site.alias + "/" + m + "/?url\x3d" + escape(l),
						n = e.elementID,
						l = a("\x3cli id\x3d'" + n + "' duda_id\x3d'" + n + "'\x3e\x3ca id\x3d'" + n.replace("_item", "a") + "' href\x3d'" + m + "' raw_url\x3d'" + l + "' duda_id\x3d'" + n.replace("_item", "a") + "'\x3e" + e.itemTitle + "\x3c/a\x3e\x3c/li\x3e");
						k.neeLinksWidget({
							current: {
								element: l.find("a:first"),
								editable: a.dmfw.editables("link"),
								navLink: {
									element: l
								}
							},
							noSurroundButton: !0,
							noRemoveLink: !0,
							selectTextOnInit: e.itemTitle == dmStr["ui.nee.navigation.newItemTitle"],
							onTitleChanged: function(a) {
								d(a)
							},
							onNavTargetChange: function(d, g) {
								a.dmnavw.changeLinkTarget(e, e.elementID, d, g)
							},
							success: function() {
								a.refreshLayoutNavigations()
							}
						})
					}
				})
			},
			showIphone: !0,
			classes: "pagesLinkEditor",
			disableDrag: !0,
			showMindTouchHelp: !0,
			mindTouchId: "dmMtEditPageLink"
		})
	}
})(jQuery); (function(a) {
	a.fn.neeSiteSettingsTabs = function() {
		var e = [{
			id: "setGeneral",
			name: dmStr["ui.general"],
			url: "/editor/nee/mainTabs/ptMainTabs/nee.pt.settings.settings_General.jsp",
			onReady: function() {
				a.siteSettingsUtil.loadSiteAndInitScreen();
				a("#ptEditorInnerArea").unbind("click.editsite").on("click.editsite", "#handleAddHomeIcon",
				function() {
					var d = new NEEHomeScreen;
					a.dmfw.openGlobalEditor({
						editable: d
					})
				})
			}
		},
		{
			id: "setSEO",
			name: dmStr["ui.nee.pages.11"],
			url: "/editor/nee/mainTabs/ptMainTabs/nee.pt.settings.settings_SEO.jsp",
			onReady: function() {
				a.siteSettingsUtil.loadSiteAndInitScreen()
			}
		},
		{
			id: "setAdvc",
			name: dmStr["ui.nee.pages.13"],
			url: "/editor/nee/mainTabs/ptMainTabs/nee.pt.settings.settings_Advc.jsp",
			onReady: function() {
				a.siteSettingsUtil.loadSiteAndInitScreen()
			}
		}];
		a(this).neeSecondaryTabsControl(e)
	}
})(jQuery); (function(a) {
	var e, d;
	function g(l, m, n) {
		m = m || a("\x3cdiv\x3e\x3c/div\x3e");
		var r = a(m);
		if (r.is("#versionManager")) {
			e = l || a.dmx.site.id;
			d = a.dmx.site.alias;
			r.find(".siteAlias").html(d);
			r.find("#versionBackupName").attr("placeholder", d + "_1");
			var u = r.find(".backupBtn"),
			E = r.find("#versionBackupName");
			r.off("click.backupVersion").on("click.backupVersion", ".backupBtn:not(.disabled)",
			function() {
				a.dmBlockUI();
				E.blur();
				var g = E.val() || "",
				g = g.trim() || E.attr("placeholder") || d;
				u.addClass("disabled");
				a.backupManager.srv.addCurrentVersion(e, g).done(function(a) {
					j(r.find("#versions"), e, a, {
						revealFirst: !0
					}).done(function() {
						k(a);
						E.val("")
					})
				}).fail(function() {
					u.removeClass("disabled");
					E.addClass("error");
					E.focus();
					o()
				})
			});
			E.off("keydown").on("keydown",
			function(a) {
				13 === a.which ? u.trigger("click") : (u.removeClass("disabled"), E.removeClass("error"))
			});
			j(r.find("#versions"), e).done(function(a) {
				k(a);
				n && n()
			})
		} else a.dmLoad(m, "/editor/nee/mainTabs/ptMainTabs/nee.pt.tabs.backup-manager.jsp").done(function(a) {
			g(l, a, n)
		})
	}
	function j(d, g, m, n) {
		function D(g) {
			var m = d.find(".versionsList");
			"function" != typeof _versionTemplate && (r = l(d, "#versionsTemplate"));
			var z = a(r({
				versions: g.reverse()
			}));
			n.revealFirst && (z.addClass("firstHidden revealing"), setTimeout(function() {
				z.removeClass("firstHidden")
			},
			200));
			a.dmUnblockUI();
			F && F.remove();
			m.find(".versionListInner").remove();
			m.find(".versionsListNoVersions").hide();
			0 < g.length ? m.append(z) : m.find(".versionsListNoVersions").show();
			var B = d;
			B.off("click.restore").on("click.restore", ".versionRestore",
			function() {
				var d = a(this).closest(".versionRow").data("url"),
				g = a(this).closest(".versionRow").data("desc");
				"function" != typeof u && (u = l(B, "#versionsConfirmationTemplate"));
				g = u({
					description: g
				});
				a("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(g, {
					initCallback: function() {
						a.dmBlockUI();
						a.backupManager.srv.restoreToVersion(e, d).done(function() {
							a.dmUnblockUI();
							location.reload()
						}).fail(o)
					},
					onNoCallback: function() {},
					triggerNow: !0,
					noText: dmStr["ui.no"].toUpperCase(),
					yesText: dmStr["ui.yes"].toUpperCase(),
					bindCloseToNo: !0,
					forceWidth: "420px",
					dontRemoveCurrent: !0,
					classes: "verManager restorePopUp"
				})
			});
			var C = d;
			C.off("click.delete").on("click.delete", ".versionDelete",
			function() {
				var d = "\x3cspan class\x3d'restoreConfirmTitle'\x3e" + dmStr["ui.backupManager.14"] + "\x3c/span\x3e",
				g = a(this).closest(".versionRow").data("url");
				a("\x3cdiv\x3e\x3c/div\x3e").neeConfirmationPopUpDiv(d, {
					initCallback: function() {
						a.dmBlockUI();
						a.backupManager.srv.deleteVersion(e, g).done(function(a) {
							j(C, e, a).done(function() {
								k(a)
							})
						}).fail(o)
					},
					onNoCallback: function() {},
					triggerNow: !0,
					noText: dmStr["ui.no"].toUpperCase(),
					yesText: dmStr["ui.yes"].toUpperCase(),
					bindCloseToNo: !0,
					forceWidth: "350px",
					dontRemoveCurrent: !0,
					classes: "verManager deletePopUp"
				})
			});
			E.resolve(g)
		}
		var E = a.Deferred(),
		F;
		n = n || {};
		e = g;
		m ? D(m) : (F = a("#disabledImageZone").clone().css("width", "0").css("height", "0").find("#imageZone").attr("style", ""), d.find(".versionsList").append(F), showDefaultLoader(F, d.find(".versionsList")), a.backupManager.srv.getVersionsList(g).done(D).fail(o));
		return E.promise()
	}
	function k(e) {
		for (var g = 1,
		j = 0,
		k = e.length; j < k; j++) {
			var l = e[j].description.replace("" + d + "_", "");
			isNumber(l) && (g = Math.max(g, parseFloat(l) + 1))
		}
		a("#versionBackupName").attr("placeholder", d + "_" + g)
	}
	function l(d, e) {
		Handlebars.registerHelper("formatDate",
		function(d) {
			return a.convertUtils.dates.getDateString(d)
		});
		Handlebars.registerHelper("spaces",
		function(a) {
			return a.toCamel().replace(/_/g, " ")
		});
		var g = d.find(e).html();
		return Handlebars.compile(g)
	}
	function m(d, e, g, j) {
		var k = a.Deferred();
		d = ["/sites/", e, "/", d].join("");
		g = g || {};
		j = j || n;
		e = g || {};
		var l = !0,
		m = "",
		o = /^[0-9a-zA-Z \-_\(\)]*$/;
		e.description && !o.test(e.description) && (l = !1, m = "Wrong characters");
		l ? a.dmPost({
			url: d,
			data: g,
			success: function(a) {
				k.resolve(a);
				j(a)
			},
			error: function(a) {
				k.reject(a)
			}
		}) : k.reject(m);
		return k.promise()
	}
	var n = function() {},
	o = function() {
		a.dmUnblockUI()
	};
	d = e = "";
	var r, u;
	a.backupManager = {
		ui: {
			init: g,
			initVersionsList: j
		},
		srv: {
			getVersionsList: function(a, d) {
				return m("getUploadedBackups", a, {},
				d)
			},
			addCurrentVersion: function(a, d, e) {
				return m("backup", a, {
					description: d
				},
				e)
			},
			deleteVersion: function(a, d, e) {
				return m("deleteBackup", a, {
					URL: "Object" === typeof d ? d.URL: d
				},
				e)
			},
			restoreToVersion: function(a, d, e) {
				return m("restoreSiteBackup", a, {
					URL: "Object" === typeof d ? d.URL: d,
					createRestorePoint: !0
				},
				e)
			},
			changeDescription: function(a, d, e, g) {
				return m("changeBackupDescription", a, {
					URL: "Object" === typeof d ? d.URL: d,
					description: e
				},
				g)
			}
		}
	}
})(jQuery, this);
var PT_LAYOUT_ID = "ptSideMenuDesignLayout",
PT_COLORS_ID = "ptSideMenuDesignColors",
PT_HEADER_ID = "ptSideMenuDesignHeader",
PT_PAGES_ID = "ptSideMenuEdit",
PT_PUBLISH_ID = "ptSideMenuGoLiveSave",
PT_REDIRECT_ID = "ptSideMenuGoLiveRedirect",
PT_DESIGN_ID = "ptOuterSideMenuDesign",
PT_CONNECT_ID = "ptSideMenuGoLiveConnect";$.extend({
	ptShellContr: {
		initShell: function() {
			$.ptShellContr._initLogoBtn();
			$.ptShellContr._initPublishBtn();
			$.ptShellContr._initLangBtn();
			$.ptShellContr._initSettingsBtn();
			$.ptShellContr._initInfoLine();
			$.ptShellContr._initUpgradeSave();
			$.ptShellContr._openPinkyToeWelcomePopup()
		},
		_initLogoBtn: function() {
			$("#headerLogoLink").attr("href", dm_www_home + "index.php")
		},
		_initPublishBtn: function() {
			$("#shortcutToPublish").click(function() {
				$.ptShellContr.navigateToTab(PT_PUBLISH_ID)
			})
		},
		_initLangBtn: function() {
			commonProps["pt.allowLocales"] || $("#openLanguageSubMenu").hide();
			var a = dm_account_locale || 1;
			$("#openLanguageSubMenu .localeText").html($("#dmLocale" + a + " .lanPopupText").html());
			$("#openLanguageSubMenu").unbind("click").click(function() {
				$("ul.languageSubMenu").toggle()
			});
			$("#dmLocale" + a).addClass("currentLocale");
			$(".localeButton").addClass("currentLocaleFlag" + a);
			$("#DM_openCloseArea.localeMenu").addClass("currentLocaleFlag" + a);
			$("ul.languageSubMenu li").unbind("click").click(function() {
				$(".languageSubMenu").toggleClass("displayNone");
				$(".localeButton").toggleClass("blue")
			})
		},
		_initSettingsBtn: function() {
			$("#originalSite").click(function() {
				window.open($.dmx.rt.liveUrl, "_blank")
			});
			$("#openSettingsSubMenu").unbind("click").click(function() {
				$("ul.SettingsSubMenu").toggle();
				$(this).toggleClass("active")
			});
			$("#openSettingsSubMenu").unbind("clickoutside").bind("clickoutside",
			function() {
				$("ul.SettingsSubMenu").hide();
				$(this).removeClass("active")
			});
			$("#settingsCssHtml").unbind("click").click(function() {
				$.ptAccordContr.showDisplayPhone({
					dontCollapse: !0
				});
				$.ptAccordContr.setAccordionIsCollapseAll(!0);
				$("#ptEditorAreaChange").empty().hide();
				url = "/editor/nee/mainTabs/ptMainTabs/nee.pt.settings_htmlCss.jsp";
				$.dmLoad($("#ptEditorAreaChange"), url,
				function() {
					$("#ptEditorAreaChange").fadeIn("fast")
				})
			});
			$("#backupManagerBtn").unbind("click").click(function() {
				$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/ptMainTabs/nee.pt.tabs.backup-manager.jsp", {
					init: function() {
						$.backupManager.ui.init($.dmx.site.id, $("#versionManager"))
					},
					showMindTouchHelp: !0,
					mindTouchId: "dmMtBackups"
				})
			});
			$("#settingsSiteSettings").unbind("click").click(function() {
				$.ptAccordContr.showDisplayPhone({
					dontCollapse: !0
				});
				$.ptAccordContr.setAccordionIsCollapseAll(!0);
				$("#ptEditorAreaChange").empty().hide();
				url = "/editor/nee/mainTabs/ptMainTabs/nee.pt.settings_siteSettings.jsp";
				$.dmLoad($("#ptEditorAreaChange"), url,
				function() {
					$("#ptEditorAreaChange").fadeIn("fast")
				});
				$.ptTipsList.destroyList("design");
				$.ptTipsList.destroyList("pages")
			}); ! isReseller && ("YAHOO" != $.dmx.site.dmProductType && "OPENTABLE" != $.dmx.site.dmProductType) && $("#whiteRussian").hide();
			$("#whiteRussian").click(function() {
				$.dmPost({
					url: "/accounts/" + dm_account_name + "/switcheditor/WR",
					success: function() {
						location.replace("/home/editor#wr@design@" + $.dmx.site.alias)
					}
				})
			});
			$("#templateEditor").unbind("click").click(function() {
				$.ptAccordContr.showDisplayPhone({
					dontCollapse: !0
				});
				$.ptAccordContr.setAccordionIsCollapseAll(!0);
				$("#ptEditorAreaChange").empty().hide();
				url = "/editor/nee/mainTabs/ptMainTabs/templates/nee.pt.templates.editor.jsp";
				$.dmLoad($("#ptEditorAreaChange"), url,
				function() {
					$("#ptEditorAreaChange").fadeIn("fast")
				})
			})
		},
		_initInfoLine: function() {
			$.dmmsg.getMsg(commonProps["editor.pt.headerMessageFilePath"],
			function(a) {
				$(".HeaderMessageContent").html(a);
				$(".HeaderMessageBG").show("blind", null, 500)
			},
			function(a) {
				$(".HeaderMessageContent").html(a)
			});
			$("#infoMessageClose").click(function() {
				$(this).hide();
				$(".HeaderMessageBG").hide("blind", null, 500)
			})
		},
		_afterCreatingAccount: function() {
			var a = $("#editorSettingsTopBar, .HeaderInnerLinks.shellHeaderWrapper");
			$.dmx.isPremium() || a.find(".upgrade").show();
			a.find(".publish").show();
			a.find(".savesite").hide();
			$(".dashboard").show()
		},
		_initUpgradeSave: function() {
			var a = $("#editorSettingsTopBar, .HeaderInnerLinks.shellHeaderWrapper");
			dm_not_saved && (a.find(".upgrade").hide(), a.find(".publish").hide(), $(".dashboard").hide(), a.find(".savesite").show(), a.find(".savesite").click(function() {
				$.dmfw.openPopupFromUrl("/editor/nee/mainTabs/signupPopup/createAccountPopupOld.jsp", {
					init: function() {
						$.dmfw.openPopUpCreateAccount({
							afterConfirm: $.ptShellContr._afterCreatingAccount
						})
					}
				})
			}));
			$.dmx.isPremium() && a.find(".upgrade").hide()
		},
		_openPinkyToeWelcomePopup: function() {},
		navigateToTab: function(a) {
			$.ptTipsList && ($.ptTipsList.destroyList("design"), $.ptTipsList.destroyList("pages"));
			switch (a) {
			case PT_LAYOUT_ID:
				$.ptAccordContr._openTabLayout();
				break;
			case PT_COLORS_ID:
				$.ptAccordContr._openTabStyle();
				break;
			case PT_HEADER_ID:
				$.ptAccordContr._openTabHeader();
				break;
			case PT_PAGES_ID:
				$.ptAccordContr._openTabPages();
				break;
			case PT_PUBLISH_ID:
				$.setCookie("_dm_pt_tips_design", "read", 8064, "/", !1);
				$.ptAccordContr._openTabSave();
				break;
			case PT_CONNECT_ID:
				$.setCookie("_dm_pt_tips_design", "read", 8064, "/", !1);
				$.dmredi.parameters.nextTimeUseBfsConnectScreen = !0;
				$.ptAccordContr._openTabRedirect();
				break;
			case PT_REDIRECT_ID:
				$.setCookie("_dm_pt_tips_design", "read", 8064, "/", !1);
				$.ptAccordContr._openTabRedirect();
				break;
			case PT_DESIGN_ID:
				$.ptAccordContr._openFirstDesignTab();
				break;
			default:
				$.ptAccordContr._openFirstDesignTab()
			}
		},
		getHistoryToken: function() {
			var a = window.location.hash;
			if (a && 1 < a.length) {
				var e = PT_LAYOUT_ID,
				a = a.replace("#", "");
				switch (a) {
				case "layout":
					e = PT_LAYOUT_ID;
					break;
				case "style":
					e = PT_COLORS_ID;
					break;
				case "header":
					e = PT_HEADER_ID;
					break;
				case "pages":
					e = PT_PAGES_ID;
					break;
				case "publish":
					e = PT_PUBLISH_ID;
					break;
				case "1stpublish":
					e = PT_PUBLISH_ID;
					$.dmx.firstPublished = !0;
					break;
				case "redirect":
					e = PT_REDIRECT_ID;
					break;
				case "connect":
					e = PT_CONNECT_ID
				}
				return e
			}
		},
		showLoadingOnAll: function() {},
		hideLoadingOnAll: function() {},
		collapseAll: function() {}
	}
});$.extend({
	ptAccordContr: {
		_varCurrTabChosen: -1,
		initTabs: function(a) {
			a = a || {};
			$.ptAccordContr._initAccordion(a);
			$.ptAccordContr._initAccordTabs();
			$.ptShellContr.navigateToTab(a.forceTab);
			$.ptAccordContr.setRedirectTabState()
		},
		_initAccordion: function() {
			$.ptAccordContr._varCurrTabChosen = -1;
			$("#SideMenuWrapper").accordion({
				icons: !1,
				clearStyle: !0,
				collapsible: !1,
				active: !1
			});
			$("#SideMenuWrapper").bind("accordionchangestart",
			function(a, e) {
				$("#ptEditorAreaChange").hide();
				$.ptAccordContr._varCurrTabChosen = e.newHeader.data() && e.newHeader.data("tabsId") != e.oldHeader.data("tabsId") ? e.newHeader.data("tabsId") : -1
			})
		},
		_initPublishBtn: function() {
			$("#shortcutToPublish").click(function() {
				$("#ptSideMenuGolive").click()
			})
		},
		_openTabRedirect: function() {
			$("#SideMenuWrapper").accordion("option", "active", 2);
			$(".SideMenuSubWrapper li").removeClass("active");
			$("#ptSideMenuGoLiveRedirect").addClass("active");
			$("#ptEditorAreaChange").hide();
			$.dmLoad($("#ptEditorAreaChange"), "/editor/nee/mainTabs/ptMainTabs/nee.pt.goLive_redirect.jsp",
			function() {
				$.ptAccordContr.hideDisplayPhone();
				$("#ptEditorAreaChange").fadeIn("fast");
				wrTrackEvent(PT_GO_REDIRECT)
			})
		},
		_initTabRedirect: function() {
			$("#ptSideMenuGoLiveRedirect").unbind("click").click(function() {
				$.ptAccordContr._openTabRedirect()
			})
		},
		_openTabSave: function() {
			$.ptAccordContr.showDisplayPhone();
			$("#SideMenuWrapper").accordion("option", "active", 2);
			$(".SideMenuSubWrapper li").removeClass("active");
			$("#ptSideMenuGoLiveSave").addClass("active");
			$("#ptEditorAreaChange").hide();
			$.dmLoad($("#ptEditorAreaChange"), "/editor/nee/mainTabs/ptMainTabs/nee.pt.goLive_save.jsp",
			function() {
				$("#ptEditorAreaChange .EditorInnerBG").hide();
				$.ptAccordContr.showDisplayPhone();
				var a = $.dmui.getDynamicPublishPanelMarkup({
					product: $.dmx.site.dmProductType
				});
				$(".EditorInnerBG .EditorInnerBGIn").load(a,
				function() {
					$("#ptEditorAreaChange .EditorInnerBG").show();
					$("#ptEditorAreaChange").fadeIn("fast");
					$("#ptEditorAreaChange").unbind("click.redir").on("click.redir", ".neeRedirectSetupBtn",
					function() {
						$("#ptSideMenuGoLiveRedirect").click()
					})
				});
				wrTrackEvent(PT_GO_GOLIVE)
			})
		},
		_initTabSave: function() {
			$("#ptSideMenuGoLiveSave").unbind("click").click(function() {
				$.ptAccordContr._openTabSave()
			})
		},
		_initTabWrapperGoLive: function() {
			$("#SideMenuWrapper").unbind("click.golive").on("click.golive", "#ptSideMenuGolive",
			function() {
				$.ptTipsList && ($.ptTipsList.destroyList("design"), $.ptTipsList.destroyList("pages"));
				$.dmfw.setPreviewEditPolicy(!1);
				$("#ptEditorAreaChange").hide();
				$.ptAccordContr._openTabSave()
			})
		},
		_openTabPages: function() {
			$.ptAccordContr.showDisplayPhone();
			$("#SideMenuWrapper").accordion("option", "active", 1);
			$.dmfw.setPreviewEditPolicy(!0);
			$.dmx.site.isBlog || $.ptPages.init();
			$("#ptEditorAreaChange").hide();
			$.dmLoad($("#ptEditorAreaChange"), "/editor/nee/mainTabs/ptMainTabs/Pages/nee.pt.pages.edit.jsp",
			function() {
				$.dmx.site.isBlog ? ($.ptContent.init(), $.ptPages.initBlogPagesPanel()) : ($.ptContent.init(), $.ptPages.ptPagesOnNavReady());
				$("#ptEditorAreaChange").fadeIn("fast",
				function() {
					$.ptPages.initPagesTabTips()
				});
				wrTrackEvent(PT_GO_PAGES)
			})
		},
		_initTabWrapperPages: function() {
			$.ptAccordContr._initTabSave();
			$.ptAccordContr._initTabRedirect();
			$("#SideMenuWrapper").unbind("click.editpages").on("click.editpages", "#ptSideMenuEdit",
			function() {
				$.ptAccordContr._openTabPages()
			})
		},
		_openTabLayout: function() {
			$.ptAccordContr.showDisplayPhone();
			$("#SideMenuWrapper").accordion("option", "active", 0);
			$(".SideMenuSubWrapper li").removeClass("active");
			$("#ptSideMenuDesignLayout").addClass("active");
			$("#ptEditorAreaChange").hide();
			var a = $("#ptSideMenuDesignLayout").data("urlToOpen");
			$.dmLoad($("#ptEditorAreaChange"), a,
			function() {
				$("#ptEditorAreaChange").fadeIn("fast");
				wrTrackEvent(PT_GO_LAYOUT)
			})
		},
		_initTabLayout: function() {
			$("#ptSideMenuDesignLayout").unbind("click").click(function() {
				$.ptAccordContr._openTabLayout()
			})
		},
		_openTabStyle: function() {
			$.ptAccordContr.showDisplayPhone();
			$("#SideMenuWrapper").accordion("option", "active", 0);
			$(".SideMenuSubWrapper li").removeClass("active");
			$("#ptSideMenuDesignColors").addClass("active");
			$("#ptEditorAreaChange").hide();
			var a = $("#ptSideMenuDesignColors").data("urlToOpen");
			$.dmLoad($("#ptEditorAreaChange"), a,
			function() {
				$("#ptEditorAreaChange").fadeIn("fast");
				wrTrackEvent(PT_GO_STYLE)
			})
		},
		_initTabStyle: function() {
			$.dmx.events.bind("onPreviewReady.refreshPtStyleTab",
			function() {
				$.ptAccordContr.isStyleTabOpen() && $.ptColor._handleBackgroundImageChange()
			},
			!0);
			$("#ptSideMenuDesignColors").unbind("click").click(function() {
				$.ptAccordContr._openTabStyle()
			})
		},
		_openTabHeader: function() {
			$.ptAccordContr.showDisplayPhone();
			$("#SideMenuWrapper").accordion("option", "active", 0);
			$(".SideMenuSubWrapper li").removeClass("active");
			$("#ptSideMenuDesignHeader").addClass("active");
			$("#ptEditorAreaChange").hide();
			var a = $("#ptSideMenuDesignHeader").data("urlToOpen");
			$.dmLoad($("#ptEditorAreaChange"), a,
			function() {
				$("#ptEditorAreaChange").fadeIn("fast");
				wrTrackEvent(PT_GO_HEADER)
			})
		},
		_initTabHeader: function() {
			$("#ptSideMenuDesignHeader").unbind("click").click(function() {
				$.ptAccordContr._openTabHeader()
			})
		},
		_openFirstDesignTab: function() {
			var a = $("[ptid]"),
			a = $(a[0]).attr("id");
			$.ptShellContr.navigateToTab(a)
		},
		_initTabWrapperDesign: function() {
			$.ptAccordContr._initTabLayout();
			$.ptAccordContr._initTabStyle();
			$.ptAccordContr._initTabHeader();
			$("#SideMenuWrapper").unbind("click.editsite").on("click.editsite", "#ptOuterSideMenuDesign",
			function() {
				$.dmfw.setPreviewEditPolicy(!0);
				$("#ptEditorAreaChange").hide();
				$.ptAccordContr._openFirstDesignTab();
				$.ptTipsList && ($.ptTipsList.destroyList("design"), $.ptTipsList.destroyList("pages"))
			})
		},
		_initAccordTabs: function() {
			$.ptAccordContr._initTabWrapperDesign();
			$.ptAccordContr._initTabWrapperPages();
			$.ptAccordContr._initTabWrapperGoLive()
		},
		setAccordionIsCollapseAll: function(a) {
			a ? ($("#SideMenuWrapper").accordion("option", "collapsible", !0), $("#SideMenuWrapper").accordion("option", "active", !1)) : $("#SideMenuWrapper").accordion("option", "collapsible", !1)
		},
		showDisplayPhone: function(a) {
			a = a || {};
			$("#PreviewPaneWrapper").show();
			a.dontCollapse || $.ptAccordContr.setAccordionIsCollapseAll(!1)
		},
		hideDisplayPhone: function() {
			$("#PreviewPaneWrapper").hide()
		},
		changeSectionHeader: function(a) {
			$("#ptEditorAreaChange #ptEditorInnerArea h2tr:first").html(a)
		},
		setRedirectTabState: function(a) {
			a = a || {};
			a.forceDisabled && ($("#ptSideMenuGoLiveRedirect").hide(), $("#ptSideMenuGoLiveSave").css("border-radius", $("#ptSideMenuGoLiveRedirect").css("border-radius")));
			$.dmx.site.isPublished && !0 != a.forceDisabled ? ($.ptAccordContr._initTabRedirect(), $("#ptSideMenuGoLiveRedirect").removeClass("menuDisbaledTab")) : $("#ptSideMenuGoLiveRedirect").unbind("click").addClass("menuDisbaledTab")
		},
		isStyleTabOpen: function() {
			return 1 == $.ptAccordContr._varCurrTabChosen && $("#SideMenuWrapper #ptSideMenuDesignColors").hasClass("active")
		}
	}
});
function NEEJalanReservation() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.jalanres.title"].replace("^", "")
	};
	this.ext = {
		id: "jalan_res",
		preId: "jalan_res",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "jalan_res";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/jalanRes.png",
			editableDraggedText: dmStr["ui.nee.widgets.39"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.jalanres.title"].replace("^", "")
	};
	this.rightPanelElementSelector = "#generalJalanRes";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/jalan/nee.jalanWidgets.jsp?type\x3dreservation",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEJalanReservation.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEJalanReservation.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorJalanResSelected")
};NEEJalanReservation.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#jalanUrl").val(a.attr("url"));
	$("#jalanTextDesc").val(a.attr("description"));
	$('[id^\x3d"jalan"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"jalan"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			url: $("#jalanUrl").val(),
			description: $("#jalanTextDesc").val(),
			needs_premium_validation: !1
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("url", e.url);
				a.find("text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEJalanReservation.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorJalanSelected"), this.disableEditInline())
};NEEJalanReservation.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmJalanRes *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEJalanReservation.prototype.getElementTagsSelectors = function() {
	return "A.dmJalanRes"
};NEEJalanReservation.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEJalanReservation.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEJalanReservation.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEJalanReservation.prototype.disableEditInline = function() {};NEEJalanReservation.prototype.docReady = function() {};NEEJalanReservation.prototype.getDefaultIconName = function() {
	return "mail.png"
};NEEJalanReservation.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};
function NEEJalanGallery() {
	this.insertBeforeNav = this.isExtension = !0;
	this.title = function() {
		return dmStr["ui.nee.jalangallery.title"].replace("^", "")
	};
	this.ext = {
		id: "jalan_gallery",
		preId: "jalan_gallery",
		defaults: {
			"class": "default dmDefaultGradient",
			icon: !0,
			surround: !0,
			needs_premium_validation: !1,
			wr: !0
		}
	};
	this.priority = 1;
	this.type = "jalan_gallery";
	this.inlineEditor = null;
	this.addClearWidget = !1;
	this.dragImageParams = function() {
		return {
			editableDraggedImg: "/editor/nee/images/contentBtns/jalanGallery.png",
			editableDraggedText: dmStr["ui.nee.widgets.38"]
		}
	};
	this.inlineEditorProperties = {
		title: dmStr["ui.nee.jalangallery.title"].replace("^", "")
	};
	this.rightPanelElementSelector = "#generalJalanGallery";
	this.allowedOperations = function() {
		return {
			insertBefore: !0,
			insertAfter: !0,
			insertInsideTop: !1,
			insertInsideBottom: !1
		}
	};
	this.buttonTabInfo = {
		type: [{
			url: "/editor/nee/editableObjects/jalan/nee.jalanWidgets.jsp?type\x3dgallery",
			text: dmStr["ui.general"],
			imgSrc: "GeneralImgIcon",
			onTabReady: this.onTabReadyGeneral,
			onTabClose: function(a, e) {
				$.dmHideAllPagesButtons();
				e && e()
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.icon"],
			imgSrc: "IconImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryIconTabs({
					tabs: {
						gallery_icon: [],
						upload_icon: [],
						url_icon: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.design"],
			imgSrc: "DesignImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					textSelector: "span.text",
					tabs: {
						color: ["text", "background_widgets", "border", "presets"],
						widgetshape: [],
						text_style: []
					}
				})
			}
		},
		{
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.htm",
			text: dmStr["ui.more"],
			imgSrc: "MoreImgIcon",
			onTabReady: function(a) {
				$(a).neeSecondaryDesignTabs({
					tabs: {
						general_design_settings: [],
						alignment_design_settings: [],
						css: [],
						html: []
					},
					showWidthHeight: !0
				})
			}
		}]
	}
}
NEEJalanGallery.prototype.getDummyElement = function() {
	return $("\x3ca\x3e\x3c/a\x3e")
};NEEJalanGallery.prototype.selectInline = function() {
	null != this.element && $(this.element).addClass("inlineEditorJalanGallerySelected")
};NEEJalanGallery.prototype.onTabReadyGeneral = function() {
	var a = $.dmx.current.editable.element;
	$("#jalanUrl").val(a.attr("url"));
	$("#jalanTextDesc").val(a.attr("description"));
	$('[id^\x3d"jalan"]').blur(function() {
		_updateInfo()
	});
	$('[id^\x3d"jalan"]').keypress(function(a) {
		13 == a.keyCode && _updateInfo()
	});
	_updateInfo = function() {
		var e = {
			url: $("#jalanUrl").val(),
			description: $("#jalanTextDesc").val(),
			needs_premium_validation: !1
		};
		$.changePage({
			clientChange: function() {
				a.attr("description", e.description);
				a.attr("url", e.url);
				a.find("text").html(e.description)
			},
			serverChange: function() {
				$.dmsrv.updateExtension(a, e)
			}
		})
	};
	$.dmAddAllPagesButtons(a)
};NEEJalanGallery.prototype.deselectInline = function() {
	null != this.element && ($(this.element).removeClass("inlineEditorJalanSelected"), this.disableEditInline())
};NEEJalanGallery.prototype.isMember = function(a) {
	var e = !1;
	$(a).is("A.dmJalanGallery *") && (e = !0);
	$(a).is(this.getElementTagsSelectors()) && (e = !0);
	return e
};NEEJalanGallery.prototype.getElementTagsSelectors = function() {
	return "A.dmJalanGallery"
};NEEJalanGallery.prototype.setCorrectElement = function(a) {
	this.element = this.getCorrectElement(a)
};NEEJalanGallery.prototype.getCorrectElement = function(a) {
	return 0 != $(a).length ? $(a).closest(this.getElementTagsSelectors()) : $.dmfw.getPreviewElement(this.getElementTagsSelectors()).get(0)
};NEEJalanGallery.prototype.editInline = function(a, e) {
	var d = $.extend(!0, {},
	this.inlineEditorProperties);
	null != e && $.extend(d, e);
	this.inlineEditor = new NEEInlineEditor(a);
	this.inlineEditor.init(d)
};NEEJalanGallery.prototype.disableEditInline = function() {};NEEJalanGallery.prototype.docReady = function() {};NEEJalanGallery.prototype.getDefaultIconName = function() {
	return "mail.png"
};NEEJalanGallery.prototype.editorReady = function(a) {
	$(a).find(".buttonTab").neeEditorTabs({
		tabs: this.buttonTabInfo
	})
};$.extend({
	dmOTPub: {
		init: function(a) {
			$("#_publish .panelsTitleWrapper .panelTitleQmark").dmQtip({
				content: dmStr["ui.nee.publishPanel.201"]
			});
			a = a || {};
			$.dmOTPub._getSiteState(a, $.dmOTPub._handleState)
		},
		_handleState: function(a) {
			$.dmOTPub._initRedirectButton(a);
			a.justPublished && a.published ? ($.dmOTPub._showConfirmationScreen(a), $.dmx.firstPublished = null) : $.dmOTPub._initNoPayment(a, $.dmOTPub._publish)
		},
		_initRedirectButton: function() {
			$.ptAccordContr.setRedirectTabState()
		},
		_initNoPayment: function(a, e) {
			$.dmOTPub._initNoPaymentLayoutChanges(a);
			$.dmOTPub._initNoPaymentButtons(a, e);
			$.dmOTPub._show()
		},
		_initNoPaymentButtons: function(a, e) {
			$(".neePublishButtons.neeRepublishBtn").hide();
			a.published ? $(".ptOtYesPublishedBtn").show() : $(".ptOtNotPublishedBtn").show();
			$(".neeRepublishBtn").unbind("click").click(function() {
				$(".neeRepublishBtn").unbind("click");
				e(a)
			});
			a.published && $.dmOTPub._initRollbackLinks(a)
		},
		_initRollbackLinks: function(a) {
			$("#dmwrRollback").neeConfirmationPopUpDiv(dmStr["ui.nee.publishPanel.209"], {
				liveClick: !0,
				initCallback: function() {
					$.dmOTPub._rollback(a)
				}
			});
			$("#dmwrUnpublish").neeConfirmationPopUpDiv(dmStr["ui.nee.publishPanel.210"], {
				liveClick: !0,
				forceWidth: "280px",
				initCallback: function() {
					$.dmOTPub._unpublish(a)
				}
			})
		},
		_initNoPaymentLayout: function(a) {
			$(".neePublishTitle").hide();
			$(".neeRepublishBtn").hide();
			$(".neeConfirmRePublishTitle").show();
			$(".neeRepublishWr").show();
			$.dmOTPub._afterTitleInit(a)
		},
		_initNoPaymentLayoutChanges: function(a) {
			$(".neePublishTitle").hide();
			a.published ? $(".ptOtYesPublished").show() : $(".ptOtNotPublished").show();
			$(".neeRepublishWr").show();
			$.dmOTPub._afterTitleInit(a)
		},
		_afterTitleInit: function(a) {
			a.published ? ($(".neeRepublishPart").show(), $(".neeRepublishSiteUrl").text($.dmx.site.domain ? $.dmx.site.domain: $.dmx.site.mobileUrl), $(".neeRedirectSetupBtn").unbind("click").click(function() {
				$.ptShellContr.navigateToTab(PT_REDIRECT_ID)
			}), $(".neePublishRollbackWrapper").show(), $.dmOTPub._initShareButtons(a)) : $(".neeRepublishPart").hide()
		},
		_initShareButtons: function() {
			$(".dmwrFBShare").unbind("click").click(function() {
				FB.ui({
					method: "stream.publish",
					message: dmStr["ui.nee.publishPanel.211"],
					caption: $.dmx.site.mobileUrl,
					name: dmStr["ui.nee.publishPanel.212"],
					link: $.dmx.site.mobileUrl,
					display: "popup"
				})
			});
			$(".dmwrGPShare").unbind("click").click(function() {
				window.open("http://plus.google.com/share?url\x3d" + escape($.dmx.site.mobileUrl))
			});
			$(".dmwrTShare").unbind("click").click(function() {
				window.open("http://twitter.com/intent/tweet?url\x3d" + escape($.dmx.site.mobileUrl) + "\x26text\x3d" + dmStr["ui.nee.publishPanel.213"] + "  \x26via\x3ddudamobile")
			});
			$(".neePublishSharePanel g:plusone").attr("href", escape($.dmx.site.mobileUrl));
			$(".dmwrQRShare").dmQrCodePopup({
				url: $.dmx.site.mobileUrl
			});
			$(".dmwrMailShare").shareByEmailPopup({
				mailType: "SHARE_SITE",
				siteAddress: $.dmx.site.mobileUrl,
				addTryModeParam: !1
			})
		},
		_publish: function(a, e) {
			$.dmsrv.publishSite(function(d) {
				wrTrackEvent(WR_SITE_PUBLISHED, {
					plan: "premium"
				});
				e ? e() : $.dmOTPub._afterPublish(a, d)
			})
		},
		_unpublish: function(a) {
			$.dmsrv.unpublishSite(function() {
				a.published = !1;
				$.dmfw.resetEmulatorPremiumMode();
				$.dmOTPub._handleState(a)
			})
		},
		_rollback: function(a) {
			$.dmUIBlockControlled({
				region: "publish.rollback",
				op: "block",
				style: "wheel",
				container: $("#neePublishContent")
			});
			$.dmsrv.rollbackSite(function() {
				$.dmops.updateEditContext.all({
					success: function() {
						$.dmfw.refreshPreview(function() {
							$.dmOTPub._handleState(a);
							$.dmUIBlockControlled({
								region: "publish.rollback",
								op: "unblock",
								style: "wheel"
							})
						})
					}
				})
			})
		},
		_afterPublish: function(a) {
			a.published || (a.published = !0);
			a.justPublished = !0;
			$.dmOTPub._handleState(a)
		},
		_showConfirmationScreen: function(a) {
			$.dmOTPub._initNoPaymentLayout(a);
			$.dmOTPub._show()
		},
		_showTitle: function(a) {
			$(".neePublishTitle").hide();
			a && $(a).show()
		},
		_show: function() {
			$("#neePublishContent").removeClass("dmVisibilityHidden");
			$.dmUIBlockControlled({
				region: "publish.screeen",
				op: "unblock",
				style: "wheel"
			});
			$.dmUnblockUI()
		},
		_getSiteState: function(a, e) {
			$.dmops.updateEditContext.site({
				withRedirect: !0,
				success: function() {
					var a = {};
					a.published = $.dmx.site.isPublished;
					a.republished = !0;
					a.premium = !0;
					a.redirected = $.dmx.site.isRedirected;
					a.justPublished = $.dmx.firstPublished;
					e(a)
				}
			})
		}
	}
});$(function() {
	$.extend({
		ptToolTips: function() {
			var a = commonProps["editor.pt.tooltips"],
			e = {
				common: {
					show: {
						delay: 600
					},
					event: "mouseover",
					position: {
						at: "right center",
						my: "left center",
						adjust: {
							x: 10
						}
					},
					style: {
						classes: "ui-tooltip-light ui-tooltip-rounded ui-tooltip-shadow dmtooltip",
						tip: {
							corner: !1
						},
						def: !1
					},
					dontHide: !1,
					hide: {
						event: "mouseleave",
						fixed: !0,
						effect: function() {
							$(this).fadeOut("fast")
						}
					}
				},
				sideMenuButton: {
					position: {
						adjust: {
							x: -60
						}
					}
				},
				bigSquareButton: {
					position: {
						at: "top left",
						my: "bottom left",
						adjust: {
							x: 40,
							y: 28
						}
					}
				},
				under: {
					position: {
						at: "bottom center",
						my: "top center",
						adjust: {
							y: 5
						}
					}
				},
				navigationStyle: {
					position: {
						at: "top left",
						my: "bottom left",
						adjust: {
							x: 40,
							y: 28
						}
					},
					show: {
						delay: 200
					}
				},
				inlineEditor: {
					position: {
						at: "left center",
						my: "right center",
						adjust: {
							x: -10
						}
					}
				}
			},
			d = {
				"#ptSideMenuDesignLayout": {
					message: dmStr["ui.nee.tooltip.1"],
					options: "sideMenuButton"
				},
				"#ptSideMenuDesignColors": {
					message: dmStr["ui.nee.tooltip.2"],
					options: "sideMenuButton"
				},
				"#ptSideMenuDesignHeader": {
					message: dmStr["ui.nee.tooltip.3"],
					options: "sideMenuButton"
				},
				"#ptSideMenuEdit[data-tabs-id\x3d2]": {
					message: dmStr["ui.nee.tooltip.4"],
					options: "sideMenuButton"
				},
				"#ptSideMenuGolive[data-tabs-id\x3d3]": {
					message: dmStr["ui.nee.tooltip.5"],
					options: "sideMenuButton"
				},
				"#ptNavigationLayoutTitle": {
					message: dmStr["ui.nee.tooltip.6"]
				},
				"#ptNavigationStyleTitle": {
					message: dmStr["ui.nee.tooltip.7"]
				},
				"#ptPalettesTitleText": {
					message: dmStr["ui.nee.tooltip.8"]
				},
				"#ptTextStyleTitle": {
					message: dmStr["ui.nee.tooltip.9"]
				},
				"#ptOpenColorText": {
					message: dmStr["ui.nee.tooltip.10"],
					options: "bigSquareButton"
				},
				"#ptOpenColorHeader": {
					message: dmStr["ui.nee.tooltip.11"],
					options: "bigSquareButton"
				},
				"#ptHeaderTypeTitle": {
					message: dmStr["ui.nee.tooltip.12"]
				},
				"#headerFixedIsSkinnk": {
					message: dmStr["ui.nee.tooltip.13"],
					options: "under"
				},
				"#headerSkinnySelection": {
					message: dmStr["ui.nee.tooltip.13"],
					options: "under"
				},
				"#headerFixedIsFixed": {
					message: dmStr["ui.nee.tooltip.14"],
					options: "under"
				},
				"#headerFixedSelection": {
					message: dmStr["ui.nee.tooltip.14"],
					options: "under"
				},
				"#ptPageInfoTitle": {
					message: dmStr["ui.nee.tooltip.15"]
				},
				"#openPageSettingsPopUp": {
					message: dmStr["ui.nee.tooltip.16"],
					options: "under"
				},
				"#neeNotifyArea": {
					message: dmStr["ui.autoSaveChange.1"],
					options: "under"
				},
				"#ListStyle1 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.1"],
					options: "navigationStyle"
				},
				"#ListStyle2 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.2"],
					options: "navigationStyle"
				},
				"#ListStyle3 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.3"],
					options: "navigationStyle"
				},
				"#ListStyle4 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.4"],
					options: "navigationStyle"
				},
				"#ListStyle5 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.5"],
					options: "navigationStyle"
				},
				"#MatrixStyle_1 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.6"],
					options: "navigationStyle"
				},
				"#MatrixStyle_2 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.7"],
					options: "navigationStyle"
				},
				"#MatrixStyle_3 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.8"],
					options: "navigationStyle"
				},
				"#MatrixStyle_4 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.9"],
					options: "navigationStyle"
				},
				"#MatrixStyle_5 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.10"],
					options: "navigationStyle"
				},
				"#ExpendingStyle1 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.11"],
					options: "navigationStyle"
				},
				"#ExpendingStyle2 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.12"],
					options: "navigationStyle"
				},
				"#ExpendingStyle3 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.13"],
					options: "navigationStyle"
				},
				"#ExpendingStyle4 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.14"],
					options: "navigationStyle"
				},
				"#ExpendingStyle5 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.15"],
					options: "navigationStyle"
				},
				"#BottomStyle1 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.16"],
					options: "navigationStyle"
				},
				"#BottomStyle2 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.17"],
					options: "navigationStyle"
				},
				"#BottomStyle3 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.18"],
					options: "navigationStyle"
				},
				"#BottomStyle4 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.19"],
					options: "navigationStyle"
				},
				"#TopStyle1 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.20"],
					options: "navigationStyle"
				},
				"#TopStyle2 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.21"],
					options: "navigationStyle"
				},
				"#TopStyle3 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.22"],
					options: "navigationStyle"
				},
				"#TopStyle4 .navTypeItemPhone .navTypeItemImg": {
					message: dmStr["ui.nee.variations.14"],
					options: "navigationStyle"
				},
				"#generalWidgetTitleController #designTitleBtn": {
					message: dmStr["ui.nee.genericTitle.2"],
					options: ""
				},
				"#generalWidgetTitleController #toggleTitleBtn": {
					message: dmStr["ui.nee.genericTitle.1"],
					options: ""
				},
				".explanationHowToGallery .explanationHowToGalleryLinkable": {
					message: dmStr["ui.nee.imageMsgs.3"],
					options: "under"
				},
				".explanationHowToGallery .deleteAllImagesBtn": {
					message: dmStr["ui.nee.imageMsgs.1"],
					options: "under"
				},
				".accountDomainBox #accountTipSubDomain": {
					message: dmStr["ui.accountSettingsTips.1"]
				},
				".accountDomainBox #accountTipEdCusDomain": {
					message: dmStr["ui.accountSettingsTips.2"]
				},
				".accountDomainBox #accountTipGenDomain": {
					message: dmStr["ui.accountSettingsTips.3"]
				},
				".accountDomainBox #accountTipLiveCusDomain": {
					message: dmStr["ui.accountSettingsTips.4"]
				},
				".accountDomainBox #accountTipResellerCusDomain": {
					message: dmStr["ui.accountSettingsTips.2"]
				},
				".accountCustomLogo #accountCustomLogoTip": {
					message: dmStr["ui.accountSettingsTips.5"]
				}
			};
			return {
				init: function() {
					var g;
					this._qTipOptions = {};
					if ($.dmfw.isPT() && a) for (g in d) $(document).one("mouseover", g,
					function(a) {
						var g = d[a],
						l = "string" === $.type(g.options) ? e[g.options] : g.options;
						return function() {
							$(this).data("qtip") || $.ptToolTips.setToolTip(a, d[a].message, void 0, void 0, l, !0)
						}
					} (g))
				},
				setToolTip: function(d, j, k, l, m, n, o) {
					if (a) {
						var r = k || $(d);
						l || $(d);
						var u, s;
						s = {
							element: k,
							selector: d,
							text: j
						};
						$.extend(!0, s, e.common);
						$.extend(!0, s, m);
						o && (d = s.position && s.position.adjust && s.position.adjust.x || 0, j = s.position && s.position.adjust && s.position.adjust.y || 0, s.position.adjust.x = d + NEFW.PREVIEW.offset().left, s.position.adjust.y = j + NEFW.PREVIEW.offset().top);
						n ? (u = setTimeout(function() {
							$.dmfw.showQTip(s).qtip("show")
						},
						s.show.delay), r.one("mouseleave",
						function() {
							clearTimeout(u);
							r.data("qtip") || $.dmfw.showQTip(s)
						})) : $.dmfw.showQTip(s)
					}
				},
				getOptions: function(a) {
					a = a || "common";
					this._qTipOptions[a] = this._qTipOptions[a] || $.extend({},
					e[a]);
					return this._qTipOptions[a]
				}
			}
		} ()
	});
	$.ptToolTips.init()
}); (function(a) {
	a.fn.neePtSecondaryDesignTabs = function(e) {
		e = e || {};
		e.colorCallbacks = e.colorCallbacks || {};
		e.onReadyCallbacks = e.onReadyCallbacks || {};
		e.colorPreviewCallbacks = e.colorPreviewCallbacks || {};
		e.colorDefaults = e.colorDefaults || {};
		e.elementArray = e.elementArray || {};
		e.selectors = e.selectors || {};
		e.specForceClassName = e.specForceClassName || {};
		e.colorSelectors = e.colorSelectors || {};
		for (var d = this,
		g = a.dmx.current.element || e.currentPreviewElement,
		g = 0 < g.length ? g.get(0).nodeName.toLowerCase() : null, j = e.changeGlobally, k = e.forceClassName, l = e.forceClassNameIcon, m = [], n = [], o = [], r = [], u = [{
			id: "background",
			name: dmStr["ui.controls.design.backgroundcolor"],
			attr: "background-color",
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			callback: e.colorCallbacks.background || null,
			additionalWidgetInit: function(g) {
				g && d.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: e.forceClassName ? a(a.dmfw.getPreviewElement(e.forceClassName).get(0)) : a.dmx.current.element,
					forceClassName: e.forceClassName,
					callback: e.colorCallbacks.bgimage ? e.colorCallbacks.bgimage: d.neeChangeImage,
					changeGlobally: j ? !0 : !1,
					selector: e.selector
				})
			}
		},
		{
			id: "color_border",
			name: "Border Color",
			attr: "border-color",
			necessaryAttr: {
				attr: "border-style",
				value: "solid"
			},
			attrSpecificToGetColor: "border-top-color"
		},
		{
			id: "background_widgets",
			name: dmStr["ui.background"],
			attr: "background-color",
			attrToWrite: dmStr["ui.background"].toLowerCase() + " ",
			tagName: e.tagName || g,
			selector: e.selector || null,
			additionalWidget: a("\x3cdiv\x3e\x3c/div\x3e"),
			forceClassName: e.specForceClassName.background_widgets || null,
			callback: e.colorCallbacks.background_widgets || null,
			additionalWidgetInit: function(g) {
				g && d.find("#additionalWidgetPlaceholder").neeAddBackgroundImagePlaceholder({
					elem: e.forceElement ? e.forceElement: e.forceClassName ? -1 != e.forceClassName.constructor.toString().indexOf("Array") ? a(a.dmfw.getPreviewElement(e.forceClassName[0]).get(0)) : a(a.dmfw.getPreviewElement(e.forceClassName).get(0)) : a.dmx.current.element,
					forceClassName: e.forceClassName,
					callback: d.neeChangeImage,
					selector: e.selector,
					changeGlobally: j ? !0 : !1,
					updateInChangePage: e.updateInChangePage || null
				})
			}
		},
		{
			id: "text",
			name: dmStr["ui.text"],
			attr: "color",
			attrToWrite: dmStr["ui.text"].toLowerCase() + " ",
			tagName: e.tagName || g,
			selector: e.textSelector || e.selector || null,
			colorSelector: e.colorSelectors.text || null,
			callback: e.colorCallbacks.text,
			changePreview: e.colorPreviewCallbacks.text,
			forceClassName: e.specForceClassName.text || null
		},
		{
			id: "border",
			name: dmStr["ui.nee.common.design.17"],
			attr: "border-color",
			attrToWrite: dmStr["ui.nee.common.design.17"].toLowerCase() + " ",
			tagName: e.tagName || g,
			selector: e.selector || null,
			forceClassName: e.specForceClassName.border || null,
			necessaryAttr: {
				attr: "border-style",
				value: "solid"
			},
			attrSpecificToGetColor: "border-top-color",
			additionalWidget: a("\x3cdiv id\x3d'borderColorSettings'\x3e\x3chr/\x3e\x3cbr/\x3e\x3cspan\x3e" + dmStr["ui.nee.twitter.14"] + ":\x3c/span\x3e \x3cinput id\x3d'borderSize' type\x3dtext' /\x3e\x3cdiv class\x3d'sliderBorderWrapper'\x3e\x3cdiv id\x3d'sliderBorder'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),
			additionalWidgetInit: function() {
				var d = function(d) {
					var e = {
						classesToRemove: null,
						attrToRemove: null,
						classesToAdd: null,
						attrToAdd: [{
							attr: "border-width",
							value: a("#borderSize").val()
						},
						{
							attr: "border-style",
							value: "solid"
						}]
					};
					if (j) {
						var g = d ? d.clientOnly: !1;
						d.updateInChangePage ? (updateInChangePage(k, "border-width", a("#borderSize").val()), updateInChangePage(k, "border-style", "solid")) : a.dmops.updateGlobalCssAndElement(e, {
							className: k,
							clientOnly: g
						})
					} else a.dmops.updateCurrentCss(e, d)
				},
				g = e.forceElement ? e.forceElement: e.forceClassName ? a(a.dmfw.getPreviewElement(e.forceClassName[0]).get(0)) : a.dmx.current.element;
				a("#sliderBorder").slider({
					range: "min",
					value: parseInt(g.css("border-left-width")),
					min: 0,
					max: 25,
					step: 1,
					slide: function(g, j) {
						a("#borderSize").val(j.value + "px");
						var k = a.extend({
							clientOnly: !0
						},
						e);
						d(k)
					},
					stop: function() {
						d(e)
					}
				});
				a("#borderSize").val(g.css("border-left-width"));
				a("#borderSize").blur(function() {
					d(e)
				});
				a("#borderSize").keypress(function(a) {
					13 == a.keyCode && d(e)
				})
			}
		}], s = [{
			id: "gen_layout",
			name: "Layout",
			onReady: function() {}
		},
		{
			id: "gen_visible_rows",
			name: "Visible Rows",
			onReady: function() {}
		},
		{
			id: "gen_remove_padding",
			name: "Remove Padding Between Thumbnails",
			onReady: function() {}
		}], B = [{
			id: "text_general",
			name: dmStr["ui.general"],
			callback: function() {
				var a = d.find(".textInnerSec");
				a.empty();
				jQuery.ajax({
					url: "/editor/nee/editableObjects/common/nee.buttonsHtmlTextStyle.jsp",
					async: !1,
					success: function(d) {
						a.append(d)
					}
				});
				a.neeSecondaryTextStyleTab(e)
			}
		},
		{
			id: "text_color",
			name: dmStr["ui.color"],
			callback: function() {
				var g = d.find(".textInnerSec");
				g.empty().append(a("\x3cdiv class\x3d'slideRightPanelInner'\x3e\x3c/div\x3e"));
				g.neeSecondaryColorTabPT(r, e)
			}
		}], z = [{
			id: "eff_shadow",
			name: dmStr["ui.controls.design.shadow"],
			isOnOff: !0,
			onReady: function(d) {
				var g = {
					initState: "none" != (e.useElement ? e.useElement: a.dmx.current.element).css("box-shadow"),
					onFn: function() {
						var d = {
							classesToRemove: null,
							attrToRemove: null,
							classesToAdd: null,
							attrToAdd: [{
								attr: "-webkit-box-shadow",
								value: "inset -1px -1px 0px hsla(0, 0%, 0%, 0.1), inset 1px 1px 0px hsla(0, 0%, 100%, 0.3), 2px 2px 2px 0px hsla(0, 0%, 0%, 0.35)"
							},
							{
								attr: "-moz-box-shadow",
								value: "inset -1px -1px 0px hsla(0, 0%, 0%, 0.1), inset 1px 1px 0px hsla(0, 0%, 100%, 0.3), 2px 2px 2px 0px hsla(0, 0%, 0%, 0.35)"
							},
							{
								attr: "box-shadow",
								value: "inset -1px -1px 0px hsla(0, 0%, 0%, 0.1), inset 1px 1px 0px hsla(0, 0%, 100%, 0.3), 2px 2px 2px 0px hsla(0, 0%, 0%, 0.35)"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(k, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, e)
					},
					offFn: function() {
						var d = {
							classesToAdd: null,
							attrToRemove: null,
							classesToRemove: null,
							attrToAdd: [{
								attr: "-webkit-box-shadow",
								value: "none"
							},
							{
								attr: "-moz-box-shadow",
								value: "none"
							},
							{
								attr: "box-shadow",
								value: "none"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(k, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, e)
					}
				};
				d.find(".neeOnButton").onOffBtn(g)
			}
		},
		{
			id: "eff_rounded_corners",
			name: dmStr["ui.controls.design.roundedcorners"],
			isOnOff: !0,
			onReady: function(d) {
				var g = {
					initState: "5px" == (e.useElement ? e.useElement: a.dmx.current.element).css("border-radius"),
					onFn: function() {
						var d = {
							classesToRemove: null,
							attrToRemove: null,
							classesToAdd: null,
							attrToAdd: [{
								attr: "-webkit-border-radius",
								value: "5px"
							},
							{
								attr: "-moz-border-radius",
								value: "5px"
							},
							{
								attr: "border-radius",
								value: "5px"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(k, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, e)
					},
					offFn: function() {
						var d = {
							classesToAdd: null,
							attrToAdd: null,
							classesToRemove: null,
							attrToAdd: [{
								attr: "-webkit-border-radius",
								value: "initial"
							},
							{
								attr: "-moz-border-radius",
								value: "initial"
							},
							{
								attr: "border-radius",
								value: "initial"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(k, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, e)
					}
				};
				d.find(".neeOnButton").onOffBtn(g)
			}
		},
		{
			id: "eff_show_icon",
			name: dmStr["ui.controls.design.showicon"],
			isOnOff: !0,
			onReady: function(d) {
				var g = e.useElement ? e.useElement: a.dmx.current.element,
				k = a.extend({},
				e, {
					selector: ".iconBg"
				}),
				g = g.find(".iconBg"),
				g = {
					initState: "none" != g.css("display"),
					onFn: function() {
						var d = {
							classesToRemove: null,
							attrToAdd: null,
							classesToAdd: null,
							attrToAdd: [{
								attr: "display",
								value: "block"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(l, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, k)
					},
					offFn: function() {
						var d = {
							classesToRemove: null,
							attrToRemove: null,
							classesToAdd: null,
							attrToAdd: [{
								attr: "display",
								value: "none"
							}]
						};
						j ? a.dmsrv.updateGlobalCSS(l, d,
						function(d) {
							a.dmops.refreshGlobalCss(d.value, 1E3)
						}) : a.dmops.updateCurrentCss(d, k)
					}
				};
				d.find(".neeOnButton").onOffBtn(g)
			}
		},
		{
			id: "eff_image_fill_slider",
			name: "Image Fill Slider"
		},
		{
			id: "eff_height",
			name: "Height"
		},
		{
			id: "eff_autoplay",
			name: "Autoplay"
		},
		{
			id: "eff_show_nav_arrow",
			name: "Show Navigation Arrows"
		}], g = [{
			id: "coupon_layout",
			name: dmStr["ui.layout"],
			url: "/editor/nee/editableObjects/coupon/nee.couponLayout.jsp",
			onReady: function() {
				a.dmx.current.editable.bindLayoutAction()
			}
		},
		{
			id: "tab_general",
			name: dmStr["ui.general"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			onReady: function() {
				d.neeSecondaryEffectsTabPT(s)
			}
		},
		{
			id: "tab_colors",
			name: dmStr["ui.controls.design.colors"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlColor.jsp",
			onReady: function() {
				d.neeSecondaryColorTabPT(m, e)
			}
		},
		{
			id: "tab_effects",
			name: dmStr["ui.effects"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			onReady: function() {
				d.neeSecondaryEffectsTabPT(n)
			}
		},
		{
			id: "tab_text_style",
			name: dmStr["ui.nee.common.design.35"],
			url: "/editor/nee/editableObjects/common/empty.html",
			onReady: function() {
				d.find(".slideRightPanelInner").append(a("\x3cdiv class\x3d'textInnerSec'\x3e\x3c/div\x3e"));
				d.find(".slideRightPanelInner").neeThirdTabControl({
					callback: !0,
					tabs: o
				})
			}
		},
		{
			id: "tab_title_style",
			name: dmStr["ui.controls.design.titlestyle"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			onReady: function() {}
		},
		{
			id: "tab_bar_style",
			name: dmStr["ui.controls.design.barstyle"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			onReady: function() {}
		},
		{
			id: "tab_combined_style",
			name: dmStr["ui.nee.common.design.35"],
			url: "/editor/nee/editableObjects/common/nee.buttonsHtmlDef.jsp",
			onReady: function() {
				d.neeSecondaryTextAndTitleStyleTab(e)
			}
		}], v = 0; v < u.length; v++) - 1 != jQuery.inArray(u[v].id.toLowerCase(), e.tabs.tab_colors) && (!u[v].hideIf || !u[v].hideIf()) && m.push(u[v]);
		for (v = 0; v < z.length; v++) - 1 != jQuery.inArray(z[v].id.toLowerCase(), e.tabs.tab_effects) && (!z[v].hideIf || !z[v].hideIf()) && n.push(z[v]);
		for (v = 0; v < B.length; v++) - 1 != jQuery.inArray(B[v].id.toLowerCase(), e.tabs.tab_text_style) && (!B[v].hideIf || !B[v].hideIf()) && o.push(B[v]);
		for (v = 0; v < u.length; v++) - 1 != jQuery.inArray(u[v].id.toLowerCase(), e.textColorList) && (!u[v].hideIf || !u[v].hideIf()) && r.push(u[v]);
		u = e.tabs;
		B = [];
		for (v = 0; v < g.length; v++) u[g[v].id.toLowerCase()] && (!g[v].hideIf || !g[v].hideIf()) && B.push(g[v]);
		a(this).neeSecondaryTabsControl(B)
	}
})(jQuery);$(function() {
	$.extend({
		ptMindTouch: function() {
			var a = {
				"#dmMtCustomizeBackground": {
					cid: "dm_customize_background",
					page: "/DudaMobile/How-To/Image_Features/Add_an_Image"
				},
				"#dmMtHeaderPage": {
					cid: "dm_header",
					page: "/DudaMobile/Getting_Started/Editor/Header"
				},
				"#dmMtPageInfo": {
					cid: "dm_page_info",
					page: "/DudaMobile/Getting_Started/Editor/Pages"
				},
				"#dmMtEditPageLink": {
					cid: "dm_edit_page_link",
					page: "/DudaMobile/Getting_Started/Editor/Edit_page_link"
				},
				"#dmMtPageSettingsGeneral": {
					cid: "dm_page_settings_general",
					page: "/DudaMobile/Getting_Started/Page_Settings/Page_Settings_(General)"
				},
				"#dmMtPageSettingsSeo": {
					cid: "dm_page_settings_seo",
					page: "/DudaMobile/Getting_Started/Page_Settings/Page_Settings_(SEO)"
				},
				"#dmMtPageSettingsTemplates": {
					cid: "dm_page_settings_templates",
					page: "/DudaMobile/Getting_Started/Page_Settings/Page_Settings_(Templates)"
				},
				"#dmMtPageSettingsHeadSection": {
					cid: "dm_page_settings_head_section",
					page: "/DudaMobile/Getting_Started/Page_Settings/Page_Settings_(Head_Section)"
				},
				"#dmMtSiteSettingsGeneral": {
					cid: "dm_manage_site_settings_general",
					page: "/DudaMobile/Getting_Started/Site_Settings/Manage_Site_Settings_(General)"
				},
				"#dmMtSiteSettingsSeo": {
					cid: "dm_manage_site_settings_seo",
					page: "/DudaMobile/Getting_Started/Site_Settings/Manage_Site_Settings_(SEO)"
				},
				"#dmMtSiteSettingsAdvanced": {
					cid: "dm_manage_site_settings_advanced"
				},
				"#dmMtSiteSettingsCssHtmlGlobalCss": {
					cid: "dm_global_css"
				},
				"#dmMtSiteSettingsCssHtmlPageCss": {
					cid: "dm_page_css"
				},
				"#dmMtSiteSettingsCssHtmlPageHtml": {
					cid: "dm_page_html",
					page: "/DudaMobile/How-To/Advanced_Editing/Page_HTML"
				},
				"#dmMtAccountSettingsGeneral": {
					cid: "dm_account_settings"
				},
				"#dmMtAccountSettingsDomain": {
					cid: "dm_domains"
				},
				"#dmMtAccountSettingsCustomBrand": {
					cid: "dm_custom_branding"
				},
				"#dmMtAccountSettingsCommunication": {
					cid: "dm_communications"
				},
				"#dmMtDashboardDeleteSite": {
					cid: "dm_delete_site"
				},
				"#dmMtMobileMap": {
					cid: "dm_mobile_map"
				},
				"#dmMtAdsense": {
					cid: "dm_adsense"
				},
				"#dmMtContactForm": {
					cid: "dm_contact_form"
				},
				"#dmMtRestMenu": {
					cid: "dm_restaurant_menu"
				},
				"#dmMtReviews": {
					cid: "dm_reviews"
				},
				"#dmMtYouTubeChannel": {
					cid: "dm_youtube_channel"
				},
				"#dmMtMultiLocation": {
					cid: "dm_multi_location"
				},
				"#dmMtList": {
					cid: "dm_list"
				},
				"#dmMtSendInfo": {
					cid: "dm_send_info"
				},
				"#dmMtButton": {
					cid: "dm_button"
				},
				"#dmMtVideo": {
					cid: "dm_video"
				},
				"#dmMtNavigation": {
					cid: "dm_navigation"
				},
				"#dmMtHtml": {
					cid: "dm_html"
				},
				"#dmMtRssFeed": {
					cid: "dm_rss_feed"
				},
				"#dmMtYouTubeVideo": {
					cid: "dm_youtube_video"
				},
				"#dmMtClickToCall": {
					cid: "dm_click_to_call"
				},
				"#dmMtImage": {
					cid: "dm_image"
				},
				"#dmMtImageSlider": {
					cid: "dm_image_slider"
				},
				"#dmMtPhotoGallery": {
					cid: "dm_photo_gallery"
				},
				"#dmMtParagraph": {
					cid: "dm_paragraph"
				},
				"#dmMtFacebookAlbums": {
					cid: "dm_facebook_albums"
				},
				"#dmMtOpenTable": {
					cid: "dm_opentable"
				},
				"#dmMtBusinessHours": {
					cid: "dm_business_hours"
				},
				"#dmMtClickToEmail": {
					cid: "dm_click_to_email"
				},
				"#dmMtClickToText": {
					cid: "dm_click_to_text"
				},
				"#dmMtPayPal": {
					cid: "dm_paypal"
				},
				"#dmMtConstantContact": {
					cid: "dm_constant_contact"
				},
				"#dmMtTabs": {
					cid: "dm_tabs"
				},
				"#dmMtSpacer": {
					cid: "dm_spacer"
				},
				"#dmMtSocialIcons": {
					cid: "dm_social_icons"
				},
				"#dmMtShare": {
					cid: "dm_share"
				},
				"#dmMtTwitterFeed": {
					cid: "dm_twitter_feed"
				},
				"#dmMtFacebookLike": {
					cid: "dm_facebook_like_button"
				},
				"#dmMtFacebookComments": {
					cid: "dm_facebook_comments"
				},
				"#dmMtBackups": {
					cid: "dm_backup"
				},
				"#dmMtDesignLayoutPage": {
					cid: "dm_button_layouts"
				},
				"#dmMtDesignStylePage": {
					cid: "dm_color_style"
				},
				"#dmMtDesignStyleTextStyleEditor": {
					cid: "dm_text_style"
				},
				"#dmMtHeaderBackgroundImage": {
					cid: "dm_customize_background"
				},
				"#dmMtAddPageEditor": {
					cid: "dm_add_a_page"
				},
				"#dmMtGoLivePreviewSite": {
					cid: "dm_preview_your_mobile_site"
				},
				"#dmMtDashboardCreateSite": {
					cid: "dm_create_new_site"
				},
				"#dmMtDashboard": {
					cid: "dm_my_sites"
				},
				"#dmMtStats": {
					cid: "dm_stats"
				},
				"#dmMtManageSitePaymentInfo": {
					cid: "dm_payment_info"
				},
				"#dmMtManageSiteUsers": {
					cid: "dm_users"
				},
				"#dmMtHome": {
					cid: "dm_home"
				},
				"#dmMtHtmlHelp": {
					cid: "dm_dmle"
				}
			},
			e = function(a, e) {
				if (e && "" != e) {
					callbackFn = function() {};
					redirect = escape("https://SERVER/@api/deki/users/current?dream.out.format\x3djsonp\x26dream.out.pre\x3dcallbackFn").replace("SERVER", "support.dudamobile.com");
					var j = "https://SERVER/@api/deki/users/authenticate?authtoken\x3dIMPAUTHTOKEN\x26redirect\x3dREDIRECTURL".replace("SERVER", "support.dudamobile.com").replace("IMPAUTHTOKEN", e).replace("REDIRECTURL", redirect);
					$.ajax(j, {
						dataType: "script",
						crossDomain: !0
					})
				}
				for (selector in a) $(document).on("click", selector,
				function(e) {
					return function() {
						$.ptMindTouch.openMindTouch(a[e].cid)
					}
				} (selector));
				j = $(".HeaderInnerLinks .help");
				0 < j.length && (j.find("a").attr("href", "javascript: void(0)"), j.find("a").removeAttr("target"), j.attr("id", "dmMtHome"));
				j = $("#supportLink");
				0 < j.length && (j.find("a").attr("href", "https://support.dudamobile.com"), j.find("a").attr("target", "_blank"))
			};
			return {
				init: function() {
					$.ptMindTouch.shouldHideHelp() ? $("body").addClass("hideMT") : $.ajax("https://SERVER/@api/deki/users/current?dream.out.format\x3djsonp\x26dream.out.pre\x3d?".replace("SERVER", "support.dudamobile.com"), {
						dataType: "json",
						success: function(d) {
							d && d.user && "Anonymous" != d.user.username ? e(a) : $.dmGet({
								url: "/support/sso/?accountId\x3d" + dm_account_id,
								success: function(d) {
									e(a, d.value)
								}
							})
						}
					})
				},
				shouldHideHelp: function() {
					return 2 == dm_account_locale || 3 == dm_account_locale || isWLSubUser || "PT" != dm_current_editor ? !0 : !1
				},
				showHelp: function(a) {
					$("body").hasClass("hideMT") || a.show()
				},
				openMindTouch: function(a) {
					F1.open({
						host: "support.dudamobile.com",
						stylesheet: "https://SERVER/@api/deki/files/569/f1style.css".replace("SERVER", "support.dudamobile.com"),
						contentStylesheet: "https://SERVER/@api/deki/files/570/f1styleContents.css".replace("SERVER", "support.dudamobile.com"),
						text: {
							forward: "\x3e",
							home: "Home",
							open: "Open in a New Window",
							search: "Search",
							back: "\x3c"
						},
						pagecid: a
					})
				}
			}
		} ()
	});
	$.ptMindTouch.init()
});