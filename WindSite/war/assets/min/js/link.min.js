function getXintaoLink(b,a){b||(b=1);$("#filterType-title").empty();$("#filterTr").hide();a&&a!=""&&$("#filterType-title").empty().append(">>"+$('#profileBody .filterType[type="'+a+'"]').attr("title"));$("#profileBody").empty().append("<tr id='loading'><td colspan=3><div  align='left'>\u6b63\u5728\u52a0\u8f7d\u6570\u636e,\u8bf7\u7a0d\u5019...</div></td></tr>");$.ajax({url:"/router/member/links/data?v="+Math.random(),type:"GET",data:{pageNo:b,type:a},dataType:"html",beforeSend:function(d){d.setRequestHeader("WindType",
"AJAX");d.setRequestHeader("WindDataType","HTML")},error:function(d,f,e){$("#loading").remove();alert(f)},success:function(d){$("#loading").remove();$("#profileBody").empty().append(d);$("#profileBody .page-number").click(function(){getXintaoLink($("a",$(this)).text(),a);return false});$("#profileBody .pgNext").click(function(){$(this).hasClass("pgEmpty")||getXintaoLink($(this).attr("page"),a);return false});$("#profileBody .filterType").click(function(){getXintaoLink(1,$(this).attr("type"))});$("#profileBody .getLink").click(function(){getHtmlXintaoLink($(this).attr("lid"))});
a&&$("#filterTr").show()}})}
function initAddItemLink(){var b=$("#addLinkWizard").scrollable();$('#addLinkWizard input[type="radio"][name="txtlinkRadio"]').change(function(){if($(this).val()=="customelink")$(this).is(":checked")?$("#txtlinkInput").attr("disabled",false):$("#txtlinkInput").attr("disabled",true);else $("#txtlinkInput").attr("disabled",true)});$("#thirdPrev").click(function(){b.prev()});$("#thirdNext").click(function(){var a=$('input[type="radio"][name="txtlinkRadio"]:checked');if(a.length==0)alert("\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u6837\u5f0f");
else{switch(a.val()){case "url":$("#txt_htmlcode").val(a.attr("title"));break;case "txtlink":$("#txt_htmlcode").val('<a href="'+a.attr("url")+'" target="_blank">'+a.attr("title")+"</a>");break;case "customelink":var d=$("#txtlinkInput").val();if(!d||d==""){alert("\u81ea\u5b9a\u4e49\u65f6\u5fc5\u987b\u6307\u5b9a\u6587\u5b57\u94fe\u7684\u6807\u9898");return}$("#txt_htmlcode").val('<a href="'+a.attr("url")+'" target="_blank">'+d+"</a>");break}b.next()}})}
function initAddShopLink(){initAddItemLink()}
function initAddKeyWordLink(){var b=$("#addLinkWizard").scrollable();$('#addLinkWizard input[type="radio"][name="txtlinkRadio"]').change(function(){if($(this).val()=="customelink")$(this).is(":checked")?$("#txtlinkInput").attr("disabled",false):$("#txtlinkInput").attr("disabled",true);else $("#txtlinkInput").attr("disabled",true)});$("#thirdPrev").click(function(){b.prev()});$("#thirdNext").click(function(){var a=$('input[type="radio"][name="txtlinkRadio"]:checked');if(a.length==0)alert("\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u6837\u5f0f");
else{var d="?words="+encodeURIComponent($("#txtlinkRadio2").attr("title"));switch(a.val()){case "url":$("#txt_htmlcode").val(a.attr("title")+d);break;case "txtlink":$("#txt_htmlcode").val('<a href="'+a.attr("url")+d+'" target="_blank">'+a.attr("title")+"</a>");break;case "customelink":var f=$("#txtlinkInput").val();if(!f||f==""){alert("\u81ea\u5b9a\u4e49\u65f6\u5fc5\u987b\u6307\u5b9a\u6587\u5b57\u94fe\u7684\u6807\u9898");return}$("#txt_htmlcode").val('<a href="'+a.attr("url")+d+'" target="_blank">'+
f+"</a>");break}b.next()}})}function initAddFavShopLink(){initAddGroupLink()}
function initAddGroupLink(){var b=$("#addLinkWizard").scrollable();$('#addLinkWizard input[type="radio"][name="txtlinkRadio"]').change(function(){if($(this).val()=="customelink")$(this).is(":checked")?$("#txtlinkInput").attr("disabled",false):$("#txtlinkInput").attr("disabled",true);else $("#txtlinkInput").attr("disabled",true)});$("#group_type li").click(function(){$(this).toggleClass("selected");$("#group_type li").not($(this)).removeClass("selected");$(this).hasClass("selected")?$(this).prepend('<img id="checkedImg" src="/assets/images/link/checked.gif" style="position:absolute;"/>'):
$("#checkedImg").remove()});$("#thirdPrev").click(function(){b.prev()});$("#thirdNext").click(function(){var a=$("#group_type li.selected");if(a.length==0)alert("\u672a\u9009\u62e9\u7248\u5f0f");else{var d=$('#group_skin input[type="radio"][name="group_skin"]:checked');if(d.length==0)alert("\u672a\u9009\u62e9\u76ae\u80a4");else{var f=$('#group_order input[type="radio"][name="group_order"]:checked');if(f.length==0)alert("\u672a\u9009\u62e9\u6392\u5e8f\u89c4\u5219");else{var e=$('input[type="radio"][name="txtlinkRadio"]:checked');
if(e.length==0)alert("\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u6837\u5f0f");else{a="?t="+a.attr("t")+"&s="+d.val()+"&o="+f.val();switch(e.val()){case "url":$("#txt_htmlcode").val(e.attr("title")+a);break;case "txtlink":$("#txt_htmlcode").val('<a href="'+e.attr("url")+a+'" target="_blank">'+e.attr("title")+"</a>");break;case "customelink":d=$("#txtlinkInput").val();if(!d||d==""){alert("\u81ea\u5b9a\u4e49\u65f6\u5fc5\u987b\u6307\u5b9a\u6587\u5b57\u94fe\u7684\u6807\u9898");return}$("#txt_htmlcode").val('<a href="'+
e.attr("url")+a+'" target="_blank">'+d+"</a>");break}b.next()}}}}});$("#thirdPreview").click(function(){var a=$("#group_type li.selected");if(a.length==0)alert("\u672a\u9009\u62e9\u7248\u5f0f");else{var d=$('#group_skin input[type="radio"][name="group_skin"]:checked');if(d.length==0)alert("\u672a\u9009\u62e9\u76ae\u80a4");else{var f=$('#group_order input[type="radio"][name="group_order"]:checked');if(f.length==0)alert("\u672a\u9009\u62e9\u6392\u5e8f\u89c4\u5219");else if($('input[type="radio"][name="txtlinkRadio"]:checked').length==
0)alert("\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u6837\u5f0f");else{$("#tc").val(a.attr("t"));$("#sc").val(d.val());$("#oc").val(f.val());$("#thirdPreviewForm").attr("action",$("#txtlinkRadio1").attr("title"));$("#thirdPreviewForm")[0].submit()}}}})}
function initAddLink(){loadAllItemGroups();var b=$("#addLinkWizard").scrollable(),a=b.scrollable();a.onBeforeSeek(function(e,c){$("#status li").removeClass("active").eq(c).addClass("active")});$("#firstNext").click(function(e){var c=$('input[type="radio"][name="linkType"]:checked',b);if(c.length>0){$("table.linkTable",b).hide();var g=c.val();$('.secondStep input[type="radio"]',b).attr("checked",false);$(".secondStep select",b).val("0");$('table.linkTable[lt="'+c.val()+'"]').show();a.next();e.preventDefault()}else alert("\u60a8\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u94fe\u63a5\u7c7b\u578b")});
$("#secondNext").click(function(e){var c=$('input[type="radio"][name="linkType"]:checked',b);if(c.length>0){c=c.val();if(c=="1"){c=$('#itemTd input[type="radio"]:checked');if(c.length==0){alert("\u60a8\u5c1a\u672a\u9009\u62e9\u8981\u63a8\u5e7f\u7684\u5546\u54c1");return}else getHtmlXintaoLink(1,c.attr("nid"))}else if(c=="2"){c=$('#shopTd input[type="radio"]:checked');if(c.length==0){alert("\u60a8\u5c1a\u672a\u9009\u62e9\u8981\u63a8\u5e7f\u7684\u5e97\u94fa");return}else getHtmlXintaoLink(2,c.attr("sid"))}else if(c==
"3"){c=$("#groupSelect option:selected");if(c.length==0){alert("\u60a8\u5c1a\u672a\u9009\u62e9\u8981\u63a8\u5e7f\u7684\u63a8\u5e7f\u7ec4");return}else{if(c.val()=="0"){alert("\u60a8\u5c1a\u672a\u9009\u62e9\u8981\u63a8\u5e7f\u7684\u63a8\u5e7f\u7ec4");return}if("0"==c.attr("num")){alert("\u60a8\u9009\u62e9\u7684\u63a8\u5e7f\u7ec4\u4e2d\u5c1a\u672a\u6dfb\u52a0\u63a8\u5e7f\u5546\u54c1\uff0c\u8bf7\u8fdb\u5165\u8be5\u63a8\u5e7f\u7ec4\uff0c\u4e3a\u5b83\u6dfb\u52a0\u63a8\u5e7f\u5546\u54c1.");return}getHtmlXintaoLink(3,
c.val())}}else if(c=="4")getHtmlXintaoLink(4,"");else if(c=="5"){c=$("#keyword").val();if(!c||c==""){alert("\u672a\u586b\u5199\u5173\u952e\u8bcd");return}getHtmlXintaoLink(5,c)}a.next();e.preventDefault()}else alert("\u60a8\u5c1a\u672a\u9009\u62e9\u63a8\u5e7f\u94fe\u63a5\u7c7b\u578b")});$("#copyCode").click(function(){copyToClipBoard($("#txt_htmlcode"))});$("#fourIndex").click(function(){a.seekTo(0)});$(".linkTable").pager("ul",{navId:"activity_nav",navClass:"nav_pager",height:270});$("#shopTd li").hover(function(){$(this).toggleClass("ui-selecting");
$("#shopTd li").not($(this)).removeClass("ui-selecting")},function(){$(this).removeClass("ui-selecting")}).click(function(){$('input[type="radio"]',$(this)).attr("checked",true);$(this).toggleClass("ui-selected");$("#shopTd li").not($(this)).removeClass("ui-selected")});$('#shopTd li input[type="radio"]').click(function(e){var c=$(this).parents("li");c.toggleClass("ui-selected");$("#shopTd li").not(c).removeClass("ui-selected");e.stopPropagation()});$("#groupSelect").unbind("change").change(function(){if($(this).val()&&
$(this).val()!="0"){$("#groupTd").empty();var e=$("body").data("g_"+$(this).val());if(e!=null&&e.length>0){for(var c,g=0;g<e.length;g++){if(g%15==0){c=$("<ul></ul>");$("#groupTd").append(c)}c.append(addLinkAddGroupItem(e[g]))}$("#groupTd").pager("ul",{navId:"groups_group_nav",navClass:"nav_pager",height:300})}}});$("#itemGroupsSelect").unbind("change").change(function(){if($(this).val()&&$(this).val()!="0"){$("#itemTd").empty();var e=$("body").data("g_"+$(this).val());if(e!=null&&e.length>0){for(var c,
g=0;g<e.length;g++){if(g%15==0){c=$("<ul></ul>");$("#itemTd").append(c)}c.append(addLinkAddItem(e[g]))}$("#itemTd").pager("ul",{navId:"groups_items_nav",navClass:"nav_pager",height:300});$("#itemTd li").hover(function(){$(this).toggleClass("ui-selecting");$("#itemTd li").not($(this)).removeClass("ui-selecting")},function(){$(this).removeClass("ui-selecting")}).click(function(){$('input[type="radio"]',$(this)).attr("checked",true);$(this).toggleClass("ui-selected");$("#itemTd li").not($(this)).removeClass("ui-selected")});
$('#itemTd input[type="radio"]').click(function(i){var h=$(this).parents("li");h.toggleClass("ui-selected");$("#itemTd li").not(h).removeClass("ui-selected");i.stopPropagation()})}}});$(".top_box li.key").hover(function(){$(".top_box li.key").not($(this)).removeClass("active");$(this).removeClass("active").addClass("active")},function(){$(this).removeClass("active")}).click(function(){$(this).toggleClass("selected");$("#checkedImg").remove();$(".top_box li.key").not($(this)).removeClass("selected");
if($(this).hasClass("selected")){$("#keyword").val($(this).attr("title"));$(this).prepend('<img id="checkedImg" src="/assets/images/link/checked.gif" style="position:absolute;top:-5px;left:-15px;"/>')}else{$("#keyword").val("");$("#checkedImg").remove()}});var d=$.url.param("type"),f=$.url.param("value");if(d&&d.length>0&&f&&f.length>0){a.seekTo(2);getHtmlXintaoLink(d,f)}}
function addLinkAddItem(b){var a="";if(b)a+='<li title="30\u5929\u63a8\u5e7f\u91cf:'+b.commission_num+'\u4ef6"><div class="pic" align="center"><img src="'+b.pic_url.replace("bao/uploaded","imgextra")+'_60x60.jpg"/></div><div class="item"><div class="title"><a href="'+b.click_url+'" target="_blank" onClick="_gaq.push([\'_trackEvent\', \'xt-'+PID+"', 'item-d-"+b.nick+"-"+b.num_iid+"', '"+b.title+"']);\">"+b.title+'</a></div><div><span class="k">\u4ef7\u683c:</span><span class="v">'+b.price+'</span>\u5143</div><div><span class="k">\u4f63\u91d1:</span><span class="v">'+
b.commission+'</span>\u5143</div><input class="customechecked" type="radio" name="checkedgroupitem" title="'+b.title+'" nid="'+b.num_iid+'"/></div></li>';return a}
function addLinkAddGroupItem(b){var a="";if(b)a+='<li title="30\u5929\u63a8\u5e7f\u91cf:'+b.commission_num+'\u4ef6"><div class="pic" align="center"><img src="'+b.pic_url.replace("bao/uploaded","imgextra")+'_60x60.jpg"/></div><div class="item"><div class="title"><a href="'+b.click_url+'" target="_blank" onClick="_gaq.push([\'_trackEvent\', \'xt-'+PID+"', 'item-d-"+b.nick+"-"+b.num_iid+"', '"+b.title+"']);\">"+b.title+'</a></div><div><span class="k">\u4ef7\u683c:</span><span class="v">'+b.price+'</span>\u5143</div><div><span class="k">\u4f63\u91d1:</span><span class="v">'+
b.commission+"</span>\u5143</div></div></li>";return a}function loadAllItemGroups(b){(new WindSender("/router/member/designer/itemgroups?version="+Math.random())).load("GET",{},function(a){if(a.isSuccess()){if(a.body.length>0)for(var d=0;d<a.body.length>0;d++){var f=a.body[d];f.items&&f.items!=null&&$("body").data("g_"+f.id,f.items)}}else alert(a.msg);b&&typeof b=="function"&&b()})};